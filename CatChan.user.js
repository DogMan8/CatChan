// ==UserScript==
// @name CatChan
// @version 2020.01.19.0
// @description Cross domain catalog for imageboards
// @include http*://*krautchan.net/*
// @include http*://boards.4chan.org/*
// @include http*://boards.4channel.org/*
// @include http*://i.4cdn.org/*
// @include http*://8chan.co/*
// @include http*://8ch.net/*
// @include http*://lainchan.org/*
// @include http*://lainchan.jp/*
// @include http*://*meguca.org/*
// @include http://localhost/*
// @require https://cdnjs.cloudflare.com/ajax/libs/Chart.js/1.0.1-beta.4/Chart.min.js
// @updateURL https://raw.github.com/Dogman8/CatChan/master/CatChan.meta.js
// @grant unsafeWindow
// @grant GM_xmlhttpRequest
// ==/UserScript==
//
//    Copyright 2014 DogMan8
//
//    This program is free software: you can redistribute it and/or modify
//    it under the terms of the GNU Affero General Public License as published by
//    the Free Software Foundation, version 3 of the License.
//
//    This program is distributed in the hope that it will be useful,
//    but WITHOUT ANY WARRANTY; without even the implied warranty of
//    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
//    GNU Affero General Public License for more details.
//
//    You should have received a copy of the GNU Affero General Public License
//    along with this program.  If not, see <http://www.gnu.org/licenses/>.
//
!function(){function pref_default(e){for(var t={image_hover:!1,image_prefetch:!1,click:"none",click_area:"thumbnail",format:{show:{style:!0,contents:!0,layout:!0,posts:!1,fileinfo:!1,images_2nd:!0},hover:{style:!0,contents:!1,layout:!1,posts:!0,fileinfo:!0,images_2nd:!0},search:{style:!1,contents:!1,layout:!1,posts:!0,fileinfo:!0,images_2nd:!0},thumb:{resize:!1,size:"small",small:{w1:150,h1:150,w2:75,h2:75},large:{w1:250,h1:250,w2:125,h2:125},vsmall:{w1:80,h1:80,w2:40,h2:40}}},footer:{use:!0,nrtm:!0,nr:!0,rp:!0,im:!0,domain:!1,board:!0,no:!1,flag:!1,tag:!0,page:!0,design:"native",rOP:!0,iOP:!0,custom:"(ar )(U: nm/nr / )(IB)R: (lp/)(RP)(*sp)(+dp)(Ib)( /II I: IMIi)( / P: pg) (ni/nf )(ct )(cT )(bt )(bT )(pt )(pT )(pr )(dn)(bd)(no) ",custom2:"(ar )(nm/)(nr/)(IB)(lp/)(RP)(*sp)(+dp)(Ib)(/IIIMIi)(/pg) (ni/nf) (ct )(cT )(bt )(bT )(pt )(pT )(pr )(dn)(bd)(no) ",custom3:'(ar )(nm/)(nr/)(lp/)(<iB style="color:orange">RP</iB>)(<u>*sp</u>)(<span style="opacity:0.6">+dp</span>)(/<iI style="color:orange">IM</iI>)(/pg) (<u>ni/nf</u>) (ct )(cT )(bt )(bT )(pt )(pT )(pr )(dn)(bd)(no) ',ctime:!1,btime:!1,ptime:!1,rctime:!1,rbtime:!1,rptime:!1,br:!0,prate:!1,archived:!0,nd:!1,nl:!1,nf:!1,nid:!1,ns:!1,triage:!1,menu:!0,triage_str:"KILL,x,,SPC, ,",menu_str:"MENU, ▶,",nr0:!1,nr1:!1,nr1_style:"color:limegreen;font-weight:bold",nrtm0:!1,nrtm1:!1,nrtm1_style:"color:lime;font-weight:bold"},triage_hover:!0,footer_br:!0,draw_on_demand:!0,load_on_demand:!1,t2h_sel:"page",t2h_L:100,t2h_M:50,get t2h_N(){return this.t2h_num_of_posts},t2h_num_of_posts:5,save_board_list_sel:!1,board_list_sel:0,mark_new_posts:!0,auto_update:!1,auto_update_period:10,auto_update_countdown:!0,storePosts:"auto",sourceOfSP:"auto",searchAs:!0,searchAsA:!1,searchAc:{loosen:!0,max:1e3,max_threads:1e4,max_threads_at_refresh:1e4},popup:!0,colorID:!0,backlink:!0,popup_truncated:!0,popup_zIndex:100,backlink_all:!1,backlink_all_cross:!1,popup_hlt:!0,bl_ec:!1,bl_rm:!0,popup_delay:50,popdown_delay:500,popdown:"delay",popup_mMove:!0,inline_post:"inline",link_show_op:!0,link_show_cross:!0,expand_thumbnail_inline:!0,localtime:!0,expand_thumbnail_inline_all_after:!1,expand_thumbnail_initial:!1,hide_posts_without_images:!1,thumbnail:{inline:{limit_width:!0,limit_height:!1,margin_width:40,margin_height:0,webm:!0,webm_mute:!1,webm_loop:!1,ondemand:!0,ref_height:400},hover:{limit_width:!0,limit_height:!0,margin_width:40,margin_height:0,webm:!1,webm_mute:!0,webm_loop:!1,popup_delay:50,popdown_delay:500,popdown:"delay",popup_mMove:!0,popup_zIndex:101,dragfloat:!0,df_dblC:!0,df_mW:!0,df_cV:!0,zoom:!1}},popupX:{popup_delay:500,popdown_delay:500,popdown:"delay",popup_mMove:!0,popup_zIndex:101,use:!1,ID:!0,flag:!0,name:!1,anon:!1,trip:!1},open_spoiler_text:!1,open_spoiler_image:!1,merge:!1,merge_list:!1,merge_list_str:"",merge_list_obj6:null,merge_first:!0,merge_lv:!0,merge_lv_str:"",merge_lv_obj6:null,merge_auto_list:!1,merge_auto_list_lv:2,merge_auto_list_lv_add:!0,merge_op_auto:!1,merge_op_lv:2,merge_op_lv_add:!0,merge_op_auto_hop:1,merge_op_lv_inc:!0,merge_btn:!0,merge_btn_mode:"all",merge_btn_lv:2,merge_btn_lv_add:!0,lazyDraw:{merge:!0,merge_step:256,step:16},scroll_lock:!1,use_expander_always:!1,popup2:"sr",popup2_sel:"auto",popup2_sel_tolerance:10,popup2_resize:!1,popup2_resize_bw:8,popup2_resize_cw:20,popup3:{ww:"no",wn:"no",nw:"no",nn:"no",popup_delay:300,popdown_delay:500,popdown:"delay",popup_mMove:!0,popup_zIndex:100},posts_search_op:"opaque",posts_search_op_opacity:40,deleted_posts:{detect:"acc",store:"LS",merge:!0,auto_clean:!0},detect_sage:!1,page_his:!1,promiscuous:!1,hide_unwatched:!1,refresh_src:"bg",refresh_src_th:3,postMenu:!0,imagesearch:{use:!0,google:!0,iqdb:!0,saucenao:!0,whatAnime:!0,desustorage:!0,exhentai:!0},env:{disp_offset:0,disp_filler:"",popup_native:!0,expand_thumbnail_inline_native:!0,image_hover_native:!1,colorID_native:!0,backlink_native:!0,localtime_native:!0,auto_update_native:!1,event_dynamic:!1,popup_native_kill:!0,refresh_initial:!0}},n={script_prefix:"CatChan",features:{page:!0,graph:!0,setting:!0,setting2:!0,postform:!0,catalog:!0,listener:!0,uip_tracker:!0,thread_reader:!0,debug:!1,notify:{desktop:!0,sound:!0,favicon:!0},recovery:!0,domains:site0.domains_obj(!0,!0)},max_capture:576,interval_found:10,write_to_ls:!0,aggregator:"true",server:!0,load_pref:!0,load_data:!0,check_page:!1,check_post:!1,check_thread:!1,import_format:"obj",max_graph:576,scale_thread:10,auto_start:!0,prevent_redirection:!1,graph_animation:!1,autoconf:"auto",info_server:!1,info_client:!1,wafd_tb:"tb",wafd_open_spoiler:!1,show_page_fraction:!0,catalog_max_page:5,catalog_max_page_auto:!0,catalog_max_page_select:"auto",catalog_snoop_refresh:!0,catalog_auto_rollup_when_moving:!0,catalog_size_frame0_width:30,catalog_size_frame1_width:69,catalog_load_on_demand_timeout:10,catalog_2nd_images_show:!1,catalog_2nd_images_hover:!0,catalog_2nd_images_search:!0,catalog_posts_on_demand:!0,catalog_refresh_clear:!0,catalog_popdown:"delay",catalog_popup_delay:300,catalog_popdown_delay:500,catalog_popup_size_fix:!0,catalog_open_last50:"exist_watch",catalog_board_list_str:"//sample of board group\n//board_name[,nickname+board_name[+thread No.]['*'+up to X page]]..., [#Tag|##Tag]..., [!stats]\nGlobal/int/,8chan/int/,KC/int/,4chan/int/\nGlobal/b/,8chan/b/,KC/b/,4chan/b/\nv+gg,8chan/v/,8chan/gamergatehq/,4chan/v/\nInter/pol/,8chan/pol/,4chan/pol/\nJapanShoppingMall,8chan/jpck/,8chan/japan2/\ntech,meguca/g/,lain/tech/,8chan/tech/,4chan/g/,KC/t/\n",catalog_board_list_obj:null,catalog_promiscuous:!1,get catalog_board_list_sel(){return cataLog&&cataLog.embed_mode&&this[cataLog.embed_mode]?this[cataLog.embed_mode].board_list_sel:0},set catalog_board_list_sel(e){cataLog&&cataLog.embed_mode&&this[cataLog.embed_mode]&&(this[cataLog.embed_mode].board_list_sel=e)},localtime_offset:-((new Date).getTimezoneOffset()/60),catalog_footer_ignore_my_own_posts:!0,catalog_footer_tag_letters:3,catalog_no_popup_at_expanded:!0,catalog_open_in_new_tab:!0,catalog_open_where:"named",catalog_open_where_click:!0,catalog_triage_place:"topLeft",catalog_triage_hist:16,triage:{show_always:!1,popdown_delay:2e3,hide_toggle:!0,sync_ex:"bg",sync_attr:"bg",sync_watch:"bg",menu_str:'KILL,Hide,\nTIME,Hide until new replies,\nWATCH,Watch,\nUNWATCH,Unwatch,\nSTICKY,Sticky,\nUNSTICKY,Unsticky,\nSHOW,Show always,\nUNSHOW,Remove "show" mark,\nATTR,Red border,border:solid 2px red\nATTR,Red background,background:#fac2c5\nNONE,Remove style,\nUNDO,Undo,\nARC1,Take one-shot archive,\nARC,Start archiving,\nUNARC,Stop archiving,\nMERGEB,Set merge base,\nMERGE,Merge,\nMERGEOP,Merge threads in op,\nUNMERGE,Unmerge,'},catalog_triage_str:"KILL,X,,TIME,v,,WATCH,W,,UNWATCH,UW,,UNDO,U,",catalog_auto_update_countdown:!0,catalog_expand_with_hr:!1,overwrite_site2_json_str:'//{"site2":{"KC":{"time_offset":2}}} // summer time for KC.\n//{"site2":{"4chan":{"protocol":"https:"}}} // use https to 4chan.\n//{"pref":{"patch":{"rm_404_blacklist":["8chan"]}}} // 8chan sends corrupted data.\n',overwrite_site2_eval_str:"",tooltips:{help:{show:!0,popup_delay:2e3,popdown_delay:1e3},info:{show:!0,popup_delay:300,popdown_delay:500},zIndex:100},catalog:{max_threads_at_refresh:500,filter:{kwd:{use:!1,str:"",re:!1,ci:!0,match:0,sentence:!1,op:!0,post:!1,sub:!0,name:!0,trip:!1,com:!0,file:!1,meta:!1,flag:!1,id:!1,rexps:null},tag:!1,tag_ci:!1,time:!1,time_creation:!1,time_str:new Date(Date.now()-864e5).toLocaleString(),time_obj6:null,time_ago_str:"0:00",time_ago_str_sync_at_refresh:!1,desktopime_mark_str:"",time_watch:!1,time_watch_creation:!1,list_time_scroll:!0,list:!0,list_str:"",list_obj2:{},attr_list:!0,attr_list_str:"",attr_list_obj2:{},bookmark_list:!0,bookmark_list_str:"",bookmark_list_obj2:{},watch_list_str:"",watch_list_obj2:{},tag_search:{str:"",re:!1,show_nof_boards:!1,get ci(){return pref.liveTag.ci},sentence:!1,rexps:null},tag2bList:{label:"",by:"tag"},auto_list:{use:!1,str:"",obj7:null,kill:!1,watch:!0,show:!1,sticky:!1,style:!1,style_str:""},disLWKA:!0,disTWKA:!1},bookmark_list_rm404:!0,auto_load_filter:!1,auto_save_filter:!1,auto_save_filter_at_refresh:!1,tag:{ignore:12,max:12},board:{recommendation:!0,all_boards:!1,board_tags:!1,ex_list:!1,ex_list_str:"",ex_list_obj2:null,board_tags_same:!1},style_general_list:!0,style_general_list_str:"//^background:#e5ecf9\n//^border:1px solid black\n//8chan^background:#eef2ff;border:1px solid #d6daf0\n//8chan^background:#eef2ff\n//KC^background:#e0e0fc;border:1px solid #aaaacc\n//4chan^background:#ffffee;border:1px solid #f0e0d6\n",style_general_list_obj2:null,refresh:{except_bt:!0,at_switch:!0},design:"auto",catalog_json:!0,embed:!0,embed_page:!0,embed_frame:!0,embed_archive:!1,order:{reply_to_me:!0,reply:!0,watch:"dont_care",sticky:"first",ordering:0},auto_watch:!0,unmark_on_hover:!0,mimic_base_site:!0,appearance:{titleBar:{filter:!0,settings:!0,refresh:!0,num_of_pages:!0,boards_selector:!0},initial:{state:"float",width:400,height:400,left:0,top:0}},t2h_sel:"no",click:"open",popupX:{__proto__:t.popupX},footer:{__proto__:t.footer},env:Object.create(t.env),format:{thumb:{__proto__:t.format.thumb},__proto__:t.format},merge_lv:!1,__proto__:t},page:{get embed(){return pref.catalog.embed_page},infinite:!1,format:{show:{style:!1,contents:!1,layout:!1,posts:!0,fileinfo:!0,images_2nd:!0},thumb:{__proto__:t.format.thumb},__proto__:t.format},image_hover:!0,footer_br:!1,load_on_demand:!0,popupX:{__proto__:t.popupX},env:Object.create(t.env),merge_btn_mode:"list",__proto__:t},thread:{embed:!1,format:{show:{style:!1,contents:!1,layout:!1,posts:!0,fileinfo:!0,images_2nd:!0},thumb:{__proto__:t.format.thumb},__proto__:t.format},image_hover:!0,footer_br:!1,popupX:{__proto__:t.popupX},env:{auto_update_native:!0,refresh_initial:!1,__proto__:t.env},auto_update:!1,triage_hover:!1,__proto__:t},float:{click:"open",footer:{triage:!0,__proto__:t.footer},format:{thumb:{resize:!0,__proto__:t.format.thumb},fc:{resize:!1,width:240,height:350},__proto__:t.format},save_board_list_sel:!0,popup3:{__proto__:t.popup3},popupX:{__proto__:t.popupX},env:Object.create(t.env),order:{reply_to_me:!0,reply:!0,watch:"dont_care",sticky:"first",ordering:0},view:"headline",hide_unwatched:!1,refresh_src:"wl",disable_kwd_filter_at_initial:!0,__proto__:t},headline:{triage_hover:!1},common:{clear_at_manual_scan:!1,consolidated_filter:!1,consolidated_watch_list:!0,sync_watch_list:!0,sync_watch_list_delay:100,watch_list_rm404:"no",blur_404:!0},uip_tracker:{on:!1,posts:!0,deletion:!0,interval:10,adaptive:!0,highlight_str:"color:red",annotate:!0,auto_open:!1,auto_open_th:300,auto_open_kwd:"",deletion:{show:!0,link:!0,name:!0,name_str:"color:red",addName:!0,addName_str:"DELETED_",post:!1,post_str:"opacity:0.4"},sage:{detect:!0,name:!0,name_str:"color:blue",addName:!1,addName_str:"SAGE_",post:!1,post_str:"opacity:0.4",tolerance:1,patch_bug:!1,patch_bug2:!1,patch_bug2nth:8,patch_bug3:!0,annotate:!0,page:!1,patch_bug4:!0,patch_bug5:!0,annotate_page:!1}},thread_reader:{use:!0,sync:!0,triage:!0,triage_close:!0,check_num_of_children:!0,own_posts_tracker:!1,show_own_post_by:"anchor",show_reply_to_me_by:"anchor",clean_up_own_posts:!0},IDinfo:{ID:!0,flag:!0,IDFlag:!0,IDop:!0,nofIDs:!0,nofFlags:!0,auto:!0,name:!1,trip:!1,nameTrip:!1,nofNames:!0,nofTrips:!0},settings:{indexing:0},tag:{gen:!1,gen_str:""},cloudflare:{auto_reload:!0,auto_reload_time:5},scan:{max:1e4,lifetime:20,crawler:50,max_threads:1e3,crawler_adaptive:!0,crawler_idle_time_to_spawn:100,max_archive:150},notify:{sound:{notify:!1,src:"beep",beep_freq:1e3,beep_length_f:.2,beep_volume_f:1,reply_to_me:!0,reply:!0,new_thread:!0,appear:!0,supp_init:!0},desktop:{notify:!0,reply_to_me:!0,reply:!0,new_thread:!0,appear:!0,lifetime:30,show_last:!1,supp_init:!0,limit:brwsr.ff?10:30,delay:brwsr.ff?500:0},favicon:!0,title:{notify:!0,hide_zero:!0}},liveTag:{use:!0,max:12,maxstr:25,from:"post",lock_tags_in_op:!0,ci:!0,inherit_board_name:!0,lock_board_name:!0,inherit_board_tags:!0,lock_board_tags:!0,info:!0,NC:!0,style:{ex:"color:blue",exurtm:"color:cyan;font-weight:bold",exur:"color:deepskyblue;font-weight:bold",in:"color:red",inurtm:"color:yellow;font-weight:bold",inur:"color:orange;font-weight:bold",use:!0,urtm:"color:lime;font-weight:bold",ur:"color:limegreen;font-weight:bold"},pickup_interval:10,rm_404:"imm",disp_delay:{fg:500,bg:5e3},click_func:"in",click_func_bl:"pkin",watch_all:!0,lazy_each:150,lazy_delay:100,ex_list:!0,ex_list_str:"8chan:#selection\n",ex_list_obj5:null,rm_list:!0,rm_list_str:"http*\n",rm_list_obj5:null},virtualBoard:{show:!0,max:20,scan:!1,scanDelay:5,p_board:"replace",p_remove:!1,v_remove:!0,scan_domains:site0.domains_obj("none"),instant_scan:!0,search:{show:!0,str:"",re:!1,get ci(){return pref.liveTag.ci},sentence:!1,rexps:null}},tagSearch:{auto:!1,th_b:20,th_t:1},style:{sel:"fix",zIndex:1,fix:{titleBar_str:"background:#b5ccf9;border:1px solid blue;font-weight:normal",window_str:"background:#e5ecf9;color:#000000;font-weight:normal",popUp_str:"background:#e5f4f9;color:#000000;border:2px solid blue;font-weight:normal"},copy:{titleBar_str:"body",window_str:"body",popUp_str:""},post_editing:"background:#cec952 !important",post_new:"border:2px solid red",userCSS:{use:!1,str:"",sample:'.CatChan_titleBar button[name^="op"]{display:none} /* remove transparency buttons in titleBar */\n.CatChan_merged1::before{float:left;content:">";} /* levelized merge */\n.CatChan_merged2::before{float:left;content:">>";}\n.CatChan_merged3::before{float:left;content:">>>";}\n.CatChan_merged4::before{float:left;content:">>>>";}\n.CatChan_merged5::before{float:left;content:">>>>>";}\n.CatChan_merged1{border-left:10px solid red;} /* colored merge */\n.CatChan_merged2{border-left:10px solid orange;}\n.CatChan_merged2{border-left:10px solid yellow;}\n.CatChan_merged2{border-left:10px solid green;}\n.CatChan_merged3{border-left:10px solid blue;}\n.CatChan_titleBar button[name="roll_toggle"]{display:none} /* remove toggle button in titleBar */\n.CatChan_titleBar button[name="max"]{display:none} /* remove maximize button in titleBar */\n.CatChan_titleBar button[name="top"]{display:none} /* remove embed to top button in titleBar */\n.CatChan_titleBar button[name="bottom"]{display:none} /* remove embed to bottom button in titleBar */\n.CatChan_search_miss>*{opacity:inherit} /* patch for chrome in 4chan */\n'},tips:{merged1:!0,merged1_str:'merged1::before{float:left;content:">";}',merged2:!0,merged2_str:'merged2::before{float:left;content:">>";}',merged3:!0,merged3_str:'merged3::before{float:left;content:">>>";}'}},recovery:{comment:!0,interval:10,auto_clean:!0},healthIndicator:{show:!0,max:10,expand_running:!1,dont_retire_running:!0,cancel:!0},network:{cross_domain:"indirect",fetch_actively:!0,adaptive:!0,th100:5,th100_delay:500,th20:10,th20_delay:100,timeout:15,overXFO:!0,overCSPF:!0},stats:{use:!1,retain_404:!0,draw_delay:10,estimate_posts:!0,save:!0,load:!0,len_capture:1440,auto_acquisition:!0,auto_acquisition_scan:!0,auto_acquisition_scan_delay:120,auto_acquisition_all:!1,tolerant:!0,tolerance:90,patch_tm:!1},chart:{off_anime_blur:!0,window_width:400,window_height:400,instant_scan:!0,load_on_demand:!1,inst:{len:120,scale_thread:10,time_sel:1,board_sel:0,show_legend:!0,show:{np:!0,p:!1,ep:!1,nt:!1,t:!0,et:!1},clip_np:!1,clip_np_val:0,options:{bezierCurve:!1,animation:!1,pointDot:!0,pointDotRadius:4}}},archive:{load_img:!0,restore_auto:!0,clear_threads:!0,clear_files:!1,format:"auto",domain:0,board:"",src:"shown",store_auto:!1,dir_dled:null,open_local:!1,fix_inconsistency:!0,store_watched:!1,oneshot:{post:!0,tn:!0,img:!0,webm:!0,post_idb:!0,tn_idb:!0,img_idb:!0,webm_idb:!0},live:{post:!0,tn:!0,img:!1,webm:!1,post_idb:!0,tn_idb:!0,img_idb:!1,webm_idb:!1},deleted:{post:!0,tn:!0,img:!1,webm:!1,post_idb:!0,tn_idb:!0,img_idb:!1,webm_idb:!1},IDB:{auto_clean:!0,auto_clean_init:!0,prune:168,prune_flush:!1,nof_tr:10,nof_cl:20,nof_cl_max:80,auto_restore:!1,auto_restore_watch:!1,auto_restore_remove:!0,watchdog:120,redirect_404:!1,redirect_404_CSP:!1},kwd:{use:!0,str:"",re:!1,ci:!0,match:0,op:!0,post:!1,sub:!0,name:!0,trip:!1,com:!0,file:!1,meta:!1,sentence:!1,rexps:null},list:!0,list_str:"",list_obj6:null,list_inherit:!1,tar:!0,tarsize:100,sub_in_filename:!0,files_sel:0,IDB_board_sel:0,IDB_board_sel_gfunc_pre:pref4.archive.IDB_board_sel_gfunc_pre,IDB_thread_sel:0,IDB_thread_sel_gfunc_pre:pref4.archive.IDB_thread_sel_gfunc_pre,IDB_select_multiple:!0,editing_timeout:!0},threadStats:{use:!1,full:!0,retry:!1},debug_mode:{unread_count:"",parse_error:!1,site2func:"",site2func_expand:!0,pfunc:"",pfunc_expand:!0,pfunc_all:"",pfunc_all_expand:!0,pfunc_comp:"",pfunc_comp_expand_same:!0,pfunc_comp_expand_diff:!0,pfunc_comp_proto:""},test_mode:{tips:!1,num:0,num_f:0,test_str:""},patch:{delayed_invoke:{use:!1,sec:10},rm_404_blacklist:[]},pref2:{KC:{summer_time:!1},meguca:{historyAPI:!0,utilize_boards_json:!0,utilize_boards_json_domain:!0},"8chan":{utilize_boards_json:!0}},easy:{posts_ago:24,threads_ago:24,max_boards:50},easy2:{reset:!0,presets:0,time_post:24,time_op:24,basics:!0,auto_update:!1,auto_update_period:10,VB:{local:0,global:0},LTfrom:0,limits:0,virtualBoard:{show:!0,scan:!0,max:100},liveTag:{use:!1,from:"op"},catalog:{embed:!0,embed_page:!0,max_threads_at_refresh:500,auto_load_filter:!0,auto_save_filter:!0,auto_save_filter_at_refresh:!0,auto_update:!0,auto_update_period:10,filter:{time_watch:!1,time_watch_creation:!1}},page:{auto_update:!0,auto_update_period:10},thread:{embed:!1,auto_update:!0,auto_update_period:10},notify:{desktop:{notify:!0}},stats:{use:!1},scan:{max:100,max_threads:1e3},network:{fetch_actively:!1},healthIndicator:{expand_running:!1}},proto:t},r=0;r<40;r++)n.debug_mode[r]=!1;for(var r=0;r<150;r++)n.test_mode[r]=!1;return site0.pref_default2&&pref_func.pref_overwrite(n,site0.pref_default2),site0.pref_default&&pref_func.pref_overwrite(n,site0.pref_default),e&&pref_func.delete_null(n),common_func.Object_modifyDescriptor(n.style.userCSS,"sample",{writable:!1}),n}function make_port_parent(e,t){function n(e,t,n){if(pref.debug_mode[0]&&console.log(window.name+": Connecting from "+e.data),e.source==n&&new RegExp(site.nicknames.join("|")).test(e.data)||e.source==site.embed_frame_win&&"frame"===site.whereami&&e.data.indexOf("CLOSE")==-1){if(pref.debug_mode[0]&&console.log(window.name+": Connected successfully."),brwsr.ff?init_receive_port(t,n):init_receive_port(t,e.ports[0]),window.removeEventListener("message",init_func[t],!1),delete init_func[t],messages_to_send[t]){for(var r=0;r<messages_to_send[t].length&&!send_message(t,messages_to_send[t][r][0],null,messages_to_send[t][r][1]);r++);delete messages_to_send[t]}"_blank"==t&&send_message(t,["CLOSE"])}else pref.debug_mode[0]&&console.log(window.name+": FAIL.")}ports[e]&&send_message(e,["CLOSE"]),ports[e]="init",init_func[e]=function(r){n(r,e,t)},window.addEventListener("message",init_func[e],!1),pref.debug_mode[0]&&console.log(window.name+": Waiting for connection from "+e+" ...")}function make_port_child(e){if(pref.debug_mode[0]&&console.log(window.name+": Try to connect to parent..."),brwsr.ff)init_receive_port("parent",e),e.postMessage(window.name,"*");else{var t=new MessageChannel;init_receive_port("parent",t.port1),e.postMessage(window.name,"*",[t.port2])}}function init_receive_port(e,t){ports[e]=t,receive_func[e]=function(t){receive_message(t,e)},brwsr.ff?window.onmessage=receive_func[e]:(t.addEventListener("message",receive_func[e],!1),t.start())}function close_connection(e){brwsr.ff||ports[e].close(),ports[e].removeEventListener("message",receive_func[e],!1),delete receive_func[e],delete ports[e]}function send_message(e,t,n,r){if(Array.isArray(t)&&Array.isArray(t[0])&&(t=t[0],console.log("WARNING, PATCHED: send_mesage")),n&&make_port_parent(e,n),"init"===ports[e])messages_to_send[e]||(messages_to_send[e]=[]),messages_to_send[e].push([t,r]);else if(ports[e]||(e="parent"),pref.debug_mode[0]&&console.log(window.name+": Sent to "+e+": "+JSON.stringify(t).substr(0,80)),brwsr.ff?ports[e].postMessage(t,"*",r):ports[e].postMessage(t,r),"CLOSE"==t[0])return close_connection(e),!0}function receive_message_emu(e){for(;send_message_emu.length>0;)receive_message({data:send_message_emu.shift()},e||site.key)}function jump_to_time(e,t){var n=site2[e.domain].mark_newer_posts2(e.posts,t,pref.catalog.unmark_on_hover,!0),r=gGEH.marked_first_post&&e.posts[n]?gGEH.marked_first_post.time_tu<e.posts[n].time_tu?gGEH.marked_first_post:e.posts[n]:gGEH.marked_first_post||e.posts[n];if(r){var a=r.pn.offsetTop;if(!a&&pClg&&(pClg.show_catalog_delayed(),!(a=r.pn.offsetTop))){for(;n>0&&!e.posts[n].pn.parentNode;)n--;a=e.posts[n].pn.offsetTop+e.posts[n].pn.offsetHeight}scrollTo(0,a-site.header_height())}else scrollTo(0,document.body.clientHeight-window.innerHeight);gGEH.marked_first_post=r}function receive_message(e,t){pref.debug_mode[0]&&console.log(window.name+": Received from "+t+": "+e.data.toString().substr(0,80));var n=e.data,r=e.ports;if("404"===site.whereami&&"CLOSE"!==n[0])return void(received_messages_404?received_messages_404.push(e.data):received_messages_404=[e.data]);if("string"==typeof n&&(n=JSON.parse(n)),"HTTPD"==n[0])httpd.sub_funcs(n[1]);else if("IDB"==n[0]&&IDB)IDB.sub_funcs(n[1],r);else if("ARCHIVER"==n[0]&&archiver)archiver.sub_funcs(n[1],n[2]);else if("CLOSE"==n[0])close_connection(t);else if("MARK"==n[0]&&n[1]>0){if(jump_to_time(site.myself,n[1]),gGEH.time_jumped=n[1],pClg&&"thread"===pClg.mode)for(var t in pClg.threads)t!==site.key&&pClg.threads[t][1]&&jump_to_time(pClg.threads[t][16],n[1]);common_obj.thread_reader&&common_obj.thread_reader.mark_posts_from_parent(n[1])}else"OWN_POSTS"==n[0]?site2[n[1]].prep_own_posts_event_received?site2[n[1]].prep_own_posts_event_received(n[2]):site3[n[1]].own_posts=n[2]:"TRIAGE"==n[0]?catalog_obj&&null!=catalog_obj.catalog_func()&&catalog_obj.catalog_func().triage_exe_pipe(n[1]):"UIP"==n[0]?uip_tracker&&uip_tracker.annotate_from_catalog(n[1]):pref.test_mode[34]&&"ECHO"===n[0]&&setTimeout(function(){send_message(window.name?"parent":"meguca",["ECHO",n[1]])},5e3)}function close_all(){for(var e in ports)send_message(e,["CLOSE"])}function make_uip_tracker(){function e(){d=null,site2[site.nickname].uip_check(t,i)}function t(e,t){a(e,t,!0)}function n(e){0!=u.length?r():y+v>Date.now()+1e3*pref.uip_tracker.interval&&(clearTimeout(d),b=0,s())}function r(){for(var e=0;e<u.length;e++){var t=u[e],n=t[0],r=site2[site.nickname].uip_tgt_post(n);if(r){var a=document.createElement("span");if(a.innerHTML=" (<span>"+t[2]+"</span>)",t[4]&&a.childNodes[1].setAttribute("style",pref.uip_tracker.highlight_str),pref.uip_tracker.posts){var s=document.createElement("span");s.innerHTML="<span>"+t[1]+"</span>"+(t[5]&&pref.uip_tracker.deletion.show?"("+(pref.uip_tracker.deletion.link?t[5].map(function(e){return'<a href="#p'+e+'" class="quotelink">&gt;&gt;'+e+"</a>"}):t[5]).join()+")":"")+"/",t[3]&&s.childNodes[0].setAttribute("style",pref.uip_tracker.highlight_str),a.insertBefore(s,a.childNodes[1])}if(t[5]&&(pref.uip_tracker.deletion.name||pref.uip_tracker.deletion.addName||pref.uip_tracker.deletion.post))for(var o=0;o<t[5].length;o++)l({no:t[5][o]},pref.uip_tracker.deletion,!0);if(pref.uip_tracker.sage.page){var i=document.createElement("span");k[n]?(k[n].pn=i,k[n].his.length>0&&c(k[n])):k[n]={pn:i,his:[]},a.insertBefore(i,a.lastChild)}var p=site2[site.nickname].uip_post_num(r);p[p.length-1].appendChild(a),w||0!=e||(w=[a,t]),u.splice(e--,1)}}}function a(e,t,n){if(b++,200==t.status){var a=site2[site.nickname].parse_json_thread("response"in t?t.response:JSON.parse(t.responseText),n).posts,o=a.length,i=a[o-1].unique_ips||f[2],l=a[o-1].no;if(f[0]!=l||f[1]!=o||f[2]!=i){pref.debug_mode[31]&&console.log(new Date(t.date).toLocaleTimeString()+", "+l+", "+o+", "+i);for(var c={},p=0;p<a.length;p++)c[a[p].no]=null;pref.uip_tracker.auto_open&&0!=f[0]&&g(a,c,h);var d=a.length<f[1]||a[f[1]-1].no!=f[0];if(pref.uip_tracker.deletion.show||pref.uip_tracker.deletion.name||pref.uip_tracker.deletion.addName||pref.uip_tracker.deletion.post){var m=[];for(var p in h)void 0===c[p]&&(m[m.length]=p);pref.debug_mode[31]&&""!==m&&console.log("uip_deleted "+m)}f=[l,o,i,d,f[2]!=i,0!=m.length?m:null],u.push(f),b=0,h=c}r();var v=a[0]}404==t.status||v&&(v.archived||v.closed)?_():s()}function s(){pref.uip_tracker.on?(v=0!==v&&0!=b&&pref.uip_tracker.adaptive?b%8==0?v>=18e5?36e5:2*v:v:1e3*(pref.uip_tracker.interval>10?pref.uip_tracker.interval:10),d=setTimeout(e,v),y=Date.now()):_()}function o(e){if("page"!==e[0]){if("sage"===e[0])return void i({posts:e.map(function(e){return{no:e,email:"sage"}})});for(var t=w?w[1]:0!=u.length?u.splice(0,1)[0]:null,n=0;n<e.length;n+=3)u[u.length]=[e[n],e[n+1],e[n+2],!1,e[n+1]==e[n+2]||n>=3&&e[n+2]!=e[n-1],null];if(pref.uip_tracker.sage.page){for(var a={},n=0;n<u.length;n++)a[u[n][0]]=null;for(var n in k)void 0===a[n]&&u.splice(u.length-1,0,[n,"?","?",!1,!1,null])}if(t){var s=u[u.length-1];s[0]==t[0]&&s[1]==t[1]&&s[2]==t[2]||(u[u.length]=t.slice(0,3).concat(!1,s[2]!=t[2],null)),w&&w[0].parentNode.removeChild(w[0])}else f=u[u.length-1],w=!0;r()}else{var o=JSON.parse(e[1]);for(var n in o)k[n]={pn:null,his:o[n]}}}function i(e){for(var t in T)l(T[t])&&delete T[t];if(e&&e.posts){for(var t=e.posts.length-1;t>=1&&("sage"===e.posts[t].email&&void 0===x[e.posts[t].no]);t--)l(e.posts[t]);if(pref.uip_tracker.sage.patch_bug)for(var t=e.posts.length-1;t>=1;t--)if("sage"!==e.posts[t].email){if(null!==x[e.posts[t].no]&&!T[e.posts[t].no])break;pref.debug_mode[30]&&console.log("OVERDETECTION: "+e.posts[t].no),null===x[e.posts[t].no]&&l(e.posts[t],{name_str:"",addName_str:"OVERDETECTED_",post_str:"",__proto__:pref.uip_tracker.sage}),delete T[e.posts[t].no],delete x[e.posts[t].no]}if(pref.uip_tracker.sage.page&&void 0!==e.page){var n=e.posts[e.posts.length-1].no,r=p(e.page);k[n]?site2["4chan"].page_his_update(k[n].his,r)&&k[n].pn&&c(k[n]):k[n]={pn:null,his:[r]}}}}function l(e,t,n){var r=site2[site.nickname].uip_tgt_post(e.no);if(r){var a=site2[site.nickname].parse_funcs.post_html.pn_name({pn:r,__proto__:e});return t||(t=pref.uip_tracker.sage),t.name&&a.setAttribute("style",t.name_str),t.addName&&(a.textContent=t.addName_str+a.textContent),t.post&&r.setAttribute("style",t.post_str),n||(x[e.no]=null),!0}n||(T[e.no]=e)}function c(e){e.pn.textContent="/"+e.his.map(function(e){return Math.floor(e/15)+"."+e%15}).join("→")}function p(e){var t=e.split(".");return 15*parseInt(t[0],10)+parseInt(t[1],10)}function _(){m.disconnect(),d&&clearTimeout(d),uip_tracker=null}var d,u=[],f=[0,1,1],h={};e();var m=new MutationObserver(n);m.observe(site.myself.pn,{childList:!0});var g=function(){function e(e,r){for(var a=r.response,o=0;o<a.length;o++)for(var i=0;i<a[o].threads.length;i++){var l=a[o].threads[i];n[l.no]={sub:l.sub,name:l.name,com:l.com},s<l.no&&(s=l.no)}t()}function t(){var e=new RegExp(pref.uip_tracker.auto_open_kwd||".*");for(var t in r){var o=n[t];o&&t>site.no&&void 0===a[t]?((o.sub&&o.sub.search(e)!=-1||o.name&&o.name.search(e)!=-1||o.com&&o.com.search(e)!=-1)&&(window.open(site2[site.nickname].make_url4([site.nickname,site.board,t,"thread_html"])[0],"_blank"),a[t]=t),delete r[t]):(s>t||r[t]--<=0)&&delete r[t]}}var n={},r={},a={},s=site.no;return function(n,a,s){for(var o=n.length-1;o>=1&&o>=pref.uip_tracker.auto_open_th&&void 0===s[n[o].no];)o--;if(o!=n.length-1){for(var i=document.createElement("span");++o<n.length;){i.innerHTML=n[o].com;for(var l=i.getElementsByTagName("a"),c=0;c<l.length;c++){var p=l[c].textContent.match(/>>([0-9]+)$/);p&&(p=p[1],void 0===a[p]&&void 0===s[p]&&(r[p]=3))}}t(),0!=Object.keys(r).length&&http_req.get("uip_auto",[site.nickname,site.board,site.no,"catalog_json"].join(),"",e)}}}(),b=0,v=0,y=0,w=null,k={},x={},T={};return{destroy:_,annotate_from_catalog:o}}function uip_tracker_init(){null===uip_tracker&&site.features.uip_tracker&&pref.features.uip_tracker&&"thread"===site.whereami&&pref.uip_tracker.on?uip_tracker=make_uip_tracker():uip_tracker&&!pref.uip_tracker.on&&uip_tracker.destroy()}function make_thread_reader(){function e(e){e.addEventListener("click",site2[site.nickname].check_reply.remake_own_posts,!1),d&&e.addEventListener("click",d.get_my_posts_no,!1)}function t(e){e.removeEventListener("click",site2[site.nickname].check_reply.remake_own_posts,!1),d&&e.removeEventListener("click",d.get_my_posts_no,!1)}function n(e){if(u=e,e/=site2[site.nickname].parse_funcs.thread_html.time_unit,_[0]&&_[0].time<e){for(var t=1;t<_.length&&_[t].time<=e;)t++;s({target:_[t-1].pn})}else{var n=site.nickname+(site2[site.nickname+"_live"]?"_live":""),r=site2[site.nickname].wrap_to_parse.get(document,site.nickname,site.board,"thread_html",{thread:site.no,parse_funcs:site2[n].parse_funcs.thread_html})[0],a=r.posts.length;if(_[0])for(;a>0&&r.posts[a-1].time>=_[0].time;)a--;for(var t=a;t>0&&r.posts[t-1].time>e;)t--;_=r.posts.slice(t,a).concat(_)}}function r(e,t){for(var n=0;n<e.length;n++)e[n].time_tu>=u&&(_[_.length]=e[n]);_.sort(function(e,t){return e.time_tu-t.time_tu}),p[c][19][1]=(4294901760&p[c][19][1])+_.length,d&&d.update_own_posts(e,t)}function a(e){if(0!=_.length){var t=brwsr.document_body.scrollTop;t<=f||(f=t,t+=window.innerHeight,s(e,t))}}function s(e,t){for(var n;0!=_.length&&!(t&&_[0].pn.offsetTop+_[0].pn.offsetHeight>t);){n=_.shift().time*site2[site.nickname].parse_funcs.post_json.time_unit}if(n){p[c][19][1]=_.length;for(var r=0;r<_.length;r++)_[r].reply_to_me&&(p[c][19][1]+=65536);notifier.favicon.set(p),pref.thread_reader.sync&&window.opener?send_message("parent",["TRIAGE",[c,"TRACK",p[c][19][1],!1,n]]):pClg&&pClg.triage_multicast(c,"TRACK",p[c][19][1],!1,n)}}function o(e,t){pClg||catalog_obj.show_hide(null,"thread"),setTimeout(function(){pClg.triage_exe_broadcast(c,e,t,!0)},0)}function i(e,t){send_message("parent",["TRIAGE",[c,e,t,!0,site2.DEFAULT.check_reply.get_checked_time(p[c][19])]])}function l(n,r){return!n&&pref.thread_reader.own_posts_tracker&&r?(e(r),n=r):!n||pref.thread_reader.own_posts_tracker&&r||(t(n),n=null),n}var c=site.nickname+site.board+site.no,p={};p[c]=[],p[c][19]=liveTag.mems.init({domain:site.nickname,board:site.board,no:site.no}).wt;var _=[],d=function(){function e(){r=!0}function t(e,t){if(0==e.length)return void(r=!1);if(r){var n=pref.script_prefix+".own_posts."+site.board+site.no,a=JSON.parse(localStorage[n]||"[]"),s=[];if(t)for(var o=0,i=e.length-1;o<a.length;){for(;i>0&&a[o]>e[i].no;)i--;a[o]===e[i].no&&(s[s.length]=e[i]),o++}else s[0]=e[e.length-1],a[a.length]=s[0].no,localStorage[n]=JSON.stringify(a);for(var o=0;o<s.length;o++){var l=s[o].parse_funcs_html.pn_name(s[o]);"plain"===pref.thread_reader.show_own_post_by?l.parentNode.insertBefore(document.createTextNode(" (You)"),l.nextSibling):l.innerHTML=l.innerHTML+" (You)"}r=!1}for(var o=0;o<e.length;o++)site2[site.nickname].check_reply.add_you(e[o])}function n(){"post"===this.name&&e()}var r=!0;return{update_own_posts:t,get_my_posts_no:e,event_submit:n}};pref.thread_reader.own_posts_tracker?(d=d(),site.components.postform_submit||window.addEventListener("submit",d.event_submit,!1)):d=null;var u=site.myself.posts[site.myself.posts.length-1].time_tu;d&&d.update_own_posts(site.myself.posts,!0);var f=0,h=document.createElement("div"),m=site.embed_to.bottom();m.parentNode.insertBefore(h,m),h.appendChild(new Triage("WATCH,Watch,,UNWATCH,UnWatch,",{onclick:o}).pn),window.opener&&pref.thread_reader.triage&&h.appendChild(new Triage(pref.catalog_triage_str,{onclick:i}).pn),pref.notify.favicon&&window.addEventListener("scroll",a,!1);var g=l(null,site.components.postform_submit),b=l(null,site.components.postform_submit2);window.addEventListener("storage",site2[site.nickname].check_reply.remake_own_posts,!1),"4chan"===site.nickname&&function(){var e=new WeakMap;site2[site.nickname].catalog_get_native_area().addEventListener("click",function(t){var n=t.target;if("A"===n.tagName&&"embed"==n.dataset.cmd){var a=e.get(n);a?(a.parentNode?a.remove():e.get(a).remove(),e.delete(a),e.delete(n)):r.observe(n.parentNode,{childList:!0})}},!1);var t=function(e){cnst.tack_float_nSblgs(e,null,!0)},n=function(e){var t=cnst.tack_dock_nSblgs(e,!0)
;"X"===e.target.textContent?t.tack.previousSibling.previousSibling.dispatchEvent(new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window})):(t.pn.style.float=null,t.pn.style.display=null,t.pn.style.overflow=null,t.pn.classList.remove(pref.script_prefix+"_titleBar"))},r=new MutationObserver(function(a){var s=a[0].addedNodes[0],o=site2[site.nickname].make_tack();cnst.set_tack_float(o,t,n),e.set(s.previousElementSibling,o),e.set(o,s),s.parentNode.insertBefore(o,s),r.disconnect()})}();var v=null;return(pref.IDinfo.ID||pref.IDinfo.flag)&&function(){function e(e){pref.IDinfo.ID&&i&&t(c,e,"pn_id","id","","",pref.IDinfo.nofIDs,null,null,pref.IDinfo.IDop),pref.IDinfo.flag&&l&&t(p,e,"flag","country","(",")",pref.IDinfo.nofFlags,pref.IDinfo.IDFlag&&_,"id"),pref.IDinfo.trip&&t(d,e,"pn_trip","trip","(",")",pref.IDinfo.nofTrips),pref.IDinfo.name&&t(u,e,"pn_name","name","(",")",pref.IDinfo.nofNames,pref.IDinfo.nameTrip&&f,"trip");for(var n=0;n<e.length;n++)h.add(e[n].no)}function t(e,t,a,s,o,i,l,c,p,_){var d={};if(t)for(var u=0;u<t.length;u++){var f=t[u],h=f[a];if(h){var m=f[s];n(e,m,h,d),c&&f[p]&&(void 0==c[m]&&(c[m]={}),c[m][f[p]]=null)}}else for(var u in e)d[u]=0;r(e,d,o,i,l,c,_)}function n(e,t,n,r){var a={pn:n,c:Object.keys(e).length+(e[t]?0:1)};e[t]?e[t].push(a):(a.m=!0,e[t]=[a]),void 0===r[t]&&(r[t]=e[t].length-1)}function r(e,t,n,r,a,s,i){for(var l in t)for(var c=s&&s[l]&&Object.keys(s[l]).length||0,p=i&&o===l?"OP:":"",_=e[l],d=0;d<_.length;d++){var u=(n||"")+p+(d+1)+"/"+_.length+(c?"/"+c:"")+(a?"/":r);if(d<t[l])_[d].pn.textContent=u;else{var f=document.createElement("span");f.innerHTML=u+(a?"<span"+(_[d].m?' style="color:red"':"")+">"+_[d].c+"</span>"+r:""),_[d].pn=_[d].pn.parentNode.insertBefore(f,_[d].pn.nextSibling).firstChild}}}function a(t,n){i&&pref.IDinfo.ID^"IDinfo.ID"===n&&s(c),l&&pref.IDinfo.flag^"IDinfo.flag"===n&&s(p,!0),pref.IDinfo.name^"IDinfo.name"===n&&s(u,!0),pref.IDinfo.trip^"IDinfo.trip"===n&&s(d,!0),e(null)}function s(e,t){for(var n in e)for(var r=0;r<e[n].length;r++){var a=e[n][r].pn.parentNode;e[n][r].pn=a.previousSibling,a.parentNode.removeChild(a)}}var o=site.myself.parse_funcs.id(site.myself),i=!pref.IDinfo.auto||o,l=!pref.IDinfo.auto||site.myself.posts[0].flag;if(i||l||pref.IDinfo.trip||pref.IDinfo.name){var c={},p={},_={},d={},u={},f={},h=new Set;e(site.myself.posts);var m=site2.DEFAULT.wrap_to_parse.prep_pfunc(site.nickname,site.board,"post_html"),g=new MutationObserver(function(t){for(var n=[],r=0;r<t.length;r++)if(t[r].addedNodes)for(var a=0;a<t[r].addedNodes.length;a++){var s={pn:t[r].addedNodes[a],__proto__:m};h.has(s.no)||(n[n.length]=s)}n.length>0&&e(n)});v={observe:function(){g.observe(site.myself.pn,{childList:!0})},disconnect:function(){g.disconnect()}},v.observe(),pref_func.settings.onchange_funcs["IDinfo.*w/"]=a}}(),{destroy:function(){return pref_func.tooltips.remove_root(h),v&&v.disconnect(),window.removeEventListener("storage",site2[site.nickname].check_reply.remake_own_posts,!1),g&&t(g),b&&t(b),null},setup_submit2:function(){b=l(b,site.components.postform_submit2)},own_posts_tracker:d,updated:r,mark_posts_from_parent:n,observer_IDinfo:v}}function thread_reader_init(){null===common_obj.thread_reader&&site.features.thread_reader&&pref.features.thread_reader&&"thread"===site.whereami&&pref.thread_reader.use?common_obj.thread_reader=make_thread_reader():!pref.thread_reader.use&&common_obj.thread_reader&&(common_obj.thread_reader=common_obj.thread_reader.destroy())}function make_catalog_obj(e){function t(e,t){null===c?(t&&n(t),c=r()):pref.test_mode[114]?c=c.destroy():c.make_watcher()}function n(e){a=pref.catalog.embed&&"catalog"===site.whereami||pref.catalog.embed_archive&&"archive"===site.whereami,s=pref.catalog.embed_page&&"page"===site.whereami,o=pref.catalog.embed_frame&&"frame"===site.whereami,i=a?"catalog":s?"page":!pref.thread.embed&&"thread"!==e||"thread"!==site.whereami?"float":"thread",l="float"!==i,cataLog.embed_mode=i}function r(){function e(e){cataLog.gClg=gClg=pClg=e,e.threads=re,Object.defineProperty(pClg,"idxs",{get:function(){return ae},set:function(e){ae=e}}),cataLog.get_ref_height=pClg.get_ref_height,Q.prototype.AllThreads=pClg.threads;for(var t in re)delete re[t][1];for(;0!=e.idxs.length;)e.idxs.shift();e.onchange_funcs["*.board_list_sel"](null,!0,!0)}function n(e){cnst.tack_float_nSblgs(e,!0),e.currentTarget.previousSibling.style.display="none"}function r(e){cnst.tack_dock_e2tack(e).previousSibling.style.display=null,cnst.tack_dock_nSblgs(e)}function a(){var e={};if(pref.catalog.auto_save_filter)for(var t=0;t<gClg.Clgs.length;t++){var n=gClg.Clgs[t];if("thread"!==n.mode){var r=n.pref[n.mode].board_list_sel;void 0===e[r]&&(n.onchange_funcs.save(),e[r]=null)}}window.removeEventListener("beforeunload",a,!1)}function s(){se=l?site2[site.nickname].catalog_get_native_area():$,cataLog.parent=se,pClg.ppn=se,pClg.pppn=pClg.ppn.parentNode}function c(e,t){var n=e[0],r=liveTag.mems.getFromName(n);(gClg.AllThreads[n][8][4]||gClg.AllThreads[n][8][0])<e[4]?gClg.UnsyncedTriages[r.key]=e:gClg.UnsyncedTriages[r.key]&&(gClg.UnsyncedTriages[r.key]=null),gClg.triage_exe_broadcast(e[0],e[1],e[2],e[3],e[4],t)}function p(e,t,n,r){return site2[e.domain].update_posts_merge_prep(t,e.pd,n===!1?t.length-1:n===-1?-1:n,!0)}function _(e,t,n,r,a,s){var o=pClg.get_watch_time_of_a_thread(e,n,r,!0);0===o&&"thread"===t&&pref.catalog.auto_watch&&e===site.key&&(o=r||n),o>0?site2.DEFAULT.check_reply.set_watch_time(s,o,e):site2.DEFAULT.check_reply.set_unwatch(s)}function d(e){""==re[e][0].style.width?(pref.catalog_expand_with_hr&&"catalog"!==i&&b(e,"shrink"),re[e][0].style.width=pref.float.format.fc.width+"px",re[e][0].style.height=pref.float.format.fc.height+"px"):(re[e][0].style.width="",re[e][0].style.height="",pref.catalog_expand_with_hr&&"catalog"!==i&&b(e,"add"))}function u(e){e.preventDefault(),e.target.href&&f(e.target.href,gGEH.get_key_recursive(e.target))}function f(e,t,n){n||(n=pClg);var r=n.threads,a=common_func.fullname2dbt(t);if(r[t][16].archiveFile)e=site2[pref.archive.open_local?site.nickname:a[0]].make_url4([site.nickname,site.board,"0","page_html"])[0];else if(null===e&&(e=site2[a[0]].make_url4(common_func.name2dbt(t))[0],"no"!==pref.catalog_open_last50)){var s=document.createElement("div");s.innerHTML=site2[a[0]].short_link(t,r[t][8][2],null,"","");for(var o=s.getElementsByTagName("a"),l=0;l<o.length;l++)if("exist"===pref.catalog_open_last50||!(786432&r[t][19][0])||parseInt(o[l].textContent,10)>(65535&r[t][19][1])){e=o[l].getAttribute("href");break}}var c=site.embed_frame_win?site.embed_frame:"named"===pref.catalog_open_where?t+(r[t][16].archiveFile?"A":""):"_blank"===pref.catalog_open_where?t+"_"+Date.now():pref.catalog_open_where,p=pref.thread.merge_auto_list?n.merge_bases.query_merged_keys(t):[t],_=pref[i].mark_new_posts?p.map(function(e){return n.get_watch_time_of_a_thread(e,r[e][8][1],null,!0)}).reduce(function(e,t){return t>e?t:e}):0,d=["MARK",_];if(site2[site.nickname].historyAPI&&site2[a[0]].historyAPI&&pref.pref2.meguca.historyAPI){if(site2[site.nickname].historyAPI_blocking)return;send_message_emu.push(d)}else{if(send_message(c,d,window.open(e,c)),pref.uip_tracker.on){var u=liveTag.mems.getFromName(t);pref.uip_tracker.sage.annotate&&(pref.uip_tracker.sage.annotate_page&&u.pgh&&send_message(c,["UIP",["page",JSON.stringify(u.pgh)]]),u.sg&&u.sg.size&&send_message(c,["UIP",["sage"].concat(Array.from(u.sg))])),pref.uip_tracker.annotate&&u.sID&&u.sID.h&&send_message(c,["UIP",u.sID.h])}if(r[t][16].archiveFile){var f=r[t][16].archiveFile;send_message(c,["ARCHIVER",["SUB_INIT","IDB"===f?{IDB:!0,domain:a[0],board:pref.test_mode[80]?a[1].slice(0,-5)+"/":a[1],no:a[2]}:{name:f.name,size:f.size,lastModified:f.lastModified,files_sel:pref.archive.files_sel}]])}}pref.catalog.auto_watch&&n.triage_multicast(t,"WATCH","",!0)}function h(){return l?brwsr.document_body.scrollTop:se.scrollTop}function m(e,t,n,r){for(var a="drawn_idx:"+e+", drawn_y:"+t+", ref_count:"+n+" ",s=0;s<r.length;s++)re[r[s]]&&!re[r[s]][1]||(a+=r[s]+", ");return a+="::: "+JSON.stringify(r)}function g(e){var t=se.childNodes.length,n=pref.script_prefix+"_hs";return e<t&&se.childNodes[e].className===n&&e++,e}function b(e,t){if("catalog"!==i){var n=re[e][0],r=pref.script_prefix+"_hs";if("add"===t&&""===n.style.width&&""===n.style.height&&(n.previousSibling&&n.previousSibling.className!==r&&n.parentNode.insertBefore(site2[site.nickname].horizontal_separator_in_index(),n),n.nextSibling&&n.nextSibling.className!==r&&n.parentNode.insertBefore(site2[site.nickname].horizontal_separator_in_index(),n.nextSibling)),"shrink"===t||"remove"===t&&""===n.style.width&&""===n.style.height||"add"===t&&(""!==n.style.width||""!==n.style.height)){var a=n.previousSibling&&n.previousSibling.className===r?n.previousSibling.previousSibling:null;!a||""===a.style.width&&""===a.style.height||n.parentNode.removeChild(n.previousSibling);var a=n.nextSibling&&n.nextSibling.className===r?n.nextSibling.nextSibling:null;!a||""===a.style.width&&""===a.style.height||n.parentNode.removeChild(n.nextSibling)}"remove"===t&&n.previousSibling&&n.previousSibling.className===r&&n.nextSibling&&n.nextSibling.className===r&&n.parentNode.removeChild(n.nextSibling)}}function v(){for(var e=Q.prototype.Clgs,t=0;t<e.length;t++)e[t].filter_changed()}function y(e,t,n,r){var a=[],s={};"boards"===site.whereami&&0==e&&pref_func.str2obj("catalog_board_list_str");var o=pref.catalog_board_list_obj[e].slice(),i=o[0].domains_for_all_boards;if(i){for(var l=0;l<i.length;l++){var c=i[l];if(!site3[c].boards)return function(e){site2[c].get_boards_json("refresh_boards_json",e,!1,W)}}for(var l=0;l<i.length;l++)if(n&&site2[i[l]].utilize_boards_json&&pref.pref2[i[l]].utilize_boards_json&&pref.pref2[i[l]].utilize_boards_json_domain)s[i[l]]=null;else for(var p in liveTag.mems[i[l]])o[o.length]=liveTag.mems[i[l]][p]}var _=pClg.prep_reserved_tags(!0,e,r);for(var d in _){for(var p=1;p<o.length&&o[p].key!==d;p++);p==o.length&&(o[o.length]=liveTag.mems.getFromName(d))}t&&(a=t.replace(/\s*\/\/.*$/gm,",").replace(/\n/g,",").replace(/,,+/g,",").replace(/^,/,"").replace(/,$/,"").split(",")),""===a[0]&&(a=[]);for(var p=0;o.length>1;){for(var l=1;l<o.length;l++){var u=o[l].key.replace(/\s/g,""),f=cnst.name2domainboardthread(u,!0),h="auto"===pref.catalog_max_page_select&&liveTag.mems[f[0]]&&liveTag.mems[f[0]][f[1]]&&liveTag.mems[f[0]][f[1]].pgs||pref.catalog_max_page;f[2]?0==p?a.push(u):o.splice(l--,1):(!o[l].max_page||p<o[l].max_page)&&p<h?a.push(u+(pref.catalog.catalog_json?"q":"p")+p):o.splice(l--,1)}p++}return{tgts:a,tgt_domains:s}}function w(e,t,n){if(pref.catalog.board.ex_list)for(var r=e.length-1;r>=0;r--){var a=pref_func.merge_obj5(e[r],pref.catalog.board.ex_list_obj2,null);a&&e.splice(r,1)}if("catalog"===pref.catalog.design||"auto"===pref.catalog.design&&"catalog"===n||"chart"===n)for(var r=e.length-1;r>=0;r--){var s=cnst.name2domainboardthread(e[r],!0);"no"===site2[s[0]].trim_list&&"chart"!==n||e[r].search(/\/[pq][0-9]*/)==-1||(e[r].search(/\/[pq]0$/)==-1||t&&s[1]==site.board&&s[0]==site.nickname&&"force_init"!==site2[s[0]].trim_list&&!pref3.stats.use?e[r].search(/\/[pq][0-9]$/)!=-1&&e.splice(r,1):e[r]=e[r].replace(/[pq]0/,pref.catalog.catalog_json||"force_init"===site2[s[0]].trim_list?"j0":"c0"))}if("page"===n&&t){if(pref.liveTag.use){for(var o={},r=0;r<e.length;r++){var s=cnst.name2domainboardthread(e[r],!0);o[s[0]+s[1]+(pref.catalog.catalog_json?"j0":"c0")]=null}for(var r in o)e[e.length]=r}e[0]&&0===e[0].search(site.nickname+site.board+"[pq]0")&&e.splice(0,1),pref[n].load_on_demand&&(pClg.drawn_idx=0)}for(var r=e.length-1;r>=0;r--){var s=common_func.name2dbt(e[r]),i=site2[s[0]].make_url4(s,"page"!==pref.catalog.design&&(0!==pref.catalog.order.ordering||"none"!==pref.liveTag.from));i?i[2]&&i[2]!==e[r]&&(e.indexOf(i[2])!=-1?e.splice(r,1):e[r]=i[2]):e.splice(r,1)}return e}function k(e){pClg.clear_threads_candidates_of_deletion(e)}function x(e,t){pClg.clear_threads(e,t)}function T(e,t,n,r){return pClg.refresh(e,t,n,r)}function C(){if((pref.notify.favicon||pref.notify.title.notify)&&notifier.favicon.set(re),pref.debug_mode[3]){var e=0;for(var t in liveTag.mems)for(var n in liveTag.mems[t])for(var r in liveTag.mems[t][n])e++;var a={};for(var s in liveTag.tags_ci)for(var o of liveTag.tags_ci[s].mems.keys())a[o.key]=null;console.log("refresh_end: tags_ci+tags: "+Object.keys(liveTag.tags_ci).length+"+"+Object.keys(liveTag.tags).length+", threads:"+e+", "+Object.keys(a).length)}pref[i].load_on_demand&&ge()}function N(e,t,n,r){var a=[];if(e)for(var s=site2[site.nickname].parse_funcs.post_html.nativeUpdate2pn,o={},i=0;i<e.length;i++)if(e[i].addedNodes)for(var l=0;l<e[i].addedNodes.length;l++){var c="thread"===site.whereami?site.key:gGEH.get_key_recursive(e[i].addedNodes[l],document),p={pn:s(e[i].addedNodes[l])};o[c]?o[c][o[c].length]=p:o[c]=[p]}var _={init:n,posts_updated:n?null:o},d=oe.scan_boards_keyword_callback2(site.nickname+","+site.board+","+("thread"===site.whereami?site.no:"0")+","+site.whereami+"_html",{date:Date.now(),status:200,response:document},["native_prep",{native_prep:!0,ext_posts:a,force_annotate:r,refresh:pClg,__proto__:cataLog.scan_boards_keyword_callback2_default_args}],_);return"thread"===site.whereami&&Object.defineProperty(site,"myself",{value:d[0],writable:!0,enumerable:!0,configurable:!0}),n&&pClg.show_catalog(),d}function I(e,t,n){var r=n.posts_updated&&n.posts_updated[e.key];r&&site2[e.domain].wrap_to_parse.posts({posts:r,__proto__:e});var a="thread"===pClg.mode&&pClg.merge_bases.bases[e.key];if(a){for(var s={},o=0;o<a.lths.length;o++)if(t!==a.lths[o])for(var i=a.tgt_ths[o][16].posts,l=0;l<i.length;l++)s[i[l].key]=null;e.posts=e.posts.filter(function(e){return void 0===s[e.key]})}var c={init:n.init,posts_shown:t.pd?e.posts.slice():e.posts,posts_updated:r},p=pref[pClg.mode].deleted_posts.merge;if(t.pd&&p&&!n.init){if(site.myself&&r&&site.myself.posts.length+r.length==e.posts.length)e.posts=site.myself.posts.concat(r);else for(var o=1,l=0;o<e.posts.length&&l<t.pd.length;)e.posts[o].no==t.pd[l].no?e.posts.splice(o,1):e.posts[o].no>t.pd[l].no?l++:o++;e.nof_posts-=t.pd.length,e.nof_files-=t.pd.map(function(e){return e.tn_imgs.length}).reduce(function(e,t){return e+t})}return c}function A(e){var t=e.split(",");(pref.catalog_promiscuous||t[0]+t[1]in boards)&&oe.scan_init("snoop",[e],{lifetime:3600,crawler_max:1,tgt_raw:!0})}function B(e,t){IDB.req(e,t,null,null,E,"list_os")}function E(e,t,n){for(var r=0;r<n.length;r++)!pref.test_mode[80]&&re[e+t+n[r]]||j(e,t,n[r])}function j(e,t,n,r){IDB.req(e,t,n,null,function(e,t,n,a){archiver.event_funcs.restore3(e,t,n,a,r)},"get_all")}function S(e,t,n){if((!pref.test_mode[136]||"thread"!==i)&&pref.patch.rm_404_blacklist.indexOf(e)==-1){for(var r=Object.create(null),a=0;a<n.length;a++)r[n[a].no]=null;var s=liveTag.rm_404_list(e,t,r),o=O(e,t,r,s),l=liveTag.mems[e][t];l.LS_synced||(site2[e].clean_up_LS(e,t,o),l.LS_synced=1),pref.test_mode[65]||l.IDB_synced||!pref.archive.IDB.auto_clean_init||IDB.clean_up(e,t,o)}}function L(e,t,n){var r=(r=liveTag.mems[e])&&(r=r[t])&&r[n];r&&O(e,t,{},{no:r},n)}function O(e,t,n,r,a){for(var s=Object.create(n),o=0;o<gClg.Clgs.length;o++)D(e,t,n,s,gClg.Clgs[o],a);for(var i in r)!gClg.Remove_thread_refresh(e+t+i,r[i],null,i in s)||i in s||(s[i]=null);for(var i in r)liveTag.rm_404_1(e,t,i,i in s);if(void 0===a){var l;null!==(l=R(e,t,n,s,a,pref3.proto.merge_list_obj2,pref.proto.merge_list_str,null))&&(pref_func.settings.pnOrDummy("proto.merge_list_str").value=pref.proto.merge_list_str=l),null!==(l=R(e,t,n,s,a,pref3.proto.merge_lv_obj2,pref.proto.merge_lv_str,null))&&(pref_func.settings.pnOrDummy("proto.merge_lv_str").value=pref.proto.merge_lv_str=l)}for(var c=Object.keys(s),p=0;p<c.length;p++){var _=s[c[p]];if(_)for(var o=0;o<gClg.Clgs.length;o++)gClg.Clgs[o].threads[_]&&gClg.Clgs[o].view_attr_set(_,!0)}return s}function D(e,t,n,r,a,s,o){o||(o=pref);var i,l="no"===o.common.watch_list_rm404||"no"===o.liveTag.rm_404?"no":"unread"===o.common.watch_list_rm404||"unread"===o.liveTag.rm_404?"unread":o.liveTag.rm_404,c=a.pref.catalog.filter;null!==(i=R(e,t,n,r,s,c.watch_list_obj2,c.watch_list_str,l))&&(a.components.watch_list.value=c.watch_list_str=i,a===pClg&&o.common.consolidated_watch_list&&o.common.sync_watch_list&&gClg.Sync_watch_save([null,"PRUNED",i])),null!==(i=R(e,t,n,r,s,c.attr_list_obj2,c.attr_list_str,o.liveTag.rm_404))&&(a.components.attr_list.value=c.attr_list_str=i),null!==(i=R(e,t,n,r,s,c.list_obj2,c.list_str,o.liveTag.rm_404))&&(a.components.ex_list.value=c.list_str=i)}function R(e,t,n,r,a,s,o,i){var l=i?U:z,c=e+t,p=null,_=s[":REV"]&&s[":REV"][c];if(_)if(void 0===a)for(var d in _)d in n||(p=l(e,t,c+d,r,d,s,_,p,o,i));else void 0===n[a]&&a in _&&(p=l(e,t,c+a,r,a,s,_,p,o,i));return p&&p.replace(/,,+/g,",").replace(/^,/g,"").replace(/\n,/g,"\n").replace(/\n\n+/g,"\n").replace(/^\n/,"")}function U(e,t,n,r,a,s,o,i,l,c){var p=a in r,_=p||"imm"!==c?(_=liveTag.mems[e])&&(_=_[t])&&_[a]:null,d=p||"no"===c||"imm"!==c&&_&&_.watched&&("watched"===c||_.nr);if(d){r[a]=null;var u=_&&_.nrtm+"/"+_.nr||"?/?";if(s[n].cmd){if(void 0!==s[n].cmd.PRUNED)return i;s[n].cmd.PRUNED=u}else s[n].cmd={PRUNED:u};r[a]=n}else delete s[n],delete o[a];pref.debug_mode[2]&&console.log("rm_items_404_delete: "+n);var f=new RegExp("(^|,)"+n.replace(/\+/,"\\+")+"([\\^@;][^,\n]*)*(,|\n|$)","mg");return(i||l).replace(f,d?"$1"+n+"$2;PRUNED:"+u+"$3":",")}function z(e,t,n,r,a,s,o,i,l,c){delete s[n],delete o[a],pref.debug_mode[2]&&console.log("rm_items_404_delete_merge: "+n);var p=n.replace(/\+/,"\\+")+"([\\^@;:][^,\n]*)*";return(i||l).replace(new RegExp("(^|,)"+p+"([,\n]+\\s*\\+*|$|\\+)","mg"),"$1").replace(new RegExp("\\+\\s*"+p+"(,|\n|$|\\s*\\+)","mg"),"$2")}function M(e){var t=te.getElementsByTagName("textarea")["catalog.filter.bookmark_list_str"];t.value=H(e,t.value),pref_func.apply_prep(t,!0)}function H(e,t){var n=pref.catalog.bookmark_list_rm404?"":"//$&",r=e.split(",");return t.replace(new RegExp(r[0]+r[1]+r[2]+"(!page)*(,|\n|$)","g"),n)}function F(){var e=new Q(!1,"float",!0);if(pref.test_mode[133])for(var t in pClg.threads)q(e,t);e.GEH=new ke(e),e.show_catalog()}function q(e,t){if(!e.threads[t]){for(var n=liveTag.mems.getFromName(t),r=pClg.threads[t],a=Object.keys(r[16]),s={th:{pn:null,__proto__:n.th},__proto__:ce},o=["th","icon_sticky","icon_show_always","show_always","clg","threads"],i=0;i<a.length;i++)o.indexOf(a[i])==-1&&(s[a[i]]=r[16][a[i]]);e.threads[t]={0:!1,1:!1,9:[null,0,null,0],16:s,20:r[20],22:null,24:null,__proto__:r},e.view_attr_set(t,null,!0)}e.idx_reorder(t)}var P=function(){function e(e){pref.tooltips.info.show&&(u=this,pref_func.tooltips.req_show("info",e,t))}function t(e){var t=e&&e.target||this,n=t.name||t.getAttribute("name"),a=p[n];if(a&&(a.prog&&(a.prog_str=a.prog.IDX?a.prog.IDX+"/"+a.prog.tgts.length+", "+a.tgt:a.prog.found_threads+"/"+a.prog.scanned+", "+a.prog.found_boards+"/"+a.prog.idx+"/"+a.prog.max+", "+a.tgt),!e&&pref.healthIndicator.expand_running&&a.start&&!a.end&&t.set(null," :"+a.prog_str),u&&u.getAttribute("name")===n)){var s=!a.end&&!pref.healthIndicator.cancel,o="Initiator: "+a.initiator+"&emsp;"+(s?'<button type="button" name="'+n+'">Cancel</button>':"")+"<br>"+(a.start?"Start: "+new Date(a.start).toLocaleTimeString()+"<br>":"")+(a.prog_str?"Progress: "+a.prog_str+"<br>":"")+"Priority: "+a.priority+"<br>"+(a.start&&!a.end&&a.prog?"Crawler: "+a.prog.crawler+"<br>":"")+(a.err_str?'<span style="color:red">Errors: '+a.err_str+"</span><br>":"")+(a.abort_str?'<span style="color:red">Abort: '+a.abort_str+"</span><br>":"")+(a.end?"End: "+new Date(a.end).toLocaleTimeString()+"<br>":""),i=s?{html:o,callback:r}:o;if(e)return i;pref_func.tooltips.show_2(null,i)}}function n(e){u=null,pref.tooltips.info.show&&pref_func.tooltips.hide2()}function r(e){e.getElementsByTagName("button")[0].onclick=s}function a(){pref.healthIndicator.cancel&&s.call(this)}function s(){var e=this.getAttribute("name");p[e]&&!p[e].end&&cataLog.scan_boards.scan_abort(p[e].initiator)}function o(){for(var e=pref.healthIndicator.show?"":"none",t=0;t<l.length;t++)l[t].pn.childNodes[1].style.display=e}function i(){if(!pref.healthIndicator.expand_running)for(var e=0;e<l.length;e++)for(var t=0;t<l[e].elems.length;t++)l[e].elems[t].pn.textContent.length>1&&l[e].elems[t].set(null,"r")}var l=[],c=0,p={},_=function(e){this.pn=document.createElement("span"),this.pn_countdown=this.pn.appendChild(cnst.dom('<span style="color:limegreen"></span>')),this.pn_hi=this.pn.appendChild(document.createElement("span")),e&&(this.pn2=this.pn.cloneNode(!0),this.pn2_countdown=this.pn2.childNodes[0],this.pn2_hi=this.pn2.childNodes[1]),pref.healthIndicator.show||(this.pn.style.display="none"),l.push(this),this.elems=[]};_.prototype={shift:function(e,t,n,r){for(var a=this.elems.length-pref.healthIndicator.max;a>=0;a--)this.elems[a].remove_from_parent()&&this.elems.splice(a,1);var s=new d(e,t,n,r);return this.pn_hi.insertBefore(s.pn,this.pn_hi.firstChild),this.elems.push(s),s},destroy:function(){this.pn.parentNode.removeChild(this.pn),l.splice(l.indexOf(this),1)},countdown:function(e){this.pn_countdown.textContent=e,this.pn2&&(this.pn2_countdown.textContent=e)}};var d=function(r,s,o,i){this.pn=document.createElement("span"),this.name="healthIndicator."+c++,this.pn.setAttribute("name",this.name),this.set(r,s),this.pn.onmouseover=e,this.pn.onmouseout=n,this.pn.onclick=a,p[this.name]={initiator:o,priority:i},this.show_tooltip_delayed=new DelayBuffer(t.bind(this),100).get_binded_delayed_do()},u=null;return d.prototype={set:function(e,t){t&&(this.pn.textContent=t),e&&this.pn.setAttribute("style","color:"+e)},remove_from_parent:function(){return!(pref.healthIndicator.dont_retire_running&&!p[this.name].end)&&(delete p[this.name],this.pn.parentNode.removeChild(this.pn),this.pn===u&&n(),!0)},remove:function(){if(this.remove_from_parent())for(var e=0;e<l.length;e++){var t=l[e].elems.indexOf(this);if(t!=-1)return void l[e].elems.splice(t,1)}},report:function(e){var t=p[this.name];if(t){var n=t.prog;if(e)for(var r in e)if("err_str"===r?(t.err_str||this.set("orange"),t[r]=(t[r]?t[r]+", ":"")+e[r]):t[r]=e[r],"end"===r){n&&(t.prog_str=t.prog.IDX?n.IDX+"/"+n.tgts.length:n.found_threads+"/"+n.scanned+", "+n.found_boards+"/"+n.max,t.prog=null);var a=t.err_str&&"IDB"!==t.initiator?n&&n.SUC?"▲":"X":"●";this.set("X"===a?"red":null,a)}(u||pref.healthIndicator.expand_running)&&this.show_tooltip_delayed()}}},{HealthIndicator:_,show:o,shrink_running:i}}();cataLog.healthIndicator=P;var W=new P.HealthIndicator(!0);httpd.set_health_indicator(W);var X={mode:i,mode_fmt:"float"==i?"float":"catalog",threads:re,timestamp:"thread"===i?16:0,clean_idx:0,timestamp_set:function(){this.timestamp+=32},update_all_force:function(e,t,n,r){if(!("float"===this.mode_fmt^t.indexOf("float")!=-1)){var a=t.split(".")[2],s=this.pn_menu,o=this.pn_triage;if(n||this.compile(),"use"!==a&&"triage"!==a&&"menu"!==a||(this.add_remove_menu(a,s,o),"triage"!==a&&"menu"!==a)){if("triage_str"===a||"menu_str"===a)return void this.replace_menu(a);for(var i in this.threads)this.update_force(i,n,r,!0)}}},update_force:function(e,t,n,r){var a=this.threads[e],s=a[24];s&&a[1]&&this.insert_footer3(s,e,16,t,n,r)},update:function(e,t,n,r){var a=this.threads[e][24];a&&(this.threads[e][1]&&16&a[4]?this.insert_footer3(a,e,0,t,n):(a[4]|=(t?1:0)|(n?4:0)|8,this.clean_idx>r&&(this.clean_idx=r)))},queue_update_force:function(e){var t=this.threads[e][24];t&&(t[4]|=16)},get_clean_idx:function(){return this.realtime&&this.real_ts!==this.timestamp?(this.real_ts=this.timestamp,0):this.clean_idx},update_without_updated_data:function(){if(this.realtime){var e=this.real_ts;for(var t in this.threads){var n=this.threads[t][24];n&&this.threads[t][1]&&n[4]>=e&&this.insert_footer3(n,t,16,null,null,!0)}}},try_dirtifying_tag:function(e){var t=this.threads[e][24];if(15&t[4])return t[4]|=4,!0},test_dirty:function(e){var t=this.threads[e][24];return t&&15&t[4]&&t},draw:function(e,t){var n=e[24];n[4]!==this.timestamp&&this.insert_footer3(n,t,16)},draw_merge:function(e,t,n){var r=e[24];n||this.insert_footer3(r,t,16),r[6]=n,n&&this.insert_footer3(r,t,16)},factory:function(e,t,n){var r={threads:t,timestamp:0,mode:e,mode_fmt:"float"==e?"float":"catalog",clean_idx:0,clg:n,realtime:!1,real_ts:0,pn_menu:null,pn_triage:null,__proto__:this};return r.compile(),r},pn:document.createElement("div"),prep_flag_dom:function(e){if(e.flag&&e.flag instanceof Element)return document.importNode(e.flag);if(site2[site.nickname].post_flag2html)return this.pn.innerHTML=site2[site.nickname].post_flag2html(e),this.pn.childNodes[0]},ts_refresh:null,refresh_start:null,formatted_arr:null,get_str:null,prep_footer3:function(e,t){var n=e.footer;n.classList.add(pref.script_prefix+"_footer");var r="catalog_html"===e.type_parse&&e.parse_funcs_html.footer_prep(e,n)||null;if(pref[this.mode].footer_br){var a=n.getAttribute("style");a=(a?a+";":"")+"clear:both",n.setAttribute("style",a)}return this.add_menu(n),[n,r,null,null,6|(e.country?1:0),e.footer2?[e.footer2,null,null,null]:null]},add_remove_menu:function(e,t,n){for(var r in this.threads){var a=this.threads[r][24];a&&(!t&&this.pn_menu?this.add_menu_1(a[0]):t&&!this.pn_menu&&a[0].removeChild(a[0].lastChild),!n&&this.pn_triage?this.add_triage_1(a[0]):n&&!this.pn_triage&&a[0].removeChild(a[0].firstChild))}},add_menu:function(e){return this.pn_menu&&this.add_menu_1(e),this.pn_triage&&this.add_triage_1(e),e},replace_menu:function(e){for(var t in this.threads){var n=this.threads[t][24];n&&("menu_str"===e&&this.pn_menu&&(n[0].removeChild(n[0].lastChild),this.add_menu_1(n[0])),"triage_str"===e&&this.pn_triage&&(n[0].removeChild(n[0].firstChild),this.add_triage_1(n[0])))}},pn_menu:null,add_menu_1:function(e){e.appendChild(this.pn_menu.cloneNode(!0))},pn_triage:null,add_triage_1:function(e){e.insertBefore(this.pn_triage.cloneNode(!0),e.firstChild)},color_tag_node:function(e,t){var n=this.query_tag_node(e,t);n&&this.liveTag.color_tag_node(n,t)},query_tag_node:function(e,t){var n=this.threads[e]&&this.threads[e][24];if(n&&!this.try_dirtifying_tag(e))for(var r=n[3]&&n[3].firstChild;r;){if(r.textContent===t)return r;r=r.nextElementSibling}},remove_nullify:function(e,t){e[0].removeChild(e[t]),e[t]=null},insert_footer3:function(e,t,n,r,a,s){var o=this.threads[t],i=liveTag.mems.getFromName(t);r=r||1&e[4],a=a||4&e[4],this.draw_exe_1(e,t,r,a,o,i),e[5]&&this.draw_exe_1(e[5],t,r,a,o,i),e[6]&&e[6].footer&&(s&&e[6].lths[0]!==i||this.draw_exe_1(e[6].footer,t,null,null,e[6],e[6])),e[4]=this.timestamp+(e[4]&n)},draw_exe_1:function(e,t,n,r,a,s){var o=pref[this.mode_fmt].footer,i=o.use&&this.get_str(a,s);if(i)if(e[1])e[1].innerHTML=i;else{var l=document.createElement("span");l.innerHTML=i,e[1]=e[0].insertBefore(l,o.triage?e[0].childNodes[1]:e[0].firstChild)}else e[1]&&this.remove_nullify(e,1);if(o.tag&&o.use){if(r||!e[3]){var c=this.liveTag.create_tag_nodes(s.tags,", ",this.tag_node_onclick);e[3]=e[3]?(e[0].replaceChild(c,e[3]),c):e[0].insertBefore(c,e[2]||o.menu?e[0].lastChild:null)}}else e[3]&&this.remove_nullify(e,3);if(o.flag&&pref[this.mode].t2h_num_of_posts>=0&&o.use){if(!n&&e[2]||(n=a[16].recent_posts()),e[2]||(e[2]=e[0].insertBefore(document.createElement("span"),o.menu?e[0].lastChild:null)),n&&n.length>0){for(var p=e[2].childNodes.length-1;p>=0;p--)e[2].removeChild(e[2].firstChild);for(var p=0;p<n.length;p++)if(n[p]){var _=X.prep_flag_dom(n[p]);_&&(n[p].deleted_after&&_.classList.add("CatChan_deleted"),e[2].appendChild(_))}}}else e[2]&&this.remove_nullify(e,2);if(pref.debug_mode[32]&&e[2]){for(var d=a[16].recent_posts(),c=document.createElement("span"),p=0;p<d.length;p++)if(d[p]){var _=X.prep_flag_dom(d[p]);_&&(d[p].deleted_after&&_.classList.add("CatChan_deleted"),c.appendChild(_))}var u=[e[2],c].map(function(e){return Array.prototype.map.call(e.getElementsByClassName("flag"),function(e){return e.getAttribute("class").match(/flag\-(..)/)[1]}).toString()});u[0]!=u[1]&&console.log("Error: Flags: "+s.key+": \n"+u[0]+"\n"+u[1])}}};X.get_str=function(e){function t(e){var t=e-o,n=t<0?"-":"+",r=Math.floor(Math.abs(t)/1e3),a=r%60,s=r>=60?Math.floor(r%3600/60):0,i=r>=3600?Math.floor(r%86400/3600):0,l=r>=86400?Math.floor(r/86400)+"d":"";return n+l+(l&&i<10?"0":"")+(r>=3600?i+":":"")+(r>=3600&&s<10?"0":"")+(r>=60?s+":":"")+(r>=60&&a<10?"0":"")+a}function n(e){return i||(i=new RegExp(new Date(o).toLocaleDateString(),"g")),new Date(e).toLocaleString().replace(i,"")+" "}function r(e,t){return function(){var n=e();return n>0?'<span style="'+t+'">'+n+"</span>":n}}function a(){o=Date.now(),i=null}var s,o=Date.now(),i=null,l=null,c=null,p=null,_={pg:function(e){return e.page?function(){return l[14]||"?"}:null},nm:function(e){return e.nrtm?(s=e.nrtm0?function(){return c.watched&&c.nrtm||""}:function(){return c.watched?c.nrtm:""},e.nrtm1?r(s,pref_func.sanitize(e.nrtm1_style)):s):null},nr:function(e){return e.nr?(s=e.nr0?function(){return c.watched&&c.nr||""}:function(){return c.watched?c.nr:""},e.nr1?r(s,pref_func.sanitize(e.nr1_style)):s):null},rp:function(e){return e.rp?e.rOP?function(){return p[2]}:function(){return p[2]-1}:null},im:function(e){return e.im?e.iOP?function(){return p[3]}:function(){return p[3]>1?p[3]-1:""}:null},RP:function(e){return e.rp?e.rOP?function(){return"<b>"+p[2]+"</b>"}:function(){return"<b>"+(p[2]-1)+"</b>"}:null},IM:function(e){return e.im?e.iOP?function(){return"<b>"+p[3]+"</b>"}:function(){return p[3]>1?"<b>"+(p[3]-1)+"</b>":""}:null},lp:function(e){return e.nl?function(){return c.ta&&c.ta.posts?c.ta.posts.length:""}:null},dp:function(e){return e.nd?function(){return c.pd?c.pd.length:""}:null},ar:function(e){return e.archived?function(){var e=c.archived;return e>=8?"a":e?"A":""}:null},nf:function(e){return e.nf?function(){return c.sID&&c.sID.nc||""}:null},ni:function(e){return e.nid?function(){return c.sID&&(c.sID.nid||c.sID.np)||""}:null},ct:function(e){return e.ctime?function(){return n(p[1])}:null},cT:function(e){return e.rctime?function(){return t(p[1])}:null},bt:function(e){return e.btime?function(){return p[0]?n(p[0]):""}:null},bT:function(e){return e.rbtime?function(){return p[0]?t(p[0]):""}:null},pt:function(e){return e.ptime?function(){return p[4]?n(p[4]):""}:null},pT:function(e){return e.rptime?function(){return p[4]?t(p[4]):""}:null},pr:function(e){return e.prate?function(){return Math.floor(p[2]/((o-p[1])/864e5))}:null},dn:function(e){return e.domain?function(){return c.domain}:null},bd:function(e){return e.board?function(){return c.board}:null},no:function(e){return e.no?function(){return c.no}:null},sp:function(e){return e.ns?function(){return c.sg?c.sg.size:""}:null},IB:function(e){return function(){return c.th&&c.th.bumplimit?"<i>":""}},Ib:function(e){return function(){return c.th&&c.th.bumplimit?"</i>":""}},II:function(e){return function(){return c.th&&c.th.imagelimit?"<i>":""}},Ii:function(e){return function(){return c.th&&c.th.imagelimit?"</i>":""}},"<iB":function(e){return function(){return c.th&&c.th.bumplimit?"<i":""}},"</iB":function(e){return function(){return c.th&&c.th.bumplimit?"</i":""}},"<iI":function(e){return function(){return c.th&&c.th.imagelimit?"<i":""}},"</iI":function(e){return function(){return c.th&&c.th.imagelimit?"</i":""}},wrap:function(e,t,n){var r=t();return""!==r?e+r+n:""},concat:function(e){for(var t="",n=1;n<e.length-1;n+=2){var r=e[n]();""!==r&&(t+=r+e[n+1])}return""!==t?e[0]+t:""},const:function(e){return function(){return e}}},d={native:"(ar )(U: nm/nr / )(IB)R: (lp/)(RP)(*sp)(+dp)(Ib)( /II I: IMIi)( / P: pg) (ni/nf )(ct )(cT )(bt )(bT )(pt )(pT )(pr )(dn)(bd)(no) ",condensed:"(ar )(nm/)(nr/)(lp/)(rp)(*sp)(+dp)(/im)(/pg) (ni/nf )(ct )(cT )(bt )(bT )(pt )(pT )(pr )(dn)(bd)(no) ",meguca:"(ar )(dn)(bd)(no) (nm/)(nr/)(lp/)(rp)(*sp)(+dp)(/im)(/pg) (ni/nf )(ct )(cT )(bt )(bT )(pt )(pT )(pr ) "};return e.compile=function(){for(var e=pref[this.mode_fmt].footer,t=pref.test_mode[138]?pref_func.sanitize(d[e.design]||e[e.design]||""):d[e.design]||e[e.design]||"",n=t.split(/(\([^)]*?\))/).filter(function(e){return e}).map(function(e){return"("===e[0]?e.slice(1,-1):e
}),r=new RegExp("(ar|n[mrfio]|pg|rp|im|[lds]p|[cbp][tT]|pr|dn|bd|RP|IM|I[BbIi]|</?[bius][BI]*|</?span)"),a={},s=0,o={enumerable:!0,configurable:!0},i=0;i<n.length;i++){var l=n[i].split(r);if(l.length>=3){if(!pref.test_mode[138]&&n[i].indexOf("<")!==-1){for(var c=1;c<l.length;c+=2)if("<"===l[c][0]&&l[c].indexOf(">")===-1)for(;l[c+1].indexOf(">")===-1;)l[c+1]+=l.splice(c+2,2).join("");for(var c=l.length-2;c>=-1;c-=2){if(c>=1&&"<"===l[c][0]){if(0===(l[c]+l[c+1]).search(/^<\/?([bius][BI]*|span)(?: +style="[^&"<>\']*")?>/))continue;l[c]=pref_func.sanitize(l[c])}l[c+1]=pref_func.sanitize(l[c+1])}var p=l.filter(function(t,n){return n%2==1&&_[t]&&_[t](e)}).length}for(var c=1;c<l.length;c+=2)if(_[l[c]])l[c]=_[l[c]](e),l[c]||(l.splice(c,2),c-=2);else{var u=c-2>=0&&("<"===l[c-2][0]||"I"===l[c-2][0])||l[c-1].indexOf(">")!==-1;1==c||p<=1&&!u?(l[c-1]+=l.splice(c,2).join(""),c-=2):(l[c]=_.const(l[c]+l[c+1]),l[c+1]="")}l[1]&&Object.defineProperty(a,s++,{get:l.length>=5?_.concat.bind(null,l):l[0]||l[2]?_.wrap.bind(null,l[0],l[1],l[2]):l[1],__proto__:o})}else n[i]&&Object.defineProperty(a,s++,{value:n[i],__proto__:o})}return a.length=s,this.formatted_arr=a,this.realtime=e.prate||e.rptime||e.rbtime||e.rctime,this.real_ts=0,this.timestamp=(this.realtime?32:0)+("thread"===this.mode||pref.test_mode[131]?16:0),this.pn_menu=e.use&&e.menu?new Triage(e.menu_str,{embed:!0,child_class:"embeddedTriage"}).pn:null,this.pn_triage=e.use&&e.triage?new Triage(e.triage_str,{embed:!0,child_class:"embeddedTriage"}).pn:null,a},e.refresh_start=a,Object.defineProperty(e,"ts_refresh",{get:function(){return o},enumerable:!0,configurable:!0}),function(e,t){return l=e,c=t,p=l[8],Array.prototype.join.call(this.formatted_arr,"")}}(X),X.compile(),cataLog.Footer=X;var K=function(e,t){this.timer=null,this.time_remains=0,this.clg=e,this.indicator=t,this.timer_tgt=this.timer_tgt.bind(this),this.countdown=this.countdown.bind(this)};K.prototype={timer_tgt:function(e){this.timer=null,this.clg.refresh(!0,null,!e),this.restart()},stop_if_running:function(){this.timer&&(clearTimeout(this.timer),this.timer=null),pref.catalog_auto_update_countdown&&this.indicator.countdown("")},countdown:function(){this.indicator.countdown(this.time_remains--),this.time_remains<0?this.timer_tgt():this.timer=setTimeout(this.countdown,1e3)},set:function(){this.stop_if_running(),this.restart()},restart:function(){var e=this.clg.pref[this.clg.mode];if(e.auto_update){var t=e.auto_update_period>=1?e.auto_update_period:e.auto_update_period===-2?1/6:e.auto_update_period===-1?.25:.5;pref.catalog_auto_update_countdown?(this.time_remains=60*t,this.countdown()):this.timer=setTimeout(this.timer_tgt,6e4*t)}},manual_refresh:function(){this.timer&&clearTimeout(this.timer),this.timer_tgt(!0)}};var G={"catalog.filter.kwd.str":function(e){var t=this["."],n=t.pref.catalog.filter.kwd;n.use==!n.str&&(n.use=!n.use,t.components.kwd_use.checked=n.use);var r=t.components.kwd_mirror.indexOf(e.target);r!=-1&&(t.components.kwd_mirror[r?0:1].value=n.str),t.filter_kwd_prep(e)},"catalog.filter.list_str":function(){var e=this["."];e.filter_changed(),e.pref[e.mode].mark_new_posts&&e.view_time_filter_changed()},"catalog.filter.attr_list_str":function(){this["."].pref.catalog.filter.attr_list&&this["."].view_attr_changed()},"catalog.filter.tag_search.str":liveTag.popup_filter.oninput_funcs["catalog.filter.tag_search.str"],__proto__:pref_func.settings.oninput_funcs.__proto__},Y={refresh:function(){this["."].auto_update.manual_refresh(!0)},"*.board_list_sel":function(e,t,n){var r=this["."];if(t||(e.target.blur(),pref.catalog.auto_save_filter&&this.save(e,r.INST.board_list_sel_old),pref.catalog.refresh.at_switch&&r.clear_threads(0),r.prep_reserved_tags(!1,r.INST.board_list_sel_old)),(pref.catalog.auto_load_filter||t)&&this.load(e,t),(!t||n)&&(r.refresh(pref.catalog.refresh.at_switch,null,!1,!0),pref.archive.IDB.auto_restore)){r.format_refresh_tgts();for(var a in this.refresh_tgts)gClg.IDB_req[a]=null}r.INST.board_list_sel_old=r.pref[r.mode].board_list_sel},"float.format.fc.*w/":function(e,t){var n=this["."];if(n&&"catalog"===n.view){var r=(t.split(".").pop(),n.pref.float.format.fc),a=r.resize&&0!=r.width?r.width+"px":null,s=r.resize&&0!=r.height?r.height+"px":null;for(var o in n.threads)n.threads[o][0]&&(n.threads[o][0].style.width=a,n.threads[o][0].style.height=s)}},"catalog.order.*":"float.order.*","float.order.*":function(){this["."].idx_re_sort()},"*.auto_update":function(){this["."].auto_update.set()},"*.auto_update_period":"*.auto_update",clear_threads:function(){this["."].clear_threads(0),this["."].show_catalog()},clear_filters:function(e){this.load(e,null,!0)},load:function(e,t,n){if(localStorage||n){var r=this["."],a=r.pref.catalog.filter,s=pref_default().catalog.filter;if(delete s.tag,pref.common.consolidated_watch_list&&delete s.watch_list_str,pref_func.pref_overwrite(a,s),n&&(a.tag=!1,!r.liveTag.NC))for(var o=0;o<gClg.Clgs.length;o++)gClg.Clgs[o].liveTag.NC||(gClg.Clgs[o].components.tag_use.checked=!1)}if(localStorage&&!n)try{var i=JSON.parse(localStorage.getItem(this.load_save_key(r.pref[r.mode].board_list_sel)))||{};delete i.tag,pref.common.consolidated_watch_list&&(t&&(a.watch_list_str=localStorage.getItem(pref.script_prefix+".WatchList")||""),i.watch_list_str&&(a.watch_list_str=i.watch_list_str+"\n"+a.watch_list_str),delete i.watch_list_str),pref_func.pref_overwrite(a,i,!0)}catch(e){console.log(e)}t&&pref[r.mode].disable_kwd_filter_at_initial&&(r.pref.catalog.filter.kwd.use=!1),pref_func.apply_prep(r.components.pn_filter,!1,null,null,!0,r.pref),r.filter_kwd_prep_init(null,t),r.liveTag.filter_onchange(a.tag_search,!0,!0),t||r.view_attr_changed()},save:function(e,t){if(localStorage){var n=this["."];"number"!=typeof t&&(t=n.pref[n.mode].board_list_sel);var r=n.pref.catalog.filter,a=JSON.stringify(pref_func.obj_elim_the_same(pref_default(!0).catalog.filter,r),function(e,t){return"time_str"===e&&!r.time&&!r.time_watch&&!r.time_watch_creation&&!r.time_creation||"watch_list_str"===e&&pref.common.consolidated_watch_list?void 0:t}),s=this.load_save_key(t);s&&("{}"===a?delete localStorage[s]:localStorage.setItem(s,a)),pref.common.consolidated_watch_list&&this.save_watch_list()}},save_watch_list:function(){if(localStorage){var e=this["."],t=e.pref.catalog.filter,n=pref.script_prefix+".WatchList";""===t.watch_list_str?delete localStorage[n]:localStorage.setItem(n,t.watch_list_str)}},load_save_key:function(e){var t=pref.catalog_board_list_obj[e];return t?pref.script_prefix+(pref.common.consolidated_filter?".Filter":".catalog.filter."+t[0].key):null},"catalog.filter.kwd.*":function(){this["."].filter_kwd_active()},"catalog.filter.kwd.match":function(){this["."].filter_kwd_prep()},"catalog.filter.kwd.re":"catalog.filter.kwd.match","catalog.filter.kwd.ci":"catalog.filter.kwd.match","catalog.filter.kwd.sentence":"catalog.filter.kwd.match","catalog.filter.kwd.post":function(e){this["."].filter_kwd_active(e),e.target.checked&&"thread"!==this.mode&&(pref[cataLog.embed_mode].searchAs&&this.scanBoard(e,!0,!0),pref[cataLog.embed_mode].searchAsA&&this.scanSite(e,!0,!0))},"catalog.filter.tag":function(){var e=this["."];if(!e.liveTag.NC)for(var t=gClg.Clgs,n=e.components.tag_use.checked,r=0;r<t.length;r++)e===t[r]||t[r].liveTag.NC||(t[r].components.tag_use.checked=n);e.liveTag.filter_changed_broadcast()},"catalog.filter.time":G["catalog.filter.list_str"],"catalog.filter.time_creation":"catalog.filter.time","catalog.filter.time_str":"catalog.filter.time","catalog.filter.list":"catalog.filter.time","catalog.filter.watch_list_str":function(e,t){pref.common.consolidated_watch_list&&!t?(gClg.Sync_watch_load({newValue:this["."].pref.catalog.filter.watch_list_str},!0),this.save_watch_list()):this["catalog.filter.list_str"]()},"*.hide_unwatched":"catalog.filter.time","catalog.filter.attr_list":function(){this["."].view_attr_changed()},scanBoardIf:function(e){this.scanBoard(e,!1,!0)},scanSiteIf:function(e){this.scanSite(e,!1,!0)},scanBoard:function(e,t,n){!t&&pref.common.clear_at_manual_scan&&this.clear_threads(),scan.keyword_load_1(site.nickname,!n||2,[site.board],W)},scanSite:function(e,t,n){!t&&pref.common.clear_at_manual_scan&&this.clear_threads(),scan.keyword_load(!n||2,W)},"catalog.filter.time_quick_sel":function(e){var t=this["."].components.time_str;t.value=new Date(Date.now()-36e5*[0,0,1,2,4,12,24,72,168][e.currentTarget.selectedIndex]).toLocaleString(),pref_func.apply_prep(t,this["."].pref,!0)},"catalog.filter.tag_search.re":"catalog.filter.tag_search.str","catalog.filter.tag_search.show_nof_boards":liveTag.popup_filter.onchange_funcs["catalog.filter.tag_search.show_nof_boards"],"tagB.*":liveTag.cbx_all_onchange,tag2bList:liveTag.add_tags_to_boardlist,add_to_auto:function(e){var t=this["."],n=t.pref.catalog.filter.auto_list,r=[n.kill?"KILL":null,n.watch?"WATCH":null,n.show?"SHOW":null,n.sticky?"STICKY":null,n.style?"ATTR:"+n.style_str:null].filter(function(e){return e}).join();if(""!==t.pref.catalog.filter.kwd.str){var a=pref_func.str2obj7.o2s({cmds:r,__proto__:t.pref.catalog.filter.kwd});t.pref.catalog.filter.auto_list.str+=a+"\n",pref_func.apply_prep(t.components.auto_list,!1,null,null,!0)}},"catalog.filter.disLWKA":function(){this["."].pref.catalog.filter.kwd.active&&this["."].filter_changed()},"catalog.filter.disTWKA":"catalog.filter.disLWKA","*.view":function(e){var t=this["."];t.func_hide_all(t.threads);for(var n in t.threads)t.remake_html_prep(t.threads[n]);e.target.selectedIndex;t.drawn_idx=0,t.show_catalog()},"liveTag.NC":function(){var e=this["."],t=e.liveTag;t!==liveTag&&(t.subscribed&&t.unsubscribe(!0),e.Setup_liveTag(e.pref.liveTag.NC,!0),e.footer.update_all_force(null,"float",null,!0),e.filter_changed())},clear_pruneds:function(e){this["."].rm_items_404_clearPRUNEDs()},__proto__:G};if(pref_func.add_onchange_format(G),pref_func.add_onchange_format(Y),common_func.Object_defProps(Y,site2.DEFAULT.update_posts_merge_bases.onchange_funcs),cataLog.embed_mode=i,pref[i].open_spoiler_text&&styleSheet.open_spoiler_text(),brwsr.sw_cache&&pref.info_client&&brwsr.sw_cache.subscribe(!0),!pref.test_mode[114]){styleSheet.register_cc("headline","white-space:nowrap;text-overflow:ellipsis;overflow:hidden;width:100%");var J=site2[site.nickname].parse_funcs.headline_html.css;J&&styleSheet.register_cc("headline "+J)}var Q=function(a,s,o){this.mode=s,this.view="float"===s?pref.float.view:s,this.show_catalog_cont=new DelayBuffer(this.show_catalog_delayed.bind(this),200).get_binded_delayed_do();var i=Q.prototype.Clgs,l=0==i.length||1==i.length&&"float"!==i[0].mode;0==i.length?Object.defineProperty(this,"pref",{get:function(){return pref},enumerable:!0,configurable:!0}):this.pref={catalog:{filter:common_func.deep_copy2({},pref.catalog.filter)},liveTag:{NC:pref.liveTag.NC}},l?(Object.defineProperty(this,"order",{get:"float"===this.mode?function(){return pref.float.order}:function(){return pref.catalog.order},enumerable:!0,configurable:!0}),0!=i.length&&Object.defineProperty(this.pref,this.mode,{get:"float"===this.mode?function(){return pref.float}:function(){return pref.catalog},configurable:!0,enumerable:!0})):(this.pref.float=pref_func.pref_overwrite(pref_default().float,pref.float,!0),this.order=this.pref.float.order),this.pref[this.mode].board_list_sel=pref[this.mode].save_board_list_sel?pref[this.mode].board_list_sel:pref.catalog_board_list_sel;var c=pref.catalog.appearance.initial,p=cnst.init3({func_str:a?"tb:embed":"left:"+c.left+"px:top:"+c.top+"px:tb:width:"+c.width+"px:height:"+c.height+"px:overflow:auto:Show:bottom_top:tb_press:"+c.state,exit:pref.test_mode[114]?t:this.destroy.bind(this),maximize:this.show_catalog_cont,get auto_roll(){return pref.catalog_auto_rollup_when_moving}}).pn,_=p.childNodes[0],d=p.childNodes[1].appendChild(document.createElement("div")),u=cnst.add_to_tb(p,'<button type="button" name="filter">'+(site2[site.nickname].CONTENT_SECURITY_POLICY_DATAURI?"F":cnst.icons.img(cnst.icons.filter))+'</button><button type="button" name="settings">'+(site2[site.nickname].CONTENT_SECURITY_POLICY_DATAURI?"S":cnst.icons.img(cnst.icons.settings))+'</button><button type="button" name="refresh">'+(site2[site.nickname].CONTENT_SECURITY_POLICY_DATAURI?"R":cnst.icons.img(cnst.icons.refresh))+'</button><span name="boards_selector"><select name="'+this.mode+'.board_list_sel"></select></span>'),f=u.getElementsByTagName("select")[this.mode+".board_list_sel"];cnst.auto_shrink_board_selector.setup(f,this.pref[this.mode].board_list_sel);for(var h=["filter","settings","refresh","num_of_pages","boards_selector"],m=0;m<h.length;m++)pref.catalog.appearance.titleBar[h[m]]||(u.getElementsByTagName("*")[h[m]].style.display="none");if(this.health_indicator=o?new P.HealthIndicator:W,_.childNodes[3].appendChild(this.health_indicator.pn),!o){_.childNodes[3].appendChild(cnst.dom("<span> </span>"));var g=new P.HealthIndicator;IDB.set_indicator(g),_.childNodes[3].appendChild(g.pn)}var b=document.createElement("div");"float"===s&&b.setAttribute("class",pref.script_prefix+"_window"),b.style="margin:0px 3px; clear:both";var v=("float"===s?"float":"catalog")+".order.";b.innerHTML=pref_func.format_html_str('<div style="float:right;display:none"><div style="float:right">'+pref_func.settings.html_funcs.updates(this.mode,0,pref_func.settings.html_funcs.rollup('<ICBX"catalog_refresh_clear"> Clear latter than<br>1,<ITB4"catalog.max_threads_at_refresh">th at update<br><BTN"clear_threads,Clear all threads">'))+("float"===this.mode?pref_func.settings.html_funcs.design_of_fc(1)+"<br>":"")+("float"===this.mode?'<IC"liveTag.NC">Separated virtual board<br>':"")+("catalog"!==this.mode?'<IC"'+this.mode+'.merge">Merge all threads<br>':"")+'<IC"'+this.mode+'.merge_list">Merge threads by list<br></div><div style="float:right"><select name="'+v+'ordering"><option>Bump order</option><option>Creation date</option><option>Reply count</option><option>Image count</option><option>Last reply</option><option>Fast</option><option>/Bump order</option><option>/Creation date</option><option>/Reply count</option><option>/Image count</option><option>/Last reply</option><option>Slow</option></select><br><div>'+pref_func.settings.html_funcs.rollup_radio(v+"sticky"," :Sticky",1,"",["first:at first","last:at last","dont_care:don't care"])+'<br><IC"'+v+'reply_to_me">New reply to me at first<br><IC"'+v+'reply">New reply at first<br>'+pref_func.settings.html_funcs.rollup_radio(v+"watch"," :Watch listed",1,"",["first:at first","last:at last","dont_care:don't care"])+'<br><IC"'+this.mode+'.hide_unwatched">Watched only<br></div></div></div><div align="left" style="float:left;display:none"><div data-show3="kwd"><a name="HIDE3" style="cursor:pointer">[-]</a><span class="PLACEHOLDER" style="float:right"></span><ICBX"catalog.filter.kwd.use"> Keyword :<input type="text" name="catalog.filter.kwd.str" size="25"> <ICBX"catalog.filter.kwd.ci">CI '+pref_func.settings.html_funcs.make_sel("catalog.filter.kwd.match",["match all","match any","unmatch all","unmatch any"])+' <ICBX"catalog.filter.kwd.sentence">Sentence <ICBX"catalog.filter.kwd.re">RE<br>1,(<ICBX"catalog.filter.kwd.sub">Subject <ICBX"catalog.filter.kwd.name">Name <ICBX"catalog.filter.kwd.com">Comment <span style="display:none"><span name="HIDE4" style="cursor:pointer">◀</span><ICBX"catalog.filter.kwd.trip">Tripcode <ICBX"catalog.filter.kwd.id">ID <ICBX"catalog.filter.kwd.file">Filename <ICBX"catalog.filter.kwd.meta">No. <ICBX"catalog.filter.kwd.flag">Flag</span><span name="SHOW4" style="cursor:pointer">▶</span>) (<ICBX"catalog.filter.kwd.op">OP <ICBX"catalog.filter.kwd.post">Posts)<BTN"scanBoard,>"><BTN"scanSite,>>">'+pref_func.settings.html_funcs.rollup('<div>&emsp;&emsp;<IC"catalog.filter.disLWKA">Disable list filter when keyword filter is active<br>2,<IC"catalog.filter.disTWKA">Disable tag filter when keyword filter is active<br>1,<IC"catalog.filter.auto_list.use">Auto filter list:<br>2,<ICBX"catalog.filter.auto_list.kill">Hide <ICBX"catalog.filter.auto_list.watch">Watch <ICBX"catalog.filter.auto_list.show">Show <ICBX"catalog.filter.auto_list.sticky">Sticky <ICBX"catalog.filter.auto_list.style">Style:<ITBL25"catalog.filter.auto_list.style_str">&emsp;<BTN"add_to_auto,+"><br>2,<TA"catalog.filter.auto_list.str,40,1"></div>')+'</div><div style="clear:both" data-show3="time"><a name="HIDE3" style="cursor:pointer">[-]</a>Time: Posted/Created <ICBX"catalog.filter.time"><ICBX"catalog.filter.time_creation">Hide <ICBX"catalog.filter.time_watch"><ICBX"catalog.filter.time_watch_creation">Watch <ITBL25"catalog.filter.time_str"><select name="catalog.filter.time_quick_sel"><option>quick select...</option><option>now</option><option>1 hour ago</option><option>2 hours ago</option><option>4 hours ago</option><option>12 hours ago</option><option>1 day ago</option><option>3 days ago</option><option>1 week ago</option></select><br></div><div style="clear:both;display:none" data-show3="tag"><a name="HIDE3" style="cursor:pointer;float:left">[-]</a><span class="PLACEHOLDER" style="float:right"></span>'+liveTag.popup_filter.html+'</div><div style="clear:both;display:none" data-show3="list"><a name="HIDE3" style="cursor:pointer;float:left">[-]</a><span class="PLACEHOLDER" style="float:right"></span><div style="float:left"><input type="checkbox" name="catalog.filter.list"> Exclusive list:<br>&emsp;<textarea style="height:1em" cols="20" name="catalog.filter.list_str"></textarea></div><div style="float:left"><input type="checkbox" name="catalog.filter.attr_list"> Attribute list:<br>&emsp;<textarea style="height:1em" cols="20" name="catalog.filter.attr_list_str"></textarea></div><div style="float:left">Watch time list:<br>&emsp;<textarea style="height:1em" cols="20" name="catalog.filter.watch_list_str"></textarea></div><div style="float:left"><input type="checkbox" name="catalog.filter.bookmark_list"> Bookmark list:<br>&emsp;<textarea style="height:1em" cols="10" name="catalog.filter.bookmark_list_str"></textarea></div><div style="clear:both"></div></div><div style="clear:both;display:none" data-show3="ctrl"><a name="HIDE3" style="cursor:pointer;float:left">[-]</a><div style="float:left;width:16px"><br></div><div style="float:left"><BTN"clear_filters,clear filters"><br><BTN"load,load"><IC"catalog.auto_load_filter">Auto load filters at changing board group<br><div><div style="float:left"><BTN"save,save"></div><div style="float:left"><IC"catalog.auto_save_filter">Auto save filters at opening or changing board group<br><IC"catalog.auto_save_filter_at_refresh">Auto save filters at refresh</div></div><BTN"clear_pruneds,clear all pruned entries in all lists"><br></div></div><div style="clear:both"></div><a name="SHOW3" style="cursor:pointer;float:left;display:none" data-show3="kwd">[+ Keyword filter]</a><a name="SHOW3" style="cursor:pointer;float:left;display:none" data-show3="time">[+ Time filter]</a><a name="SHOW3" style="cursor:pointer;float:left" data-show3="tag">[+ Tag search]</a><a name="SHOW3" style="cursor:pointer;float:left" data-show3="list">[+ List filters]</a><a name="SHOW3" style="cursor:pointer;float:left" data-show3="ctrl">[+ Control]</a></div><div style="clear:both"></div>');var y=document.createElement("form");y.name=pref.script_prefix+"_float"+Q.prototype.Clgs_count,y.appendChild(b),p.childNodes[1].insertBefore(y,d);for(var w=b.getElementsByClassName("PLACEHOLDER"),m=0;m<w.length;m++)cnst.set_tack_float(w[m].appendChild(site2[site.nickname].make_tack()).parentNode,n,r);var k=u.getElementsByTagName("button");cnst.set_target_of_button(k.settings,b.childNodes[0]),cnst.set_target_of_button(k.filter,b.childNodes[1]),this.name=y.name,this.pn12=p,this.pn12_0=_,this.pn12_1=d,this.pn12_0_2=u,this.pn12_0_4=b,this.board_sel=f,this.threads={},this.ths_undo={},this.idxs=[],this.drawn_idx=0,this.threads_odl={},this.ppn=d,this.pppn=this.ppn.parentNode,this.pppn_window="float"===this.mode?this.pppn:window,gGEH.pns_resize.set(this.pn12,this.show_catalog_cont);var x=b.getElementsByTagName("*");this.components={ordering:x[("float"===this.mode?"float":"catalog")+".order.ordering"],pn12_0:_,pn12_0_4:b,pn_hi:null,kwd_use:x["catalog.filter.kwd.use"],kwd_mirror:[],time_str:x["catalog.filter.time_str"],tag_use:x["catalog.filter.tag"],attr_list:x["catalog.filter.attr_list_str"],watch_list:x["catalog.filter.watch_list_str"],ex_list:x["catalog.filter.list_str"],pn_filter:b.childNodes[1],auto_list:x["catalog.filter.auto_list.str"],merge:x[this.mode+".merge"],merge_list:x[this.mode+".merge"]},this.triage_history=[],this.INST={},this.auto_update=new K(this,this.health_indicator),this.refresh_tgts={},this.image_resize1_onload_bound=this.image_resize1_onload.bind(this),this.image_resize2_onload_bound=this.image_resize2_onload.bind(this),this.footer=0!=i.length?X.factory(this.mode,this.threads,this):(X.clg=this,X),pref_func.tooltips.add_root(b),pref_func.apply_prep(b.childNodes[0],!1,null,null,!0,this.pref),cnst.auto_shrink_selector(this.components.ordering),this.onchange_funcs={".":this,__proto__:Y},pref_func.add_onchange(u,this.onchange_funcs,G);var T=pref_func.add_onchange(b,this.onchange_funcs,G);0==i.length&&(cataLog.event_func=T),this.scrollTop=0,this.innerHeight=null,this.pppn_window.addEventListener("scroll",this.show_catalog_cont,!1),pref.test_mode[96]&&"catalog"===this.mode||this.pppn_window.addEventListener("resize",this.show_catalog_cont,!1),this.Setup_liveTag(pref.liveTag.NC),this.merge_bases=0===i.length?site2.DEFAULT.update_posts_merge_bases:site2.DEFAULT.update_posts_merge_bases.factory(),this.merge_bases.view=this.view,this.Clgs.push(this),Q.prototype.Clgs_count++,site2[site.nickname].catalog_float_prep&&site2[site.nickname].catalog_float_prep(this),2==i.length&&this.hook_set({set drawn_idx(e){this.Clgs.forEach(function(t){t.drawn_idx=e})},footer:{update:function(e,t,n,r){for(var a=Q.prototype.Clgs,s=0;s<a.length;s++)a[s].threads[e]&&a[s].footer.update(e,t,n,r)},update_force:function(e,t,n){for(var r=Q.prototype.Clgs,a=0;a<r.length;a++)r[a].threads[e]&&r[a].footer.update_force(e,t&&r[a].pref["float"===r[a].mode?"float":"catalog"].footer.flags,n)},color_tag_node:function(e,t,n){for(var r=Q.prototype.Clgs,a=0;a<r.length;a++)!n&&r[a].NC||r[a].threads[e]&&r[a].footer.color_tag_node(e,t)},update_all_force:function(e,t,n){for(var r=Q.prototype.Clgs,a=0;a<r.length;a++)r[a].footer.update_all_force(e,t,n)},__proto__:X},show_catalog:function(e){for(var t=Q.prototype.Clgs,n=0;n<t.length;n++){var r=t[n];if(e)if("string"==typeof e)r.threads[e]&&r.show_catalog(e);else{var a={},s=!1;for(var o in e)r.threads[o]&&(a[o]=null,s=!0);s&&r.show_catalog(a)}else r.show_catalog()}},filter_changed:function(){for(var e=Q.prototype.Clgs,t=0;t<e.length;t++)e[t].filter_changed()},__proto__:Q.prototype}),1===i.length&&(cataLog.auto_update=this.auto_update),"archive"!==site.whereami&&this.auto_update.set(),i.length>=2&&this.onchange_funcs["*.board_list_sel"](null,!0,!0),1!==Q.prototype.Clgs_count&&1===i.length&&e(this),this.show_catalog_scroll_lock=this.show_catalog_scroll_lock_factory(this)};Q.prototype={Clgs:[],AllThreads:null,UnsyncedTriages:{},destroy:function(e){var t=e.currentTarget.parentNode;cnst.div_destroy(e.currentTarget.parentNode,!0);var n=Q.prototype.Clgs.map(function(e){return e.pn12}).indexOf(t),r=Q.prototype.Clgs.splice(n,1)[0];pref.catalog.auto_save_filter&&r.onchange_funcs.save();for(var a in r.threads)r.remove_thread(a);r.auto_update.stop_if_running(),r.footer.liveTag=null,r.footer=null,r.liveTag=null,r.auto_update=null,r.pppn_window.removeEventListener("scroll",r.show_catalog_cont,!1),r.pppn_window.removeEventListener("resize",r.show_catalog_cont,!1),r.GEH.destroy(),1==Q.prototype.Clgs.length&&Q.prototype.hook_set(Q.prototype.Clgs[0])},hook_set:function(e){gClg=e,cataLog.Footer=e.footer,ge=e.show_catalog.bind(e),cataLog.show_catalog=ge,cataLog.gClg=gClg,1==Q.prototype.Clgs.length&&(pClg=e),Q.prototype.AllThreads=1==Q.prototype.Clgs.length?pClg.threads:common_func.shallow_copy_1(pClg.threads)},Clgs_count:0,BroadcastEventByMode:function(e,t,n){for(var r="proto"===e?this.Clgs:this.Clgs.filter(function(t){return t.mode===e}),a=0;a<r.length;a++)t.apply({".":r[a],__proto__:this.onchange_funcs},n)},onchange_funcs:Y,Setup_liveTag:function(e,t){this.liveTag=0===this.Clgs.length?(liveTag.clg=this,liveTag.footer=this.footer,liveTag):liveTag.factory(this,this.footer,e),this.liveTag.setup_pn(this.components.pn_filter,this.pref.catalog.filter.tag_search),this.footer.liveTag=this.liveTag,this.pref!==pref&&(e?t&&(delete this.pref.catalog.filter.tag,this.pref.catalog.filter.tag=!1):Object.defineProperty(this.pref.catalog.filter,"tag",{get:function(){return pref.catalog.filter.tag},set:function(e){pref.catalog.filter.tag=e},configurable:!0,enumerable:!0}),this.components.tag_use.checked=this.pref.catalog.filter.tag)},Maintain_AllThreads:function(e){if(1!=this.Clgs.length){var t=this.Clgs.filter(function(t){return t.threads[e]});if(0===t.length)delete gClg.AllThreads[e];else{var n=t[0].threads[e];if(t.length>=2)var r=t.map(function(t){return t.threads[e][16].t2h_sel||pref[i].t2h_sel}),a=r.lastIndexOf(r[0])>0;gClg.AllThreads[e]=a?{16:{t2h_sel:"ALL",__proto__:n[16]},__proto__:n}:n}}},Sync_watch_load:function(e,t,n){if(pref.common.consolidated_watch_list&&pref.common.sync_watch_list)if(e.key===pref.script_prefix+".WatchList"||t||n)for(var r=0;r<gClg.Clgs.length;r++){var a=gClg.Clgs[r];if(a.pref.catalog.filter.watch_list_str!==e.newValue){if(pref.debug_mode[37]){var s=a.pref.catalog.filter.watch_list_str.split("\n").reduce(function(e,t){return e[t]=null,e},{}),o=e.newValue.split("\n").reduce(function(e,t){return t in s?delete s[t]:e[t]=null,e},{});console.log("changed: "+Object.keys(s)+" -> "+Object.keys(o))}a.pref.catalog.filter.watch_list_str=e.newValue||"",pref_func.apply_prep(a.components.watch_list,!1,null,null,!0,a.pref),n||a.onchange_funcs["catalog.filter.watch_list_str"](null,!0)}}else if(e.key===pref.script_prefix+".WatchListCmd"){var i=JSON.parse(e.newValue);if(!i)return;if("PRUNED"===i[1])return void gClg.Sync_watch_load({newValue:i[2]},null,!0);if("string"==typeof i[1])gClg.Sync_watch_load_cmd_1(i);else for(var r=0;r<i.length;r++)gClg.Sync_watch_load_cmd_1(i[r])}},Sync_watch_load_cmd_1:function(e){if("UNWATCH"!==e[1]||gClg.AllThreads[e[0]]){var t=common_func.fullname2dbt(e[0]);liveTag.mems[t[0]]&&liveTag.mems[t[0]][t[1]]&&liveTag.mems[t[0]][t[1]][t[2]]&&gClg.AllThreads[e[0]]?c(e,!0):(e[5]=!0,gClg.triage_exe_broadcast.apply(gClg,e))}},Sync_watch_save:function(e,t){if(t)return void this.Sync_watch_save_merged.push(e);var n=0!=this.Sync_watch_save_merged.length&&this.Sync_watch_save_merged.concat([e])||e.concat(Date.now());localStorage&&localStorage.setItem(pref.script_prefix+".WatchListCmd",JSON.stringify(n)),this.Sync_watch_save_merged=[]},Sync_watch_save_merged:[],jump_to_post:function(e){var t=e[0]+e[1]+e[2],n=this.threads[t]&&this.threads[t][1]&&this.threads[t][16].posts;if(n){for(var r=n.length-1;r>=0&&n[r].no!=e[3];r--);return r>=0&&window.scrollTo(0,n[r].pn.offsetTop),n[r].pn}},image_resize:function(e,t){var n=(n=this.pref[this.mode].format.thumb,n[n.size]),r=t?n.w1:n.w2,a=t?n.h1:n.h2,s=e.naturalWidth,o=e.naturalHeight,i=s/r,l=o/a,c=i>l?i:l;e.setAttribute("width",s/c),e.setAttribute("height",o/c)},image_resize_onload_add:function(e){for(var t=0;t<e.length;t++)e[t].complete?(this.image_resize(e[t],0===t),e[t].onload&&(e[t].onload=null)):e[t].onload=0==t?this.image_resize1_onload_bound:this.image_resize2_onload_bound},image_resize_all:function(e){this.pref[this.mode].format.thumb.size=e;this.pref[this.mode].format.thumb;for(var t in this.threads)this.threads[t][0]&&this.image_resize_th(this.threads[t][0])},image_resize_th:function(e){var t=site2[site.nickname].parse_funcs[this.view+"_html"].tn_imgs({pn:e});this.image_resize_onload_add(t)},image_resize1_onload:function(e){e.currentTarget.onload=null,this.image_resize(e.target,!0)},image_resize2_onload:function(e){e.currentTarget.onload=null,this.image_resize(e.target,!1)},kwd_clear:function(){var e=pClg.components.kwd_mirror[1];e.value="",e.oninput({target:e,currentTarget:e})},kwd_init:function(e,t){var n;return 0==this.components.kwd_mirror.length?(n=e.cloneNode(!1),n.name="catalog.filter.kwd.str",n.oninput=cataLog.event_func,this.components.kwd_mirror=[t.getElementsByTagName("input")["catalog.filter.kwd.str"],n]):n=this.components.kwd_mirror[1],e.setAttribute("style","display:none"),e.parentNode.insertBefore(n,e.nextSibling),this.kwd_clear(),n},filter_kwd_prep_init:function(e,t){var n=this.pref.catalog.filter.kwd;n.str_old="",n.fail_list={},n.suc_list={},this.filter_kwd_prep(e,t)},filter_kwd_prep:function(e,t){var n=this.pref.catalog.filter.kwd;n.rexps=common_func.kwd_prep_regexp(n),this.filter_kwd_active(e,t)},filter_kwd_count:0,filter_kwd_active:function(e,t){var n=this.pref.catalog.filter.kwd,r=n.posts_active,a=n.use&&n.rexps&&(n.sub||n.name||n.com||n.file||n.meta||n.trip||n.id||n.flag);if(n.active=a&&(n.op||n.post),n.posts_active=a&&n.post,pref4.search_posts_active_once|=n.posts_active,t||n.posts_active||!r||pe.posts_search_inactivated(),n.timestamp=this.filter_kwd_count++,!pref.test_mode[59]){if(!e||"catalog.filter.kwd.str"!==e.target.name||0!==n.match||n.re&&!/^[\w\s]*$/.test(n.str+n.str_old))n.fail_list={},n.suc_list={};else{for(var s in n.fail_list)0!==n.str.indexOf(n.fail_list[s])?delete n.fail_list[s]:n.fail_list[s]===n.str&&(n.timestamp=s);for(var s in n.suc_list)0!==n.suc_list[s].indexOf(n.str)?delete n.suc_list[s]:n.suc_list[s]===n.str&&(n.timestamp=s)}n.str&&(n.fail_list[n.timestamp]=n.str,n.suc_list[n.timestamp]=n.str)}t||this.filter_changed()},format_refresh_tgts:function(){if(Array.isArray(this.refresh_tgts)){for(var e={},t=0;t<this.refresh_tgts.length;t++)e[this.refresh_tgts[t].replace(/\/[cjpqt][0-9]+$/,"/")]=null;this.refresh_tgts=e}},IDB_req:{},remake_html_prep:function(e,t){t||(e[0]=!1,e[16].th={pn:null,__proto__:e[16].lth.th},e[16].posts=null),e[16].icon_sticky&&delete e[16].icon_sticky,e[16].icon_show_always&&delete e[16].icon_show_always,e[16].pn_summary&&delete e[16].pn_summary},remove_thread:function(e,t,n){var r=this.threads[e],a=this.idxs.indexOf(e);if("ODL:"!==e.substr(0,4)){if(!r)return;var s=liveTag.mems.getFromName(e);t||s.q&&site2[s.domain].popups_release_all(s,{}),r[1]&&(r[0]&&r[0].parentNode===this.ppn&&this.func_hide(e)&&(r[1]=!1),a<this.drawn_idx&&(this.drawn_idx=0)),this.merge_bases.remove_th(e,r,this)}return t?(r[0]=!1,r[1]=!1,r[16].th=r[7],r[16].posts=null,void(r[24]&&(r[24][0]=null))):(delete this.threads[e],pref.debug_mode[2]&&console.log("removed: "+e),a=this.idxs.indexOf(e),a>=0&&this.idxs.splice(a,1),pref.test_mode[95]&&"dist"===site.nickname&&site2[site.nickname].testPoster(e),!n&&r&&gClg.Maintain_AllThreads(e),r)},get_latest_time_of_a_thread:function(e){var t=this.threads[e][8];return t[0]>t[4]?t[0]:t[4]||t[0]},clear_threads_candidates_of_deletion:function(e){if(null!==this.INST.threads_candidates_of_deletion){for(var t in this.INST.threads_candidates_of_deletion)this.threads[t]&&this.INST.threads_candidates_of_deletion[t]===this.get_latest_time_of_a_thread(t)&&this.remove_thread(t);this.INST.threads_candidates_of_deletion=null}},clear_threads:function(e,t){for(var n=0;n<this.idxs.length&&n<e;)"ODL:"===this.idxs[n++].substr(0,4)&&e++;for(t&&null===this.INST.threads_candidates_of_deletion&&(this.INST.threads_candidates_of_deletion={});this.idxs.length>e;){var r=this.idxs[e];"ODL:"!==r.substr(0,4)&&t?(this.INST.threads_candidates_of_deletion[r]=this.get_latest_time_of_a_thread(r),e++):this.remove_thread(r)}},show_catalog_scroll_lock_factory:function(e){function t(){s.cancel(),a=null}function n(){var t=a[0].offsetTop||0,n=t-a[1]+a[2];n<0&&(n=0),t&&e.get_now_height()!==n&&(window.scrollTo(0,n),i())}function r(t){if(null===a||t){if(t||(t=o.id?l:e.GEH.get_last_viewed()||l),!t)return;a=[t,t.offsetTop,e.get_now_height()],l=t}o.restart(),i()}var a=null,s=new Watchdog(n,5),o=new Watchdog(t,100),i=Watchdog.prototype.restart.bind(s),l=null;return{modified:function(t){t.pn&&a&&a[0]===t.pn?(n(),a=null,
r(site2[site.nickname].general_event_handler[site.whereami].get_mark_from_height(t.pn.offsetTop)),e.GEH.clear_last_viewed()):r()},set:r}},get_now_height:function(){return"float"!==this.mode?brwsr.document_body.scrollTop:this.ppn.scrollTop},get_ref_height:function(e){return null===this.innerHeight&&(this.scrollTop="float"===this.mode?this.pppn.scrollTop+this.pppn.offsetTop:brwsr.document_body.scrollTop,this.innerHeight="float"===this.mode?this.pppn.clientHeight:window.innerHeight),this.scrollTop+this.innerHeight*e},show_catalog_delayed:function(){this.innerHeight=null,this.drawn_idx!==!0?this.show_catalog():this.func_lazy_draw&&this.func_lazy_draw(),this===pClg&&cataLog.DIH.expand_thumbnail_on_demand_kick()}},pClg=new Q(l,i);var V=pClg.pn12,Z=pClg.pn12_0,$=pClg.pn12_1,ee=pClg.pn12_0_2,te=pClg.pn12_0_4,ne=pClg.board_sel,re=pClg.threads;X.threads=pClg.threads,cataLog.threads=re;var ae=pClg.idxs;Object.defineProperty(pClg,"idxs",{get:function(){return ae},set:function(e){ae=e}}),Object.defineProperty(pClg,"ppn",{get:function(){return se},set:function(e){se=e}}),gClg=pClg,cataLog.gClg=gClg,cataLog.get_ref_height=pClg.get_ref_height,Q.prototype.AllThreads=pClg.threads,cataLog.components=pClg.components,"thread"===i&&pref_func.pref_overwrite(pref.catalog.filter,pref_default().catalog.filter),window.addEventListener("beforeunload",a,!1),window.addEventListener("storage",site2[site.nickname].prep_own_posts_event,!1),site2[site.nickname].check_reply.make_own_posts(),pref.virtualBoard.scan&&"thread"!==i&&setTimeout(function(){scan.keyword_load(!1,W)},1e3*pref.virtualBoard.scanDelay);var se;s(),cataLog.triage_parent_set=s,pClg.onchange_funcs["*.board_list_sel"](null,!0);var oe=function(){function e(e){return!o.args[e]||(o.args[e].max!=o.args[e].idx?(o.args[e].max=o.args[e].idx,o.args[e].INDICATOR&&o.args[e].INDICATOR.report({abort_str:"canceled"})):(o.args[e].INDICATOR&&o.args[e].INDICATOR.report({abort_str:"aborted",end:Date.now()}),delete o.args[e]),!1)}function t(t,r,a,s){if(pref.debug_mode[5]&&console.log("scan_init: "+t),s||e(t,!1)){if(Array.isArray(r)||(r=Object.keys(r)),0==r.length)return void(a.callback&&a.callback(a.callback_args));n(t,r,a)}}function n(e,t,n){o.pool||(o.pool={div:document.createElement("div"),parser:new DOMParser,doc:null,ths:null,dbt:null,tgts:null,tags:{cs:{},ci:{}},name:null,sticky:null,type:null,wrapper_obj:null}),o.args[e]={key:e,idx:0,max:t.length,max_threads:pref4.scan.max_threads,found_threads:0,found_boards:0,scanned:0,crawler:0,obj:t,lifetime:0,cache_write:!1,callback:null,callback_args:null,pool:o.pool,refresh:null,indicator:null,tgt_raw:!1,watchdog:null,from_auto:null,load_on_demand:null,senders_returned:[],priority:0,tgts_iterator:null,__proto__:o.args_proto};for(var a in n)o.args[e][a]=n[a];var s=o.args[e];if(s.load_on_demand&&!s.tgts_iterator){for(var a=0;a<s.obj.length;a++){var i=r(s,a);0===common_func.name2domainboardthread(i,!0)[2].search(/[cjpq][1-9]/)&&(_e.idx_insert_odl(i),s.obj.splice(a--,1))}if(0===s.obj.length){if(s.indicator&&s.indicator.remove(),s.callback)var l=s.callback,n=s.callback_args;return delete o.args[s.key],l?l(n):void 0}be.get()&&(s.callback=s.callback?function(e){return function(){be.release(),e()}}(s.callback):be.release),s.max=s.obj.length,pClg.drawn_idx=0}o.args_proto.init_func(s),httpd.req(s,s.priority<7?s.priority+1:1)}function r(e,t){var n=e.tgts_iterator?e.tgts_iterator.next().value:e.obj[t];if(n&&"string"!=typeof n){var r=128&n.u;n=n.key}var a;return n&&(a=cnst.name2domainboardthread(n,!0)),n?e.tgt_raw?n:""===a[2]?n+(pref.catalog.catalog_json|r?"j0":"c0"):pref.catalog.catalog_json&&a[2][0].search(/[0-9]/)!=-1?a[0]+a[1]+"t"+a[2]:n:n}function a(e,t,n,r){var a=n[1],o=e.split(",");if((200==t.status||304==t.status)&&t.response&&a.found_threads<a.max_threads)if("meguca1"===o[0]&&"catalog_json"===o[3]){for(var p=0;p<t.response.length;p++)liveTag.mems.init({domain:o[0],board:o[1],no:t.response[p]}),l[o[1]+t.response[p]]={page:parseInt(p/10)+"."+p%10,refresh:a.refresh||l[o[1]+t.response[p]]&&l[o[1]+t.response[p]].refresh},scan.list_nup.add(o[0]+o[1]+t.response[p],a.priority);scan.list_nup.got_200_board(o[0]+o[1])}else{var _={};if(!pref.test_mode[133]){_=[];for(var p=0;p<gClg.Clgs.length;p++)_[p]={},gClg.Clgs[p].format_refresh_tgts()}var d="thread_html"===o[3]||"thread_json"===o[3]?{thread:o[2]}:{page:o[2]};a.localArchive&&(d.localArchive=a.localArchive,d.archiveFile=a.archiveFile,d.page=a.page);var u=site2[o[0]].wrap_to_parse.get(t.response,o[0],o[1],o[3],d);if(a.localArchive){for(var p=0;p<u.length;p++)u[p].key=u[p].key.substr(0,u[p].key.lastIndexOf("/")+1)+u[p].posts[0].no;1===u.length&&(o[2]=u[0].posts[0].no)}if(a.force_annotate)for(var p=0;p<u.length;p++)re[u[p].key]&&u[p].pn&&re[u[p].key][0]!==u[p].pn&&(re[u[p].key][0]=u[p].pn,re[u[p].key][1]=!0,insert_thread_format_th_pn(re[u[p].key],!0,!0,!0,u[p]),re[u[p].key][16].posts=u[p].posts);a.scanned+=u.length;var f=pref.catalog.filter.kwd.active,h=pref.catalog.filter.tag&&liveTag.active.in,m=a.refresh;if("meguca1"===o[0]&&"thread_json"===o[3]){var g=l[o[1]+o[2]];void 0!==g&&(m=g.refresh,u[0].page=g.page,delete l[o[1]+o[2]])}var b="post"===pref.liveTag.from||pref.stats.use||0===pref[i].deleted_posts.detect.indexOf("full")||"ALL_agg"===pref[i].storePosts||site2[o[0]].parse_funcs[o[3]].has_editing&&("page"===i||"thread"===i)||pref[i].backlink_all,v="ALL_agg"===pref[i].storePosts||"auto"===pref[i].storePosts&&pref4.search_posts_active_once?"ALL":pref[i].deleted_posts.detect;"no"===v&&"page"===i&&(v=pref[i].t2h_num_of_posts),pref[i].detect_sage&&"4chan"===o[0]&&"catalog_json"===o[3]&&site2["4chan"].sage_detect_all(u);for(var p=0;p<u.length;p++){var y=u[p];if(y.no)if(y.time_loaded=t.date,a.native_prep&&(y.native_prep=!0),pref.test_mode[33]&&"meguca1"===o[0]&&"thread_json"===o[3])scan.list_nup.got_200(y);else{var w=liveTag.prep_tags(y),k=r&&I(y,w,r);y.tags=w;var x,T=w.wt,C=gClg.AllThreads[y.key],N=!(b||2883584&T[0])&&null;if(w.ed_t&&y.parse_funcs.has_posts){var A=[];x=liveTag.update_tags_in_editing_posts(y,w,A)||x,0===A.length&&(A=null)}w.q&&w.q.waiting&&y.parse_funcs.has_posts&&site2[y.domain].popups_fetched(y,w);var E=null,j=w.archived||"no"!==v,O=s(v,C),D=w.ta&&w.ta.posts[0].missing_info,R=w.nof_posts!=y.nof_posts||D&&(!y.missing_info||y.missing_info<D);if(null!==N&&(w.nof_posts<y.nof_posts||393216&T[0])?"thread"===y.type_source||y.parse_funcs.has_posts&&y.posts.length>y.nof_posts-w.nof_posts&&(w.ta||0!==pref[i].deleted_posts.detect.indexOf("full"))||1===y.nof_posts&&y.posts[0].time>=0&&!y.parse_funcs.dont_have_com?(E=site2[y.domain].check_reply.check(y,T,C,a.ext_posts||[]),0!==E.posts.length&&(N=!0),pref[i].backlink_all&&site2[y.domain].popups_add_1_cross(y,E.posts,pref[i].backlink_all_cross),x=E.tags||x,scan.list_nup.got_200(y),pref.threadStats.use&&site2[y.domain].stats_ID&&(m||C)&&site2[y.domain].stats_ID(y,E.posts,w)&&scan.list_nup.add(y.key,0),j&&archiver.store(t,y,w,E.posts,E.time_check_old,O,A,a.localArchive)):(scan.list_nup.add(y.key,a.priority),(A||R)&&j&&archiver.store(t,y,w,void 0,void 0,O,A,!0)):(a.localArchive||scan.list_nup.got_200(y),pref.threadStats.use&&site2[y.domain].stats_ID&&(m||C)&&(site2[y.domain].stats_ID(y,null,w),pref.threadStats.retry&&pref.threadStats.full&&y.nof_posts<w.nof_posts&&"thread"===y.type_source&&scan.list_nup.add(y.key,0)),(w.rescan_dp||w.force_ar||A||R&&y.parse_funcs.has_posts)&&j&&archiver.store(t,y,w,void 0,void 0,O,A,a.localArchive),w.nof_posts!=y.nof_posts&&(w.nof_posts=y.nof_posts)),y.parse_funcs.has_editing){if(E&&"post"!==pref.liveTag.from){for(var U=void 0,z=0;z<E.posts.length;z++)E.posts[z].editing&&E.posts[z].no!=y.no&&(U?U[U.length]=E.posts[z]:U=[E.posts[z]]);U&&(w.ed_t=w.ed_t?U.concat(w.ed_t):U,pref.debug_mode[24]&&console.log(y.key+": lth.ed_t: "+w.ed_t.map(function(e){return"string"==typeof e?e:e.no+"("+e.time+")"})))}"catalog"===y.type_source&&(w.ed_p||w.ed_t)&&(w.archived||"no"!==pref[i].t2h_sel&&C)&&w.ed_u<y.replyTime&&scan.list_nup.add(y.key,a.priority)}if(!pref.test_mode[32]||"meguca1"!==o[0]||"thread_json"!==o[3]){if(w.th&&(C?w.th.missing_info&&(!y.missing_info||y.missing_info<w.th.missing_info)&&(w.th.pn&&(y.pn=w.th.pn),w.th=y):delete w.th),pref.test_mode[133]){var H="thread"===y.type_source&&"ALL_agg"===pref[i].storePosts,F=f&&ve.kwd(pref.catalog.filter.kwd,y.posts,y.domain,y),q=h&&liveTag.search_by_tags(y.tags),P=F||q,W=void 0===C?void 0:C[9][0],X=C&&(C[16].expand_posts||"thread"===y.type_source&&C[16].needs_update===!0)||w.ed_u<y.replyTime||H;if(null===N&&C&&(m||P)){var K=C[8];N=!((K[0]>K[4]?K[0]:K[4]||K[0])>=(y.time_bumped>y.time_posted?y.time_bumped:y.time_posted||y.time_bumped)&&K[2]==y.nof_posts&&K[3]==y.nof_files)||"thread"===y.type_source}if((N&&(C||pref[i].promiscuous)||(m||P)&&!C||X)&&(pref[i].scroll_lock&&pClg.show_catalog_scroll_lock.set(),pClg.insert_thread(y,t.date,F,k),this.idx_reorder(y.key),_[y.key]=!0,C=re[y.key],void 0===W)){var G=s(v,C);O!==G&&archiver.store_th_to_mem(t,y,w,G,null)}a.from_auto&&!W&&(pref.notify.desktop.notify||pref.notify.sound.notify)&&pClg.filter_test(y.key,C)&&notifier.appeared(y,void 0===W),pref.test_mode[31]||C&&(y.page&&(C[14]=y.page),gClg.footer.update(y.key,y.country&&N,void 0!==W?x:y.tags))}else for(var z=0;z<gClg.Clgs.length;z++)gClg.Clgs[z].insert_thread_1(y,w,N,x,k,m===gClg.Clgs[z]||null===gClg.Clgs[z].refresh_tgts[y.domain+y.board],a,v,t,O,_[z]);a.found_threads++,gClg.UnsyncedTriages[w.key]&&c(gClg.UnsyncedTriages[w.key])}}}if("catalog_json"!==o[3]&&"catalog_html"!==o[3]||(scan.list_nup.got_200_board(o[0]+o[1]),S(o[0],o[1],u)),pref.catalog_max_page_auto&&("page_html"===o[3]||"catalog_json"===o[3]&&site2[o[0]].parse_funcs[o[3]].get_max_page)){var Y=site2[o[0]].parse_funcs[o[3]].get_max_page(t.response);Y&&(liveTag.mems[o[0]][o[1]].pgs=Y)}if(pref[i].load_on_demand){var J=u[u.length-1];!J||"page"!==J.type_source||site2[J.domain].all_boards&&site2[J.domain].all_boards.indexOf(site.board)==-1||_e.idx_raise_odl(J)}if(a.found_boards++,pref.test_mode[133])0!==Object.keys(_).length&&(a.native_prep||ge(_));else{if(!a.native_prep)for(var p=0;p<gClg.Clgs.length;p++)(0===Object.keys(_[p]).length||gClg.Clgs[p].show_catalog(_[p]))&&m===gClg.Clgs[p]&&gClg.Clgs[p].footer.update_without_updated_data();if("mergeAuto"===a.key&&gGEH.time_jumped)for(var p=0;p<u.length;p++)jump_to_time(u[p],gGEH.time_jumped)}}else if(404!=t.status||"thread_json"!==o[3]&&"thread_html"!==o[3]||(L(o[0],o[1],o[2]),scan.list_nup.got_404(o[0]+o[1]+o[2])),a.found_threads<a.max_threads&&404==t.status&&M(e),null===t.response&&200==t.status&&(pref.debug_mode[16]&&console.log("ERROR!!! Inconsistency in server. Server returned null with status 200 for "+site2[o[0]].make_url4(o)[0]+" , "+e),t.status=-200),404==t.status&&pref.catalog_max_page_auto&&("page_json"===o[3]||"page_html"===o[3])){var Y=parseInt(o[2].replace(/^[pq]/,""),10);(!liveTag.mems[o[0]][o[1]].pgs||Y<liveTag.mems[o[0]][o[1]].pgs)&&(liveTag.mems[o[0]][o[1]].pgs=Y)}return a.refresh&&!pref.test_mode[65]&&pref.archive.IDB.auto_restore&&o[0]+o[1]in gClg.IDB_req&&("catalog_json"==o[3]||"catalog_html"===o[3]||"page_json"==o[3]||"page_html"===o[3])&&!window.opener&&(B(o[0],o[1]),delete gClg.IDB_req[o[0]+o[1]]),u}function s(e,t){var n=t&&t[16].get_t2h_num_of_posts()||"no";return"ALL"===e||"ALL"===pref[i].storePosts&&t?-1:"no"===e||"passive"===e&&"no"!==n?n:e}var o={args:{},pool:null};o.args_proto={callback_1:function(e,t,n){a(e.key2||"",t,[null,n])},get_tgt_func:function(e){if(e.IDX<e.max&&(e.refresh||e.found_threads<e.max_threads)){do{var t=r(e,e.IDX++)}while(e.IDX<e.max&&(!t||pref.catalog.board.ex_list&&pref_func.merge_obj5(t,pref.catalog.board.ex_list_obj2,null)));if(e.IDX<=e.max){var n=scan.list_nup.issued(t),a=common_func.name2dbt(t),s=site2[a[0]].make_url4(a),o=a.join(",");return{REQ:e,url:s[0],responseType:n?"text":"html"===s[1]?"document":s[1],tgt:t,key2:o,data_type:s[1],domain:a[0]}}}},callback:function(e){e.found_threads>=e.max_threads&&e.INDICATOR.report({err_str:"Aborted.(Reached upper limit)"}),delete o.args[e.key],0==Object.keys(o.args).length&&(o.pool=null),e.callback2&&e.callback2(e.callback_args)},init_func:function(e){Object.defineProperty(e,"idx",{get:function(){return this.IDX},configurable:!0}),Object.defineProperty(e,"tgts",{get:function(){return this.obj},configurable:!0}),Object.defineProperty(e,"initiator",{get:function(){return this.key},configurable:!0}),e.hasOwnProperty("callback")&&(e.callback2=e.callback,delete e.callback)}},o.args_proto.callback_1_fail=o.args_proto.callback_1,cataLog.scan_boards_keyword_callback2_default_args={refresh:pClg,found_threads:0,get max_threads(){return pref4.scan.max_threads},found_board:0,scanned:0};var l={};return cataLog.scan_boards_keyword_callback2=a,Q.prototype.insert_thread_1=function(e,t,n,r,a,o,l,c,p,_,d){var u=pref[i],f=this.pref[this.mode],h=this.threads[e.key],m="thread"===e.type_source&&"ALL_agg"===u.storePosts,g=this.pref.catalog.filter.kwd.active&&ve.kwd(this.pref.catalog.filter.kwd,e.posts,e.domain,e),b=this.pref.catalog.filter.tag&&this.liveTag.active.in&&liveTag.search_by_tags(t),v=g||b,y=void 0===h?void 0:h[9][0],w=h&&(h[16].expand_posts||"thread"===e.type_source&&h[16].needs_update===!0)||t.ed_u<e.replyTime||m;if(null===n&&h&&(o||v)){var k=h[8];n=!((k[0]>k[4]?k[0]:k[4]||k[0])>=(e.time_bumped>e.time_posted?e.time_bumped:e.time_posted||e.time_bumped)&&k[2]==e.nof_posts&&k[3]==e.nof_files)||"thread"===e.type_source}if(n&&(h||f.promiscuous)||(o||v)&&!h||w){u.scroll_lock&&this.show_catalog_scroll_lock.set(),this.insert_thread(e,p.date,g,a,"mergeUI"===l.key||"mergeAuto"===l.key);var x=this.idx_reorder(e.key);if(d[e.key]=!0,h=this.threads[e.key],void 0===gClg.AllThreads[e.key]){var T=s(c,h);_!==T&&archiver.store_th_to_mem(p,e,t,T,null),l.from_auto&&(pref.notify.desktop.notify&&pref.notify.desktop.new_thread||pref.notify.sound.notify&&pref.notify.sound.new_thread)&&this.filter_test(e.key,h)&&notifier.appeared(e,!0),gClg.AllThreads[e.key]=h}}else h&&e.key in this.ths_undo&&(x=this.idx_reorder(e.key),d[e.key]=!0);e.key in this.ths_undo&&delete this.ths_undo[e.key],pref.test_mode[31]||h&&(e.page&&(h[14]=e.page),this.footer.update(e.key,e.country&&n,void 0!==y?r:e.tags,x))},cataLog.scan_init=t,{scan_init:t,scan_abort:function(e){t(e,{},{})},scan_boards_keyword_callback2:a}}();cataLog.scan_boards=oe;var ie=(l?site2[site.nickname].catalog_get_native_scroll_area?site2[site.nickname].catalog_get_native_scroll_area():window:se.parentNode,null);Q.prototype.triage_event=function(e,t,n,r){var a="string"==typeof e?e:e.keys[0];if("GO"===t)return void this.click_thread(a,"force");if("MERGEB"===t)return void(ie=a);var s="MERGE"!==t&&"UNMERGE"!==t&&"MERGEOP"!==t;this.triage_multicast(e,t,n,s,r)},Q.prototype.triage_multicast=function(e,t,n,r,a){var s="string"==typeof e?[e]:e.keys;if("UNDO"!==t)for(var o=s.length-1;o>=1;o--)this.triage_exe_broadcast(s[o],t,n,r?"multi":r,null,null,null,!0);this.triage_exe_broadcast(s[0],t,n,r,a)},Q.prototype.triage_exe_broadcast=function(e,t,n,r,a,s,o,i){if("MERGE"===t)return this.merge_bases.add_to_list_1(ie,e,this),void le.off();if("UNMERGE"===t)return this.merge_bases.add_to_list_1(null,e,this),void le.off();if("MERGEOP"===t)return this.merge_cross_links_in_op_manually(e),void le.off();if(["ARC","ARC1","UNARC"].indexOf(t)!=-1)return void(pref.test_mode[67]||archiver.start_1(t,liveTag.mems.getFromName(e),!0));!a&&"WATCH"===t&&pref.common.consolidated_watch_list&&(a=this.threads[e]&&(this.threads[e][8][4]||this.threads[e][8][0])||gClg.AllThreads[e]&&(gClg.AllThreads[e][8][4]||gClg.AllThreads[e][8][0]));for(var l=!1,c=gClg.Clgs,p=0;p<c.length;p++){var _=1!=c.length&&this!==c[p]&&(this===gClg||(this.pref[this.mode].board_list_sel!=c[p].pref[c[p].mode].board_list_sel||0)),d=c[p].triage_exe(e,t,n,r,a,_,s);o||"TRACK"===t&&"thread"===this.mode||c[p].triage_exe_view(d.name,d),l|=d.watch}if(pref_func.tooltips.hide(),s||l&&pref.common.consolidated_watch_list&&pref.common.sync_watch_list&&gClg.Sync_watch_save([e,t,n,r,a],i),"WATCH"===t&&pref.archive.store_watched&&this.threads&&this.threads[e]){var u=liveTag.mems.getFromName(e);u.archived||archiver.start_1("ARC",u,!0)}},Q.prototype.triage_exe_view=function(e,t){this.threads[e]&&(t.attr&&this.view_attr_set(e),t.ex&&this.filter_dirtify(this.threads[e]),t.watch&&(this.idx_reorder(e),this.pref[this.mode].mark_new_posts&&this.view_time_filter_changed(e),"page"===this.view&&this.threads[e][16].check_and_expand(this.threads[e][16].posts,!0)),(t.ex||t.watch)&&this.show_catalog(e,!0,!0),le.off())},Q.prototype.triage_exe=function(e,t,n,r,a,s,o){var i=this.triage_history,l=this.components.attr_list,c=this.components.watch_list,p=this.components.ex_list,_=this.threads,d={ex:!1,attr:!1,watch:!1,name:e};if("UNDO"!==t){if(r){var u=i.length>0&&i[i.length-1];u&&"multi"===u[0][3]?(u[4].push(e),"multi"!==r&&(u[0][3]=r)):(i.length>=pref.catalog_triage_hist&&i.shift(),i.push([Array.prototype.slice.call(arguments),p.value,l.value,c.value,"multi"===r?[e]:null]))}var f=new RegExp("(^|,)"+e.replace(/\+/,"\\+")+"([\\^@;][^,\n]*)*(,|\n|$)","mg");if(["KILL","TIME","WATCH","UNWATCH","TRACK","KILL_N","TIME_N"].indexOf(t)!=-1){a||(a=gClg.AllThreads[e]&&(gClg.AllThreads[e][8][4]||gClg.AllThreads[e][8][0])||this.threads[e]&&(this.threads[e][8][4]||this.threads[e][8][0])||0);var h=a%1e3,m="@"+new Date(a).toLocaleString()+(a%1e3==0?"":"."+h),g=c.value,b=g.search(f)!=-1;(s===!1||b||pref.common.consolidated_watch_list||"all"===pref.triage.sync_watch||0===s&&"bg"===pref.triage.sync_watch)&&(g=g.replace(f,","),"WATCH"===t||"TRACK"===t||"TIME"===t||"TIME_N"===t?(g+=","+e+m+"\n",_[e]&&this.mark_read_thread(e,a,"TRACK"===t&&n)):("UNWATCH"!==t||b||(g+=","+e+"@0\n"),_[e]&&this.mark_read_thread(e,null)),c.value=g.replace(/,,+/g,",").replace(/^,/g,"").replace(/\n,/g,"\n").replace(/\n\n+/g,"\n").replace(/^\n/,""),d.watch=!0)}if(!o&&["KILL","TIME","NONE","UNWATCH","KILL_N","TIME_N"].indexOf(t)!=-1){var v=p.value.replace(f,",");(s===!1||p.value.search(f)!=-1||"all"===pref.triage.sync_ex||0===s&&"bg"===pref.triage.sync_ex)&&(["KILL","KILL_N","TIME","TIME_N"].indexOf(t)!=-1&&_[e]&&(v=v+","+e+("TIME"===t||"TIME_N"===t?m:"")+"\n"),p.value=v.replace(/,,+/g,",").replace(/^,/g,"").replace(/\n,/g,"\n").replace(/\n\n+/g,"\n").replace(/^\n/,""),d.ex=!0)}if(!o&&["KILL","TIME","NONE","ATTR","SHOW","UNSHOW","STICKY","UNSTICKY"].indexOf(t)!=-1&&(s===!1||"all"===pref.triage.sync_attr||0===s&&"bg"===pref.triage.sync_attr)){if(_[e]){var y=l.value.match(f),w=pref_func.str2obj2(null,null,y?y.join():e,{},!0);"ATTR"===t&&n&&(w=pref_func.str2obj2(null,null,e+";"+n,w,!0));var k=w[e];k.style||(k.style={}),k.cmd||(k.cmd={}),"SHOW"===t?k.cmd.SHOW=!0:"UNSHOW"===t||"KILL"===t?delete k.cmd.SHOW:"STICKY"===t?_[d.name][16].systemSticky?delete k.cmd.STICKY:k.cmd.STICKY=!0:"UNSTICKY"===t&&(_[d.name][16].systemSticky?k.cmd.STICKY=!1:delete k.cmd.STICKY);var x=["KILL","TIME","NONE"].indexOf(t)!=-1?n:k.style?Object.keys(k.style).map(function(e){return e+":"+k.style[e]}).join(";"):"",T=k.cmd?Object.keys(k.cmd).map(function(e){return e+(k.cmd[e]===!0?"":":"+k.cmd[e])}).join(";"):"",C=(x?";"+x:"")+(T?";"+T:"")}var N=l.value.replace(f,",")+(C?e+C+"\n":"");l.value=N.replace(/,,+/g,",").replace(/^,/g,"").replace(/\n,/g,"\n").replace(/\n\n+/g,"\n").replace(/^\n/,""),d.attr=!0}}else{if(0==i.length)return d;var I=i.pop();d={ex:p.value!==I[1],attr:l.value!==I[2],watch:c.value!==I[3],name:I[0][0],names:I[4]},c.value=I[3],l.value=I[2],p.value=I[1]}return d.watch&&pref_func.apply_prep(c,this.pref),d.ex&&pref_func.apply_prep(p,this.pref),d.attr&&pref_func.apply_prep(l,this.pref),"UNDO"!==t||!d.watch&&"KILL"!==I[0][1]||this.triage_rewind_watch(d),d},Q.prototype.triage_rewind_watch=function(e){for(var t=e.names||[e.name],n=t.length-1;n>=0;n--){var r=t[n];if(this.threads[r]){var a=this.get_watch_time_of_a_thread(r,this.threads[r][8][1],null,!0),s=liveTag.mems.getFromName(r).wt;a?site2.DEFAULT.check_reply.set_watch_time(s,a,r):site2.DEFAULT.check_reply.set_unwatch(s),0!==n&&this.triage_exe_view(r,e),this.footer.queue_update_force(r),this.ths_undo[r]=null}else t.splice(n,1)}0!=t.length&&oe.scan_init("triage_undo",t,{refresh:!0,priority:8})};var le=function(){function e(e,t,n){for(var r=t.format_tgt,a="string"==typeof e?null:e,s=a?null:liveTag.mems.getFromName(e),o=a?null:n.threads[e],i=0;i<r.length;i++)r[i][0].style.display=(a?p.merge(a.tgt_ths,a.lths,r[i][1]):p[r[i][1]](o,s))?"none":""}function t(e,t){var n=new Triage(e,t);return n.pn.onmouseover=f.triage_in,n.pn.onmouseout=f.triage_out,pref.triage.hide_toggle||(n.format_tgt=null),n}function n(e){if("float"===_.mode){f.off(),pref_func.tooltips.hide(),e.preventDefault();var t=document.createEvent("MouseEvents");t.initMouseEvent(e.type,e.canBubble,e.cancelable,e.view,e.detail,e.screenX,e.screenY,e.clientX,e.clientY,e.ctrlKey,e.altKey,e.shiftKey,e.metaKey,e.button,e.relatedTarget),_.ppn.dispatchEvent(t)}}function r(e,t){if("PWATCH"===e){var n=s.getAttribute("data-attr");_.triage_event(n.slice(0,n.indexOf("#")),"WATCH","",parseInt(n.slice(n.indexOf("@")+1),10))}else _.triage_event(d,e,t);f.off()}function a(){var e={onclick:r,onmousewheel:n,style:"pointer-events:none;position:absolute"};o=t(pref.catalog_triage_str,e),i=t(pref.triage.menu_str,{menu:!0,child_style:"width:100%;",class:"menu",__proto__:e}),l=t("PWATCH,Watched,",{menu:!0,child_style:"width:100%;",class:"postMenu",__proto__:e})}var s,o=null,i=null,l=null,c=null,p={WATCH:function(e){return 786432&e[19][0]&&0===e[19][1]},UNWATCH:function(e){return!(786432&e[19][0])},SHOW:function(e){return e[16].show_always},UNSHOW:function(e){return!e[16].show_always},STICKY:function(e){return e[20]},UNSTICKY:function(e){return!e[20]},ARC:function(e,t){return t.archived},ARC1:function(e,t){return t.archived},UNARC:function(e,t){return!t.archived},merge:function(e,t,n){for(var r=0;r<t.length;r++)if(!this[n](e[r],t[r]))return!1;return!0}},_=null,d=null,u=pClg.ppn,f=function(){function t(e,t,n,r){var a=e.pn.style,s=n.offsetLeft-t.ppn.scrollLeft+(r?r.offsetLeft+r.offsetWidth:0);r||"Left"===pref.catalog_triage_place.slice(-4)?(a.left=s+"px",a.right=null):(a.right=t.ppn.offsetWidth-s-n.offsetWidth+"px",a.left=null);var o="float"===t.mode,i=!o&&r?r.getBoundingClientRect().top+window.pageYOffset:n.offsetTop-t.pppn.scrollTop+(!o&&r?r.offsetTop:0);r||"t"===pref.catalog_triage_place[0]?(a.top=i+"px",a.bottom=null):(a.bottom=(o?t.pppn.offsetHeight+t.ppn.offsetTop:window.innerHeight)-i-n.offsetHeight+"px",a.top=null)}function n(e,t,n,r){if(pref[r.view].triage_hover){if(m===n)return;pref.triage.show_always||g.restart(pref.triage.popdown_delay),h(o,t,n,r)}else m!==n&&s()}function r(){u.appendChild(o),u.appendChild(i),b=!1}function a(e,t){c!==e&&s(),c=e,d||(b?u.appendChild(e.pn):e.pn.style.display=""),d=t}function s(){d&&(b?c.pn.parentNode.removeChild(c.pn):c.pn.style.display="none",d=null,c=null),pref_func.tooltips.hide_if(c)}function p(e){m=null,_=null,s()}function f(e,t,n,r,a){var o=a?l:i;if(m===r&&c===o&&t===d)return void s();g.stop(),h(o,t,r,n,e)}function h(n,r,s,o,i){_=o,u=pref.test_mode[141]?o.pppn:o.ppn,t(n,o,s,i),m=s,n.format_tgt&&e(r,n,o),a(n,r)}var m=null,g=new Watchdog(s,100),b=!0;return{change_mode:r,thread_in:n,off:s,triage_in:function(e){g.stop(),e.stopPropagation(),gGEH.triage_in2(e),gGEH.triage_in&&gGEH.triage_in(e)},triage_out:function(){c!==i&&(pref.triage.show_always||g.restart(pref.triage.popdown_delay))},thread_out2:p,make_menu:f}}();return a(),{change_mode:f.change_mode,thread_in:f.thread_in,off:f.off,triage_in:f.triage_in,triage_out:f.triage_out,thread_out2:f.thread_out2,destroy:function(){this.off(),o.destroy(),i.destroy()},remake:function(){this.destroy(),a()},embedded_onclick:function(e,t){var n=gGEH.get_key_recursive(e.target,e.currentTarget,!0);Triage.prototype.prep_func_onclick(function(r,a){if("MENU"===r||"PMENU"===r){var o=cataLog.GEH.prototype.geh,i=o.recSearch_thread(e.target,e.currentTarget)||o.recSearch_thread(e.target,e.currentTarget,pref.script_prefix+"_headline"),l="PMENU"===r;s=e.target,n&&f.make_menu(e.target,n,t,i,l)}else t.triage_event(n,r,a)})(e)},postMenu:function(e){var t=Triage.prototype.postMenu.cloneNode(!0);return t.setAttribute("data-attr",e),t}}}();cataLog.triage=le;var ce={get no(){return this.dbt[2]},get board(){return this.dbt[1]},get domain(){return this.dbt[0]},get key(){return this.dbt.join("")},get nof_posts(){return liveTag.mems.getFromName(this.key).nof_posts},get nof_files(){return this.threads[this.key][8][3]},get tags(){return liveTag.mems.getFromName(this.key)},recent_posts:function(e,t){void 0!==e&&null!==e||(e=this.get_t2h_num_of_posts());var n=t;return e!==!1&&this.lth.ta&&(n=site2[this.lth.domain].update_posts_replace_prep(null,this.lth.ta.posts,e)),pref.test_mode[135]&&(t||(n&&this.lth.pd&&(n=n.filter(function(e){return!e.deleted_after})),(!n||e<0||n.length<=e)&&this.lth.ta&&(n=site2[this.lth.domain].update_posts_replace_prep(n||this.lth.ta.posts,this.lth.ta.posts,e)))),n||(n=[this.op]),!pref.test_mode[64]&&pref[i].deleted_posts.merge&&this.lth.pd?p(this.lth,n,e,pref[i].t2h_sel):n},get_t2h_num_of_posts:function(){var e=this.t2h_sel||pref[i].t2h_sel;return"page"===e?this.t2h_page||pref[i].t2h_num_of_posts:"L"===e?pref[i].t2h_L:"M"===e?pref[i].t2h_M:"N"===e?pref[i].t2h_num_of_posts:"N_unread"===e?pref[i].t2h_num_of_posts+this.lth.nr:"unread"===e?this.lth.watched?this.lth.nr:this.t2h_page||pref[i].t2h_num_of_posts:"no"===e?0:-1},expand_num:function(){var e=this.get_t2h_num_of_posts()+1,t=this.nof_posts;return 0==e||e>t?t:e},expand_event:function(e){this.t2h_sel=pe.get_t2h_from_index(e),this.check_and_expand(this.recent_posts(),!0)},check_and_expand:function(e,t){var n=this.expand_num();if(e.length<n)this.expand_posts=!0,scan.scan_ui("expand_page",{tgts:[this.key],options:{refresh:!0}}),gClg.Maintain_AllThreads(this.key);else if(t){var r={posts:e,__proto__:this.threads[this.key][7]};this.clg.insert_thread_prepare_html_lazy(this.threads[this.key],!1,!1,null,r),cataLog.show_catalog(this.key,!0),gClg.Maintain_AllThreads(this.key)}}};Q.prototype.insert_thread_dummy=function(e,t,n){var r=site2.DEFAULT.wrap_to_parse.get_getters(),a=[{domain:e,board:t,no:n,key:e+t+n,sub:"",com:"DUMMY, waiting for archive...",body:"",name:"",id:void 0,trip:void 0,country:void 0,flag:null,op_img_url:void 0,time_bumped:1,time_posted:1,time_created:1,nof_posts:1,nof_files:0,parse_funcs:{type_com:"html"},sticky:!1,__proto__:r}],s={posts:a,__proto__:a[0]};liveTag.prep_tags(s),this.insert_thread(s,0),this.threads[e+t+n][16].needs_update=!0},Q.prototype.insert_thread=function(e,t,n,r,a){var s=e.key;pref.test_mode[28]||site2[e.domain].preprocess_doc&&!r&&site2[e.domain].preprocess_doc(e.pn),pref.test_mode[26]&&(r||"html"!==e.type_data||(e.pn=document.adoptNode(e.pn))),pref.test_mode[27]&&(r||"html"!==e.type_data||(e.pn=document.importNode(e.pn,!0)));var o=!1,l=this.threads[s],c=[e.time_bumped,e.time_created,e.nof_posts,e.nof_files,e.time_posted];if(l&&l[16].needs_update)if(l[16].needs_update===!0){!e.page&&l[7]&&(e.page=l[7].page),this.remove_thread(s,!0),l=void 0;var p=!0}else delete l[16].needs_update;var _=e.lth;if(void 0==l){if(pref.test_mode[19]&&e.parse_funcs_html.th_init&&e.parse_funcs_html.th_init(e),o=!0,l=[!!r&&e.pn,r&&"archive"!==site.whereami,null,null,null,[],null,null,c,[null,0,null,0],null,null,null,t,e.page,0,{dbt:common_func.name2domainboardthread(s,!0),parse_funcs:e.parse_funcs,systemSticky:e.sticky,type_html:e.type_html,domain_html:e.domain_html,parse_funcs_html:e.parse_funcs_html,icon_sticky:null,icon_show_always:null,show_always:null,th:e,lth:_,op:e.posts&&e.posts[0],threads:this.threads,clg:this,__proto__:ce},null,e.type_html,null,e.sticky,!1,null,null,null],p){for(var d=0;d<l.length;d++)this.threads[s][d]=l[d];l=this.threads[s]}else this.threads[s]=l;l[19]=_.wt,"catalog"===i&&e.domain===site.nickname||!("KC"===e.domain&&"catalog"===e.type_source||e.posts[0].editing)?"archive"===e.type_source&&(l[16].needs_update=!0,scan.list_nup.add_scan(e.key)):(l[16].needs_update=!0,"catalog"===e.type_source&&scan.list_nup.add(e.key)),e.archiveFile&&(l[16].archiveFile=e.archiveFile),"thread"===this.mode&&(l[16].t2h_sel=a?pref[i].t2h_sel:"all")}if(e.parse_funcs.posts_full&&e.parse_funcs.posts_full(e),c[0]||(c[0]=l[8][0]),c[4]||(c[4]=l[8][4]<c[0]?c[0]:l[8][4]?l[8][4]:site2[e.domain].check_reply.get_checked_time(l[19])),l[8]=c,r&&(l[16].posts=r.posts_shown),("page"===e.type_source||"4chan"===e.domain&&"catalog_json"===e.type_parse)&&(l[16].t2h_page=e.posts.length-1),l[16].expand_posts&&(l[16].expand_num<=e.nof_posts||"thread"===e.type_source)&&(l[16].expand_posts=!1),pref.test_mode[135]){var u=("page"!==this.view||"page"!==(l[16].t2h_sel||pref[i].t2h_sel))&&l[16].get_t2h_num_of_posts();u!==!1&&o&&(u<0||u+1>e.posts.length)&&e.posts.length<e.nof_posts&&"page"===this.view&&(l[16].expand_posts=!0,scan.list_nup.add_scan(e.key)),e.parse_funcs.has_posts&&(e.posts=l[16].recent_posts(u,e.posts))}else"page"===this.view&&o&&l[16].check_and_expand(e.posts);!e.page&&l[16].th&&(e.page=l[16].th.page),!o&&e.parse_funcs.has_posts&&(l[16].th=e),(pref.test_mode[49]||"no"===pref[i].t2h_sel)&&!site2[site.nickname].historyAPI||l[7]&&!e.parse_funcs.has_posts||(l[7]=e),pref.test_mode[135]&&"no"===pref[i].t2h_sel&&(e.posts=e.posts.slice(0,1)),_.th=e,this.filter_dirtify(l,!0);var f=this.pref.catalog.filter;if((r||l[16].expand_posts&&l[1]&&!f.kwd.posts_active||pref.test_mode[36])&&this.insert_thread_prepare_html_lazy(l,o,r,null,e),o){if(f.auto_list.use&&!f.list_obj2[e.key]&&!f.watch_list_obj2[e.key]&&!f.attr_list_obj2[e.key]){var h=pref_func.merge_obj5a(e,f.auto_list.obj7,null);h&&this.insert_thread_auto_list(e,h)}this.view_attr_set(e.key,null,!0)}if("meguca"===e.domain&&(_.ed_t?_.ed_u=e.replyTime:_.ed_u&&(_.ed_u=void 0)),!pref.test_mode[114]&&Q.prototype.Clgs.length>=2&&pref.test_mode[133])for(var d=1;d<Q.prototype.Clgs.length;d++)q(Q.prototype.Clgs[d],s)},Q.prototype.insert_thread_auto_list=function(e,t){for(var n=0;n<t.length;n++)if(t[n].use!==!1&&ve.kwd({use:!0,__proto__:t[n]},e.posts,e.domain,e))for(var r=t[n].cmds.split(","),a=0;a<r.length;a++){var s=r[a].indexOf(":");this.triage_exe_broadcast(e.key,s===-1?r[a]:r[a].slice(0,s),s===-1?"":r[a].slice(s+1),!1,null,!1,!0)}},cataLog.set_watch_time_thread=_,Q.prototype.insert_thread_prepare_html_lazy=function(e,t,n,r,a){var a=e[16].th||a;if(r&&pref.catalog.filter.kwd.posts_active||("page"===this.view||"thread"===this.view&&(a.lth.pd||"ALL"!==e[16].t2h_sel))&&(a.posts=e[16].recent_posts()),site2[a.domain].wrap_to_parse.posts(a),(t||"page"===i||"thread"===i)&&pe.prepare_html(e,a,t,this.view,this.mode),t&&this.insert_thread_format_th_pn(e,t,a),e[0]&&this.insert_thread_format_html(a,a.key,t,n),pref.test_mode[124]&&"catalog"===i&&a.parse_funcs.has_posts){var s=a.lth;s.ta&&s.ta.posts.length<a.posts?e[16].posts=a.posts:e[16].posts&&(e[16].posts=null)}e[16].th=null},Q.prototype.insert_thread_format_th_pn=function(e,t,n){if(t){var r=e[0];gGEH.pns_all_keys.set(r,n.key),"float"===this.mode&&"catalog"===this.view&&this.pref.float.format.fc.resize&&(r.style.width=this.pref.float.format.fc.width+"px",r.style.height=this.pref.float.format.fc.height+"px",r.style.float="left",r.style.overflow="hidden"),(this.pref[this.mode].format.thumb.resize||n.domain!==site.nickname)&&this.image_resize_onload_add(n.parse_funcs_html.tn_imgs(n)),e[24]=this.footer.prep_footer3(n,e[24]),this.view_attr_set(n.key,null,!0)}},Q.prototype.insert_thread_format_html=function(e,t,n,r){site2.DEFAULT.check_reply.set_own_posts(e);var a,s=n||r&&"meguca"===site.nickname;if(s&&("page"===e.type_html||"thread"===e.type_html)){var o=e.parse_funcs_html.get_thread_links(e.pn?e:{pn:this.threads[t][0],__proto__:e});if(o)for(var l=0;l<o.length;l++)o[l].onclick=u}var c=this.threads[t],p=this.merge_bases,_=p.bases[e.key]||n&&(c[1]||!p.initialized)&&p.query(e.key,c,e,!0,this);if("page"===this.view||"thread"==this.view?(a=this.update_posts_in_page(e,t,s,r,c,_),pref[i].popup&&(site2[e.domain].popups_add(c[16].posts,e,!this.pref.catalog.filter.kwd.posts_active),
pref[this.mode].merge_op_auto&&a[0]===c[16].posts[0]&&this.merge_cross_links_in_op(e.lth,c[16].posts[0]))):pref.test_mode[124]&&s&&(this.threads[t][16].posts=e.posts,a=e.posts),pref.test_mode[124]){var d=n?0:1;if("page"==i&&"json"===e.type_data){e.domain_html=site.nickname,e.parse_funcs_html=site2[e.domain_html].parse_funcs.page_html;for(var l=d;l<e.posts.length;l++)e.posts[l].pn||(e.posts[l].pn=site2[e.domain_html].post_json2html(e.posts[l],e.board));for(var l=d;l<e.posts.length;l++)e.posts[l].tn_imgs=e.parse_funcs_html.tn_imgs(e.posts[l]);a=e.posts.slice(d)}}pref[i].hide_posts_without_images&&pe.hide_posts_without_images(e,t),"headline"!==this.view&&"catalog"!==this.view&&this.view_update_draw(t,this.threads[t][16].posts),this.insert_thread_format_html_add_events(e,a,r)},Q.prototype.merge_cross_links_in_op=function(e,t){var n=e.mh||0;if(!(n>=pref[this.mode].merge_op_auto_hop)){var r=e.q[t.no].quotes,a=r&&r.filter(function(t){return t[0]!==e.q}).map(function(e){return e[0].key}).filter(function(e){return!this.threads[e]},this);a&&0!=a.length&&(scan.scan_ui("mergeAuto",{tgts:a,options:{refresh:this}}),this.merge_tgts(a,n))}},Q.prototype.merge_tgts=function(e,t){pref[this.mode].merge_op_lv_add&&this.merge_bases.add_to_lv_list(e,pref[this.mode].merge_op_lv+(pref[this.mode].merge_op_lv_inc?t:0),this);for(var n=0;n<e.length;n++){var r=common_func.fullname2dbt(e[n]),a=liveTag.mems.init({domain:r[0],board:r[1],no:r[2]});(!a.mh||a.mh>t+1)&&(a.mh=t+1)}},Q.prototype.merge_cross_links_in_op_manually=function(e){var t=liveTag.mems.getFromName(e);site2[t.domain].popups_prep(t),pe.prepare_html_post(t.th,t.th.posts[0]);var n=t.q[t.th.posts[0].no].quotes,r=n&&n.filter(function(e){return e[0]!==t.q}).map(function(e){return e[0].key}).filter(function(e){return this.threads[e]},this);if(r&&0!=r.length){this.merge_tgts(r,t.mh||0);for(var a=0;a<r.length;a++)this.merge_bases.add_to_list_1(e,r[a],this)}},Q.prototype.insert_thread_format_html_add_events=function(e,t,n){if(t&&("page"===this.mode||"thread"===this.mode)){var r=!pref[this.mode].env.expand_thumbnail_inline_native||!n||pref[this.mode].expand_thumbnail_inline_all_after&&pref[this.mode].env.event_dynamic,a=pref[this.mode].expand_thumbnail_initial,s=pref[this.mode].thumbnail.inline.ondemand;if(r||a||!pref.test_mode[104])for(var o=0;o<t.length;o++){var i=e.parse_funcs_html.tn_imgs(t[o]);if(i)for(var l=0;l<i.length;l++)pref.test_mode[104]?i[l].onclick=de.expand_thumbnail_inline:r||pref[this.mode].env.event_dynamic&&e.domain===site.nickname||ke.prototype.blacklist_click.add(i[l]),a&&(s?(de.expand_thumbnail_on_demand(i[l]),a=!1):de.expand_thumbnail_inline.call(i[l],null,!0))}}};var pe={prepare_html_prep_posts:function(e){site2[e.domain].wrap_to_parse.posts(e),"html"===e.type_data&&this.prepare_html_extract_params(e)},prepare_html_extract_params:function(e){if(!e.extracted){if(e.parse_funcs.filename){for(var t=0;t<e.posts.length;t++)e.posts[t].pn&&(e.posts[t].filename=e.parse_funcs.filename(e.posts[t]));e.filename=e.parse_funcs.filename(e)}e.parse_funcs.prep_mimic&&e.parse_funcs.prep_mimic(e),e.extracted=!0}},prepare_html:function(e,t,n,r,a){var s=t.domain!==site.nickname&&"html"===t.type_data,o=!t.pn||(t.domain!==site.nickname||site.whereami+"_html"!==t.type_mimic)&&pref.catalog.mimic_base_site||"float"===a,i="float"===a?r:"page"===a||"thread"===a?"page":"catalog";if(pref.test_mode[92]&&(i="catalog"),o){if(n){var l="headline"===i?site2[site.nickname].headline_json2html(t):"page"===i?site2[site.nickname].page_json2html3(t,!s,e[16],pref[r].use_expander_always||"thread"===a&&"all"!==e[16].t2h_sel):site2[site.nickname].catalog_json2html3(t,t.board,t.op_img_url);Object.defineProperty(t,"pn",{value:l,writable:!0,enumerable:!0,configurable:!0})}t.type_html=i,t.domain_html=site.nickname,t.parse_funcs_html=site2[site.nickname].parse_funcs[t.type_html+"_html"]}else"html"===t.type_data&&site2.common.remove_by_tagname(t.pn,"script");n&&(pref[a].popup&&"page"===i&&site2[t.domain].popups_prep(t),e[0]===!1&&(e[0]=t.pn,e[16].type_html=t.type_html,e[16].domain_html=t.domain_html,e[16].parse_funcs_html=t.parse_funcs_html),Object.defineProperty(t,"footer",{value:t.parse_funcs_html.footer(t),writable:!0,enumerable:!0,configurable:!0}),t.parse_funcs_html.footer2&&Object.defineProperty(t,"footer2",{value:t.parse_funcs_html.footer2(t),writable:!0,enumerable:!0,configurable:!0}),this.prep_anchor_links(t.pn,t))},prep_anchor_links:function(e,t){(pref.test_mode[109]||t.no!=site.no||t.board!=site.board||t.domain!=site.nickname)&&site2[t.domain].toplevel_anchor(e,t),site.nickname!==t.domain&&site2[t.domain].absolute_link(e)},prepare_html_post:function(e,t,n,r,a,s,o,l,c){t.pn||(t.pn=site2[e.domain_html].parse_funcs.post_json.pn(t),n||(n=e.lth.q)),a||this.prep_anchor_links(t.pn,e),site2[e.domain_html].format_pn(t.pn,n?n[t.no]:null,r,t,e),t.editing&&t.pn.classList.add(pref.script_prefix+"_post_editing"),pref[i].popup&&site2[e.domain].popups_add_1(e,t,s,n||e.lth.q,o,l,c),!t.pn_menu&&pref[i].postMenu&&(t.pn_menu=this.add_postMenu(e,t))},add_postMenu(e,t){var n=le.postMenu(e.key+"#"+t.no+"@"+t.time_tu),r=site2[e.domain_html].add_backlinks_bks_query(t.pn);return r?r.parentNode.insertBefore(n,r):site2[e.domain_html].add_backlinks_bks_append(t.pn,n),n},get_t2h_from_index:function(e){return["page","L","M","N","N_unread","unread","all"][e]},get_t2h_index:function(e){var t=e[16].t2h_sel||pref[i].t2h_sel;return"page"===t?0:"L"===t?1:"M"===t?2:"N"===t?3:"N_unread"===t?4:"unread"===t?5:6}};Q.prototype.update_posts_in_page=function(e,t,n,r,a,s){for(var o=pref[i],l=r?{colorID:o.colorID&&!o.env.colorID_native,backlink:o.backlink&&!o.env.backlink_native,localtime:o.localtime&&!o.env.localtime_native}:o,c=n&&e.key===site.key,p=r&&pref[this.mode].env.popup_native&&!pref[this.mode].env.event_dynamic,_=r?r.init?r.posts_shown:r.posts_updated:n?e.posts.slice():[],d=0;d<_.length;d++)pe.prepare_html_post(e,_[d],e.lth.q,l,c,p,!0,r,!0);return s||a[16].posts&&a[16].posts!==e.posts?site2[e.domain_html].update_posts_replace(e,a[16],a[0],s,a[1],_,this,p,r):(a[16].posts=e.posts.slice(),("4chan"===site.nickname||pref.test_mode[140])&&n&&r&&pref[this.view].use_expander_always&&site2[e.domain_html].page_json2html3_add_omitted_info_html(e,a[16],!0,0,0)),"4chan"===site.nickname||pref.test_mode[140]||n&&r&&"page"===this.view&&pref[i].use_expander_always&&site2[e.domain_html].page_json2html3_replace_expander(e.posts,pe.get_t2h_index(a),t),common_obj.thread_reader&&common_obj.thread_reader.updated(_,r&&r.init),_},common_func.Object_defProps(pe,{replace_posts_by_search:function(e){var t=e[7];if(pref.catalog.filter.kwd.posts_active){if(e[10]!=pref.catalog.filter.kwd.timestamp||e[16].th){e[10]=pref.catalog.filter.kwd.timestamp;var n=ve.kwd_make_result(e[16].recent_posts("auto"===pref[i].sourceOfSP?-1:null),t.domain);if(n){var r=!e[16].posts||e[16].posts.length!==n.length;if(!r)for(var a=n.length;--a>=0;)if(e[16].posts[a].no!==n[a].no){r=!0;break}e[16].posts&&e[16].posts[0]&&e[16].posts[0].pn&&e[16].posts[0].pn.classList.contains("CatChan_search_miss")==n[0].search_result&&site2[t.domain_html].update_posts0_class(e[16].posts[0].pn,n[0].search_result),r?(pe.prepare_html_prep_posts(t),e[16].th={posts:n,__proto__:t}):e[16].th&&(e[16].th=null)}else e[9][0]=!1,e[16].th=null}}else(e[10]||e[16].th)&&(e[16].th||(e[16].th={posts:e[16].recent_posts(),__proto__:t}),e[10]=!1);return e[16].th&&e[7]&&e[16].posts===e[7].posts&&(e[7].posts=e[7].posts.slice()),!pref.catalog.filter.kwd.posts_active||e[9][0]},posts_search_inactivated:function(){for(var e in re){var t=re[e][7],n=re[e][16];n.posts&&n.posts[0]&&n.posts[0].pn&&n.posts[0].pn.classList.contains("CatChan_search_miss")&&site2[t.domain_html].update_posts0_class(n.posts[0].pn,!0)}pClg.drawn_idx=0},hide_posts_without_images:function(e,t){for(var n=re[t][16].posts,r=0;r<n.length;r++){0===e.parse_funcs_html.tn_imgs(e.posts[r]).length&&(n[r].pn.style.display="none")}}}),cataLog.format_html=pe,common_func.Object_defProps(Q.prototype,{view_update_draw_merged:function(e){if(this.pref[this.mode].mark_new_posts){var t=this.merge_bases.bases[e.key],n=t?t.lths.map(function(e){return e.watched&&this.get_mark_time(e.key)},this).reduce(function(e,t){return t>e?t:e}):786432&this.threads[e.key][19][0]&&this.get_mark_time(e.key);n>0&&site2[site.nickname].mark_newer_posts2(e.posts,n,"thread"===this.view,!0)}},view_update_draw:function(e,t){if(this.pref[this.mode].mark_new_posts&&786432&this.threads[e][19][0]){var n=this.get_mark_time(e);0===n&&"thread"===this.view&&(n=site2.DEFAULT.check_reply.get_checked_time(this.threads[e][19])),n>0&&site2[this.threads[e][16].domain_html].mark_newer_posts2(t,n,"thread"===this.view,!0)}},view_update:function(e){if(this.threads[e][16].posts){var t=this.pref[this.mode].mark_new_posts&&786432&this.threads[e][19][0]?this.get_mark_time(e):0;0===t&&(t=1/0),site2[this.threads[e][16].domain_html].mark_newer_posts2(this.threads[e][16].posts,t,"thread"===this.view,!1)}},view_time_filter_changed:function(e){if("page"===this.view||"thread"===this.view)if(e)this.view_update(e);else for(e in this.threads)this.view_update(e)}}),Q.prototype.get_watch_time_of_a_thread=function(e,t,n,r){var a=this.pref.catalog.filter,s=this.get_mark_time(e,r);return r&&s<0?-s:n&&s>n?0:!a.time_watch&&a.time_watch_creation&&s>t?0:s},common_func.Object_defProps(Q.prototype,function(){function e(e){var t=parseInt(e.substr(e.lastIndexOf("/")+2),10);return 0===t?{8:[void 0,void 0,void 0,void 0,void 0],__proto__:l}:{8:[-t,-t,-t,-t,-t],__proto__:l}}function t(t){return 0===t.indexOf(c)?a[t]||e(t):s[t]}function n(e,n,r){for(var a=o;a<i&&n(t(r[a]));)a++;n(e)?i=a:o=a}function r(e,r){var l=r.idxs;s=r.threads,a=r.threads_odl,o=0,i=l.length;var c=r.order,d=t(e);"dont_care"!==c.sticky&&n(d,"last"===c.sticky?p.sticky_last:p.sticky_first,l),c.reply_to_me&&n(d,p.reply_to_me,l),c.reply&&n(d,p.reply,l),"dont_care"!==c.watch&&n(d,"last"===c.watch?p.watch_last:p.watch_first,l);for(var u=_[c.ordering%6],f=u(d[8]),h=c.ordering>=5&&c.ordering<11?function(e){return f>=u(e[8])}:function(e){return f<=u(e[8])},m=o;m<i&&h(t(l[m]));)m++;return m==l.length?l[l.length]=e:l.splice(m,0,e),m}var a,s,o,i,l={8:[0,0,0,0,0],19:[0,0,0]},c="ODL:",p={reply_to_me:function(e){return 786432&e[19][0]&&e[19][1]>>16!=0},reply:function(e){return 786432&e[19][0]&&0!=e[19][1]},watch_first:function(e){return 786432&e[19][0]},watch_last:function(e){return!(786432&e[19][0])},sticky_first:function(e){return e[20]},sticky_last:function(e){return!e[20]}},_={0:function(e){return e[0]||e[4]},4:function(e){return e[4]||e[0]},get 5(){var e=X.ts_refresh;return function(t){return(e-t[1])/t[2]}},1:function(e){return e[1]},2:function(e){return e[2]},3:function(e){return e[3]}};return{idx_raise_odl:function(e){var t=this.idxs.indexOf(e.key);if(t!=-1)for(var n=c+e.domain+e.board;++t<this.idxs.length;)if(0===this.idxs[t].indexOf(n)){this.threads_odl[this.idxs[t]]={8:[e.time_posted||e.time_bumped,e.time_created,e.nof_posts,e.nof_files,e.time_bumped||e.time_posted],__proto__:l},r(this.idxs.splice(t,1)[0],this);break}},idx_delete_odl:function(e){for(var t=0;t<e.length;t++)delete this.threads_odl[c+e[t]]},idx_insert_odl:function(e){delete this.threads_odl[c+e],this.idx_reorder(c+e)},idx_re_sort:function(){var e=this.idxs.filter(function(e){return"ODL:"===e.substr(0,4)});this.idxs=[];for(var t in this.threads)r(t,this);this.idxs=this.idxs.concat(e),this.drawn_idx=0,this.show_catalog()},idx_reorder:function(e){var t=this.idxs.indexOf(e);t!=-1&&this.idxs.splice(t,1);var n=r(e,this);return(n!==t||"catalog"!==this.view&&"headline"!==this.view)&&(this.drawn_idx===!0||n<this.drawn_idx||t<this.drawn_idx)&&(this.drawn_idx=0),n}}}());var _e=pClg,de=function(){function e(e,t,n){var r=k(e,t,n,"hover");if(r)return r.style.position="fixed",r.style.top="0px",r.style.right="0px",r.style.pointerEvents="none",r}function t(e){return e.currentTarget===site.popup_body?"page":i}function n(n,a){var s=t(n),l=n.target;if(pref[i].image_hover){var c,p=E&&E[1]===l;if(p)c=E[0],c.style.display="",E=null;else if(!(c=e(l,a,s)))return;c.style.zIndex=pref[i].thumbnail.hover.popup_zIndex,p||site.script_body.appendChild(c),n.preventDefault(),httpd.pause_req(),c.onload=o,c.onerror=httpd.pause_cancel,B&&r(),A=l,B=c}if(E&&(E[0].parentNode.removeChild(E[0]),E=null),pref[i].image_prefetch){var _=(gGEH.get_key_recursive(l),site2[site.nickname].get_next_image(l));if(_){var d=e(_,null,s);d.style.display="none",site.script_body.appendChild(d),E=[d,_]}}}function r(){B&&site.script_body.removeChild(B),B=null}function a(){if(B)return l(B)&&(B.style.cursor="zoom-in",B.onclick=v),B}function s(){var e=B.style;e.position=null,e.pointerEvents=null,e.zIndex=null,e.top=null,e.right=null,"VIDEO"===B.tagName&&B.play(),B=null}function o(e){if(httpd.pause_cancel(),pref[i].thumbnail.hover.zoom){var t=e.target;l(t,!0)&&(A.addEventListener("mouseout",_,!1),A.addEventListener("mousemove",p,!1),A.addEventListener("click",d,!1),L={x:document.documentElement.clientWidth-t.clientWidth,y:t.clientHeight,state:null})}}function l(e,t){var n=pref[i].thumbnail.hover;if(t&&!n.zoom)return!1;var r=e.style;return n.limit_width&&e.naturalWidth>parseInt(r.maxWidth,10)||n.limit_height&&e.naturalHeight>parseInt(r.maxHeight,10)}function c(e){return e.clientX>L.x&&e.clientY<L.y}function p(e){c(e)?L.state||(e.target.style.cursor="zoom-in",L.state=!0):L.state&&(e.target.style.cursor="auto",L.state=!1)}function _(e){var t=e.currentTarget;t.removeEventListener("mouseout",_,!1),t.removeEventListener("mousemove",p,!1),t.removeEventListener("click",d,!1),t.style.cursor=null}function d(e){c(e)&&(e.stopPropagation(),e.preventDefault(),_(e),B.onmouseout=r,v({target:B,clientX:e.clientX,clientY:e.clientY}),u(B))}function u(e){e.style.pointerEvents="auto",e.draggable=!0,e.ondragstart=cnst.div_dragstart,e["on"+brwsr.mousewheel]=cnst.div_scroll}function f(e){return document.documentElement.clientWidth-pref[i].thumbnail[e].margin_width}function m(e){return document.documentElement.clientHeight-pref[i].thumbnail[e].margin_height}function g(e){var t=e.naturalWidth/(parseInt(e.style.maxWidth,10)||f("hover")),n=e.naturalHeight/(parseInt(e.style.maxHeight,10)||m("hover"));return t>n?t:n}function b(e,t,n){if(!t.top){t=e.target.parentNode.parentNode.style;var r=e.target.offsetTop,a=e.target.offsetLeft}t.top=parseInt(t.top,10)*n+((r||0)-e.clientY)*(n-1)+"px",t.right=parseInt(t.right,10)*n-(document.documentElement.clientWidth-(a||0)-e.clientX)*(n-1)+"px"}function v(e){var t=e.target,n=t.style;b(e,n,g(t)),n.maxWidth="none",n.maxHeight="none",n.cursor="zoom-out",t.onclick=y}function y(e){var t=e.target,n=t.style;b(e,n,1/g(t)),n.maxWidth=f("hover")+"px",n.maxHeight=m("hover")+"px",n.cursor="zoom-in",t.onclick=v}function w(e,t,n,r){var a=gGEH.get_key_recursive(e);if(r||!pref[i].env.event_dynamic||void 0===n||("inline"===n?!pref[i].env.expand_thumbnail_inline_native:!pref[i].env.image_hover_native)){if(!a&&pref.test_mode[106]&&pref.test_mode[107])return e.src;var s=pref.catalog.mimic_base_site?site.nickname:re[a][16].domain_html;if("catalog"!==(t=site2[s].general_event_handler[site.whereami].image_hover_check_mode(e)))return site2[s].parse_funcs.post_html.img2src(e)||e.src;if("4chan"===site.nickname){var o=site2.DEFAULT.popups_posts.href2domain(e.src);return o&&site2[o].parse_funcs[t+"_html"].img2src(e)||e.src}if(a){var l=liveTag.mems.getFromName(a);return site2[l.domain].parse_funcs[l.th.type_parse].get_op_src(l.th,e)}}}function k(e,t,n,r,a){var s=e.cloneNode();if(t||(t=w(e,n,r,a)),t){var o=0===t.search(/^blob/)?site2.DEFAULT.parse_funcs.post_html.img2ext(e):"";if(t.indexOf("data-ext")!=-1&&(o=t.slice(t.indexOf("data-ext")+10).replace(/".*/,""),t=t.replace(/".*/,"")),".webm"===t.substr(-5,5)||".webm"===o||".webm"===e.getAttribute("data-ext")){if(!pref[i].thumbnail[r].webm||a)return null;if(B&&B.src===t)s=B,B=null,s.style.position=null,s.style.top=null,s.style.right=null,s.style.pointerEvents=null;else{var s=document.createElement("video");s.controls=!0,s.autoplay=!0}pref.test_mode[63]||(s.loop=pref[i].thumbnail[r].webm_loop,s.muted=pref[i].thumbnail[r].webm_mute)}return s.src=t,s.style.width="auto",s.style.height="auto",pref[i].thumbnail[r].limit_width&&(s.style.maxWidth=document.documentElement.clientWidth-pref[i].thumbnail[r].margin_width+"px"),pref[i].thumbnail[r].limit_height&&(s.style.maxHeight=document.documentElement.clientHeight-pref[i].thumbnail[r].margin_height+"px"),s}}function x(e,n){var r=t(e||{currentTarget:this});if(pref[i].expand_thumbnail_inline&&S.indexOf(this)==-1){var a=k(this,null,r,"inline",n);if(!a)return void C.call(this);"VIDEO"!==a.tagName&&(a.style.display="none",a.addEventListener("load",T,!1),this.style.opacity=.5),this.parentNode.insertBefore(a,this.nextSibling),S.push(a),e&&e.preventDefault(),"VIDEO"===a.tagName&&(T.call(a),a.play())}}function T(){this.previousSibling.style.display="none",this.style.display="",this.previousSibling.style.opacity="",this.removeEventListener("load",T,!1),this.onclick=I,site2[site.nickname].format_expanded_thumbnail&&site2[site.nickname].format_expanded_thumbnail(this);var e=S.indexOf(this);e>=0&&S.splice(e,1),site.patch.expand_thumbnail_inline_load&&site.patch.expand_thumbnail_inline_load.call(this),C.call(this)}function C(){if(pref[i].expand_thumbnail_inline&&(pref[i].expand_thumbnail_initial||pref[i].expand_thumbnail_inline_all_after)){var e=site2[site.nickname].get_next_image(this,h());e&&"none"!==e.style.display&&N(e)}}function N(e){var t,n=pClg.get_ref_height(pref[i].thumbnail.inline.ref_height/100);if(Array.isArray(e)){for(var r,a=h(),s=0;s<e.length;s++){var o=e[s].offsetTop;(o>=a&&o<t||0===s)&&(r=e[s],t=o)}e=r}else t=e.offsetTop;t<n||!pref[i].thumbnail.inline.ondemand?(j=null,x.call(e,null,!0)):j=e}function I(e){if(this.previousSibling.style.display="",e.preventDefault(),this.getAttribute("data-originalWidth")){this.parentNode.parentNode.style.width=this.getAttribute("data-originalWidth")}this.parentNode.removeChild(this)}var A=null,B=null,E=null,j=null,S=[],L=null;return{image_hover_add:n,image_hover_remove:r,image_hover_reentry:function(e,t){t||(t=i),B&&B.src===e.src&&(B.src=w(e,t))},image_hover_snatch:a,image_hover_snatch_end:s,get hover_ex(){return B},expand_thumbnail_inline:x,expand_thumbnail_on_demand_kick:function(){j&&N(j)},expand_thumbnail_on_demand:N,fetch_and_reentry:function(e,t){scan.scan_ui("image_hover",{tgts:e,options:{callback:function(){cataLog.DIH.image_hover_reentry(t)},priority:6}})}}}();cataLog.DIH=de,cataLog.image_hover_reentry=de.image_hover_reentry,Q.prototype.click_thread=function(e,t){t?f("force"===t?null:t,e,this):"open"===pref[this.mode].click?f(null,e,this):"catalog"!==re[e][18]&&"expand"===pref[i].click&&d(e)},Q.prototype.get_mark_time=function(e,t){var n=this.pref.catalog.filter,r=pref_func.merge_obj5(e,n.watch_list_obj2,null);return r&&"time"in r?t?-r.time:r.time:(r=pref_func.merge_obj5(e,n.list_obj2,null),r?r.time||0:(n.time_watch||n.time_watch_creation)&&""!==n.time_str?Date.parse(n.time_str):0)},Q.prototype.mark_read_thread=function(e,t,n){null!==t?site2.DEFAULT.check_reply.set_watched_to_last(this.threads[e][19],t,e,n):site2.DEFAULT.check_reply.set_unwatch(this.threads[e][19]),pref.liveTag.style.use&&liveTag.update_ur(e,0,!0),this.footer.update_force(e,this.pref[this.mode].footer.flag),pref.notify.favicon&&notifier.favicon.set(re)};var ue,fe,he={show_catalog:function(e,t,n){if(pref.debug_mode[11])var r=m(this.drawn_idx,this.drawn_y,this.ref_count,this.idxs);pref.test_mode[23]&&(this.drawn_idx=0);var a=pref[i].draw_on_demand&&this.permit_draw_on_demand,s=a&&pref.network.adaptive,o=0;if(a&&!t){var l=this.get_ref_height(pref[cataLog.embed_mode].merge?4:this.disp_th20?.2:this.disp_th100?1:1.5);if(0!==this.drawn_idx&&this.drawn_y>=l)if(this.ppn.offsetTop+this.ppn.offsetHeight<this.drawn_y)this.drawn_y=-1;else if(void 0===e)return!0}pref[i].scroll_lock&&this.show_catalog_scroll_lock.set(),common_obj.thread_reader&&common_obj.thread_reader.observer_IDinfo&&common_obj.thread_reader.observer_IDinfo.disconnect(),this.observer_myself&&this.observer_myself.disconnect();var c;"string"==typeof e?(c={},c[e]=null):c=e;var p=c?Object.keys(c).length:void 0,_="float"===i&&pref.catalog_expand_with_hr||pref[i].env.disp_filler;if(void 0!==c)for(var d=0;d<this.drawn_idx;d++)if(this.idxs[d]in c){this.drawn_idx=d,this.drawn_y=-1;break}this.ref_count_init=pref[i].env.disp_offset,_&&(this.ref_count_init=g(this.ref_count_init)),a&&0!==this.drawn_idx&&this.drawn_idx!==!0||this.func_track_reset();for(var u="",d=0,f=this.drawn_idx,h=this.func_lazy_draw,b=!(!this.pref[this.mode].merge_list||!pref.proto.merge_first&&!n||this.pref[this.mode].merge)&&null,v=pref[cataLog.embed_mode].lazyDraw.step,y=v<=f,w=this.footer.get_clean_idx(),k=a&&!pref.test_mode[132]||void 0===c;d<this.idxs.length;){var x=this.idxs[d],T=this.threads[x];if("ODL:"===x.substr(0,4)){if(""===u){u=x,be.call([u.substr(4)])&&this.idxs.splice(d,1);break}}else{if(a&&this.drawn_y>=l){if(!h||b===!1)break;if(null===b&&(b=d+1),!this.merge_bases.isShownForTails(x)){d++;continue}}if(0===p&&b===!1)break;if(d>=f)if(d%v==0&&(y=!0),k||void 0===c||x in c){var C=this.filter_test(x,T);if(C&&("page"===i||pref.test_mode[52])&&(C=pe.replace_posts_by_search(T)),C){if(T[0]&&!T[16].th||(this.insert_thread_prepare_html_lazy(T,!T[0],!1,!0,null),s&&(++o==pref.network.th100?(l=this.get_ref_height(1),this.disp_th100||(this.disp_th100=setTimeout(function(){this.disp_th100=null,this.show_catalog()}.bind(this),pref.network.th100_delay))):o===pref.network.th20&&(l=this.get_ref_height(.2),this.disp_th20||(clearTimeout(this.disp_th100),this.disp_th100=null,this.disp_th20=setTimeout(function(){this.disp_th20=null,this.show_catalog()}.bind(this),pref.network.th20_delay)),s=!1))),this.footer.draw(T,x),b&&!this.func_check_overrated(x)){T[1]||this.func_show(x,null,_)&&(T[1]=!0),d++;continue}var N;if(void 0!==c||h){for(var I=(h?this.func_search_ref_idx(x,d):d)-1;I>=0&&("ODL:"===this.idxs[I].substr(0,4)||!this.threads[this.idxs[I]][1]||h&&this.func_search_ref(this.idxs[I]));)I--;I>=0?(N=this.threads[this.idxs[I]][0].nextSibling,_&&N&&(N=N.nextSibling)):N=this.ppn.childNodes[this.ref_count_init]}else N=this.ppn.childNodes[this.ref_count];N===T[0]&&T[1]||this.func_show(x,N,_)&&(T[1]=!0),T[1]&&(this.func_track_shown(x,a&&y),y=!1)}else T[1]&&this.func_hide(x,_)&&(T[1]=!1);void 0!==c&&void 0!==c[x]&&p--}else d>=w&&T[1]&&this.footer.draw(T,x);else d>=w&&T[1]&&this.footer.draw(T,x);d++}}if(b&&(d=b-1),k&&(this.drawn_idx=!a||d==this.idxs.length||(d<f?f:d)),this.footer.clean_idx=d,h&&this.func_lazy_draw(),this.observer_myself&&this.observer_myself.observe(),common_obj.thread_reader&&common_obj.thread_reader.observer_IDinfo&&common_obj.thread_reader.observer_IDinfo.observe(),pref.debug_mode[11]&&"thread"!==i&&!pref[i].merge){for(var A=-1,B=0,E=0;E<d;E++)if("O"!==this.idxs[E][0]&&this.threads[this.idxs[E]][1]){var j,S,L=common_func.fullname2dbt(this.idxs[E]);if("page"===i&&"4chan"===site.nickname?(j=this.ppn.getElementsByClassName("CatChan_thread")[B++],S=site.board+j.id.substr(1)):"page"===i&&"8chan"===site.nickname?(j=this.ppn.getElementsByClassName("CatChan_thread")[B++],S="/"+j.getAttribute("data-board")+"/"+j.id.substr(7)):(j=this.ppn.childNodes[pref[i].env.disp_offset+B++],S="page"===i?"/"+j.getAttribute("data-board")+"/"+j.id.substr(7):j.getElementsByTagName("a")[0].getAttribute("href").replace("res/","").replace(".html","").replace(/.*lainchan.org/,"").replace(/.*8ch.net/,"").replace("thread/","").replace(/.*4chan.org/,"").replace(/.*meguca.org/,"").replace(/.*krautchan.net/,"").replace(/thread\-/,""),"4chan"===L[0]&&"catalog"===i&&(S=S.substr(0,S.lastIndexOf("/")))),L[1]+L[2]!==S){for(var O="",I=E+1;I<E+5;I++)O+=this.idxs[I]+", ";console.log("ERROR: "+E+", "+S+", "+this.idxs[E]+": "+d+", "+O),A=d}}var D=m(this.drawn_idx,this.drawn_y,this.ref_count,this.idxs);if(A!=-1){console.log("PREV: "+fe),console.log("IN:   "+r);for(var d=0;d<A+5;d++)this.ppn.childNodes[d]&&console.log(this.ppn.childNodes[d]);console.log("OUT:  "+D)}fe=D}if(pref.debug_mode[36]&&(debugWindow&&!this.debug&&(this.debug=debugWindow.connect()),this.debug)){for(var d=-1,R=-1,U=null,z=null;++d<this.idxs.length;)if(this.threads[this.idxs[d]]){if(U=this.footer.test_dirty(this.idxs[d]))break;z=this.threads[this.idxs[d]][24]||z,R=d}this.debug.innerHTML=this.name+":<br>drawn_idx: "+this.drawn_idx+"<br>drawn_y: "+this.drawn_y+"<br>last_clean_footer: "+this.idxs[R]+", offsetTop: "+(z&&z[0].parentNode.offsetTop)+"<br>first_dirty_footer: "+this.idxs[d]+", offsetTop: "+(U&&U[0].parentNode.offsetTop)}},func_show:function(e,t){return this.ppn.insertBefore(this.threads[e][0],t&&t.parentNode===this.ppn?t:null),!0},func_hide:function(e){return this.ppn.removeChild(this.threads[e][0]),!0},func_hide_all:function(e){var t="float"===this.mode&&pref.catalog_expand_with_hr||pref[this.mode].env.disp_filler;for(var n in e){var r=e[n];r[1]&&this.func_hide(n,t)&&(r[1]=!1)}},func_track_shown:function(e,t){t&&(this.drawn_y=this.threads[e][0].offsetTop),this.ref_count+=this.ref_step},func_track_reset:function(){this.ref_count=this.ref_count_init,this.drawn_y=-1,this.drawn_idx=0},permit_draw_on_demand:!0,ref_step:1,drawn_y:-1,ref_count:0,ref_count_init:0};common_func.Object_defProps(Q.prototype,he),pref.test_mode[96]&&"catalog"===i&&(he={func_track_shown:function(e){return function(t,n){var r=this.drawn_y,a=this.od_count%this.od_width==0;e.call(this,t,n&&a),a&&r==this.drawn_y&&this.od_width++,this.od_count++}}(he.func_track_shown),func_track_reset:function(e){return function(){e.call(this),this.od_count=0}}(he.func_track_reset),func_od_reset:function(){this.od_width=1,this.show_catalog_cont()},od_width:1,od_count:0,__proto__:he}),pref.test_mode[96]&&"catalog"===i&&window.addEventListener("resize",he.func_od_reset.bind(he),!1);var me=he;"page"===i&&site2[site.nickname].all_boards&&site2[site.nickname].all_boards.indexOf(site.board)!=-1?me={func_show:function(e){var t=this.threads[e][0];return!(!t.previousSibling||"H2"!==t.previousSibling.tagName)&&(t.previousSibling.style.display="",t.style.display="",!0)},func_hide:function(e){var t=this.threads[e][0];return!(!t.previousSibling||"H2"!==t.previousSibling.tagName)&&(t.previousSibling.style.display="none",t.style.display="none",!0)},permit_draw_on_demand:!1,__proto__:he}:pref[i].env.disp_filler?me=function(e){return{func_show:function(e,t){var n=this.threads[e][1]&&this.threads[e][0].nextSibling||this.filler.cloneNode(!1);return this.ppn.insertBefore(this.threads[e][0],t),this.ppn.insertBefore(n,t),!0},func_hide:function(e){return this.ppn.removeChild(this.threads[e][0].nextSibling),this.ppn.removeChild(this.threads[e][0]),!0},ref_step:2,filler:e,__proto__:he}}("<"===pref[i].env.disp_filler[0]?document.createElement("hr"):document.createTextNode(pref[i].env.disp_filler)):"float"===i&&pref.catalog_expand_with_hr&&(me={func_show:function(e,t){return this.threads[e][1]&&b(e,"remove"),this.ppn.insertBefore(this.threads[e][0],t&&t.parentNode===this.ppn?t:null),b(e,"add"),!0},func_hide:function(e){return b(e,"remove"),this.ppn.removeChild(this.threads[e][0]),!0},func_track_shown:function(e,t){this.__proto__.func_track_shown.call(this,e,t),this.ref_count=g(this.ref_count)},__proto__:he}),common_func.Object_defProps(pClg,me);var ge=pClg.show_catalog.bind(pClg);cataLog.show_catalog=ge,cataLog.catalog_obj2=pClg;var be=function(){function e(){n&&(clearTimeout(n),n=null),t=!0}var t=!0,n=null;return{call:function(e){return!!this.get()&&(_e.idx_delete_odl(e),oe.scan_init("on_demand_load",e,{refresh:!0,crawler_max:1,callback:be.release_draw}),!0)},release:e,release_draw:function(){e(),ge()},get:function(){var r=t;return r&&(n=setTimeout(e,1e3*pref.catalog_load_on_demand_timeout)),t=!1,r}}}();Q.prototype.view_attr_changed=function(){for(var e in this.threads)this.view_attr_set(e)},Q.prototype.view_attr_set=function(e,t,n){var r=this.threads[e],a=this.pref.catalog.filter,s=this.threads[e][0],o=null;if(a.attr_list){var i;pref.common.blur_404&&(i=a.watch_list_obj2[e])&&(i=i.cmd)&&i.PRUNED&&"thread"!==this.view&&!this.noBlur&&(o={style:{opacity:.4}}),pref.catalog.style_general_list&&(o=pref_func.merge_obj5(e,pref.catalog.style_general_list_obj2,o)),a.attr_list&&(o=pref_func.merge_obj5(e,a.attr_list_obj2,o))}if(s){var l=r[22];if(o&&o.style){l||(l={});for(var c in o.style)c in l||(l[c]=s.style[c]),s.style[c]=o.style[c];r[22]=l}if(l)for(var c in l)o&&o.style&&c in o.style||(void 0===l[c]?delete s.style[c]:s.style[c]=l[c],delete l[c])}if(!t&&(o&&o.cmd||r[20]||r[16].show_always||r[16].icon_sticky||r[16].icon_show_always||r[16].systemSticky)){var p=!!(o&&o.cmd&&void 0!==o.cmd.STICKY?o.cmd.STICKY:r[16].systemSticky);p^r[20]&&(r[20]=p,this.idx_reorder(e),n||this.show_catalog(e,null,!0)),(r[24]&&p!=!!r[16].icon_sticky||r[16].systemSticky)&&(r[16].icon_sticky=site2[site.nickname].set_icon(r[0],this.view,"sticky",r[16],p));var _=!!(o&&o.cmd&&o.cmd.SHOW);_^r[16].show_always&&(r[16].show_always=_,this.filter_dirtify(r),n||this.show_catalog(e,!0)),r[24]&&_!=!!r[16].icon_show_always&&(r[16].icon_show_always=site2[site.nickname].set_icon(r[0],this.view,"show_always",r[16],_))}};var ve=function(){function e(e,n,r,a,s){if(e.op&&t(e,n,r[0].DUMMY&&s||r[0],a))return!0;if(e.post)for(var o=1;o<r.length;o++)if(t(e,n,r[o],a))return!0;return!1}function t(e,t,n,r){if(e.sub&&n.sub&&t.test(n.sub))return!0;if(e.name&&n.name&&t.test(n.name))return!0;if(e.com)if(n.parse_funcs&&"txt"===n.parse_funcs.type_com){if(t.test(n.body||n.com))return!0}else{var a=site2[r].post_com2txt(n);if(a&&t.test(a))return!0}if(e.trip&&n.trip&&t.test(n.trip))return!0;if(e.id&&n.id&&t.test(n.id))return!0;if(e.file){if(n.filename&&t.test(n.filename))return!0;if(n.extra_files)for(var s=n.extra_files.length-1;s>=0;s--)if(n.extra_files[s].filename&&t.test(n.extra_files[s].filename))return!0}return!!(e.meta&&n.no&&t.test(n.no))||!!(e.flag&&n.country&&t.test(n.country))}return{kwd:function(t,n,r,a){if(!t.use||!t.rexps)return!0;for(var s=t.match%2==1,o=!!(t.match>=2^s),i=0;i<t.rexps.length;i++)if(o===e(t,t.rexps[i],n,r,a))return s;return!s},kwd_1:function(e,n,r){for(var a=e.match>=2,s=0;s<e.rexps.length;s++)if(t(e,e.rexps[s],n,r))return!a;return a},kwd_make_result:function(e,t,n){n||(n=pref.catalog.filter.kwd);var r=[Object.create(e[0])];r[0].search_result=this.kwd_1(n,e[0],t);for(var a=1;a<e.length;a++)this.kwd_1(n,e[a],t)&&(r[r.length]=e[a]);return 1!=r.length||r[0].search_result?r:null}}}();cataLog.catalog_filter_query_keyword=ve,Q.prototype.filter_dirtify=function(e,t){e[9][0]=null,t&&(e[9][2]=null)},Q.prototype.filter_test=function(e,t){var n=t[9][0];return null!==n?n:this.filter_query(e,t)},Q.prototype.filter_query=function(e,t){return t[9][0]=this.filter_query_1(e,t)},Q.prototype.filter_query_1=function(e,t){var n=this.pref.catalog.filter;if(t[16].show_always&&!n.kwd.active)return!0;if(this.pref[this.mode].hide_unwatched&&!t[16].lth.watched)return!1;if(n.tag&&(!n.kwd.active||!n.disTWKA)&&!this.liveTag.search_by_tags(t[16].lth))return!1;if(n.time&&(t[8][4]||t[8][0])<=n.time_obj6)return!1;if(n.time_creation&&t[8][1]<=n.time_obj6)return!1;if(n.list&&(!n.kwd.active||!n.disLWKA)){var r=this.filter_list(e,t);if(r[0]===!1)return t[9]=r,t[9][0]}if(n.kwd.active){var a=t[16].recent_posts(n.kwd.post?"auto"===pref[i].sourceOfSP?-1:null:0);if(pref.test_mode[59]){if(!ve.kwd(n.kwd,a,common_func.fullname2dbt(e)[0]))return!1}else if(n.kwd.fail_list[t[9][3]]&&t[9][2]===!1||n.kwd.suc_list[t[9][3]]&&t[9][2]===!0?pref.debug_mode[18]&&t[9][2]!==ve.kwd(n.kwd,a,common_func.fullname2dbt(e)[0])&&console.log("BUG, test59, "+e):(t[9][3]=n.kwd.timestamp,t[9][2]=ve.kwd(n.kwd,a,common_func.fullname2dbt(e)[0])),!t[9][2])return!1}return!0},Q.prototype.filter_list=function(e,t){var n=pref_func.merge_obj5(e,this.pref.catalog.filter.list_obj2,null);return n?n.time?[n.time<(t[8][4]||t[8][0]),n.time]:[!1]:[!0]},Q.prototype.filter_changed=function(){var e=this.pref.catalog.filter,t=!(e.kwd.use||e.tag||e.time||e.list)||null;for(var n in this.threads)this.threads[n][9][0]=t;this.drawn_idx=0,ge&&this.show_catalog()},
cataLog.catalog_filter_changed=v,Q.prototype.pop_up_set_contents=function(e,t,n,r){var a="sr"===t||"srpv"===t,s=r||pref.catalog.filter.kwd.posts_active,o=this.merge_bases.bases[n]||this.threads[n],l=o[16].recent_posts(a&&s&&"auto"===pref[i].sourceOfSP?-1:null),c={posts:l,__proto__:l[0]};if(!pref.test_mode[49]&&s&&c)var p=a?ve.kwd_make_result(c.posts,c.domain,r):null;if(("sr"!==t||p)&&("page"!==this.view||"pv"!==t&&("srpv"!==t||p))){if(e||(e=cnst.init("pop:border:1px solid blue")),"chart"!==t){var _=c.lth;c="dp"===t?{posts:[{search_result:!1,__proto__:c.posts[0]}].concat(_&&_.pd||[]),__proto__:c}:"pv"!==t&&p&&{posts:p,__proto__:c}||(c.posts=c.posts.slice(),c),pe.prepare_html_prep_posts(c),site2[c.domain].popups_prep(_);for(var d=0;d<c.posts.length;d++)c.posts[d]=Object.create(c.posts[d]);for(var u=site2[site.nickname].page_json2html3(c,r,{}),d=0;d<c.posts.length;d++)cataLog.format_html.prepare_html_post(c,c.posts[d],_.q);site2.DEFAULT.check_reply.set_own_posts(c),pref[i].mark_new_posts&&this.view_update_draw_merged(c),r&&!c.posts[0].search_result&&Array.prototype.forEach.call(u.getElementsByClassName("CatChan_search_miss"),function(e){e.style.display="none"}),gGEH.pns_all_keys.set(e,c.key),e.appendChild(u);var f={threads:{},pref:pref,noBlur:!0};f.threads[n]={0:e.childNodes[0],22:null},Q.prototype.view_attr_set.call(f,n,!0)}return e}};Q.prototype.prep_reserved_tags=function(e,t,n){var r=pref.catalog_board_list_obj[t]&&pref.catalog_board_list_obj[t][0].tags||null;return r&&n&&(r=r.filter(function(e){return"#"===e[0]&&"#"===e[1]})),r?this.liveTag.tags_reserved_init(r,e):null},Q.prototype.make_refresh_list_from_watch_list=function(){var e=[],t=this.pref.catalog.filter.watch_list_obj2,n=t[":REV"];for(var r in n){var a=[];for(var s in n[r])if(t[r+s].time>0)if(t[r+s].cmd&&t[r+s].cmd.PRUNED&&void 0===this.threads[r+s]){var o=r.indexOf("/"),i=r.slice(0,o),l=r.slice(o);this.insert_thread_dummy(i,l,s),pref.archive.IDB.auto_restore_watch&&j(i,l,s,this)}else a[a.length]=r+s;a.length>=pref[this.mode].refresh_src_th?e[e.length]=r:e=e.concat(a)}return{tgts:e}};cataLog.catalog_clear_threads=x,Q.prototype.refresh=function(e,t,n,r){pref4.refresh.count++,X.refresh_start(),this.footer.timestamp_set(),pref.test_mode[67]||t||archiver.refresh_start(),r||t||!pref.catalog.auto_save_filter_at_refresh||this.onchange_funcs.save();var a=this.refresh_1(i,e&&this,t,n,"refresh",this.pref[this.mode].board_list_sel,pref.catalog.filter.bookmark_list_str,!1,void 0,r);"function"==typeof a?a(function(){T(e,t,n)}):this.refresh_tgts=a},Q.prototype.refresh_1=function(e,t,n,r,a,s,o,i,l,c){var p="object"!=typeof t||"bg"===t.pref[t.mode].refresh_src.slice(0,2)?y(s,o,t,!n&&!c):null,_="object"==typeof t&&"wl"===t.pref[t.mode].refresh_src.slice(-2)?this.make_refresh_list_from_watch_list():null,d=p&&_?(p.tgts=p.tgts.concat(_.tgts),p):p||_;if("function"==typeof d)return d;var u=d.tgts;if(i)for(var f={},h=0;h<u.length;h++){var m=common_func.name2domainboardthread(u[h],!0);m[2][0].search(/^[pqcj]/)!=-1?f[m[0]+m[1]]=null:f[m[0]+m[1]+m[2].replace(/^t/,"")]=null}a&&pref3.stats.use&&pref.stats.auto_acquisition_all&&stats.register_auto_acquisition(s),u=w(u,n,e);var g=t?r?2:4:0,b=t&&t.health_indicator||W;return 0===u.length?t?scan.scan_refresh(b,u,g,d.tgt_domains):u:(t&&(k(),pref.catalog_refresh_clear&&!n&&x(pref4.scan.max_threads_at_refresh,!0)),a&&oe.scan_init(a,u,{refresh:t,indicator:b,callback:function(){scan.scan_refresh(b,u,g,d.tgt_domains),l&&l()},from_auto:r,load_on_demand:pref[e].load_on_demand,priority:g}),i?Object.keys(f):u)},cataLog.catalog_refresh_end=C,o&&site2[site.nickname].catalog_frame_prep(V);var ye=function(){cnst.tb_prep_for_embed(Z),Z.appendChild(te),site2[site.nickname].catalog_native_prep(Date.now(),te,Z,pClg.health_indicator.pn2,"catalog"===i);var e=N(null,null,!0);if("page"===i&&site2[site.nickname].all_boards&&site2[site.nickname].all_boards.indexOf(site.board)!=-1||"thread"===i&&pref.thread.env.auto_update_native){var t=new MutationObserver(N),n="page"===i?e[0].pn.parentNode:e[0].pn;pClg.observer_myself={observe:function(){t.observe(n,{childList:!0})},disconnect:function(){t.disconnect()}},pClg.observer_myself.observe(),pref.test_mode[137]&&le.change_mode()}if(ue&&ue(),!pref.catalog.filter.kwd.active||"page"!==i&&"catalog"!==i||ge(),0!==pref.catalog_board_list_sel&&(!pref.catalog.board.all_boards||pref.catalog_board_list_sel!==pref.catalog_board_list_obj.length-1)){var r=pClg.refresh_1(i,!1,!1,!1,!1,pref.catalog_board_list_sel,!1,!1,null,!0),a=site.nickname+site.board+("catalog"===i?"c0":"page"===i?"p0":site.no),s=site.nickname+site.board+("catalog"===i?"j0":"page"===i?"q0":"t"+site.no);Array.isArray(r)&&pref.catalog.refresh.at_switch&&r.indexOf(a)===-1&&r.indexOf(s)===-1&&pClg.clear_threads(0)}pref[i].merge_auto_list&&site2.DEFAULT.update_posts_merge_bases.auto_merge_list(site.key,pClg)};if(l){var we=site2[site.nickname].parse_funcs[site.whereami+"_html"];we.ths_hook?we.ths_hook(ye):setTimeout(ye,0)}cataLog.insert_myself=N,window.opener&&window.name&&"A"===window.name.slice(-1)||"archive"===site.whereami||setTimeout(function(){(0!=pref.catalog_board_list_sel||pref[i].env.refresh_initial)&&T("boards"!==site.whereami,l,!1)},1),cataLog.restore_th_from_IDB=j,Q.prototype.Remove_thread_refresh=function(e,t,n,r){if(gClg.AllThreads[e]){for(var a=pref.liveTag.rm_404,s=r||"no"===a||"imm"!==a&&t&&t.watched&&("watched"===a||t.nr),o=0;o<gClg.Clgs.length;o++){var i=gClg.Clgs[o].threads[e];if(i){var l="IDB"===i[14]||"FILE"===i[14];s||!n&&l?l||"x"!==i[14]&&(i[14]="x",gClg.Clgs[o].footer.update_force(e)):gClg.Clgs[o].remove_thread(e,!1,!0)}}s||delete gClg.Maintain_AllThreads[e]}return s},Q.prototype.rm_items_404_clearPRUNEDs=function(){for(var e=Object.create(null),t=Object.create(e),n={common:{watch_list_rm404:"imm"},liveTag:{rm_404:"imm"}},r=this.pref.catalog.filter,a=[r.watch_list_obj2,r.attr_list_obj2,r.list_obj2],s=0;s<a.length;s++){var o=a[s];for(var i in o)if(o[i].cmd&&o[i].cmd.PRUNED){var l=common_func.fullname2dbt(i);D(l[0],l[1],e,t,this,l[2],n)}}pref.common.consolidated_watch_list&&pref.common.sync_watch_list&&gClg.Sync_watch_save([null,"PRUNED",r.watch_list_str])};pref_func.mirror_targets.pn12_0_2=ee,pref_func.mirror_targets.pn12_0_4=te;var ke=function(e){this.ppn=e.ppn,this.subscribers=[],this.valid=null,this.last_viewed=null,this.last_Y=0,this.init2(e)};ke.prototype={setup:function(e){!pref[i].scroll_lock||this.valid||e?this.valid&&(this.ppn.removeEventListener("mouseover",this.valid,!0),this.valid=null):(this.valid=this.mouseover_lock.bind(this),this.ppn.addEventListener("mouseover",this.valid,!0))},mouseover_lock:function(e){this.last_viewed=e.target,this.last_Y=e.clientY},change:function(){var e=pref.script_prefix+"_expander";return function(t){if(t.target.className===e){var n=t.target.getAttribute("data-key");cataLog.threads[n][16].expand_event(t.target.selectedIndex),t.target.blur()}}}(),blacklist_click:new WeakSet,geh:site2[site.nickname].general_event_handler[site.whereami],click_bl:function(e){e.target;e.target.className===pref.script_prefix+"_tag"&&liveTag.boardlist_click_entry(e)},click:function(e){function t(e,t,n){var n=t.target,r=document.createElement("span");if(r.innerHTML=' [<a data-cmd="'+pref.script_prefix+'_remove_next">Remove</a>] ',!n.nextSibling||n.nextSibling.innerHTML!==r.innerHTML){t.target.parentNode.insertBefore(r,n.nextSibling);var a=document.createElement("div");a.innerHTML='<iframe src="'+e+'" width="640" height="360" frameborder="0" allowfullscreen=""></iframe>',a.classList.add("media-embed"),n.parentNode.insertBefore(a,r.nextSibling)}t.stopPropagation(),t.preventDefault()}var n=e.target,r=this["."]||pClg;if(e.target.className===pref.script_prefix+"_tag")r.liveTag.tag_node_onclick(e);else if(e.target.className===pref.script_prefix+"_embeddedTriage")le.embedded_onclick(e,r);else if(e.target.className===pref.script_prefix+"_UImerge"){var a=gGEH.get_key_recursive(e.target,e.currentTarget),s=e.target.previousSibling.previousSibling.getAttribute("href"),o=site2[site.nickname].popups_href2dbtp(s);r.merge_bases.add_to_list(a,o.slice(0,3).join(""),r)}else if(!pref.test_mode[104]){var l=ke.prototype.geh.isThumbnail(e);if("catalog"===r.view&&(l||"entire"===pref[r.view].click_area)||"headline"===r.view&&n.className!==pref.script_prefix+"_tag"){e.preventDefault();var a=gGEH.get_key_recursive(e.target,e.currentTarget);"string"!=typeof a&&(a=a.lths[0].key),a&&r.click_thread(a,null)}else if(l){var c=site2.DEFAULT.popups_posts.href2domain(n.getAttribute("src"));ke.prototype.blacklist_click.has(n)||pref[i].env.expand_thumbnail_inline_native&&pref[i].env.event_dynamic&&c===site.nickname||de.expand_thumbnail_inline.call(e.target,e)}}if("A"===n.tagName){if("no"!==pref[r.mode].inline_post&&site2.DEFAULT.popups_link_regex.test(n.textContent)&&(site2.DEFAULT.popups_posts.inline_post(e,r),e.preventDefault(),e.stopPropagation()),pref.test_mode[93]){var p=n.getAttribute("download");if(p){var s=n.getAttribute("href"),_=s.search(/^(https*:)*\/\//)!=-1&&s.replace(/^(https*:)*\/\//,"").match(/^([^\/]*)\//)[1];if(site2.ALL[_]&&(_=site2[site2.ALL[_]].nickname),_!=site2[site.nickname].domain_url)return httpd.req({tgts:[{url:s,domain:_,archive:p,responseType:"blob"}],max:1,initiator:"download",callback_1:function(){}},6),e.preventDefault(),void e.stopPropagation()}}if(pref.test_mode[87])if(n.href.indexOf("//www.youtube.com")!==-1)t(n.href.replace(/watch\?v=/,"embed/"),e);else if(n.href.indexOf("//youtu.be")!==-1)t(n.href.replace(/youtu.be/,"youtube.com/embed"),e);else{var d=n.getAttribute("data-cmd");d&&0===d.indexOf(pref.script_prefix)&&"remove_next"===(d=d.substr(pref.script_prefix.length+1))&&function(e){e.target.parentNode.parentNode.removeChild(e.target.parentNode.nextSibling),e.target.parentNode.parentNode.removeChild(e.target.parentNode)}(e)}}},get_last_viewed:function(){return this.last_viewed?site2[site.nickname].general_event_handler[site.whereami].get_mark(this.last_viewed,h()+this.last_Y):null},clear_last_viewed:function(){this.last_viewed=null},init:function(){site2[site.nickname].parse_funcs[site.whereami+"_html"].dynamic_image_hover,site2[site.nickname].general_event_handler[site.whereami];common_func.dom_addEventListener(this.subscribers,this.ppn,"change",this.change),pref.test_mode[104]||site.popup_body.addEventListener("click",this.click,!1),this.setup(),site.root_body.addEventListener("dragstart",this.dragstart,!1),site.root_body.addEventListener("dragend",this.dragend,!1)},init2:function(e){var t={".":e,__proto__:this};(pref.test_mode[87]||pref.test_mode[93]||!pref.test_mode[104])&&common_func.dom_addEventListener(this.subscribers,this.ppn,"click",this.click.bind(t)),site2.DEFAULT.popups_posts.init2(pref.test_mode[141]?e.pppn:e.ppn,t)},destroy:function(){this.setup(!0),common_func.dom_removeEventListener(this.subscribers)},mouseover:function(e,t){var n=e.target;site2.DEFAULT.popups_posts.over(e,t),pref.liveTag.info&&pref.tooltips.info.show&&(n.className===pref.script_prefix+"_tag"?pref_func.tooltips.req_show("info",e,liveTag.tag_onmouseover):pref_func.tooltips.hide2())},mouseleave_bl:function(e){pref.liveTag.info&&pref_func.tooltips.hide2()},drag_sx:0,drag_sy:0,dragstart:function(e){var t=ke.prototype;t.drag_sx=e.screenX,t.drag_sy=e.screenY},dragend:function(e){if(pref[i].thumbnail.hover.dragfloat&&(de.hover_ex||"IMG"===e.target.tagName)){var t=ke.prototype,n=de.image_hover_snatch(),r=(n?parseInt(n.style.right,10):cnst.left2right(e.clientX-e.offsetX,e.target))-(e.screenX-t.drag_sx),a=(n?parseInt(n.style.right,10):e.clientY-e.offsetY)+e.screenY-t.drag_sy;cnst.init3({func_str:"right:"+r+"px:top:"+a+"px:ftb:overflow:hidden:Show"}).cn.appendChild(n||e.target.cloneNode()),n&&de.image_hover_snatch_end()}}},cataLog.GEH=ke,cataLog.general_event_handler=new ke(pClg),setTimeout(cataLog.general_event_handler.init.bind(cataLog.general_event_handler),500);var xe=function(e){return function(t){e(t,!0),t.stopPropagation()}}(ke.prototype.mouseover);return pref.test_mode[98]||site.popup_body.addEventListener("mouseover",xe,!1),site.root_body.addEventListener("mouseover",ke.prototype.mouseover,!1),site.components.boardlist&&site.components.boardlist.addEventListener("click",ke.prototype.click_bl,!1),site2.DEFAULT.popups_posts.init(pClg.ppn),pref.test_mode[114]||(pClg.GEH=cataLog.general_event_handler),window.addEventListener("storage",Q.prototype.Sync_watch_load,!1),stats&&pref.stats.auto_acquisition_scan&&"archive"!==site.whereami&&setTimeout(stats.auto_acquisition_init,1e3*pref.stats.auto_acquisition_scan_delay),{destroy:function(){cataLog.general_event_handler.destroy(),pref_func.mirror_targets.pn12_0_2=null,pref_func.mirror_targets.pn12_0_4=null,x(0),brwsr.sw_cache&&brwsr.sw_cache.subscribe&&brwsr.sw_cache.subscribe(!1),W.destroy(),cnst.auto_shrink_board_selector.destroy(ne),a(),le.destroy(),pref_func.tooltips.remove_root(te),pref_func.tooltips.hide(),V.parentNode.removeChild(V),window.removeEventListener("storage",site2[site.nickname].prep_own_posts_event,!1),V=null,liveTag.pn=null;for(var e in cataLog)cataLog[e]=null;return window.removeEventListener("storage",Q.prototype.Sync_watch_load,!1),null},triage_exe_pipe:c,catalog_insert:A,pn12_0_4:te,pn12_0_2:ee,get_threads:function(){return re},catalog_filter_changed:v,scan_boards:oe,show_catalog:ge,catalog_liveTag_scan_site:Y.scanSite,make_watcher:F}}var a,s,o,i,l,c=null;return cataLog.set_embed_xxxx=n,n(),e&&e.addEventListener("click",t,!1),styleSheet.init(i),pref.test_mode[98]||"catalog"!==i||styleSheet.register(".backlink","display:inline;font-size:0.8em;"),{catalog_func:function(){return c},show_hide:t}}function make_chart_obj(e){function t(){cnst.subscribe(c,new _),1===c.length&&(common_func.dom_addEventListener(common_obj.events_beforeunload,window,"focus",n),common_func.dom_addEventListener(common_obj.events_beforeunload,window,"blur",r))}function n(){cnst.foreach(c,function(e){e.chart_posts.options.animation=e.options.animation})}function r(){pref.chart.off_anime_blur&&cnst.foreach(c,function(e){e.chart_posts.options.animation=!1})}function a(){cnst.foreach(c,function(e){e.destroy()})}function s(){return{labels:["dummy","dummy"],datasets:[]}}function o(e,t,n){return{label:e,fillColor:"rgba("+t+","+n+")",strokeColor:"rgba("+t+",1)",pointColor:"rgba("+t+",1)",pointStrokeColor:"#fff",pointHighlightFill:"#fff",pointHighlightStroke:"rgba("+t+",1)",data:[0,0]}}var i='<select name="chart.inst.time_sel"><option>1 min</option><option>10 mins</option><option>1 hour</option><option>1 day</option><option>1 week</option><select>',l=['Number of points: <ITB3"chart.inst.len"><br>','Scale of new thread: <ITB3"chart.inst.scale_thread"><br>',"Show: Posts/Threads:<br>",'&emsp;&emsp;<IC"chart.inst.show.np"><IC"chart.inst.show.nt" disabled style="visibility:hidden">Estimated, <IC"chart.inst.clip_np">Clip:<ITB4"chart.inst.clip_np_val"><br>','&emsp;&emsp;<IC"chart.inst.show.p"><IC"chart.inst.show.t">Observed<br>','&emsp;&emsp;<IC"chart.inst.show.ep"><IC"chart.inst.show.et">Alive<br>','<IC"chart.inst.show_legend">Legend<br>','<IC"chart.inst.options.animation">Animation (Doesn\'t work on FF)<br>','<IC"chart.inst.options.pointDot">Point dot: radius <ITB1"chart.inst.options.pointDotRadius"><br>'];if(!e)return{time_unit_sel_html:i,chart_options_str:l};e.addEventListener("click",t,!1);var c=[];window.addEventListener("beforeunload",a,!1);var p=0,_=function(e,t,n){if(n||common_func.deep_copy(this,pref.chart.inst),e)this.pn_canvas_root=e,this.show={np:!1,p:!0,ep:!1,nt:!1,t:!0,et:!1};else{this.name="graph_"+p++,this.pn2_obj=cnst.init3({this_obj:this,__proto__:this.pn2_template});var r=this.pn2_obj.pn;cnst.add_to_tb(r,i+(n?"":'<select name="chart.inst.board_sel"><select>')+cnst.icons.button_settings());r.childNodes[1].innerHTML=pref_func.format_html_str('<div style="display:none"><div style="float:right">'+l.join("")+'</div><div style="clear:both"></div></div><div style="position:relative"></div>'),pref_func.apply_prep(r,!1);var a=r.getElementsByTagName("select");cnst.auto_shrink_selector(a["chart.inst.time_sel"]),this.legend=cnst.init3({func_str:"border:1px solid lightblue:cursor:move:position:absolute:left:80px:top:40px"}),this.pn2=r,this.set_legend_str();var s=this.onchange_entry.bind(this);if(r.childNodes[0].onchange=s,r.childNodes[1].childNodes[0].onchange=s,n){cnst.bottom_top(r),this.show_legend=!1;for(var o=r.querySelectorAll("input[name],textarea[name],select[name]"),_=0;_<o.length;_++){var d=pref_func.get_tgt(o[_].getAttribute("name").replace(/chart.inst./,""),this);pref_func.apply_prep_load(o[_],d[0],d[1])}return cnst.subscribe(c,this),r}this.pn_board_sel=a["chart.inst.board_sel"],cnst.auto_shrink_board_selector.setup(this.pn_board_sel,pref.catalog_board_list_sel),this.board_sel=pref.catalog_board_list_sel,this.pn_canvas_root=r.childNodes[1].childNodes[1]}this.pn_canvas_root.style.width=pref.chart.window_width+"px",this.pn_canvas_root.style.height=pref.chart.window_height+"px",this.pn_canvas_root.style.resize="both",this.pn_canvas_root.style.overflow="hidden",this.pn_canvas=document.createElement("canvas"),this.pn_canvas_root.appendChild(this.pn_canvas),this.chart_size_changed(!0),this.stats=e?new stats.Stats(this,t,"popup"):new stats.Stats(this,this.get_tgts(),pref.catalog_board_list_obj[this.board_sel][0].key),this.canvas_active=!0,this.pn_canvas_root.onmousemove=this.deactivate_canvas_if_mouse_on_corner.bind(this),this.pn_canvas_root.onclick=this.chart_size_changed.bind(this),e||(this.show_legend&&this.append_legend(),cnst.bottom_top(r))};return _.prototype={get_tgts:function(e){return pClg.refresh_1?pClg.refresh_1("chart",!1,!1,!1,e,this.board_sel,!1,!0):[site.nickname+site.board]},board_sel_changed:function(e){e.target.blur();var t=this.get_tgts(pref.chart.instant_scan?this.name:null);"function"==typeof t?t(this.board_sel_changed.bind(this)):this.stats.tgts_changed(t,pref.catalog_board_list_obj[this.board_sel][0].key)},len_changed:function(){this.len>this.stats.len?this.stats.len_changed.call(this.stats,this.len):this.stats.len!=pref.stats.len_capture?this.stats.len_changed.call(this.stats,pref.stats.len_capture):this.replace_data(this.data_src)},deactivate_canvas_if_mouse_on_corner:function(e){var t=e.currentTarget.style;(parseInt(t.width,10)-e.offsetX<=10&&parseInt(t.height,10)-e.offsetY<=10)^!this.canvas_active&&(this.pn_canvas.style.pointerEvents=this.canvas_active?"none":"auto",this.canvas_active=!this.canvas_active)},chart_size_changed:function(e){this.pn_canvas.style.width=this.pn_canvas_root.style.width,this.pn_canvas.style.height=this.pn_canvas_root.style.height,this.pn_canvas.width=this.pn_canvas_root.clientWidth,this.pn_canvas.height=this.pn_canvas_root.clientHeight,e!==!0&&this.chart_redraw()},chart_redraw:function(){this.chart_posts&&this.chart_posts.destroy(),this.data_graph=s();var e=this.data_graph.datasets,t=this.data_src.fromNo,n=this.data_src.rm,r=this.data_src,a=0;this.idxs={};var i=this.idxs;i.np=t&&this.show.np?a++:-1,i.p=this.show.p?a++:-1,i.ep=n&&this.show.ep?a++:-1,i.t=this.show.t?a++:-1,i.et=n&&this.show.et?a++:-1,i.np!=-1&&(e[i.np]=o("post_fromNo","151,187,205",.2)),i.p!=-1&&(e[i.p]=o("Posts","98,152,179",.2)),i.ep!=-1&&(e[i.ep]=o("exist_p","66,119,136",.15)),i.t!=-1&&(e[i.t]=o("Threads","204,0,0",.2)),i.et!=-1&&(e[i.et]=o("exist_t","140,0,0",.2)),pref.test_mode[39]&&e[pref.test_mode.num]&&(e[pref.test_mode.num]=o(e[pref.test_mode.num].label,pref.test_mode.test_str,pref.test_mode.num_f));var l=this.len<this.stats.len?this.stats.len-this.len:0;if(this.data_graph.labels=r.data_l.slice(l),i.p!=-1&&(e[i.p].data=this.stats.merge_1(r.data_p.slice(l),r.data_p_old?r.data_p_old.slice(l):null)),i.t!=-1&&(e[i.t].data=this.stats.merge_1(r.data_t.slice(l),r.data_t_old?r.data_t_old.slice(l):null),1!=this.scale_thread&&this.scale_setup(e[i.t].data)),n&&(i.ep!=-1&&(e[i.ep].data=this.arr_dec_slice(r.data_p,n.data_p,l)),i.et!=-1&&(e[i.et].data=this.arr_dec_slice(r.data_t,n.data_t,l),1!=this.scale_thread&&this.scale_setup(e[i.et].data)),pref.test_mode[40]&&(e[a]=o("old_p","0,255,0",.1),e[a++].data=r.data_p_old.slice(l),e[a]=o("p_raw","98,152,179",.2),e[a++].data=r.data_p.slice(l))),t&&i.np!=-1){if(e[i.np].data=t.data_p_old?t.data_p_old.concat(t.data_p.slice(t.data_p_old.length)).slice(l):t.data_p.slice(l),t.data_p_old){var c=t.data_p_old.length-1;t.data_p[c]>t.data_p_old[c]&&c-l>=0&&(e[i.np].data[c-l]=t.data_p[c])}if(this.clip_np)for(var p=e[i.np].data,_=0;_<p.length;_++)p[_]=this.clip_np_func(p[_]);pref.test_mode[41]&&(e[a]=o("post_fromNo_old","0,255,0",.2),e[a++].data=t.data_p_old.slice(l),e[a]=o("post_fromNo","0,128,0",0),e[a++].data=t.data_p.slice(l))}this.scale_thread_old=this.scale_thread;var d=this.pn_canvas.getContext("2d");this.chart_posts=new Chart(d).Line(this.data_graph,this.options)},clip_np_func:function(e){return e<0?0:e>this.clip_np_val?this.clip_np_val:e},arr_dec_slice:function(e,t,n){for(var r=[],a=0,s=n;s<e.length;s++)r[a++]=e[s]-t[s];return r},scale_setup:function(e,t){if(void 0!==t)for(var n=0;n<e.length;n++)e[n].value=e[n].value/t*this.scale_thread;else for(var n=0;n<e.length;n++)e[n]*=this.scale_thread;return e},scale_changed:function(){this.set_legend_str(),0!==this.scale_thread_old?(this.scale_setup(this.chart_posts.datasets[this.idxs.t].points,this.scale_thread_old),void 0!==this.idxs.et&&this.data_graph.datasets[this.idxs.et]&&this.scale_setup(this.chart_posts.datasets[this.idxs.et].points,this.scale_thread_old),this.chart_posts.update()):this.chart_redraw(),this.scale_thread_old=this.scale_thread},set_legend_str:function(){var e='<span style="color:rgba(98,152,179,1)">●</span><span style="color: black;"> Posts</span><br><span style="color:rgba(204,0,0,1)">●</span><span style="color: black;"> Threads '+(1==this.scale_thread?"":"x"+this.scale_thread+" ")+"</span>";this.legend.pn.innerHTML=e},destroy:function(){return brwsr.ff||this.chart_posts.stop(),this.chart_posts.destroy(),this.stats.destroy(),this.stats=null,this.pn2&&(cnst.div_destroy(this.legend.pn,!1,this.legend),cnst.div_destroy(this.pn2,!0,this.pn2_obj),cnst.auto_shrink_board_selector.destroy(this.pn_board_sel),cnst.unsubscribe(c,this)),null},replace_data:function(e){this.stats||(this.stats=e),this.data_src=e,this.chart_redraw()},update_data2:function(e){for(var t=e.shift;t>0;)this.chart_posts.removeData(),t--;for(var n=[],t=e.data_p.length-e.shift;t<e.data_p.length;t++)e.fromNo&&this.idxs.np!=-1&&(n[this.idxs.np]=this.clip_np?this.clip_np_func(e.fromNo.data_p[t]):e.fromNo.data_p[t]),this.idxs.p!=-1&&(n[this.idxs.p]=e.data_p[t]),this.idxs.t!=-1&&(n[this.idxs.t]=e.data_t[t]*this.scale_thread),e.rm&&(this.idxs.ep!=-1&&(n[this.idxs.ep]=e.data_p[t]-e.rm.data_p[t]),this.idxs.et!=-1&&(n[this.idxs.et]=(e.data_t[t]-e.rm.data_t[t])*this.scale_thread)),this.chart_posts.addData(n,e.data_l[t]);var r=this.idxs.p!=-1?this.chart_posts.datasets[this.idxs.p]:null,a=this.idxs.t!=-1?this.chart_posts.datasets[this.idxs.t]:null,s=this.idxs.ep!=-1&&e.rm?this.chart_posts.datasets[this.idxs.ep]:null,o=this.idxs.et!=-1&&e.rm?this.chart_posts.datasets[this.idxs.et]:null,i=this.idxs.np!=-1&&e.fromNo?this.chart_posts.datasets[this.idxs.np]:null,l=e.min_idx-(this.stats.len-this.len),t=e.min_idx;for(l<0&&(t+=-l,l=0),pref.stats.patch_tm&&i&&l>0&&t>0&&(i.points[l-1].value=this.clip_np?this.clip_np_func(e.fromNo.data_p[t-1]):e.fromNo.data_p[t-1]);t<e.data_p.length-e.shift;)r&&(r.points[l].value=e.data_p_old&&e.data_p_old[t]>e.data_p[t]?e.data_p_old[t]:e.data_p[t]),a&&(a.points[l].value=(e.data_t_old&&e.data_t_old[t]>e.data_t[t]?e.data_t_old[t]:e.data_t[t])*this.scale_thread),s&&(s.points[l].value=e.data_p[t]-e.rm.data_p[t]),o&&(o.points[l].value=(e.data_t[t]-e.rm.data_t[t])*this.scale_thread),i&&(i.points[l].value=this.clip_np?this.clip_np_func(e.fromNo.data_p[t]):e.fromNo.data_p[t]),l++,t++;e.shift=0,this.chart_posts.update()},append_legend:function(){this.pn_canvas_root.appendChild(this.legend.pn)},remove_legend:function(){this.pn_canvas_root.removeChild(this.legend.pn)}},_.prototype.pn2_template={get func_str(){return"left:"+(p-1)%5*20+"px:tile2:get:bottom:"+(p-1)%5*20+":Show:tb"},maximize:_.prototype.chart_size_changed,maximize_embed_style_pnch1:{},maximize_float_style_pnch1:{},exit:_.prototype.destroy,get maximize_tgt(){return this.this_obj.pn_canvas_root}},_.prototype.onchange_entry=function(e){var t=pref_func.get_tgt(e.target.name.replace(/chart.inst./,""),this),n=t[1];pref_func.apply_prep_set(t[0],t[1],e.target),this.onchange_funcs[n]&&this.onchange_funcs[n].call(this,e)},_.prototype.onchange_funcs={pointDot:_.prototype.chart_redraw,pointDotRadius:_.prototype.chart_redraw,scale_thread:_.prototype.scale_changed,animation:function(){this.chart_posts.options.animation=this.options.animation},len:_.prototype.len_changed,separate:function(){this.stats.init()},time_sel:function(e){e.target.blur(),this.stats.time_unit_changed(this.time_sel)},board_sel:_.prototype.board_sel_changed,show_legend:function(e){e.target.checked?this.append_legend():this.remove_legend()},clip_np:_.prototype.chart_redraw,clip_np_val:function(){this.clip_np||(this.clip_np=!0,this.pn2.querySelector('input[name="chart.inst.clip_np"]').checked=!0),_.prototype.chart_redraw.call(this)}},_.prototype.onchange_funcs.np=_.prototype.onchange_funcs.separate,_.prototype.onchange_funcs.p=_.prototype.onchange_funcs.separate,_.prototype.onchange_funcs.ep=_.prototype.onchange_funcs.separate,_.prototype.onchange_funcs.t=_.prototype.onchange_funcs.separate,_.prototype.onchange_funcs.et=_.prototype.onchange_funcs.separate,{clear:function(){},dump:function(e){},data_update:function(e,t,n){},PostChart:_,time_unit_sel_html:i,chart_options_str:l}}function make_setting_obj(e){function t(){r=n(null==r)}function n(e){function n(e){pref_func.apply_prep(a,e),e&&(listener(),timer_obj.init())}function s(e){var r=e.currentTarget.value;"apply"==r?n(!0):"cancel"==r?t():"ok"==r?(n(!0),t()):"apply+save"==r?(n(!0),localStorage&&(localStorage[pref.script_prefix+".pref"]=JSON.stringify(pref))):"load_default"==r?(pref=pref_default(),n(!1),n(!0),pref_func.obj_init()):"load_samples"==r?pref_func.pref_samples.init():"Dump(csv)"==r?chart_obj.dump("csv"):"Dump(obj)"==r?chart_obj.dump("obj"):"Clear data"==r?chart_obj.clear():"JSON"==r?(pref_func.apply_prep(a.getElementsByTagName("TEXTAREA").overwrite_site2_json_str,!0),pref_func.site2_json()):"EVAL"==r&&(pref_func.apply_prep(a.getElementsByTagName("TEXTAREA").overwrite_site2_eval_str,!0),pref_func.site2_eval())}if(e&&(pref.test_mode[17]?(r=document.createElement("div"),r.innerHTML="<div></div><div></div>",site.root_body.appendChild(r)):r=cnst.init("left:0px:tile:get:bottom:Show:tb",cnst.void_func,cnst.void_func,t,cnst.void_func),a=pref.test_mode[17]?r:r.childNodes[1],a.innerHTML='<div><div style="float:left">Statistics:<br>&emsp;Interval: <input type="text" name="interval_found" size="6" style="text-align: right;">min<br>&emsp;<input type="checkbox" name="check_page"> Show page no. of this thread<br>&emsp;&emsp;<input type="checkbox" name="show_page_fraction"> Show fraction of page No.<br>&emsp;<input type="checkbox" name="check_post"> Show num of new posts in this board<br>&emsp;<input type="checkbox" name="check_thread"> Show num of new threads in this board<br>&emsp;&emsp; Max_capture: <input type="text" name="max_capture" size="6" style="text-align: right;"> points<br>&emsp;&emsp;&emsp;Show recent : <input type="text" name="max_graph" size="6" style="text-align: right;"> points in graph<br>&emsp;&emsp;&emsp;Scale of #threads in graph: <input type="text" name="scale_thread" size="6" style="text-align: right;"><br><!-- &emsp;&emsp;<input type="radio" name="autoconf" value="auto"> Automatic configuration<br>&emsp;&emsp;<input type="radio" name="autoconf" value="manual"> Manual configuration<br> -->&emsp;&emsp;&emsp;<input type="radio" name="aggregator" value="true"> Aggregate data<br>&emsp;&emsp;&emsp;&emsp;<input type="checkbox" name="write_to_ls"> Write to localStrage (server)<br>&emsp;&emsp;&emsp;<input type="radio" name="aggregator" value="false"> Listen from localStrage (client)<br>&emsp;&emsp;<input type="checkbox" name="load_data"> Load data from localStrage at the start<br>&emsp;&emsp;Import format (drop whole text on graph)<br>&emsp;&emsp;&emsp;<input type="radio" name="import_format" value="csv"> csv<br>&emsp;&emsp;&emsp;<input type="radio" name="import_format" value="obj"> obj<br>&emsp;&emsp;<input type="button" value="Dump(csv)"><input type="button" value="Dump(obj)">&emsp;<input type="button" value="Clear data"><br><input type="checkbox" name="auto_start"> Start automatically (Delayed 10sec.)<br><br><!-- Post form:<br>&emsp;<input type="checkbox" name="hide_rules"> Hide rules<br>&emsp;<input type="checkbox" name="hide_Go"> Hide \'Go\'<br> --><br><br></div></div><div style="clear: both"><input type="button" value="cancel"><input type="button" value="apply"><input type="button" value="ok">&emsp;<input type="button" value="apply+save"><input type="button" value="load_default"><input type="button" value="load_samples"></div>',pref.test_mode[17]||(n(!1),cnst.bottom_top(r))),!pref.test_mode[17])for(var o=a.getElementsByTagName("input"),i=0;i<o.length;i++)"button"==o[i].type&&(e?o[i].addEventListener("click",s,!1):o[i].removeEventListener("click",s,!1));return e?r:pref.test_mode[17]?(a.innerHTML="",r.parentNode.removeChild(r),null):(a=null,cnst.div_destroy(r,!0))}e.addEventListener("click",t,!1);var r=null,a=null}function make_listener(){function e(e){if(null!==e.newValue&&e.key===pipe_name&&"false"===pref.aggregator){var t=brwsr.JSON_parse(e.newValue);t[0]!=n&&(n=t[0],chart_obj.data_update(t[0],t[1],t[2]),timer_obj.show_page([null,"+"+t[1]+"+"+t[2]+"@"+t[0]]))}}function t(){r||"false"!==pref.aggregator?r&&"true"===pref.aggregator&&(window.removeEventListener("storage",e,!1),r=!1):(window.addEventListener("storage",e,!1),r=!0)}var n,r=!1;return t(),t}function make_timer_obj(e){function t(t){null==r&&(pref.check_page||"true"==pref.aggregator&&(pref.check_thread||pref.check_post))?r=make_timer(e):null!=r&&(t&&(pref.check_page||"false"!=pref.aggregator&&(pref.check_thread||pref.check_post))?t&&r.timer().restart(!1):n())}function n(){r=r.destroy(),e.style.color="gray"}e.addEventListener("click",function(){t(!1)},!1);var r=null;pref.auto_start&&setTimeout(function(){t(!1)},1e4);var a=["",""];return{init:function(){t(!0)},finished:function(){n()},timer:function(){return r},show_page:function(t){null!=t[0]&&(a[0]=t[0]+"@"+cnst.get_time()),t.length>=2&&null!=t[1]&&(a[1]=t[1]),t.length>=3&&null!=t[2]&&(a[0]=t[2]),""!=a[0]&&""!=a[1]?e.textContent=a[0]+", "+a[1]:e.textContent=a[0]+a[1]}}}function make_timer(e){function t(e,t,r){var a=common_func.name2domainboardthread(e,!0)[2].substr(1);n(t.date,a,(new DOMParser).parseFromString(t.responseText,"text/html"))}function n(e,t,n){for(var r=site.get_ops(n),a=_.myself(),s=0;s<r.length;s++)if(a==r[s]){o.str_set(t,s);var i=o.str_get()+"@"+new Date(e).toLocaleTimeString();timer_obj.show_page([null,null,i]),o.prep_next(),_.restart(!0),pref.check_page&&options.func0_exe(o.str_get());break}}function r(e){var t=o.no();if(a(e,_.myself(),t),o.all_got()&&o.no()!=site.max_page){var n=0==i?0:l-i,r="";pref.check_page&&(r=o.str_get()),pref.check_post&&(r=r+"+"+n),pref.check_thread&&(r=r+"+"+p),timer_obj.show_page([r]),o.prep_next(),_.found(),n=parseInt(n,10),(isNaN(n)||null==n)&&(n=0),(pref.check_post||pref.check_thread)&&chart_obj.data_update(_.timestr(),n,p),i=l,pref.check_page&&options.func0_exe(o.str_get())}else timer_obj.show_page([t+"?"]),o.step(),_.missing()}function a(e,t,n){for(var r=site.get_ops(e),a=0;a<r.length;a++)if(t==r[a]){o.str_set(n,a),o.flag_set(2);break}if(t==-1)return r[0];if(0==n&&(o.flag_set(0),l=s(e)),n==site.max_page-1){o.flag_set(1);var i=c.length;if(0!=i){for(var _=r[r.length-1],a=0;a<i&&_!=c[i-a-1];)a++;p=a}else p=0;c=r}}function s(e){for(var t=site.get_posts(e),n=t[0],r=1;r<t.length;r++)t[r]>n&&(n=t[r]);return n}var o=function(){function e(){var e=0;t[0]=-1,t[1]=-1,pref.check_post&&(t[e++]=0),pref.check_thread&&(t[e++]=site.max_page-1);var a=(r+1)%(site.max_page+1)
;r!=t[0]&&r!=t[1]&&(t[e++]=r),a!=t[0]&&a!=t[1]&&(t[e++]=a);for(var o=0;o<=site.max_page;o++)o!=r&&o!=a&&o!=t[0]&&o!=t[1]&&(t[e++]=o);flag=[!pref.check_post,!pref.check_thread,!s],n=0}var t=[],n=0,r=0,a="",s=pref.check_page;return window.location.href.search(site.thread_keyword)==-1&&(s=!1),e(),{no:function(){return t[n]},step:function(){n=(n+1)%(site.max_page+1)},prep_next:function(){e()},flag_set:function(e){flag[e]=!0},all_got:function(){return flag[0]&&flag[1]&&flag[2]},str_set:function(e,t){s&&e!=site.max_page&&(a=e+"."+t,r=e)},str_get:function(){return a},init:function(){e()}}}(),i=0,l=0,c=[],p=0,_=function(){function t(e){var t=new DOMParser;if(404==p.status)_.dead();else{var n=Date.now();pref.info_server&&o.no()!=site.max_page&&brwsr.sw_cache&&brwsr.sw_cache.setItem(info_raw+"p"+o.no(),{date:n,status:p.status,responseText:p.responseText}),pref.catalog_snoop_refresh&&null!=catalog_obj.catalog_func()&&catalog_obj.catalog_func().catalog_insert(info_raw+"p"+o.no(),{date:n,status:p.status,responseText:p.responseText}),r(t.parseFromString(p.responseText,"text/html"))}}function n(e){p.open("GET",e,!0),p.send(null)}function s(){u||(u=!0,d=cnst.get_time(),i())}function i(){var e=site2[site.nickname].make_url4([site.nickname,site.board,o.no(),"page_html"])[0];o.no()==site.max_page&&(e=window.location.href),n(e)}function l(e){(e||g!=pref.interval_found)&&(c(!1),m=setInterval(s,6e4*pref.interval_found)),g=pref.interval_found}function c(t){null!=m&&clearInterval(m),m=null,t&&(e.style.color="gray")}var p=new XMLHttpRequest;p.addEventListener("load",t,!1),p.addEventListener("error",t,!1),p.addEventListener("abort",t,!1);var d,u=!1,f=0,h=site.max_page+1+5,m=null,g=0;l(!0),s(),e.style.color="#000000";var b=window.location.href.search(site.thread_keyword)!=-1?a(document,-1,-1):-2;return{req:p,found:function(){f=0,u=!1},missing:function(){200==p.status&&f++<h?setTimeout(i,1e3):(f=0,u=!1)},stop:function(e){c(e)},dead:function(){timer_obj.show_page(["Dead"]),c(!0),timer_obj.finished()},myself:function(){return b},restart:function(e){l(e)},timestr:function(){return d},destroy:function(){p.removeEventListener("load",t,!1),p.removeEventListener("error",t,!1),p.removeEventListener("abort",t,!1)}}}();return brwsr.sw_cache&&pref.info_client&&brwsr.sw_cache.subscribe(!0),{destroy:function(){return brwsr.sw_cache&&brwsr.sw_cache.subscribe(!1),_.stop(!0),_.destroy(),null},timer:function(){return _},page_check5:t}}function make_post_form_obj(e){function t(){site.components.postform_comment.focus()}function n(e){site2[site.nickname].postform.activation&&site2[site.nickname].postform.activation();var n=cnst.tack_float_nSblgs(e);n.rolldown=t,i=n.pn,n.cn.childNodes[0].innerHTML='<div><input type="checkbox" name="prevent_redirection">prevent redirection</div><div></div>',l=n.cn.childNodes[0],pref_func.apply_prep(l,!1),l.getElementsByTagName("input").prevent_redirection.onchange=s,options.func0_prep(n.cn.childNodes[0].childNodes[1],n.pn,n.cn),t(),site.postform.getAttribute("name")===pref.script_prefix+"_draft"&&(site.postform.style.display=null,n.pn.style.top="0px",n.pn.style.left="0px")}function r(e){cnst.tack_dock_nSblgs(e),site.postform.getAttribute("name")===pref.script_prefix+"_draft"&&(site.postform.style.display="none")}function a(){"none"!==o.style.display?n({currentTarget:o}):r({currentTarget:i.childNodes[0]})}function s(){if(null!=l&&pref_func.apply_prep(l,!0),1==pref.prevent_redirection){g||(g=cnst.make_iframe("redirect_target"),g.onload=function(){g.location&&"about:blank"!=g.location.href&&g.location.replace("about:blank")});for(var e=0;e<c.length;e++)m[e]=_[e].target,_[e].target="redirect_target"}else for(var e=0;e<c.length;e++)_[e].target=m[e]}var o;e.addEventListener("click",a,!1),site2[site.nickname].postform&&(o=site2[site.nickname].postform.init())&&cnst.set_tack_float(o,n,r);for(var i=null,l=null,c=[],p=[],_=document.getElementsByTagName("form"),d=0;d<_.length;d++)"post"==_[d].method&&p.push(_[d]);for(var d=0;d<p.length;d++)for(var u=p[d].getElementsByTagName("input"),f=0;f<u.length;f++)"submit"==u[f].type&&c.push(u[f]);for(var h=!1,m=[],d=0;d<c.length;d++)c[d].addEventListener("click",function(){h=!0},!1);var g;return 1==pref.prevent_redirection&&s(),{debug:function(){debug()}}}function make_debug_obj(e){function t(e){console.log("debug"),null!=site.components.postform_submit&&(site.components.postform_submit.disabled=!1),post_form_obj&&post_form_obj.debug()}e.addEventListener("click",t,!1)}if(!(window.top!=window.self&&""===window.name||"post_tgt"===window.name&&window.location.href.indexOf("localhost")!=-1)){var brwsr={ff:navigator.userAgent.indexOf("Firefox")!=-1,sw_cache:!0,JSON_parse:function(e){var t=JSON.parse(e);for(var n in t)"string"==typeof t[n]&&t[n].search(/^\[.*\]$/)!=-1&&(t[n]=brwsr.JSON_parse(t[n]));return t}};brwsr.innerText=brwsr.ff?"textContent":"innerText",brwsr.Date_parse=brwsr.ff?function(e){var t=Date.parse(e);if(isNaN(t)){var n=e.lastIndexOf(".");t=Date.parse(e.substr(0,n),10)+parseInt(e.substr(n+1,3),10)}return t}:Date.parse,brwsr.document_body=brwsr.ff?document.documentElement:document.body,brwsr.mousewheel=brwsr.ff?"DOMMouseScroll":"mousewheel";var DelayBuffer=function(e,t){this.tgt=e,this.delay=t,this.id=null,this.do_tgt=this.do_tgt.bind(this)};DelayBuffer.prototype={do_tgt:function(){this.id=null,this.tgt()},delayed_do:function(e){null===this.id&&(void 0===e&&(e=this.delay),this.id=setTimeout(this.do_tgt,"number"==typeof e?e:this.hasFocus?e.fg:e.bg))},cancel:function(){null!==this.id&&(clearTimeout(this.id),this.id=null)},get_binded_delayed_do:function(){return this.delayed_do.bind(this)},hasFocus:!0};var Watchdog=function(e,t){DelayBuffer.call(this,e,t)};Watchdog.prototype={start:function(e){this.delayed_do(e)},stop:function(){this.cancel()},restart:function(e){this.cancel(),this.delayed_do(e)},__proto__:DelayBuffer.prototype};var common_func={Object_modifyDescriptor:function(e,t,n){n.__proto__=Object.getOwnPropertyDescriptor(e,t),Object.defineProperty(e,t,n)},Object_defProps:function(e,t){for(var n in t)e[n]=t[n];return t}},site0=function(){var e=window.location.href,t=null,n=null,r=null,e=window.location.href;e.indexOf("/meguca.org/")!=-1?(t="meguca",n={pref2:{meguca:{utilize_boards_json:!1,utilize_boards_json_domain:!1}},thread:{env:{disp_offset:3}},scan:{max:100},proto:{env:{event_dynamic:!0}},style:{zIndex:300},tooltips:{zIndex:302}},r=!0):e.search(/(4chan(nel)*|4cdn).org/)!=-1?(t="4chan",n={catalog_expand_with_hr:!0,page:{env:{disp_filler:"<hr>"}},patch:{delayed_invoke:{use:brwsr.ff}},catalog:{t2h_sel:"N",thumbnail:{hover:{popup_zIndex:100001}}},proto:{footer:{rOP:!1,iOP:!1},env:{event_dynamic:!0}},easy2:{limits:2}}):e.indexOf("lainchan.org")!==-1?(t="lain",n={page:{env:{disp_offset:1}},catalog:{image_hover:!0,board:{all_boards:!0},env:{disp_offset:1,disp_filler:"                                        "}},proto:{env:{localtime_native:!1,colorID_native:!1}},stats:{time_unit:3,patch_tm:!0},chart:{inst:{show:{p:!0},time_sel:3}},easy2:{limits:1},thread_reader:{own_posts_tracker:!0}}):e.indexOf("lainchan.jp")!=-1?(t="lainjp",n={page:{env:{disp_offset:1}},proto:{env:{localtime_native:!1,colorID_native:!1}},stats:{time_unit:3,patch_tm:!0},chart:{inst:{show:{p:!0},time_sel:3}},catalog:{image_hover:!0,board:{all_boards:!0},env:{disp_offset:1,disp_filler:" "}},thread:{auto_update:!0},thread_reader:{own_posts_tracker:!0},scan:{max:100},liveTag:{style:{urtm:"color:lime !important;font-weight:bold !important",ur:"color:limegreen !important;font-weight:bold !important",in:"color:red !important"}},virtualBoard:{scanDelay:1},easy2:{limits:1},style:{post_new:"border:2px solid red !important"}},r=!0):e.search(/8chan.co|8ch.net/)!=-1?(t="8chan",n={catalog_expand_with_hr:!0,page:{env:{disp_offset:1,disp_filler:"<hr>"}}}):e.search(/krautchan.net/)!=-1&&(t="KC",n={thread_reader:{own_posts_tracker:!0,check_num_of_children:!1},proto:{env:{popup_native:!1,expand_thumbnail_inline_native:!1,image_hover_native:!1,colorID_native:!1,backlink_native:!1,localtime_native:!1,auto_update_native:!1}},page:{use_expander_always:!0}});var a=["meguca","4chan","lain","lainjp","8chan","KC"];t&&a.unshift(a.splice(a.indexOf(t),1)[0]);var s=["8chan","8chan_live","vichan","KC","4chan_i","4chan","meguca","imeguca","lain","lainjp"];return r&&(r={catalog:{auto_load_filter:!0,auto_save_filter:!0,auto_save_filter_at_refresh:!0},liveTag:{use:!1,from:"op"},virtualBoard:{max:100,scan:!0,scan_domains:{}},network:{fetch_actively:!1},easy2:{presets:1,VB:{local:1},catalog:{auto_update:!1},page:{auto_update:!1}}},r.virtualBoard.scan_domains[t]="board"),{domain:t,domains:a,pref_default:n,pref_default2:r,domains_obj:function(e,n){for(var r={},s=0;s<a.length;s++)r[a[s]]=e;return n&&common_func.Object_modifyDescriptor(r,t,{writable:!1}),r},isStep:window.opener&&s.indexOf(window.name)!=-1}}(),pref4={funcs:{set_options_to_selector:function(e,t){e.length=t.length;for(var n=0;n<t.length;n++)e.options[n].text=t[n]}},archive:{IDB_board_sel_gfunc_pre:function(e,t,n,r,a){pref4.funcs.set_options_to_selector(a,pref4.archive.IDB_board_sel_options||["Wait..."])},IDB_board_sel_options:null,IDB_thread_sel_gfunc_pre:function(e,t,n,r,a){pref4.funcs.set_options_to_selector(a,pref4.archive.IDB_thread_sel_options||["Wait..."])},IDB_thread_sel_options:null},refresh:{count:0},search_posts_active_once:!1,scan:{get loosen(){return pref4.search_posts_active_once&&pref.proto.searchAc.loosen},get max(){return"archive"===site.whreami?pref.scan.max_archive:this.loosen?pref.proto.searchAc.max:pref.scan.max},get max_threads(){return"archive"===site.whreami?pref.scan.max_archive:this.loosen?pref.proto.searchAc.max_threads:pref.scan.max_threads},get max_threads_at_refresh(){return this.loosen?pref.proto.searchAc.max_threads_at_refresh:pref.catalog.max_threads_at_refresh}}},gGEH={get_key_recursive:function(e,t,n){for(var r;e&&!(r=this.pns_all_keys.get(e))&&e!==t;)e=e.parentNode;return r&&(n||"string"!=typeof r&&(r=r.lths[0].key)),r},pns_all_keys:new WeakMap,pns_resize:new WeakMap,triage_in:null,triage_in2:null,last_viewed:null,time_jumped:0},pref_func={delete_null:function(e){for(var t in e)null===e[t]?delete e[t]:"object"!=typeof e[t]||Array.isArray(e[t])||pref_func.delete_null(e[t])},pref_overwrite:function(e,t,n){for(var r in t)if(void 0!==e[r]&&(null!==e[r]||pref&&pref.test_mode[117])){if(n&&typeof t[r]!=typeof e[r])continue;"object"!=typeof t[r]||Array.isArray(t[r])?e[r]!==t[r]&&(e[r]=t[r]):pref_func.pref_overwrite(e[r],t[r],n)}return e},site2_json:function(query,dumb,enables){var pn_out=document.getElementsByName("JSON_result")[0];pn_out&&(pn_out.style={});try{if(""!==pref.overwrite_site2_json_str){for(var fields=pref.overwrite_site2_json_str.split('"'),i=0;i<fields.length;)if(fields[i].search(/\/\/.*/)!=-1){for(;i+1<fields.length&&fields[i].search(/\/\/[^\n]*\n/)==-1;)fields[i]+=fields.splice(i+1,1);fields[i]=fields[i].replace(/\/\/[^\n]*(\n|$)/,"")}else i+=2;for(var str=fields.join('"'),ex_count=0,str_out="",count=0,start=0,j=0;j<str.length;j++)if(0==count&&"{"!==str[j]&&" "!==str[j]&&"\n"!==str[j]&&ex_count++,"{"===str[j]&&count++,"}"===str[j]&&0==--count){var obj=JSON.parse(str.substr(start,j-start+1));for(var i in obj)"site2"!==i&&"pref"!==i&&"pref_func"!==i&&"liveTag"!=i&&"site3"!==i||enables&&enables.indexOf(i)==-1||(query?str_out='{"'+i+'":'+pref_func.pref_query(query===!0?eval(i):query,obj[i])+"}":pref_func.pref_overwrite(eval(i),obj[i]));start=j+1}pn_out&&(pn_out.textContent=(0!=ex_count?"OK, but there are extra useless strings, ":0!=count?"OK, but there are non-closed brackets, ":"OK, ")+(new Date).toLocaleString(),pn_out.style.color="",""!==str_out&&(document.getElementsByName("overwrite_site2_json_str")[0].value=str_out,pref.overwrite_site2_json_str=str_out))}}catch(e){pn_out&&(pn_out.textContent="ERROR!!!, "+(new Date).toLocaleString(),pn_out.style.color="red"),console.log("ERROR in overwtite strings:"),console.log(pref.overwrite_site2_json_str),console.log(e)}},sanitize:function(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}},pref=pref_default();localStorage&&localStorage[pref.script_prefix+".pref"]&&pref_func.pref_overwrite(pref,JSON.parse(localStorage[pref.script_prefix+".pref"]),!0);for(var i in{catalog:null,page:null,float:null,thread:null})pref[i].save_board_list_sel||(pref[i].board_list_sel=0);if(sessionStorage&&sessionStorage[pref.script_prefix+".pref"]&&pref_func.pref_overwrite(pref,JSON.parse(sessionStorage[pref.script_prefix+".pref"]),!0),window.name)for(var i in{catalog:null,page:null,float:null,thread:null})pref[i].board_list_sel=0;if(pref_func.site2_json(!1,!0,["pref"]),pref.script_prefix=pref_func.sanitize(pref.script_prefix),site0.isStep){for(var i in pref.features)"domains"!==i&&(pref.features[i]=!1);for(var i in pref.features.domains)i!==site0.domain&&(pref.features.domains[i]=!1);brwsr.sw_cache=null,pref_func.pref_overwrite(pref,{catalog:{auto_update:!1},thread:{auto_update:!1},page:{auto_update:!1},float:{auto_update:!1},virtualBoard:{scan:!1},stats:{auto_acquisition_scan:!1},cloudflare:{auto_reload:!1}})}var styleSheet=site0.isStep?{}:function(){function e(e,t){p.cssRules[t]&&p.deleteRule(t),p.insertRule(e,t)}function t(){e("."+pref.script_prefix+("entire"===pref.catalog.click_area?"_thread":"_thumbnail")+" {cursor: pointer}",2)}function n(){var t=[pref.style.fix.titleBar_str,pref.style.fix.window_str,pref.style.fix.popUp_str];if("copy"===pref.style.sel)for(var n=[pref.style.copy.titleBar_str,pref.style.copy.window_str,pref.style.copy.popUp_str],a=document.styleSheets.length-1;a>=0;a--){var s=document.styleSheets[a].cssRules;if(s){for(var o=s.length-1;o>=0;o--){for(var i=0;i<3;i++)n[i]&&s[o].selectorText===n[i]&&(t[i]=r(s[o].cssText),n[i]=null);if(!t[0]&&!t[1]&&!t[2])break}if(!t[0]&&!t[1]&&!t[2])break}}e("."+pref.script_prefix+"_titleBar {"+t[0]+"}",4),e("."+pref.script_prefix+"_window {"+t[1]+"}",5),e("."+pref.script_prefix+"_popUp {"+t[2]+"}",6)}function r(e){for(var t=e.replace(/.*\{/,"").replace(/\}.*/,"").split(";"),n=t.length-1;n>=0;n--)t[n].split(":")[0].search(/\s*(background|color)/)==-1&&t.splice(n,1);return t.join(";")}function a(e){new MutationObserver(s).observe(e,{attributes:!0})}function s(){if(p){var e=document.createElement("img");e.src=this.href,e.onerror=o,document.getElementsByTagName("body")[0].appendChild(e)}}function o(){this.parentNode.removeChild(this),n()}function i(){if(cataLog.embed_mode){var e=site2[site.nickname].spoiler_text;if(e.spoiler){if(!_&&!d&&e&&pref[cataLog.embed_mode].open_spoiler_text)for(var t=0;t<document.styleSheets.length;t++)if(document.styleSheets[t].cssRules)for(var n=0;n<document.styleSheets[t].cssRules.length;n++){var r=document.styleSheets[t].cssRules[n].selectorText;r&&(r.search(e.spoiler)!=-1&&(_=[t,n,document.styleSheets[t].cssRules[n].style.cssText]),r.search(e.open)!=-1&&(d=[t,n,document.styleSheets[t].cssRules[n].style.cssText]))}_&&d&&(document.styleSheets[_[0]].cssRules[_[1]].style.cssText=_[2]+(pref[cataLog.embed_mode].open_spoiler_text?d[2]:""))}else pref[cataLog.embed_mode].open_spoiler_text?(d=[document.styleSheets.length-1,document.styleSheets[document.styleSheets.length-1].cssRules.length,e.open_rule],document.styleSheets[d[0]].insertRule(d[2],d[1])):d&&document.styleSheets[d[0]].deleteRule(d[1])}}function l(e,t){if(void 0===t){var n=e.indexOf("{");t=e.slice(n+1,e.lastIndexOf("}")),e=e.slice(0,n)}var r=u.indexOf(e);r!=-1&&p.deleteRule(r),null===t||""===t?r!=-1&&u.splice(r,1):(r===-1&&(r=u.length,u[r]=e),p.insertRule(e+" {"+t+"}",r))}function c(){var e=pref.style.userCSS;if(e.use){var t=h||document.createElement("style");t.textContent=e.str,h||(h=document.head.appendChild(t))}else h&&(document.head.removeChild(h),h=null)}var p,_=null,d=null,u=["dummy","dummy","dummy","dummy","dummy","dummy","dummy"],f="."+pref.script_prefix+"_",h=null;return c(),{init:function(e){p=document.head.insertBefore(document.createElement("style"),h).sheet,p.insertRule(".catalog_triage_parent {pointer-events: none;}",0),p.insertRule(".catalog_triage_button {pointer-events: auto;}",1),t(),p.insertRule("."+pref.script_prefix+"_tag {cursor:pointer;}",3),n(),pref_func.settings.onchange_funcs["*.posts_search_op"](null,e),pref_func.settings.onchange_funcs["style.post_editing"](),l(f+"autoTp","opacity:0; position:absolute; top:0px; left:0px;"),l(f+"autoTp:hover","opacity:1;"),l(f+"deleted","opacity:0.4;");var r=site2[site.nickname].styles;if(r)for(var a=0;a<r.length;a++)l(r[a][0],r[a][1]);for(var s in pref.style.tips)"_str"!==s.slice(-4)&&pref.style.tips[s]&&this.register_cc(pref.style.tips[s+"_str"])},make_rule_click_area:function(){p&&t()},styles_changed:function(){p&&n()},add_to_watch:a,open_spoiler_text:i,register:l,register_cc:function(e,t){this.register(f+e,t)},userCSS_changed:c}}(),pref3={stats:{use:null,estimate_posts:null},reload_required:!1,catalog:{filter:{time_str:function(e,t,n,r){r.time_obj6=Date.parse(n)}}},notify:{sound:{file:null}},archive:{working:!1,list_str:function(e,t,n){pref_func.str2obj2(e,t.replace(/str$/,"obj2"),n)},list_obj2:null,jsons:null,imgs:null,dir:null},proto:{merge_list_str:function(e,t,n){this.merge_list_obj2_old||(this.merge_list_obj2_old=this.merge_list_obj2);var r=null;pref_func.str2obj2(e,"merge_list_obj2",n.replace(/\s*\+\s*/g,",+"),null,null,function(e,t){var n="+"===e[0],a=(n?e.slice(1):e)||"DEFAULT";n&&r?(t[a]=t[r],t[a][t[a].length]=a):(t[a]=[a],r=a)})},merge_list_obj2:null,merge_list_obj2_old:null,merge_lv_str:function(e,t,n){this.merge_lv_obj2_old||(this.merge_lv_obj2_old=this.merge_lv_obj2),pref_func.str2obj2(e,"merge_lv_obj2",n,null,null,pref_func.str2obj2_func_for_val)},merge_lv_obj2:null,merge_lv_obj2_old:null},test_mode:{js_file:null}},gClg,pClg,debugWindow,cataLog={threads:null,scan_boards:null,scan_init:null,embed_mode:null,format_html:null,show_catalog:null,get_ref_height:null,catalog_obj2:null,healthIndicator:null,parent:null,open_spoiler_text:null,general_event_handler:null,catalog_refresh_end:null,catalog_filter_changed:null,image_hover_reentry:null,image_hover_remove:null,scan_boards_keyword_callback2:null,scan_boards_keyword_callback2_default_args:null,catalog_clear_threads:null,catalog_filter_query_keyword:null,set_watch_time_thread:null,event_func:null,restore_th_from_IDB:null,components:null,triage:null,GEH:null,insert_myself:null,DIH:null,auto_update:null,gClg:null};pref_func=function(){return{__proto__:pref_func,mirror_targets:{pn12_0_2:null,pn12_0_4:null,get pn13_1(){return pref_func.settings.pn13&&pref_func.settings.pn13.childNodes[1]||null},boardlist:null},mirror_names:function(){var e={"virtualBoard.max":null,"*.merge":null,"*.merge_list":null,"*.refresh_src":null,"*.refresh_src_th":null};return function(t){var n=t.split(".");return"catalog"!==n[0]&&"page"!==n[0]&&"thread"!==n[0]||(n[0]="*"),n.join(".")in e}}(),apply_prep:function(e,t,n,r,a,s){var o=Array.isArray(e)?e:e instanceof HTMLCollection||e instanceof NodeList?Array.prototype.slice.call(e):(o=e.querySelectorAll("input,textarea,select"+(t?"":",span[data-class=show_value]")),o.length>0?Array.prototype.slice.call(o):[e]);this.apply_prep_2_all(o,t,n,!1,a,s),this.apply_prep_save(e,t,n,!1,a,s),this.apply_prep_mirror(o[0],t,n,r,a,s)},apply_prep_1n:function(e,t,n,r,a,s){this.apply_prep_1(pref_func.settings.pnOrDummy(e),t,n,r,a,s)},apply_prep_1:function(e,t,n,r,a,s){this.apply_prep_2(e,t,n,!1,a,s),this.apply_prep_save(e,t,n,!1,a,s),this.apply_prep_mirror(e,t,n,r,a,s)},apply_prep_mirror:function(e,t,n,r,a,s){var o=e.name||e.getAttribute("name");if(o&&this.mirror_names(o)&&(r=!0),r){var i=[];for(var l in this.mirror_targets)this.mirror_targets[l]&&(i=i.concat(Array.prototype.slice.call(this.mirror_targets[l].getElementsByTagName(e.tagName)).filter(function(e){return e.getAttribute("name")===o})));for(var l=0;l<i.length;l++)e!==i[l]&&("INPUT"===i[l].tagName&&"radio"===i[l].type&&i[l].value!==e.value||this.apply_prep_2(i[l],!1,!1,!1,!1,s))}},apply_prep_save:function(e,t,n,r,a,s){pref.test_mode[117]?sessionStorage&&t&&(sessionStorage[pref.script_prefix+".pref"]=JSON.stringify(pref_func.site2_json_ex_remove())):sessionStorage&&(t||a)&&(sessionStorage[pref.script_prefix+".pref"]=JSON.stringify(pref))},apply_prep_2_all:function(e,t,n,r,a,s){for(var o=0;o<e.length;o++)this.apply_prep_2(e[o],t,n,!1,a,s)},apply_prep_2:function(e,t,n,r,a,s){var o=e.name||e.getAttribute("name");if(o&&"button"!=e.type){var i=pref_func.get_tgt(o,"file"===e.type?pref3:s||t!==!0&&t||null),l=i[0],c=i[1];if(l){var p=e.tagName;if("INPUT"===p)"file"===e.type?!t&&l[c]&&l[c]!==e?e.parentNode.replaceChild(l[c],e):l[c]=e:t?this.apply_prep_set(l,c,e,o):this.apply_prep_load(e,l,c),(t||a)&&"string"==typeof l[c]&&"text"===e.type&&"str"===c.substr(-3,3)&&l[c.slice(0,-3)+"obj6"]&&pref_func.str2obj6(l,c,e.value,o);else if("TEXTAREA"===p){if(t?l[c]=e.value:e.value=l[c],(t||a)&&"str"===c.slice(-3)){var _=c.slice(0,-3);l[_+"obj"]?pref_func.str2obj(c):l[_+"obj2"]?pref_func.str2obj2(l,_+"obj2",e.value):void 0!==l[_+"obj5"]?pref_func.str2obj5(l,_+"obj5",e.value,"rm_list_str"===c):null===l[_+"obj6"]?pref_func.str2obj6(l,c,e.value,o):void 0!==l[_+"obj7"]&&(l[_+"obj7"]=pref_func.str2obj7.s2o({},e.value))}}else if("SELECT"===p)t?this.apply_prep_set(l,c,e,o):(l[c+"_gfunc_pre"]&&l[c+"_gfunc_pre"](l,c,l[c],o,e),this.apply_prep_load(e,l,c));else if("SPAN"===p&&!t&&"show_value"===e.getAttribute("data-class")){var d=l[c],u=this.apply_prep_2_str[c+":"+l[c]];u&&(d="string"==typeof u?u:u(l)),e.textContent=d.toString().replace(/^./,function(e){return e.toUpperCase()})}n&&(e.oninput&&e.oninput.call(e,{currentTarget:e,target:e},!0),e.onchange&&e.onchange.call(e,{currentTarget:e,target:e},!0))}}},apply_prep_set:function(e,t,n,r){var a=typeof e[t];if("number"===a){var s;e[t]="SELECT"===n.tagName?n.selectedIndex:(s=r&&"_f"===r.substr(-2)?parseFloat(n.value):parseInt(n.value,10),isNaN(s)?0:s)}else"boolean"===a?e[t]=n.checked:"string"===a&&("text"===n.type||n.checked)&&(e[t]=n.value)},apply_prep_load:function(e,t,n){var r=t[n];if("SELECT"===e.tagName)r>=e.length&&(t[n]=0),e.selectedIndex=t[n];else{var a=typeof r;"number"==a?e.value=r:"boolean"==a?e.checked=r:"string"==a&&("text"===e.type?e.value=r:r===e.value&&(e.checked=!0))}},apply_prep_2_str:{"t2h_sel:L":function(e){return e.t2h_L},"t2h_sel:M":function(e){return e.t2h_M},"t2h_sel:N":function(e){return e.t2h_N},"t2h_sel:N_unread":function(e){return e.t2h_N+"+unread"},"t2h_sel:unread":"All unread","posts_search_op:opaque":function(e){return"opaque "+e.posts_search_op_opacity+"%"},"popup2:sr":"SearchResult","popup2:srpv":"SearchResult/Preview","popup2:pv":"Preview","popup2:chart":"PostRateChart","popup2:dp":"DeletedPosts"},catalog_board_list_str_or:"",catalog_board_list_str_bt:"",catalog_board_list_str_bt_same:"",add_onchange:function(e,t,n){return this.set_event_target(e,this.add_onchange_entry_func.bind(t),n)},add_onchange_entry_func:function(e,t){var n=e.currentTarget.getAttribute("name");if(t||["INPUT","TEXTAREA","SELECT"].indexOf(e.currentTarget.tagName)==-1||pref_func.apply_prep_1(e.currentTarget,this["."]&&this["."].pref||!0),this[n])this[n].call(this,e);else{var r=n.indexOf(".");if(r!=-1){var a=n.substr(r);if(this["*"+a])this["*"+a].call(this,e);else if(this["*w/"+a])this["*w/"+a].call(this,e,n);else{var s=n.lastIndexOf(".");if(s!=-1){var a=n.substr(0,s+1)+"*";if(this[a])this[a].call(this,e);else if(this[a+"w/"])this[a+"w/"].call(this,e,n);else if(r!=-1){var o=n.substr(0,r),i=n.substr(r+1);this[o]&&this[o][i]&&this[o][i](e)}}}}}},add_onchange_format:function(e){for(var t=Object.keys(e),n=0;n<t.length;n++)"string"==typeof e[t[n]]&&(e[t[n]]=e[e[t[n]]]);return e},set_event_target:function(){function e(e){n=e?e.target:null}function t(){n&&pref_func.apply_prep_1(n,!0)}var n=null;return window.addEventListener("beforeunload",t,!1),function(t,r,a){var s=function(e,t){n=null,r.call(this,e,t)},o=t.getElementsByTagName("*");0==o.length&&(o=[t]);for(var i=0;i<o.length;i++){var l=o[i].getAttribute("name");if(l){var c=o[i].tagName;"INPUT"===c||"TEXTAREA"===c||"SELECT"===c?a&&a[o[i].name]?o[i].oninput=s:(o[i].onchange=s,("INPUT"===c&&"text"===o[i].type||"TEXTAREA"===c)&&(o[i].oninput=e)):"BUTTON"===c?o[i].onclick=s:"A"===c?"SHOW"!==l&&"SHOWALL"!==l&&"HIDEALL"!==l&&"SHOW2"!==l&&"SHOW3"!==l&&"HIDE3"!==l||(o[i].onclick=r):"SPAN"!==c&&"DIV"!==c||("SUB"===l&&(o[i].onchange=r),"SHOW2_I"!==l&&"SHOW4"!==l&&"HIDE4"!==l||(o[i].onclick=r))}}return s}}(),str2obj:function(e){var t=e.replace(/str$/,"obj");pref[t]=[],t=pref[t];var n="boards"===site.whereami?site2[site.nickname].boards_sel_from_tags():site.board+("thread"===site.whereami?site.no:"");if("//"===n&&(n="/ROOT_DUMMY/"),n+=","+n+"\n"+pref[e]+"\n",pref.catalog.board.recommendation){var r=site2[site.nickname].get_owners_recommendation();pref_func.catalog_board_list_str_or=r,n=n+r+"\n"}pref.catalog.board.board_tags&&""!==pref_func.catalog_board_list_str_bt&&(n=n+pref_func.catalog_board_list_str_bt+"\n"),pref.catalog.board.board_tags_same&&""!==pref_func.catalog_board_list_str_bt_same&&(n=n+pref_func.catalog_board_list_str_bt_same+"\n");for(var a=n.split("\n"),s=-1,o=0;o<a.length;o++){for(var i=a[o].replace(/\s*\/\/.*/,"").replace(/, +/g,",").split(","),l=0;l<i.length&&""==i[l];)l++;if(i[l]){t[++s]=[{key:i[l++]}];for(var c=0;l<i.length;)""!==i[l]&&(i[l].search(/^\s*!?#/)!==-1?(t[s][0].tags||(t[s][0].tags=[]),t[s][0].tags[t[s][0].tags.length]=i[l].replace(/\s/g,"")):i[l].search(/^\s*!/)!==-1?(t[s][0].cmds||(t[s][0].cmds=[]),t[s][0].cmds[t[s][0].cmds.length]=i[l].replace(/\s/g,"").substr(1)):(t[s][++c]={},t[s][c].key=i[l].replace(/[\*\^!].*/,"").replace(/\s/g,""),i[l].search(/\*/)!=-1&&(t[s][c].max_page=parseInt(i[l].replace(/[^\*\^!]*[\*\^!]/,"").replace(/[\^!].*/,""),10)),i[l].search(/\^/)!=-1&&(t[s][c].style=i[l].replace(/[^\*\^!]*[\*\^!]/,"").replace(/[\*!].*/,"")))),l++}}pref.catalog.board.all_boards&&(t[t.length]=[{key:"ALL"},{key:site.nickname}]);for(var o=0;o<t.length;o++)for(var l=1;l<t[o].length;l++){var p=t[o][l].key.replace(/\/.*/,"");""==p&&(p=site.nickname);var _="/"+t[o][l].key.replace(/[^\/]*\//,"").replace(/\/.*/,"")+"/";1==l?(t[o][0].domain=p,t[o][0].board=_):(t[o][0].domain!=p&&(t[o][0].domain=null),t[o][0].board!=_&&(t[o][0].board=null))}for(var o=0;o<t.length;o++)for(var l=1;l<t[o].length;l++){var d=common_func.name2domainboardthread(t[o][l].key,!1);t[o][l].key=common_func.name2domainboardthread(t[o][l].key,!0).join(""),""===d[1]&&""===d[2]&&(t[o][0].domains_for_all_boards||(t[o][0].domains_for_all_boards=[]),t[o][0].domains_for_all_boards[t[o][0].domains_for_all_boards.length]=d[0],t[o].splice(l--,1))}},get_tgt:function(e,t,n){t||(t="#"===e[0]?liveTag.tags:pref);for(var r=e.split("."),a=0;a<r.length;a++){if(n&&void 0===t[r[a]])return null;if(a==r.length-1)return[t,r[a]];t=t[r[a]]}},str2obj2:function(){function e(e,n){var r=e.replace(/[@;].*/,""),a=e.slice(r.length).replace(/@/g,";@").split(";").filter(function(e){return e});r||(r="DEFAULT"),n[r]||(n[r]={});for(var s=0;s<a.length;s++)t(n[r],a[s])}function t(e,t){if("@"===t[0])e.time=0==t[1]?0:brwsr.Date_parse(t.slice(1));else{var n=0===t.search(/^[A-Z]/)?"cmd":"style",r=t.split(":");e[n]||(e[n]={}),e[n][r[0]]="cmd"!==n?r[1]:1===r.length||"true"===r[1]||"false"!==r[1]&&r[1]}}function n(e,t){"+"===e[0]&&(e=e.slice(1));var n=e.replace(/[@;:].*/,"")||"DEFAULT",r=n.indexOf("/"),a=n.lastIndexOf("/");if(r>0&&r!==a&&a!=n.length-1){var s=n.slice(0,a+1);t[s]||(t[s]={}),t[s][n.slice(a+1)]=null}}return function(t,r,a,s,o,i){var l=s||{},c=a.replace(/\s*\/\/.*/gm,"").replace(/\n/g,",").replace(/\s*$/,"").split(/\s*,\s*/);i||(i=e);for(var p=0;p<c.length;p++)c[p]&&i(c[p],l);if(s||(t[r]=l),o)return l;for(var _={},p=0;p<c.length;p++)c[p]&&n(c[p],_);l[":REV"]=_}}(),str2obj2_func_for_val:function(e,t){e=e.replace(/\s*/g,"");var n=e.indexOf(":");t[n>=1?e.substr(0,n):"DEFAULT"]=e.substr(n+1)},str2obj5:function(e,t,n,r){e[t]={};for(var a=e[t],s=n.replace(/\s*\/\/.*/gm,"").replace(/\n/g,",").split(","),o=0;o<s.length;o++){var i=s[o].replace(/\s*:\s*/,":").replace(/\s+$/,"");if(""!=i){var l,c=i.indexOf(":"),p=c!=-1?i.substr(0,c):"DEFAULT",_="/"===i[c+1]&&(l=i.lastIndexOf("/"))>c+2,d=_?i.slice(c+2,l):i.slice(c+1),u=(r?"g":"")+(_?i.slice(l+1).replace(/g/,""):"");void 0===a[p]&&(a[p]=[]);try{a[p][a[p].length]=new RegExp(_?d:this.str2rstr(d,r),u)}catch(e){console.log("ERROR at str2obj5 in string of: "+s[o])}}}},str2rstr:function(e,t){return e.replace(/[\.\(\)\[\]\+\^\$\{\}]/g,"\\$&").replace(/\*/g,t?"\\S*(\\s|\\n|$)":".*").replace(/\?/g,".")},str2obj7:function(){var e={use:!0,str:"",re:!1,ci:!0,match:0,sentence:!1,op:!0,post:!1,sub:!0,name:!0,trip:!1,com:!0,file:!1,meta:!1,flag:!1,id:!1,cmds:""};return{s2o:function(t,n){for(var r=n.replace(/\s*\/\/.*/gm,"").split(/\s*\n\s*/),a=0;a<r.length;a++){var s=r[a],o=s.indexOf("{");if(o!==-1){var i=s.substr(0,o).trim().replace(/\s*:\s*/,"")||"DEFAULT";try{var l=JSON.parse(s.slice(o).trim());l.__proto__=e,l.rexps=common_func.kwd_prep_regexp(l),void 0===t[i]?t[i]=[l]:t[i][t[i].length]=l}catch(e){console.log("ERROR at str2obj7 in string of: "+r[a])}}}return t},o2s:function(t){var n={};for(var r in e)e[r]!=t[r]&&(n[r]=t[r]);return delete n.use,t.sentence&&t.str.indexOf(" ")===-1&&delete n.sentence,JSON.stringify(n)}}}(),merge_obj5:function(e,t,n){return this.merge_obj5_all(e,t,n,this.merge_obj5_1)},merge_obj5a:function(e,t,n){return this.merge_obj5_all(e.key,t,n,this.merge_obj5_1a)},merge_obj5a_sc:function(e,t,n){if(!t)return n;var r=common_func.fullname2dbt(e);return t[e]||t[r[1]+r[2]]||t[r[0]+r[2]]||t[r[2]]||t[r[0]+r[1]]||t[r[1]]||t[r[0]]||t.DEFAULT||n},merge_obj5_all:function(e,t,n,r){var a=common_func.fullname2dbt(e);return n=r(n,t,"DEFAULT"),n=r(n,t,a[0]),n=r(n,t,a[1]),n=r(n,t,a[0]+a[1]),n=r(n,t,a[2]),n=r(n,t,a[0]+a[2]),n=r(n,t,a[1]+a[2]),n=r(n,t,e)},merge_obj5_1:function(e,t,n){if(t[n]){var r=t[n];e||(e={});for(var a in r)if("object"!=typeof r[a])e[a]=r[a];else{void 0===e[a]&&(e[a]={});for(var s in r[a])e[a][s]=r[a][s]}}return e},merge_obj5_1a:function(e,t,n){var r=t[n];return r?e?r.concat(e):r:e},str2obj6:function(e,t,n,r){var a=pref_func.get_tgt(r,pref3);a[0][a[1]](a[0],t,n,e)},obj_init_hier:function(e,t){for(var n in e)"object"==typeof e[n]&&t[n]?this.obj_init_hier(e[n],t[n]):"function"==typeof e[n]&&e[n](e,n,t[n],t)},obj_init:function(){pref_func.str2obj("catalog_board_list_str"),pref_func.str2obj2(pref.catalog,"style_general_list_obj2",pref.catalog.style_general_list_str),pref_func.str2obj2(pref.catalog.board,"ex_list_obj2",pref.catalog.board.ex_list_str),pref_func.str2obj5(pref.liveTag,"ex_list_obj5",pref.liveTag.ex_list_str),pref_func.str2obj5(pref.liveTag,"rm_list_obj5",pref.liveTag.rm_list_str),pref_func.settings.onchange_funcs.archive["kwd.*"](),this.obj_init_hier(pref3,pref)},obj_elim_the_same:function(e,t,n,r){var a=!1;for(var s in e)if(e.hasOwnProperty(s)&&!Object.getOwnPropertyDescriptor(e,s).get||t.hasOwnProperty(s))if("object"==typeof e[s]&&t[s]&&"object"==typeof t[s])pref_func.obj_elim_the_same(e[s],t[s],n,!0)?(a=!0,n||(Array.isArray(e[s])||Array.isArray(t[s]))&&(e[s]=t[s])):delete e[s];else if(e[s]===t[s]){var o;!e.hasOwnProperty(s)&&(o=Object.getPrototypeOf(t))&&o!==Object.getPrototypeOf({})&&t[s]!==o[s]||delete e[s]}else a=!0,n||(e[s]=t[s]);return(Array.isArray(e)||Array.isArray(t))&&e.length!==t.length&&(a=!1),r?a:e},site2_json_ex_remove:function(){var e=pref_default(!0);pref_func.obj_elim_the_same(e,pref);var t=pref_default().proto;return["catalog","page","thread","float"].forEach(function(n){pref_func.obj_elim_the_same(e[n],t,!0)||delete e[n]}),e},site2_json_ex:function(e,t){var n=this.site2_json_ex_remove();t||n.catalog.filter&&delete n.catalog.filter,e||n.catalog_board_list_str&&delete n.catalog_board_list_str,n.overwrite_site2_json_str&&delete n.overwrite_site2_json_str,pref.overwrite_site2_json_str=t?'{"pref":{"catalog":{"filter":'+JSON.stringify(n.catalog.filter)+"}}}":'{"pref":'+JSON.stringify(n)+"}"},pref_query:function(e,t){var n=""
;for(var r in t)void 0!==e[r]&&(n+='"'+r+'":'+("object"!=typeof t[r]||Array.isArray(t[r])?JSON.stringify(e[r]):pref_func.pref_query(e[r],t[r]))+",");return"{"+n.substr(0,n.length-1)+"}"},site2_eval:function(){},tooltips:site0.isStep?null:function(){function e(e){var t=e&&(e.target.name||e.target.getAttribute("name"))||this.name;if(t&&e&&"radio"===e.target.type&&(t+=", "+e.target.value),t||"LABEL"!==e.target.tagName||(t=e.target.childNodes[0].name+("radio"===e.target.childNodes[0].type?", "+e.target.childNodes[0].value:"")),"SHOW2_I"===t&&(t=e.target.previousSibling.childNodes[1].getAttribute("name")),"SHOW2"===t&&(t=e.target.childNodes[1].getAttribute("name")),t){var n="function"==typeof m[t]?m[t](e):m[t];return n||(n=m[t.substr(0,t.lastIndexOf(".")+1)+"*"]),n||(n=l(m,t,"")||""),pref.test_mode.tips&&(n="Name: "+t+"\n"+n),n=n.replace(/\n/gm,"<br>").replace(/  /g,"&emsp;"),"#"===t[0]?m["#*"](e,n):n}}function t(t){var r=t.target.getAttribute("name"),a=r&&"#"===r[0]?"info":"help";pref.tooltips[a].show&&n(a,t,e)}function n(e,t,n){_=e;var s={target:t.target,currentTarget:t.currentTarget,clientX:t.clientX,clientY:t.clientY};p?a(t,n(t))&&(f=s):(null!==d&&clearTimeout(d),d=setTimeout(r,pref.tooltips[e].popup_delay),f=s,h=n)}function r(){d=null,a(f,h(f))?site.script_body.appendChild(c):f=null,h=null}function a(e,t){return t?("string"==typeof t?c.innerHTML=t:(c.innerHTML=t.html,t.callback&&t.callback(c)),null!==u&&(clearTimeout(u),u=null),e&&p!==e.target&&(c.style.left=e.clientX+20+"px",c.style.top=e.clientY+20+"px",p=e.target),!0):(o(),!1)}function s(e){f&&f.currentTarget===e&&o()}function o(){f&&null===u&&(null!==d&&(clearTimeout(d),d=null),u=setTimeout(i,pref.tooltips[_].popdown_delay))}function i(){u=null,p&&(c.parentNode.removeChild(c),p=null,f=null)}function l(e,t){if(!e)return null;var n=t.indexOf(".");return n==-1?e[t]||e["*"]||null:l(e[t.substr(0,n)],t.substr(n+1))}var c=document.createElement("div");c.style.position="fixed",c.setAttribute("class",pref.script_prefix+"_popUp"),c.style.zIndex=pref.tooltips.zIndex;var p=null,_="help",d=null,u=null,f=null,h=null,m={catalog_refresh_clear:"Clear all threads at update.",catalog_promiscuous:"Gather information whatever.",catalog:{filter:{kwd:{re:"Regular Expression.",ci:"Case insensitive. Don't distinguish upper and lower case.",sentence:'"XXXX YYYY" matches itself as a whole instead of matching "XXXX" and/or "YYYY"'},time:"Time : Hide threads which have no posts after the time.",time_creation:"Time(Creation Time) : Hide threads which were created before the time.",time_watch:"Watch: watch threads which have posts after the time.",time_watch_creation:"Watch(Creation Time): watch threads which were created after the time."}},"catalog.filter.tag_search.str":"String for searching tags.\n[CAUTION] this function is very heavy, keep blank here when you don't use.","catalog.filter.tag_list":!1,"network.cross_domain":"Use 'direct' if you could, because it's quite light, but it doesn't work in almost of all environments.\n'indirect' usually works well and gives full functionality.\nOr you can use 'GreaseMonkeyM's extension if your browser tend to close steps for cross domain when you connect over X-Frame-Options, but this doesn't provide localStorage/IDB features in remote domains.",debug_mode:"Debug mode.",show_tooltip:"Show this tooltip.","liveTag.rm_list_str":function(){return this.TagExLists()},"liveTag.ex_list_str":function(){return this.TagExLists()},TagExLists:function(){return"String, ...  or\n/RegularExpression/, ... or \nIdentifier:String, ... or \nIdentifier:/RegularExpression/, ...\n\nRegularExpression must be embraced by shashes, and accepts i flag(case insensitive).\nIdentifier must be followed by :(colon). First colon is interpreted as a delimiter always. Put a colon at the head of line when you want to use colons in search strings for global search(without any identifiers)\n"+this.GeneralRules},catalog_board_list_str:function(){return"How to write 'Board groups'.\n\nNameOfBoardGroup,Identifier, ..., Commands, ...\n\nEach line becomes each board group. One line per one board group.\nFirst column is a name of board group. The name is shown in board selector and become a key for localStorage or statistics.\nSecond or later columns are members. Each member is expressed by 'Identifier'.\nYou can add tags for filtering or picking up threads. Single # means filter, double #(##) means pick up and filter. For example,\n\nCC, lain/λ/, #CatChan // load lain/λ/ and filter by #CatChan, then shows a thread for CatChan in lain/λ/.\nlain#lainchan, lain, #lainchan // load all boards of lain and filter by #lainchan, then show all threads which have the tag(#lainchan).\n#tech, ##tech // load all boards which have #tech from sites which are set in VirtualBoard, and filter by #tech, then show all threads which have the tag(#tech) from sites.\nAnd you can add commands to the last of each line. '!stats' takes statistics if the function is enabled.\n"+this.GeneralRules},GeneralRules:"Double slash(//) is a beginning of comment.\n\nIdentifier:\nIdentifier is a string which contains domain, board and/or thread. You can omit some of them. When some identifiers are dropped, it'll be interpreted as follows. Upper case has the priority.\n\ndomain/board/thread\n/board/thread\ndomain/thread\nthread\ndomain/board/\n/board/\ndomain\n\n'Board identifier' must be expressed in a couple of slashes, like /int/. 'Thread identifier' must be numeric. When the identifier is a word, it'll be 'Thread identifier' if it is numeric, otherwise it'll be a 'Domain identifier'. Domain identifiers must be one of meguca, lain, 4chan, 8chan or KC.","catalog.style_general_list_str":function(){return"Identifier^Style_string\nStyle_string is a string and set to its object.style.XXXX. Therefore you can use all of styles in CSS, which ranges from 'background' or 'border' to 'fontSize', 'width' or 'height'\n"+this.GeneralRules},"catalog.board.recommendation":"Scans 'board announcement' and gets owner's recommendation. This recommendation must be start 'Recommendation: ', and the following part of the line is treated as a line of board groups. The recommendation can be seen in a last line of board groups.",overwrite_site2_eval_str:"For developers. This function is killed by security reason. If you want to use, you must uncomment the function 'pref_func.site2_eval' by yourself.",catalog_open_where:"this tab: open the thread in this tab, and catalog will be closed.\nnew tab always: this enables you to open a thread in multiple tabs.\nnamed tab: this prevents you from opening a thread in multiple tabs.\na fixed tab: this enables you to use a catalog window as a dashboard.","virtualBoard.scan_domains.*":"None: Don't scan.\nBoard: Read boards.json and set them to boardlist, not scan threads at startup. Threads are scanned when you read them.\nThread: Scan all threads at startup.",scanBoard:"Scan selected virtual boards.\nScan this physical board if no virtual board is selected.",scanSite:"Scan all virtual boards.\nScan all boards in this site if no virtual board is selected.","style.fix.*":"Write style strings.","style.copy.*":"Write exact selectorText in CSS, then its styles are copied.",debug_mode:["pipe","","removed threads from catalog"],dummy:"",archive:{kwd:null},"#*":function(e,t){return liveTag.tooltip(e,t)}};return m.archive.kwd=m.catalog.filter.kwd,m["catalog.filter.tag_search.re"]=m.catalog.filter.kwd.re,{add_root:function(e){e.addEventListener("mouseover",t,!1),e.addEventListener("mouseleave",o,!1)},remove_root:function(e){e.removeEventListener("mouseover",t,!1),e.removeEventListener("mouseleave",o,!1)},show:e,str:m,req_show:n,hide2:o,show_2:a,hide:o,hide_if:s}}(),pref_samples:site0.isStep?null:{simple:{catalog_triage_str:"KILL,X,",catalog:{style_general_list_str:"%border:4px solid #d6daf0\n%margin:4px",format:{show:{posts:!0}}}},backwash:{catalog_triage_str:"NONE,O,width:;height:,NONE,O,border:4px solid #ff0000;width:100px;height:100px,NONE,O,border:4px solid #00ff00;width:100px;height:100px,NONE,O,border:4px solid #0000ff;width:100px;height:100px,NONE,O,border:4px solid #ffff00;width:100px;height:100px,NONE,O,border:4px solid #ff00ff;width:100px;height:100px,NONE,O,border:4px solid #00ffff;width:100px;height:100px",page:{click:"expand"},catalog:{format:{show:{style:!0,contents:!0,layout:!0,posts:!0,fileinfo:!0,images_2nd:!0}}}},recommend:{max_threads_at_refresh:500,catalog:{auto_load_filter:!0,auto_save_filter:!0,auto_save_filter_at_refresh:!0,order:{sticky:"first"},board:{board_tags_same:!0},auto_update:!0,auto_update_period:1},page:{auto_update:!0,auto_update_period:1},float:{auto_update:!0,auto_update_period:1}},get easy2(){return pref.easy2},"easy2.presets":function(){var e=[{liveTag:{use:!1},virtualBoard:{scan:!1},LTfrom:0,VB:{local:0,global:0},network:{fetch_actively:!1}},{liveTag:{use:!1},virtualBoard:{scan:!0},LTfrom:0,VB:{local:1,global:0},network:{fetch_actively:!1}},{liveTag:{use:!1},virtualBoard:{scan:!0},LTfrom:0,VB:{local:1,global:1},network:{fetch_actively:!1}},{liveTag:{use:!0},virtualBoard:{scan:!0},LTfrom:0,VB:{local:2,global:0},network:{fetch_actively:!0}},{liveTag:{use:!0},virtualBoard:{scan:!0},LTfrom:0,VB:{local:2,global:1},network:{fetch_actively:!0}},{liveTag:{use:!0},virtualBoard:{scan:!0},LTfrom:0,VB:{local:2,global:2},network:{fetch_actively:!0}},{liveTag:{use:!0},virtualBoard:{scan:!0},LTfrom:1,VB:{local:2,global:0},network:{fetch_actively:!0}},{liveTag:{use:!0},virtualBoard:{scan:!0},LTfrom:1,VB:{local:2,global:1},network:{fetch_actively:!0}},{liveTag:{use:!0},virtualBoard:{scan:!0},LTfrom:1,VB:{local:2,global:2},network:{fetch_actively:!0}}],t=["none","board","thread"],n={catalog:{auto_load_filter:!0,auto_save_filter:!0,auto_save_filter_at_refresh:!0},page:{load_on_demand:!0}};return function(r){var a=pref.easy2;void 0!==r&&pref_func.pref_overwrite(a,e[r]),a.virtualBoard.scan_domains={};for(var s in pref.virtualBoard.scan_domains)a.virtualBoard.scan_domains[s]=t[s===site.nickname?a.VB.local:a.VB.global];a.liveTag.from=0===a.LTfrom?"op":"post";var o={auto_update:pref.easy2.auto_update,auto_update_period:pref.easy2.auto_update_period};return a.catalog.embed&&pref_func.pref_overwrite(a,{catalog:o}),a.catalog.embed_page&&pref_func.pref_overwrite(a,{page:o}),a.thread.embed&&pref_func.pref_overwrite(a,{thread:o}),(a.catalog.filter.time_watch||a.catalog.filter.time_watch_creation)&&(a.catalog.filter.time_str=new Date(Date.now()-36e5*(a.catalog.filter.time_watch?a.time_post:a.time_op)).toLocaleString()),pref.easy2.basics&&pref_func.pref_overwrite(a,n),a}}(),"easy2.limits":function(){var e=[{virtualBoard:{max:100},scan:{max:100,max_threads:1e3},catalog:{max_threads_at_refresh:500}},{virtualBoard:{max:50},scan:{max:100,max_threads:1500},catalog:{max_threads_at_refresh:1500}},{virtualBoard:{max:150},scan:{max:100,max_threads:15e3},catalog:{max_threads_at_refresh:15e3}},{virtualBoard:{max:100},scan:{max:50,max_threads:15e3},catalog:{max_threads_at_refresh:15e3}},{virtualBoard:{max:150},scan:{max:100,max_threads:3e4},catalog:{max_threads_at_refresh:15e3}},{virtualBoard:{max:200},scan:{max:500,max_threads:1e5},catalog:{max_threads_at_refresh:15e3}},{virtualBoard:{max:200},scan:{max:1e4,max_threads:1e5},catalog:{max_threads_at_refresh:15e3}},{virtualBoard:{max:150},scan:{max:100,max_threads:15e3},catalog:{max_threads_at_refresh:15e3}}];return function(){pref_func.pref_overwrite(pref.easy2,e[pref.easy2.limits])}}(),"easy.virtualBoard_10_passive":{virtualBoard:{show:!0,scan:!0,max:20},catalog:{auto_load_filter:!0,auto_save_filter:!0,auto_save_filter_at_refresh:!0,auto_update:!0,auto_update_period:10},page:{auto_update:!0,auto_update_period:10},float:{auto_update:!0,auto_update_period:10},func:function(){for(var e in pref.virtualBoard.scan_domains)pref.virtualBoard.scan_domains[e]=e===site.nickname?"board":"none"}},"easy.virtualBoard_10":{virtualBoard:{show:!0,scan:!0,max:20},catalog:{auto_load_filter:!0,auto_save_filter:!0,auto_save_filter_at_refresh:!0,auto_update:!0,auto_update_period:10},page:{auto_update:!0,auto_update_period:10},float:{auto_update:!0,auto_update_period:10},func:function(){for(var e in pref.virtualBoard.scan_domains)pref.virtualBoard.scan_domains[e]=e===site.nickname?"thread":"none"}},"easy.virtualBoard_1":{virtualBoard:{show:!0,scan:!0,max:100,scanDelay:20},catalog:{auto_load_filter:!0,auto_save_filter:!0,auto_save_filter_at_refresh:!0,auto_update:!0,auto_update_period:1},page:{auto_update:!0,auto_update_period:1},float:{auto_update:!0,auto_update_period:1},func:function(){for(var e in pref.virtualBoard.scan_domains)pref.virtualBoard.scan_domains[e]=e===site.nickname?"thread":"none"}},"easy.virtualBoard_8_50":{virtualBoard:{show:!0,scan:!0,max:100,scanDelay:20},catalog:{auto_load_filter:!0,auto_save_filter:!0,auto_save_filter_at_refresh:!0,auto_update:!0,auto_update_period:5},page:{auto_update:!0,auto_update_period:5},float:{auto_update:!0,auto_update_period:5},func:function(){pref.scan.max=pref.easy.max_boards;for(var e in pref.virtualBoard.scan_domains)pref.virtualBoard.scan_domains[e]=e===site.nickname?"thread":"none"}},"easy.virtualBoard_8_all":{virtualBoard:{show:!0,scan:!0,max:100,scanDelay:20},scan:{max:1e4},catalog:{auto_load_filter:!0,auto_save_filter:!0,auto_save_filter_at_refresh:!0,auto_update:!0,auto_update_period:5},page:{auto_update:!0,auto_update_period:5},float:{auto_update:!0,auto_update_period:5},func:function(){for(var e in pref.virtualBoard.scan_domains)pref.virtualBoard.scan_domains[e]=e===site.nickname?"thread":"none"}},"easy.virtualBoard_interSite":{virtualBoard:{show:!0,scan:!0,max:100,scanDelay:20},catalog:{auto_load_filter:!0,auto_save_filter:!0,auto_save_filter_at_refresh:!0,auto_update:!0,auto_update_period:10},page:{auto_update:!0,auto_update_period:10},float:{auto_update:!0,auto_update_period:10},func:function(){for(var e in pref.virtualBoard.scan_domains)pref.virtualBoard.scan_domains[e]=e===site.nickname?"thread":"board"}},"easy.posts_0h":{catalog:{filter:{time_str:null,time_watch:!0}},func:function(){pref_func.pref_samples["easy.posts_0h"].catalog.filter.time_str=(new Date).toLocaleString()}},"easy.posts_24h":{catalog:{filter:{time_str:null,time_watch:!0}},func:function(){pref_func.pref_samples["easy.posts_24h"].catalog.filter.time_str=new Date(Date.now()-36e5*pref.easy.posts_ago).toLocaleString()}},"easy.threads_24h":{catalog:{filter:{time_str:null,time_watch_creation:!0}},func:function(){pref_func.pref_samples["easy.threads_24h"].catalog.filter.time_str=new Date(Date.now()-36e5*pref.easy.threads_ago).toLocaleString()}},"easy.embed_index":{catalog:{embed_page:!0,auto_load_filter:!0,auto_save_filter:!0,auto_save_filter_at_refresh:!0}},"easy.embed_index_lazy":{catalog:{embed_page:!0,auto_load_filter:!0,auto_save_filter:!0,auto_save_filter_at_refresh:!0,auto_watch:!1},liveTag:{use:!1},notify:{desktop:{notify:!1}},network:{fetch_actively:!1}},"easy.light":{catalog:{embed_page:!0,auto_load_filter:!0,auto_save_filter:!0,auto_save_filter_at_refresh:!0,filter:{time_watch:!1,time_watch_creation:!1}},liveTag:{use:!1},stats:{use:!1},network:{fetch_actively:!1}},"easy.embed_index_infinite":{catalog_max_page_auto:!0,catalog:{embed_page:!0,auto_load_filter:!0,auto_save_filter:!0,auto_save_filter_at_refresh:!0}},"easy.embed_index_backwash":{catalog_max_page_auto:!0,catalog:{embed_page:!0,auto_load_filter:!0,auto_save_filter:!0,auto_save_filter_at_refresh:!0,auto_update:!0,auto_update_period:0},page:{auto_update:!0,auto_update_period:0},float:{auto_update:!0,auto_update_period:0}},"easy.stat_activate":{stats:{use:!0},virtualBoard:{scan:!0,scan_domains:{}},liveTag:{use:!0,from:"post"},func:function(){this.virtualBoard.scan_domains[site.nickname]="board"}},pn_samples:null,init:function(){if(!pref_func.pref_samples.pn_samples){var e=pref_func.format_html_str('General samples:<br><BTN"simple,simple"><br><BTN"backwash,backwash"><br><BTN"recommend,recommend for desktop/note"><br>Triages:<br><BTN"triage_simple_kill,simple_kill"><br><BTN"triage_simple,simple"><br><BTN"triage_basic,basic"><br><BTN"triage_basic_color,basic_color"><br><BTN"triage_colorful,colorful"><br><BTN"triage_borders,borders"><br><BTN"triage_samples,samples"><br><BTN"triage_test,test"><br>');cnst.make_popup(pref_func.pref_samples,"pn_samples",e,pref_func.pref_samples.onclick_event)}},get_name:function(e,t,n){for(var r in e)"object"!=typeof e[r]?t.push(n+r):pref_func.pref_samples.get_name(e[r],t,n+r+".");return t},onclick_event:function(e,t){t||(t=pref_func.pref_samples[this.name]),t.func&&"function"==typeof t.func&&t.func(),pref_func.pref_overwrite(pref,t),pref_func.pref_overwrite(pref_func.tooltips.str,t);for(var n=pref_func.pref_samples.get_name(t,[],""),r=Array.prototype.slice.call(document.querySelectorAll("*[name]")),a=r.length-1;a>=0;a--)n.indexOf(r[a].name)==-1&&r.splice(a,1);r.length>0&&pref_func.apply_prep(r,!1,!0,null,!0)}},settings:{pn13:null,pnOrDummy:function(e){return this.pn13&&this.pn13.getElementsByTagName("*")[e]||{name:e,tagName:"TEXTAREA"}},show_hide:function(e){if(null===pref_func.settings.pn13){var t=(2*e.clientX>window.innerWidth?"right":"left")+":0px:"+(2*e.clientY>window.innerHeight?"bottom:0":"top:"+site.header_height())+"px",n=cnst.init(t+":Show:tb",cnst.void_func,cnst.void_func,pref_func.settings.show_hide,cnst.void_func),r=cnst.add_to_tb(n,'<select name="settings.indexing"><option>'+pref_func.settings.options.join("</option><option>")+"</option></select>");r.getElementsByTagName("select")["settings.indexing"].selectedIndex=pref.settings.indexing<pref_func.settings.options.length?pref.settings.indexing:0,pref_func.settings.pn13=n,pref_func.settings.onchange_funcs["settings.indexing"](),pref_func.add_onchange(r,pref_func.settings.onchange_funcs_formatted),pref_func.tooltips.add_root(n.childNodes[1]),cnst.bottom_top(n)}else pref_func.tooltips.remove_root(pref_func.settings.pn13.childNodes[1]),pref_func.settings.files_store(),pref_func.settings.pn13=cnst.div_destroy(pref_func.settings.pn13,!0)},apply_pn13_1:function(e,t){pref_func.apply_prep(pref_func.settings.pn13.childNodes[1],e,t),pref_func.settings.onchange_funcs.pn13_1_warning()},files_store:function(){var e=pref_func.settings.pn13.querySelectorAll("input[type=file]");e.length>0&&pref_func.apply_prep_2_all(e,!0)},insert_menu:function(e,t){var n=pref_func.settings.options.length-1;pref_func.settings.options.splice(n,0,e),pref_func.settings.htmls.splice(n,0,t)},html_funcs:{show_hide_all_to_header:function(e){return"<span>"+e+'<a name="SHOWALL" style="float:right;cursor:pointer" data-str="[all▲]">[all▼]</a></span>'},show_hide_all:function(e,t){return'<a name="SHOWALL" style="cursor:pointer">['+e+']</a><a name="HIDEALL" style="cursor:pointer">['+t+"]</a>"},show_hide:function(e,t,n,r){return'<a name="SHOW" style="cursor:pointer" data-str="'+t+'">'+e+'</a><span style="display:none" name="SUB">'+(r||"")+"<br>"+n+"</span>"},popup:function(e){return'2,<ICBX"'+e+'.popup"> Pop up reply'+this.rollup(this.popup_delay("proto.")+'<br>3,<IC"proto.popup_hlt">Highlight the post if it is visible')+"<br>2,"+this.rollup_radio(e+".inline_post"," :Click posts to",3,"",["no:No","inline:Inline the post, shift-click to jump","jump:Jump to the post"])+"<br>"},popup_delay:function(e,t){return'4,<IR"'+e+'popdown,imm">immediately<br>4,<IR"'+e+'popdown,delay">delayed: <ITB4"'+e+'popup_delay">'+(t?"":'<ITB4"'+e+'popdown_delay">')+' ms<br>5,<IC"'+e+'popup_mMove">Don\'t popup while mouse is moving<br>4,zIndex: <ITB3"'+e+'popup_zIndex">'},expand_thumbnail_inline:function(e){var t=e+".thumbnail.inline.";return'2,<IC"'+e+'.expand_thumbnail_inline">Image expansion at click'+this.rollup(this.limit_webm(t)+'3,<IC"'+e+'.expand_thumbnail_initial">Expand all images at initial<br>3,<IC"'+e+'.expand_thumbnail_inline_all_after">Expand all images after clicked one<br>4,<IC"'+t+'ondemand">On demand loading: <ITB3"'+t+'ref_height"> % of browser')+"<br>"},expand_thumbnail_hover:function(e){var t=e+".thumbnail.hover.";return'2,<IC"'+e+'.image_hover">Image hover'+this.rollup(this.popup_delay(t,!0)+"<br>"+this.limit_webm(t)+'3,<IC"'+e+'.image_prefetch">Prefetch next image<br>3,<IC"'+t+'dragfloat">Drag thumbnail to make it window<br>4,<IC"'+t+'df_dblC">Double click to close<br>4,<IC"'+t+'df_mW">Wheel to scroll<br>4,<IC"'+t+'df_cV">Continue playing video<br>3,<IC"'+t+'zoom">Click to zoom mode if limited')+"<br>"},resize_thumbnails:function(e){return'<IC"'+e+'.format.thumb.resize">Resize thumbnails'+this.rollup(this.resize_thumbnails_size(e,"vsmall","Very small")+"<br>"+this.resize_thumbnails_size(e,"small","Small")+"<br>"+this.resize_thumbnails_size(e,"large","Large"))+"<br>"},resize_thumbnails_size:function(e,t,n){var r=e+".format.thumb.";return'3,<IR"'+r+"size,"+t+'">'+n+'<br>4,1st thumbnail: <ITB4"'+r+t+'.w1"> x <ITB4"'+r+t+'.h1"><br>4,2nd and later: <ITB4"'+r+t+'.w2"> x <ITB4"'+r+t+'.h2">'},limit_webm:function(e){return'4,<IC"'+e+'limit_width">Limit to browser\'s width - <ITB3"'+e+'margin_width"> px<br>4,<IC"'+e+'limit_height">Limit to browser\'s height - <ITB3"'+e+'margin_height"> px<br>4,<IC"'+e+'webm">Play webm<br>5,<IC"'+e+'webm_loop">Loop<br>5,<IC"'+e+'webm_mute">Mute<br>'},env:function(e,t){return"1,Environment values:(advanced option)"+this.rollup('2,You are using native function of:<br>3,<IC"'+e+'.popup_native">Pop up reply<br>3,<IC"'+e+'.expand_thumbnail_inline_native">Image expansion<br>3,<IC"'+e+'.image_hover_native">Image hover<br>3,<IC"'+e+'.colorID_native">Color ID<br>3,<IC"'+e+'.backlink_native">Backlink<br>3,<IC"'+e+'.localtime_native">Local time'+t+'<br>2,<IC"'+e+'.popup_native_kill">Suppress native static popup<br>2,<IC"'+e+'.refresh_initial">Refresh at initial<br>'+this.native_html_config(e))+"<br>"},native_html_config:function(e){return'2,Native HTML configuration<br>3,<IC"'+e+'.thread_pos_static">Thread position is static<br>'},posts_for_search:function(e){return"2,"+this.rollup_radio(e+".storePosts"," :Num of posts to store for search",3,"",["no:No additional posts are stored for search.<br>5,Search will be done only from posts for preview.","ALL:All posts are stored always.<br>5,Search will be done from all posts without preparation scan.","auto:All posts in all scanned threads are stored after the first activation of search.<br>5,Need (automatic) scans prior to search. (usual usage)",'ALL_agg:All posts in all scanned threads are stored.<br>5,Search will be done from all scanned threads.<br>5,This is an option for search from entire domains.<br>3,<IC"proto.searchAc.loosen">Auto loosen limits at the first activation'+this.rollup('6,Max boards of a scan: <ITB6"proto.searchAc.max"><br>6,Max threads of a scan: <ITB6"proto.searchAc.max_threads"><br>6,Max threads at refresh (auto deletion): <ITB6"proto.searchAc.max_threads_at_refresh"><br>5,<BTN"tighten_loosed_limits,Tighten loosed limits">')+'<br>3,<IC"proto.searchAs">Auto scan from this (virtual) board if needed <BTN"scanBoardIf,Scan"><BTN"scanBoard,Rescan"><br>3,<IC"proto.searchAsA">Auto scan from all (virtual) boards if needed <BTN"scanSiteIf,Scan"><BTN"scanSite,Rescan">'])+"<br>2,"+this.rollup_radio(e+".sourceOfSP"," :Posts to be used for search",3,"3,Posts may be stored also by function of deleted posts detection.<br>3,Number of stored posts can be shown in footer.<br>",["auto:All stored posts.(usual usage)","pv:Posts for preview only.<br>5,Search will be done only from recent or newer posts,<br>5,which depends on preview settings."])+"<br>"},op_in_search_result:function(e){return"2,"+this.rollup_radio(e+".posts_search_op"," :Unmatched OP in search result",3,"",["show:Show",'opaque:Opaque: <ITB3"'+e+'.posts_search_op_opacity"> %',"hide:Hide"])+"<br>"},deleted_posts_detection:function(e){return"2,"+this.rollup_radio(e+".deleted_posts.detect"," :Detect deleted posts",4,"3,Detection:<br>",["no:No","passive:Passive detection. Don't make any request","acc:Best effort without any additional requests","full:Full detection, read all posts at first","full_IDB:Full detection with IndexedDB"],'<br>3,<ICBX"'+e+'.deleted_posts.merge"> Merge deleted posts with live posts')},popup_others:function(e){return'2,<IC"'+e+'.popupX.use">Pop up others'+this.rollup(this.popup_delay("proto.popupX.")+'<br>3,<IC"'+e+'.popupX.ID">Pop up ID<br>3,<IC"'+e+'.popupX.flag">Pop up flag<br>3,<IC"'+e+'.popupX.name">Pop up name<br>3,<IC"'+e+'.popupX.trip">Pop up trip')+"<br>"},radios:function(e,t,n,r){var a=t+',<IR"'+e+',$1">'+(r?r.map(function(e){return'<IR"'+e+',$1">'}).join(""):"");return n.map(function(e){return e.replace(/([^:]*):/,a)}).join("<br>")},rollup_radio:function(e,t,n,r,a,s,o){return'<a name="SHOW2" style="cursor:pointer" data-str="▲]">[<SSV"'+e+'"></span>▼]</a><span name="SHOW2_I">'+t+'</span><span style="display:none" name="SUB"><br>'+r+this.radios(e,n,a,o)+(s||"")+"</span>"},rollup:function(e,t){return"&emsp;"+this.show_hide("[▼]","[▲]",e,t)},format_posts:function(e,t){return'2,<IC"'+e+'.open_spoiler_text">Open text spoiler<br>2,<IC"'+e+'.colorID">Color ID<br>'+this.backlink(e)+'2,<IC"'+e+'.localtime">Local time<br>'+t.deleted_posts_detection(e)+'<br>2,<IC"'+e+'.mark_new_posts">Mark new posts<br>2,<IC"'+e+".use_expander_always\">Use CatChan's expander always<br>"},backlink:function(e){return'2,<IC"'+e+'.backlink">Backlink'+this.rollup('3,<IC"proto.bl_ec">Explicit cross backlink<br>3,<IC"proto.bl_rm">Don\'t retain backlinks to OP<br>3,<IC"'+e+'.backlink_all">Track all backlinks<br>4,<IC"'+e+'.backlink_all_cross">Track all cross-board links')+"<br>"},merges:function(e){return'2,<IC"'+e+'.merge">Merge all threads'+this.rollup(this.merge_list(e)+"<br>"+this.merge_lv(e)+this.rollup("2,Style tips for merge:<br>"+this.userCSS(2)))+"<br>"+("thread"===e?'2,<IC"thread.merge_auto_list">Auto merge listed threads'+this.rollup('3,<IC"thread.merge_auto_list_lv_add">with level <ITB2"thread.merge_auto_list_lv">')+'<br>2,<IC"thread.merge_op_auto">Auto merge cross-linked threads in OP'+this.rollup('3,to hop <ITB2"thread.merge_op_auto_hop"><br>3,<IC"thread.merge_op_lv_add">with level <ITB2"thread.merge_op_lv">, <IC"thread.merge_op_lv_inc">increment by hop')+"<br>":"")+'2,<IC"'+e+'.merge_btn">Add merge button to cross-links'+this.rollup('3,Merge mode:<br>4,<IR"'+e+'.merge_btn_mode,all"'+("thread"!==e?" disabled":"")+">all (Don't modify the list)<br>4,<IR\""+e+'.merge_btn_mode,list"'+("thread"!==e?" disabled":"")+'>by list (target is added to the list)<br>3,<IC"'+e+'.merge_btn_lv_add">with level <ITB2"'+e+'.merge_btn_lv">')+"<br>"+("thread"===e?'2,<IC"thread.scroll_lock">Don\'t scroll at merging<br>':"")},merge_list:function(e){return'2,<IC"'+e+'.merge_list">Merge listed threads'},merge_lv:function(e){return'3,<TA"proto.merge_list_str,40,1" placeholder="4chan/c/2887897 + 4chan/c/2880944 + 4chan/c/2888255,"><br>2,<IC"'+e+'.merge_lv">Merge with level (use style tips or user CSS to style)<br>3,<TA"proto.merge_lv_str,40,1">'},userCSS:function(e){return e+1+',<IC"style.tips.merged1">Add ">" to merged threads of level 1<br>'+(e+1)+',<IC"style.tips.merged2">Add ">>" to merged threads of level 2<br>'+(e+1)+',<IC"style.tips.merged3">Add ">>>" to merged threads of level 3<br>'+e+',<IC"style.userCSS.use">User CSS<br>'+(e+1)+',<TA"style.userCSS.str,40,1"><br>'+(e+1)+",Sample user CSS:<br>"+(e+1)+',<TA"style.userCSS.sample,40,1" disabled>'},vb_domains:function(){for(var e="2,Scan targets:<br>3,None/Board/Thread(No/Passive/Active)<br>",t=site0.domains,n=0;n<t.length;n++)e+='3,<input type="radio" name="virtualBoard.scan_domains.'+t[n]+'" value="none"><input type="radio" name="virtualBoard.scan_domains.'+t[n]+'" value="board"><input type="radio" name="virtualBoard.scan_domains.'+t[n]+'" value="thread"> '+t[n]+"<br>";return e},make_sel:function(e,t){for(var n='<select name="'+e+'" style="float:none">',r=0;r<t.length;r++)n+="<option>"+t[r]+"</option>";return n+"</select>"},features_domains:function(){for(var e="",t=0;t<site0.domains.length;t++)e+='1,<ICBX"features.domains.'+site0.domains[t]+'"> '+site0.domains[t]+"<br>";return e},cb_block:function(e,t){for(var n="",r=t-1;void 0!==pref[e][++r];)n+='<ICBX"'+e+"."+r+'">'+(r%10==4?"&emsp;":r%50==49?"<br><br>":r%10==9?"<br>":"");return n},footer:function(e){var t=e+".footer.";return'1,<IC"'+t+'use">Show information footer'+this.rollup('3,<IC"'+e+'.footer_br">Always over/under the image')+'<br>2,<IC"'+t+'nrtm">Show num of new replies to me (nm)'+this.rollup('3,<IC"'+t+'nrtm1">Style if &gt;0:<ITBL30"'+t+'nrtm1_style"><br>3,<IC"'+t+'nrtm0">Empty if 0')+'<br>2,<IC"'+t+'nr">Show num of new replies (nr)'+this.rollup('3,<IC"'+t+'nr1">Style if &gt;0:<ITBL30"'+t+'nr1_style"><br>3,<IC"'+t+'nr0">Empty if 0')+'<br>2,<IC"'+t+'rp">Show num of replies (rp), bold (RP)'+this.rollup('3,<IC"'+t+'rOP">Counts OP')+'<br>2,<IC"'+t+'im">Show num of images (im), bold (IM)'+this.rollup('3,<IC"'+t+'iOP">Counts images in OP')+'<br>2,<IC"'+t+'nl">Show num of stored live posts (lp)<br>2,<IC"'+t+'nd">Show num of deleted posts (dp)<br>2,<IC"'+t+'ns">Show num of saged posts (sp)<br>2,<IC"'+t+'page">Show page No. (pg)<br>2,<IC"threadStats.use">Take statistics of each thread'+this.rollup('4,<IC"threadStats.full">Issue additional fetchs if required<br>5,<IC"threadStats.retry">Retry if obsolete data(may cause infinite loop)')+'<br>3,<IC"'+t+'nid">Show num of IDs (ni)<br>3,<IC"'+t+'nf">Show num of flags (nf)<br>2,<ICBX"'+t+'ctime"> <IC"'+t+'rctime">Show created time (ct), relative (cT)<br>2,<ICBX"'+t+'btime"> <IC"'+t+'rbtime">Show bumped time (bt), relative (bT)<br>2,<ICBX"'+t+'ptime"> <IC"'+t+'rptime">Show last posted time (pt), relative (pT)<br>2,<IC"'+t+'prate">Show post rate (pr)<br>2,<IC"'+t+'domain">Show domain\'s name (dn)<br>2,<IC"'+t+'board">Show board\'s name (bd)<br>2,<IC"'+t+'no">Show thread\'s no (no)<br>2,<IC"'+t+'archived">Show archived (ar)<br>2,<IC"'+t+'tag">Show tags<br>2,<IC"'+t+'flag">Show recent flags<br>2,<IC"'+t+'menu">Show menu button at last'+this.rollup('3,<TA"'+t+'menu_str,40,1">',this.rollup(Triage.prototype.howto))+'<br>2,<IC"'+t+'triage">Show triage button at head'+this.rollup('3,<TA"'+t+'triage_str,40,1">',this.rollup(Triage.prototype.howto))+'<br>2,Design:<br>3,<IR"'+t+'design,native"> U: */* / R: * / I: * / P: *<br>3,<IR"'+t+'design,condensed"> */*/*/*/*<br>3,<IR"'+t+'design,meguca"> /bd/ */*/*/*/*'+this.rollup("3,How to custoimze design<br>4,** are replaced by the parameter above.<br>4,() forms a group, all parameters to be replaced must be in ().<br>4,(IB) and (Ib) are italics start/end at bumplimit, must be used in pair.<br>4,(II) and (Ii) are italics start/end at imagelimit, must be used in pair.<br>4,tags of b, i, u, s, iB, iI and span are accepted.<br>4,Style can be used also.<br>4,&lt;iB&gt; and &lt;iI&gt; are pseudo tags for italics at bumplimit/imagelimit.")+'<br>3,<IR"'+t+'design,custom"> <ITBL40"'+t+'custom"><br>3,<IR"'+t+'design,custom2"> <ITBL40"'+t+'custom2"><br>3,<IR"'+t+'design,custom3"> <ITBL40"'+t+'custom3"><br>'},design_of_fc:function(e){return this.rollup_radio("float.view"," :View",e,"",["headline:Headline","catalog:Catalog<br>"+(e+1)+',<IC"float.format.fc.resize">Resize:<ITB4"float.format.fc.width"> x <ITB4"float.format.fc.height">',"page:Page"])},updates:function(e,t,n){return(t?t+",":"")+'<IC"'+e+'.auto_update">Auto update'+(n?"<br>1,":", every ")+'<ITB2"'+e+'.auto_update_period">min.'+(n||"")+"<br>"+t+","+this.rollup_radio(e+".refresh_src"," :Refresh targets from",t+1,"",["bg:Boards group (usual)","bgwl:Both; boards group and watch list (embed watcher)","wl:Watch list (watcher mode)"],"<br>"+(t+2)+',Use catalog if >=<ITB3"'+e+'.refresh_src_th"> threads in a board')+"<br>"},broadcast_triage:function(e,t,n){return this.rollup_radio("triage.sync_"+e," :Sync "+(t||e)+" list in this tab"+(n||""),3,"",["no:No","bg:Sync among the same board group","all:Sync with any board group"])+"<br>"},popup3:function(e,t){
return this.rollup_radio(e+".popup3.ww"," :Pop up",t,"3,WW/WN/NW/NN (Wider/Narrower) side:"+this.rollup(this.popup_delay("proto.popup3."))+"<br>",["no:No","sr:Search result","srpv:Search result or preview","pv:Preview","chart:Post rate chart (statistics must be activated)","dp:Deleted posts"],"",[e+".popup3.wn",e+".popup3.nw",e+".popup3.nn"])+"<br>"},t2h:function(e,t){return"2,"+this.rollup_radio(e+".t2h_sel"," :"+t,3,"",["page:Inherit from index page",'L: <ITB3"'+e+'.t2h_L"> posts(L posts)','M: <ITB3"'+e+'.t2h_M"> posts(M posts)','N: <ITB3"'+e+'.t2h_num_of_posts"> posts(N posts)',"N_unread:N + all unread posts","unread:All unread posts","ALL:All posts"])+"<br>"}},options:["Easy Setting2:","Easy Setting:","Virtual Board:","Catalog:","Index Page:","Thread:","Watcher/FC:","Gerenal 0","General 1","Board Group","Live Tag","Statistics","Footer","Footer for watcher","ThreadReader","Notifiers","JSON Archiver: Store","JSON Archiver: Restore","UIP tracker for 4chan","Command Line Interface","Networking","General 2","Styles","Features","About"],htmls:[function(e){return'Easy Setting2: --- Welcome to CatChan! ---<br><br>1,0. <BTN"easy2.beginner,I\'m a beginner and I just want to try">, click this.<br>2,Then a reload will be occur after loading settings for beginner.<br>2,(This will be default after a certain period of test.)<br>2,Or follow next steps to choose your favorite settings.<br><br>1,1. <input type="checkbox" name="easy2.reset"> Reset all settings before loading new one if you prefer.<br>1,2. Select a preset: <select name="easy2.presets" style="float:none"><option>Safe default</option><option>Silent inter-board operability (for beginner)</option><option>Silent inter-site operability</option><option>Active inter-board operability</option><option>Active inter-site ondemand operability</option><option>Active inter-site operability</option><option>Active in-board operability with LiveTag</option><option>Active inter-board operability with LiveTag</option><option>Active inter-site operability with LiveTag</option></select><br>1,3. Select limits for safe: <select name="easy2.limits" style="float:none"><option>General</option><option>/all/ for lain, meguca</option><option>/all/ for 4chan</option><option>8chan with top 50 boards</option><option>8chan with top 100 boards</option><option>8chan with top 500 boards</option><option>8chan with all boards</option><option>/all/ for KC</option></select><br>1,4. Modify details if you want.<br>2,<input type="checkbox" name="easy2.virtualBoard.show"> VirtualBoards, shows <input type="text" name="easy2.virtualBoard.max" size="3" style="text-align: right;"> virtual boards<br>4,Local: <select name="easy2.VB.local" style="float:none"><option>No</option><option>Passive</option><option>Active</option></select>&emsp;Global: <select name="easy2.VB.global" style="float:none"><option>No</option><option>Passive</option><option>Active</option></select><br>2,<input type="checkbox" name="easy2.liveTag.use"> LiveTag, from: <select name="easy2.LTfrom" style="float:none"><option>OP</option><option>Posts</option></select><br>2,<IC"easy2.catalog.embed">Use CatChan in catalog<br>2,<IC"easy2.catalog.embed_page">Use CatChan in index page<br>2,<IC"easy2.thread.embed">Use CatChan in thread<br>2,<IC"easy2.auto_update">Auto update, every <ITB2"easy2.auto_update_period"> min.<br>2,<IC"easy2.notify.desktop.notify">Desktop notification<br>2,Misc.'+e.rollup('3,<IC"easy2.catalog.filter.time_watch">Hide all threads which have no posts in recent <ITB3"easy2.time_post"> hours<br>3,<IC"easy2.catalog.filter.time_watch_creation">Hide all threads which are created before <ITB3"easy2.time_op"> hours ago<br>3,<IC"easy2.stats.use">Statistics<br>3,<IC"easy2.healthIndicator.expand_running">Show details of running indicators<br>3,<IC"easy2.network.fetch_actively">Fetch missing info actively<br>3,<IC"easy2.basics">Other basic settings<br>3,Limits for safe: <br>4,At scan: <ITB6"easy2.scan.max"> boards, <ITB6"easy2.scan.max_threads"> threads.<br>4,In a catalog: <ITB6"easy2.catalog.max_threads_at_refresh"> threads.')+'<br>1,5. Click <BTN"easy2.apply,Apply"><br>1,6. Click <BTN"save,Save"> if you want to save your settings to localStorage<br>1,7. Click <BTN"reload,Reload">, because some setting may need<br>'},'Easy Setting:<br>&emsp;VBs: virtual boards<br>&emsp;AU: auto update every X min<br>1,<BTN"easy.virtualBoard_10_passive,Click"> 20 VBs / AU 10 min. / passive scan. (for all)<br>1,<BTN"easy.virtualBoard_10,Click"> 20 VBs / AU 10 min. (for lainchan and meguca)<br>1,<BTN"easy.virtualBoard_1,Click"> 100 VBs / AU 1 min. (for 4chan)<br>1,<BTN"easy.virtualBoard_8_50,Click"> 100 VBs / AU 5 min from top <input type="text" name="easy.max_boards" size="3" style="text-align: right;"> boards. (for 8chan)<br>1,<BTN"easy.virtualBoard_8_all,Click"> 100 VBs / AU 5 min from all boards. (for 8chan)<br>1,<BTN"easy.virtualBoard_interSite,Click"> 100 VBs / AU 10 min from all sites. / passive scan. (for all)<br><br>1,<BTN"easy.posts_0h,Click"> I want to check all new posts from now.<br>1,<BTN"easy.posts_24h,Click"> I want to check all posts from <input type="text" name="easy.posts_ago" size="3" style="text-align: right;"> hours ago.<br>1,<BTN"easy.threads_24h,Click"> I want to check all new threads from <input type="text" name="easy.threads_ago" size="3" style="text-align: right;"> hours ago.<br><br>1,<BTN"easy.embed_index_lazy,Click"> Setup for narrow band.<br>1,<BTN"easy.embed_index_infinite,Click"> Setup for infinite scroll.<br>1,<BTN"easy.embed_index_backwash,Click"> Backwash style. (infinite scroll/quick auto update)<br><br>1,<BTN"easy.light,Click"> Setup for light start up.<br>',function(e){return'Virtual Board:<br>&emsp;<input type="checkbox" name="virtualBoard.show"> Show virtual boards, up to: <input type="text" name="virtualBoard.max" size="3" style="text-align: right;"><br>2,<ICBX"virtualBoard.search.show"> Show search bar in boardlist<br>&emsp;<input type="checkbox" name="virtualBoard.scan"> Scan at start up, delay: <input type="text" name="virtualBoard.scanDelay" size="2" style="text-align: right;">s<br>3,Scan: <BTN"virtualBoard.scanStart,Start">&emsp;<BTN"virtualBoard.scanStop,Stop"><br>'+e.vb_domains()+'&emsp;&emsp;<input type="checkbox" name="virtualBoard.instant_scan"> Instant scan<br>&emsp;Physical boards in boardlist:<br>&emsp;&emsp;<input type="radio" name="virtualBoard.p_board" value="both"> Show as they are<br>&emsp;&emsp;&emsp;<input type="checkbox" name="virtualBoard.p_remove"> Remove virtual boards of the same name<br>&emsp;&emsp;<input type="radio" name="virtualBoard.p_board" value="replace"> Replace with virtual boards<br>1,<IC"liveTag.info">Show infomation on hover<br>1,Styles:'+e.rollup('2,Selected:<ITBL30"liveTag.style.in"><br>2,Excluded:<ITBL30"liveTag.style.ex"><br>2,<IC"liveTag.style.use">Add style for unread posts:<br>3,Unread replies to me:<ITBL30"liveTag.style.urtm"><br>3,Unread replies:<ITBL30"liveTag.style.ur"><br>3,Unread replies to me + selected:<ITBL30"liveTag.style.inurtm"><br>3,Unread replies + selected:<ITBL30"liveTag.style.inur"><br>3,Unread replies to me + excluded:<ITBL30"liveTag.style.exurtm"><br>3,Unread replies + excluded:<ITBL30"liveTag.style.exur">')+"<br>"},function(e){return e.show_hide_all_to_header("Catalog:")+'<br>&emsp;<input type="checkbox" name="catalog.embed"> Use CatChan in catalog<br>'+e.expand_thumbnail_hover("catalog")+e.popup_others("catalog")+'&emsp;&emsp;<input type="checkbox" name="catalog.open_spoiler_text"> Open text spoiler<br>'+e.updates("catalog",2)+'2,<IC"catalog.mark_new_posts">Mark new posts at opening threads<br>2,'+e.rollup_radio("catalog.click_area"," :Click to open the thread",3,"",["thumbnail:Thumbnail","entire:Entire thread card"])+"<br>2,"+e.popup3("catalog",3)+"2,"+e.rollup_radio("catalog.t2h_sel"," :Num of posts for preview or footer",3,"",["no:No",'N:Last <ITB3"catalog.t2h_num_of_posts"> posts (N posts)',"N_unread:N + all unread posts","unread:All unread posts","ALL:All posts"])+"<br>"+e.posts_for_search("catalog")+e.op_in_search_result("catalog")+e.deleted_posts_detection("catalog")+'<br>2,<IC"catalog.detect_sage">Detect saged posts in 4chan<br>3,<IC"catalog.page_his">Store page history in 4chan<br>'+e.backlink("catalog")+'2,<IC"catalog.save_board_list_sel">Save board group index<br>2,<IC"catalog.promiscuous">Show all fetched threads<br>'+e.merge_list("catalog")+e.rollup(e.merge_lv("catalog")+'<br>2,OP merge by manual<br>3,to hop <ITB2"catalog.merge_op_auto_hop"><br>3,<IC"catalog.merge_op_lv_add">with level <ITB2"catalog.merge_op_lv">, <IC"catalog.merge_op_lv_inc">increment by hop')+'<br>1,<IC"catalog.embed_archive">Generate catalog in archive'+e.rollup('5,from top <ITB5"scan.max_archive"> threads')+"<br><br>1,Environment values:(advanced option)"+e.rollup('2,You are using native function of:<br>3,<IC"catalog.env.image_hover_native">Image hover<br>2,<IC"catalog.env.refresh_initial">Refresh at initial<br>2,'+e.resize_thumbnails("catalog")+e.native_html_config("catalog.env"))+"<br>"},function(e){return e.show_hide_all_to_header("Index Page:")+'<br>&emsp;<input type="checkbox" name="catalog.embed_page"> Use CatChan in index page'+e.rollup('3,Refresh up to:<br>4,<IR"catalog_max_page_select,manual"> <ITB2"catalog_max_page"> pages<br>4,<IR"catalog_max_page_select,auto"> Max pages<br>5,<ICBX"catalog_max_page_auto"> Update automatically')+"<br>"+e.popup("page")+e.expand_thumbnail_inline("page")+e.expand_thumbnail_hover("page")+e.popup_others("page")+e.format_posts("page",e)+e.t2h("page","Num of posts to show")+e.posts_for_search("page")+e.op_in_search_result("page")+e.updates("page",2)+e.merges("page")+'2,<IC"page.scroll_lock">Don\'t scroll at update<br>2,<IC"page.save_board_list_sel">Save board group index<br>2,<IC"page.promiscuous">Show all fetched threads<br>2,'+e.resize_thumbnails("page")+'2,<IC"page.hide_posts_without_images">Hide posts without images<br><br>'+e.env("page.env","")},function(e){return e.show_hide_all_to_header("Thread:")+'<br>&emsp;<input type="checkbox" name="thread.embed"> Use CatChan in thread<br>'+e.popup("thread")+e.expand_thumbnail_inline("thread")+e.expand_thumbnail_hover("thread")+e.popup_others("thread")+e.format_posts("thread",e)+e.updates("thread",2)+e.merges("thread")+e.t2h("thread","Num of posts to show at initial merging")+'2,<IC"archive.IDB.redirect_404">Open archive from IDB if 404'+e.rollup('3,<IC"archive.IDB.redirect_404_CSP">Open blob to bypass Content Security Policy')+'<br>2,<IC"thread.hide_posts_without_images">Hide posts without images<br><br>'+e.env("thread.env",'<br>3,<input type="checkbox" name="thread.env.auto_update_native"> Auto update')},function(e){return'Watcher / Floating Catalog:<br>1,<IC"catalog.auto_watch">Auto add to watch list<br>1,Default settings:<br>2,'+e.design_of_fc(3)+"<br>"+e.updates("float",2)+'2,<IC"float.hide_unwatched">Show watched threads only (watcher mode)<br>2,<IC"liveTag.NC">Separated virtual board for each instance<br>'+e.merge_list("float")+"<br>1,"+e.rollup_radio("catalog.appearance.initial.state"," :At initial",2,"",["max:Maximized",'float:Floating <ITB4"catalog.appearance.initial.width"> x <ITB4"catalog.appearance.initial.height"><br>4,left:<ITB4"catalog.appearance.initial.left">px, top:<ITB4"catalog.appearance.initial.top">px<br>',"top:Embed to top","bottom:Embed to bottom"])+"<br>1,"+e.popup3("float",2)+'1,<IC"float.save_board_list_sel">Save board group index<br>1,<IC"float.promiscuous">Show all fetched threads<br>1,'+e.resize_thumbnails("float")+'1,<IC"float.disable_kwd_filter_at_initial">Disable keyword filter at initial<br><br>1,Advanced options:<br>2,<IC"common.consolidated_watch_list">Consolidated watch list (for watcher mode)<br>3,<IC"common.sync_watch_list">Sync watch list with other tabs<br>2,'+e.broadcast_triage("watch",null," (ignored if consolidated)")+"2,"+e.broadcast_triage("attr")+"2,"+e.broadcast_triage("ex","exclude")+'2,<IC"liveTag.watch_all">Watch all boards<br>'},function(e){return'General 0:<br>&emsp; Open short link<br>&emsp;&emsp;<input type="radio" name="catalog_open_last50" value="no">No. Open entire thread<br>&emsp;&emsp;<input type="radio" name="catalog_open_last50" value="exist">If it exists<br>&emsp;&emsp;<input type="radio" name="catalog_open_last50" value="exist_watch">If it exists and all unread posts are in it<br>&emsp; Open the thread in<br>&emsp;&emsp;<input type="radio" name="catalog_open_where" value="_self">this tab<br>&emsp;&emsp;<input type="radio" name="catalog_open_where" value="_blank">new tab always<br>&emsp;&emsp;<input type="radio" name="catalog_open_where" value="named">named tab<br>&emsp;&emsp;<input type="radio" name="catalog_open_where" value="CatChan_tgt">a fixed tab<br>2,<ICBX"pref2.meguca.historyAPI"> Use historyAPI in meguca<br>1,Triage:<br>2,Use hover triage on<br>3,<IC"catalog.triage_hover">catalog view<br>3,<IC"page.triage_hover">index page view<br>3,<IC"thread.triage_hover">thread view<br>3,<IC"headline.triage_hover">headline view<br>2,Where to show:<br>3,<span style="display:inline-block"><IR"catalog_triage_place,topLeft">Top left<br><IR"catalog_triage_place,bottomLeft">Bottom left</span><span style="display:inline-block"><IR"catalog_triage_place,topRight">Top right<br><IR"catalog_triage_place,bottomRight">Bottom right</span><br>&emsp;&emsp;pop down delay: <input type="text" name="triage.popdown_delay" size="4" style="text-align: right;">ms<br>&emsp;&emsp;&emsp;<input type="checkbox" name="triage.show_always"> Don\'t pop down while the mouse is on the thread<br>&emsp;&emsp;<input type="checkbox" name="triage.hide_toggle"> Hide useless toggle buttons<br>2,Style of hover triage:'+e.rollup(Triage.prototype.howto)+'<br>3,<TA"catalog_triage_str,40,1"><br>2,Load sample to hover triage:<br>3,<BTN"triage.sample.simple_kill"> <BTN"triage.sample.simple"> <BTN"triage.sample.basic"> <BTN"triage.sample.basic_color"><br>3,<BTN"triage.sample.colorful"> <BTN"triage.sample.borders"> <BTN"triage.sample.toggles"> <BTN"triage.sample.samples"> <BTN"triage.sample.test"><br>2,Style of menu triage:<br>3,<TA"triage.menu_str,40,1"><br>'},function(e){return'General 1:<br>&emsp;Click to:<br>&emsp;&emsp;<input type="radio" name="float.click" value="open">Go to/open the thread<br>&emsp;&emsp;<input type="radio" name="float.click" value="expand">Expand/shrink the OP in catalog<br>&emsp;&emsp;&emsp;&emsp;<input type="checkbox" name="catalog_expand_with_hr"> Insert horizontal splitter when it is expanded<br>&emsp;&emsp;&emsp;<input type="checkbox" name="catalog_no_popup_at_expanded"> Don\'t popup when the catalog is expanded<br>&emsp;&emsp;<input type="radio" name="float.click" value="none">None<br>&emsp;Click area:<br>&emsp;&emsp;<input type="radio" name="float.click_area" value="thumbnail">Thumbnail<br>&emsp;&emsp;<input type="radio" name="float.click_area" value="entire">Entire thread card<br>&emsp;<input type="checkbox" name="float.popup2"> Use pop-up window<br>2,appear/disappear:<br>3,<IR"catalog_popdown,imm">immediately<br>3,<IR"catalog_popdown,delay">delayed: <ITB4"catalog_popup_delay"><ITB4"catalog_popdown_delay"> ms<br>2,grab to move / select text:<br>3,<IR"proto.popup2_sel,move">Move always<br>3,<IR"proto.popup2_sel,auto">Auto, padding-x:<ITB4"proto.popup2_sel_tolerance"> px<br>3,<IR"proto.popup2_sel,sel">Select always<br>3,<ICBX"catalog_popup_size_fix"> Fix size when you move it<br>2,<IC"proto.popup2_resize">Resize on borders of <ITB4"proto.popup2_resize_bw"> px<br>3,Size of corner angle: <ITB4"proto.popup2_resize_cw"> px<br>&emsp;Shows in title bar:<br>&emsp;&emsp;<input type="checkbox" name="catalog.appearance.titleBar.filter">Checkbox to show filter<br>&emsp;&emsp;<input type="checkbox" name="catalog.appearance.titleBar.settings">Checkbox to show settings<br>&emsp;&emsp;<input type="checkbox" name="catalog.appearance.titleBar.refresh">Refresh button<br>&emsp;&emsp;<input type="checkbox" name="catalog.appearance.titleBar.boards_selector">Boards selector<br><br>&emsp;<input type="checkbox" name="catalog.embed_frame"> Embed to frame<br>&emsp;&emsp;Frame size : &emsp;&emsp;<input type="text" name="catalog_size_frame0_width" size="4" style="text-align: right;">%, &emsp;&emsp;<input type="text" name="catalog_size_frame1_width" size="4" style="text-align: right;">%<br>&emsp;&emsp;<input type="checkbox" name="catalog.refresh.except_bt"> Except the page of selecting boards\' tag.<br>&emsp;<input type="checkbox" name="catalog.refresh.at_switch"> Clear and refresh when boards are switched<br>&emsp;<input type="checkbox" name="common.clear_at_manual_scan"> Clear all threads at manual scan<br>1,'+e.rollup_radio("common.watch_list_rm404"," :Remove 404 threads in watch list",2,"",["imm:Immediately","unread:Keep them if they have unread posts<br>4,(can't catch unread posts during offline)",'no:No, user interaction is need to remove<br>2,<IC"archive.IDB.auto_restore_watch">Auto restore pruned threads from IDB archive'])+"<br>1,"+e.rollup_radio("liveTag.rm_404"," :Remove 404 threads",2,"",["imm:Immediately","watched:Keep watched threads","unread:Keep watched threads if they have unread posts","no:No, keep all threads remain"])+'<br>1,<IC"common.blur_404">Blur 404 threads<br>&emsp;<input type="checkbox" name="catalog.bookmark_list_rm404"> Remove 404 threads from bookmark<br>&emsp;<input type="checkbox" name="pref2.8chan.utilize_boards_json"> Utilize boards.json in 8chan<br>1,<ICBX"pref2.meguca.utilize_boards_json"> Utilize boardTimestamps in meguca<br>2,<ICBX"pref2.meguca.utilize_boards_json_domain"> Utilize boardTimestamps at refresh in meguca<br>1,<IC"common.consolidated_filter">Use consolidated filter<br>'},'Board Group:<br>&emsp;configuration:<br>&emsp;&emsp;<textarea rows="1" cols="40" name="catalog_board_list_str"></textarea><br>&emsp;&emsp;<input type="checkbox" name="catalog.board.recommendation"> Read owner\'s recommendation &emsp;&emsp;<BTN"tag.recommendation_add,Add to list"><br>2,<IC"catalog.board.all_boards">Add all boards group to the last<br>&emsp;&emsp;<input type="checkbox" name="catalog.board.board_tags"> Generate board groups from tags &emsp;&emsp;<BTN"tag.scan,Scan"><br>&emsp;&emsp;<input type="checkbox" name="catalog.board.board_tags_same"> Pick up boards which have the same tag&emsp;&emsp;<BTN"tag.same_tag_refresh,Refresh"><br>&emsp;<input type="checkbox" name="catalog.board.ex_list"> Use exclusive list<br>&emsp;&emsp;<textarea rows="1" cols="40" name="catalog.board.ex_list_str"></textarea><br>&emsp;<input type="checkbox" name="catalog.style_general_list"> Use general style<br>&emsp;&emsp;<textarea rows="1" cols="40" name="catalog.style_general_list_str"></textarea><br>&emsp;<input type="checkbox" name="catalog.mimic_base_site"> Mimic base site<br>&emsp;Scan:<br>&emsp;&emsp;Max scan boards <input type="text" name="scan.max" size="6" style="text-align: right;"><br>&emsp;&emsp;Max found threads <input type="text" name="scan.max_threads" size="6" style="text-align: right;"><br>&emsp;&emsp;Num of crawler: <input type="text" name="scan.crawler" size="2" style="text-align: right;"><br>&emsp;&emsp;&emsp;<input type="checkbox" name="scan.crawler_adaptive"> Spawn adaptively at idle<input type="text" name="scan.crawler_idle_time_to_spawn" size="2" style="text-align: right;">ms<br>','Live Tag:<br>1,From:<br>2,<IR"liveTag.from,op">OP<br>2,<IR"liveTag.from,post">All posts<br>1,<ICBX"liveTag.use"> Live<br>1,max: <ITB2"liveTag.max">, max string length: <ITB2"liveTag.maxstr"><br>1,<ICBX"liveTag.ci"> Case insensitive<br>1,<ICBX"liveTag.inherit_board_name"> Inherits board\'s name as a tag<br>2,<ICBX"liveTag.lock_board_name"> Lock & sticky<br>1,<ICBX"liveTag.inherit_board_tags"> Inherits board\'s tags<br>2,<ICBX"liveTag.lock_board_tags"> Lock & sticky<br>1,<ICBX"liveTag.lock_tags_in_op"> Lock & sticky tags in OP<br>1,<ICBX"liveTag.ex_list"> Use exclusive list<br>2,String list to remove before extraction (costs much)<br>3,<textarea rows="1" cols="40" name="liveTag.rm_list_str"></textarea><br>2,Tag list to remove after extraction (costs less)<br>3,<textarea rows="1" cols="40" name="liveTag.ex_list_str"></textarea><br>1,Click function: tags in <br>2,boardlist / threads<br>2,<IR"liveTag.click_func_bl,pkin"><IR"liveTag.click_func,pkin">None -> Fetch/In -> None<br>2,<IR"liveTag.click_func_bl,in"><IR"liveTag.click_func,in">None -> In -> None<br>2,<IR"liveTag.click_func_bl,inex"><IR"liveTag.click_func,inex">None <-> In <-> Out <-> None (ctrl for backward)<br>2,<IR"liveTag.click_func_bl,ex"><IR"liveTag.click_func,ex">None -> Out -> None<br>1,Update intervals:<br>2,Foreground: <ITB4"liveTag.disp_delay.fg">ms<br>2,Background: <ITB4"liveTag.disp_delay.bg">ms<br>2,Lazy draw of incremental search:<br>3,every <ITB4"liveTag.lazy_each"> tags with <ITB4"liveTag.lazy_delay"> ms delay<br>',function(e){return'Statistics:<br>1,<ICBX"stats.use"> Take statistics<br>3,<ICBX"stats.estimate_posts"> Estimate num of posts from posts\' No.<br>4,<ICBX"stats.patch_tm"> Patch for thread move<br>2,Default settings:<br>3,Time unit: '+chart_obj.time_unit_sel_html+"<br>3,"+chart_obj.chart_options_str.join("3,")+'3,Size of window: <ITB4"chart.window_width"> x <ITB4"chart.window_height"><br><br>2,Accumulation:<br>3,<ICBX"stats.load"> Load data<br>4,<ICBX"stats.save"> Save data: <ITB4"stats.len_capture"> points<br>4,Auto acquisition of data:<br>5,<ICBX"stats.auto_acquisition_all"> All board groups which you saw once<br>5,<ICBX"stats.auto_acquisition"> Board groups with \'!stats\'<br>6,<ICBX"stats.auto_acquisition_scan"> Scan all targets at startup with <ITB2"stats.auto_acquisition_scan_delay"> secs delay<br>5,(Targets are colored <span style="background:#b5fbda">green</span> in board selector)<br><br>2,<ICBX"chart.instant_scan"> Instant scan at switching board group<br>2,Delay to draw: <ITB2"stats.draw_delay"> sec.<br>2,<ICBX"chart.off_anime_blur"> Off animation in background<br>2,<ICBX"stats.tolerant"> Tolerant of inaccuracy of server and local clocks<br>5,up to <input type="text" name="stats.tolerance" size="2" style="text-align: right;"> min<br>'},function(e){return"Footer:<br>"+e.footer("catalog")},function(e){return"Footer for watcher:<br>"+e.footer("float")},'ThreadReader:<br>&emsp;<input type="checkbox" name="catalog.unmark_on_hover"> Unmark post on hover<br>&emsp;<input type="checkbox" name="thread_reader.use"> Thread reader<br>&emsp;&emsp;<input type="checkbox" name="thread_reader.own_posts_tracker"> Own posts tracker<br>&emsp;&emsp;&emsp;&emsp;>> (You)<br>&emsp;&emsp;&emsp;&emsp;<input type="radio" name="thread_reader.show_reply_to_me_by" value="anchor"> anchor text<br>&emsp;&emsp;&emsp;&emsp;<input type="radio" name="thread_reader.show_reply_to_me_by" value="plain"> plain text (for dollchan)<br>&emsp;&emsp;&emsp;&emsp;(You) in name field<br>&emsp;&emsp;&emsp;&emsp;<input type="radio" name="thread_reader.show_own_post_by" value="anchor"> name string<br>&emsp;&emsp;&emsp;&emsp;<input type="radio" name="thread_reader.show_own_post_by" value="plain"> plain text<br>&emsp;&emsp;&emsp;<input type="checkbox" name="thread_reader.clean_up_own_posts"> Clean up localStorage at loading embed native catalog<br>&emsp;&emsp;<input type="checkbox" name="thread_reader.sync"> Sync with parent catalog<br>&emsp;&emsp;&emsp;<input type="checkbox" name="thread_reader.triage"> Show triage to parent catalog<br>2,ID enhancer:<br>4,<IC"IDinfo.auto">Auto off when OP doesn\'t have ID or flag<br>3,<IC"IDinfo.ID">Show count of posts by each ID<br>4,<IC"IDinfo.nofIDs">Show count of IDs at the time of post<br>4,<IC"IDinfo.IDop">Show \'OP\' for ID of OP<br>3,<IC"IDinfo.flag">Show count of posts by each flag<br>4,<IC"IDinfo.nofFlags">Show count of flags at the time of post<br>4,<IC"IDinfo.IDFlag">Show count of IDs by each Flag<br>3,<IC"IDinfo.name">Show count of posts by each name<br>4,<IC"IDinfo.nofNames">Show count of names at the time of post<br>4,<IC"IDinfo.nameTrip">Show count of trips by each name<br>3,<IC"IDinfo.trip">Show count of posts by each trip<br>4,<IC"IDinfo.nofTrips">Show count of trips at the time of post<br>',function(e){function t(e,t,n){return t.rollup('4,<IC"notify.'+e+'.supp_init">Suppressed at initial')+"<br>"+n+'2,<IC"notify.'+e+'.reply_to_me">New replies to me<br>2,<IC"notify.'+e+'.reply">New replies<br>2,<IC"notify.'+e+'.new_thread">New threads<br>'+(pref.test_mode[133]?'2,<IC"notify.'+e+'.appear">Appear threads<br>':"")}return'Notifiers:<br>1,<ICBX"notify.desktop.notify"> Desktop Notification'+t("desktop",e,'3,<ITB3"notify.desktop.lifetime"> secs (0 means permanent)<br>3,max: <ITB3"notify.desktop.limit">, delay: <ITB3"notify.desktop.delay">ms<br>3,<ICBX"notify.desktop.show_last"> Show the last post only<br>')+'1,<ICBX"notify.favicon"> Favicon<br>1,<ICBX"notify.title.notify"> Show number of unread replies in title<br>2,<ICBX"notify.title.hide_zero"> Hide unread count in title bar when it is zero<br>1,<IC"notify.sound.notify">Sound&emsp;&emsp;<BTN"notify.sound.pause,Pause">'+t("sound",e,'3,<IR"notify.sound.src,beep">Beep &emsp;freq:<ITB4"notify.sound.beep_freq"> length:<ITB4"notify.sound.beep_length_f"> volume:<ITB4"notify.sound.beep_volume_f"><br>3,<IR"notify.sound.src,file">File &emsp;<input type="file" accept="audio/*" name="notify.sound.file"><br>')},function(e){return archiver.event_funcs.queryQuota(),"JSON Archiver: Store<br><br>1,1. Make sure DOWNLOAD DIRECTORY to be set correctly."+e.rollup('3,All files will be into the directory.<br>3,And also, make sure each download doesn\'t ask you anything.<br>3,So many files will be downloaded.<br>2,<ICBX"archive.editing_timeout"> Timeout for editing posts (patch for meguca)')+'<br>1,2. Select sources for each target:<br>2,File: Manual/Auto<br>3,<ICBX"archive.oneshot.post"><ICBX"archive.live.post"> Posts<br>3,<ICBX"archive.oneshot.tn"><ICBX"archive.live.tn"> Thumbnails<br>3,<ICBX"archive.oneshot.img"><ICBX"archive.live.img"> Images (original size)<br>3,<ICBX"archive.oneshot.webm"><ICBX"archive.live.webm"> Webms<br>2,IndexedDB:'+e.rollup('4,<ICBX"archive.IDB.auto_clean"> Automatic clean up<br>4,<ICBX"archive.IDB.auto_clean_init"> Automatic clean up at start up<br>4,Delayed pruning: <ITB3"archive.IDB.prune"> hours<br>5,<ICBX"archive.IDB.prune_flush"> Archive to file at pruning<br>4,num of transactions: <ITB3"archive.IDB.nof_tr"><br>4,num of requests in a cluster: <ITB3"archive.IDB.nof_cl"> - <ITB3"archive.IDB.nof_cl_max"><br>4,watchdog timer: <ITB3"archive.IDB.watchdog">s')+'<br>4,used / limit: <span name="SHOW_QUOTA"></span><button name="archive.queryQuota"><img src="'+cnst.icons.refresh+'" style="width:1em;height:1em"></button><br>3,Manual/Auto<br>3,<ICBX"archive.oneshot.post_idb"><ICBX"archive.live.post_idb"> Posts<br>3,<ICBX"archive.oneshot.tn_idb"><ICBX"archive.live.tn_idb"> Thumbnails<br>3,<ICBX"archive.oneshot.img_idb"><ICBX"archive.live.img_idb"> Images (original size)<br>3,<ICBX"archive.oneshot.webm_idb"><ICBX"archive.live.webm_idb"> Webms<br>1,3. <IC"archive.list_inherit">Inherit previous archiving list (for 4d,e)<br>1,4a. <IC"archive.store_watched">Auto archiving for watched threads<br>1,4b. <IC"archive.store_auto">Auto archiving if OP matches:<br>2,Keyword: <input type="text" name="archive.kwd.str" size="25">'+pref_func.settings.html_funcs.make_sel("archive.kwd.match",["match all","match any","unmatch all","unmatch any"])+'<br>3,<ICBX"archive.kwd.sub">Subject <ICBX"archive.kwd.name">Name <ICBX"archive.kwd.com">Comment <br>3,<ICBX"archive.kwd.ci">CI <ICBX"archive.kwd.sentence">Sentence <ICBX"archive.kwd.re">RE<br>1,4c. <ICBX"archive.list"> List picker<br>2,<textarea rows="1" cols="40" name="archive.list_str" placeholder="lain  // whole lainchan\n/tech/  // whole /tech/\n/q/1234  // thread /q/1234"></textarea><br>1,4d. <BTN"archive.oneshot,OneShotArchive"> or <BTN"archive.start,StartArchiving"><br>3,<IR"archive.src,shown"> All shown threads<br>3,<IR"archive.src,watched"> All watched threads<br>3,<IR"archive.src,stored"> All stored threads<br>1,4e. You can select target threads individually using triage<br>'},function(e){return 2===pref.archive.files_sel&&archiver.event_funcs.queryList(),'JSON Archiver: Restore<br><br>1,1. Open a live catalog, index page or thread to be overriden.<br>2,CatChan must be working in it.<br>1,2. Select where to extract<br>2,<IR"archive.format,auto">Select from filename: Domain-Board-No_Sub.json<br>2,<IR"archive.format,manual">Set manually: '+e.make_sel("archive.domain",site0.domains)+'/<ITB5"archive.board">/No.<br>1,3a. <ICBX"archive.IDB.auto_restore"> Automatic restore from IndexedDB<br>3,<IC"archive.IDB.auto_restore_remove">Remove deleted thread from display<br>1,3b. Select source from: '+e.make_sel("archive.files_sel",["Dir","Files","IndexedDB"])+'<br><span name="FILES_ARCHIVE0"'+(0===pref.archive.files_sel?"":' style="display:none"')+'>&emsp;&emsp;<span><IF"archive.dir" multiple webkitdirectory directory><BTN"archive.files_clear,X"></span><br></span><span name="FILES_ARCHIVE1"'+(1===pref.archive.files_sel?"":' style="display:none"')+'>&emsp;&emsp;JSONs/HTMLs: <IF"archive.jsons" multiple accept=".html,.json,text/*"><br>2,<ICBX"archive.load_img"> Images: <IF"archive.imgs" multiple webkitdirectory directory><br></span><span name="FILES_ARCHIVE2"'+(2===pref.archive.files_sel?"":' style="display:none"')+'>&emsp;&emsp;<span><select name="archive.IDB_board_sel"'+(pref.archive.IDB_select_multiple?" multiple":"")+' style="float:none"></select><select name="archive.IDB_thread_sel" style="float:none'+(pref4.archive.IDB_thread_sel_options?'"':';display:none"')+(pref.archive.IDB_select_multiple?" multiple":"")+"></select></span>"+e.rollup('&emsp;&emsp;<ICBX"archive.IDB_select_multiple"> Multiple select<br>&emsp;&emsp;Export selected &emsp;&emsp;&emsp;&emsp;<BTN"archive.IDB.export_thread,Threads"><br>&emsp;&emsp;Reset archived time of selected <BTN"archive.IDB.reset_time,Threads">')+e.rollup('&emsp;&emsp;Delete selected <BTN"archive.IDB.delete_board,Boards"><BTN"archive.IDB.delete_thread,Threads"><BTN"archive.IDB.delete_imgs,Images">')+'<br></span>&emsp;&emsp;<BTN"archive.restore_button,Restore"> <ICBX"archive.restore_auto"> Auto restore after selection<br>3,<ICBX"archive.clear_threads"> Clear all threads at opening an archive<br>3,<ICBX"archive.fix_inconsistency"> Fix inconsistencies at open<br>'
},'UIP tracker for 4chan:<br>1,<ICBX"uip_tracker.on"> Show num of unique IPs after post No.<br>3, Check interval: <ITB3"uip_tracker.interval">sec, <ICBX"uip_tracker.adaptive"> Adaptive<br>3, Style of changes: <ITBL30"uip_tracker.highlight_str"><br>2,<ICBX"uip_tracker.posts"> Show num of posts<br>2,<ICBX"uip_tracker.deletion.show"> Show deleted posts\' No.<br>3,<ICBX"uip_tracker.deletion.link"> as links<br>2, Apply style to deleted post:<br>3,<ICBX"uip_tracker.deletion.name"> Add style to name: <ITBL30"uip_tracker.deletion.name_str"><br>3,<ICBX"uip_tracker.deletion.addName"> Add <ITBL30"uip_tracker.deletion.addName_str"> to name<br>3,<ICBX"uip_tracker.deletion.post"> Add style to post: <ITBL30"uip_tracker.deletion.post_str"><br>2,<ICBX"uip_tracker.annotate"> Annotate history of UIP from catalog<br>2,<ICBX"uip_tracker.auto_open"> Open next thread automatically<br>3,Conditions:<br>4,After <input type="text" name="uip_tracker.auto_open_th" size="3" style="text-align: right;">th post<br>4,OP contains <textarea style="height:1em" cols="20" name="uip_tracker.auto_open_kwd"></textarea><br>2,<ICBX"uip_tracker.sage.detect"> Sage detection, tolerance: <ITB2"uip_tracker.sage.tolerance"> sec<br>3,<ICBX"uip_tracker.sage.name"> Add style to name: <ITBL30"uip_tracker.sage.name_str"><br>3,<ICBX"uip_tracker.sage.addName"> Add <ITBL30"uip_tracker.sage.addName_str"> to name<br>3,<ICBX"uip_tracker.sage.post"> Add style to post: <ITBL30"uip_tracker.sage.post_str"><br>3,Bug patch for corrupted data<br>4,<ICBX"uip_tracker.sage.patch_bug3"> Ignore corrupted data at head by history<br>4,<IC"uip_tracker.sage.patch_bug4">Recover by page history<br>4,<IC"uip_tracker.sage.patch_bug5">Cease detection at encountering obsolete data<br>4,<ICBX"uip_tracker.sage.patch_bug2"> Loose detection, to <ITB2"uip_tracker.sage.patch_bug2nth">th thread<br>4,<ICBX"uip_tracker.sage.patch_bug"> Re-evaluate and recover<br>3,<IC"uip_tracker.sage.page">Annotate page history<br>3,<IC"uip_tracker.sage.annotate">Annotate sage from catalog<br>4,<IC"uip_tracker.sage.annotate_page">Annotate page history from catalog<br>','Command interface for overwriting preference<br>&emsp;<textarea style="height:1em" cols="40" name="overwrite_site2_json_str"></textarea><br>1,<BTN"JSON_ex,extract"><BTN"JSON_ex_full,extract_full"><BTN"JSON_ex_filter,extract_current_filter"><br>1,<BTN"JSON_query,query"><BTN"JSON_query_default,query_default"><BTN"JSON_query_boards,query_boards"><br>1,<BTN"JSON,Apply"><span name="JSON_result"></span><br>&emsp;<textarea style="height:1em" cols="40" name="overwrite_site2_eval_str"></textarea><br>1,<BTN"EVAL,EVAL"><br>',function(e){return'Networking:<br>1,Timeout: <ITB3"network.timeout"> sec.<br>&emsp;Cross domain connection:<br>'+e.radios("network.cross_domain",2,["direct: Direct connection",'indirect: Indirect connection<br>3,<ICBX"network.overXFO"> Over X-Frame-Options<br>3,<ICBX"network.overCSPF"> Over Content Security Policy frame',"GM: GreaseMonkey's extension"])+'<br>&emsp;Data source:<br>&emsp;&emsp;<input type="radio" name="catalog.design" value="page">Page<br>&emsp;&emsp;<input type="radio" name="catalog.design" value="auto">Auto<br>&emsp;&emsp;<input type="radio" name="catalog.design" value="catalog">Catalog<br>&emsp;&emsp;&emsp;<input type="checkbox" name="catalog.catalog_json"> From json file<br>1,Lazy load/draw<br>2,Catalog/IndexPage/Float <br>3,<IC"catalog.lazyDraw.merge" style="visibility:hidden"><IC"page.lazyDraw.merge"><IC"float.lazyDraw.merge" style="visibility:hidden">Lazy draw posts, step:<ITB3"proto.lazyDraw.merge_step">(at merge)<br>3,<IC"catalog.draw_on_demand"><IC"page.draw_on_demand"><IC"float.draw_on_demand">Lazy draw threads, step:<ITB3"proto.lazyDraw.step"><br>3,<IC"catalog.load_on_demand"><IC"page.load_on_demand"><IC"float.load_on_demand">Lazy load HTMLs/JSONs<br>2,<input type="checkbox" name="network.adaptive"> Adaptive<br>3,100%: new <input type="text" name="network.th100" size="3" style="text-align: right;"> threads, <input type="text" name="network.th100_delay" size="4" style="text-align: right;"> ms delay<br>3,20%: new <input type="text" name="network.th20" size="3" style="text-align: right;"> threads, <input type="text" name="network.th20_delay" size="4" style="text-align: right;"> ms delay<br>1,<ICBX"catalog_auto_update_countdown"> Show countdown to auto update<br>1,<ICBX"healthIndicator.show"> Health indicator, history: <ITB3"healthIndicator.max"><br>2,<ICBX"healthIndicator.expand_running"> Show details of running indicators<br>2,<ICBX"healthIndicator.dont_retire_running"> Don\'t retire running indicators<br>2,<ICBX"healthIndicator.cancel"> Cancel scan when it is clicked<br>1,<ICBX"network.fetch_actively"> Fetch missing info actively<br>'},'General 2:<br>&emsp;Localtime offset<input type="text" name="localtime_offset" size="2" style="text-align: right;"><br>Share loaded html with other tabs to update<br>&emsp;<input type="checkbox" name="info_server"> Broadcast loaded html to other tabs (server)<br>&emsp;<input type="checkbox" name="info_client"> Listen other tab\'s broadcasting (client)<br>Cloudflare<br>&emsp;<input type="checkbox" name="cloudflare.auto_reload"> Auto reload at server error<br>&emsp;&emsp;<input type="text" name="cloudflare.auto_reload_time" size="2" style="text-align: right;"> minutes after<br><br><input type="checkbox" name="tooltips.info.show"> Show infotips<br>&emsp;pop up delay: <input type="text" name="tooltips.info.popup_delay" size="4" style="text-align: right;"> ms<br>&emsp;pop down delay: <input type="text" name="tooltips.info.popdown_delay" size="4" style="text-align: right;"> ms<br><input type="checkbox" name="tooltips.help.show"> Show tooltips<br>&emsp;pop up delay: <input type="text" name="tooltips.help.popup_delay" size="4" style="text-align: right;"> ms<br>&emsp;pop down delay: <input type="text" name="tooltips.help.popdown_delay" size="4" style="text-align: right;"> ms<br>Z-Index of tooptips: <ITB4"tooltips.zIndex"><br>Misc.<br><input type="checkbox" name="recovery.comment"> Recover comment when browser was crashed<br><input type="checkbox" name="catalog_footer_ignore_my_own_posts"> Ignore my own posts at counting unread posts<br><input type="checkbox" name="pref2.KC.summer_time"> Summer time in KC<br><br>Patches<br><input type="checkbox" name="patch.delayed_invoke.use"> Delayed invoke for 4chan, <input type="text" name="patch.delayed_invoke.sec" size="2" style="text-align: right;">sec.<br>',function(e){return'Styles:<br>1,Windows and popups:<br>2,Z-Index: <ITB4"style.zIndex"><br>2,<IR"style.sel,fix"> Fixed <BTN"style.reset.fix,reset"><br>3,Title bar:<ITBL30"style.fix.titleBar_str"><br>3,Window:<ITBL30"style.fix.window_str"><br>3,Pop up:<ITBL30"style.fix.popUp_str"><br>2,<IR"style.sel,copy"> Copy from CSS <BTN"style.reset.copy,reset"><br>3,Title bar:<ITBL30"style.copy.titleBar_str"><br>3,Window:<ITBL30"style.copy.window_str"><br>3,Pop up:<ITBL30"style.copy.popUp_str"><br>1,Others:<br>2,New post:<ITBL30"style.post_new"><br>2,Editing post:<ITBL30"style.post_editing"><br>1,Tips:<br>'+e.userCSS(1)},function(e){return'Features:<br>1,<ICBX"features.page"> Page<br>1,<ICBX"features.graph"> Graph<br>1,<ICBX"features.setting2"> Setting2<br>1,<ICBX"features.postform"> Postform<br>1,<ICBX"features.catalog"> Catalog<br>1,<ICBX"features.listener"> Listener<br>1,<ICBX"features.uip_tracker"> UIP_tracker<br>1,<ICBX"features.thread_reader"> Thread Reader<br>1,<ICBX"features.recovery"> Recovery comment<br>Notifications:<br>1,<ICBX"features.notify.desktop"> DesktopNotification<br>1,<ICBX"features.notify.sound"> Sound<br>1,<ICBX"features.notify.favicon"> Favicon<br>Sites:<br>'+e.features_domains()},function(e){return'CatChan<br>Version 2020.01.19.0<br><a href="https://github.com/DogMan8/CatChan">GitHub</a><br><a href="https://github.com/DogMan8/CatChan/raw/master/CatChan.user.js">Get stable release</a><br><a href="https://github.com/DogMan8/CatChan/raw/develop/CatChan.user.js">Get BETA release</a><br><br><br>Debug mode<br><input type="checkbox" name="debug_mode.0"><input type="text" name="debug_mode.unread_count" size="30" style="text-align: right;"><input type="checkbox" name="debug_mode.2"><input type="checkbox" name="debug_mode.3"><input type="checkbox" name="debug_mode.4">&emsp;<input type="checkbox" name="debug_mode.5"><input type="checkbox" name="debug_mode.parse_error"><input type="checkbox" name="debug_mode.7"><br><input type="text" name="debug_mode.site2func" size="15" style="text-align: right;" placeholder="catalog_json2html3"><BTN"debug_site2,dump_site2"><input type="checkbox" name="debug_mode.site2func_expand">func<br><input type="text" name="debug_mode.pfunc" size="15" style="text-align: right;" placeholder="4chan:catalog_json"><BTN"debug_pfunc,dump_parse_funcs"><input type="checkbox" name="debug_mode.pfunc_expand">func<br><input type="text" name="debug_mode.pfunc_comp" size="15" style="text-align: right;" placeholder="4chan:catalog_json"><BTN"debug_pfunc_comp,compare_parse_funcs"><input type="checkbox" name="debug_mode.pfunc_comp_expand_same"><input type="checkbox" name="debug_mode.pfunc_comp_expand_diff">func <br>1,<input type="text" name="debug_mode.pfunc_comp_proto" size="40" style="text-align: right;" placeholder="temporal prototype, DEFAULT:catalog_json"><br><input type="text" name="debug_mode.pfunc_all" size="15" style="text-align: right;"  placeholder="op_img_url"><BTN"debug_pfunc_all,find_parse_funcs"><input type="checkbox" name="debug_mode.pfunc_all_expand">func<br><input type="checkbox" name="debug_mode.9"><br>'+e.cb_block("debug_mode",10)+'<BTN"debugWindow,debugWindow"><br>Test mode'+e.rollup(e.cb_block("test_mode",0)+'<br><IC"test_mode.tips"><ITB6"test_mode.num"><ITBL30"test_mode.test_str"><ITB6"test_mode.num_f">&emsp;<BTN"button_test,test"><br>1,<BTN"load_samples,setting_samples"><br><IF"test_mode.js_file" accept=".js,text/*"><BTN"test_mode.js_load,JS_load">')+"<br>"}],html_common:'<span name="reload_recommended" style="display:none;background:yellow">&emsp;&emsp;RELOAD IS REQUIRED TO GET LIGHT FEELING&emsp;&emsp;<br></span><span name="reload_required" style="display:none;background:red;color:white">&emsp;&emsp;RELOAD IS REQUIRED&emsp;&emsp;</span><br><BTN"close,close">&emsp;<BTN"save,save"><BTN"load_default,load_default"><BTN"load_default_of_this_page,load_default_of_this_page">',tag_gen:null,get onchange_funcs_formatted(){return Object.defineProperty(this,"onchange_funcs_formatted",{value:pref_func.add_onchange_format(this.onchange_funcs),writable:!0,enumerable:!0,configurable:!0}),pref_func.add_onchange_format(this.onchange_funcs.archive),this.onchange_funcs_formatted},oninput_funcs:null,onchange_funcs:{__proto__:{__proto__:{SHOWALL:function(e){this.TOGGLE(e.target,"HIDEALL","",null,"no"),Array.prototype.slice.call(e.target.parentNode.parentNode.querySelectorAll("[name=SHOW],[name=SHOW2],[name=SHOW3]")).forEach(function(e){e.onclick({target:e,currentTarget:e})})},HIDEALL:function(e){this.TOGGLE(e.target,"SHOWALL","",null,"no"),Array.prototype.slice.call(e.target.parentNode.parentNode.querySelectorAll("[name=HIDE],[name=HIDE2],[name=HIDE3]")).forEach(function(e){e.onclick({target:e,currentTarget:e})})},SHOW:function(e){this.TOGGLE(e.target,"HIDE","")},HIDE:function(e){this.TOGGLE(e.target,"SHOW","none")},TOGGLE:function(e,t,n,r,a){r||(r=e);var s=e.getAttribute("data-str");e.setAttribute("data-str",r.textContent),r.textContent=s,e.setAttribute("name",t),"no"!==a&&(a||(a=e.nextSibling),a.style.display=n)},SHOW2:function(e){this.TOGGLE2(e.target,"HIDE2","")},HIDE2:function(e){this.TOGGLE2(e.target,"SHOW2","none")},TOGGLE2:function(e,t,n){"A"!==e.tagName&&(e=e.parentNode),this.TOGGLE(e,t,n,e.childNodes[2],e.nextSibling.nextSibling)},SHOW3:function(e){for(var t=e.target.getAttribute("data-show3"),n=e.target.previousSibling;n.getAttribute("data-show3")!==t;)n=n.previousSibling;n.style.display="",e.target.style.display="none"},HIDE3:function(e){for(var t=e.target.parentNode.getAttribute("data-show3"),n=e.target.parentNode.nextSibling;n.getAttribute("data-show3")!==t;)n=n.nextSibling;n.style.display="",e.target.parentNode.style.display="none"},SHOW2_I:function(e){var t=e.target.previousSibling;t.onclick({target:t,currentTarget:t})},SHOW4:function(e){e.target.style.display="none",e.target.previousSibling.style.display=null},HIDE4:function(e){e.target.parentNode.style.display="none",e.target.parentNode.nextSibling.style.display=null},SUB:function(e){var t=e.currentTarget.previousSibling.previousSibling;if(t&&t.querySelectorAll){var n=t.querySelectorAll("span[data-class=show_value]");n.length>0&&pref_func.apply_prep(n,!1,null,null,null,this["."]&&this["."].pref||null)}},"virtualBoard.search.str":function(){liveTag.filter_onchange(pref.virtualBoard.search)}}},"uip_tracker.on":uip_tracker_init,"healthIndicator.show":function(){cataLog.healthIndicator.show()},"healthIndicator.expand_running":function(){cataLog.healthIndicator.shrink_running()},"settings.indexing":function(e){var t=pref_func.settings,n=pref_func.settings.pn13.childNodes[1];pref_func.settings.files_store();var r=t.htmls[pref.settings.indexing],a=("function"==typeof r?r(t.html_funcs):r)+t.html_common;n.innerHTML='<form name="CatChan_settings">'+pref_func.format_html_str(a)+"</form>",pref_func.add_onchange(n,pref_func.settings.onchange_funcs_formatted),pref_func.settings.apply_pn13_1()},pn13_1_warning_reload:function(){pref3.reload_required=!0,pref_func.settings.onchange_funcs.pn13_1_warning()},pn13_1_warning:function(){var e=pref_func.settings.pn13.childNodes[1],t=e.getElementsByTagName("span").reload_required;t.style.display=pref3.reload_required||pref3.stats.use!==pref.stats.use||pref.stats.estimate_posts&&!pref3.stats.estimate_posts?"":"none";var t=e.getElementsByTagName("span").reload_recommended;t.style.display=!pref.stats.estimate_posts&&pref3.stats.estimate_posts?"":"none"},"tag.scan":function(){pref.catalog.board.board_tags=!0,pref_func.settings.onchange_funcs["tag.generate_caller"]("tag.scan"),liveTag.popup_filter.popup()},"tag.same_tag_refresh":function(){pref.catalog.board.board_tags_same=!0,pref_func.settings.onchange_funcs["tag.generate_caller"]("tag.same_tag_refresh")},"tag.generate_caller":function(e){site2[site.nickname].get_boards_json("manual_refresh_boards_json",null,null,!0)},"tag.gen":function(){for(var e=pref_func.settings.tag_gen.childNodes[1].getElementsByTagName("input"),t="",n=pref_func.settings.tag_gen.childNodes[1].getElementsByTagName("textarea")[0].value,r=site3["8chan"].boards,a=0;a<e.length;a++)if(e[a].checked){var s=e[a].nextSibling.textContent.replace(/ [0-9]*: /,"");""===n&&(n="#"+s);for(var o=0;o<r.length;o++)for(var i=0;i<r[o].tags.length;i++)r[o].tags[i]==s&&(t=t+"8chan/"+r[o].uri+"/,")}pref_func.catalog_board_list_str_bt=n+","+t,pref_func.settings.onchange_funcs.board_sel_refresh()},"tag.gen_add":function(){pref_func.settings.onchange_funcs["tag.gen"](),pref_func.settings.onchange_funcs["tag.add_to_list"](pref_func.catalog_board_list_str_bt)},"tag.recommendation_add":function(){pref_func.settings.onchange_funcs["tag.add_to_list"](pref_func.catalog_board_list_str_or)},"tag.add_to_list":function(e){""!==e&&(pref.catalog_board_list_str.search(/\n$/)==-1&&(pref.catalog_board_list_str=pref.catalog_board_list_str+"\n"),pref.catalog_board_list_str=pref.catalog_board_list_str+e+"\n",pref_func.settings.pn13&&pref_func.settings.apply_pn13_1(),pref_func.settings.onchange_funcs.board_sel_refresh())},board_sel_refresh:function(){pref_func.str2obj("catalog_board_list_str"),cnst.auto_shrink_board_selector.str_changed()},"stats.use":"pn13_1_warning","stats.estimate_posts":"pn13_1_warning","stats.auto_acquisition":function(){cnst.auto_shrink_board_selector.color()},"stats.auto_acquisition_all":"stats.auto_acquisition","catalog.board.recommendation":"board_sel_refresh","catalog.board.board_tags":"board_sel_refresh",catalog_board_list_str:"board_sel_refresh","catalog.board.all_boards":"board_sel_refresh",JSON:function(){pref_func.site2_json()},JSON_query_boards:function(){pref.overwrite_site2_json_str='{"site2":{"'+site.nickname+'":{"boards_json":""}}}',pref_func.site2_json(!0)},JSON_query:function(){pref_func.site2_json(!0)},JSON_query_default:function(){pref_func.site2_json(pref_default())},JSON_ex:function(){pref_func.site2_json_ex(!1),pref_func.settings.apply_pn13_1()},JSON_ex_full:function(){pref_func.site2_json_ex(!0),pref_func.settings.apply_pn13_1()},JSON_ex_filter:function(){pref_func.site2_json_ex(!1,!0),pref_func.settings.apply_pn13_1()},EVAL:function(){pref_func.site2_eval()},close:function(){pref_func.settings.show_hide()},save:function(){localStorage&&(localStorage[pref.script_prefix+".pref"]=JSON.stringify(pref_func.site2_json_ex_remove()))},load_default:function(e){var t=pref_default();if(delete t.settings.indexing,delete t.catalog_board_list_sel,delete t.catalog.filter,"load_default_of_this_page"===e.target.name){for(var n=e.target.parentNode.getElementsByTagName("*"),r=0;r<n.length;r++)if(n[r].name){var a=pref_func.get_tgt(n[r].name,t,!0);if(a){var s=pref_func.get_tgt(n[r].name);s[0][s[1]]=a[0][a[1]]}}}else 0===e.target.name.indexOf("easy2")&&delete t.easy2,pref_func.pref_overwrite(pref,t),pref3.reload_required=!0;pref_func.obj_init(),pref_func.settings.apply_pn13_1(),pref_func.settings.apply_pn13_1(!0,"load_default_of_this_page"===e.target.name&&cataLog.threads)},load_default_of_this_page:"load_default",load_samples:function(){pref_func.pref_samples.init()},catalog_triage_str:function(){cataLog.triage&&cataLog.triage.remake()},"triage.hide_toggle":"catalog_triage_str","triage.menu_str":"catalog_triage_str","catalog.footer.*w/":function(e,t){cataLog.Footer&&cataLog.Footer.update_all_force(e,t)},"float.footer.*w/":"catalog.footer.*w/","thread_reader.use":thread_reader_init,"catalog.appearance.titleBar.*w/":function(e,t){catalog_obj&&null!==catalog_obj.catalog_func()&&(catalog_obj.catalog_func().pn12_0_2.getElementsByTagName("*")[t.split(".").pop()].style.display=e.currentTarget.checked?"":"none")},"style.tips.*w/":function(e,t){var n=t.split(".")[2],r=pref.style.tips[n+"_str"];styleSheet.register_cc(pref.style.tips[n]?r:r.slice(0,r.indexOf("{")),pref.style.tips[n]?void 0:null)},"catalog.click_area":styleSheet.make_rule_click_area,"style.sel":styleSheet.styles_changed,"style.fix.*":"style.sel","style.copy.*":"style.sel","style.reset.*w/":function(e,t){var n=pref_default(),r=t.split(".")[2];pref_func.pref_overwrite(pref.style[r],n.style[r]),pref_func.settings.apply_pn13_1(),pref_func.settings.onchange_funcs["style.sel"]()},"style.userCSS.*":styleSheet.userCSS_changed,"virtualBoard.p_board":function(){liveTag.update_boardlist(!0)},"virtualBoard.p_remove":"virtualBoard.p_board","virtualBoard.max":"virtualBoard.p_board","virtualBoard.show":"virtualBoard.p_board","easy.virtualBoard_10_passive":"easy.virtualBoard_10","easy.virtualBoard_10":function(){pref_func.settings.onchange_funcs.pn13_1_warning_reload(),pref_func.pref_samples.onclick_event.call(this)},"easy.virtualBoard_1":"easy.virtualBoard_10","easy.virtualBoard_8_50":"easy.virtualBoard_10","easy.virtualBoard_8_100":"easy.virtualBoard_10","easy.virtualBoard_8_500":"easy.virtualBoard_10","easy.virtualBoard_8_all":"easy.virtualBoard_10","easy.virtualBoard_interSite":"easy.virtualBoard_10","easy.posts_0h":"easy.virtualBoard_10","easy.posts_24h":"easy.virtualBoard_10","easy.threads_24h":"easy.virtualBoard_10","easy.embed_index":"easy.virtualBoard_10","easy.embed_index_lazy":"easy.virtualBoard_10","easy.embed_index_infinite":"easy.virtualBoard_10","easy.embed_index_backwash":"easy.virtualBoard_10","easy.light":"easy.virtualBoard_10","easy.stat_activate":"easy.virtualBoard_10","easy2.beginner":function(e){pref.easy2.presets=1,pref_func.settings.onchange_funcs["easy2.presets"](e,pref.easy2.presets),pref_func.settings.onchange_funcs["easy2.apply"](e,!0),pref_func.settings.onchange_funcs.reload(e)},"easy2.presets":function(e,t){pref_func.pref_samples["easy2.presets"](void 0!==t?t:pref.easy2.presets),pref_func.settings.apply_pn13_1()},"easy2.limits":function(e,t){pref_func.pref_samples["easy2.limits"](),pref_func.settings.apply_pn13_1()},"easy2.apply":function(e,t){(pref.easy2.reset||t)&&pref_func.settings.onchange_funcs.load_default(e),pref_func.pref_samples["easy2.presets"](),pref_func.settings.onchange_funcs.pn13_1_warning_reload(),pref_func.pref_samples.onclick_event(null,pref.easy2)},reload:function(){location.reload()},"triage.sample.*w/":function(e,t){var n={simple_kill:"KILL,X,",simple:"KILL,X,,TIME,v,,WATCH,W,,UNWATCH,UW,,UNDO,U,",basic:"KILL,X,,TIME,v,,WATCH,W,,UNWATCH,UW,,SHOW,★,,UNSHOW,☆,,STICKY,S,,UNSTICKY,US,,UNDO,U,",basic_color:"KILL_N,X,,TIME_N,v,,WATCH,W,,UNWATCH,UW,,SHOW,★,,UNSHOW,☆,,STICKY,S,,UNSTICKY,US,,UNDO,U,\nNONE,O,,ATTR,O,background:#c3dcf9,ATTR,O,background:#b8efc2,ATTR,O,background:#efedbe,ATTR,O,background:#fbd5fb,ATTR,O,background:#fac2c5\nATTR,O,border:3px solid blue,ATTR,O,border:3px solid lime,ATTR,O,border:3px solid yellow,ATTR,O,border:3px solid orange,ATTR,O,border:3px solid red\n",colorful:"KILL,X,,KILL,X,background:#c3dcf9,KILL,X,background:#b8efc2,KILL,X,background:#efedbe,KILL,X,background:#fbd5fb,KILL,X,background:#fac2c5\nTIME,v,,TIME,v,background:#c3dcf9,TIME,v,background:#b8efc2,TIME,v,background:#efedbe,TIME,v,background:#fbd5fb,TIME,v,background:#fac2c5\nNONE,O,,NONE,O,background:#c3dcf9,NONE,O,background:#b8efc2,NONE,O,background:#efedbe,NONE,O,background:#fbd5fb,NONE,O,background:#fac2c5\nUNDO,U,,WATCH,W,,UNWATCH,UW,,GO,G,\n",borders:"KILL,X,,KILL,X,border:3px solid blue,KILL,X,border:3px solid lime,KILL,X,border:3px solid yellow,KILL,X,border:3px solid orange,KILL,X,border:3px solid red\nTIME,v,,TIME,v,border:3px solid blue,TIME,v,border:3px solid lime,TIME,v,border:3px solid yellow,TIME,v,border:3px solid orange,TIME,v,border:3px solid red\nNONE,O,,NONE,O,border:3px solid blue,NONE,O,border:3px solid lime,NONE,O,border:3px solid yellow,NONE,O,border:3px solid orange,NONE,O,border:3px solid red\nUNDO,U,,WATCH,W,,UNWATCH,UW,,GO,G,\n",toggles:"KILL,X,,TIME,v,,WATCH,W,,UNWATCH,UW,,UNDO,U,,SHOW,★,,UNSHOW,★,border:2px inset,STICKY,†,,UNSTICKY,†,border:2px inset;,NONE,n,",samples:"KILL,delete forever,\nTIME,hide until new replies,\nNONE,back to default design,background:;border:;\nNONE,border and background,background:#c3dcf9;border:3px solid blue\nNONE,border 3px,border:3px solid blue\nNONE,background,background:#c3dcf9\nNONE,border 5px,border:5px solid blue\nNONE,border 1px,border:1px solid blue\nNONE,transparent,background:\nNONE,shrink,width:100px;height:100px\nGO,open this thread,\n",test:"KILL,X,,TIME,v,,WATCH,W,,UNWATCH,UW,,SHOW,★,,UNSHOW,☆,,STICKY,S,,UNSTICKY,US,,UNDO,U,,ARC,A+,,ARC1,A1,,UNARC,A-,"};pref.catalog_triage_str=n[t.split(".").pop()];var r=pref_func.settings.pn13.getElementsByTagName("*").catalog_triage_str;r&&pref_func.apply_prep(r,!1),this.catalog_triage_str(e)},"virtualBoard.scanStart":function(){catalog_obj&&null!==catalog_obj.catalog_func()&&catalog_obj.catalog_func().catalog_liveTag_scan_site()},"virtualBoard.scanStop":function(){scan.abort()},"virtualBoard.scan_domains.*w/":function(e,t){if(pref.virtualBoard.instant_scan){var n=t.split(".").pop();scan.keyword_load_1(n)}},"virtualBoard.search.show":function(e,t){if(site.components.boardlist){var n="virtualBoard.search",r=site.components.boardlist.getElementsByTagName("input")[n+".str"];r&&(r=r.parentNode),pref.virtualBoard.search.show?r||(r=document.createElement("span"),r.innerHTML=pref_func.format_html_str('<ITBL10"'+n+'.str"><span style="display:none"><ICBX"'+n+'.re">RE, &lt;<ITB2"virtualBoard.max"><span name="HIDE4">◀</span></span><span name="SHOW4">▶</span>'),r.style="float:right",pref_func.apply_prep(r,!1),pref_func.add_onchange(r,pref_func.settings.onchange_funcs_formatted,pref_func.settings.oninput_funcs),site.settings.parentNode.insertBefore(r,site.settings),pref_func.mirror_targets.boardlist=r,t||liveTag.update_pn()):r&&(site.settings.parentNode.removeChild(r),pref_func.mirror_targets.boardlist=null,liveTag.update_pn())}},"virtualBoard.search.*":"virtualBoard.search.str",debug_site2:function(){pref.debug_mode.site2func&&common_func.debug_site2func(pref.debug_mode.site2func)},debug_pfunc:function(){pref.debug_mode.pfunc&&common_func.debug_parse_funcs_entry(pref.debug_mode.pfunc)},debug_pfunc_comp:function(){pref.debug_mode.pfunc_comp&&common_func.debug_parse_funcs_entry(pref.debug_mode.pfunc,pref.debug_mode.pfunc_comp)},debug_pfunc_all:function(){pref.debug_mode.pfunc_all&&common_func.debug_parse_funcs_all(pref.debug_mode.pfunc_all)},"liveTag.ex_list_str":function(){liveTag.ex_list_changed()},"liveTag.inherit_board_name":function(){liveTag.inherit_board_name_changed()},"liveTag.inherit_board_tags":function(){liveTag.inherit_board_tags_changed()},"page.mark_new_posts":function(){if(gClg.Clgs)for(var e=0;e<gClg.Clgs.length;e++)gClg.Clgs[e].view_time_filter_changed()},"recovery.comment":function(){recovery.setup()},"*.open_spoiler_text":styleSheet.open_spoiler_text,"*.scroll_lock":function(){cataLog.general_event_handler.setup()},button_test:function(){function e(e,t,n,r){console.log(r)}IDB.req_raw("meguca","meguca","mine",null,e,"get_all",!0)},"*.posts_search_op":function(e,t){t||(t=cataLog.embed_mode),styleSheet.register(".CatChan_search_miss","opaque"===pref[t].posts_search_op?"opacity:"+pref[t].posts_search_op_opacity/100+" !important":"hide"===pref[t].posts_search_op?"display:none !important":null)},"*.posts_search_op_opacity":"*.posts_search_op","style.post_editing":function(){styleSheet.register("."+pref.script_prefix+"_post_editing",pref.style.post_editing)},archive:{restore2:function(e,t,n){if(cataLog.threads&&(!e||pref.archive.restore_auto||"archive.restore_button"===e.target.name)){n||(t=Array.prototype.slice.call(pref3.archive.dir.files),n=t.filter(function(e,t,n){return e.name.search(/\.(json|html*)$/)!=-1}),n=n.filter(function(e,t,n){return e.name.indexOf("_deleted.json")==-1}));var r=t.filter(function(e,t,n){return e.name.search(/\.(json|html*)$/)==-1});0!==n.length&&archiver.restore_entry(n,r,this.clear_files_button,t.filter(function(e,t,n){return e.name.indexOf("_deleted.json")!=-1}))}},dir:"restore2",files_sel:function(e){e.target.parentNode.querySelectorAll('span[name="FILES_ARCHIVE0"]')[0].style.display=0===pref.archive.files_sel?"":"none",e.target.parentNode.querySelectorAll('span[name="FILES_ARCHIVE1"]')[0].style.display=1===pref.archive.files_sel?"":"none",e.target.parentNode.querySelectorAll('span[name="FILES_ARCHIVE2"]')[0].style.display=2===pref.archive.files_sel?"":"none",2===pref.archive.files_sel&&this.queryList()},restore_button:function(e){0===pref.archive.files_sel&&this.restore2(e),2===pref.archive.files_sel?this.IDB_thread_sel(e):this.restore(e)},restore:function(e){var t=pref3.archive.jsons.files,n=pref3.archive.imgs.files;0===t.length||pref.archive.load_img&&0===n.length||this.restore2(null,Array.prototype.slice.call(n),t)},jsons:"restore",imgs:"restore",clear_files_button:function(){for(var e=[pref3.archive.jsons,pref3.archive.imgs],t=0;t<e.length;t++)if(e[t]&&e[t].parentNode){var n=e[t].parentNode.insertBefore(e[t].cloneNode(e[t]),e[t]);n.onchange=e[t].onchange,e[t].parentNode.removeChild(e[t]),n.onchange({target:e[t],currentTarget:e[t]})}},get pn_IDB_board_sel(){return pref_func.settings.pn13&&pref_func.settings.pn13.querySelector('select[name="archive.IDB_board_sel"]')},get pn_IDB_thread_sel(){return pref_func.settings.pn13&&pref_func.settings.pn13.querySelector('select[name="archive.IDB_thread_sel"]')},IDB_select_multiple:function(){this.pn_IDB_board_sel.multiple=pref.archive.IDB_select_multiple,this.pn_IDB_thread_sel.multiple=pref.archive.IDB_select_multiple},queryQuota:function(){navigator.webkitTemporaryStorage&&navigator.webkitTemporaryStorage.queryUsageAndQuota(this.showQuota.bind(this))},showQuota:function(e,t){var n=pref_func.settings.pn13.querySelector('span[name="SHOW_QUOTA"]');n&&(n.textContent=e.toLocaleString()+" / "+t.toLocaleString()+" ("+(100*e/t).toString().slice(0,5)+"%)")},queryList:function(){pref.test_mode[65]||pref4.archive.IDB_board_sel_options||(brwsr.ff?setTimeout(function(){this.showList({target:{result:Object.keys(liveTag.mems[site.nickname])}})}.bind(this),0):window.indexedDB.webkitGetDatabaseNames().onsuccess=this.showList.bind(this))},showList:function(e){if(e){for(var t=e.target.result,n=["Select board"],r=0;r<t.length;r++)n[n.length]=t[r].replace(/^[^\/]*/,"");n[n.length]="ALL ("+t.length+")"}else n=null;pref4.archive.IDB_board_sel_options=n,pref_func.apply_prep(this.pn_IDB_board_sel,!1)},IDB_board_sel:function(){pref4.archive.IDB_thread_sel_options=null;var e=this.pn_IDB_thread_sel;pref_func.apply_prep(e,!1),e.style.display="";for(var t=this.IDB_selected_boards(),n=0;n<t.length;n++)IDB.req(site.nickname,t[n],null,null,this.showThreadList_fromIDB.bind(this),"list_os")},IDB_selected_boards:function(){return 0===pref.archive.IDB_board_sel?[]:pref4.archive.IDB_board_sel_options&&pref.archive.IDB_board_sel===pref4.archive.IDB_board_sel_options.length-1?pref4.archive.IDB_board_sel_options.slice(1,-1):Array.prototype.slice.call(this.pn_IDB_board_sel.options).filter(function(e){return e.selected}).map(function(e){return e.textContent})},showThreadList_fromIDB:function(e,t,n){1==this.IDB_selected_boards().length&&(t="");for(var r=pref4.archive.IDB_thread_sel_options||["ALL"],a=0;a<n.length;a++)r[r.length]=t+n[a];r[0]=" ",r.sort(),r[0]="ALL ("+(r.length-1)+")",pref4.archive.IDB_thread_sel_options=r,pref_func.apply_prep(this.pn_IDB_thread_sel,!1)},IDB_thread_sel:function(e){cataLog.threads&&(pref.archive.restore_auto||"archive.restore_button"===e.target.name)&&(pref.archive.clear_threads&&cataLog.threads&&cataLog.catalog_clear_threads(0),this["IDB.selected_threads"](IDB.req,null,this.restore3.bind(this),"get_all"))},"IDB.selected_threads":function(e,t,n,r){var a=0===pref.archive.IDB_thread_sel?pref4.archive.IDB_thread_sel_options.slice(1):Array.prototype.slice.call(this.pn_IDB_thread_sel.options).filter(function(e){return e.selected}).map(function(e){return e.textContent}),s=this.IDB_selected_boards(),o=1===s.length?s[0]:"";if(!e){for(var i={domain:site.nickname,boards:s},l=0;l<a.length;l++)a[l]={board:o||a[l].replace(/[^\/]*$/,""),no:a[l].replace(/\/[^\/]*\//,""),__proto__:i};return a}for(var l=0;l<a.length;l++)e(site.nickname,o||a[l].replace(/[^\/]*$/,""),a[l].replace(/\/[^\/]*\//,""),t,n,r)},restore3:function(e,t,n,r,a){var s=this.consolidate_IDB_result(r,e);if(s.posts.length>0){var o=archiver.restore({name:(site.nickname+t+n).replace(/\//,"-")},site2[e].parse_funcs.thread_json.prep_to_archive(s.posts),s.tn,!0,a);if(s.posts_deleted.length>0){pref.test_mode[80]&&(t=t.slice(0,-1)+"_IDB/");var i=liveTag.mems.init({domain:e,board:t,no:n});archiver.prep_deleted_posts(o,i,!0,s.posts_deleted,a)}}},consolidate_IDB_result:function(e,t){for(var n=[],r=[],a={},s=Object.create(a),o=Object.keys(e),i=0;i<o.length;i++)if(0===o[i].indexOf("posts_deleted"))r=r.concat(e[o[i]]);else if(0===o[i].indexOf("posts"))n=n.concat(e[o[i]]);else{if("pruned_time"===o[i])continue;var l=o[i].replace(/[^\.]*./,""),c="webm"===l?"video/webm":"image",p={type:c,file:e[o[i]]};0===o[i].indexOf("tn_")?s[o[i].substr(3)]=p:a[o[i].substr(4)]=p}for(var i=0;i<n.length-1&&n[i].no<n[i+1].no;)i++;if(i!==n.length-1)for(n.sort(this.consolidate_IDB_sort_func),i=0;i<n.length-1;){if(n[i].no===n[i+1].no){for(var _=i+2;_<n.length&&n[i].no===n[_].no;)_++;if("meguca"===t){for(var d=n[i].editing,u=i+1;u<_&&n[u].editing==d;)u++;if(u<_)for(u=_;--u>i;)n[u].editing&&(n.splice(u,1),_--)}for(;--_>i;)n.splice(_,1)}i++}_=0;for(var i=0;i<r.length;i++){for(;_<n.length&&n[_].no<r[i].no;)_++;_<n.length&&n[_].no===r[i].no&&n.splice(_,1)}var f=t&&site2[t].parse_funcs.thread_json.consolidate_IDB_result_sub;return f&&0!==n.length&&f(n),{posts:n,posts_deleted:r,img:a,tn:s}},consolidate_IDB_sort_func:function(e,t){return e.no!==t.no?e.no-t.no:e.com<t.com?-1:1},"IDB.delete_board":function(){for(var e=this.IDB_selected_boards(),t=0;t<e.length;t++)window.indexedDB.deleteDatabase(pref.script_prefix+"."+e[t])
;var n=this.pn_IDB_thread_sel;n&&(n.style.display="none"),this.showList(null),this.queryList()},"IDB.delete_thread":function(){this["IDB.selected_threads"](IDB.req,null,null,"delete_th"),this.IDB_board_sel(null)},"IDB.delete_imgs":function(){this["IDB.selected_threads"](IDB.req,IDBKeyRange.bound("img_","img`",!1,!0),null,"delete")},"IDB.export_thread":function(){for(var e=this["IDB.selected_threads"](),t="CatChan_IDB_"+e[0].domain+"-"+(1==e[0].boards.length?e[0].board.slice(1,-1):e[0].boards.length)+"-"+(1===e.length?e[0].no:e.length)+".tar",n="IDB_extract_"+Date.now(),r=function(r){var a=e.length;return function(e,s,o,i){r.export_thread(e,s,o,i,n),0==--a&&archiver.tar.flush(n,t)}}(this),a=0;a<e.length;a++)IDB.req(e[a].domain,e[a].board,e[a].no,null,r,"get_all")},export_thread:function(e,t,n,r,a,s){for(var o=this.consolidate_IDB_result(r,e),i=Object.keys(o),l=0;l<i.length;l++)for(var c=Array.isArray(o[i[l]])?["dummy"]:Object.keys(o[i[l]]),p=0;p<c.length;p++){var _=0===i[l].indexOf("posts");if(!_||0!==o[i[l]].length){var d=_?new Blob([JSON.stringify(site2[e].parse_funcs.thread_json.prep_to_archive(o[i[l]]))],{type:"text/plain"}):o[i[l]][c[p]].file,u=_?e+"-"+t.slice(1,-1)+"-"+n+i[l].substr(5)+".json":i[l]+"_"+c[p];archiver.tar.add_blob(d,{domain:e,board:t,no:n},u,a,!0)}}s&&archiver.tar.flush(a,s)},"IDB.reset_time":function(){this["IDB.selected_threads"](archiver.clean_list)},start:function(e){archiver.store_entry("archive.start"===e.target.name?"ARC":"ARC1")},oneshot:"start","kwd.*":function(){pref.archive.kwd.rexps=common_func.kwd_prep_regexp(pref.archive.kwd)}},"test_mode.js_load":function(){var e=pref_func.settings.pn13.getElementsByTagName("input")["test_mode.js_file"].files[0],t=window.URL.createObjectURL(e),n=document.createElement("script");n.src=t,site.script_body.appendChild(n)},scanBoard:function(e){cataLog.event_func&&cataLog.event_func(e)},scanBoardIf:"scanBoard",scanSite:"scanBoard",scanSiteIf:"scanBoard",tighten_loosed_limits:function(e){pref4.search_posts_active_once=!1},"*w/.t2h_sel":function(e,t){cataLog.Footer&&pref.catalog.footer.use&&pref.catalog.footer.flag&&cataLog.Footer.update_all_force(e,t,!0)},"*w/.t2h_num_of_posts":"catalog.t2h_sel",debugWindow:function(){debugWindow=cnst.init3({func_str:"left:0px:top:0px:tb:width:400px:height:400px:overflow:auto:Show:bottom_top:tb_press:float"}),debugWindow.connect=function(){return debugWindow.cn.appendChild(document.createElement("div"))}}}},bind_myself:function(e,t){for(var n of t)e[n]=e[n].bind(e)},format_html_str:function(e){return e=e.replace(/<br>([0-9]),/g,function(e,t){for(var n="<br>",r=0;r<t;r++)n+="&emsp;";return n}),e=e.replace(/<TA"([\w.]+),(\d+),(\d+)"([^>]*)>/g,'<textarea style="height:1em" rows="$3" cols="$2" name="$1"$4></textarea>'),e=e.replace(/<IC"([\w.]+)"([^>]*)>(\w)?/g,function(e,t,n,r){return'<input type="checkbox" name="'+t+'"'+n+">"+(r?" "+r:"")}),e=e.replace(/<ITB(L)?(\d+)"([\w.]+)"([^>]*)>(\w)?/g,function(e,t,n,r,a,s){return'<input type="text"'+(t?"":' style="text-align: right;"')+' size="'+n+'" name="'+r+'"'+a+">"+(s?" "+s:"")}),e=e.replace(/<ICBX"/g,'<input type="checkbox" name="'),e=e.replace(/<IR"([\w\.]+),([^"]+)"([^>]*)>/g,'<input type="radio" name="$1" value="$2"$3>'),e=e.replace(/<SSV("[\w\.]+")>/g,'<span data-class="show_value" style="font-weight:bold" name=$1></span>'),e=e.replace(/<BTN"([\w.]+),([^"]+)"([^>]*)>/g,'<button type="button" name="$1"$3>$2</button>'),e=e.replace(/<BTN"([\w.]+)"([^>]*)>/g,function(e,t,n,r){return'<button type="button" name="'+t+'"'+n+">"+t.split(".").pop()+"</button>"}),e=e.replace(/<IF"/g,'<input type="file" name="'),e.replace(/<input type="(checkbox|radio)[^>]+>[^<]+/g,"<label>$&</label>")}}}(),pref_func.settings.oninput_funcs=pref_func.add_onchange_format(pref_func.settings.onchange_funcs.__proto__),pref_func.settings.onchange_funcs["tag.gen_str"]=pref_func.settings.onchange_funcs["tag.gen"],pref_func.bind_myself(pref_func.settings.oninput_funcs.__proto__,["SHOW","HIDE","SHOW2","HIDE2","SHOW3","HIDE3","TOGGLE2","SHOWALL","HIDEALL"]);var options={func0_prep:function(){},func0_exe:function(){}};common_func={__proto__:common_func,overwrite_prop:function(e,t){for(var n in t)void 0===t[n]&&e[n]?delete e[n]:"object"==typeof e[n]&&"object"==typeof t[n]?common_func.overwrite_prop(e[n],t[n]):e[n]=t[n]},name2domainboardthread:function(e,t){var n=e.substr(e.lastIndexOf("/")+1),r=e.substr(0,e.indexOf("/")),a=e.substr(r.length,e.length-n.length-r.length);return e===n&&n.search(/[^0-9]/)!=-1&&(r=n,n=""),t&&(""===r&&(r=site.nickname),""===a&&(a=site.board)),[r,a,n]},name2dbt:function(){var e={c:"catalog_html",j:"catalog_json",p:"page_html",q:"page_json",t:"thread_json"};return function(t){var n=this.name2domainboardthread(t,!0);return n[3]=e[n[2][0]],n[3]?n[2]=n[2].substr(1):n[3]="thread_html",n}}(),fullname2dbt:function(e){var t=e.substr(e.lastIndexOf("/")+1),n=e.substr(0,e.indexOf("/"));return[n,e.substr(n.length,e.length-t.length-n.length),t]},dom_addEventListener:function(e,t,n,r){t.addEventListener(n,r,!1),e[e.length]=[t,n,r]},dom_removeEventListener:function(e,t,n,r){for(var a=e.length-1;a>=0;a--)t&&t!==e[a][0]||n&&n!==e[a][1]||r&&r!==e[a][2]||(e[a][0].removeEventListener(e[a][1],e[a][2],!1),e.splice(a,1))},dom_addAttribute:function(e,t,n){var r=e.getAttribute(t);r&&(n=r+" "+n),e.setAttribute(t,n)},perf_out:function(e){e.push(performance.now());for(var t="",n=null,r=0;r<e.length;r++)"number"==typeof e[r]?(n&&(t+=e[r]-n+", "),n=e[r]):t+=e[r]+", ";console.log(t)},debug_show_proto_func_pool:null,debug_show_proto:function(e,t,n,r){r||(r="proto"),n||(n=["proto"]);for(var a=e+":",s=Object.keys(t),o=0;o<s.length;o++)n.indexOf(s[o])==-1&&(a+=s[o]+",",n.push(s[o]),this.debug_show_proto_func_pool&&(this.debug_show_proto_func_pool[s[o]]=t[s[o]]));return t.hasOwnProperty(r)&&(a+="/"+this.debug_show_proto(t.__proto__[r],t.__proto__,n,r)),a},debug_parse_funcs_entry:function(e,t){if((t?pref.debug_mode.pfunc_comp_expand_same||pref.debug_mode.pfunc_comp_expand_diff:pref.debug_mode.pfunc_expand)&&(this.debug_show_proto_func_pool={}),console.log(this.debug_parse_funcs(e)),t){var n=this.debug_show_proto_func_pool;if(this.debug_show_proto_func_pool={},pref.debug_mode.pfunc_comp_proto){var r=t.split(":"),a=site2[r[0]].parse_funcs[r[1]],s=a.__proto__;r=pref.debug_mode.pfunc_comp_proto.split(":"),(r=site2[r[0]].parse_funcs[r[1]])&&(a.__proto__=r)}console.log(this.debug_parse_funcs(t));var o=this.debug_show_proto_func_pool}if(this.debug_show_proto_func_pool)if(t){for(var i in o){var l=n[i]===o[i];(pref.debug_mode.pfunc_comp_expand_same&&l||pref.debug_mode.pfunc_comp_expand_diff&&!l)&&(console.log(i+": "+(l?"same":"differ")+": "+n[i]),l||console.log(i+": "+(l?"same":"differ")+": "+o[i])),delete n[i]}for(var i in n)console.log(i+": only_in_original: "+n[i])}else for(var i in this.debug_show_proto_func_pool)console.log(i+": "+this.debug_show_proto_func_pool[i]);this.debug_show_proto_func_pool=null,s&&(a.__proto__=s)},debug_parse_funcs:function(e){for(var t in site2)for(var n in site2[t].parse_funcs)site2[t].hasOwnProperty("parse_funcs")&&site2[t].parse_funcs.hasOwnProperty(n)&&(site2[t].parse_funcs[n].debug____proto=t+"."+n);var r=e.split(":"),a=site2[r[0]].parse_funcs[r[1]];return e+"::"+(a?this.debug_show_proto("/"+a.debug____proto,a,["debug____proto","proto"],"debug____proto"):"NONE")},debug_parse_funcs_parse:function(e,t,n,r){for(var a=[t+"_template",t],s=0;s<2;s++)for(var o=this.debug_parse_funcs(e+":"+a[s]).split(","),i=0;i<o.length;i++){var l=o[i].lastIndexOf(":");if(o[i].substr(l+1)===n){o.splice(i+1,o.length-i-1);var c=o[i>0?i-1:i].replace(/[^\/]*\//g,"").replace(/:[^:]*$/,"").replace(/\./,":"),p=o[0].replace(/::.*/,"");return c!==p&&(o[o.length]=" (==="+c+")"),[o,c,a[s]]}l===-1?o.splice(i--,1):o[i]=o[i].substr(0,l+1)}return[o,c,a[s]]},debug_parse_funcs_all:function(e){for(var t=["DEFAULT","4chan","vichan","lain","8chan","KC","meguca","meguca1","meguca2","dist"],n=["","_json","_html"],r=["common","post","thread","page","catalog"],a={},s=0;s<t.length;s++)for(var o=0;o<n.length;o++)if("KC"!==t[s]||"_json"!==n[o])for(var i=0;i<r.length;i++)if(("DEFAULT"===t[s]||"common"!==r[i])&&site2[t[s]]){var l=r[i]+n[o];if(site2[t[s]].parse_funcs[l]){var c=this.debug_parse_funcs_parse(t[s],l,e),p=c[0],_=c[1];l=c[2];var d=site2[t[s]].parse_funcs[l];if(d){var u=d[e],f=!0;for(var h in a)if(a[h][0]===u){p[p.length]=" (==="+h+")",f=!1,a[h][1]++;break}f&&(a[_]=[u,1]),"string"!=typeof u&&"number"!=typeof u||(p[e.length]=", "+u)}console.log(p.join(""))}}var m=0;if(pref.debug_mode.pfunc_all_expand)for(var h in a)console.log(m+++"("+a[h][1]+"): "+h+": "+a[h][0])},debug_site2func:function(e){for(var t in site2)site2[t].hasOwnProperty(e)&&(site2[t]["debug____"+e]=t);var n="",r={};for(var t in site2)n+=t+": "+site2[t]["debug____"+e]+", ",r[site2[t]["debug____"+e]]=site2[t][e];if(console.log(n),pref.debug_mode.site2func_expand)for(var t in r)console.log(t+": "+r[t])},shallow_copy_1:function(e){var t=Object.create(null);for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t},deep_copy:function(e,t){for(var n in t)t.hasOwnProperty(n)&&(Array.isArray(t[n])?e[n]=t[n].slice():"object"==typeof t[n]?e[n]=this.deep_copy({},t[n]):e[n]=t[n]);return e},deep_copy2:function(e,t){for(var n in t)t.hasOwnProperty(n)&&(Array.isArray(t[n])?e[n]=t[n].slice():"object"==typeof t[n]?null===t[n]?e[n]=null:e[n]=this.deep_copy({},t[n]):e[n]=t[n]);return e},kwd_prep_regexp:function(e,t){if(!e.str)return null;for(var n=e.sentence?[e.str]:e.str.split(" "),r=n.length-1;r>=0;r--)if(""===n[r])n.splice(r,1);else{e.re||(n[r]=n[r].replace(/[\.\(\)\[\]\+\^\$\{\}]/g,"\\$&").replace(/\*/g,".*").replace(/\?/g,"."),t&&(n[r]="^"+n[r]+"$"));try{n[r]=new RegExp(n[r],e.ci?"i":"")}catch(e){n.splice(r,1)}}return 0===n.length?null:n},escape:function(){function e(e){return t[e]}var t={"<":"&lt;",">":"&gt;","&":"&amp;",'"':"&quot;","'":"&#039;"};return function(t){return t.replace(/[<>"'&]/g,e)}}(),escape_text:function(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;")},arraybuffer2blob:function(){var e={jpg:"image/jpeg",jpeg:"image/jpeg",gif:"image/gif",png:"image/png",pdf:"application/pdf",svg:"image/svg+xml",svgz:"image/svg+xml",htm:"text/html",html:"text/html",txt:"text/plain",webm:"video/webm",mpg:"video/mpeg",mpeg:"video/mpeg",mp4:"video/mp4",ogv:"video/ogg",mp3:"audio/mp3",gz:"application/x-gzip",tar:"application/x-tar",tgz:"application/x-tar",zip:"application/x-compress","7z":"application/x-7z-compressed",xz:"application/x-xz"};return function(t,n){var r=t.substr(t.lastIndexOf(".")+1),a=e[r]||"text/plain";return new Blob([n],{type:a})}}()};var common_obj={thread_reader:null,events_beforeunload:[]};common_func.dom_addEventListener(common_obj.events_beforeunload,window,"beforeunload",function(){common_func.dom_removeEventListener(common_obj.events_beforeunload)}),common_func.dom_addEventListener(common_obj.events_beforeunload,window,"focus",function(){DelayBuffer.prototype.hasFocus=!0}),common_func.dom_addEventListener(common_obj.events_beforeunload,window,"blur",function(){DelayBuffer.prototype.hasFocus=!1});var site={max_page:20,autosage:300,board_name:"/int/",url_prefix:"https://krautchan.net/int/",url_prefix2:{},nickname:"KC",nicknames:["CatChan_tgt"],thread_keyword:"thread",postform:null,postform_rules:null,get_ops:null,get_posts:null,server_name:null,protocol:document.location.href.search(/https/)!=-1?"https:":"http:",catalog_threads_in_page:null,remove_posts:function(e){return e},remove_files_info:function(e){return e},remove_checkboxes:function(e){return e},get_time_of_last_post:function(e){return null},header_height:function(){return 0},patch:null,components:{},get key(){return site.nickname+site.board+("thread"===site.whereami?site.no:"")},query_set_component:function(e){var t=site2[site.nickname].components[e],n="string"==typeof t?document.querySelector(t):document.querySelectorAll(t[0])[t[1]];n?site.components[e]=n:delete site.components[e]},config:function(e,t,n){var r=window.location.href,a=r.substr(0,r.indexOf(e)+e.length),s=decodeURI(r.substr(a.length+1))+"/";if(site.board="/"+s.substr(0,s.indexOf("/")+1),site.url_prefix=a+site.board,site.server_name=r.substr(0,r.indexOf(e)-1).replace(/https*:\/\/*/,""),site.nickname=t,void 0===site.no&&(site.no="thread"===site.whereami?site2[site.nickname].get_ops(document)[0]:""),!n){!site0.isStep&&site2[t].features&&pref_func.pref_overwrite(site.features,site2[t].features);for(var o in site2[site.nickname].components)site.query_set_component(o);!site.settings&&site.components.boardlist&&(site.settings=site.components.boardlist.appendChild(document.createElement("span")),site.components.boardlist2&&(site.settings3=site.components.boardlist2.appendChild(document.createElement("span")))),site.patch=site2[site.nickname].patch}},features:{page:!1,graph:!0,setting:!0,setting2:!0,postform:!0,catalog:!0,listener:!1,uip_tracker:!1,thread_reader:!0,debug:!1},owners_recommendation:"",catalog:!1,whereami:null,embed_to:{},root_body:document.getElementsByTagName("body")[0],embed_frame:"CatChan_embed_frame",embed_frame_win:null,boardlist:null,settings:null,__proto__:{get myself(){return Object.defineProperty(this,"myself",{value:site2[site.nickname].wrap_to_parse.get(document,site.nickname,site.board,"thread_html",{thread:site.no})[0],writable:!0,enumerable:!0,configurable:!0}),this.myself}}};site.protocol=document.location.href.search(/https/)!=-1?"https:":"http:",site.root_body2=site.root_body;var site2={};site2.DEFAULT={nickname:"DEFAULT",home:"",check_func:function(){return window.location.href.indexOf(this.domain_url)!=-1&&(site.whereami="other",site.config(this.domain_url,this.nickname),!0)},boards_sel_from_tags:function(){return""},protocol:site.protocol,components:{},spoiler_text:{spoiler:/span.spoiler$/,open:/span.spoiler:hover/},make_tack:function(){var e=document.createElement("i");return e.setAttribute("class","fa fa-thumb-tack"),e},make_showAlways:function(){var e=document.createElement("i");return e.setAttribute("class","fa"),e.textContent="★",e},set_icon:function(e,t,n,r,a){if(e){var s=r["icon_"+n]||"sticky"==n&&this.get_icon(e,t,n,r);if(a&&s)return r.systemSticky&&(s.style.opacity=null),s;if(a){if(!s)return this.add_icon(e,t,n,r)}else"sticky"==n&&r.systemSticky?(s||(r.icon_sticky=s=this.add_icon(e,t,n,r)),s.style.opacity="0.4"):s.parentNode&&s.parentNode.removeChild(s)}return null},postform:function(){function e(e){this.tack&&(this.tack.style.display="none"===this.tack.style.display?"":"none")}return{tack:null,init:function(){return site.postform&&(this.tack=site2[site.nickname].make_tack(),this.tack.setAttribute("style","float:right;font-size:2em"),site.postform.parentNode.insertBefore(this.tack,site.postform)),this.tack},on:e,off:e}}(),postform_prep:function(){site.components.postform_submit2=null,site.components.postform_submit2_observer=new MutationObserver(this.postform_submit2_find),site.components.postform_submit2_observer.observe(document.getElementsByTagName("body")[0],{childList:!0})},postform_submit2_find:function(){site.components.postform_submit2;site.query_set_component("postform_submit2"),site.query_set_component("postform_comment2"),common_obj.thread_reader&&common_obj.thread_reader.setup_submit2(),pref.features.recovery&&recovery.setup2()},general_event_handler:function(){var e={common:{subscribe:function(e){this.mouseover&&e.addEventListener("mouseover",this.mouseover,!1)},unsubscribe:function(e){this.mouseover&&e.removeEventListener("mouseover",this.mouseover,!1)},get_mark:function(e,t){return this.get_mark_from_height(t,document.getElementByTagName("div"))},get_mark_from_height:function(e,t){for(var n=t.length,r=n>>1,a=0;r>0;)t[a+r].offsetTop<e&&(a+=r),r>>=1;for(;a+1<n&&t[a+1].offsetTop<e;)a++;return t[a]},isThumbnail:function(e){var t=e.target;return"IMG"===t.tagName&&t.parentNode&&"A"===t.parentNode.tagName},recSearch_thread:function(e,t,n){for(n||(n="thread");e&&e!=t;){if(e.classList&&e.classList.contains(n))return e;e=e.parentNode}return null},getID:function(e){},getCountry:function(e){},getTrip:function(e){},getName:function(e){return e.classList.contains("name")&&e.textContent||void 0},an2srcNo:function(e,t){for(;e;){if(e.classList&&e.classList.contains("post"))return site2[t.domain_html].parse_funcs.post_html.no({pn:e});if(gGEH.pns_all_keys.get(e))return site2[t.domain_html].parse_funcs.catalog_html.no({pn:e});e=e.parentNode}}}};return e.thread=Object.create(e.common),e.page=Object.create(e.common),e.catalog=Object.create(e.common),e}(),horizontal_separator_in_index:function(){var e=document.createElement("hr");return e.setAttribute("class",pref.script_prefix+"_hs"),e},get_next_image:function(e,t,n){n||(n=cataLog.parent.getElementsByTagName("img"));var r=Array.prototype.indexOf.call(n,e);if(t)for(;n[r+1]&&n[r+1].offsetTop<t;)r++;return r>=0?n[r+1]:null},catalog_threads_in_page:function(e){return[]},remove_posts:function(e,t){},remove_files_info:function(e){return e},postform_rules:null,thread_keyword:"thread",max_page:function(e){return 10},generate_boards_json:function(e,t){for(var n={pages:t},r=[],a=0;a<e.length;a++)r[r.length]=Array.isArray(e[a])?{board:e[a][0],pages:e[a][1],__proto__:n}:{board:e[a],__proto__:n};return{boards:r}},url_boards_json:function(){return""},get_boards_json:function(e,t,n,r){var e="boards_json_"+this.nickname;this.boards_json?this.get_boards_json_callback(this.nickname,{status:200,response:this.boards_json},[t,n]):httpd.req({initiator:e,INDICATOR:r?{shift:function(){},report:function(){}}:null,IDX:0,FINISHED:0,SUC:0,max:1,tgts:[{domain:this.nickname,url:this.url_boards_json()[0],responseType:"json",data_type:"json"}],callback_1:function(r,a){this.get_boards_json_callback(e,a,[t,n,!0])}.bind(this)},6)},get_boards_json_callback:function(e,t,n){200==t.status&&(this.postprocess_board(t.response),site3[this.nickname].boards||(liveTag.update_pn_buf.cancel(),liveTag.update_pn_buf.do_tgt()),site3[this.nickname].boards="8chan"!==site.nickname||"boards"!==site.whereami||t.response),n[0]&&(n[1]||200===t.status)&&(n[2]?n[0]():setTimeout(n[0],0))},postprocess_board:function(e){for(var t=0;t<e.boards.length;t++){var n=liveTag.mems.init({domain:this.nickname,board:"/"+e.boards[t].board+"/"});n.o=t,e.boards[t].pages&&!n.pgs&&(n.pgs=e.boards[t].pages),e.boards[t].tags&&0!=e.boards[t].tags.length&&liveTag.postprocess_board_add_btag(e.boards[t].tags,n)}},boardlist_boards:Object.create(null,{sel:{value:null,writable:!0}}),show_boardlist_physical_board:function(e,t){var n=this.boardlist_boards;if(n.sel===!0&&"replace"===pref.virtualBoard.p_board||n.sel===!1&&"both"===pref.virtualBoard.p_board){var r=n.sel?"v":"p",a=n.sel?"p":"v";for(var s in n){var o=n[s];o[r]&&o[a]&&(o[a].parentNode.insertBefore(o[r],o[a]),o[a].parentNode.removeChild(o[a]))}n.sel=!n.sel}if(null===this.boardlist_boards.sel&&"replace"===pref.virtualBoard.p_board){for(var i=site.components.boardlist.getElementsByTagName("a"),s=0;s<i.length;s++){var l=i[s].textContent;this.show_boardlist_physical_extract_func&&(l=this.show_boardlist_physical_extract_func(l)),"#"!==l[0]&&(this.boardlist_boards["#"+(pref.liveTag.ci?l.toLowerCase():l)]={p:i[s]})}this.boardlist_boards.sel=!1}if("replace"===pref.virtualBoard.p_board){for(var c={},s=e.length-1;s>=0;s--){var l=pref.liveTag.ci?e[s].toLowerCase():e[s],o=this.boardlist_boards[l];if(o){if(!o.v){var p=o.p,_=liveTag.create_tag_node_1(l,t,"a");_.setAttribute("href",p.getAttribute("href")),p.parentNode.insertBefore(_,p),p.parentNode.removeChild(p),o.v=_}e.splice(s,1),c[l]=null}}if(pref.virtualBoard.v_remove)for(var s in this.boardlist_boards)if(this.boardlist_boards[s].v&&void 0===c[s]){var p=this.boardlist_boards[s].p,_=this.boardlist_boards[s].v;_.parentNode.insertBefore(p,_),_.parentNode.removeChild(_),delete this.boardlist_boards[s].v}}return e},boardlist_tags:null,boardlist_tags_pn:null,show_boardlist:function(e,t){var n=site.components.boardlist,r=this.show_boardlist_physical_board(e.slice(),t);if(pref.virtualBoard.show&&0!==r.length){var a=pref.test_mode[118]?liveTag.create_tag_nodes(r," / ",t):liveTag.update_tag_nodes(r," / ",t,this.boardlist_tags_pn,this.boardlist_tags);if(this.boardlist_tags_pn)pref.test_mode[118]&&this.boardlist_tags_pn.parentNode.replaceChild(a,this.boardlist_tags_pn);else{var s=document.createElement("span");s.appendChild(document.createTextNode("[ ")),s.appendChild(a),s.appendChild(document.createTextNode(" ]")),n.appendChild(s)}this.boardlist_tags_pn=a,this.boardlist_tags=r}else this.boardlist_tags_pn&&(n.removeChild(this.boardlist_tags_pn.parentNode),this.boardlist_tags_pn=null,this.boardlist_tags=null)},query_tag_node:function(e){var t=this.boardlist_boards[e];if(t)return t.v;if(this.boardlist_tags_pn){var n=this.boardlist_tags.indexOf(e);if(n>=0)return this.boardlist_tags_pn.childNodes[2*n]}},get_ops:function(e){return[]},get_posts:function(e){return[]},absolute_link:function(e){for(var t=this.protocol+"//"+this.domain_url,n=["src","href"],r=e.getElementsByTagName("*"),a=0;a<r.length;a++)for(var s=0;s<n.length;s++){var o=r[a].getAttribute(n[s]);o&&0!=o.indexOf("http")&&0!=o.indexOf("mailto:")&&0!=o.indexOf("blob")&&"//"!=o.substr(0,2)&&r[a].setAttribute(n[s],t+o)}},absolute_link_1:function(e){return site2[this.nickname].protocol+"//"+site2[this.nickname].domain_url+e},link_dbtp2href_abs:function(e,t){var n=e[0];return(n!=site.nickname?site2[n].protocol+"//"+site2[n].domain_url:"")+site2[n].link_dbtp2href(e,t)},ls_key_own_posts:pref.script_prefix+".own_posts.",prep_own_posts_event:function(e){e&&site2[site.nickname].prep_own_posts_1(e.key),window.name===site.nickname&&send_message("parent",["OWN_POSTS",window.name,site3[window.name].own_posts])},prep_own_posts:function(e){if(site3[this.nickname].own_posts={},localStorage)for(var t=e?[this.ls_key_own_posts+e]:Object.keys(localStorage),n=0;n<t.length;n++)this.prep_own_posts_1(t[n])},prep_own_posts_1:function(e){if(0==e.indexOf(this.ls_key_own_posts)){var t=e.substr(this.ls_key_own_posts.length),n=t.substr(0,t.lastIndexOf("/")+1);site3[this.nickname].own_posts[n]||(site3[this.nickname].own_posts[n]={});for(var r=JSON.parse(localStorage[e]||"[]"),a=0;a<r.length;a++)site3[this.nickname].own_posts[n][r[a]]=null}},clean_up_LS:function(e,t,n){e===site.nickname&&localStorage&&(pref.thread_reader.own_posts_tracker&&pref.thread_reader.clean_up_own_posts&&this.clean_up_LS_th(this.ls_key_own_posts,t,n),pref[cataLog.embed_mode].deleted_posts.auto_clean&&this.clean_up_LS_th(this.ls_key_deletedPosts,t,n),pref.recovery.auto_clean&&(this.clean_up_LS_th(this.ls_key_comment,t,n),this.clean_up_LS_th(pref.script_prefix+".comment."+site.nickname,t,n)))},ls_key_deletedPosts:pref.script_prefix+".deletedPosts.",clean_up_deleted_posts_1:function(e){localStorage&&delete localStorage[this.ls_key_deletedPosts+e]},ls_key_comment:pref.script_prefix+".draft.",clean_up_LS_th:function(e,t,n){for(var r=e+t,a=Object.keys(localStorage),s=0;s<a.length;s++)0==a[s].indexOf(r)&&void 0===n[a[s].substr(r.length)]&&delete localStorage[a[s]]},check_reply:function(){function e(e,t){for(var n=e.pn.getElementsByTagName("a"),r=0;r<n.length;r++){var a=!1,i=n[r].textContent;if(s&&null===s[i.substr(2)]&&f.test(i)&&(a=!0),!a&&o&&m.test(i)){var l=i.split("/"),c="/"+l[1]+"/";o[c]&&null===o[c][l[2]]&&(a=!0)}a&&("plain"===pref.thread_reader.show_reply_to_me_by?n[r].parentNode.insertBefore(document.createTextNode(" (You)"),n[r].nextSibling):n[r].textContent=n[r].textContent+" (You)")}if(t&&s&&null===s[e.no]){var p=e.parse_funcs_html.pn_name(e);"plain"===pref.thread_reader.show_own_post_by?p.parentNode.insertBefore(document.createTextNode(" (You)"),p.nextSibling):p.innerHTML=p.innerHTML+" (You)"}}function t(e,t,r,a){var i=s&&e.no in s;if(i&&(e.reply_of_mine=!0),!i||!pref.catalog_footer_ignore_my_own_posts){var l=c?e.com:e.body;if(l){var p=!1;if(s){var f=l.match(_);if(null!==f)for(var h=0;h<f.length;h++){var m=f[h].substr(d);if(null===s[m]){p=!0;break}}}if(!p&&o&&null!==(f=l.match(u)))for(var h=0;h<f.length;h++){var m=f[h].split("/"),g="/"+m[1]+"/";if(o[g]&&null===o[g][m[2]]){p=!0;break}}p&&(e.reply_to_me=!0,t[1]+=65536)}t[1]++}a[a.length]=e,r&&n(e,r)}function n(e,t){if(c){var n=e.com;if(!n)return;n=n.replace(/<[^>]*>|&[^;]*;/g," "),pref.test_mode[47]&&(p.innerHTML=n,n=p[brwsr.innerText])}else{if(e.editing)return void(t[t.length]=e);if(!(n=e.body||e.txt))return}if(n.indexOf("#")!==-1){if(l)for(var r=0;r<l.length;r++)n=n.replace(l[r],"\n");var a=n.match(liveTag.scan_regex);if(null!==a)for(var r=0;r<a.length;r++)if(a[r].length<=pref.liveTag.maxstr){if(i){for(var s=i.length-1;s>=0&&!i[s].test(a[r]);s--);if(s>=0)continue}t[t.length]=a[r]}}}function r(e){"txt"===e.parse_funcs.type_com?(_=h,d=2,u=g,c=!1):(_=b,d=8,u=v,c=!0)}function a(e){pref.liveTag.ex_list?(i=pref_func.merge_obj5a(e,pref.liveTag.ex_list_obj5,null),l=pref_func.merge_obj5a(e,pref.liveTag.rm_list_obj5,null)):(i=null,l=null)}var s,o,i,l,c=!1,p=document.createElement("div"),_="",d=0,u="",f=/^>>[0-9]+/,h=/>>[0-9]+/g,m=/^>>>\/[0-9A-z_\+]+\/[0-9]+/,g=/>>>\/[0-9A-z_\+]+\/[0-9]+/g,b=/&gt;&gt;[0-9]+/g,v=/&gt;&gt;&gt;\/[0-9A-z_\+]+\/[0-9]+/g,y=!0;return{remake_own_posts:function(){y=!0},make_own_posts:function(){site2[site.nickname].prep_own_posts(),y=!1},add_you:e,set_own_posts:function(e){o=site3[e.domain].own_posts,s=o[e.board]||o.ALL,0==Object.keys(o).length&&(o=void 0)},check_t1_op:function(e){r(e),a(e);var t=[];return n(e,t),t},get_checked_time:function(e){return e[2]},set_watch_time:function(e,t,n){t>0&&(e[0]|=262144,8388608&e[0]?e[2]=t:(this.time_watch[n]=t,e[0]&=4286578687))},set_watched_to_last:function(e,t,n,r){!(8388608&e[0])&&524288&e[0]||this.set_watch_time(e,t,n),e[1]=r||0},set_unwatch:function(e){e[0]&=4285792255,e[1]=0},time_watch:{},check:function(e,s,o,i){var l=131072&s[0],c=s[2],p=!1,_=s[2];262144&s[0]&&(8388608&s[0]?(c=0,s[2]=0):(_=this.time_watch[e.key],delete this.time_watch[e.key]),s[1]=0,s[0]=(4286251008&s[0]|524288)+(e.omitted_posts?e.omitted_posts+1:0),p=!0);var d=c,u=e.posts.length-1;if(u>=0){s[2]=e.posts[u].time*e.parse_funcs.time_unit||s[2],1!=e.parse_funcs.time_unit&&(c=Math.floor(c/e.parse_funcs.time_unit),_=p?Math.floor(_/e.parse_funcs.time_unit):c);var f="post"===pref.liveTag.from?[]:null;f&&a(e);var h=liveTag.generate_ur(s[1]),m=786432&s[0];if((m||f)&&r(e),m)for(y&&this.make_own_posts(),liveTag.mems[e.domain][e.board].nr=-1,r(e),this.set_own_posts(e);u>=0&&e.posts[u].time>_;)t(e.posts[u--],s,f,i);if(f)for(;u>0&&(l||e.posts[u].time>c);)n(e.posts[u--],f);if(!common_obj.thread_reader)if(f&&0!=f.length)var g=liveTag.extract_tags(e,f,null,!l);else if(pref.liveTag.style.use&&m){var b=liveTag.generate_ur(s[1]);h!=b&&liveTag.update_ur(e.key,b,0!=h&&p)}if(pref3.stats.use&&stats&&stats.aggregate(e),_!==c||!m){for(u=e.posts.length;u>0&&e.posts[u-1].time>c;)u--;var v=e.posts.slice(u)}}return s[0]=(4294508544&s[0])+e.nof_posts,o&&786432&s[0]&&(0!=i.length&&pref.notify.desktop.notify&&site2[e.domain].wrap_to_parse.posts({posts:i,__proto__:e}),notifier.changed(e,i)),{tags:g,posts:v||i,time_check_old:d}}}}(),get_post_offsetTop:function(e,t){},favicon:{get_favicon:function(){for(var e=document.getElementsByTagName("head")[0].getElementsByTagName("link"),t=0;t<e.length;t++)if("shortcut icon"==e[t].getAttribute("rel"))return e[t];var n=document.createElement("link");return n.setAttribute("rel","shortcut icon"),n.setAttribute("href",this.none),n.setAttribute("type","image/x-icon"),document.getElementsByTagName("head")[0].appendChild(n)},get_title:function(){var e=document.getElementsByTagName("head")[0].getElementsByTagName("title")[0];return e||(e=document.createElement("title"),e=document.getElementsByTagName("head")[0].appendChild(e)),e}},get_icon:function(){},add_icon:function(){},time_revised_check:function(e){return!1},format_thread_layout:function(e){},format_thread_style:function(e){},format_thread_contents:function(e){},format_thread_always:function(e){},format_remove_tn_area_size:function(e){},mark_newer_posts2:function(e,t,n,r){t/=this.parse_funcs.post_json.time_unit;for(var a=null,s=e.length-1;s>=0;s--){var o=e[s].pn;if(t<e[s].time)o.setAttribute("style",pref.style.post_new),n&&o.addEventListener("mouseleave",this.unmark_post_from_event,!1),a=s;else{if(r)break;null!=o.getAttribute("style")&&o.removeAttribute("style")}}return a},format_pn:function(e,t,n,r,a){n||(n=pref[cataLog.embed_mode]),n.colorID&&this.colorID(e),n.backlink&&this.backlink(e,t,a),n.localtime&&this.localtime(e),r&&(site2.DEFAULT.check_reply.add_you(r,!0),r.deleted_after&&e.classList.add("CatChan_deleted"),void 0!==r.search_result&&site2[r.domain_html].update_posts0_class(e,r.search_result))},colorID:function(){},localtime:function(){},unmark_post_from_event:function(e){e.currentTarget.removeEventListener("mouseleave",site2.common.unmark_post_from_event,!1),site2.DEFAULT.unmark_post(e.target)},unmark_post:function(e){e.removeAttribute("style")},modify_thread_link:function(e){return[]},preprocess_html:function(e){return e},preprocess_doc:null,check_thread_archived:function(e){return!1},get_owners_recommendation:function(){return""},get_board_tags:function(){return{}},get_json_url_catalog:function(e){return""},parse_json_thread:function(e,t){},uip_tgt_post:function(e){return null},uip_post_num:function(e){return null},uip_check:function(e){},catalog_native_prep:function(e){return[]},catalog_native_prep_sel:function(e,t,n){if(n){if(0!=n.selectedIndex){n.selectedIndex=0;var r=document.createEvent("UIEvents");r.initUIEvent("change",!1,!0,window,1),n.dispatchEvent(r)}n.style.display="none"}var a=e.getElementsByTagName("select")["catalog.order.ordering"];a.parentNode.removeChild(a.nextSibling),"catalog"===site.whereami?n.parentNode.insertBefore(a,n):t.childNodes[3].insertBefore(a,t.childNodes[3].firstChild)},catalog_native_prep_swap_sortSel:function(e){e.parentNode.insertBefore(cataLog.components.ordering,e.nextSibling),e.setAttribute("style","display:none")},catalog_frame_prep:function(e){},catalog_native_frame_prep:function(e){function t(){a?(site.root_body.removeChild(n),n=null,site.embed_frame_win=null,site2.common.disgorge_children(r)):(r=site2.common.absorb_children(site.root_body),r.style.width=pref.catalog_size_frame0_width+"%",r.style.float="left",r.style.height=window.innerHeight+"px",r.style.overflow="scroll",n=site2[site.nickname].catalog_native_frame_prep_frame(site.root_body,null)),a=!a}var n,r,a=!1;e.addEventListener("click",t,!1)},catalog_native_frame_prep_frame:function(e,t){return ifrm=document.createElement("iframe"),ifrm.setAttribute("name",site.embed_frame),ifrm.style.height=window.innerHeight+"px",ifrm.style.margin="0px",ifrm.style.width=pref.catalog_size_frame1_width+"%",e.insertBefore(ifrm,t),site.embed_frame_win=ifrm.contentWindow,ifrm},catalog_embed_prep:function(e){e.style.position=null,e.childNodes[1].style.width=null,e.childNodes[1].style.height=window.innerHeight+"px",e.childNodes[0].childNodes[0].style.display="none",e.childNodes[0].childNodes[1].style.display="none",e.style.border=null,e.style.left=null,e.style.resize=null,e.style.top=null},thread2search_obj:function(e){return[e[brwsr.innerText],"","","","","","",""]},popups_posts:function(){function e(){function e(e,n,r,a){"imm"===e.popdown?r(n):(a||(a=n.target),e.popup_mMove&&a.addEventListener("mousemove",t,!1),s=r,o=e,i=a,t(n,!0))}function t(e,t){(r||t)&&(r&&clearTimeout(r),r=setTimeout(n,o.popup_delay),a=e)}function n(e){e&&clearTimeout(r),r=null,o.popup_mMove&&i.removeEventListener("mousemove",t,!1),e||s(a)}var r=null,a=null,s=null,o=null,i=null;return{over:e,stop:function(){return!!r&&(n(!0),!0)},get up_timer(){return r},out:function(e){return e.relatedTarget===h?(h=null,e.relatedTarget):this.stop()}}}function t(e,t){var r=f.get(e);if(r)if(Array.isArray(r))for(var a=0;a<r.length;a++)r[a]&&r[a]!==t&&n(r[a]);else r!==t&&n(r)}function n(e){var t=f.get(e),n=t.pf&&t.pf()||pref.proto;"imm"===n.popdown?a(e):t.timer=setTimeout(a.bind(null,e),n.popdown_delay)}function r(e,t,n,r){f.set(e,r||t),f.set(t,n||{src:e}),t.addEventListener("mouseenter",s,!1),t.addEventListener("mousedown",cnst.div_mousedown,!1)}function a(e,t){
if(e&&e.parentNode){t||e.parentNode.removeChild(e);var n=f.get(e);n.key&&k.pop_load_req_delete(n.key,e),n.chart&&!t&&n.chart.destroy(),n.scroll&&e.removeEventListener(brwsr.mousewheel,cnst.div_scroll,!1);var r=n.src,a=f.get(r);if(Array.isArray(a)){a[a.indexOf(e)]=null;for(var i=0;i<a.length&&!a[i];i++);i==a.length&&f.delete(r)}else f.delete(r);if(f.delete(e),e.removeEventListener("mouseenter",s,!1),e.removeEventListener("mousedown",cnst.div_mousedown,!1),t)return e.removeEventListener("mouseleave",o,!1),n}}function s(e){var t=e.currentTarget,n=f.get(t);"imm"===(n.pf&&n.pf()||pref.proto).popdown?a(t):(n.timer&&i(n),h=e.relatedTarget,t.addEventListener("mouseleave",o,!1))}function o(e){var t=e.currentTarget;t.removeEventListener("mouseleave",o,!1),n(t)}function i(e){clearTimeout(e.timer),e.timer=null}function l(e,t,n,r,a){var s=n?"left"===m?.75:.25:.5,o=n?"top"===g?.8:.2:.5;b=document.documentElement.clientWidth,v=document.documentElement.clientHeight,b*s-t.clientX>0^r?(e.style.left=t.clientX+10+"px",m="left"):(e.style.right=b-t.clientX+10+"px",m="right"),v*o-t.clientY>0^a?(e.style.top=t.clientY+10+"px",g="top"):(e.style.bottom=v-t.clientY+10+"px",g="bottom")}function c(e,t){var n=e.style,r=parseInt(n.top?n.top:n.bottom,10);if(!(e.offsetHeight+r<v)&&r>.5*v){var a=v-e.offsetHeight,s=(a<0?0:a)+"px";n.top?(n.top=s,g="bottom"):(n.bottom=s,g="top")}var o=parseInt(n.left?n.left:n.right,10);if(!(e.offsetWidth+o<b)&&o>.5*b){var s=b-parseInt(n.left?n.left:n.right,10)+20+"px";n.left?(n.right=s,n.left=null):(n.left=s,n.right=null)}}function p(e){if("/"===e[0]||"#"===e[0])return site.nickname;for(var t in liveTag.mems)if(e.indexOf(site2[t].domain_url)!=-1)return site2[t].nickname;for(var t in site2)if(e.indexOf(site2[t].domain_url)!=-1)return site2[t].nickname_href2domain||site2[t].nickname}function _(e,t){d(e);var n=e.target,r=pref[cataLog.embed_mode];r.popup&&"A"===n.tagName&&site2.DEFAULT.popups_link_regex.test(n.textContent)?k.over(e,t):r.image_hover&&u.isThumbnail(e)?w.over(r.thumbnail.hover,e,cataLog.DIH.image_hover_add):r.popupX.use&&w.over(r.popupX,e,T.X)}function d(e){if(cataLog.DIH.image_hover_remove(),!w.out(e)){var n=e.relatedTarget;n&&("A"===n.tagName||T.et)&&t(n),T.et=null}}var u,f=new Map,h=null,m="left",g="top",b=0,v=0,y=new WeakSet,w=e(),k=function(){function e(e,n){if(!pref.proto.popup_hlt||!b(e)){w.force=n,w.over(pref.proto,e,t);p(e.target.getAttribute("href"))!==site.nickname&&e.stopPropagation()}}function t(e){var t=w.force,r=e.target;if(f.has(r))return void i(f.get(f.get(r)));var a=p(r.getAttribute("href"));if(!t&&pref[cataLog.embed_mode].env.popup_native)if(pref[cataLog.embed_mode].env.event_dynamic&&!pref.test_mode[100]){if(site.nickname===a)return}else if(y.has(r))return;n(e,a)}function n(e,t){var n=C(e,t);return n&&(N(e,n.pn),r(e.target,n.pn,n.key?{src:e.target,key:n.key}:null)),n.pn}function s(e,t){var n=p(e.target.getAttribute("href"));if(e.shiftKey||"jump"===pref[t.mode].inline_post){var r=t.jump_to_post(site2[n].popups_href2th_q(e.target.getAttribute("href"))[2]);r&&(r.classList.add(site2[site.nickname].popups_posts_class_hlt),r.addEventListener("mouseleave",_,!1))}else o(e,n)}function o(e,t){var n=e.target,r=I.get(n);if(r)r.parentNode.removeChild(r),I.delete(n);else{var a=C(e,t);a&&(n.parentNode.insertBefore(a.pn,n.nextElementSibling),I.set(n,a.pn))}}function _(e){e.currentTarget.removeEventListener("mouseleave",_,!1),e.currentTarget.classList.remove(site2[site.nickname].popups_posts_class_hlt)}function h(e,t){var r=A.get(e);if(r){for(var s=r.length-1;s>=0;s--){var i=r[s],l=f.get(i.target);if(l){a(l);n(i,t)}I.get(i.target)&&(o(i,t),o(i,t))}A.delete(e)}}function m(e,t,n){var r={target:e.target,clientX:e.clientX,clientY:e.clientY,pn:n},a=A.get(t);a?a.unshift(r):A.set(t,[r])}function g(e,t){var n=A.get(e);if(n){for(var r=n.length-1;r>=0;r--)n[r].pn===t&&n.splice(r,1);0===n.length&&A.delete(e)}}function b(e){var t=e.target.getAttribute("href"),n=p(t),r=site2[n].popups_href2th_q(t),a=r[1],s=cataLog.threads[r[0].key],o=s&&s[16]&&s[16].posts;if(o){for(var i=o.length-1;i>=0&&o[i].no!==a;i--);var l=i>=0?o[i].pn:void 0;if(l&&"none"!==window.getComputedStyle(l).display){var c=l.offsetTop,_=brwsr.document_body.scrollTop;if(c>_&&c+l.offsetHeight<_+document.documentElement.clientHeight)return l.classList.add(site2[site.nickname].popups_posts_class_hlt),e.target.addEventListener("mouseout",v,!1),f.set(e.target,l),k(l,e,{domain_html:pref.catalog.mimic_base_site?site.nickname:n}),!0}}return!1}function v(e){var t=e.target;t.removeEventListener("mouseout",v,!1),f.get(t).classList.remove(site2[site.nickname].popups_posts_class_hlt),f.delete(t),B&&(B.classList.remove("dotted"),B=null)}function k(e,t,n){if(!pref.test_mode[108]){var r=site2[n.domain_html].post_pn2ce(e),a=r?r.getElementsByTagName("a"):void 0;if(a&&a.length>1){var s=u.an2srcNo(t.target,n);if(s){for(var o=0;o<a.length&&site2[n.domain_html].popups_href2dbtp(a[o].getAttribute("href"))[3]!=s;o++);o!=a.length&&(a[o].classList.add("dotted"),B=a[o])}}}}function x(e,t,n,r){site2[e.domain].wrap_to_parse.posts({posts:[r],__proto__:e}),cataLog.format_html.prepare_html_post(e,r,t.q)}function T(e,t,n){if(e.ta)for(var r=e.ta.posts.length-1;r>=0;r--)if(e.ta.posts[r].no==t){var a=e.ta.posts[r],n={domain_html:n.domain_html,lth:e,type_data:a.type_data||(a.pn?"html":"json"),posts:[a],__proto__:e};return void x(n,e,t,a)}}function C(e,t){var n=site2[t].popups_href2th_q(e.target.getAttribute("href"));if(n){var r,a=n[2],s=n[0][n[1]],o=a[3]==a[2],i=n[3],l={domain:t,domain_html:pref.catalog.mimic_base_site?site.nickname:t,posts:[s],lth:i,__proto__:i};if(void 0===s&&pref.test_mode[80]){l.no=n[2][2];for(var c=["_IDB/","_File/"],p=0;p<2;p++){l.board=n[2][1].slice(0,-1)+c[p];var _=liveTag.mems[l.domain][l.board]&&liveTag.mems[l.domain][l.board][l.no]&&liveTag.mems[l.domain][l.board][l.no].q;if(_){n[0]=_;break}}}if(void 0===s||Array.isArray(s)?(T(i,parseInt(a[3],10),l),s=n[0][n[1]]):s&&!s.pn&&x(l,i,a[2],s),void 0===s||Array.isArray(s)){site2[l.domain].popups_post_fetch(l,a),r=site2[l.domain_html].post_json2html({time:Date.now(),com:"Loading...",domain:t,board:a[1],no:a[2]},a[1]);var d=a[0]+a[1]+a[2]+"#"+a[3];m(e,d,r),site2.DEFAULT.popups_set_waiting(n[0],n[1])}else{if(!s.pn||o&&("4chan"!==site.nickname||"thread"!==site.whereami)){if(!s.domain){var u=s;if(u.domain=l.domain,u.extra_files)for(var p=0;p<u.extra_files.length;p++)u.extra_files[p].domain=l.domain}r=site2[l.domain_html].post_json2html(s,a[1])}else r=s.pn.cloneNode(!0);cataLog.format_html.prep_anchor_links(r,n[0]),site2[l.domain_html].format_pn(r,s,null,null,n[0]),k(r,e,l)}return gGEH.pns_all_keys.set(r,a[0]+a[1]+a[2]),pref.debug_mode[10]&&console.log("popup: "+n[1]+": "+site2[l.domain].popups_debug(n[0])),d?{pn:r,key:d}:{pn:r}}}function N(e,t){t.style={},t.style.position="fixed",l(t,e,!0),t.style.zIndex=pref[cataLog.embed_mode].popup_zIndex,"KC"!==site.nickname&&(t.style.borderStyle="solid"),t.style.boxShadow="rgb(153, 153, 153) 1px 1px 1px","4chan"===site.nickname&&(t.classList.add("preview"),t.style.display="block"),site2[site.nickname].popups_post_pnode(e.target).appendChild(t),c(t,e)}var I=new WeakMap,A=new Map,B=null;return gGEH.triage_in2=d,{over:e,pop_load:h,pop_load_req_delete:g,inline_post:s}}(),x=function(){function n(e,t,n){var r=pref[n.mode].popup3;if("no"!==r.ww||"no"!==r.wn||"no"!==r.nw||"no"!==r.nn)if(t){if(d.up_timer&&d.src===t)return;s(e),d.src=t,m=n,d.over(r,e,o,t)}else s(e)}function s(e){var n=d.out(e);if(n!==!0){var r=u.recSearch_thread(e.relatedTarget,e.currentTarget);r?t(r,n):h&&t(h,n),h=null,m=null}}function o(e){if(m){var t=gGEH.get_key_recursive(d.src,document),n=f.get(d.src)||[],r=pref[m.mode].popup3;pref.test_mode[110]||c(r.ww,e,t,n,0,!1,!1),c(r.wn,e,t,n,1,!1,!0),c(r.nw,e,t,n,2,!0,!1),c(r.nn,e,t,n,3,!0,!0),h=d.src,d.src=null}}function c(e,t,n,s,o,c,u,h,g){if("no"!==e){if(s[o])return void i(f.get(s[o]));var b=document.createElement("div");if(b.setAttribute("class",pref.script_prefix+"_window"),b.style.position="fixed",b.style.border="1px solid blue",b.style.zIndex=pref.proto.popup3.popup_zIndex,"chart"===e||m.pop_up_set_contents(b,e,n,h)){if(b.addEventListener(brwsr.mousewheel,cnst.div_scroll,!1),l(b,t,!1,c,u),s[o]=site.popup_body.appendChild(b),"chart"===e)if(chart_obj&&pref3.stats.use)var v=new chart_obj.PostChart(b,[n]);else b.innerHTML="Statistics needs to be activated.";pref.catalog_popup_size_fix&&(b.style.width=b.offsetWidth+"px",b.style.height=b.offsetHeight+"px");var y=document.createElement("button");y.classList.add(pref.script_prefix+"_autoTp"),y.appendChild(site2[site.nickname].make_tack()),b.appendChild(y),y.onclick=function(e){var t=e.currentTarget,r=t.parentNode;cnst.bottom_top(r);var s,o=a(r,!0).chart;if(o){var i=document.createElement("div"),l=site2[common_func.name2dbt(n)[0]].parse_funcs.catalog_html.tn_imgs({pn:cataLog.threads[n][0]});l[0]?i.appendChild(l[0].cloneNode()):i.innerHTML=n,common_func.overwrite_prop(i.style,{position:"absolute",bottom:"0px",left:"0px",opacity:.4}),r.replaceChild(i,t),s=chart_obj.PostChart.call(o,null,null,o),s.childNodes[1].replaceChild(r,s.childNodes[1].childNodes[1])}else r.removeChild(t),s=cnst.init3({func_str:"Show:tb"}).pn,s.appendChild(r);s.style.top=parseInt(r.style.top,10)-s.offsetHeight+"px",s.style.left=r.style.left,common_func.overwrite_prop(r.style,{position:"relative",border:null,top:null,left:null})},h?r(g,b,{src:g,scroll:!0,pf:p}):r(d.src,b,v?{src:d.src,chart:v,scroll:!0,pf:_}:{src:d.src,scroll:!0,pf:_},s)}}}function p(){return pref.proto.popupX}function _(){return pref.proto.popup3}var d=e(),h=null,m=null;return{th_over:n,th_over:n,th_out:s,pop_up_th_1:c,set on_clg(e){m=e}}}(),T=function(){function e(e,n,r){var a=gGEH.get_key_recursive(e.target,e.currentTarget);a&&(n.rexps=common_func.kwd_prep_regexp(n,r),x.pop_up_th_1("sr",e,a,[],4,!1,!1,n,e.target),t=e.target)}var t=null;return{X:function(t){var n=pref[cataLog.embed_mode].popupX;if(n.ID){var r=u.getID(t.target);if(r)return e(t,{str:r,id:!0})}if(n.flag){var a=u.getCountry(t.target);if(a)return e(t,{str:a,flag:!0})}if(n.name){var s=u.getName(t.target);if(!pref.anon&&"Anonymous"===s)return;if(s)return e(t,{str:s,name:!0,sentence:!0},!0)}if(n.trip){var o=u.getTrip(t.target);if(o)return e(t,{str:o,trip:!0},!0)}},get et(){return t},set et(e){t=e}}}(),C=function(){function e(e){var t=u.recSearch_thread(e.target,e.currentTarget)||u.recSearch_thread(e.target,e.currentTarget,pref.script_prefix+"_headline"),n=this["."];if(/*!pref.test_mode['127'] &&*/"catalog"===n.mode||"float"===n.mode?t?x.th_over(e,t,n):x.th_out(e):x.on_clg=n,t){var r=gGEH.pns_all_keys.get(t)||gGEH.pns_all_keys.get(t.parentNode);if(r)return cataLog.triage.thread_in(e,r,t,n)}cataLog.triage.thread_out2(e)}function t(e){/*!pref.test_mode['127'] &&*/"catalog"===cataLog.embed_mode?x.th_out(e):x.on_clg=null,cataLog.triage.thread_out2(e)}return{init:function(n,r){n.addEventListener("mouseover",e.bind(r),!1),n.addEventListener("mouseleave",t.bind(r),!1)},destroy:function(t){site.root_body.removeEventListener("mouseover",e,!1)},th_over:e}}();return{over:_,leave:w.stop,pop_load:k.pop_load,blacklist:y,set_pos:l,href2domain:p,init:function(e){u=site2[site.nickname].general_event_handler[site.whereami],gGEH.triage_in=x.th_out},init2:function(e,t){C.init(e,t)},inline_post:k.inline_post,menu_click:C.th_over}}(),popups_posts_class_hlt:"highlighted",popups_post_fetch:function(e,t){cataLog.scan_init("popup",[e.domain+t[1]+(pref.catalog.catalog_json?"t":"")+t[2]],{priority:8})},popups_post_pnode:function(e){if(pref.test_mode[107])return site.popup_body;if(!pref.test_mode[106])for(var t=e.parentNode;t;){if(t===cataLog.parent)return site.popup_body;t=t.parentNode}for(var n;(!(n=e.getAttribute("class"))||n.indexOf("post")==-1&&n.indexOf("thread")==-1)&&e.parentNode;)e=e.parentNode;return e},popups_href2th_q:function(e){var t=this.popups_href2dbtp(e);if(!t[0]||!t[1]||!t[2])return null;var n=liveTag.mems.init({domain:t[0],board:t[1],no:parseInt(t[2],10)});return void 0===n.q&&(n.q=n.no>1e6?Object.create(n):Object.create({0:void 0,1:void 0,2:void 0,__proto__:n})),[n.q,parseInt(t[3],10),t,n]},popups_prep:function(e,t){t||(t=liveTag.mems[e.domain][e.board][e.no]),void 0===t.q&&(t.q=e.no>1e6?Object.create(t):Object.create({0:void 0,1:void 0,2:void 0,__proto__:t}))},popups_add:function(e,t,n){var r=liveTag.mems[t.domain][t.board][t.no];if(e&&"html"===t.type_data)for(var a=0;a<e.length;a++)e[a].no||Object.defineProperty(e[a],"no",{value:t.parse_funcs.no(e[a])});var s={};if(e)for(var a=0;a<e.length;a++){var o=e[a].no;s[o]=null}pref[cataLog.embed_mode].backlink_all||!n&&!pref.test_mode[125]||this.popups_release_all(r,s)},popups_release_all:function(e,t){if(e.q)for(var n=Object.keys(e.q),r=0;r<n.length;r++)void 0===t[n[r]]&&"waiting"!==n[r]&&this.popups_release(e,n[r])},popups_add_1_cross:function(e,t,n){for(var r=0;r<t.length;r++){var a=e.parse_funcs.hrefs(t[r]);if(a)for(var s=0;s<a.length;s++)if("#"!==a[s][0]&&(n||0===a[s].indexOf(e.board))){var o=site2[e.domain].popups_href2th_q(a[s]);if(o){var i=o[2][0]!==e.domain?e.key:o[2][1]!==e.board?e.board+e.no:o[2][2]!=e.no?e.no:null;null!==i&&site2[e.domain_html].popups_add_backlink(o[0],o[1],i+"#"+t[r].no,e,!1,!1)}}}},popups_link_regex:/^>>(>\/[^\/]+\/)*[0-9]+/,popups_add_1:function(e,t,n,r,a,s,o){var i=Array.prototype.slice.call(site2[e.domain_html].post_pn2ce(t.pn).getElementsByTagName("a"));if(n&&pref[cataLog.embed_mode].env.backlink_native){var l=i.length,c=site2[e.domain_html].add_backlinks_bks_query(t.pn);c&&(i=i.concat(Array.prototype.slice.call(c.getElementsByTagName("a"))))}if(i.length>0)for(var p=[],_=0;_<i.length;_++){var d=i[_].textContent;if(d.search(this.popups_link_regex)!=-1){if(n){if(pref[cataLog.embed_mode].env.popup_native_kill){var u=i[_].cloneNode(!0);i[_].parentNode.replaceChild(u,i[_]),i[_]=u}else this.popups_posts.blacklist.add(i[_]);if(_>=l)continue}var f=site2[e.domain].popups_href2th_q(i[_].getAttribute("href"));if(f){pref[cataLog.embed_mode].link_show_op&&f[2][2]==f[2][3]&&d.indexOf("(OP)")==-1&&(i[_].textContent+=" (OP)"),f[0]!==r&&(pref[cataLog.embed_mode].link_show_cross&&d.indexOf("→")===-1&&(i[_].textContent+=" →"),pref[cataLog.embed_mode].merge_btn&&cnst.doms_insertBefore(i[_].parentNode,' [<a href="javascript:;" class="'+pref.script_prefix+'_UImerge">Merge</a>]',i[_].nextSibling)),p[p.length]=[f[0],f[1]];var h=f[2][0]!==e.domain?e.key:f[2][1]!==e.board?e.board+e.no:f[2][2]!=e.no?e.no:null;site2[e.domain_html].popups_add_backlink(f[0],f[1],null!==h?h+"#"+t.no:t.no,e,a,s)}}}this.popups_set(r,t.no,t,p&&0!=p.length&&p,o)},popups_add_backlink:function(e,t,n,r,a,s){if(void 0===e[t])e[t]=[n],a&&this.popups_set_waiting(e,t);else if(Array.isArray(e[t]))e[t].indexOf(n)==-1&&(e[t][e[t].length]=n,a&&this.popups_set_waiting(e,t));else{e[t].backlinks||(e[t].backlinks=[]);var o=e[t].backlinks;o.indexOf(n)==-1&&(o[o.length]=n,e[t].pn&&(!pref[cataLog.embed_mode].backlink||pref[cataLog.embed_mode].env.backlink_native&&s||site2[r.domain_html].add_backlinks(e[t].pn,o,o.length-1,r)))}},add_backlinks:function(e,t,n,r){var a=this.add_backlinks_bks_query(e),s=a||this.add_backlinks_bks();n||(s.innerHTML="");for(var o=n||0;o<t.length&&(this.add_backlinks_add_1(s,this.popups_backlink2dbtpth(t[o],r)),!n);o++);a||this.add_backlinks_bks_append(e,s)},popups_backlink2dbtpth:function(e,t){var n,r="number"==typeof e?[t.domain,t.board,t.no,e,">>"+e]:(n=e.split(/[\/#]/),2==n.length?[t.domain,t.board,n[0],n[1],">>"+(pref.proto.bl_ec?n[0]+"#":"")+n[1]]:[n[0]||t.domain,"/"+n[1]+"/",n[2],n[3],(n[0]?">>>>"+n[0]:">>>")+"/"+n[1]+"/"+(pref.proto.bl_ec?n[2]+"#":"")+n[3]]);return r[5]=site2[r[0]].link_dbtp2href_abs(r),r},remove_backlink:function(e,t){},popups_remove_backlink:function(e,t,n){if(e[t]){var r=Array.isArray(e[t])?e[t]:e[t].backlinks,a=r.indexOf(n);a>=0&&(r.splice(a,1),e.no===t&&pref.proto.bl_rm&&e[t]&&this.remove_backlink(e[t].pn,a))}},popups_set:function(e,t,n,r,a){t<=2&&(Object.hasOwnProperty.call(e,t)||(e[t]=void 0)),void 0===e[t]?(n.backlinks&&(n.backlinks=void 0),e[t]=n):Array.isArray(e[t])?(n.backlinks=e[t],e[t]=n):(e[t].backlinks&&(n.backlinks=e[t].backlinks),a&&(e[t]=n)),r&&(e[t].quotes=r),n.editing&&this.popups_set_waiting(e,t),this.popups_remove_waiting(e,t)},popups_release:function(e,t){function n(e,t){if(e.no!=t&&e.q&&e.q[t]){var n=Array.isArray(e.q[t])?e.q[t]:e.q[t].backlinks;if(!n||0===n.length){this.popups_remove_waiting(e.q,t),a[s++]=[e,t];var r=e.q&&e.q[t]&&e.q[t].quotes;if(r)for(var o=r.length-1;o>=0;o--)a[s++]=[e,t,r[o]]}}}function r(e){var t=Object.keys(e.q);return t.length-(t.indexOf("waiting")==-1?0:1)}var a=[],s=0;if(pref.debug_mode[12])var o={no:t,lth:e,len:r(e)};for(n.call(this,e,t);--s>=0;){var i=a[s];if(e=i[0],t=i[1],3==i.length){var l=i[2][0],c=i[2][1],p=l.domain!==e.domain?e.key:l.board!==e.board?e.board+e.no:l.no!=e.no?e.no:null;this.popups_remove_backlink(l,c,null!==p?p+"#"+t:parseInt(t,10)),n.call(this,Object.getPrototypeOf(l),c)}else delete e.q[t]}if(pref.debug_mode[12]){var _=r(o.lth);_!==o.len&&console.log("popups_release: "+o.lth.key+": "+_+" <- "+o.len+", "+o.no+(pref.debug_mode[10]?"    "+this.popups_debug(e.q):""))}},popups_set_waiting:function(e,t){if(e.waiting){for(var n=0;n<e.waiting.length&&e.waiting[n]<t;)n++;e.waiting[n]!=t&&e.waiting.splice(n,0,t)}else e.waiting=[t]},popups_remove_waiting:function(e,t){if(e.waiting){var n=e.waiting.indexOf(t);n!=-1&&(e.waiting.splice(n,1),0===e.waiting.length&&delete e.waiting)}},popups_fetched:function(e,t,n){n||(n=0);for(var r=e.posts.length-1,a=t.q.waiting.length-1;a>=0;a--){for(var s=t.q.waiting[a];r>n&&s<e.posts[r].no;)r--;s===e.posts[r].no?this.popups_set(t.q,s,e.posts[r]):"thread"===e.type_source&&(pref.test_mode[64],this.popups_set(t.q,s,{time:0,com:"DELETED"})),this.popups_posts.pop_load(e.key+"#"+e.posts[r].no,e.domain)}},popups_fetched_html:function(e,t){var n={domain:t.domain,board:t.board,domain_html:t.domain_html,parse_funcs:t.parse_funcs};if(e.extra_files)for(var r=0;r<e.extra_files.length;r++)for(var a in n)e.extra_files[r][a]=n[a];for(var a in n)e[a]=n[a];e.parse_funcs.filename&&(e.filename=e.parse_funcs.filename(e));e.time;return e.sub,e.com,e.name,e.no,e.op_img_url,e.type_data=t.type_data,e},backlink:function(e,t,n){var r=t?Array.isArray(t)?t:t.backlinks:null;r&&this.add_backlinks(e,r,void 0,n)},popups_debug:function(e){if(!e)return"";for(var t=Object.keys(e),n=t.length+", "+e.key+": ",r=0;r<t.length;r++){var a=t[r];n+=a+":"+(Array.isArray(e[a])?e[a]:e[a].backlinks||e[a].remove_if_no_backlinks||"P")+", "}return n},toplevel_anchor_pos:1,toplevel_anchor:function(e,t){for(var n=e.getElementsByTagName("a"),r=this.toplevel_anchor_pos,a=[t.domain,t.board,t.no,null],s=0;s<n.length;s++){var o=n[s].getAttribute("href");o&&"#"===o[0]&&(a[3]=o.substr(r),n[s].setAttribute("href",this.link_dbtp2href(a)))}},wrap_to_parse:function(){function e(){return pref.debug_mode.parse_error?site4.parse_funcs_on_demand_debug:site4.parse_funcs_on_demand}function t(t,n,a){var s=a.substr(0,a.indexOf("_")),o=a.substr(a.indexOf("_")+1),i=r[s]+r[o]+(pref.debug_mode.parse_error?"_debug":""),l=liveTag.mems.init({domain:t,board:n}).p[i];if(!l){var c=liveTag.mems[t].p,l=c[i];if(!l){var p=site2[t].parse_funcs[a+"_template"]||site2[t].parse_funcs[o+"_template"]||e(),_=pref.catalog.mimic_base_site||site2[t].mimic_always?site.nickname:t;c[i]={domain:t,parse_funcs:site2[t].parse_funcs[a],parse_funcs_html:site2[_].parse_funcs[s+"_html"],type_parse:a,type_source:s,type_data:o,type_html:s,domain_html:_,__proto__:p},c[i].parse_funcs.missing_info&&(c[i].missing_info=c[i].parse_funcs.missing_info),l=c[i]}liveTag.mems[t][n].p[i]={board:n,__proto__:l},l=liveTag.mems[t][n].p[i]}return l}var n=/[A-z]/,r={catalog:"c",page:"i",thread:"t",post:"p",shortCatalog:"b",shortThread:"s",html:"h",json:"j"};return{get_getters:e,prep_pfunc:t,get:function(e,r,a,s,o){var i=t(r,a,s);return o&&(void 0!==o.thread&&n.test(o.thread)&&(o.thread=o.thread.substr(1)),o.__proto__=i,i=o),s.indexOf("_json")==-1?site2[r].parse_funcs[s].ths({pn:e,__proto__:i}):site2[r].parse_funcs[s].ths(e,i)},posts:function(e,n,r){if(void 0===e.type_data){var a=[];if(e.posts)for(var s=0;s<e.posts.length;s++)!e.posts[s].domain&&e.posts.pn&&(a[a.length]=e.posts[s]);0!=a.length&&this.posts({type_data:"html",posts:a,__proto__:e},0,common_func.shallow_copy_1(r)),e={type_data:"json",__proto__:e}}var o=t(e.domain,e.board,"post_"+e.type_data);r&&(r.__proto__=o,o=r);var i=e.localArchive;if(i&&(o={localArchive:i,__proto__:o}),e.posts)for(var s=n||0;s<e.posts.length;s++)if(!e.posts[s].domain||i){if(e.posts[s].extra_files)for(var l=0;l<e.posts[s].extra_files.length;l++)e.posts[s].extra_files.domain||(e.posts[s].extra_files[l].__proto__=o);e.posts[s].__proto__=o}if(e.extra_files&&(!e.extra_files[0].domain||i))for(var l=0;l<e.extra_files.length;l++)e.extra_files[l].__proto__=o}}}(),parse_pn_dummy:document.createElement("div"),parse_funcs:{common:{finisher:function(){},posts:function(){},com:function(){},flags:function(){},flag:function(){},id:function(){},country:function(){},hrefs:function(){},trip:function(){},th_init:null,tn_as:function(e){return e.pn.getElementsByTagName("a")},tn_imgs:function(e){for(var t=[],n=e.pn.getElementsByTagName("a"),r=0;r<n.length;r++){var a=n[r].getElementsByTagName("img")[0];a&&(t[t.length]=a)}return t},key:function(e){return e.domain+e.board+e.no},op_img_url:function(e){return site2[e.domain].catalog_json2html3_thumbnail(e,e.board)},get_op_src:function(e){return e.op_img_url},ths_array:function(e,t){var n=[];if(t)for(var r=0;r<t.length;r++){var a="catalog"===e.type_html?Math.floor(r/15)+"."+r%15:"page"===e.type_html?e.page+"."+r:void 0;n[r]={pn:t[r],page:a,__proto__:e.__proto__}}return n},time:function(e){},time_posted:function(e){},time_unit:1,has_posts:!0,txt:function(e){return site2.DEFAULT.parse_pn_dummy.innerHTML=e.com,site2.DEFAULT.parse_pn_dummy[brwsr.innerText]},type_com:"html",footer_prep:function(e,t){var n=t.innerHTML.replace(/ *R:[0-9 \/]*I:[0-9 \/]*/,"");n=n.replace(/P:[0-9 \/]*/,""),""!==(n=n.replace(/ *\(sticky\) */,""))&&(t.innerHTML="<span></span>"+n,t=t.childNodes[0])},get_lth_from_node:function(e){for(;e&&!e.name;)e=e.parentNode;return e&&liveTag.mems.getFromName(e.name)||null},nativeUpdate2pn:function(e){return e.lastChild}},headline_html:{footer:function(e){return e.pn.insertBefore(cnst.dom('<span style="padding:0 3px 0 0"></span>'),e.pn.firstChild)},css:".threadIcons {margin:0px;position:static;width:auto;text-align:left;display:inline}"},catalog_html:{posts:function(e){return[{pn:e.pn,__proto__:e.__proto__}]},time:function(e){return e.time_created},posts_full:function(){var e={posts:null,pn:null,flag:null,flags:null,footer:null,pn_name:null,ths:null,page:null,tn_as:null,tn_imgs:null,txt:null,pn_id:null,pn_trip:null,parse_funcs:null,parse_funcs_html:null,type_parse:null,type_source:null,type_data:null,type_html:null,domain:null,board:null,domain_html:null,exe_sub:null,exe_sub2:null};return function(t){for(var n in t)void 0===e[n]&&t.parse_funcs[n]&&Object.defineProperty(t.posts[0],n,{value:t[n],enumerable:!0,configurable:!0,writable:!0})}}(),has_posts:!1,type_com:"txt",filename:function(e){var t=e.op_img_url.replace(/.*\//,""),n=t.indexOf(".");return e.tim=t.substr(0,n),e.tim}},catalog_json:{ths:function(e,t){for(var n=[],r=0;r<e.length;r++)if(e[r].threads)for(var a=0;a<e[r].threads.length;a++)e[r].threads[a].page=r+"."+a,e[r].threads[a].sticky=1===e[r].threads[a].sticky,e[r].threads[a].type_html="catalog",e[r].threads[a].__proto__=t,n[n.length]=e[r].threads[a];return n},posts:function(e){return[{time:e.time,DUMMY:!0}]},posts_full:function(e){delete e.posts[0].DUMMY;for(var t=Object.keys(e),n=0;n<t.length;n++)"posts"!==t[n]&&"pn"!==t[n]&&(e.posts[0][t[n]]=e[t[n]])},has_posts:!1},page_html:{posts_array:function(e,t){var n=[],r=site2[e.domain].wrap_to_parse.prep_pfunc(e.domain,e.board,"post_html");if(pref.test_mode[5])n.pns=t,n.idx0=0,n.idx1=t.length-1,n.get0=this.posts_get0,n.get1=this.posts_get1,n.proto=r,Object.defineProperty(n,n.idx0,{get:n.get0,enumerable:!0,configurable:!0}),Object.defineProperty(n,n.idx1,{get:n.get1,enumerable:!0,configurable:!0});else for(var a=0;a<t.length;a++)n[n.length]={pn:t[a],__proto__:r};return n},posts_get0:function(){var e={pn:this.pns[this.idx0],__proto__:this.proto};return Object.defineProperty(this,this.idx0,{value:e,enumerable:!0,configurable:!0,writable:!0}),++this.idx0<this.idx1&&Object.defineProperty(this,this.idx0,{get:this.get0,enumerable:!0,configurable:!0}),e},posts_get1:function(){var e={pn:this.pns[this.idx1],__proto__:this.proto};return Object.defineProperty(this,this.idx1,{value:e,enumerable:!0,configurable:!0,writable:!0}),--this.idx1>this.idx0&&Object.defineProperty(this,this.idx1,{get:this.get1,enumerable:!0,configurable:!0}),e},posts:function(e){return this.posts_array(e,e.pn.getElementsByClassName("post"))},time_posted:"thread_html",time_bumped:function(e){return e.posts[e.posts.length-1].time},time_created:function(e){return e.posts[0].time},key:function(e){return e.domain+e.board+e.no},insert_footer4:function(e){var t=document.createElement("div");return e.parentNode.insertBefore(t,e)},flags:function(e){var t=[],n=e.posts.length-1,r=pref[cataLog.embed_mode].t2h_num_of_posts-1;if(n<r)for(r=0;r<=n;)e.posts[r]&&(t[r]=e.posts[r].flag),r++;else for(;r>=0;)e.posts[n]&&(t[r--]=e.posts[n--].flag),0==r&&(n=0);return t},html_org:function(e){return e.pn.innerHTML},sticky:function(){return!1},type_com:"txt",replace_omitted_info:function(e,t){e.textContent=t.textContent},replace_omitted_info2:"replace_omitted_info",posts_full:"catalog_html",get_max_page:function(e){var t=e.getElementsByClassName("pages")[0];if(t){t=t.childNodes;for(var n=0,r=0;r<t.length;r++)n+1==t[r].textContent&&n++;return n}}},page_json:{ths:function(e,t){var n=[];if(e&&e.threads)for(var r=0;r<e.threads.length;r++){var a=e.threads[r];a&&(a.page=t.page?t.page+"."+r:void 0,a.key=t.domain+t.board+a.posts[0].no,a.posts[0].__proto__=t,a.__proto__=a.posts[0],n[r]=a)}return n},flags:function(e){if(e.country){var t=e.posts.length-pref[cataLog.embed_mode].t2h_num_of_posts;return[e].concat(e.posts.slice(t<=1?1:t))}}},thread_html:{ths_array:function(e,t){return[{pn:t,__proto__:e.__proto__}]},time_posted:function(e){return 1e3*e.posts[e.posts.length-1].time},posts_full:"catalog_html",id:function(e){return e.posts[0].id},country:function(e){return e.posts[0].country},trip:function(e){return e.posts[0].trip},flag:function(e){return e.posts[0].flag},name:function(e){return e.posts[0].name},type_com:"txt",time_unit:1e3},thread_json:{ths:function(e,t){return e.key=t.domain+t.board+e.posts[0].no,e.posts[0].__proto__=t,e.__proto__=e.posts[0],[e]},time_created:function(e){return 1e3*e.posts[0].time},time_bumped:function(e){if(!e.posts[0].bumplimit){for(var t=e.posts.length-1;t>0&&e.posts[t].email&&"sage"===e.posts[t].email;)t--;return 1e3*e.posts[t].time}},time_posted:function(e){return 1e3*e.posts[e.posts.length-1].time},nof_posts:function(e){return e.posts[0].replies+1},nof_files:function(e){return e.posts[0].images+1},has_nof_files:!0,sub:function(e){return e.posts[0].sub||""},name:function(e){return e.posts[0].name||""},com:function(e){return e.posts[0].com||""},sticky:function(e){return 1===e.posts[0].sticky},time_unit:1e3,prep_to_archive:function(e){return{posts:e}},rip_from_archive:function(e){return e.posts||e}},post_html:{sub:function(e){var t=e.pn.getElementsByClassName("subject")[0];return t?t.textContent:""},img2src:function(e){return e.parentNode.href},img2ext:function(e){return e.parentNode.getAttribute("data-ext")}},post_json:{time_unit:1e3,pn:function(e){return site2[e.domain_html].post_json2html(e,e.board)},anchor:function(){},hrefs:function(e){if(e.com){var t=e.com.match(/href="([^"]*)"/g);if(t)for(var n=0;n<t.length;n++){var r=t[n].indexOf("://");t[n]=t[n].slice(r===-1?6:r+1,-1)}return t}}},catalog_json_template:"post_json_template",page_json_template:"post_json_template",thread_json_template:"post_json_template",post_json_template:{sub:"",name:"Anonymous",com:"",sticky:void 0,no:void 0,time:void 0},html_template:{get id(){return this.exe_sub("id")},get pn_id(){return this.exe_sub("pn_id")},get pn_name(){return this.exe_sub("pn_name")}}},parse_parts:{add_op_img_url:function(e,t,n){for(var r=0;r<e.length;r++)e[r].op_img_url=site2[n].catalog_json2html3_thumbnail(e[r],t)}},update_posts_merge_prep:function(e,t,n,r){if(e){n=n>=0?n+1:(t&&t.length?t.length:0)+e.length,n<e.length&&(e=e.slice(0,1).concat(e.slice(e.length-n+1)));var a=1,s=0,o=[e[0]];if(r)for(;a<e.length&&s<t.length;)e[a].no!==t[s].no?o[o.length]=e[a].no<t[s].no?e[a++]:t[s++]:(o[o.length]=e[a++],s++);else for(;a<e.length&&s<t.length;)o[o.length]=e[a].time*e[a].parse_funcs.time_unit<t[s].time*t[s].parse_funcs.time_unit?e[a++]:t[s++];return o=o.concat(a<e.length?e.slice(a):t.slice(s)),o.length<=n?o:o.slice(0,1).concat(o.slice(o.length-n+1,o.length))}},update_posts_merge_bases:{factory:function(){return{bases:{},initialized:!1,shown:new Set,shownSet:null,__proto__:this}},bases:{},initialized:!1,query:function(e,t,n,r,a){var s=this.base_tgts(e,a.pref[a.mode]);if(s){var o=s?this.bases[s]:null,i=o||this.base_factory(e,t,n,r,a);return this.bases[e]=i,this.merge_th(t,n,i,e,a),o?r&&a.func_hide_org(e):this.initialized||this.setup_hook(a),t[0]=i.pn,i}},base_factory:function(){function e(e){return e[8][0]}function t(e){return e[8][1]}function n(e){return e[8][2]}function r(e){return e[8][3]}function a(e){return e[8][4]}function s(e,t){return e>t?e:t}function o(e,t){return e<t?e:t}function i(e,t){return e+t}function l(e){return u.lths.map(e).reduce(c)}function c(e,t){return e&&t?e+t:e?e:t}function p(e){return e.ta&&e.ta.posts?e.ta.posts.length:""}function _(e){return e.pd?e.pd.length:""}function d(e){return e.sg?e.sg.size:""}var u,f={posts:{get length(){return l(p)}}},h={get length(){return l(_)}},m={get size(){return l(d)}},g={recent_posts:function(e){void 0!==e&&null!==e||(e={lth:u,__proto__:u.tgt_ths[0][16]}.get_t2h_num_of_posts());var t=u.posts||(u.lths.forEach(function(e){site2[e.domain].wrap_to_parse.posts({posts:e.ta.posts,__proto__:e.ta.posts[0]})}),u.tgt_ths.map(function(t){return t[16].recent_posts(e)}).reduce(function(t,n){return site2.DEFAULT.update_posts_merge_prep(t,n,e)}));return site2.DEFAULT.update_posts_replace_prep(null,t,e)}},b={lazy_draw:function(e){e>=this.lazy.length?this.lazy[e]=!0:this.lazy.splice(e,0,!0),this.lazy_idx>e&&(this.lazy_idx=e)},remove:function(e){return this.posts.splice(e,1),e<this.lazy_idx&&this.lazy_idx--,!this.lazy||!this.lazy.splice(e,1)[0]},draw_1_pos:function(e){for(var t=e+1;t<this.lazy.length&&this.lazy[t];)t++;return this.lazy[e]=!1,t},get_class:function(e,t,n){if(!t&&!pref.proto.merge_lv)return null;var r=pref_func.merge_obj5a_sc(e,n?pref3.proto.merge_lv_obj2_old:pref3.proto.merge_lv_obj2,null);return null===r?null:pref.script_prefix+"_merged"+r},posts:null,lazy:null,lazy_idx:null,get 0(){return this.tgt_ths.map(e).reduce(s)},get 1(){return this.tgt_ths.map(t).reduce(o)},get 2(){return this.tgt_ths.map(n).reduce(i)},get 3(){return this.tgt_ths.map(r).reduce(i)},get 4(){return this.tgt_ths.map(a).reduce(s)},get 8(){return this},get 14(){var e,t=this.tgt_ths.map(function(t){return t[14]&&t[14].indexOf(".")!==-1?(e=t[14].split("."),e[0]+"."+(e[1].length>=2?e[1]:"0"+e[1])):t[14]}).sort();return(t[0]+"-"+t[t.length-1]).replace(/\.0/g,".")},get 16(){return u=this,g},domain:"",board:"",no:"",tags:[],get watched(){return this.lths.some(function(e){return e.watched})},get nrtm(){return this.lths.map(function(e){return e.watched&&e.nrtm||0}).reduce(i)},get nr(){return this.lths.map(function(e){return e.watched&&e.nr||0}).reduce(i)},get ta(){return u=this,f},get pd(){return u=this,h},get sp(){return u=this,m},get archived(){var e=this.lths.filter(function(e){return e.archived}).length;return 0===e?0:e===this.lths.length?1:8},get keys(){return this.lths.map(function(e){return e.key})}};return function(e,t,n,r,a){var s={pn:t[0],isShown:0,key:e,top_key:e,tgt_ths:[],lths:[],footer:null,__proto__:b}
;if("catalog"===a.view)s.cns=null;else if("page"===a.view||"thread"===a.view){var o=t[16].posts||n.posts;a.merge_bases.class_add_all(o,b.get_class(e)),s.posts=o.slice(),s.lazy=pref[a.view].lazyDraw.merge?o.map(function(){return!1}):null,s.lazy_idx=pref[a.view].lazyDraw.merge?o.length:null}return s}}(),class_add_all:function(e,t){if(t)for(var n=0;n<e.length;n++)e[n].pn&&e[n].pn.parentNode&&e[n].pn.parentNode.classList.add(t)},class_remove_all:function(e,t){if(t)for(var n=0;n<e.length;n++)e[n].pn&&e[n].pn.parentNode&&e[n].pn.parentNode.classList.remove(t)},remove_th:function(e,t,n){var r=this.bases[e];if(r){var a=t[16].domain_html;t[0]="catalog"===n.view?site2[a].catalog_separate({cns:t[3],__proto__:t[16]},r,n):"headline"===n.view?site2[a].headline_separate(r,t[3]):this.remove_th_page(t[16],!1,r,n),2===r.isShown&&(r.footer[0].parentNode.removeChild(r.footer[0]),r.footer=null),n.remake_html_prep(t,"page"===n.view||"thread"===n.view),t[3]=null,r.isShown>=2&&(t[22]=null);var s=r.lths.indexOf(liveTag.mems.getFromName(e));r.tgt_ths.splice(s,1),r.lths.splice(s,1),n.footer.draw_merge(t,e,null),2===r.isShown&&gGEH.pns_all_keys.set(r.pn,r.lths[0].key),0!=--r.isShown&&r.key===e&&(r.key=r.lths[0].key,gGEH.pns_all_keys.set(r.pn,r.key),n.view_attr_set(r.key,null,!0)),r.top_key===e&&(r.top_key=null),delete this.bases[e]}},merge_th:function(e,t,n,r,a){var s=e[16].domain_html;"catalog"===a.view?e[3]=site2[s].catalog_merge(e[0],n,a):"headline"===a.view?e[3]=site2[s].headline_merge(e[0],n,a):(1===n.isShown&&(n.footer=[n.pn.insertBefore(cnst.dom('<div style="clear:both"></div>'),n.pn.firstChild)]),0!==n.isShown&&this.merge_th_page({pn:e[0],posts:e[16].posts||t.posts,__proto__:e[16]},n,a)),n.tgt_ths[n.tgt_ths.length]=e,n.lths[n.lths.length]=liveTag.mems.getFromName(r),a.footer.draw_merge(e,r,n),n.isShown++,n.isShown>=2?e[22]=a.threads[n.lths[0].key][22]:1!=n.isShown||e[22]||(e[22]={}),2===n.isShown&&(gGEH.pns_all_keys.set(n.pn,n),gGEH.pns_all_keys.set(n.footer[0],n)),gGEH.pns_all_keys.set(e[24][0],r)},remove_th_page:function(e,t,n,r){var a=t?null:site2[e.domain_html].page_json2html3_skelton(e);return site2[e.domain_html].update_posts_separate(e,n,a,r),a},merge_th_page:function(e,t,n){for(var r=0,a=0;a<e.posts.length;a++)r=site2[e.domain_html].update_posts_merge_1(e,t,a,r);t.lazy&&t.lazy_idx<t.posts.length&&n.lazy_tgts.set(t,e.key)},base_arr:function(e,t){return pref_func.merge_obj5a_sc(e,t?pref3.proto.merge_list_obj2_old:pref3.proto.merge_list_obj2,null)},base_tgts:function(e,t){if(t.merge)return Object.keys(this.bases)[0]||e;if(t.merge_list){var n=this.base_arr(e);if(!n)return null;for(var r in this.bases)if(this.base_arr(r)===n)return r;return e}return null},query_merged_keys:function(e){var t=this.bases[e];return t?t.keys:[e]},func_show:function(e,t,n){var r=this.merge_bases,a=this.threads[e],s=r.bases[e]||!a[1]&&r.query(e,a,null,!1,this);return s?(r.shown.has(s)||this.func_show_org(e,t,n),!0):this.func_show_org(e,t,n)},func_hide:function(e){var t=this.merge_bases,n=t.bases[e];return n?(1===n.isShown&&(this.func_hide_org(e),t.shown.delete(n),"page"!==this.view&&"thread"!==this.view||this.lazy_tgts.delete(n)),t.remove_th(e,this.threads[e],this),!0):this.func_hide_org(e)},func_search_ref_idx:function(e,t){var n=this.merge_bases,r=this.threads[e],a=n.bases[e]||!r[1]&&n.query(e,r,null,!1,this),s=a&&this.idxs.indexOf(a.top_key);return a?s===-1||s>t?(a.top_key=e,t):s:t},func_search_ref:function(e){var t=this.merge_bases,n=t.bases[e];return n&&n.top_key!==e},func_check_overrated:function(e){var t=this.merge_bases,n=t.bases[e];return n&&null===n.top_key},func_track_shown:function(e,t){var n=this.merge_bases,r=n.bases[e];if(r){var a=this.pref[this.mode];if(n.shown.has(r)||(this.func_track_shown_org(e,!a.merge&&t),n.shown.add(r),n.shownSet&&n.shownSet.add(n.base_arr(e))),r.lazy&&r.lazy_idx<r.posts.length&&this.lazy_tgts.set(r,e),a.merge&&t&&("page"===this.view||"thread"===this.view)){var s=pref.test_mode[88]?1:pref.proto.lazyDraw.merge_step;++this.post_count%s==0&&(this.drawn_y=this.threads[e][16].posts[0].pn.offsetTop)}}else this.func_track_shown_org(e,t)},shown:new Set,shownSet:null,isShownForTails:function(e){if(this.bases[e])return!0;if(!this.shownSet){this.shownSet=new Set;for(var t of this.shown.values())this.shownSet.add(this.base_arr(t.key))}return this.shownSet.has(this.base_arr(e))},func_track_reset:function(){var e=this.merge_bases;e.shown.clear(),e.shownSet=null,this.post_count=0,this.lazy_tgts.clear(),this.func_track_reset_org()},setup_hook:function(e){e.func_show_org=e.func_show,e.func_show=this.func_show,e.func_hide_org=e.func_hide,e.func_hide=this.func_hide,e.func_track_shown_org=e.func_track_shown,e.func_track_shown=this.func_track_shown,e.func_track_reset_org=e.func_track_reset,e.func_track_reset=this.func_track_reset,e.func_search_ref=this.func_search_ref,e.func_search_ref_idx=this.func_search_ref_idx,e.func_check_overrated=this.func_check_overrated,e.post_count=0,e.lazy_tgts=new Map,e.func_lazy_draw=this.func_lazy_draw,this.initialized=!0},func_lazy_draw:function(){var e=this.get_ref_height(4);for(var t of this.lazy_tgts.keys()){var n=t.lazy_idx;if(n>=1&&t.posts[n-1].pn.offsetTop>e)break;for(var r=0,a=pref.test_mode[88]?1:pref.proto.lazyDraw.merge_step,s=pref.catalog.mimic_base_site?site.nickname:this.threads[this.lazy_tgts.get(t)][16].domain_html;n<t.posts.length;){if(t.lazy[n]){for(r<n&&(r=n+1);r<t.lazy.length&&t.lazy[r];)r++;site2[s].update_posts_insert(t.posts,t.posts,n,r,t.pn),t.lazy[n]=!1;var o=t.get_class(t.posts[n].key_op);o&&t.posts[n].pn.parentNode.classList.add(o)}if(!pref.test_mode[111]&&++this.post_count%a==0&&t.posts[n].pn.offsetTop>e)break;n++}t.lazy_idx=n,n>=t.posts.length&&this.lazy_tgts.delete(t)}},release_hook:function(){},auto_merge_list:function(e,t){t.threads[e];if(this.bases[e]){var n=this.base_arr(e);n&&(n.splice(n.indexOf(e),1),scan.scan_ui("mergeAuto",{tgts:n,options:{refresh:t}}),pref[pClg.mode].merge_auto_list_lv_add&&pClg.merge_bases.add_to_lv_list(n,pref[pClg.mode].merge_auto_list_lv,pClg))}},add_to_list:function(e,t,n){scan.scan_ui("mergeUI",{tgts:[t],options:{refresh:n}}),pref.proto.merge_btn_lv_add&&this.add_to_lv_list(t,pref.proto.merge_btn_lv,n),"all"===n.pref[n.mode].merge_btn_mode?n.pref[n.mode].merge||(n.pref[n.mode].merge=!0,pref_func.apply_prep(n.components.merge,!1,!0,"float"!==n.mode)):(this.add_to_list_1(e,t,n),pref.proto.merge_list||(pref.proto.merge_list=!0,pref_func.settings.pnOrDummy(pClg.mode+".merge_list").checked=!0,n.onchange_funcs["*w/.merge_list"]()))},add_to_lv_list:function(e,t,n){if(Array.isArray(e))for(var r=0;r<e.length;r++)this.add_to_lv_list(e[r],t,r===e.length-1?n:null);else{var a=new RegExp("(^|,)\\s*"+e+"\\s*:\\s*\\w+\\s*(,|\n|$)","mg"),s=pref.proto.merge_lv_str.replace(a,",")+","+e+":"+t+",\n";pref.proto.merge_lv_str=s.replace(/,,+/g,",").replace(/^,/g,"").replace(/\n,/g,"\n").replace(/\n\n+/g,"\n").replace(/^\n/,""),n&&(pref_func.apply_prep_1n("proto.merge_lv_str",!1,null,null,!0),n.onchange_funcs["*w/.merge_lv_str"]())}},add_to_list_1:function(e,t,n){var r=this.base_arr(t);e&&t&&r&&r===this.base_arr(e)||(this.add_to_list_2(t,null,n),e&&t&&this.add_to_list_2(e,t,n),pref_func.apply_prep_1n("proto.merge_list_str",!1,null,null,!0),n.onchange_funcs["*w/.merge_list_str"]())},add_to_list_2:function(e,t,n){var r=pref.proto.merge_list_str,a=e.replace(/\+/,"\\+")+"([\\^@;][^,\n]*)*";if(t){var s=new RegExp("(^|,|\\+)\\s*"+a+"(?=(,|\n|$|\\+))","mg");r.search(s)!==-1?r=r.replace(s,"$&+"+t):r+="\n"+e+"+"+t+"\n"}else r=r.replace(new RegExp("(^|,)"+a+"([,\n]+\\s*\\+*|$|\\+)","mg"),"$1").replace(new RegExp("\\+\\s*"+a+"(,|\n|$|\\s*\\+)","mg"),"$2");pref.proto.merge_list_str=r.replace(/,,+/g,",").replace(/^,/g,"").replace(/\n,/g,"\n").replace(/\n\n+/g,"\n").replace(/^\n/,"")},hide_merge_tgts:function(e,t){for(var n in e.threads){var r=e.threads[n],a={};a[n]=r,r[1]&&t.call(this,n)&&e.func_hide_all(a)}pref3.proto.merge_list_obj2_old=null,e.func_track_reset(),this.initialized||this.setup_hook(e)},onchange_funcs:common_func.Object_defProps(pref_func.settings.onchange_funcs,{"*w/.merge_list_str":function(e,t){var n=this["."];if(!n)return void gClg.BroadcastEventByMode(t.split(".")[0],this["*w/.merge_list_str"],arguments);n.pref[n.mode].merge_list&&(n.merge_bases.hide_merge_tgts(n,function(e){var t=this.base_arr(e),n=this.base_arr(e,!0);return t?!n||t.join()!==n.join():n}),n.show_catalog())},"*w/.merge_list":function(e,t){var n=this["."];if(!n)return void gClg.BroadcastEventByMode(t.split(".")[0],this["*w/.merge_list"],arguments);n.merge_bases.hide_merge_tgts(n,function(e){return this.base_arr(e)||this.base_arr(e,!0)}),n.show_catalog()},"*w/.merge":function(e,t){var n=this["."];if(!n)return void gClg.BroadcastEventByMode(t.split(".")[0],this["*w/.merge"],arguments);n.merge_bases.hide_merge_tgts(n,function(){return!0}),n.pref[n.mode].merge&&(n.order.ordering_old=n.order.ordering),n.components.ordering.onfocus(),n.order.ordering=n.pref[n.mode].merge?7:n.order.ordering_old||n.order.ordering,pref_func.apply_prep(n.components.ordering,!1,!0),n.components.ordering.onblur(),n.components.ordering.disabled=n.pref[n.mode].merge},"*w/.merge_lv_str":function(e,t){var n=this["."];if(!n)return void gClg.BroadcastEventByMode(t.split(".")[0],this["*w/.merge_lv_str"],arguments);n.pref[n.mode].merge_lv&&this["*w/.merge_lv"](e,t,!0)},"*w/.merge_lv":function(e,t,n){var r=this["."];if(!r)return void gClg.BroadcastEventByMode(t.split(".")[0],this["*w/.merge_lv"],arguments);if(r.pref[r.mode].merge||r.pref[r.mode].merge_list){var a=r.merge_bases;for(var t in r.threads)if(r.threads[t][1]){var s=a.bases[t];if(s){var o=s.get_class(t),i=s.get_class(t,!0,!0);if(!n||o!=i){var l="page"===r.view||"thread"===r.view?r.threads[t][16].posts:[{pn:s.pn}];!n&&r.pref[r.mode].merge_lv||a.class_remove_all(l,n?i:o),(n||r.pref[r.mode].merge_lv)&&a.class_add_all(l,o)}}}pref3.proto.merge_lv_obj2_old=null}}})},update_posts_replace_prep:function(e,t,n){if(!e||e.length<=1)return n<0||t.length<=n+1?t:0==n?t.slice(0,1):t.slice(0,1).concat(t.slice(-n));if((n=n>=0?n+1:t.length+e.length-1)==e.length)return e;if(n<e.length)return e.slice(0,1).concat(e.slice(e.length-n+1));for(var r=e[1].no,a=1;a<t.length&&t[a].no<r;)a++;if(1===a)return e;var s=a>n-e.length?a-(n-e.length):1;return e.slice(0,1).concat(t.slice(s,a),e.slice(1))},update_posts0_class:function(e,t){t?e.classList.remove("CatChan_search_miss"):e.classList.add("CatChan_search_miss")},update_posts_replace:function(e,t,n,r,a,s,o,i,l){if(r&&(n=r.pn,a=r.isShown),t.posts){if("4chan"===site.nickname||pref.test_mode[140])site2[e.domain].page_json2html3_add_omitted_info(e,t,pref[o.view].use_expander_always);else{var c=t.parse_funcs_html.get_omitted_info(t.posts[0]),p=e.posts[0].pn&&(pref.test_mode[139]||e.posts[0]!==t.posts[0])?e.parse_funcs_html.get_omitted_info(e.posts[0]):site2[e.domain_html].page_json2html3_add_omitted_info(e,null,e.posts);c?t.parse_funcs_html.replace_omitted_info2(c,p,e):p&&t.parse_funcs_html.set_omitted_info(t.posts[0],p)}for(var _=-1,d=e.posts.length-1,u=null,f=t.posts.length-1;f>=1;f--){for(;d>1&&e.posts[d].no>t.posts[f].no;)d--;var h=t.posts[f].editing&&t.posts[f].pn&&t.posts[f]!==e.posts[d];(e.posts[d].no!=t.posts[f].no||h)&&(_=this.update_posts_remove_1(t,f,n,a,r,_,o)),h&&(u?u[u.length]=e.posts[d]:u=[e.posts[d]])}}this.update_posts_add(e,t,n,r,a,s,u,i,l)},update_posts_add:function(e,t,n,r,a,s,o,i,l){if(t.posts&&e.posts)for(var c=liveTag.mems[e.domain][e.board][e.no].q,p=(r&&e.parse_funcs.time_unit,-1),_=r?0:1,d=r?0:1;d<e.posts.length;d++){for(;_<t.posts.length&&e.posts[d].no>t.posts[_].no;)_++;if(_>=t.posts.length||e.posts[d].no!=t.posts[_].no){var u=o&&o.indexOf(e.posts[d])!=-1,c=u?liveTag.mems[e.domain][e.board][e.no].q:null;cataLog.format_html.prepare_html_post(e,e.posts[d],null,null,null,i,!0,l,!0),u&&pref[cataLog.embed_mode].backlink&&c[e.posts[d].no].backlinks&&site2[e.domain_html].add_backlinks(e.posts[d].pn,c[e.posts[d].no].backlinks,void 0,e),r?p=this.update_posts_merge_1(e,r,d,p):this.update_posts_insert(e.posts,t.posts,d,_,n),_<t.posts.length?t.posts.splice(_,0,e.posts[d]):t.posts[t.posts.length]=e.posts[d],s[s.length]=e.posts[d]}_<t.posts.length&&_++}},update_posts_remove_1:function(e,t,n,r,a,s,o){var i=e.posts[t];return r&&pref[cataLog.embed_mode].scroll_lock&&o.show_catalog_scroll_lock.modified(i),a?(s=s==-1?a.posts.indexOf(i):a.posts.lastIndexOf(i,s),s==-1&&(s=a.posts.lastIndexOf(i)),s>=0&&a.remove(s)&&this.update_posts_remove(e,t,n)):i.pn&&this.update_posts_remove(e,t,n),e.posts.splice(t,1),s},update_posts_merge_1:function(e,t,n,r){var a=e.posts[n].time_tu;for(r==-1&&(r=t.posts.length-1);r>0&&t.posts[r].time_tu>=a;)r--;for(;r<t.posts.length&&(t.posts[r].time_tu<a||t.posts[r].time_tu==a&&t.posts[r].no<=e.posts[n].no);)r++;if(t.lazy&&t.lazy_draw(r),!t.lazy||!pref.test_mode[89]&&0==n){this.update_posts_insert(e.posts,t.posts,n,t.lazy?t.draw_1_pos(r)-1:r,t.pn);var s=t.get_class(e.key);s&&e.posts[n].pn.parentNode.classList.add(s)}return r<t.posts.length?t.posts.splice(r,0,e.posts[n]):t.posts[t.posts.length]=e.posts[n],r},update_posts_separate:function(e,t,n,r){for(var a=t.get_class(e.key,!0),s=0,o=0;o<e.posts.length;o++){var i=e.posts[o];s=t.posts.indexOf(i,s),s==-1&&(s=t.posts.indexOf(i));var l=s!=-1&&t.remove(s);t.isShown&&pref[cataLog.embed_mode].scroll_lock&&r.show_catalog_scroll_lock.modified(i),a&&i.pn.parentNode&&i.pn.parentNode.classList.remove(a),n?this.update_posts_insert(e.posts,[],o,o,n):l&&this.update_posts_remove(e,o,t.pn)}},short_link:function(){return""},page_json2html3_replace_expander:function(){},page_json2html3_add_omitted_info:function(){},post_json2html_fname_server:function(e){return e.tim+e.ext},post_json2html_fname:function(e){return e.filename+e.ext},post_com2txt_finisher:function(){var e=document.createElement("div");return function(t,n){return t.search(/&[#\w\d]+;/)==-1?t:(pref.debug_mode[17]&&console.log("not interpreted html: "+t),e.innerHTML=n&&n.com,e.textContent)}}(),post_com2txt:function(e){return e.com?this.post_com2txt_finisher(e.com.replace(/<[^>]*>/g," ").replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&amp;/g,"&"),e):""},patch:{},post_pn2ce:function(e){return"BLOCKQUOTE"===e.lastChild.tagName?e.lastChild:e.getElementsByTagName("blockquote")[0]},headline_json2html:function(e){var t=document.createElement("div");t.className=pref.script_prefix+"_headline",gGEH.pns_all_keys.set(t,e.key);var n=site2[e.domain].post_com2txt(e),r=(e.sub?"<b>"+e.sub+"</b>: ":"")+n,a=500-(e.sub?2:0);return r.length>=a&&(r=r.slice(0,a)+"..."),t.innerHTML=r,t},headline_merge:function(e,t,n){return 0===t.isShown&&(t.pn=cnst.dom('<div class="'+pref.script_prefix+"_merged "+pref.script_prefix+'_headline"></div>'),e.parentNode&&e.parentNode.insertBefore(t.pn,e)),1===t.isShown&&(t.footer=[t.pn.insertBefore(n.footer.add_menu(document.createElement("div")),t.pn.firstChild)]),t.pn.appendChild(e)},headline_separate:function(e,t){return e.pn.removeChild(t)}},site2.common={absorb_children:function(e){for(var t=document.createElement("div");0!=e.childNodes.length;)t.appendChild(e.childNodes[0]);return e.appendChild(t),t},disgorge_children:function(e){for(;0!=e.childNodes.length;)e.parentNode.appendChild(e.childNodes[0]);e.parentNode.removeChild(e)},remove_by_classname:function(e,t,n,r){void 0===n&&(n=0);for(var a=e.getElementsByClassName(t),s=a.length-1-n;s>=0;s--)r&&a[s].nextSibling&&"BR"===a[s].nextSibling.tagName&&a[s].parentNode.removeChild(a[s].nextSibling),a[s].parentNode.removeChild(a[s])},remove_by_tagname:function(e,t,n){void 0===n&&(n=0);for(var r=e.getElementsByTagName(t),a=r.length-1-n;a>=0;a--)r[a].parentNode.removeChild(r[a])},remove_by_attribute:function(e,t,n){for(var r=e.length-1;r>=0;r--)for(var a=e[r].childNodes.length-1;a>=0;a--)e[r].childNodes[a].getAttribute&&e[r].childNodes[a].getAttribute(t)&&e[r].childNodes[a].getAttribute(t).search(n)!=-1&&e[r].removeChild(e[r].childNodes[a])},remove_attribute:function(e,t){for(var n=e.getElementsByTagName("*"),r=n.length-1;r>=0;r--)n[r].getAttribute&&n[r].getAttribute(t)&&n[r].removeAttribute(t)},add_attribute_by_classname:function(e,t,n,r){for(var a=e.getElementsByClassName(t),s=a.length-1;s>=0;s--)a[s].setAttribute(n,r)},add_attribute_by_tagname:function(e,t,n,r){for(var a=e.getElementsByTagName(t),s=a.length-1;s>=0;s--)a[s].setAttribute(n,r)},add_attribute_by_attribute:function(e,t,n,r,a){for(var s=e.length-1;s>=0;s--)for(var o=e[s].childNodes.length-1;o>=0;o--)e[s].childNodes[o].getAttribute&&e[s].childNodes[o].getAttribute(t)&&e[s].childNodes[o].getAttribute(t).search(n)!=-1&&e[s].setAttribute(r,a)},move_up_and_delete_parent:function(e){for(var t=0;t<e.length;t++){var n=e[t].parentNode,r=n.parentNode;r.insertBefore(e[t],n),r.removeChild(n)}},remove_last_hrs_and_brs:function(e){for(;;){var t=e.childNodes[e.childNodes.length-1];if("HR"!==t.tagName&&"BR"!==t.tagName)break;e.removeChild(t)}},remove_brs:function(e){for(var t=e.getElementsByTagName("br"),n=t.length-1;n>=0;n--)t[n].parentNode.removeChild(t[n])},remove_double_br:function(e){for(var t=e.getElementsByTagName("*"),n=t.length-2;n>=0;n--)"<br>"===t[n].outerHTML&&t[n].nextSibling&&"BR"===t[n].nextSibling.tagName&&t[n].parentNode.removeChild(t[n].nextSibling)},remove_double_tags:function(e,t){for(var n=e.getElementsByTagName("*"),r=n.length-2;r>=0;r--)n[r].tagName===t&&n[r+1].tagName===t&&n[r+1].parentNode.removeChild(n[r+1])},change_utc_to_local:function(e){var t=new Date(e);return t.toLocaleString().replace(/\ /," ("+t.toString().replace(/\ .*/,"")+") ")}};var site4={parse_funcs_getters:{get no(){return this.exe_sub("no")},get key(){return this.exe_sub("key")},get time_bumped(){return this.exe_sub("time_bumped")},get nof_posts(){return this.exe_sub("nof_posts")},get nof_files(){return this.exe_sub("nof_files")},get time_created(){return this.exe_sub("time_created")},get posts(){return this.exe_sub("posts")},get sub(){return this.exe_sub("sub")},get name(){return this.exe_sub("name")},get com(){return this.exe_sub("com")},get flag(){return this.exe_sub("flag")},get flags(){return this.exe_sub("flags")},get footer(){return this.exe_sub("footer")},get sticky(){return this.exe_sub("sticky")},get time(){return this.exe_sub("time")},get time_posted(){return this.exe_sub("time_posted")},get tn_as(){return this.exe_sub2("tn_as")},get tn_imgs(){return this.exe_sub2("tn_imgs")},get op_img_url(){return this.exe_sub("op_img_url")},get txt(){return this.exe_sub("txt")},get time_tu(){return this.time*this.parse_funcs.time_unit},get lth(){return liveTag.mems[this.domain][this.board][this.no]},get type_mimic(){return this.type_parse},get key_op(){return this.domain+this.board+(this.resto||this.op||this.no)}},parse_funcs_on_demand:{},parse_funcs_on_demand_debug:{},parse_funcs_no_cache:{},parse_funcs_one_time:{}};site4.parse_funcs_on_demand={exe_sub:function(e){return Object.defineProperty(this,e,{value:this.parse_funcs[e](this),enumerable:!0,configurable:!0,writable:!0})[e]},exe_sub2:function(e){return this.parse_funcs_html[e](this)},__proto__:site4.parse_funcs_getters},site4.parse_funcs_on_demand_debug={exe_sub:function(e){try{return Object.defineProperty(this,e,{value:this.parse_funcs[e](this),enumerable:!0,configurable:!0,writable:!0})[e]}catch(t){console.log("parse_error: "+this.key+", "+this.type_parse+", "+e),console.trace(),console.log(this)}},exe_sub2:function(e){try{return this.parse_funcs_html[e](this)}catch(t){console.log("parse_error: "+this.key+", "+this.type_parse+", "+e),console.trace(),console.log(this)}},__proto__:site4.parse_funcs_getters},site4.parse_funcs_no_cache={exe_sub:function(e){return this.parse_funcs[e](this)},exe_sub2:function(e){return this.parse_funcs_html[e](this)},__proto__:site4.parse_funcs_getters},site4.parse_funcs_one_time={get posts(){return Object.defineProperty(this,"posts",{value:this.parse_funcs.posts(this),enumerable:!0,configurable:!0,writable:!0}).posts},exe_sub:function(e){return this.parse_funcs[e](this)},exe_sub2:function(e){return this.parse_funcs_html[e](this)},__proto__:site4.parse_funcs_getters},pref.features.domains["8chan"]&&(site2["8chan"]={nickname:"8chan",domain_url:"8ch.net",domain_url_image:"media.8ch.net",home:site.protocol+"//8ch.net"+(brwsr.ff?"/faq.html":"/favicon.ico"),protocol:site.protocol,features:{uip_tracker:!0},utilize_boards_json:!0,check_func:function(){var e=window.location.href;if(e.search(/8chan.co|8ch.net/)!=-1){if(site2["8chan"].domain_url=e.search(/8ch.net/)!=-1?"8ch.net":"8chan.co",this.home=site.protocol+"//"+this.domain_url+this.home.substr(this.home.lastIndexOf("/")),site.whereami=document.title.indexOf("404 - Page Not Found")!=-1?"404":e.search(/8ch\.net\/?$/)!=-1?"frame":e.search(/catalog\.html/)!=-1?"catalog":e.search(/res\/[0-9\+]*\.html/)!=-1?"thread":e.search(/8ch\.net\/index/)!=-1?"boards":e.search(/\/$|(index|[0-9]+)\.html|\/#all$/)!=-1?"page":e.search(/boards.html/)!=-1?"boards":"other",site.config(site2["8chan"].domain_url,"8chan"),site.header_height=function(){var e=document.getElementsByClassName("boardlist")[0];return e?e.offsetHeight:0},site.postform=document.getElementsByTagName("form")[0],site.postform&&this.postform_prep(),site.max_page=site2["8chan"].max_page(site.board),site.catalog=e.search(/catalog\.html/)!=-1,site.embed_to="thread"===site.whereami||"page"===site.whereami?{top:function(){return document.getElementsByName("postcontrols")[0]},bottom:function(){return document.getElementsByClassName("boardlist bottom")[0]}}:"catalog"===site.whereami?{top:function(){return document.getElementsByClassName("thumbnail")[0].nextSibling},bottom:function(){return document.getElementsByTagName("footer")[0]}}:{},site.components.boardlist&&(site.components.boardlist.style.zIndex=0),"boards"===site.whereami){var t=document.getElementById("search-form"),n=t.parentNode.parentNode.insertBefore(document.createElement("button"),t.parentNode);n.textContent="TagSearch";var r=document.createElement("div");r.innerHTML=pref_func.format_html_str('<BTN"tagSearch.genResult,Generate Result"><IC"tagSearch.auto">Auto, &lt;= <ITB4"tagSearch.th_b">boards or <ITB4"tagSearch.th_t">tags, Now: <span></span>');var a=r.lastChild;pref_func.apply_prep(r,!1),n.onclick=function(e){pref.catalog.board.board_tags=!0,pref_func.settings.onchange_funcs["tag.generate_caller"]("tag.scan");var t=liveTag.popup_filter.embed(r);t&&n.parentNode.insertBefore(t,n.nextSibling)};var s=document.getElementsByClassName("board-list-tbody")[0],o=function(e,t){function n(e){var t=e.slice(1);return'<a class="tag-link" href="/boards.php?tags='+t+'">'+t+"</a>"}var r=liveTag.tags_array_old.filter(function(e){return liveTag.tags[e.key].pn});if(0==r.length)return void(a.textContent="none");for(var o={},i=[],l=0;l<r.length;l++)for(var c=Object.keys(liveTag.tags[r[l].key].mems_boards()),p=0;p<c.length;p++){var _=c[p].replace(/^8chan/,"");void 0===o[_]&&(i[i.length]=_,o[_]=null)}if(
//            var bds = tags.map(function(v){return Object.keys(liveTag.tags[v.key].mems_boards()).map(function(v){return v.replace(/^8chan/,'');}).filter(function(bd){return bds_check[bd]===undefined && (bds_check[bd]=null || true);});}).reduce(function(a,c){return a.concat(c);});
a.textContent=i.length+" board"+(i.length>=2?"s":"")+", "+r.length+" tag"+(r.length>=2?"s":""),!t||site3["8chan"].boards&&!(i.length>pref.tagSearch.th_b&&r.length>pref.tagSearch.th_t)){var d=site3["8chan"].bds;d||(d={},site3["8chan"].boards.forEach(function(e){d["/"+e.uri+"/"]=e}),site3["8chan"].bds=d),s.innerHTML=i.map(function(e){return"/"!==e[0]?"":'<tr><td class="board-uri"><p class="board-cell"><a href="'+e+'">'+e+"</a>"+(1==d[e].sfw?'<i class="fa fa-briefcase board-sfw" title="SFW"></i>':"")+'</p></td><td class="board-title"><p class="board-cell" title="Created ">'+d[e].title+'</p></td><td class="board-pph"><p class="board-cell board-pph-desc" title="'+d[e].pph+" made in the last hour, "+d[e].pph_average+' on average">'+d[e].pph+'</p></td><td class="board-unique"><p class="board-cell">'+d[e].active+'</p></td><td class="board-tags"><p class="board-cell">'+d[e].tags.map(n).join("")+'</p></td><td class="board-max"><p class="board-cell">'+d[e].max+"</p></td></tr>"}).join("")}};r.firstChild.onclick=o,setTimeout(function(){liveTag.sub_tagSearch=function(){pref.tagSearch.auto&&o(0,!0)}},0)}return!0}return brwsr.ff||(this.protocol="https:",this.home=this.protocol+"//"+this.domain_url+this.home.substr(this.home.lastIndexOf("/"))),!1},postprocess_board:function(e){for(var t=0;t<e.length;t++)if(e[t].max>0){var n=liveTag.mems.init({domain:this.nickname,board:"/"+e[t].uri+"/"});n.o=t,e[t].pages&&!n.pgs&&(n.pgs=e[t].pages),Object.defineProperty(n,"max",{value:parseInt(e[t].max,10),writable:!0}),void 0===n.read_max&&Object.defineProperty(n,"read_max",{value:0,writable:!0}),e[t].tags&&0!=e[t].tags.length&&liveTag.postprocess_board_add_btag(e[t].tags,n)}},catalog_frame_prep:function(e){document.getElementsByTagName("header")[0].style.display="none",document.getElementsByClassName("footer")[0].style.display="none";var t=document.getElementsByClassName("menuCol")[0];t.firstChild.style.display="none";var n=document.getElementsByClassName("bodyCol")[0];n.firstChild.style.display="none",t.insertBefore(e,t.firstChild);this.catalog_native_frame_prep_frame(n,n.firstChild);this.catalog_embed_prep(e)},prep_own_posts_event:function(e){e&&"own_posts"===e.key&&site2["8chan"].prep_own_posts(),"8chan"===window.name&&send_message("parent",["OWN_POSTS",window.name,site3[window.name].own_posts])},prep_own_posts:function(){var e={},t=JSON.parse(localStorage.getItem("own_posts"));for(var n in t){var r="/"+n+"/";e[r]={};for(var a=0;a<t[n].length;a++)e[r][t[n][a]]=null}site3["8chan"].own_posts=e},preprocess_doc2:{thread_html:function(e){for(var t=e.getElementsByTagName("head")[0];t.firstChild;)t.removeChild(t.firstChild);for(var n=e.getElementsByTagName("body")[0],r=n.childNodes.length-1;r>=0;r--)"postcontrols"!==n.childNodes[r].name&&n.removeChild(n.childNodes[r])}},parse_funcs:{catalog_html:{before_test:["ths",":ITER",":ALL","ths",["key","time_bumped","nof_posts","nof_files"]],after_test:["time_created","sub","name","com","footer","sticky","format"],full_hier:["ths",":ITER",":ALL","ths",["key","time_bumped","nof_posts","nof_files","time_created","sub","name","com","footer","sticky","format"]],ths:function(e){var t=e.pn.getElementsByClassName("mix"),n=[];if(pref.test_mode[0])for(var r=0;r<t.length;r++)"DIV"===t[r].tagName&&(n[n.length]={pn:t[r],page:Math.floor(r/15)+"."+r%15});else{for(var r=0;r<t.length;r++)"DIV"===t[r].tagName&&(n[n.length]=t[r]);n=this.ths_array(e,n)}return n},th_init:function(e){var t=e.pn.getElementsByTagName("div")[0];t.className=t.className.replace(/grid\-size\-[a-z]*/,"grid-size-"+site2["8chan"].catalog_native_size)},no:function(e){return parseInt(e.pn.getAttribute("data-id"),10)},sticky:function(e){return"true"===e.pn.getAttribute("data-sticky")},posts:"DEFAULT.catalog_html",proto:"vichan.catalog_html"},catalog_json:{get_op_src:"thread_json",proto:"vichan.catalog_json"},page_html:{ths:function(e){var t=this.ths_array(e,e.pn.getElementsByClassName("thread"));if("page"!==site.whereami||!pref.catalog.embed_page)for(var n=0;n<t.length;n++)t[n].pn.removeAttribute("class");return t},filename:"thread_html",proto:"vichan.page_html"},page_json:{has_posts:!0,proto:"vichan.page_json"},thread_html:{filename:function(e){var t=[],n=(e.pn.classList.contains("op")?e.pn.parentNode:e.pn).getElementsByClassName("files")[0];if(n)for(var r=n.getElementsByClassName("postfilename"),a=0;a<r.length;a++)t[a]=r[a].textContent;if(t.length>1){e.extra_files=[];for(var a=1;a<t.length;a++)e.extra_files[a-1]={filename:t[a],__proto__:e.__proto__}}return t[0]},get_op_src:"thread_json",proto:"vichan.thread_html"},thread_json:{get_op_src:function(e){return e.op_img_url.replace("thumb","src").replace(".jpg",e.ext)},proto:"vichan.thread_json"}},update_posts_remove:function(e,t,n){n.removeChild(e.posts[t].pn.nextSibling),n.removeChild(e.posts[t].pn)},update_posts_insert:function(e,t,n,r,a){var s=1==r?t[0].pn.nextSibling||null:r<t.length?t[r].pn.nextSibling&&t[r].pn.nextSibling.nextSibling||null:null;e[n].pn||(e[n].pn=this.post_json2html(e[n],e[n].board)),a.insertBefore(e[n].pn,s),a.insertBefore(document.createElement("br"),s)},catalog_json2html3_thumbnail:function(e,t){return".jpg"===e.ext||".png"===e.ext||".jpeg"===e.ext||".gif"===e.ext||".webm"===e.ext||".mp4"===e.ext?this.protocol+"//"+(64!=e.tim.length?this.domain_url+t+"thumb/"+e.tim+(".gif"===e.ext?".gif":".jpg"):this.domain_url_image+"/file_store/thumb/"+e.tim+(".gif"===e.ext?".gif":".png"===e.ext?".png":".jpeg"===e.ext?".jpeg":".jpg")):e.embed?("//"==e.embed.slice(0,2)?"https:":"")+e.embed.replace(/.*src="/,"").replace(/".*/,""):".swf"===e.ext?"/static/file.png":""},short_link:function(){return""},favicon:{__proto__:site2.DEFAULT.favicon,none:"/favicon.ico",reply:"png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAQElEQVR42mNgGEbg/5n/GJgYORQFDQ0IjK4BmxxWzehsQnJYBdFtxCWH1QBcrkKWw2sAWS6gKAwojgWqpIORDQBVkjfW5KYpFQAAAABJRU5ErkJggg==",reply_to_me:"png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAWUlEQVR42mNgAIH/Z/4zNDRgYpA4UQBqADIYZAaAaHRMtAEwjB42cEPQFaCzCclhFcQWK9jk0A1A8QJW2xgYiDeAJBdQFAbYAhLdRryxgByVuOKaYDoY2QAAcHCIXLRHYMUAAAAASUVORK5CYII="},proto:"vichan"},site2["8chan_live"]={parse_funcs:{thread_html:{posts:function(e){return this.posts_array(e,e.pn.querySelectorAll(":scope>.post.reply"))},proto:"8chan.thread_html"}},proto:"8chan"}),(pref.features.domains["8chan"]||pref.features.domains.lain||pref.features.domains.lainjp)&&(site2.vichan={components:{boardlist:".boardlist",postform_comment:['textarea[name="body"]',0],postform_comment2:['textarea[name="body"]',1],postform_submit:['input[name="post"]',0],postform_submit2:['input[name="post"]',1]},general_event_handler:function(){var e={thread:{get_mark:function(e,t){for(;e&&e!==cataLog.parent;)if("BR"!==e.tagName&&e.classList){if(e.classList.contains("post"))return e;if(e.classList.contains("postcontainer"))return e.getElementsByClassName("post")[0];if(e.parentNode&&e.parentNode.id&&e.parentNode.id.search(/^thread/)!=-1){if(e=e.previousSibling)continue;break}if(e.id&&e.id.search(/^thread/)!=-1)break;e=e.parentNode}else e=e.previousSibling||e.parentNode;return this.get_mark_from_height(t)},get_mark_from_height:function(e){return this.__proto__.get_mark_from_height(e,document.getElementsByClassName("post"))},image_hover_check_mode:function(e){return e.parentNode.parentNode.classList.contains("file")?"page":"catalog"},getID:function(e){return e.classList.contains("poster_id")&&e.textContent},__proto__:site2.DEFAULT.general_event_handler.common}};return e.page={add_mouseover:pref.test_mode[68],mouseover:function(e){var t=e.target;"A"===t.tagName&&pref[cataLog.embed_mode].popup_truncated&&"toolong"===t.parentNode.className&&site2.DEFAULT.popups_posts.over(e)},__proto__:e.thread},e.catalog=Object.create(e.thread),e}(),boards_sel_from_tags:function(){for(var e=document.getElementsByClassName("board-list-tbody")[0],t="SELECTED_BOARDS,",n=0;n<e.childNodes.length;n++)"none"!==e.childNodes[n].style.display&&(t=t+"8chan"+e.childNodes[n].getElementsByClassName("board-uri")[0].getElementsByTagName("a")[0].getAttribute("href")+",");return t+"\n"},get_next_image:function(e,t){var n=Array.prototype.slice.call(cataLog.parent.getElementsByClassName("post-image")).filter(function(e){return".webm"!==e.src.substr(-5,5)});return site2.DEFAULT.get_next_image(e,t,n)},modify_thread_link:function(e){var t=e.getElementsByClassName("post op");if(0==t.length)return[];var n=[];t=t[0].getElementsByTagName("a");for(var r=t.length-1;r>=0;r--)if("[Reply]"==t[r].innerHTML||"[Last 50 Posts]"==t[r].innerHTML){var a=t[r].getAttribute("href");a&&(n.push([t[r],a]),t[r].removeAttribute("href"))}return n},catalog_threads_in_page:function(e){for(var t={domain:site.nickname,pn:e},n=this.parse_funcs.page_html.ths(t),r=0;r<n.length;r++)n[r]=n[r].pn;return n},remove_posts:function(e,t){site2.common.remove_by_classname(e,"post reply",t,!0)},remove_files_info:function(e){site2.common.remove_by_classname(e,"fileinfo"),site2.common.move_up_and_delete_parent(e.getElementsByClassName("post-image"))},postform_rules:null,thread_keyword:"res",max_page:function(){return 15},make_url4:function(e){var t=this.protocol+"//"+this.domain_url+e[1];return"page_html"===e[3]?[t+(0!=e[2]?parseInt(e[2],10)+1:"index")+".html","html"]:"page_json"===e[3]?[t+parseInt(e[2],10)+".json","json"]:"catalog_json"===e[3]?[t+"catalog.json","json"]:"catalog_html"===e[3]?[t+"catalog.html","html"]:"thread_html"===e[3]?[t+"res/"+e[2]+".html","html"]:"thread_json"===e[3]?[t+"res/"+e[2]+".json","json"]:void 0},url_boards_json:function(){return[site2["8chan"].protocol+"//"+site2["8chan"].domain_url+"/boards.json","json"]},get_ops:function(e){for(var t=e.getElementsByClassName("post op"),n=[],r=0;r<t.length;r++)n.push(parseInt(t[r].id.substring(3),10));return n},get_posts:function(e){for(var t=[],n=e.getElementsByClassName("post_no"),r=0;r<n.length;r++)n[r].id&&t.push(parseInt(n[r].id.substr(8),10));return t},get_post_offsetTop:function(e,t){return e.getElementsByClassName("post")[t].offsetTop},get_icon:function(e,t,n,r){return"sticky"===n?e.getElementsByClassName("fa-thumb-tack")[0]:null},add_icon:function(e,t,n,r){var a,s="sticky"===n?this.make_tack():this.make_showAlways();if("catalog"===t||"headline"===t)a=e.getElementsByClassName("threadIcons")[0]||(a="catalog"===t?e.firstElementChild:e,a.insertBefore(cnst.dom('<div class="threadIcons"'+("catalog"===t?'style="position:absolute"':"")+"></div>"),a.firstChild)),a.appendChild(s);else{var o=e.getElementsByClassName("op")[0];a=o.getElementsByClassName("mentioned")[0]||o.getElementsByClassName("post_no")[1].nextSibling,a.parentNode.insertBefore(s,a)}return s},favicon:{__proto__:site2.DEFAULT.favicon,none:"/favicon.ico",reply:"png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAQElEQVR42mNgGEbg/5n/GJgYORQFDQ0IjK4BmxxWzehsQnJYBdFtxCWH1QBcrkKWw2sAWS6gKAwojgWqpIORDQBVkjfW5KYpFQAAAABJRU5ErkJggg==",reply_to_me:"png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAWUlEQVR42mNgAIH/Z/4zNDRgYpA4UQBqADIYZAaAaHRMtAEwjB42cEPQFaCzCclhFcQWK9jk0A1A8QJW2xgYiDeAJBdQFAbYAhLdRryxgByVuOKaYDoY2QAAcHCIXLRHYMUAAAAASUVORK5CYII="},time_revised_check:function(e){return e>300},format_thread_layout:function(e){site2.common.add_attribute_by_tagname(e,"img","style","margin:0px"),site2.common.add_attribute_by_tagname(e,"iframe","style","margin:0px"),site2.common.add_attribute_by_classname(e,"post","style","padding:0px"),site2.common.add_attribute_by_classname(e,"intro","style","margin:0px"),site2.common.add_attribute_by_classname(e,"body","style","margin:12px 5px")},format_thread_contents:function(e){site2.common.remove_by_classname(e,"delete"),site2.common.remove_by_classname(e,"omitted")},localtime:function(e){for(var t=e.getElementsByTagName("time"),n=0;n<t.length;n++)t[n].textContent=site2.common.change_utc_to_local(t[n].getAttribute("datetime"))},format_remove_tn_area_size:function(e){for(var t=e.getElementsByClassName("file"),n=0;n<t.length;n++){var r=t[n].getAttribute("style");r&&(r=(r?r+";":"")+"float:left;",r.indexOf("width")!=-1&&(r=r.replace(/width:[^;]*(;|$)/,"")),r.indexOf("height")!=-1&&(r=r.replace(/height:[^;]*(;|$)/,"")),t[n].setAttribute("style",r))}},get_owners_recommendation:function(){if(document.getElementsByClassName("blotter")[0]){or_str=document.getElementsByClassName("blotter")[0][brwsr.innerText];var e="Recommendation: ",t=or_str.indexOf(e);if(t!=-1)return or_str.substr(t+e.length)}return""},get_json_url_catalog:function(e){return site2["8chan"].protocol+"//"+site2["8chan"].domain_url+e+"catalog.json"},thread2search_obj:function(e){function t(e){if(0!=e.length){for(var t=e[0].parentNode;t.classList.contains("post");)t=t.parentNode;for(var n=t.classList.contains("op")?-1:0,r=n>=0?e[0][brwsr.innerText]:"",a="",s=n+1;s<e.length;s++)a=a+e[s][brwsr.innerText]+"\n";return[r,a]}return["",""]}var n=t(e.getElementsByClassName("body")),r=t(e.getElementsByClassName("subject")),a=t(e.getElementsByClassName("name")),s=e.getElementsByClassName("files"),o=["",""];if(0!=s.length){for(var i=0;i<s.length;i++){var l=s[i].getElementsByClassName("unimportant");o[i]="";for(var c=0;c<l.length;c++)0!=l[c].getElementsByTagName("a").length&&(o[i]=o[i]+l[c].getElementsByTagName("a")[0][brwsr.innerText]+"\n"),0!=l[c].getElementsByTagName("span").length&&(o[i]=o[i]+l[c].getElementsByTagName("span")[0][brwsr.innerText]+"\n")}for(var i=2;i<o.length;i++)o[1]=o[1]+o[i]+"\n";s[0].parentNode!=e&&(o[1]=o[0]+"\n"+o[1],o[0]="")}return[n[0],r[0],a[0],o[0],n[1],r[1],a[1],o[1]]},parse_json_thread:function(e,t){for(var n={posts:[]},r={},a=0,s=document.getElementsByClassName("post"),o=0;o<s.length;o++){n.posts[o]={},n.posts[o].no=s[o].id.replace(/op_/,"").replace(/reply_/,"");var i=s[o].getElementsByClassName("poster_id")[0].textContent;n.posts[o].id=i,void 0===r[i]&&(a++,r[i]=1),n.posts[o].unique_ips=a}return n},uip_check:function(e){e(0,200,"")},uip_tgt_post:function(e){var t=document.getElementById("reply_"+e);return t?t:document.getElementById("op_"+e)},uip_post_num:function(e){return e.getElementsByClassName("intro")},catalog_native_prep:function(e,t,n,r,a){var s="catalog"===site.whereami?document.getElementsByClassName("threads")[0]:document.getElementsByName("postcontrols")[0];if(site2.DEFAULT.catalog_native_prep_sel(t,n,"catalog"===site.whereami?document.getElementById("sort_by"):null),"catalog"===site.whereami)n.style.display="inline",n.childNodes[3].style.display="inline";else if("page"===site.whereami){var o=document.getElementsByName("postcontrols")[0];if(!pref.catalog_expand_with_hr||a)for(var i=o.childNodes.length-1;i>=0;i--)"HR"===o.childNodes[i].tagName&&o.removeChild(o.childNodes[i]);else for(var i=o.childNodes.length-1;i>=0;i--)"HR"===o.childNodes[i].tagName&&o.childNodes[i].setAttribute("class",pref.script_prefix+"_hs");o.parentNode.insertBefore(document.createElement("hr"),o.nextSibling)}s.parentNode.insertBefore(n,s)},catalog_native_size:document.getElementById("image_size")?document.getElementById("image_size").value:"small",catalog_native_size_changed:function(){site2["8chan"].catalog_native_size=this.value},catalog_get_native_area:function(){return"catalog"===site.whereami?document.getElementById("Grid"):document.getElementsByName("postcontrols")[0]},parse_funcs:{catalog_html:{ths:function(e){return this.ths_array(e,e.pn.getElementsByClassName("mix"))},no:function(e){return parseInt(e.pn.getElementsByTagName("img")[0].id.substr(4),10)},time_bumped:function(e){return 1e3*parseInt(e.pn.getAttribute("data-bump"),10)},time:function(e){return parseInt(e.pn.getAttribute("data-time"),10)},time_created:function(e){return 1e3*e.time},nof_posts:function(e){return parseInt(e.pn.getAttribute("data-reply"),10)+1},nof_files:function(e){return parseInt(e.pn.getElementsByTagName("strong")[0].textContent.replace(/.*I: */,""),10)+1},key:function(e){return pref.test_mode[0]&&(e.hasOwnProperty("no")||Object.defineProperty(e,"no",{value:this.no(e),enumerable:!0,configurable:!0,writable:!0})),e.domain+e.board+e.no},sub:"DEFAULT.post_html",name:function(e){return e.pn.getElementsByTagName("img")[0].getAttribute("data-name")},com:function(e){return e.pn.getElementsByClassName("replies")[0].innerHTML.replace(/\s*<strong>[^<]*<\/strong>\s*(<br>)*/,"").replace(/\s*$/,"")},type_com:"html",footer:function(e){return e.pn.getElementsByTagName("strong")[0]},sticky:function(e){return null},op_img_url:function(e){var t=e.pn.getElementsByTagName("img")[0];return t?t.getAttribute("src"):void 0},dynamic_image_hover:!0,missing_info:2,img2src:function(e){var t=this.get_lth_from_node(e);if(!t)return null;var n=e.src;return t.th&&t.th.ext?n=n.replace(/thumb/,"src").replace(/.[^\.]*$/,t.th.ext):t.th.missing_info&&scan.scan_ui("image_hover",{tgts:[t.domain+t.board+"j0"],options:{callback:function(){cataLog.image_hover_reentry(e)},priority:6}}),n},get_op_src:"thread_json",time_unit:1e3},catalog_json:{before_test:["ths",":ITER",":ALL","ths",["key","time_bumped","nof_posts","nof_files"]],after_test:["time_created","pn","footer"],full_hier:["ths",":ITER",":ALL","ths",["key","time_bumped","nof_posts","nof_files","pn","footer"]],ths:"DEFAULT.catalog_json",time_bumped:function(e){return 1e3*e.last_modified},time_created:function(e){return 1e3*e.time},nof_posts:function(e){return e.replies+1},nof_files:function(e){return e.images+e.omitted_images},key:function(e){return e.domain+e.board+e.no},sub:function(e){return e.hasOwnProperty("sub")?e.sub:""},name:function(e){return e.hasOwnProperty("name")?e.name:""},com:function(e){return e.hasOwnProperty("com")?e.com:""},op_img_url:"DEFAULT.common",missing_info:1,get_op_src:"thread_json",time_unit:1e3,type_com:"html",posts:"DEFAULT.catalog_json",posts_full:"DEFAULT.catalog_json",get_max_page:function(e){return e.length},proto:"catalog_html"},page_json:{has_posts:!0,nof_posts:"DEFAULT.thread_json",nof_files:function(e){return e.posts[0].images+e.posts[0].omitted_images},ths:"DEFAULT.page_json",proto:"thread_json"},page_html:{before_test:["ths",":ITER",":ALL","ths",["key","time_bumped","nof_posts","nof_files"]],after_test:["time_created",":ITER",":ALL","posts",["sub","name","com","flag"],":ITER",":GALL","posts",["flags","flag"]],before_test_post:["posts",":ITER",":FL","posts",["time"],"html_org","footer"],ths:function(e){return this.ths_array(e,e.pn.querySelectorAll("div[id^=thread_]"))},th_init:function(e){"page"===site.whereami&&pref.catalog.embed_page||e.pn.removeAttribute("class")},no:"post_html",time:function(e){var t=e.pn.getElementsByTagName("time")[0];return t?Date.parse(t.getAttribute("datetime"))/1e3:void 0},time_unit:1e3,time_bumped:function(e){for(var t=e.posts.length;--t>=0;){var n=e.posts[t].pn.getElementsByClassName("email")[0];if(!n||"mailto:sage"!==n.href)return e.posts[t].time}},time_created:function(e){return pref.test_mode[0]&&(e.hasOwnProperty("posts")||this.entry(e,this.before_test_post)),e.posts[0].time},nof_posts:function(e){var t=e.pn.getElementsByClassName("post").length,n=e.pn.getElementsByClassName("fileinfo").length,r=e.pn.getElementsByClassName("omitted")[0];if(r){var a=r.childNodes[0].textContent.replace(/\n/g,"");t+=parseInt(a.replace(/\ post.*/,""),10)||0,n+=parseInt("0"+a.replace(/\ image.*/,"").replace(/[^\ ]*\ /g,""),10)||0}return Object.defineProperty(e,"nof_files",{value:n,enumerable:!0,configurable:!0,writable:!0}),t},nof_files:function(e){return e.hasOwnProperty("nof_posts")||this.nof_posts(e),e.nof_files},key:function(e){return pref.test_mode[0]&&(e.hasOwnProperty("no")||Object.defineProperty(e,"no",{value:this.no(e),enumerable:!0,configurable:!0,writable:!0})),e.domain+e.board+e.no},sub:"DEFAULT.post_html",com:function(e){var t=e.pn.getElementsByClassName("body")[0];return t?t.innerHTML:""},type_com:"html",footer:function(e){return this.insert_footer4(e.pn.getElementsByClassName("post op")[0])},sticky:function(e){return 0!=e.pn.getElementsByClassName("fa-thumb-tack").length},flag:"post_html",op_img_url:function(e){var t=e.pn.getElementsByTagName("img");if(t.length>=2){e.op_img_url2=[];for(var n=1;n<t.length;n++){var r=t[n].getAttribute("src");r&&(e.op_img_url2[e.op_img_url2.length]=r)}}return t&&t[0]?t[0].getAttribute("src"):void 0},tn_as:function(e){return e.tn_imgs},tn_imgs:function(e){var t=[],n=(e.pn.classList.contains("op")?e.pn.parentNode:e.pn).getElementsByClassName("files")[0];if(n){n=n.getElementsByClassName("file");for(var r=0;r<n.length;r++){var a=n[r].getElementsByTagName("img")[0]||n[r].getElementsByTagName("video")[0];a&&(t[t.length]=a)}}return t},get_thread_links:function(e){for(var t=[],n=e.pn.getElementsByClassName("post op")[0].getElementsByTagName("a"),r=0;r<n.length;r++)"[Reply]"===n[r].textContent&&t.unshift(n[r]),"[Last 50 Posts]"===n[r].textContent&&t.push(n[r]),n[r].classList.contains(pref.script_prefix+"_link")&&t.push(n[r]);return t},get_omitted_info:function(e){return e.pn.getElementsByClassName("omitted")[0]},set_omitted_info:function(e,t){e.pn.lastChild.appendChild(t)},replace_omitted_info2:function(e,t){e.childNodes[0].textContent=t?t.childNodes[0].textContent:""},filename:"thread_html",get_op_src:"thread_json",id:"DEFAULT.thread_html",country:"DEFAULT.thread_html",trip:"DEFAULT.thread_html",flag:"DEFAULT.thread_html",name:"DEFAULT.thread_html",pn_name:"post_html"},thread_html:{after_test:["time_created",":ITER",":FLx","posts",["sub","name","com","flag"],":ITER",":GFLx","posts",["flags","flag"]],get_op_src:"thread_json",filename:function(e){var t=(e.pn.classList.contains("op")?e.pn.parentNode:e.pn).getElementsByClassName("files")[0];if(t){t=t.querySelectorAll(":scope>.file");for(var n=0;n<t.length;n++){var r=t[n].getElementsByTagName("a")[0];if(r){r=r.textContent,1===n&&(e.extra_files=[]),n>=1&&(e.extra_files[n-1]={domain:e.domain,board:e.board});var a=0===n?e:e.extra_files[n-1];a.filename="lain"===e.domain?t[n].getElementsByTagName("a")[1].getAttribute("download"):t[n].getElementsByClassName("postfilename")[0].textContent.replace(/\..*/,""),a.ext=r.substr(r.indexOf(".")),a.tim=r.substr(0,r.indexOf("."));var s="lainjp"!==e.domain?t[n].getElementsByClassName("details")[0].textContent.split(","):t[n].getElementsByClassName("unimportant")[0].textContent.split(",");a.w=parseInt(s[1].substr(0,s[1].indexOf("x")),10),a.h=parseInt(s[1].substr(s[1].indexOf("x")+1),10);var o=s[0].split(/\s/);o[1]="KB"===o[1]?1024:"MB"===o[1]?1048576:1,a.fsize=parseFloat(o[0].replace(/\(/,""))*o[1];var i=t[n].querySelector("img.post-image");i&&(a.tn_w=parseInt(i.style.width,10),a.tn_h=parseInt(i.style.height,10))}}}return t?e.filename:void 0},proto:"page_html"},thread_json:{nof_posts:function(e){return e.posts.length},nof_files:function(e){for(var t=0,n=1;n<e.posts.length;n++)e.posts[n].filename&&t++,e.posts[n].extra_files&&(t+=e.posts[n].extra_files.length);return t},add_op_img_url:site2.DEFAULT.parse_parts.add_op_img_url,get_op_src:function(e,t){return!e.ext&&e.missing_info&&scan.scan_ui("image_hover",{tgts:[e.domain+e.board+"j0"],options:{callback:function(){cataLog.image_hover_reentry(t)},priority:6}}),e.ext?e.op_img_url.replace("thumb","src").replace(".png",e.ext):t.src},pn_name:"post_html",proto:"DEFAULT.thread_json"},post_html:{no:function(e){var t=e.pn.getAttribute("id");return parseInt(t.substring(t.indexOf("_")+1),10)},name:function(e){return e.pn_name?e.pn_name.textContent:""},pn_name:function(e){return e.pn.getElementsByClassName("name")[0]},time_pn:function(e){return Date.parse(e.getElementsByTagName("time")[0].getAttribute("datetime"))},txt2com_spoiler_replace_txt:'<span class="spoiler">$1</span>',flag:function(e){return e.pn.getElementsByClassName("flag")[0]},pn_id:function(e){return e.pn.getElementsByClassName("poster_id")[0]},id:function(e){return e.pn_id?e.pn_id.textContent:void 0},time:"page_html",time_unit:1e3,proto:"DEFAULT.post_html"},post_json:{proto:"DEFAULT.post_json"}},update_posts_remove:function(e,t,n,r){var a=e.posts[t].pn;r&&a.parentNode===n?this.update_posts_insert_pack(a):a=a.parentNode,n.removeChild(a.nextSibling),n.removeChild(a)},update_posts_insert:function(e,t,n,r,a){var s=r<t.length?t[r].pn:null,o=s&&s.parentNode;o&&o!==a&&(s=o),r>=t.length&&(s=a.getElementsByClassName("clear")[0]),e[n].pn||(e[n].pn=this.post_json2html(e[n],e[n].board)),0===n&&this.update_posts_insert_pack(e[n].pn),0===r&&t[0]&&this.update_posts_insert_pack(t[0].pn);var i=0===r&&0===n?e[n].pn:this.post_container(e[n].pn,e[n].no);a.insertBefore(i,s),a.insertBefore(document.createElement("br"),s),0===n&&0===r&&this.update_posts_insert_unpack(e[n].pn)},update_posts0_class:function(e,t){site2.DEFAULT.update_posts0_class(e,t),this.update_posts_insert_pack_iter(e,t?function(e){e.classList.remove("CatChan_search_miss")}:function(e){e.classList.add("CatChan_search_miss")})},update_posts_insert_pack:function(e){this.update_posts_insert_pack_iter(e,function(t){e.insertBefore(t,e.firstChild)})},update_posts_insert_pack_iter:function(e,t){for(var n=e.previousSibling;n;){var r=n.previousSibling;if(n.classList&&(n.classList.contains(pref.script_prefix+"_footer")||n.classList.contains("files"))&&t(n),n.classList&&n.classList.contains("op"))break;n=r}},update_posts_insert_unpack:function(e){for(;;){var t=e.firstChild;if(!t||!t.classList||!t.classList.contains(pref.script_prefix+"_footer")&&!t.classList.contains("files"))break;e.parentNode.insertBefore(t,e)}},add_backlinks_bks:function(){var e=document.createElement("span");return e.setAttribute("class","mentioned unimportant"),function(){return e.cloneNode(!1)}}(),add_backlinks_add_1:function(){var e=document.createElement("a");return e.setAttribute("class","mentioned"),function(t,n){var r=e.cloneNode(!0);r.setAttribute("href",n[5]),r.textContent=n[4],r.onclick=this.backlink_onclick,t.appendChild(r)}}(),add_backlinks_bks_query:function(e){return e.getElementsByClassName("mentioned")[0]},add_backlinks_bks_append:function(e,t){var n=e.getElementsByClassName("post_no")[1],r=n.parentNode;do{n=n.nextSibling}while(n&&"I"===n.tagName);r.insertBefore(t,n)},popups_href2dbtp:function(e){var t=e.split("/"),n=t[t.length-1].substr(t[t.length-1].indexOf("#")+1),r=t[t.length-1].substr(0,t[t.length-1].indexOf("."))||"#"===e[0]&&site.no,a=t.length>=3?"/"+t[t.length-3]+"/":site.board;return[this.nickname,a,r,n]},link_dbtp2href:function(e){return e[1]+"res/"+e[2]+".html#"+e[3]},backlink_onclick:function(){highlightReply.call(this,parseInt(this.textContent.substr(2),10))},colorID:function(e){var t=e.getElementsByClassName("poster_id")[0];if(t){var n=t.textContent,r=parseInt(n.substr(0,2),16),a=parseInt(n.substr(2,2),16),s=parseInt(n.substr(4,2),16),o=r+a+s>384?0:255;t.setAttribute("style","padding: 0px 5px; border-radius: 8px; color: rgb("+o+","+o+","+o+"); background-color: rgb("+r+","+a+","+s+");")}},post_container:function(e,t){var n=document.createElement("div");return n.setAttribute("id","pc"+t),n.setAttribute("class","postcontainer"),n.innerHTML='<div class="sidearrows">&gt;&gt;</div>',n.appendChild(e),n},short_link:function(e,t,n,r,a){var s=common_func.fullname2dbt(e);return t>100?'<a href="'+s[1]+"res/"+s[2]+'+50.html" class="'+pref.script_prefix+'_link">'+r+"50"+a+"</a>":""},post_json2html:function(e,t,n,r){var a=document.createElement("div"),s=e.parse_funcs&&e.parse_funcs.time_unit||1,o=new Date((e.time||0)*s),i='<div class="post '+(n?"op":"reply")+'" id="reply_'+e.no+'" style="border: none"><p class="intro"><input type="checkbox" class="delete" name="delete_'+e.no+'" id="delete_'+e.no+'"><label for="delete_'+e.no+'">'+(e.sub?'<span class="subject">'+e.sub+" </span>":"")+(e.email?'<a class="email" href="mailto:'+e.email+'">':"")+'<span class="name">'+(e.name||"")+"</span>"+(e.trip?'<span class="trip">'+e.trip+"</span>":"")+(e.capcode?'<span class="capcode" style="color:orange;font-weight:bold">## '+e.capcode+"</span>":"")+(e.email?"</a> ":" ")+(e.country?'<img class="flag flag-'+e.country.toLowerCase()+'" src="/static/blank.gif" style="width:16px;height:11px;" alt="'+e.country_name+'" title="'+e.country_name+'"> ':" ")+'<time datetime="'+o.toISOString()+'">'+o.toLocaleString()+"</time></label>"+(e.id?'<span class="poster_id">'+e.id+"</span>":"")+'&nbsp;<a class="post_no" id="post_no_'+e.no+'">No.</a><a class="post_no">'+e.no+"</a>"+(n?'<a href="'+site2[e.domain].make_url4([e.domain,t,e.no,"thread_html"])[0]+'">[Reply]</a>'+(r?r:""):"")+"</p>";if(e.filename){if(i+='<div class="files">'+this.post_json2html_file(e,t,e.extra_files),e.extra_files)for(var l=0;l<e.extra_files.length;l++)i+=this.post_json2html_file(e.extra_files[l],t,!0);i+="</div>"}return i+='<div class="body">'+(e.com?e.com:"")+"</div></div>",a.innerHTML=i,a.childNodes[0]},post_pn2ce:function(e){return"body"===e.lastChild.className?e.lastChild:e.getElementsByClassName("body")[0]},post_json2html_file:function(e,t,n){var r=(.005+(e.fsize>1048576?e.fsize/1048576:e.fsize/1024)).toString();r=r.substr(0,r.indexOf(".")+3)+(e.fsize>1048576?" MB":" KB");var a=site2[e.domain].post_json2html_fname_server(e),s=site2[e.domain].post_json2html_fname(e),o=site2[e.domain].catalog_json2html3_src(e,t),i=site2[e.domain].catalog_json2html3_thumbnail(e,t);return'<div class="file'+(n?" multifile":"")+'"'+(n?' style="width:'+(e.tn_w+40)+'px"':"")+'><p class="fileinfo">File: <a href="'+o+'">'+a+'</a> <span class="details">('+r+", "+e.w+"x"+e.h+', <span class="postfilename">'+s+'</span>) </span></p><a href="'+o+'" target="_blank">'+(".webm"!==e.ext?'<img class="post-image" src="'+i+'" style="width: '+e.tn_w+"px; height: "+e.tn_h+'px; max-width: 98%;" alt=""'+(128===e.tn_w&&128===e.tn_h?"onerror=\"this.onerror=null;this.src='/static/spoiler.png';\"":"")+">":'<video class="post-image" src="'+o+'" style="width: '+e.tn_w+"px; height: "+e.tn_h+'px; max-width: 98%;">')+"</a></div>"},page_json2html3_skelton:function(e,t){var n=document.createElement("div");n.setAttribute("class","thread"),n.setAttribute("id","thread_"+e.no),n.setAttribute("data-board",e.board.slice(1,-1));var r=document.createElement("br");return r.setAttribute("class","clear"),n.appendChild(r),n.appendChild(document.createElement("hr")),t?[n,r]:n},page_json2html3:function(e,t,n,r){var a=this.page_json2html3_skelton(e,!0),s=a[0],o=a[1],i=this.post_json2html(e.posts&&e.posts[0]?e.posts[0]:e,e.board,!0,site2[e.domain].short_link(e.key,e.nof_posts,2,"[Last "," Posts]")),l=i.getElementsByClassName("files")[0];if(l&&s.insertBefore(l,o),t&&e.posts[0].pn&&(i=e.posts[0].pn.cloneNode(!0)),i.setAttribute("class","post op"),e.posts&&e.posts[0]&&e.posts[0].extra_files&&i.setAttribute("style","clear:both;"),s.insertBefore(i,o),e.posts[0].pn=i,e.posts){for(var c=1;c<e.posts.length;c++){var p=t&&e.posts[c].pn&&e.posts[c].pn.cloneNode(!0)||this.post_json2html(e.posts[c],e.board);s.insertBefore(this.post_container(p,e.posts[c].no),o),s.insertBefore(document.createElement("br"),o),e.posts[c].pn=p}this.page_json2html3_add_omitted_info(e,n,r)}return s},page_json2html3_replace_expander:function(e,t,n){var r=e[0].pn.getElementsByClassName("omitted")[0];r&&(r.childNodes.length>=3&&r.removeChild(r.childNodes[2]),r.childNodes.length>=2&&r.removeChild(r.childNodes[1]),r.appendChild(cnst.config_expander(n,t)))},page_json2html3_add_omitted_info:function(e,t,n){for(var r=e.posts,a=0,s=1;s<r.length;s++)a+="html"===r[s].type_data?r[s].pn.getElementsByClassName("file").length:r[s].filename?r[s].extra_files?r[s].extra_files.length+1:1:0;var o=r.filter(function(e){return e.deleted_after}),i=e.nof_files-a+o.reduce(function(e,t){return e+(t.filename?t.extra_files?t.extra_files.length+1:1:0)},0),l=e.nof_posts-r.length+o.length;site2[t&&t.domain_html||e.domain_html].page_json2html3_add_omitted_info_html(e,t,n,l,i)},page_json2html3_add_omitted_info_html:function(e,t,n,r,a){if(!pref.test_mode[140]){var s=e.posts.pn&&e.posts,o=s?s[0].pn.getElementsByClassName("omitted")[0]:null;return 0!=r?(o||(o=document.createElement("span"),o.setAttribute("class","omitted"),o.innerHTML="dummy",o.appendChild(cnst.config_expander(e.key)),s&&s[0].pn.appendChild(o)),o.childNodes[0].textContent=r+" post"+(1!==r?"s":"")+(a?" and "+a+" image repl"+(1===a?"y":"ies"):"")+" omitted. "):o&&(o.childNodes[0].textContent="Showing all posts."),o}
if(!t.pn_summary&&(r>0||n)){var i=t.posts?t.posts[0]:e.posts[0],o=i.pn.getElementsByClassName("omitted")[0];o||(o=document.createElement("span"),o.setAttribute("class","omitted"),o.innerHTML="dummy",o.appendChild(cnst.config_expander(e.key)),i.pn.appendChild(o)),t.pn_summary=o.childNodes[0]}t.pn_summary&&(t.pn_summary.textContent=r<=0?"Showing all replies.":r+" post"+(1!==r?"s":"")+(a?" and "+a+" image repl"+(1===a?"y":"ies"):"")+" omitted. ")},catalog_json2html3_thumbnail:function(e,t){return".jpg"===e.ext||".jpeg"===e.ext||".gif"===e.ext||".png"===e.ext?"https://"+this.domain_url+t+"thumb/"+e.tim+e.ext:""},catalog_json2html3_src:function(e,t){return".jpg"===e.ext||".jpeg"===e.ext||".gif"===e.ext||".png"===e.ext||".webm"===e.ext?"https://"+this.domain_url+t+"src/"+e.tim+e.ext:""},catalog_json2html3:function(e,t,n,r){var a=document.createElement("div");return a.setAttribute("class","mix"),a.setAttribute("style","display: inline-block;"),a.innerHTML='<div class="thread grid-li grid-size-'+site2[site.nickname].catalog_native_size+'"><a href="'+site2[e.domain].make_url4([e.domain,e.board,e.no,"thread_html"])[0]+'"><img src="'+n+'" id="img-'+e.no+'" data-subject="'+e.sub+'" data-name="'+e.name+'" data-muhdifference="" data-last-reply="" data-last-subject="" data-last-name="" data-last-difference=""class="'+t+' thread-image" title="'+new Date(1e3*e.last_modified).toLocaleString()+" "+e.ext+'"></a><div class="replies"><strong>'+(r?" R: "+(e.nof_posts-1)+" / I: "+e.nof_files:"")+"</strong>"+(e.sub?'<p class="intro"><span class="subject">'+e.sub+"</span></p>":"<br>")+e.com+"</div></div>",a},catalog_from_json3:function(e,t){var n;return pref.test_mode[0]?(n={domain:"8chan",board:site.board,obj:e},this.parse_funcs.catalog_json.entry(n,this.parse_funcs.catalog_json.full_hier),n.ths):site2[this.nickname].wrap_to_parse.get(e,this.nickname,t,"catalog_json")},patch:{expand_thumbnail_inline_load:function(){var e=this.parentNode&&this.parentNode.parentNode;e&&e.classList&&e.classList.contains("multifile")&&e.style.width&&(this.setAttribute("data-originalWidth",e.style.width),e.style="")}},proto:"DEFAULT"}),pref.features.domains.KC&&(site2.KC={nickname:"KC",domain_url:"krautchan.net",components:{boardlist:".menu",postform_comment:"#postform_comment",postform_submit:"#postform_submit"},make_tack:function(){var e=document.createElement("img");return e.setAttribute("src","/images/sticky.gif"),e},boards_json:site2.DEFAULT.generate_boards_json([["b",15],["int",20],"vip","a","c","co","d","e","f","fb","fe","fit","jp","k","l","li",["m",5],"n","ng","p","ph","prog","sp","t",["trv",18],"tu","tv","v","w","we","wk","wp","z","zp","ft","r",["h",8],"s","bans","kc","rfk",["rvss",15]],10),check_func:function(){site2.KC.force_https||(site2.KC.protocol=site.protocol);var e=window.location.href;return e.search(/krautchan.net/)!=-1&&(site.whereami=document.head.innerHTML.indexOf("404 Not Found")!=-1?"404":e.search(/krautchan\.net\/?$/)!=-1?"frame":e.search(/catalog/)!=-1?"catalog":e.search(/thread/)!=-1?"thread":e.search(/\/$|(index|[0-9]+)\.html|\/#all$/)!=-1?"page":"other","page"!==site.whereami&&"thread"!==site.whereami||(this.components.boardlist="body > div:nth-child(3)",delete this.show_boardlist_physical_extract_func),site.config("krautchan.net","KC"),site.max_page=void 0==site2.KC.max_page_kc[site.board]?10:site2.KC.max_page_kc[site.board],"catalog"===site.whereami&&("/"===e[e.length-1]&&(e=e.substr(0,e.length-1)),site.board=e.substr(e.lastIndexOf("/"))+"/"),"frame"===site.whereami&&(site.root_body2=document.createElement("div"),site.embed_frame="main",site.embed_frame_win=main,navigation.onload=function(){site.root_body=navigation.document.body,site.root_body.appendChild(site.root_body2)}),site.embed_to="thread"===site.whereami||"page"===site.whereami?{top:function(){return document.querySelector('form[action="/delete"]')},bottom:function(){return document.querySelector('form[action="/delete"]').nextSibling}}:{},site.postform=document.getElementById("postform"),site.postform_rules=document.getElementById("rules_row"),!0)},force_https:!1,protocol:"https:",home:site.protocol+"//krautchan.net/regeln.html",show_boardlist_physical_extract_func:function(e){return e.substr(1,e.length-2)},catalog_frame_prep:function(e){var t=[navigation.document.body,main.document.body];site2.common.absorb_children(t[0]).style.display="none",site2.common.absorb_children(t[1]).style.display="none",t[0].insertBefore(e,t[0].firstChild),t[0].insertBefore(e,t[0].firstChild),site.root_body.appendChild(site.root_body2),this.catalog_embed_prep(e)},catalog_threads_in_page:function(e){return e.getElementsByClassName("thread_body")},max_page_kc:{"/int/":20,"/b/":15,"/trv/":13,"/m/":5},max_page:function(e){return site2.KC.max_page_kc[e]},make_url4:function(e){var t=this.protocol+"//"+this.domain_url;return e[3]=e[3].replace(/_json/,"_html"),"page_html"===e[3]?[t+e[1]+(0==e[2]?"":e[2]+".html"),"html"]:"catalog_html"===e[3]?[t+"/catalog"+e[1].substr(0,e[1].length-1),"html"]:"thread_html"===e[3]?[t+e[1]+"thread-"+e[2]+".html","html"]:void 0},trim_list:"no",get_next_image:function(e,t){var n=Array.prototype.slice.call(document.querySelectorAll("img[id^=thumbnail]")).filter(function(e){return".webm"!==e.src.substr(-5,5)});return site2.DEFAULT.get_next_image(e,t,n)},get_ops:function(e){for(var t=[],n=e.getElementsByTagName("div"),r=0;r<n.length;r++)"thread"!=n[r].className&&"thread kc_showReplies"!=n[r].className||t.push(n[r].id.substring(7));return t},get_posts:function(e){for(var t=[],n=e.getElementsByTagName("a"),r=0;r<n.length;r++)""!=n[r].name&&t.push(n[r].name);return t},modify_thread_link:function(e){for(var t=[],n=e.getElementsByClassName("postheader")[0].getElementsByTagName("a"),r=0;r<n.length;r++)if("Reply"==n[r][brwsr.innerText]||"Antworten"==n[r][brwsr.innerText]){var a=n[r].getAttribute("href");t.push([n[r],a]),n[r].removeAttribute("href")}return t},time_offset:1,localtime:function(e){var t=e.getElementsByClassName("postdate")[0];if(t){var n=t.cloneNode(!1);n.setAttribute("class","CatChan_localtime"),n.textContent=site2.common.change_utc_to_local(site2.KC.parse_funcs.post_html.time_pn_1(t)),t.parentNode.insertBefore(n,t.nextSibling),t.setAttribute("style","display:none")}},remove_files_info:function(e){site2.common.remove_by_classname(e,"filename"),site2.common.remove_by_classname(e,"fileinfo");for(var t=e.getElementsByTagName("img"),n=0;n<t.length;n++)t[n].id&&t[n].id.search("thumbnail")!=-1&&(t[n].removeAttribute("onmouseover"),t[n].removeAttribute("onmouseout"),t[n].removeAttribute("onload"),site2.common.move_up_and_delete_parent([t[n]]));for(var r=e.getElementsByClassName("file_thread"),n=0;n<r.length;n++)site2.common.remove_brs(r[n]);for(var n=0;n<r.length;n++)site2.common.remove_by_attribute([r[n]],"id","filename")},remove_posts:function(e,t){for(var n=e.getElementsByTagName("table"),r=n.length-1-t;r>=0;r--)n[r].previousSibling.previousSibling&&n[r].parentNode.removeChild(n[r].previousSibling.previousSibling),n[r].parentNode.removeChild(n[r].previousSibling),n[r].parentNode.removeChild(n[r])},format_thread_layout:function(e){site2.common.add_attribute_by_classname(e,"file_thread","style","float:left;margin:5px"),site2.common.add_attribute_by_classname(e,"file_reply","style","float:left;margin:5px"),e.getElementsByTagName("blockquote")[0].setAttribute("style","margin:5px;clear:both")},format_thread_style:function(e){site2.common.add_attribute_by_classname(e,"postreply","style","background:#cacaec")},format_thread_contents:function(e){site2.common.remove_by_tagname(e,"input"),site2.common.remove_by_classname(e,"report_parent"),site2.common.remove_by_attribute(e.getElementsByClassName("postheader"),"onclick","hideThread"),site2.common.remove_by_attribute(e.getElementsByClassName("file_thread"),"onclick","toggleThumbnail"),site2.common.remove_by_attribute(e.getElementsByClassName("file_thread"),"href","shipainter"),site2.common.remove_by_tagname(e,"hr"),site2.common.remove_by_classname(e,"omittedinfo")},preprocess_html:function(e,t){return e&&(t&&(e=e.replace(/<script[> ].*<\/script>/gm,"")),e=e.replace(/onload="imageFinishedLoading\([0-9]*\)"/gm,""),e=e.replace(/onmouseover="[^"]*"/gm,""),e=e.replace(/onmouseout="[^"]*"/gm,""),e=e.replace(/onclick="[^"]*"/gm,"")),e},preprocess_doc:function(e){site2.common.remove_attribute(e,"onload"),site2.common.remove_attribute(e,"onmouseover"),site2.common.remove_attribute(e,"onmouseout"),site2.common.remove_attribute(e,"onclick"),site2.common.remove_attribute(e,"onchange"),site2.common.remove_attribute(e,"onfocus"),site2.common.remove_attribute(e,"onsubmit");for(var t=e.getElementsByTagName("*"),n=t.length-1;n>=0;n--)t[n].getAttribute&&t[n].getAttribute("href")&&0==t[n].getAttribute("href").indexOf("javascript:")&&t[n].removeAttribute("href");pref.test_mode[28]&&(e.getElementsByTagName("html")[0].innerHTML=e.getElementsByTagName("html")[0].innerHTML)},catalog_native_prep:function(e,t,n,r){var a="catalog"===site.whereami?document.getElementsByClassName("catalog")[0]:document.querySelector('form[action="/delete"]'),s=t.getElementsByTagName("select")["catalog.order.ordering"];s.setAttribute("style","float:left"),a.parentNode.insertBefore(s,a),n.childNodes[3].setAttribute("style","float:left"),a.parentNode.insertBefore(n,a)},catalog_get_native_area:function(){return"page"===site.whereami?document.querySelector('form[action="/delete"]'):document.getElementsByClassName("catalog")[0]},parse_funcs:{catalog_html:{ths:function(e){for(var t=this.ths_array(e,e.pn.getElementsByClassName("thread")),n=Date.now()-36e5*pref.localtime_offset,r=0;r<t.length;r++)t[r].time_bumped<0&&(t[r].time_bumped+=n);return t},no:function(e){return parseInt(e.pn.getAttribute("id").substr(7),10)},time_bumped:function(e){return-1-16*parseInt(e.page.substr(0,e.page.indexOf(".")),10)-parseInt(e.page.substr(e.page.indexOf(".")+1))},time_created:function(e){return 0},nof_posts:function(e){var t=e.pn.getElementsByClassName("omitted_text")[0],n=t?parseInt(t.textContent.match(/[0-9]+/),10):0;return isNaN(n)?1:n+1},nof_files:function(e){return 0},key:function(e){return e.domain+e.board+e.no},sub:function(e){var t=e.pn.getElementsByTagName("header")[0].textContent.trim();return 0==t.search(/^#[0-9]+$/)?"":t},name:function(e){return""},com:function(e){return e.pn.getElementsByTagName("section")[0].innerHTML},type_com:"html",footer:function(e){var t=e.pn.getElementsByClassName("omitted_text")[0];return t.innerHTML="",t},sticky:function(e){return!1},op_img_url:function(e){var t=e.pn.getElementsByClassName("thumbnail"),n=t[0]?t[0].getElementsByTagName("img"):null;return n&&n[n.length-1]?n[n.length-1].getAttribute("src"):void 0},get_op_src:"thread_html",filename:function(e){var t=(e.pn.classList.contains("thread")||e.pn.classList.contains("thread_body"),e.pn.getElementsByClassName("post_files")[0].getElementsByTagName("figure"));if(t)for(var n=0;n<t.length;n++){var r=t[n].getElementsByTagName("img")[0].getAttribute("src");1===n&&(e.extra_files=[]),n>=1&&(e.extra_files[n-1]={domain:e.domain,board:e.board});var a=r.lastIndexOf("/"),s=0===n?e:e.extra_files[n-1];s.filename=t[n].getElementsByTagName("img")[0].getAttribute("alt"),s.filename_server=r.substr(a+1)}return e.filename},prep_mimic:"page_html",tn_imgs:function(){return[]},img2src:function(e){return th.op_img_url.replace("thumbnails","files")},dynamic_image_hover:!0},catalog_json:{proto:"catalog_html"},page_html:{ths:function(e){return this.ths_array(e,e.pn.getElementsByClassName("thread"))},th_init:function(e){e.pn.removeAttribute("class"),e.pn.style.clear="none"},no:function(e){return parseInt(e.pn.id?e.pn.id.replace(/[^_\-]*./,""):e.pn.getElementsByClassName("postnumber")[0].getElementsByTagName("a")[1].textContent,10)},posts:function(e){return this.posts_array(e,e.pn.querySelectorAll(".thread_body, td.postreply"))},time:"post_html.time",nof_posts:function(e){var t=e.pn.getElementsByTagName("table").length+1,n=e.pn.getElementsByClassName("filename").length,r=e.pn.getElementsByClassName("omittedinfo");if(r[0]){var a=r[0][brwsr.innerText].replace(/\n/g,"");t+=parseInt(a.replace(/\ post.*/,""),10),n+=parseInt("0"+a.replace(/\ file.*/,"").replace(/[^\ ]*\ /g,""),10)}return Object.defineProperty(e,"nof_files",{value:n,enumerable:!0,configurable:!0,writable:!0}),t},nof_files:function(e){return e.hasOwnProperty("nof_posts")||this.nof_posts(e),e.nof_files},sub:function(e){var t=e.pn.getElementsByClassName("postsubject")[0];return t?t.textContent:""},name:function(e){return e.pn.getElementsByClassName("postername")[0][brwsr.innerText]},pn_name:function(e){return e.pn.getElementsByClassName("postername")[0]},com:function(e){return(e.pn.getElementsByClassName("postbody")[0]||e.pn).getElementsByTagName("p")[0].innerHTML.replace(/^\s*/,"").replace(/\s*$/,"")},type_com:"html",footer:function(e){return this.insert_footer4(e.pn.getElementsByClassName("file_thread")[0])},flag:function(e){for(var t=e.pn.getElementsByTagName("img"),n=0;n<t.length&&t[n].getAttribute("src").search(/images\/balls/)==-1;n++);if(n<t.length){var r=document.importNode(t[n],!1);return r.setAttribute("src",site2.KC.absolute_link_1(r.getAttribute("src"))),r}return null},op_img_url:function(e){var t=e.pn.getElementsByClassName("file_thread"),n=t[0]?t[0].getElementsByTagName("img"):null,r=n&&n[n.length-1]?n[n.length-1].getAttribute("src"):void 0;if(t.length>=2){e.op_img_url2=[];for(var a=1;a<t.length;a++){n=t[a].getElementsByTagName("img");var s=n&&n[n.length-1]?n[n.length-1].getAttribute("src"):void 0;s&&(e.op_img_url2[e.op_img_url2.length]=s)}}return site2[e.domain].protocol+"//"+site2[e.domain].domain_url+r},get_op_src:"thread_html",get_thread_links:function(e){for(var t=e.pn.getElementsByClassName("postheader")[0].getElementsByTagName("a"),n=0;n<t.length;n++)if("Reply"===t[n].textContent||"Antworten"===t[n].textContent)return[t[n]]},get_omitted_info:function(e){return e.pn.getElementsByClassName("omittedinfo")[0]},set_omitted_info:function(e,t){e.pn.insertBefore(t,e.pn.getElementsByClassName("postbody")[0].nextSibling)},replace_omitted_info2:function(e,t){e.childNodes[0].textContent=t?t.childNodes[0].textContent:""},filename:function(e){var t=e.pn.classList.contains("thread")||e.pn.classList.contains("thread_body"),n=e.pn.getElementsByClassName(t?"file_thread":"file_reply");if(n)for(var r=0;r<n.length;r++){var a=n[r].getElementsByClassName("filename")[0].getElementsByTagName("a")[0].getAttribute("href");1===r&&(e.extra_files=[]),r>=1&&(e.extra_files[r-1]={domain:e.domain,board:e.board});var s=a.lastIndexOf("/"),o=0===r?e:e.extra_files[r-1];o.filename=a.substr(s+1),o.filename_server=a.substr(0,s).replace(/[^\/]*\//g,"").replace(/jpeg$/,"jpg");var i=n[r].getElementsByClassName("fileinfo")[0].textContent.replace(/\s/g,"").split(",");o.w=parseInt(i[1].substr(0,i[1].indexOf("x")),10),o.h=parseInt(i[1].substr(i[1].indexOf("x")+1),10);var l=i[1].split(/\s/);l[1]="kB"===l[1]?1e3:"MB"===l[1]?1e6:1,o.fsize=parseInt(l[0],10)*l[1];var c=n[r].querySelector("img[id^=thumbnail]");c&&(o.tn_w=parseInt(c.getAttribute("width"),10),o.tn_h=parseInt(c.getAttribute("height"),10))}return e.filename},tn_imgs:function(e){return e.pn.querySelectorAll("img[id^=thumbnail]")},prep_mimic:function(e){e.op_img_url=e.parse_funcs.op_img_url(e)},get_op_src:function(e){return site2.KC.catalog_json2html3_src(e)},get_max_page:function(e){for(var t=e.querySelectorAll("form[action*=delete]")[0].lastChild.previousSibling.previousSibling.previousSibling.childNodes[1].childNodes[1].childNodes[0].childNodes[3].childNodes,n=0,r=0;r<t.length;r++){var a=t[r].textContent.replace(/\s+/g,"");n+1!=a&&"["+(n+1)+"]"!==a||n++}return n}},thread_html:{com:function(e){return e.pn.getElementsByTagName("blockquote")[0].innerHTML.replace(/^\s*/,"").replace(/\s*$/,"")},type_com:"html",time_created:function(e){return e.parse_funcs.time(e.posts[0])},time_bumped:function(e){return e.parse_funcs.time(e.posts[e.posts.length-1])},get_op_src:function(e){return e.op_img_url.replace("thumbnails","files")},proto:"page_html"},post_html:{flag:"page_html",time:function(e){return site2.KC.parse_funcs.post_html.time_pn(e.pn)},time_pn:function(e){var t=e.getElementsByClassName("postdate")[0];return t?site2.KC.parse_funcs.post_html.time_pn_1(t):void 0},time_pn_1:function(e){return Date.parse(e.textContent)+36e5*(pref.localtime_offset-site2.KC.time_offset)}},post_json:{time_unit:1}},general_event_handler:{},popups_href2dbtp:function(e){var t=e.split(/[\/#]/),n=t[t.length-1],r=t[t.length-2].replace("thread-","").replace(".html","");return["KC",t.length>=3?"/"+t[t.length-3]+"/":site.board,r,n]},link_dbtp2href:function(e){return e[1]+"thread-"+e[2]+".html#"+e[3]},post_json2html_fname_server:function(e){return e.filename_server},post_json2html_fname:function(e){return e.filename},catalog_json2html3_src:function(e){return site.protocol+"//"+site2[e.domain].domain_url+"/files/"+e.filename_server},catalog_json2html3_thumbnail:function(e){return site.protocol+"//"+site2[e.domain].domain_url+"/thumbnails/"+e.filename_server},post_json2html:function(e,t,n,r,a){var s=document.createElement("div"),o=e.parse_funcs&&e.parse_funcs.time_unit||1,i=new Date((e.time||0)*o-36e5*(pref.localtime_offset-site2.KC.time_offset)),l="";if(e.filename&&(l+=this.post_json2html_file(e,t,e.extra_files),e.extra_files))for(var c=0;c<e.extra_files.length;c++)l+=this.post_json2html_file(e.extra_files[c],t,!0);return s.innerHTML='<div class="'+(n?"thread_body":'postreply" id="post-'+e.no)+'"><div class="postheader"><input name="post_'+e.no+'" value="delete" type="checkbox">'+(e.flag?e.flag.outerHTML:"")+'<span class="postsubject">'+e.sub+'</span> <span class="postername">'+e.name+'</span> <span class="postdate">'+i.toLocaleString()+'</span> <span class="postnumber"><a href="/int/thread-'+a+".html#"+e.no+'" class="quotelink">No.</a><a href="/int/thread-'+a+".html#q"+e.no+'" class="quotelink">'+e.no+'</a></span> <div class="report_parent"><a href="/report/int/'+a+'" class="report_link"><img src="/images/icon-report.png"></a></div>'+(n?' [<a href="'+t+"thread-"+e.no+'.html">Reply</a>] ':"")+"</div>"+l+"<div"+(n?' class="postbody"':"")+'><blockquote><p id="post_text_'+e.no+'">'+e.com+"</p></blockquote></div></div>",s.childNodes[0]},post_pn2ce:function(e){return"BLOCKQUOTE"===e.lastChild.firstChild.tagName?e.lastChild.firstChild:e.getElementsByTagName("blockquote")[0]},post_json2html_file:function(e,t,n){var r=(.005+(e.fsize>1048576?e.fsize/1048576:e.fsize/1024)).toString();r=r.substr(0,r.indexOf(".")+3)+(e.fsize>1048576?" MB":" KB");var a=site2[e.domain].post_json2html_fname_server(e),s=site2[e.domain].post_json2html_fname(e),o=site2[e.domain].catalog_json2html3_src(e,t),i=site2[e.domain].catalog_json2html3_thumbnail(e,t);return'<div class="file_thread"><span class="filename"><a href="/download/'+a+"/"+s+'">'+s+'</a></span><br><span class="fileinfo"> '+s.substr(s.lastIndexOf(".")+1).toUpperCase()+", "+e.w+"x"+e.h+", "+r+'</span><br><a href="'+o+'" target="_blank"><img style="display: block" id="thumbnail_'+a+'" src="'+i+'" width="'+e.tn_w+'" height="'+e.tn_h+'"></a></div>'},page_json2html3:function(e){var t=document.createElement("div");t.setAttribute("id","thread_"+e.no),t.setAttribute("style","clear:both"),t.innerHTML="<hr><a name="+e.no+"></a>";var n=this.post_json2html(e.posts&&e.posts[0]?e.posts[0]:e,e.board,!0,site2[e.domain].short_link(e.key,e.nof_posts,2,"[Last "," Posts]"),e.no);if(t.appendChild(n),e.posts[0].pn=n,e.posts){for(var r=1;r<e.posts.length;r++){var a=this.post_json2html(e.posts[r],e.board);this.update_posts_insert_1(this.post_container(a,e.posts[r].no),e.posts[r].no,null,t),e.posts[r].pn=a}this.page_json2html3_add_omitted_info(e,e.posts,e.posts)}return t},page_json2html3_replace_expander:function(e,t,n){var r=e[0].pn.getElementsByClassName("omittedinfo")[0];r&&r.appendChild(cnst.config_expander(n,t))},page_json2html3_add_omitted_info:function(e,t,n){for(var r=0,a=1;a<n.length;a++)r+="html"===n[a].type_data?n[a].pn.getElementsByClassName("file_thread").length:n[a].filename?n[a].extra_files?n[a].extra_files.length+1:1:0;var s=e.nof_files-r,o=e.nof_posts-n.length,i=t?t[0].pn.getElementsByClassName("omittedinfo")[0]:null;return e.nof_posts>1?(i||(i=document.createElement("span"),i.setAttribute("class","omittedinfo"),i.innerHTML="dummy",i.appendChild(cnst.config_expander(e.key)),t&&t[0].pn.insertBefore(i,t[0].pn.getElementsByClassName("postbody")[0].nextSibling)),i.childNodes[0].textContent=0!==o?o+" post"+(1!==o?"s":"")+(s?" and "+s+" file"+(1===s?"":"s"):"")+" are not shown. ":""):i&&(i.childNodes[0].textContent="Showing all posts."),i},update_posts_remove:function(e,t,n,r){n=n.getElementsByClassName("thread_body")[0];var a=e.posts[t].pn;r&&a.parentNode===n?this.update_posts_insert_pack(a):a=a.parentNode.parentNode.parentNode,a.previousSibling&&"A"===a.previousSibling.tagName&&n.removeChild(a.previousSibling),n.removeChild(a)},update_posts_insert:function(e,t,n,r,a){var s=t[r];s=s?s.pn:null;var o=s&&s.parentNode&&s.parentNode.parentNode&&s.parentNode.parentNode.parentNode;o&&o.parentNode&&o.parentNode.parentNode===a&&(s=o),e[n].pn||(e[n].pn=this.post_json2html(e[n],e[n].board)),0===n&&this.update_posts_insert_pack(e[0].pn),0===r&&s&&this.update_posts_insert_pack(t[0].pn);var i=0===r&&0===n?e[n].pn:this.post_container(e[n].pn,e[n].no);this.update_posts_insert_1(i,e[n].no,s,a),0===n&&0===r&&this.update_posts_insert_unpack(e[0].pn)},update_posts_insert_1:function(e,t,n,r){r=r.getElementsByClassName("thread_body")[0];var a=document.createElement("a");a.setAttribute("name",t),r.insertBefore(a,n),r.insertBefore(e,n)},update_posts0_class:site2.vichan.update_posts0_class,update_posts_insert_pack:site2.vichan.update_posts_insert_pack,update_posts_insert_pack_iter:function(e,t){for(var n=e.previousSibling;n;){var r=n.previousSibling;if(n.classList&&(n.classList.contains(pref.script_prefix+"_footer")||n.classList.contains("file_thread")||n.classList.contains("post_header"))&&t(n),n.classList&&n.classList.contains("postbody"))break;n=r}},update_posts_insert_unpack:function(e){for(;;){var t=e.firstChild;if(!(t&&t.classList&&(t.classList.contains(pref.script_prefix+"_footer")||t.classList.contains("file_thread")||t.classList.contains("post_header"))))break;e.parentNode.insertBefore(t,e)}},post_container:function(e,t){var n=document.createElement("table");return n.innerHTML='<tbody><tr><td valign="top">&gt;&gt;</td></tr></tbody>',n.childNodes[0].childNodes[0].appendChild(e),n},catalog_json2html3:function(e,t,n,r){var a=document.createElement("article");a.setAttribute("class","thread teaser"),a.setAttribute("id","thread-"+e.no);var s=null;return e.flags&&e.flags[0]&&(s=document.importNode(e.flags[0],!1),s.setAttribute("class","post_country")),a.innerHTML='<article class="thread_OP" id="'+e.no+'"><div class="post"><header><a><h1>'+(s?s.outerHTML:"")+(e.sub?e.sub:"#"+e.no)+'</h1></a></header><div class="post_body"><a><div class="post_files multiple"><figure><div class="thumbnail"><img src="'+e.op_img_url+'"></div></figure>'+(e.op_img_url2&&e.op_img_url2[0]?'<figure><div class="thumbnail"><img src="'+e.op_img_url2[0]+'"></div></figure>'+(e.op_img_url2&&e.op_img_url2[1]?'<figure><div class="thumbnail"><img src="'+e.op_img_url2[1]+'"></div></figure>'+(e.op_img_url2&&e.op_img_url2[2]?'<figure><div class="thumbnail"><img src="'+e.op_img_url2[2]+'"></div></figure>':""):""):"")+'</div></a><div class="omittedposts"><span class="omitted_text">'+(r?"R: 0 / I: 0 / P: 0.0&emsp;/catalog/":"")+'</span></div><div class="post_text"><section>'+e.com+"</section></div></div></div></article>",a.getElementsByClassName("thumbnail")[0].childNodes[0].addEventListener("load",site2.KC.catalog_json2html3_onload,!1),a},catalog_json2html3_onload:function(){this.removeEventListener("load",site2.KC.catalog_json2html3_onload,!1);var e=this.naturalWidth,t=this.naturalHeight,n=(e>t?e:t)/200;this.setAttribute("width",e/n),this.setAttribute("height",t/n)},favicon:{__proto__:site2.DEFAULT.favicon,none:"/favicon.ico",reply:"png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAIAAACQkWg2AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAKJJREFUOE9jZPh/hgECfv4yts59/PgxlAujZGVlzx6dzMDOBhMAaoCjtEA01SAuUBBZDQrnwEwsGoCCKBp+HEPwPx6QkZFB1gPifjyAUABUbGxsDLIUaAxEItQFxRIgFygIlAIqSAsEKYYDkGGhLpaWlsgaQNxQFxRrxcTEsLgbhxBI8SDUQLKnSQ9WUiOO9KRBfuL7cQzoH2C0oAGQJ5GcDQBwM6RhinByrgAAAABJRU5ErkJggg==",reply_to_me:"png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAIAAACQkWg2AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAMxJREFUOE9jZPh/hgECfv4yts59/PgxlAujZGVlzx6dzMDOBhMAavh/5j8MoKkGcdMCQYbCEYSFT8OBmagafhxD1iAjI4NsCYj78QBCA1CxsbEx0FKEDaEuKK4CcoFOAOoB2pMWCFIMAXANlpaWyBpA3FAXFGvFxMSQNWDxNJIQSDFEA5EAoQFfKGG1gQQNcP0gn4W6EPY0JFhBoQYJb8LBCo44KPp4gHDEoUQ70B5MgJ40kBMW0G2YAGviA9nz4xjQP8CQRgMgTyI5GwD2xdfU779fsgAAAABJRU5ErkJggg=="},add_backlinks:function(e,t,n,r){}}),(pref.features.domains["4chan"]||pref.features.domains.meguca)&&(site2["4chan_i"]={home:void 0,nickname:"4chan_i",nickname_href2domain:"4chan",domain_url:"i.4cdn.org",check_func:site2.DEFAULT.check_func,proto:"4chan"},site2["4chan"]={nickname:"4chan",home:site.protocol+"//boards.4chan.org/favicon.ico",protocol:"http:",make_tack:function(){var e=document.createElement("img");return e.setAttribute("src","//s.4cdn.org/image/sticky.gif"),e.setAttribute("class","stickyIcon retina"),e},postform_rules:null,postform:{activation:function(){document.getElementById("togglePostFormLink").getElementsByTagName("a")[0].click(),this.activation=null},__proto__:site2.DEFAULT.postform},features:{uip_tracker:!0},components:{boardlist:".boardList",boardlist2:[".boardList",1],postform_comment:'textarea[name="com"]',postform_submit:'input[type="submit"]',postform_comment2:['textarea[name="com"]',1],postform_submit2:['input[type="submit"]',2]},spoiler_text:{open_rule:"s,s a:not(:hover) {color: #fff!important;}"},general_event_handler:function(){var e={thread:{get_mark:function(e,t){for(;e&&e!==cataLog.parent;){if(e.classList.contains("post"))return e;if(e.classList.contains("postContainer"))return e.getElementsByClassName("post")[0];if(e.parentNode&&e.parentNode.classList.contains("thread")){if(e=e.previousSibling)continue;break}if(e.classList.contains("thread"))break;e=e.parentNode}return this.get_mark_from_height(t)},get_mark_from_height:function(e){return this.__proto__.get_mark_from_height(e,document.getElementsByClassName("post"))},image_hover_check_mode:function(e){return e.parentNode.classList.contains("fileThumb")?"page":"catalog"},getID:function(e){return e.classList.contains("hand")&&e.textContent},getCountry:function(e){return e.classList.contains("flag")&&e.getAttribute("class").replace(/\s*flag\-*/g,"").toUpperCase()||"countryFlag"===e.className&&e.getAttribute("alt").toLowerCase()},getTrip:function(e){return e.classList.contains("postertrip")&&e.textContent},__proto__:site2.DEFAULT.general_event_handler.common}};return e.catalog=Object.create(e.thread),e.page=Object.create(e.thread),e.archive=Object.create(e.thread),e}(),domain_url:"boards.4chan.org",check_func:function(){var e=window.location.href;return e.search(this.domain_url)!==-1&&(site.whereami=document.title.indexOf("404 Not Found")!=-1?"404":e.search(/catalog/)!=-1?"catalog":e.search(/thread\/[0-9]+/)!=-1?"thread":e.search(/archive/)!=-1?"archive":e.search(/\/$|(index|[0-9]+)(\.html)*|\/#all$/)!=-1?"page":"other","thread"===site.whereami&&(site.no=parseInt(e.replace(/.*thread\/([0-9]+)/,"$1"),10)),site.config(this.domain_url,"4chan"),this.postform_prep(),site.max_page=site2["4chan"].max_page(site.board),site.header_height=function(){var e=document.getElementById("header");return e?e.offsetHeight:0},site.embed_to="thread"===site.whereami?{top:function(){return document.getElementsByClassName("navLinks")[0]},bottom:function(){return document.getElementsByClassName("bottomad")[0]||document.getElementById("boardNavDesktopFoot")}}:"page"===site.whereami?{top:function(){return document.getElementById("ctrl-top")},bottom:function(){return document.getElementsByClassName("pagelist")[0]}}:"catalog"===site.whereami?{top:function(){return document.getElementById("content").previousSibling},bottom:function(){return document.getElementsByClassName("navLinksBottom")[0].nextSibling}}:{},site.postform=document.getElementsByClassName("postForm")[0],!0)},get_next_image:function(e,t){var n=cataLog.parent.querySelectorAll("img[data-md5]");0===n.length&&(n=site.popup_body.querySelectorAll("img[data-md5]"));var r=Array.prototype.indexOf.call(n,e);if(r==-1&&(r=Array.prototype.indexOf.call(n,e.previousSibling)),t)for(;n[r+1]&&n[r+1].offsetTop<t;)r++;if(r>=0){for(;n[r+1]&&n[r+1].parentNode.getAttribute("href").search(/\.webm$/)!=-1;)r++;return n[r+1]}return null},format_expanded_thumbnail:function(e){e.removeAttribute("data-md5"),e.className="expanded-thumb"},catalog_threads_in_page:function(e){return e.getElementsByClassName("thread")},catalog_posts_in_thread:function(e){return e.getElementsByClassName("replyContainer")},max_page:function(){return 10},make_url4:function(e,t){var n=site.protocol+"//"+this.domain_url+e[1],r=site.protocol+"//a.4cdn.org"+e[1];return("catalog_html"===e[3]||t&&0==e[2]&&"page_json"===e[3])&&(e[3]="catalog_json"),"page_json"===e[3]?[r+(parseInt(e[2],10)+1)+".json","json",t?"4chan"+e[1]+"j0":void 0]:"catalog_json"===e[3]?[r+"catalog.json","json","4chan"+e[1]+"j0"]:"thread_json"===e[3]?[r+"thread/"+e[2]+".json","json"]:"page_html"===e[3]?[n+(0!=e[2]?parseInt(e[2],10)+1:""),"html"]:"thread_html"===e[3]?[n+"thread/"+e[2],"html"]:null},trim_list:"force_init",url_boards_json:function(){return[site.protocol+"//a.4cdn.org/boards.json","json"]},archive_patch_domain:function(e){Object.defineProperty(e,"domain_xhr",{get:function(){return this.url.indexOf("i.4cdn.org/")===-1?null:"4chan_i"},configurable:!0,enumerable:!0})},get_ops:function(e){for(var t=[],n=e.getElementsByClassName("thread"),r=0;r<n.length;r++)t.push(n[r].id.substring(1));return t},get_posts:function(e){for(var t=[],n=e.getElementsByClassName("postContainer"),r=0;r<n.length;r++)t.push(parseInt(n[r].id.substring(2),10));return t},modify_thread_link:function(e){var t=e.getElementsByClassName("replylink")[0];if(t){var n=t.getAttribute("href");return t.removeAttribute("href"),[[t,n]]}return[]},check_thread_archived:function(e){return 0!=e.getElementsByClassName("archivedIcon").length},localtime:function(e){for(var t=e.getElementsByClassName("dateTime"),n=0;n<t.length;n++)t[n].textContent=site2.common.change_utc_to_local(1e3*parseInt(t[n].getAttribute("data-utc"),10))},remove_files_info:function(e){site2.common.remove_by_classname(e,"fileText"),site2.common.remove_by_classname(e,"mFileInfo");for(var t=e.getElementsByClassName("fileThumb"),n=0;n<t.length;n++)site2.common.move_up_and_delete_parent([t[n].childNodes[0]])},remove_posts:function(e,t){site2.common.remove_by_classname(e,"postContainer replyContainer",t,!0)},format_thread_layout:function(e){site2.common.add_attribute_by_classname(e,"post op","style","padding:0px"),site2.common.add_attribute_by_tagname(e,"blockquote","style","margin:12px 5px")},format_thread_contents:function(e){site2.common.remove_by_tagname(e,"input"),site2.common.remove_by_classname(e,"mobile"),site2.common.remove_by_classname(e,"sideArrows"),site2.common.remove_by_classname(e,"summary")},get_json_url_catalog:function(e){return site.protocol+"//a.4cdn.org"+e+"catalog.json"},uip_check:function(e,t){var n=[site.nickname,site.board,site.no,"thread_json"],r=pref.test_mode[136]&&pClg?function(t,n,r){e(t,n,r),cataLog.scan_boards_keyword_callback2(t,n,["sage_detect",{refresh:null,__proto__:cataLog.scan_boards_keyword_callback2_default_args}])}:e;http_req.get("uip",n.join(),"",r,!1,!1),pref.uip_tracker.sage.detect&&(n[3]="catalog_json",http_req.get("sage_detection",n.join(),"",this.sage_detect,!1,!1,t))},sage_detect:function(e,t,n){var r=e.split(","),a=pref.test_mode[136]&&pClg?cataLog.scan_boards_keyword_callback2(e,t,["sage_detect",{refresh:null,
__proto__:cataLog.scan_boards_keyword_callback2_default_args}]):site2["4chan"].wrap_to_parse.get(t.response,r[0],r[1],r[3],{page:0});n(site2["4chan"].parse_funcs.catalog_json.add_sage(a,site.no))},sage_detect_all:function(e){this.parse_funcs.catalog_json.add_sage(e,null);for(var t=0;t<e.length;t++){for(var n=e[t].posts,r=liveTag.mems.init(e[t]),a=0;a<n.length;a++)"sage"===n[a].email&&(r.sg||(r.sg=new Set),r.sg.add(n[a].no));if(pref.catalog.page_his){r.pgh||(r.pgh={});var s=r.pgh,o=e[t].posts[e[t].posts.length-1].no;s[o]?this.page_his_update(s[o],t):s[o]=[t]}}},page_his_update:function(e,t){var n=e[e.length-1];return n!=t&&(e[e.length-(e.length>=3&&e.length%2==1?0:e.length>1&&n<t?1:0)]=t),n!=t},parse_json_thread:function(e,t){if(t)return e.posts[e.posts.length-1].unique_ips=e.posts[0].unique_ips,e;for(var e={posts:[]},n={},r=0,a=document.getElementsByClassName("postContainer"),s=0;s<a.length;s++){e.posts[s]={},e.posts[s].no=a[s].id.replace(/pc/,"");var o=a[s].getElementsByClassName("posteruid")[0];o&&(o=o.textContent,e.posts[s].id=o,void 0===n[o]&&(r++,n[o]=1)),e.posts[s].unique_ips=r}return e.posts[a.length-1].unique_ips=0,e},uip_tgt_post:function(e){return document.getElementById("p"+e)},uip_post_num:function(e){return e.getElementsByClassName("postNum")},prep_own_posts_reg:/^4chan\-track\-[0-9A-z]+\-[0-9]+$/,prep_own_posts_event:function(e){e&&site2["4chan"].prep_own_posts_1(e.key)&&(e=null),"4chan"!==window.name||e||send_message("parent",["OWN_POSTS",window.name,site3[window.name].own_posts])},prep_own_posts:function(e){if(site3[this.nickname].own_posts={},localStorage)for(var t=e?[("4chan-track"+e).replace(/\//g,"-")]:Object.keys(localStorage||"{}"),n=0;n<t.length;n++)this.prep_own_posts_1(t[n])},prep_own_posts_1:function(e){if(this.prep_own_posts_reg.test(e)){var t="/"+e.replace(/^4chan\-track\-/,"").replace(/\-[0-9]+$/,"")+"/";site3[this.nickname].own_posts[t]||(site3[this.nickname].own_posts[t]={});var n=JSON.parse(localStorage[e]||"{}");for(var r in n)site3[this.nickname].own_posts[t][r.substr(2)]=null;return!0}return!1},catalog_native_prep:function(e,t,n,r){var a="catalog"===site.whereami?document.getElementById("ctrl"):document.getElementById("ctrl-top");if("thread"===site.whereami||!a)for(var a=document.getElementsByClassName("navLinks"),s=0;s<a.length;s++)if("none"!==window.getComputedStyle(a[s]).display){a=a[s];break}if(site2.DEFAULT.catalog_native_prep_sel(t,n,"catalog"===site.whereami?document.getElementById("order-ctrl"):null),"catalog"===site.whereami){var o=document.getElementById("size-ctrl");pref.catalog.format.thumb.size=o.value,o.addEventListener("change",site2["4chan"].catalog_native_size_changed,!1),pClg.kwd_init(document.getElementById("qf-box"),t).id=null,document.getElementById("qf-ctrl").addEventListener("click",pClg.kwd_clear,!1),document.getElementById("qf-clear").addEventListener("click",pClg.kwd_clear,!1)}else site.whereami;a.appendChild(n),"thread"===site.whereami&&document.getElementsByClassName("navLinksBot")[0].appendChild(r),"archive"===site.whereami&&(styleSheet.register("."+pref.script_prefix+"_threads","padding:20px 0;text-align:center;"),styleSheet.register("."+pref.script_prefix+"_threads>.thread","width:180px;max-height:320px;vertical-align:top;display:inline-block;word-wrap:break-word;overflow:hidden;margin-top:5px;margin-bottom:20px;padding:5px 0 3px;position:relative;"))},catalog_get_native_area:function(){if("archive"===site.whereami){var e=document.getElementById("arc-list"),t=document.createElement("div");t.setAttribute("class",pref.script_prefix+"_threads"),e.parentNode.insertBefore(t,e);var n=document.createElement("button");return n.textContent="More threads",e.parentNode.insertBefore(n,e),n.onclick=function(){cataLog.insert_myself(null,null,!0)},t}return"catalog"===site.whereami?document.getElementById("threads"):document.getElementsByClassName("board")[0]},catalog_native_size_changed:function(e){pref.catalog.format.thumb.size=e.target.value;for(var t=document.getElementsByClassName("thread"),n=t.length-1;n>=0;n--)gGEH.pns_all_keys.has(t[n])||t[n].parentNode.removeChild(t[n]);pClg.image_resize_all(e.target.value),pClg.drawn_idx=0,pClg.show_catalog()},catalog_float_prep:function(e){"catalog"===site.whereami&&e.ppn.appendChild(cnst.dom('<div style="clear:both"></div>'))},parse_funcs:{catalog_html:{ths_hook:function(e){var t=document.createElement("script");t.innerHTML="var clg; try{clg = JSON.stringify(catalog);} catch (e){clg = null;} document.body.lastChild.textContent = clg;";var n=new MutationObserver(function(r){document.body.removeChild(t),n.disconnect();try{site.data_embedded=JSON.parse(t.textContent)}catch(e){}e()});n.observe(t,{childList:!0}),document.body.appendChild(t)},ths:function(e){var t=e.pn.getElementsByClassName("thread"),n=site.data_embedded;if(!n)return this.ths_array(e,t);var r=[],a={get filename(){return this.file.slice(0,this.file.indexOf("."))},get tim(){return this.imgurl},get ext(){return this.file.slice(this.file.lastIndexOf("."))},get name(){return this.author},get com(){return this.teaser},missing_info:void 0,__proto__:e.__proto__};for(var s in n.threads){var o=n.threads[s];o.b>t.length||(o.no=s,o.page=Math.floor(o.b/(n.pagesize||15))+"."+o.b%(n.pagesize||15),o.pn=t[o.b],o.nof_posts=o.r+1,o.nof_files=o.i+1,o.time_created=1e3*o.date,o.time_posted=1e3*(o.lr&&o.lr.date||o.date),o.time_bumped=o.time_posted,o.time=o.date,o.__proto__=a,r[o.b]={posts:[o],__proto__:o})}return r},no:function(e){return parseInt(e.pn.getAttribute("id").substr(7),10)},time_bumped:function(e){return 0},time_created:function(e){return 0},nof_posts:function(e){var t=e.footer.textContent.match(/[0-9]+/g),n=t&&t[1]&&parseInt(t[1],10)+1||1;return Object.defineProperty(e,"nof_files",{value:n,enumerable:!0,writable:!0,configurable:!0}),t&&parseInt(t[0],10)+1||1},nof_files:function(e){var t=e.footer.textContent.match(/[0-9]+/g),n=t&&parseInt(t[0],10)+1||1;return Object.defineProperty(e,"nof_posts",{value:n,enumerable:!0,writable:!0,configurable:!0}),t&&t[1]&&parseInt(t[1],10)+1||1},sub:function(e){var t=e.pn.getElementsByClassName("teaser")[0],n=t?t.getElementsByTagName("b"):null,r=t?n&&n[0]?t.childNodes[1]?t.childNodes[1].textContent:"":t.childNodes[0].textContent:"";return Object.defineProperty(e,"com",{value:r,enumerable:!0,writable:!0,configurable:!0}),n&&n[0]?n[0].textContent:""},name:function(e){return""},com:function(e){return e.hasOwnProperty("sub")||Object.defineProperty(e,"sub",{value:this.sub(e),enumerable:!0,writable:!0,configurable:!0}),e.com},footer:function(e){return e.pn.getElementsByClassName("meta")[0]},sticky:function(e){return void 0!==e.pn.getElementsByClassName("stickyIcon")[0]},tn_as:function(e){return e.pn.getElementsByTagName("a")},class_thread:"thread",class_thumbnail:"thumb",op_img_url:function(e){return e.tn_imgs[0]?e.tn_imgs[0].getAttribute("src"):void 0},get_op_src:"thread_json",dynamic_image_hover:!0,missing_info:1,img2src:function(e){var t=site2["4chan"].popups_href2dbtp(e.parentNode.getAttribute("href")),n=liveTag.mems.getFromName(t[0]+t[1]+t[2]);return n?n.th&&n.th.ext?e.src.replace(/thumb/,"src").replace(/s\.[^\.]*$/,n.th.ext):(n.th.missing_info&&cataLog.DIH.fetch_and_reentry([n.domain+n.board],e),e.src):null},time_unit:1e3,footer_prep:function(e,t){var n=document.createElement("span"),r=t.lastChild;r&&t.removeChild(r),t.insertBefore(n,t.firstChild);for(var a;a=n.nextSibling;)n.appendChild(a);return n}},catalog_json:{ths:function(e,t){for(var n=[],r=0;r<e.length;r++)if(e[r].threads)for(var a=0;a<e[r].threads.length;a++){var s=e[r].threads[a];s.__proto__=t,n[n.length]={page:r+"."+a,key:t.domain+t.board+s.no,__proto__:s}}return n},time_posted:function(e){return e.last_replies?1e3*e.last_replies[e.last_replies.length-1].time:e.time_created},time_bumped:function(e){return e.bumplimit?void 0:e.time_posted},time_created:function(e){return 1e3*e.time},nof_posts:function(e){return e.replies+1},nof_files:function(e){return e.images+1},op_img_url:"DEFAULT.common",posts:function(e){return e.last_replies?[e.__proto__].concat(e.last_replies):[e.__proto__]},has_posts:!0,add_op_img_url:site2.DEFAULT.parse_parts.add_op_img_url,time_unit:1e3,get_op_src:"thread_json",type_com:"html",posts_full:null,missing_info:void 0,tn_as:"catalog_html",tn_imgs:"catalog_html",footer:"catalog_html",class_thread:"catalog_html",class_thumbnail:"catalog_html",add_sage:function(){function e(e,t,n){return"p"+Math.floor(e/15)+"."+e%15+", "+t+"#"+n.no}var t={},n={};return function(r,a){for(var s=pref.uip_tracker.sage,o=0;o<r.length&&r[o].sticky;){if(r[o].no===a)return r[o];o++}if(s.patch_bug3){for(var i=(r[0].domain!==site.nickname?r[0].domain:"")+r[0].board,l=t[i]||0;o<r.length&&r[o].last_modified<l;){if(r[o].no===a)return r[o];o++}o<r.length&&(t[i]=r[o].last_modified)}if(o!=r.length){if(r[o].no==a)return r[o];l=r[o].last_modified;for(var c=(r[0].domain!==site.nickname?r[0].domain:"")+(r[0].board!==site.board?r[0].board:""),p=!1,_=this.time_unit;++o<r.length;){var d=r[o],u=c?c+d.no:d.no;if(!d.bumplimit){for(var f=d.posts.length-1;f>=1;f--){var h=d.posts[f].time;if(t[u]>=h)break;if(l+s.tolerance>=h)break;if(s.patch_bug4&&f==d.posts.length-1&&o<n[u]){pref.debug_mode[30]&&console.log("RECOVERED by page history: "+e(o,u,d.posts[f])),p=!0;break}d.posts[f].email="sage",pref.debug_mode[30]&&console.log("detect: sage: "+e(o,u,d.posts[f])+", "+h+", "+l)}0===f&&(h=d.posts[0].time),1!==d.posts.length&&d.posts[d.posts.length-1].time==d.last_modified||(h=d.last_modified);var m=t[u]!=h;(!t[u]||t[u]<h)&&(t[u]=h),l=s.patch_bug2&&o<s.patch_bug2nth?d.last_modified:t[u],Object.defineProperty(d,"time_bumped",{value:l*_,enumerable:!0,configurable:!0,writable:!0})}var g=!m&&o<n[u];if(n[u]=g?n[u]:o,d.no==a)return d;if(s.patch_bug5&&(p||g)){pref.debug_mode[30]&&console.log("EXIT by obsolete data: "+e(o,u,d.posts[f])+", "+n[u]);break}}}}}(),flags:"DEFAULT.page_json",hrefs:"DEFAULT.post_json",proto:"DEFAULT.common"},page_html:{footer2:void 0,proto:"thread_html"},thread_html:{time_created:"DEFAULT.thread_json",time_bumped:"DEFAULT.thread_json",time_posted:"DEFAULT.thread_json",ths:function(e){return this.ths_array(e,e.pn.getElementsByClassName("thread"))},id:"DEFAULT.thread_html",country:"DEFAULT.thread_html",trip:"DEFAULT.thread_html",flag:"DEFAULT.thread_html",name:"DEFAULT.thread_html",th_init:function(e){e.pn.removeAttribute("class")},nof_posts:function(e){var t=e.pn.getElementsByClassName("postContainer").length,n=e.pn.getElementsByClassName("fileText").length,r=e.pn.getElementsByClassName("summary desktop")[0];if(r){var a=r[brwsr.innerText].replace(/\n/g,"");t+=parseInt(a.replace(/\ post.*/,""),10),n+=parseInt("0"+a.replace(/\ image.*/,"").replace(/[^\ ]*\ /g,""),10)}return Object.defineProperty(e,"nof_files",{value:n,enumerable:!0,configurable:!0,writable:!0}),t},nof_files:function(e){return e.hasOwnProperty("nof_posts")||this.nof_posts(e),e.nof_files},footer:function(e){return this.insert_footer4(e.pn.getElementsByClassName("postInfo desktop")[0])},footer2:function(e){return document.getElementsByClassName("navLinksBot")[0].appendChild(cnst.dom('<div style="clear:both;float:right"></div>'))},sticky:function(e){return 0!=e.pn.getElementsByClassName("stickyIcon").length},op_img_url:function(e){var t=e.pn.getElementsByTagName("img")[0];return t?t.getAttribute("src"):void 0},get_thread_links:function(e){return e.pn.querySelectorAll(".replylink,."+pref.script_prefix+"_link")},get_omitted_info:function(e){var t=e.pn.parentNode&&e.pn.parentNode.nextSibling;return t&&t.classList.contains("summary")?t:void 0},set_omitted_info:function(e,t){e.pn.parentNode.parentNode.insertBefore(t,e.pn.parentNode.nextSibling)},replace_omitted_info:function(e,t){e.childNodes[1].textContent=t.childNodes[1].textContent},replace_omitted_info2:function(e,t,n){if("A"===e.tagName){var r=document.createElement("span");r.setAttribute("class","summary"),r.appendChild(document.createElement("span")),r.appendChild(e),e=r}t?("none"===e.childNodes[1].style.display&&(n.domain===site.nickname&&e.childNodes[0].removeAttribute("style"),e.childNodes[1].removeAttribute("style")),this.replace_omitted_info(e,t)):(e.childNodes[0].setAttribute("style","display:none"),e.childNodes[1].setAttribute("style","display:none"))},get_op_src:"thread_json",prep_mimic:function(e){for(var t=0;t<e.posts.length;t++){var n=e.posts[t];if("html"===n.type_data){n.name,n.sub,n.com,n.trip,n.id,n.id,n.country;n.country_name=n.parse_funcs.country_name(n)}}},proto:"post_html"},page_json:{ths:"DEFAULT.page_json",get_op_src:"thread_json",proto:"thread_json"},thread_json:{tn_as:"catalog_html.tn_as",sticky:function(e){return e.posts[0].sticky},get_op_src:function(e,t){return e.op_img_url.indexOf("s.4cdn.org")!=-1?e.op_img_url:(!e.ext&&e.missing_info&&scan.scan_ui("image_hover",{tgts:[e.domain+e.board+"j0"],options:{callback:function(){cataLog.image_hover_reentry(t)},priority:6}}),e.localArchive?site2[e.domain].catalog_json2html3_src(e,e.board):e.ext?e.op_img_url.replace(/s(\.\w+)$/,e.ext):t.src)},consolidate_IDB_result_sub:function(e){e[0].nof_posts=e.length;for(var t=0,n=0;n<e.length;n++)e[n].filename&&t++;e[0].nof_files=t},flags:"DEFAULT.page_json",hrefs:"DEFAULT.post_json",proto:"DEFAULT.thread_json"},post_html:{no:function(e){var t=e.pn.getAttribute("id");return parseInt(t.substr(1),10)||parseInt(t.substr(2),10)},time:function(e){return parseInt(e.pn.getElementsByClassName("dateTime")[0].getAttribute("data-utc"),10)},time_pn:function(e){return 1e3*parseInt(e.getElementsByClassName("dateTime")[0].getAttribute("data-utc"),10)},flag:function(e){return e.pn.getElementsByClassName("flag")[1]||e.tFlag},tFlag:function(e){return e.pn.getElementsByClassName("countryFlag")[1]},country:function(e){return e.tFlag?e.tFlag.getAttribute("alt").toLowerCase():e.flag?e.flag.getAttribute("class").replace(/\s*flag\-*/g,"").toUpperCase():void 0},country_name:function(e){return e.tFlag?e.tFlag.getAttribute("title"):e.flag?e.flag.getAttribute("title"):void 0},txt2com_anchor_class:"quotelink",txt2com_spoiler_replace_txt:"<s>$1</s>",pn_name:function(e){return e.pn.getElementsByClassName("desktop")[0].getElementsByClassName("name")[0]},name:function(e){return this.pn_name(e).textContent},pn_id:function(e){var t=e.pn.getElementsByClassName("posteruid")[1];return t?t.childNodes[1]:void 0},id:function(e){return e.pn_id?e.pn_id.textContent:void 0},pn_trip:function(e){return e.pn.getElementsByClassName("postertrip")[1]},trip:function(e){return e.pn_trip?e.pn_trip.textContent:void 0},time_unit:1e3,com:function(e){return e.pn.getElementsByClassName("postMessage")[0].innerHTML},txt:function(e){return e.pn.getElementsByClassName("postMessage")[0][brwsr.innerText]},sub:"DEFAULT.post_html",img2src:"DEFAULT.post_html",img2ext:"DEFAULT.post_html",filename:function(e){if(e.pn.getElementsByClassName("file")[0]){var t=e.pn.getElementsByClassName("fileText")[0].getElementsByTagName("a")[0],n=t.getAttribute("title")||t.textContent,r=n.lastIndexOf("."),a=n.slice(0,r);e.ext=n.slice(r);var s=t.nextSibling.textContent.replace(/^ \(/,"").replace(/\)$/,"").replace(",","").split(/ |x/);e.fsize=parseInt(s[0],10)*("KB"===s[1]?1024:"MB"===s[1]?1024e3:1),e.w=parseInt(s[2],10),e.h=parseInt(s[3],10);var o=e.pn.getElementsByTagName("img")[0];return e.md5=o.getAttribute("data-md5"),e.time=parseInt(e.pn.getElementsByClassName("dateTime")[0].getAttribute("data-utc"),10),e.tim=parseInt(t.href.slice(t.href.lastIndexOf("/")+1).split(".")[0],10),e.tn_w=o.naturalWidth,e.tn_h=o.naturalHeight,a}},proto:"DEFAULT.page_html"},post_json:{proto:"DEFAULT.post_json"},archive_html:{ths:function(e){for(var t=Array.prototype.slice.call(e.pn.getElementById("arc-list").getElementsByTagName("tr")).slice(1,pref.scan.max_archive+1),n=0;n<t.length;n++)t[n].parentNode.removeChild(t[n]);return this.ths_array(e,t)},no:function(e){return parseInt(e.pn.getElementsByTagName("td")[0].textContent,10)},sub:function(e){var t=e.pn.getElementsByTagName("td")[1].firstChild;return"B"===t.tagName?t.textContent:""},com:function(e){return e.pn.getElementsByTagName("td")[1].lastChild.textContent},nof_posts:function(){},nof_files:function(){},filename:function(){return""},footer:function(){return document.createElement("div")},proto:"catalog_html"},html_template:{get id(){return this.exe_sub("id")},get pn_id(){return this.exe_sub("pn_id")},get country(){return this.exe_sub("country")},get trip(){return this.exe_sub("trip")},get pn_trip(){return this.exe_sub("pn_trip")},get pn_name(){return this.exe_sub("pn_name")},get tFlag(){return this.exe_sub("tFlag")}}},popups_posts_class_hlt:"highlight",popups_href2dbtp:function(e){e=e.replace(/^https*:/,"");var t=e.split(/[\/#]/),n=t.length,r=t[n-1].substr(1),a=n>=2&&t[n-2]||site.no,s=n>=4&&t[n-4]?"/"+t[n-4]+"/":site.board;if("catalog"===t[n-2])r="",a="",s=n>=3&&t[n-3]?"/"+t[n-3]+"/":site.board;else if("/"===e[0])if("/"===e[1]){if(0!==e.indexOf("//boards.4chan"))return[];r=n>=7?t[6].slice(1):"",a=n>=6?t[5]:"",s=n>=4?"/"+t[3]+"/":site.board}else 5!=n&&(r=n>=5?t[4].slice(1):"",a=n>=4?t[3]:"",s="/"+t[1]+"/");return["4chan",s,a,r]},update_posts_remove:function(e,t,n){pref.debug_mode[13]&&e.posts[t].pn.parentNode.parentNode!==n&&console.log(e.posts[t].pn);var r=e.posts[t].pn.parentNode,a=0==t?r.nextSibling:null;n.removeChild(r),a&&"SPAN"===a.tagName&&n.removeChild(a)},update_posts_insert:function(e,t,n,r,a){var s=r<t.length?t[r].pn.parentNode:null;e[n].pn||(e[n].pn=this.post_json2html(e[n],e[n].board));var o=e[n].pn.parentNode||this.post_container(e[n].pn,e[n].no),i=0==n?o.nextSibling:null;a.insertBefore(o,s),i&&"SPAN"===i.tagName&&a.insertBefore(i,s)},update_posts0_class:function(e,t){site2.DEFAULT.update_posts0_class(e,t);var n=e.parentNode&&e.parentNode.nextSibling;n&&n.classList.contains("summary")&&site2.DEFAULT.update_posts0_class(n,t)},post_container:function(e,t,n){var r=document.createElement("div");return r.setAttribute("id","pc"+t),r.setAttribute("class","postContainer "+(n?"op":"reply")+"Container"),n||(r.innerHTML='<div class="sideArrows" id="sa'+t+'">&gt;&gt;</div>'),r.appendChild(e),r},remove_backlink:function(e,t){var n=e&&e.getElementsByClassName("backlink")[0],r=n&&n.childNodes[t];r&&n.removeChild(r)},add_backlinks_bks:function(){var e=document.createElement("div");return e.setAttribute("class","backlink"),function(){return e.cloneNode(!1)}}(),add_backlinks_add_1:function(){var e=document.createElement("a");e.setAttribute("class","quotelink");var t=document.createElement("span");return t.appendChild(e),t.appendChild(document.createTextNode(" ")),function(n,r){e.setAttribute("href",r[5]),e.textContent=r[4];var a=t.cloneNode(!0);if("4chan"!==r[0]||pref.test_mode[91]){a.firstChild.onclick=this.backlink_onclick}n.appendChild(a)}}(),add_backlinks_bks_query:function(e){return e.getElementsByClassName("backlink")[0]},add_backlinks_bks_append:function(e,t){e.getElementsByClassName("desktop")[0].appendChild(t)},toplevel_anchor_pos:2,link_dbtp2href:function(e,t){return(e[1]!=site.board||e[2]!=site.no?e[1]+"thread/"+e[2]:"")+"#"+(t?"q":"p")+e[3]},backlink_onclick:function(){highlightReply.call(this,parseInt(this.textContent.substr(2),10))},backlink_parent_prevSib:function(e){return e.getElementsByClassName("postNum")[1]},post_com2txt:function(e){return e.com?this.post_com2txt_finisher(e.com.replace(/<[^>]*>/g," ").replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&quot;/g,'"').replace(/&#039;/g,"'").replace(/&#0*44;/g,",").replace(/&amp;/g,"&"),e):""},post_json2html:function(e,t,n,r,a){void 0===a&&(a=e.op||e.resto||e.no),void 0===n&&(n=0===e.resto||e.no==e.op);var s=document.createElement("div"),o=e.parse_funcs&&e.parse_funcs.time_unit||1,i=new Date((e.time||0)*o),l=e.name||"Anonymous";if(e.ext){var c=(.005+(e.fsize>1048576?e.fsize/1048576:e.fsize/1024)).toString();c=c.substr(0,c.indexOf(".")+3)+(e.fsize>1048576?" MB":" KB");var p=site2[e.domain].catalog_json2html3_src(e,t),_=site2[e.domain].catalog_json2html3_thumbnail(e,t),d=n?1:(e.tn_w>e.tn_h?e.tn_w:e.tn_h)/125,u='<div class="file" id="f'+e.no+'"><div class="fileText" id="fT'+e.no+'">File: <a '+(e.filename.length>30?'title="'+e.filename+e.ext+'" ':"")+'href="'+p+'" target="_blank">'+(e.spoiler?"Spoiler Image":e.filename.length>30?e.filename.slice(0,25)+"(...)":e.filename)+e.ext+"</a> ("+c+", "+e.w+"x"+e.h+')</div><a class="fileThumb" href="'+p+'" target="_blank"><img src="'+_+'" alt="'+c+'" data-md5="'+e.md5+'" style="height: '+(e.spoiler?100:n?e.tn_h:e.tn_h/d)+"px; width:"+(e.spoiler?100:n?e.tn_w:e.tn_w/d)+'px;"><div data-tip="" data-tip-cb="mShowFull" class="mFileInfo mobile">'+c+" "+e.ext.substr(1).toUpperCase()+"</div></a></div>"}var f=[e.domain,t,a,e.no];return s.innerHTML='<div id="p'+e.no+'" class="post reply"><div class="postInfoM mobile" id="pim'+e.no+'">'+this.post_json2html_nameblock(e,l,!1)+'<span class="dateTime postNum" data-utc="'+e.time+'">'+site2.common.change_utc_to_local(i)+"</span></div>"+(e.ext&&n?u:"")+'<div class="postInfo desktop" id="pi'+e.no+'"><input type="checkbox" name="'+e.no+'" value="delete"> '+(e.sub?'<span class="subject">'+e.sub+"</span> ":"")+this.post_json2html_nameblock(e,l,!0)+'<span class="dateTime" data-utc="'+e.time+'">'+site2.common.change_utc_to_local(i)+'</span> <span class="postNum desktop"><a href="'+this.link_dbtp2href_abs(f)+'" title="Link to this post">No.</a><a href="'+this.link_dbtp2href_abs(f,!0)+'" title="Reply to this post">'+e.no+"</a></span> &nbsp; "+(n?'<span>[<a href="'+site2[e.domain].make_url4([e.domain,t,e.no,"thread_html"])[0]+'" class="replylink">Reply</a>]</span>'+(r?r.replace(/>\[/g,">").replace(/<a/g,"<span>[<a").replace(/\]<\/a/g,"</a>]</span"):""):"")+("4chan"===e.domain&&"4chan"===site.nickname?'<a href="#" class="postMenuBtn" title="Post menu" data-cmd="post-menu">▶</a>':"")+"</div>"+(e.ext&&!n?u:"")+'<blockquote class="postMessage" id="m'+e.no+'">'+(e.com||"")+"</blockquote></div>",s.removeChild(s.childNodes[0])},post_json2html_nameblock:function(e,t,n){var r;return'<span class="nameBlock"><span class="name">'+t+"</span> "+(e.trip?'<span class="postertrip">'+e.trip+"</span> ":"")+(e.capcode?'<strong class="capcode hand id_mod" title="Highlight posts by Moderators">##'+e.capcode+"</strong>":"")+(e.since4pass?'<span title="Pass user since '+e.since4pass+'" class="n-pu"></span>':"")+(e.id?'<span class="posteruid id_'+e.id+'">(ID: <span class="hand" title="Highlight posts by this ID"'+(n?(r=this.post_json2html_colorID(e),' style="color: '+r[1]+"; background-color: rgb("+r[0]+');"'):"")+">"+e.id+"</span>)</span> ":"")+site2["4chan"].post_flag2html(e)+(n?"</span> ":"<br></span>")},post_flag2html:function(e){return e.troll_country?'<img src="//s.4cdn.org/image/country/troll/'+e.troll_country.toLowerCase()+'.gif" alt="'+e.troll_country+'" title="'+e.country_name+'" class="countryFlag">':e.country?"<span "+(e.country_name?'title="'+e.country_name+'" ':"")+'class="flag flag-'+e.country.toLowerCase()+'"></span>':""},post_json2html_colorID:function(e){for(var t=0,n=0;n<e.id.length;n++)t=(t<<5)-t+e.id.charCodeAt(n);var r=t>>24&255,a=t>>16&255,s=t>>8&255;return[r+","+a+","+s,.299*r+.587*a+.114*s>125?"black":"white"]},page_json2html3_skelton:function(e){var t=document.createElement("div");return t.setAttribute("class","thread"),t.setAttribute("id","t"+e.no),t},page_json2html3:function(e,t,n,r){var a=this.page_json2html3_skelton(e),s=t&&e.posts[0].pn&&e.posts[0].pn.cloneNode(!0)||this.post_json2html(e.posts&&e.posts[0]?e.posts[0]:e,e.board,!0,site2[e.domain].short_link(e.key,e.nof_posts,2,"[Last "," Posts]"),e.posts[0].no);if(s.setAttribute("class","post op"),a.appendChild(this.post_container(s,e.posts[0].no,!0)),e.posts[0].pn=s,e.posts){for(var o=1;o<e.posts.length;o++){var i=t&&e.posts[o].pn&&e.posts[o].pn.cloneNode(!0)||this.post_json2html(e.posts[o],e.board);a.appendChild(this.post_container(i,e.posts[o].no)),e.posts[o].pn=i}this.page_json2html3_add_omitted_info(e,n,r)}return a},page_json2html3_add_omitted_info:function(e,t,n){for(var r=e.posts,a=0,s=0;s<r.length;s++)a+="html"===r[s].type_data?r[s].pn.getElementsByClassName("file").length:r[s].filename?1:0;var o=r.filter(function(e){return e.deleted_after}),i=e.nof_files-a+o.filter(function(e){return e.filename}).length,l=e.nof_posts-r.length+o.length;site2[t.domain_html||e.domain_html].page_json2html3_add_omitted_info_html(e,t,n,l,i)},page_json2html3_add_omitted_info_html:function(e,t,n,r,a){if(!t.pn_summary&&(n|="4chan"!==e.domain,r>0||n)){var s=t.posts?t.posts[0]:e.posts[0],o=this.parse_funcs.page_html.get_omitted_info(s);o||(o=document.createElement("span"),o.setAttribute("class","summary"),o.innerHTML='<img class="extButton expbtn" title="Expand thread" alt="+" data-cmd="expand" data-id="'+e.posts[0].no+'" src="//s.4cdn.org/image/buttons/burichan/post_expand_plus.png"><span class="summary"></span><span style="display: none;">Showing all replies.</span>',e.domain!==site.nickname&&(o.childNodes[0].style.display="none"),this.parse_funcs.page_html.set_omitted_info(s,o)),n&&o.appendChild(cnst.config_expander(e.key)),t.pn_summary=o.childNodes[1]}t.pn_summary&&(t.pn_summary.textContent=r<=0?"Showing all replies.":r+(1==r?" reply":" replies")+(a?" and "+a+" image"+(1!==r?"s":""):"")+" omitted.")},catalog_json2html3_thumbnail:function(e,t){return e.ext?e.spoiler?"//s.4cdn.org/image/spoiler-a1.png":this.protocol+"//i.4cdn.org"+t+e.tim+"s"+(".jpg"===e.ext||".png"===e.ext||".gif"===e.ext||".webm"===e.ext?".jpg":e.ext):""},catalog_json2html3_src:function(e,t){return e.ext?this.protocol+"//i.4cdn.org"+t+e.tim+e.ext:""},catalog_json2html3:function(e,t,n,r){var a,s,o=this.catalog_json2html3_skelton(e),i=pref.catalog.format.thumb,l="small"===i.size&&150===i.small.w1&&150===i.small.h1?.6:"large"===i.size&&250===i.large.w1&&250===i.large.h1?1:(a=i[i.size].w1/e.tn_w,s=i[i.size].h1/e.tn_h,a<s?a:s);return o.innerHTML='<a href="'+this.protocol+"//boards.4chan.org"+e.board+"thread/"+e.no+'"><img alt="" id="thumb-'+e.no+(e.tn_w?'" width="'+e.tn_w*l:"")+(e.tn_h?'" height="'+e.tn_h*l:"")+'" src="'+n+'" data-id="'+e.no+'"></a><div title="(R)eplies / (I)mages" id="meta-'+e.no+'" class="meta">'+(r?"R: <b>"+e.nof_posts+"</b> / I: <b>"+e.nof_files+"</b>":"")+'</div><div class="teaser">'+(e.sub?"<b>"+e.sub+"</b>":"")+(e.com?(e.sub?": ":"")+e.com:"")+"</div>",o},catalog_json2html3_skelton:function(e){return cnst.dom('<div class="thread" id="thread-'+e.no+'"></div>')},catalog_merge:function(e,t,n){if(1===t.isShown){t.pn.childNodes[0].style.float="left";var r=t.pn.getElementsByClassName("threadIcons")[0],a=n.footer.add_menu(t.pn.insertBefore(cnst.dom('<div style="clear:both" class="meta"></div>'),t.pn.childNodes[r?2:1]));t.footer=[a],t.cns=[a,t.pn.childNodes[r?4:3],t.pn.childNodes[0]]}var s=e.getElementsByClassName("threadIcons")[0],o=[e.childNodes[s?2:1],e.childNodes[s?3:2],e.childNodes[0]];return t.pn!==e&&(o[2].style.float="left",t.pn.insertBefore(o[2],t.cns[0]),t.pn.insertBefore(o[0],t.cns[1]),t.pn.appendChild(o[1]),n.image_resize_th(t.pn)),o},catalog_separate:function(e,t,n){var r=this.catalog_json2html3_skelton(e);return 2===t.isShown&&(t.cns[2].style.float=null,t.cns=null),e.cns[2].style.float=null,r.appendChild(e.cns[2]),t.cns&&e.cns[0]===t.cns[0]&&(t.cns[0]=e.cns[0].nextSibling),r.appendChild(e.cns[0]),t.cns&&e.cns[1]===t.cns[1]&&(t.cns[1]=e.cns[1].nextSibling),r.appendChild(e.cns[1]),n.image_resize(e.cns[2].firstChild,!0),n.image_resize_th(t.pn),r},favicon:{__proto__:site2.DEFAULT.favicon,none:"/favicon.ico",reply:"png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAoUlEQVQ4T61TwRGAMAiTmexMDuVMOlM1XOEoAj60L20gDUlLy8dF6Kd+dM/TqTEmK6shAe4GW8zfQlLVMAGat2NVgr2dUDWJymomBRlJdUCoAEdbFZ7A4qEHw9jHCM5U/k1TiEyMkiqj8ikIgY1YCXxUUQp2NCW3F8malZno9kk9qKLKMKj4nwAScaGiETw2KRix8RWG5MhEjynB24usXusFrlPCCCmAi/UAAAAASUVORK5CYII=",reply_to_me:"png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAvUlEQVQ4T61TXRrDIAiDXWmeabvTzlSvVGb8hFIK3ct8aeUnJkSZxmLZBF+/hBvHWLafRQDY6Wn5B3WKANUhrIkIADQF0Zqxt0NGbP5PACREDhXMDFZREr22g+Wn9VmTMnj3RlqwmKTNJYNfAGi8MPD61mAvEnzAZlDZmA0xs7q08Q7AW5wCVC54aWaxl4A5qFWVCyE+DF830Tf7Kd/ZCBb/BwBFyMgkxNyJgVKFv5CTXeWYM4DqLsTHlD33Lx2GzAg15eTiAAAAAElFTkSuQmCC"},stats_ID:function(e,t,n){n.sID||(n.sID={ids:{},cs:{},nid:0,nc:0,np:0,h:null});var r=n.sID;if(e.unique_ips&&(r.np=e.unique_ips,!e.id&&e.posts)){r.h||(r.h=[]);var a=r.h.length;r.h[a-3]!=e.posts[e.posts.length-1].no||r.h[a-2]!=e.nof_posts||r.h[a-1]!=e.unique_ips?r.h.push(e.posts[e.posts.length-1].no,e.nof_posts,e.unique_ips):e.nof_posts<n.nof_posts&&scan.list_nup.add(n,0,!0)}if(t&&t.length>0&&(e.id||e.country))for(var s=0;s<t.length;s++){var o=t[s].country;if(o&&(r.cs[o]?r.cs[o]++:(r.cs[o]=1,r.nc++)),t[s].id){var i=(o||"")+t[s].id;r.ids[i]?r.ids[i]++:(r.ids[i]=1,r.nid++)}}return 1==e.nof_posts?(r.np=1,!1):t&&t.length>0&&pref.threadStats.full&&!e.id&&!e.unique_ips},get_icon:function(e,t,n,r){return"sticky"==n?e.getElementsByClassName("stickyIcon")[0]:null},add_icon:function(e,t,n,r){var a="sticky"===n?this.make_tack():this.make_showAlways();return("headline"!==t&&"catalog"!==t?e.getElementsByClassName("postNum")[1]:e.getElementsByClassName("threadIcons")[0]||e.insertBefore(cnst.dom('<div class="threadIcons"></div>'),"headline"===t?e.firstChild:e.getElementsByClassName("meta")[0])).appendChild(a),a}},site2["4channel"]={domain_url:"boards.4channel.org",check_func:site2["4chan"].check_func,proto:"4chan"}),pref.features.domains.meguca&&(site2.meguca1={nickname:"meguca",protocol:"https:",home:"https://meguca.org/favicon.ico",domain_url:"meguca.org",domain_url_image:"meguca.org",features:{page:!1,graph:!1,setting2:!1,thread_reader:!1},components:{boardlist:"#navTop"},pref_default:{catalog:{image_hover:!0}},boards_json:{boards:[{board:"a"},{board:"an"},{board:"cr"},{board:"g"},{board:"v"}]},check_func:function(){var e=window.location.href;return e.indexOf("/meguca.org/")!=-1?(site.whereami=e.indexOf("/catalog")!=-1?"catalog":e.search(/page[0-9]/)!=-1?"page":e.search(/[0-9]+$/)!=-1?"thread":"other",site.config("meguca.org",this.nickname),site.max_page=3,site.header_height=function(){var e=document.getElementById("banner");return e?e.offsetHeight:0},!0):(this.prep_own_posts(),!1)},make_url4:function(e){var t=this.protocol+"//"+this.domain_url;return"page_json"===e[3]&&0==e[2]&&(e[3]="catalog_json"),"page_html"===e[3]?[t+(0!=e[2]?parseInt(e[2],10)+1:""),"html"]:"catalog_json"===e[3]?[t+"/api/board"+e[1].substr(0,e[1].length-1),"json"]:"thread_html"===e[3]?[t+e[1]+e[2],"html"]:"thread_json"===e[3]?[t+"/api/thread/"+e[2],"json"]:void 0},catalog_get_native_area:function(){return"catalog"===site.whereami?document.getElementById("catalog"):document.getElementsByName("postcontrols")[0]},catalog_native_prep:function(e,t,n,r){var a="catalog"===site.whereami?document.getElementsByTagName("threads")[0].getElementsByTagName("aside")[0]:document.getElementsByName("postcontrols")[0];if("catalog"===site.whereami){for(var s=document.createElement("span");n.firstChild;)s.appendChild(n.firstChild);n=s,n.appendChild(n.removeChild(n.childNodes[3]).firstChild),n.setAttribute("style","float:right")}else if("page"===site.whereami){var o=document.getElementsByName("postcontrols")[0];o.parentNode.insertBefore(document.createElement("hr"),o.nextSibling)}site.whereami,a.parentNode.insertBefore(n,a),a.parentNode.insertBefore(t,document.getElementById("catalog"));var i=t.getElementsByTagName("select")["catalog.order.ordering"];i.setAttribute("style","float:left"),"catalog"===site.whereami?a.parentNode.insertBefore(i,a):n.childNodes[3].insertBefore(i,n.childNodes[3].firstChild),a.setAttribute("style","float:left"),a.parentNode.insertBefore(n.childNodes[3],a.nextSibling)},catalog_json2html3:function(e,t,n,r){var a=document.createElement("article"),s=site2[e.domain].make_url4([e.domain,e.board,e.no,"thread_html"])[0],o=e.tn_w||e.posts[0].tn_w,i=e.tn_h||e.posts[0].tn_h,l=150/(o>i?o:i),c=site2[e.domain].historyAPI&&pref.pref2.meguca.historyAPI?"history":"",p=c+" "+pref.script_prefix+"_link",_=site2[e.domain].short_link(e.key,e.nof_posts,1,"Last ","")
;return a.innerHTML='<a target="_blank" rel="nofollow" href="'+s+'"'+(c?' class="'+c+'"':"")+'><img src="'+n+'" width="'+o*l+'" height="'+i*l+'" class="expanded"></a><br><small><span title="Replies/Images">'+(r?e.nof_posts-1+"/"+(e.nof_files-1):"")+'</span><span class="act expansionLinks"><a href="'+s+'" class="'+p+'">Expand</a>'+(_?"] ["+_:"")+"</span></small><br>"+(e.sub?"<h3>"+e.sub+" </h3>":"")+(e.com?e.com:""),a},prep_own_posts_event:function(e){e&&"mine"===e.key&&site2.meguca.prep_own_posts(),"meguca"===window.name&&send_message("parent",["OWN_POSTS",window.name,site3[window.name].own_posts.ALL])},prep_own_posts_event_received:function(e){site3[this.nickname].own_posts.ALL=e},prep_own_posts:function(e){if(!site3[this.nickname].own_posts.ALL){site3[this.nickname].own_posts.ALL={};for(var t=["/a/","/an/","/cr/","/g/"],n=0;n<t.length;n++)site3[this.nickname].own_posts[t[n]]=Object.create(site3[this.nickname].own_posts.ALL)}if(localStorage){var r=JSON.parse(localStorage.mine||"{}");for(var a in r)site3[this.nickname].own_posts.ALL[a]=null}},wrap_to_parse:{get:site2.DEFAULT.wrap_to_parse.get,posts:function(e){delete Object.getPrototypeOf(e.posts[0]).com}},short_link:function(e,t,n,r,a){var s=this.make_url4(common_func.name2dbt(e))[0],o=pref.script_prefix+"_link";return(!n||n>1?'<a href="'+s+'?last=50" class="'+o+'">'+r+"50"+a+"</a>":"")+'<a href="'+s+'?last=100" class="'+o+'">'+r+"100"+a+"</a>"},catalog_json2html3_src:function(e){return e.image?"/static/src/"+e.image.src:void 0},catalog_json2html3_thumbnail:function(e){return e.image?"/static/"+(void 0===e.image.spoiler||pref[cataLog.embed_mode].open_spoiler_image?void 0!==e.image.thumb?"thumb/"+e.image.thumb:"src/"+e.image.src:"spoil/spoilers"+e.image.spoiler+".png"):void 0},post_json2html_fname_server:function(e){return e.image?e.image.src:void 0},post_json2html_fname:function(e){return e.image?e.image.imgnm:void 0},popups_href2dbtp:function(e){var t=e.split(/[\/#]/),n=t[t.length-1],r=t[t.length-2];return["meguca","/"+t[t.length-3]+"/",r,n]},link_dbtp2href:function(e){return e[1]+e[2]+"#"+e[3]},time_offset:-5,parse_funcs:{post_json:{get no(){return this.num},get sub(){return this.subject},name:"Anonymous",get txt(){return this.body},get com(){return this.body?this.body.replace(this.anchor_regex,this.anchor_func):""},get filename(){return this.image?this.image.imgnm:void 0},get w(){return this.image?this.image.dims[0]:void 0},get h(){return this.image?this.image.dims[1]:void 0},get tn_w(){return this.image?void 0===this.image.spoiler||pref[cataLog.embed_mode].open_spoiler_image?this.image.dims[2]:250:void 0},get tn_h(){return this.image?void 0===this.image.spoiler||pref[cataLog.embed_mode].open_spoiler_image?this.image.dims[3]:250:void 0},get fsize(){return this.image?this.image.size:void 0},get ext(){return this.image?this.image.ext:void 0},domain:"meguca",get domain_html(){return site.nickname},get parse_funcs_html(){return site2[site.nickname].parse_funcs[site.whereami+"_html"]},anchor_regex:/(>>)([0-9]+)/g},thread_json:{ths:function(e,t){for(var n={board:t.board,anchor_func:function(){var e=['<a href="'+t.board+t.thread+"#",'">&gt;&gt;',"</a>"];return function(t,n,r){return e[0]+r+e[1]+r+e[2]}}(),get com(){return this.body},__proto__:site2[t.domain].parse_funcs.post_json},r=0;r<e.length&&void 0===e[r].state;)e[r++].__proto__=n;return r!==e.length&&e.splice(r,e.length-r),[{posts:e,nof_posts:e.length,key:t.domain+t.board+t.thread,no:t.thread,__proto__:t}]},get_op_src:function(e){return site2[e.domain].protocol+"//"+site2[e.domain].domain_url+"/static/src/"+e.posts[0].image.src},op_img_url:function(e){return site2[e.domain].protocol+"//"+site2[e.domain].domain_url+"/static/"+site2.meguca.catalog_json2html3_thumbnail(e.posts[0])},nof_files:function(e){return e.posts[0].imgctr-1},time:function(e){return e.posts[0].time},time_posted:function(e){return e.posts[e.posts.length-1].time},time_created:function(e){return e.posts[0].time},time_bumped:function(e){for(var t=e.posts.length-1;t>0;){if(!e.posts[t].email||"sage"!==e.posts[t].email)return e.posts[t].time;t++}return e.posts[0].time},sticky:function(e){return!1},com:function(e){return e.posts[0].body},sub:function(e){return e.posts[0].sub},name:function(e){return e.posts[0].name},filename:function(e){return e.posts[0].image.imgnm},type_com:"txt",time_unit:1,add_op_img_url:function(e,t,n){for(var r=0;r<e.length;r++)e[r].image&&(e[r].op_img_url=site2[n].protocol+"//"+site2[n].domain_url+"/static/thumb/"+e[r].image.thumb)},footer:"catalog_html",footer_prep:"catalog_html",proto:"DEFAULT.thread_json"},catalog_html:{footer:function(e){return e.pn.getElementsByClassName("counters")[0]},footer_prep:function(e){e.footer.textContent=""},ths:function(e){if(!pref.pref2.meguca.historyAPI)for(var t=e.pn.getElementsByClassName("history"),n=t.length-1;n>=0;n--)"Expand"===t[n].textContent||"Last 100"===t[n].textContent?t[n].setAttribute("class",pref.script_prefix+"_link"):t[n].removeAttribute("class");var r=this.ths_array(e,e.pn.getElementsByTagName("article"));if("/all/"===site.board)for(var n=r.length-1;n>=0;n--)r[n].board=r[n].pn.getElementsByTagName("a")[0].getAttribute("href").replace(/\d+$/,"");return r},no:function(e){return e.pn.getElementsByTagName("a")[0].getAttribute("href").replace(/.*\//g,"")},time_bumped:function(e){},time_created:function(e){},nof_posts:function(e){return parseInt(e.footer.textContent.split("/")[0],10)},nof_files:function(e){return parseInt(e.footer.textContent.split("/")[1],10)},sub:function(e){var t=e.pn.getElementsByTagName("h3")[0];return t?common_func.escape(t.textContent):void 0},name:function(e){},com:function(e){return e.pn.childNodes[e.pn.childNodes.length-1].textContent},sticky:function(e){return!1},op_img_url:function(e){var t=e.pn.getElementsByTagName("img")[0];return t&&t.getAttribute("src")||""},get_op_src:function(e){return e.op_img_url.replace(/thumb/,"src")},dynamic_image_hover:!0,missing_info:1,img2src:function(e,t){if(t||(t=this.get_lth_from_node(e)),!t)return null;var n=e.src;return t.th&&t.th.posts[0].ext?n=n.replace(/thumb/,"src").replace(/\.\w+$/,t.th.posts[0].ext):t.th.missing_info&&scan.scan_ui("image_hover",{tgts:[t.key],options:{callback:function(){cataLog.image_hover_reentry(e)},priority:6}}),n}},post_html:{time_pn:function(e){var t=e.getElementsByTagName("time")[0];return Date.parse(t.title||t.textContent)+36e5*(pref.localtime_offset-site2.meguca.time_offset)},pn_name:function(e){return e.pn.getElementsByClassName("name")[0]}}},general_event_handler:{page:{mouseover:function(e){}},catalog:{image_hover_check_mode:function(e){return"catalog"===e.parentNode.parentNode.parentNode.parentNode.id?"catalog":"page"},recSearch_thread:function(e,t,n){var r=site2.DEFAULT.general_event_handler.common.recSearch_thread;return r(e,t,"op")||n&&r(e,t,n)||null},__proto__:site2.DEFAULT.general_event_handler.catalog}},favicon:{__proto__:site2.DEFAULT.favicon,none:"/static/favicon.ico",reply:"/static/css/ui/unreadFavicon.ico",reply_to_me:"/static/css/ui/replyFavicon.ico"},make_tack:function(){var e=document.createElement("div");return e.innerHTML='<svg class="sticky" xmlns="http://www.w3.org/2000/svg" width="8" height="8" viewBox="0 0 8 8"><path d="M1.34 0a.5.5 0 0 0 .16 1h.5v2h-1c-.55 0-1 .45-1 1h3v3l.44 1 .56-1v-3h3c0-.55-.45-1-1-1h-1v-2h.5a.5.5 0 1 0 0-1h-4a.5.5 0 0 0-.09 0 .5.5 0 0 0-.06 0z"></path></svg>',e.childNodes[0]}},site2.meguca2={home:"https://meguca.org/assets/favicons/default.ico",components:{boardlist:"#banner"},boards_json:void 0,check_func:function(e){var t=window.location.href;if(t.indexOf("/meguca.org/")!=-1){if(site.whereami=t.search(/[A-z]+\/(\?page=\d+)*$/)!=-1?"page":t.search(/[0-9]+(\?last=\d+)*$/)!=-1?"thread":t.search(/catalog\/*$/)!=-1?"catalog":"other",site.config("meguca.org",this.nickname,e),site.no="thread"===site.whereami?parseInt(t.replace(/.*meguca\.org\/\w*\/([0-9]+)/,"$1"),10):"","page"===site.whereami){var n=t.indexOf("?page=");site.page=n!=-1&&parseInt(t.substr(n+6),10)||0}else site.page=null;if(e)return;return site.max_page=3,site.header_height=function(){var e=document.getElementById("banner");return e?e.offsetHeight:0},!0}return!1},check_func_whereami:function(){},utilize_boards_json:!0,url_boards_json:function(){return["https://meguca.org/json/boardTimestamps","json"]},postprocess_board:function(e){var t=0;for(var n in e){var r=liveTag.mems.init({domain:this.nickname,board:"/"+n+"/"});r.o=t++,Object.defineProperty(r,"max",{value:e[n],writable:!0}),void 0===r.read_max&&Object.defineProperty(r,"read_max",{value:0,writable:!0})}},make_url4:function(e){var t=this.protocol+"//"+this.domain_url;return"page"===e[3].substr(0,4)&&0==e[2]&&(e[3]="catalog_json"),"catalog_json"===e[3]?[t+"/json"+e[1],"json","meguca"+e[1]+"j0"]:"thread_html"===e[3]?[t+e[1]+e[2],"html"]:"thread_json"===e[3]?[t+"/json"+e[1]+e[2],"json"]:void 0},catalog_get_native_area:function(){return document.getElementById("catalog"===site.whereami?"catalog":"page"===site.whereami?"index-thread-container":"threads")},catalog_get_native_scroll_area:function(){return"catalog"===site.whereami?document.getElementsByTagName("section")[1]:window},catalog_native_prep_wait_loop_timeout:100,catalog_native_prep_wait_loop:function(e,t){--this.catalog_native_prep_wait_loop_timeout<0||(("catalog"!==e||document.getElementsByName("sortMode")[0])&&("page"!==e||document.getElementById("catalog-controls")&&document.getElementById("index-thread-container"))&&("thread"!==e||document.getElementById("expand-images")&&document.getElementById("threads"))?t():setTimeout(function(){this.catalog_native_prep_wait_loop(e,t)}.bind(this),1e3))},catalog_native_prep:function(e,t,n,r){var a="catalog"===site.whereami?document.getElementsByName("sortMode")[0]:"page"===site.whereami?document.getElementById("catalog-controls").getElementsByTagName("input").search:document.getElementById("expand-images");if("catalog"!==site.whereami||a.nextSibling!==cataLog.components.ordering){if(!cataLog.components.initialized){n.setAttribute("style","float:right"),cataLog.components.pn12_0=n,cataLog.components.pn_hi=n.removeChild(n.childNodes[3]);var s=function(){cataLog.catalog_obj2.func_track_reset(),cataLog.insert_myself(null,null,null,!0),cataLog.show_catalog()},o=function(e){pref[site.whereami].embed&&(cataLog.general_event_handler.destroy(),cataLog.triage_parent_set(),cataLog.general_event_handler=new cataLog.GEH(cataLog.parent),cataLog.general_event_handler.init(),s(),site2.meguca.catalog_native_prep(null,t,n))};new MutationObserver(o).observe(document.getElementById("threads"),{childList:!0}),pref_func.settings.onchange_funcs.button_test=o;var i=document.getElementById("loading-image"),l="none"!==i.style.display,c=function(e){if("none"!==e[0].target.style.display)site2.meguca.historyAPI_blocking=!0,"thread"===site.whereami&&site2.meguca.prep_own_posts();else{if(site2.meguca.historyAPI_blocking=!1,!l){cataLog.DIH.image_hover_remove(),cataLog.general_event_handler.destroy();for(var r in cataLog.threads)pClg.remove_thread(r,!0);site2.meguca.check_func(!0),pref[site.whereami].embed&&(cataLog.set_embed_xxxx(),cataLog.triage_parent_set(),cataLog.general_event_handler=new cataLog.GEH(cataLog.parent),cataLog.general_event_handler.init(),"catalog"!==site.whereami&&"page"!==site.whereami||pref.test_mode[90]||s(),site2.meguca.catalog_native_prep(null,t,n)),recovery.reentry(),receive_message_emu()}l=!1}};new MutationObserver(c).observe(i,{attributes:!0})}if("catalog"===site.whereami?(a.parentNode.appendChild(n),a.parentNode.parentNode.insertBefore(cataLog.components.pn_hi,a.parentNode)):(a.parentNode.insertBefore(n,a),a.parentNode.insertBefore(cataLog.components.pn_hi,a)),"catalog"===site.whereami){var p=document.getElementById("catalog");p.parentNode.insertBefore(t,p)}else a.parentNode.insertBefore(t,document.getElementById("catalog"));"catalog"===site.whereami?site2.DEFAULT.catalog_native_prep_swap_sortSel(a):a.parentNode.insertBefore(cataLog.components.ordering,a.nextSibling),"catalog"!=site.whereami&&"page"!=site.whereami||(document.getElementById("banner").style="height:auto",pClg.kwd_init(document.getElementById("catalog-controls").getElementsByTagName("input").search,t)),cataLog.components.initialized=!0}},post_json2html:site2["4chan"].post_json2html,page_json2html3_skelton:site2["4chan"].page_json2html3_skelton,page_json2html3:site2["4chan"].page_json2html3,page_json2html3_replace_expander:site2["4chan"].page_json2html3_replace_expander,page_json2html3_add_omitted_info:site2["4chan"].page_json2html3_add_omitted_info,post_container:site2["4chan"].post_container,wrap_to_parse:site2.DEFAULT.wrap_to_parse,catalog_json2html3_thumbnail:function(e){return e.image?this.protocol+"//"+this.domain_url_image+(void 0===e.image.spoiler||pref[cataLog.embed_mode].open_spoiler_image?14===e.image.thumbType?"/audio.png":"/images/thumb/"+e.image.SHA1+(0===e.image.thumbType||void 0===e.image.thumbType&&0===e.image.fileType?".jpg":".png"):"/spoil/default.jpg"):void 0},catalog_json2html3_src:function(e){return e.image?this.protocol+"//"+this.domain_url_image+"/images/src/"+e.image.SHA1+(e.ext||Object.getOwnPropertyDescriptor(this.parse_funcs.post_json_template,"ext").get.call(e)):void 0},post_json2html_fname_server:function(e){return e.image?e.image.SHA1+(0===e.image.fileType?".jpg":".png"):void 0},post_json2html_fname:function(e){return e.image?e.filename+e.ext:void 0},parse_funcs:{page_html:{get_omitted_info:site2["4chan"].parse_funcs.page_html.get_omitted_info,set_omitted_info:site2["4chan"].parse_funcs.page_html.set_omitted_info,replace_omitted_info:site2["4chan"].parse_funcs.page_html.replace_omitted_info,replace_omitted_info2:site2["4chan"].parse_funcs.page_html.replace_omitted_info2},thread_json:{ths:function(e,t){var n=this.prep_th_posts(e);return n.nof_posts=n.posts.length,e.__proto__=t,[n]},prep_th_posts:function(e){var t=Object.create(e);t.sticky&&(t.sticky=!0),t.board="/"+e.board+"/",e.no=e.id||e.no,delete e.id;var n=[e];if(e.posts)for(var r=0;r<e.posts.length;r++){var a=e.posts[r];a.id&&(a.no=a.id,delete a.id),n[n.length]=a}return t.posts=n,t},get_op_src:function(e){return site2[e.domain].catalog_json2html3_src(e.posts[0])},op_img_url:"DEFAULT.common",time_unit:1e3,type_com:"txt",posts_full:null,has_editing:!0,posts_obj:function(e,t){for(var n={},r=e.posts.length;--r>=0;){var a=e.posts[r].no;if(n[a]=e.posts[r],a===t)break}return n},key:"DEFAULT.common"},catalog_json:{ths:function(e,t){var n=[],r=parseInt(t.page||0,10);e.threads&&(e=e.threads);for(var a=0;a<e.length;a++){var s=this.prep_th_posts(e[a]);s.page=r+Math.floor(a/15)+"."+a%15,e[a].__proto__=t,n[n.length]=s}return n},has_posts:!0,proto:"thread_json"},shortCatalog_json_template:{proto:"catalog_json_template"},page_json_template:{proto:"catalog_json_template"},catalog_json_template:{dont_have_com:!0,get nof_posts(){return this.postCtr},proto:"thread_json_template"},thread_json_template:{get time_posted(){return 1e3*this.replyTime},get time_bumped(){return 1e3*this.bumpTime},get time_created(){return 1e3*this.time},get nof_files(){return this.imageCtr},get com(){return this.body},proto:"post_json_template"},post_json:{anchor:function(e,t,n,r,a){return a||(a=(r?"/all/":e)+"#p"+n),'<em><a class="history post-link" data-id="'+n+'" href="'+a+'">&gt;&gt;'+n+'</a><a class="hash-link history" href="'+a+'"> #</a> </em>'}},post_json_template:function(){var e=["jpg","png","gif","webm","pdf","svg","mp4","mp3","ogg","zip","7z","tar.gz","tar.xz","flac","noFile","txt"];return{get filename(){return this.image?this.image.name:void 0},get w(){return this.image?this.image.dims[0]:void 0},get h(){return this.image?this.image.dims[1]:void 0},get tn_w(){return this.image?void 0===this.image.spoiler||pref[cataLog.embed_mode].open_spoiler_image?this.image.dims[2]||125:150:void 0},get tn_h(){return this.image?void 0===this.image.spoiler||pref[cataLog.embed_mode].open_spoiler_image?this.image.dims[3]||125:150:void 0},get fsize(){return this.image?this.image.size:void 0},get ext(){return this.image?"."+e[this.image.fileType]:void 0},get sub(){return this.subject?common_func.escape(this.subject):""},get capcode(){return this.auth},get md5(){return this.image?this.image.MD5:void 0},get sha1(){return this.image?this.image.SHA1:void 0},get country(){return this.flag?this.flag.toUpperCase():void 0},name:"Anonymous",get txt(){return this.body},get com(){function e(e,t,n){for(var r=a.links,o=0;o<r.length&&r[o].id!=n;)o++;return o<r.length?s(a.board,r[o].op,n,a.op!=r[o].op,null):e}function t(e){return"<strong>"+e+" ("+(this[n]?this[n++].val:"")+")</strong>"}var n,r=site2[site.nickname].parse_funcs.post_html.txt2com_anchor_class?'" class="'+site2[site.nickname].parse_funcs.post_html.txt2com_anchor_class:"",a=null,s="meguca"===site.nickname?site2.meguca.parse_funcs.post_json.anchor:function(e,t,n,a){return'<a href="'+(a?"/cross/":e)+t+"#p"+n+r+'">&gt;&gt;'+n+"</a>"},o=site2[site.nickname].parse_funcs.post_html.txt2com_spoiler_replace_txt||"<spoiler>$1</spoiler>",i="meguca"===site.nickname?"<em>$1</em>":'<span class="quote">$1</span>';return Object.defineProperty(site2.meguca.parse_funcs.post_json_template,"com",{get:function(){if(!this.body)return"";var r=common_func.escape_text(this.body);return this.links&&(a=this,r=r.replace(/(>>)([0-9]+)/g,e)),r=r.replace(/(^>[^>].*$)/gm,i),r=r.replace(/\*\*(.*?)((\*\*)|$)/gm,o),this.commands&&(n=0,r=r.replace(/^#(pyu|flip|\d*d\d+|8ball)$/gm,t.bind(this.commands))),r=r.replace(/(https*:\/\/[^\s]*)(\s|$)/gm,'<a href="$1" target="_blank">$1</a>$2'),r.replace(/\n/g,"<br>")},enumerable:!0,configurable:!0}),this.com},sticky:!1,get no(){return this.id},time:void 0,flag:void 0,flags:void 0,get parse_funcs_html(){return Object.defineProperty(site2.meguca.parse_funcs.post_json_template,"parse_funcs_html",{value:site2[site.nickname].parse_funcs[site.whereami+"_html"],writable:!0,enumerable:!0,configurable:!0}),this.parse_funcs_html},proto:"DEFAULT.common"}}()},mimic_always:!0,post_com2txt:function(e){return e.body?e.body.replace(/\*\*([^(\*\*)\n]*)((\*\*)|$)/gm," $1 "):""},proto:"meguca1"},common_func.Object_modifyDescriptor(site2.meguca2,"check_func",{writable:!1}),site2.meguca={domain_url_image:"meguca.org/assets",check_func:site2.meguca2.check_func,url_boards_json:function(){return["https://meguca.org/json/board-list","json"]},postprocess_board:function(e){for(var t=0;t<e.length;t++){var n=liveTag.mems.init({domain:this.nickname,board:"/"+e[t].id+"/"});n.o=t,e[t].tags&&0!=e[t].tags.length&&liveTag.postprocess_board_add_btag(e[t].tags,n)}},utilize_boards_json:!1,catalog_get_native_scroll_area:void 0,make_url4:function(e){var t=this.protocol+"//"+this.domain_url;return"catalog_json"===e[3]?[t+"/json/boards"+e[1]+"catalog","json"]:"page_json"===e[3]?[t+"/json/boards"+e[1]+"?page="+e[2],"json"]:"thread_html"===e[3]?[t+e[1]+e[2],"html"]:"thread_json"===e[3]?[t+"/json/boards"+e[1]+e[2],"json"]:"page_html"===e[3]?[t+e[1],"html"]:void 0},historyAPI:!1,historyAPI_blocking:!1,short_link:function(e,t,n,r,a){return'<a href="'+this.make_url4(common_func.name2dbt(e))[0]+'?last=100" class="history lastN-link '+pref.script_prefix+'_link">'+r+"100"+a+"</a>"},wrap_to_parse:{get:site2.DEFAULT.wrap_to_parse.get,posts:function(e,t){site2.DEFAULT.wrap_to_parse.posts(e,t||e.localArchive&&1||void 0,{op:e.no||e.id})}},lth_init:function(e){liveTag.mems.init({board:"/cross/",domain:e.domain}),Object.defineProperty(liveTag.mems.meguca,"/cross/",{value:liveTag.mems.meguca["/cross/"],configurable:!0,enumerable:!1,writable:!0})},prep_own_posts:function(e){window.opener&&"meguca"===window.name?setTimeout(this.prep_own_posts_IDB.bind(this),0):this.prep_own_posts_IDB()},prep_own_posts_IDB:function(e){IDB.req_raw("meguca","meguca","mine",null,this.prep_own_posts_IDB_callback.bind(this),"get_all")},prep_own_posts_IDB_callback:function(e,t,n,r){var a={};for(var s in r)a[r[s].id]=null;site3[this.nickname].own_posts={ALL:a},window.opener&&"meguca"===window.name&&this.prep_own_posts_event()},popups_post_pnode:function(e){for(;"ARTICLE"!==e.tagName&&e.parentNode;)e=e.parentNode;return e},add_backlinks_pn:function(e,t){var n=e.getElementsByClassName("backlinks")[0];return n?{pn:n,hrefs:this.add_backlinks_hrefs(n,t)}:(n=document.createElement("span"),n.setAttribute("class","spaced backlinks"),e.appendChild(n),{pn:n,hrefs:{}})},add_backlinks_hrefs:function(e,t){var n={};if(t)for(var r=e.getElementsByTagName("a"),a=0;a<r.length;a++)n[r[a].getAttribute("href")]=null;else e.innerHTML="";return n},add_backlinks_add_1:function(e,t,n){var r=document.createElement("span");r.innerHTML=site2.meguca.parse_funcs.post_json.anchor(t[1],t[2],t[3],null,n),r=r.childNodes[0],("meguca"!==t[0]||pref.test_mode[91])&&(r.childNodes[0].onclick=this.backlink_onclick,r.childNodes[1].onclick=this.backlink_onclick),e.pn.appendChild(r)},add_backlinks:function(e,t,n,r){for(var a=this.add_backlinks_pn(e,n),s=n||0;s<t.length;s++){var o=this.popups_backlink2dbtpth(t[s],r),i=o[0],l=site2[i].link_dbtp2href_abs(o);if(null!==a.hrefs[l]&&this.add_backlinks_add_1(a,o,l),n)break}},popups_href2dbtp:function(e){var t=e.split(/[\/#]/),n=t[t.length-1].substr(1),r="/"+t[t.length-3]+"/",a=t[t.length-2];return a||(a=-1),["meguca",r,a,n]},toplevel_anchor_pos:2,link_dbtp2href:function(e){return e[1]+e[2]+"#p"+e[3]},popups_post_fetch:function(e,t){httpd.req({initiator:"popup",tgts:[{url:"https://meguca.org/json/post/"+t[3],responseType:"json",tgt:t[0]+"/*/"+t[2]+"#"+t[3],data_type:"json",domain:e.domain}],callback_1:site2[e.domain].popups_post_fetch_callback.bind(site2[e.domain]),IDX:0,FINISHED:0,SUC:0,max:1,dbt:t},8)},popups_post_fetch_callback:function(e,t,n){var r={domain:n.dbt[0],board:n.dbt[1],no:n.dbt[2],type_data:"json",domain_html:site.nickname,key:n.dbt[0]+n.dbt[1]+n.dbt[2]};delete t.response.board;var a={posts:[r,t.response],__proto__:r};site2[a.domain].wrap_to_parse.posts(a);var s=liveTag.mems.init(a);this.popups_fetched(a,s,1)},post_json2html_imagesearch_href:{google:function(e){return"https://www.google.com/searchbyimage?image_url="+e},iqdb:function(e){return"http://iqdb.org/?url="+e},saucenao:function(e){return"http://saucenao.com/search.php?db=999&amp;url="+e},whatAnime:function(e){return"https://whatanime.ga/?url="+e},desustorage:function(e){return"https://desuarchive.org/_/search/image/"+e},exhentai:function(e){return"http://exhentai.org/?fs_similar=1&amp;fs_exp=1&amp;f_shash="+e}},post_json2html_imagesearch_1:function(e,t,n){return'<a class="image-search '+e+'" target="_blank" rel="nofollow" href="'+this.post_json2html_imagesearch_href[e](t)+'">'+n+"</a>"},post_json2html_imagesearch:function(e,t,n,r){return(e.google?this.post_json2html_imagesearch_1("google",t,"G"):"")+(e.iqdb?this.post_json2html_imagesearch_1("iqdb",t,"Iq"):"")+(e.saucenao?this.post_json2html_imagesearch_1("saucenao",t,"Sn"):"")+(e.whatAnime?this.post_json2html_imagesearch_1("whatAnime",t,"Wa"):"")+(e.desustorage&&n?this.post_json2html_imagesearch_1("desustorage",n,"Ds"):"")+(e.exhentai&&r?this.post_json2html_imagesearch_1("exhentai",r,"Ex"):"")},post_json2html:function(e,t,n,r,a){var s=document.createElement("div"),o=e.parse_funcs&&e.parse_funcs.time_unit||1,i=new Date((e.time||0)*o),l=(e.name,""),c="";if(e.ext){var p=(.005+(e.fsize>1048576?e.fsize/1048576:e.fsize/1024)).toString();p=p.substr(0,p.indexOf(".")+3)+(e.fsize>1048576?" MB":" KB");var _=site2[e.domain].catalog_json2html3_src(e,t),d=site2[e.domain].catalog_json2html3_thumbnail(e,t);n||(e.tn_w>e.tn_h?e.tn_w:e.tn_h);l='<figcaption class="spaced"><a class="image-toggle act" hidden=""></a>'+(pref[cataLog.embed_mode].imagesearch.use?'<span class="spaced image-search-container">'+this.post_json2html_imagesearch(pref[cataLog.embed_mode].imagesearch,_,e.md,e.sha1)+"</span>":"")+'<span class="fileinfo"><span class="filesize">'+p+'</span><span class="dims">'+e.w+"x"+e.h+'</span></span><a href="'+("meguca"===e.domain?_.replace(/images\.meguca\.org/,"meguca.org"):_)+'" download="'+e.filename+e.ext+'">'+e.filename+e.ext+"</a></figcaption>",c='<figure><a target="_blank" href="'+_+'"><img src="'+d+'" width="'+e.tn_w+'" height="'+e.tn_h+'"></a></figure>'}return s.innerHTML='<article id="p'+e.no+'" class="glass'+(e.ext?" media":"")+'"><input type="checkbox" class="deleted-toggle"><header class="spaced"><input type="checkbox" class="mod-checkbox hidden"><b class="name">'+e.name+"</b>"+(e.country?'<img class="flag" src="/assets/flags/'+e.country.toLowerCase()+'.svg" title="'+e.country+'">':"")+"<time>"+site2.common.change_utc_to_local(i)+'</time><nav><a class="history" href="#p'+e.no+'">No.</a><a class="history quote" href="#p'+e.no+'">'+e.no+"</a></nav>"+(n?'<span><span class="act"><a class="history expand-link" href="'+t+e.no+'">Expand</a></span>'+(r?'<span class="act">'+r+"</span>":"")+"</span>":"")+'<a class="control"><svg xmlns="http://www.w3.org/2000/svg" width="8" height="8" viewBox="0 0 8 8"><path d="M1.5 0l-1.5 1.5 4 4 4-4-1.5-1.5-2.5 2.5-2.5-2.5z" transform="translate(0 1)"></path></svg></a></header>'+l+'<div class="post-container">'+c+"<blockquote>"+e.com+"</blockquote></div></article>",s.removeChild(s.childNodes[0])},post_container:function(e){return e},update_posts_remove:function(e,t,n){n.removeChild(e.posts[t].pn)},update_posts_insert:function(e,t,n,r,a){var s=r<t.length?t[r].pn:a.getElementsByTagName("aside")[0];e[n].pn||(e[n].pn=this.post_json2html(e[n],e[n].board));var o=e[n].pn;a.insertBefore(o,s)},page_json2html3_skelton:function(e,t){var n=document.createElement("section");return n.setAttribute("class","index-thread"),n.setAttribute("data-id",e.no),n.innerHTML='<input type="checkbox" class="deleted-toggle"><aside class="act posting glass"><a href="'+e.board+e.no+'?last=100#bottom">Reply</a></aside>',t?[n,n.childNodes[1]]:n},page_json2html3:function(e){var t=this.page_json2html3_skelton(e,!0),n=t[0],r=t[1],a=this.post_json2html(e.posts&&e.posts[0]?e.posts[0]:e,e.board,!0,site2[e.domain].short_link(e.key,e.nof_posts,2,"Last ",""),e.no);if(n.insertBefore(a,r),e.posts[0].pn=a,e.posts){for(var s=1;s<e.posts.length;s++){var o=this.post_json2html(e.posts[s],e.board);n.insertBefore(o,r),e.posts[s].pn=o}this.page_json2html3_add_omitted_info(e,e.posts,e.posts)}return n},page_json2html3_replace_expander:function(e,t,n){var r=this.parse_funcs.page_html.get_omitted_info(e[0]);r&&r.appendChild(cnst.config_expander(n,t))},page_json2html3_add_omitted_info:function(e,t,n){for(var r=0,a=0;a<n.length;a++)r+="html"===n[a].type_data?n[a].pn.getElementsByClassName("figure").length:n[a].filename?1:0;var s=e.nof_files-r,o=e.nof_posts-n.length,i=t?this.parse_funcs.page_html.get_omitted_info(t[0]):null;return 0!=o?(i||(i=document.createElement("span"),i.setAttribute("class","omit"),i.setAttribute("data-omit",o),i.setAttribute("data-image-omit",s),i.innerHTML=' <span class="act"><a href="'+n[0].no+'" class="history">See All</a></span>',("meguca"!==e.domain||pref[cataLog.embed_mode].use_expander_always)&&i.appendChild(cnst.config_expander(e.key)),t&&this.parse_funcs.page_html.set_omitted_info(t[0],i)),i.childNodes[0].textContent=o+(1==o?" post":" posts")+(s?" and "+s+" image"+(1!==o?"s":""):"")+" omitted "):i&&(i.childNodes[0].textContent="Showing all posts."),i},catalog_json2html3:function(e,t,n,r){var a=document.createElement("article");a.id="p"+e.no,a.setAttribute("class","glass media op"+(e.deleted?" deleted":"")),a.setAttribute("data-id",e.no);var s=site2[e.domain].make_url4([e.domain,e.board,e.no,"thread_html"])[0];if(n)var o=e.tn_w||e.posts[0].tn_w,i=e.tn_h||e.posts[0].tn_h,l=150/(o>i?o:i);var c=site2[e.domain].historyAPI&&pref.pref2.meguca.historyAPI?"history":"",p=c+(c?" ":"")+pref.script_prefix+"_link",_=site2[e.domain].short_link(e.key,e.nof_posts,1,"Last ","");return a.innerHTML='<input type="checkbox" class="deleted-toggle">'+(n?'<figure><a class="'+c+'" href="'+t+e.no+'"><img width="'+o*l+'" height="'+i*l+'" class="catalog" src="'+n+'"></a></figure>':"")+'<span class="spaced thread-links hide-empty"><b class="board">'+t+'</b><span class="counters" title="Posts/Images">'+(r?e.nof_posts-1+"/"+(e.nof_files-1):"")+'</span><span class="act">'+("meguca"===e.domain?'<a class="'+c+' lastN-link" href="'+t+e.no+'?last=100">Last 100</a></span>':'<a href="'+s+'" class="'+p+' lastN-link">Expand</a>'+(_?"] ["+_:""))+"</span></span><br>"+(e.sub?"<h3>"+e.sub+" </h3>":"")+"<blockquote>"+(e.com?e.com:"")+"</blockquote>",a},parse_funcs:{shortCatalog_json:{has_posts:!1,proto:"meguca2.catalog_json"},catalog_json:{has_posts:!1},catalog_html:{ths_json:"thread_html",ths:function(e){for(var t=site2.meguca2.parse_funcs.catalog_html.ths(e),n=this.ths_json(e,t.map(function(e){return e.pn}),"shortCatalog_json","catalog_html"),r=0;r<n.length;r++)n[r].page=Math.floor(r/15)+"."+r%15;return n},get_omitted_info:function(){},set_omitted_info:function(){},pn_name:"thread_html"},page_json:{proto:"meguca2.catalog_json"},post_json:{pn:"DEFAULT.post_json"},page_html:{ths:function(e){for(var t=this.ths_json(e,document.getElementsByClassName("index-thread"),"page_json","page_html"),n=0;n<t.length;n++)t[n].page=site.page+"."+n;return t},get_max_page:function(e){var t,n=e.getElementsByClassName("pagination")[0];return n?(t=n.childNodes.length,t<=1?t:t-1):1},proto:"thread_html"},thread_html:{ths_json:function(e,t,n,r){var a=JSON.parse(e.pn.getElementById("post-data").innerHTML);a=site2.meguca.wrap_to_parse.get(a,"meguca",e.board,n);for(var s={},o=0;o<t.length;o++)s[t[o].dataset.id]=t[o];for(var o=0;o<a.length;o++){a[o].pn=s[a[o].no];var i=a[o].pn&&a[o].pn.getElementsByTagName("article");if(i){for(var l=0;l<a[o].posts.length;l++)a[o].posts[l].pn=i[l];Object.defineProperty(a[o],"footer",{value:this.footer(a[o]),configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(a[o],"type_mimic",{value:r,configurable:!0,enumerable:!0,writable:!0})}}return a[0].__proto__.__proto__.__proto__.parse_funcs_html=site2.meguca.parse_funcs[r],a},ths:function(e){return this.ths_json(e,[document.getElementById("thread-container")],"thread_json","thread_html")},footer:function(e){return site2.DEFAULT.parse_funcs.page_html.insert_footer4(e.pn.getElementsByClassName("deleted-toggle")[0])},get_thread_links:function(e){return e.pn.querySelectorAll(".expand-link,.lastN-link,."+pref.script_prefix+"_link")},get_omitted_info:function(e){return e.pn&&e.pn.getElementsByClassName("omit")[0]||void 0},set_omitted_info:function(e,t){t&&e.pn.appendChild(t)},replace_omitted_info:function(e,t){e.childNodes[0].textContent=t.childNodes[0].textContent},replace_omitted_info2:function(e,t,n){if(t)"none"===e.childNodes[1].style.display&&(e.insertBefore(e.childNodes[0].childNodes[0],e.firstChild),e.removeChild(e.childNodes[1]),e.childNodes[1].removeAttribute("style")),this.replace_omitted_info(e,t);else{var r=document.createElement("span");r.setAttribute("style","display:none"),e.insertBefore(r,e.childNodes[1]),r.appendChild(e.childNodes[0]),e.childNodes[1].setAttribute("style","display:none")}},pn_name:function(e){return e.pn.getElementsByClassName("name")[0].childNodes[0]}},thread_json:{prep_to_archive:function(e){return e[0].posts=e.slice(1),e[0]},proto:"meguca2.thread_json"}},favicon:{__proto__:site2.DEFAULT.favicon,none:"/assets/favicons/default.ico",reply:"/assets/favicons/unread.ico",reply_to_me:"/assets/favicons/reply.ico"},proto:"meguca2"},common_func.Object_modifyDescriptor(site2.meguca,"check_func",{writable:!1}),site2.imeguca={nickname:"imeguca",domain_url:"images.meguca.org",home:"https://images.meguca.org/assets/favicons/default.ico",check_func:site2.DEFAULT.check_func}),(pref.features.domains.lain||pref.features.domains.lainjp)&&(site2.lain={nickname:"lain",home:site.protocol+"//lainchan.org/q/index.html",X_FRAME_OPTIONS:!0,CONTENT_SECURITY_POLICY_FRAME:!0,protocol:"https:",domain_url:"lainchan.org",postform_rules:null,features:{page:!1,graph:!0,setting2:!1},boards_json:site2.DEFAULT.generate_boards_json([["λ",5],["diy",2],["sec",6],["tech",6],["inter",2],["lit",3],["music",3],["vis",3],["hum",3],["drg",3],["zzz",2],["layer",1],["q",7],["r",7]],3),check_func:function(){
var e=window.location.href;return e.indexOf(this.domain_url)!==-1&&e.search(new RegExp(this.domain_url+"/*$"))==-1&&(site.whereami=e.indexOf("/catalog")!=-1?"catalog":e.indexOf("/res/")!=-1?"thread":"404"===document.title?"404":"page","thread"===site.whereami&&(site.no=parseInt(e.replace(/.*res\//,"").replace(/\.html/,""),10)),site.config(this.domain_url,this.nickname),site.max_page=7,site.header_height=function(){var e=document.getElementsByClassName("boardlist")[0];return e?e.offsetHeight:0},site.embed_to="thread"===site.whereami||"page"===site.whereami?{top:function(){return document.getElementsByName("postcontrols")[0]},bottom:function(){return document.getElementsByTagName("footer")[0]}}:"catalog"===site.whereami?{top:function(){return document.getElementsByTagName("header")[0].nextSibling},bottom:function(){return document.getElementsByTagName("footer")[0]}}:{},"thread"!==site.whereami&&"page"!==site.whereami||(site.postform=document.getElementsByTagName("form").post,site.postform&&this.postform_prep()),"lain"===this.nickname&&(styleSheet.add_to_watch(document.getElementById("stylesheet")),styleSheet.add_to_watch(document.getElementById("code_stylesheet"))),!0)},styles:[["a.dotted","border-bottom:1px dashed;"]],catalog_posts_in_thread:function(e){return e.getElementsByClassName("replyContainer")},max_page:function(){return 10},all_boards:["/popular/","/all/","/mega/","/random/","/culture/","/psy/"],make_url4:function(e){return site2.lain.all_boards.indexOf(e[1])!=-1&&"catalog_html"!==e[3]?void 0:site2.vichan.make_url4.call(this,e)},catalog_native_prep:function(e,t,n,r){var a="catalog"===site.whereami?document.getElementsByClassName("threads")[0]:document.getElementsByName("postcontrols")[0];if(site2.DEFAULT.catalog_native_prep_sel(t,n,"catalog"===site.whereami?document.getElementById("sort_by"):null),"catalog"===site.whereami){if(document.getElementById("image_size").addEventListener("change",site2.lain.catalog_native_size_changed,!1),n.style.display="inline",n.childNodes[3].style.display="inline","lain"===this.nickname)document.getElementsByClassName("controls")[0].appendChild(n);else{var s=document.getElementsByClassName("threads")[0];s.parentNode.insertBefore(n,s)}a.parentNode.insertBefore(t,a)}else{var o=document.getElementsByName("postcontrols")[0];if("lain"===this.nickname){var i=document.getElementsByClassName("blotter")[0],l=document.createElement("div");l.setAttribute("style","float:left"),l.appendChild(i.nextSibling.nextSibling),l.appendChild(i.nextSibling.nextSibling),"page"===site.whereami&&l.appendChild(document.createTextNode(" | ")),i.parentNode.insertBefore(l,i.nextSibling.nextSibling),l.parentNode.insertBefore(t,l.nextSibling),l.parentNode.insertBefore(n,l.nextSibling)}else o.parentNode.insertBefore(t,o),o.parentNode.insertBefore(n,o)}},catalog_native_size:document.getElementById("image_size")?document.getElementById("image_size").value:"small",catalog_native_size_changed:function(){site2[site.nickname].catalog_native_size=this.value},parse_funcs:{catalog_html:{sticky:function(e){return e.footer.textContent.indexOf("(sticky)")!=-1},ths:function(e){var t=this.__proto__.ths(e);if(site2.lain.all_boards.indexOf(site.board)!=-1)for(var n=t.length-1;n>=0;n--)t[n].board="/"+t[n].pn.getAttribute("data-board")+"/";for(var n=0;n<t.length;n++)t[n].page=Math.floor(n/10)+"."+n%10;return t}},page_html:{ths:function(e){var t=this.__proto__.ths(e);if(site2.lain.all_boards.indexOf(site.board)!=-1){for(var n=t.length-1;n>=0;n--){var r=site.nickname+"/"+t[n].pn.getAttribute("data-board")+"/"+t[n].no;cataLog.threads[r]?t.splice(n,1):t[n].board="/"+t[n].pn.getAttribute("data-board")+"/"}0===t.length&&cataLog.show_catalog()}return t}},catalog_json:{time_unit:1e3},post_html:{img2src:function(e){var t=e.parentNode.href;return t.search(/.webm/)!=-1&&(t=t.replace(/.*player.php\?v=/,"").replace(/&t=.*/,"")),t}}},colorID:function(e){var t=e.getElementsByClassName("poster_id")[0];if(t&&t.style&&!t.style.backgroundColor){site2.vichan.colorID(e);var n=t.previousSibling;t.textContent="ID: "+t.textContent," ID: "===n.textContent&&(n.textContent="")}},catalog_json2html3_thumbnail:function(e,t){return".jpg"===e.ext||".jpeg"===e.ext||".gif"===e.ext||".png"===e.ext||".pdf"===e.ext?"https://"+this.domain_url+t+"thumb/"+e.tim+".png":".epub"===e.ext?"https://"+this.domain_url+"/static/lain_epub.jpg":""},catalog_from_json3:function(e,t){return site2[this.nickname].wrap_to_parse.get(e,this.nickname,t,"catalog_json")},favicon:{__proto__:site2.DEFAULT.favicon,none:"/favicon.png",reply:"png;base64,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",
reply_to_me:"png;base64,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"},proto:"vichan"}),pref.features.domains.lainjp&&(site2.lainjp={nickname:"lainjp",home:site.protocol+"//lainchan.jp/lainicon.ico",X_FRAME_OPTIONS:!0,CONTENT_SECURITY_POLICY_DATAURI:!0,CONTENT_SECURITY_POLICY_FRAME:!0,protocol:"https:",domain_url:"lainchan.jp",postform_rules:null,features:{page:!1,graph:!0,setting2:!1,postform:!0},boards_json:site2.DEFAULT.generate_boards_json([["cyb",2],["tech",2],["cult",2],["λ",1],["μ",1],["psy",1],["feels",1],["q",2],["r",1]],2),check_func:site2.lain.check_func,components:{boardlist:"#overheader",__proto__:site2.vichan.components},parse_funcs:{catalog_html:{sticky:function(e){return e.pn.getElementsByTagName("strong")[0].textContent.search(/\(sticky\)/)!=-1},proto:"lain.catalog_html"}},post_container:function(e,t){return e},update_posts_remove:function(e,t,n,r){var a=e.posts[t].pn;0==t&&a.classList.contains("op")?this.update_posts_insert_pack(a):n.removeChild(a.nextSibling),n.removeChild(a)},catalog_json2html3_thumbnail:function(e,t){return".jpg"===e.ext||".jpeg"===e.ext||".gif"===e.ext||".png"===e.ext?"https://"+this.domain_url+t+"thumb/"+e.tim+".png":".pdf"===e.ext?"https://"+this.domain_url+"/static/pdf.png":""},favicon:{__proto__:site2.lain.favicon,none:"/lainicon.ico"},proto:"lain"}),window.location.href.search(/localhost/)!=-1&&(pref.test_mode[94]=!0,pref.catalog.embed_page=!1,pref.virtualBoard.scan_domains.dist="none"),pref.test_mode[94]&&(site2.dist={nickname:"dist",domain_url:"localhost",boards_json:site2.DEFAULT.generate_boards_json([["a",1],["undefined",1]],3),check_func:function(){site2.DEFAULT.check_func.call(this),site.postform=document.getElementsByClassName("postForm")[0]},make_url4:function(e,t){var n=site.protocol+"//"+this.domain_url+e[1];return("catalog_html"===e[3]||t&&0==e[2]&&"page_json"===e[3])&&(e[3]="catalog_json"),"page_json"===e[3]?[n+(parseInt(e[2],10)+1)+".json","json",t?this.nickname+e[1]+"j0":void 0]:"catalog_json"===e[3]?[n+"catalog.json","json",this.nickname+e[1]+"j0"]:"thread_json"===e[3]?[n+e[2]+".json","json"]:"page_html"===e[3]?[n+(0!=e[2]?parseInt(e[2],10)+1:""),"html"]:"thread_html"===e[3]?[n+e[2],"html"]:null},parse_funcs:{other_html:{}},testPoster:function(){function e(){var e=new Date;return e.toLocaleTimeString()+"."+("00"+e.getMilliseconds()).slice(-3)}function t(e){var t=!1;return function(n){return e.insertBefore(n,e.firstChild),t?e.removeChild(e.lastChild):(t=e.childNodes.length>=10,null)}}var n=[],r=document.getElementsByClassName("message")[1];if(r){r.innerHTML="<div></div><div></div><div></div><div></div>";var a=t(r.childNodes[0]),s=t(r.childNodes[1]),o=t(r.childNodes[2]),i=t(r.childNodes[3])}var l=new Map,c=[],p=document.getElementsByClassName("a_update")[0],_=DelayBuffer.prototype.delayed_do.bind(new DelayBuffer(function(){function t(t){var r=t.target,a=l.get(r),s=a.pn,o=a.data,i=200==r.status?r.response&&r.response.message:r.status,d=s.textContent,u=d.indexOf(": ")+2;if(d=[d.slice(0,u),d.slice(u)],i&&i.indexOf("OK.")!=-1){d[1]=d[1].replace(/(makeThread|post|prune)/,"");var i=i.split(" ");i[1]=i[1].slice(0,8),i[4]=i[4].slice(0,8),i[5]="op/sec,",i=i.join(" ")}s.textContent=d[0]+e()+": "+i+d[1],p.textContent=o.thread,o.board===site.board.slice(1,-1)&&"prune"!==o.action&&p.click(),n.length>0&&_(pref.test_mode.num||500),l.delete(r),c.push(r)}var r=n.shift(),d=r.op,u=r.post;if(u){u.no===d&&(u.new_thread=!0);var f={type:"json",action:u.new_thread?"makeThread":u.pruned?"prune":"post",board:u.board.slice(1,-1),thread:d,body:n.length+": "+u.com,subject:u.sub,debug:d};u.com&&u.com.indexOf(" is ")!=-1&&(f.tag=u.com.substr(u.com.indexOf(" is ")+4).split(/[\W]/)[0]);var h=document.createElement("div"),m=f.action+"/"+f.board+"/"+f.thread,g=c.shift()||function(){var e=new XMLHttpRequest;return e.addEventListener("load",t,!1),e.addEventListener("error",t,!1),e.addEventListener("abort",t,!1),e.responseType="json",e}();l.set(g,{pn:h,data:f}),g.open("POST","//localhost/post.php",!0),g.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),g.send(function(e){var t=[],n=0;for(var r in e)t[n++]=encodeURIComponent(r)+"="+encodeURIComponent(e[r]);return t.join("&").replace(/%20/g,"+")}(f)),h.textContent=e()+": "+m+(f.tag?" "+f.tag:"");var b=a(h);b&&(b.textContent.indexOf("OK.")===-1?i(b):b.textContent.indexOf("prune")!==-1?o(b):b.textContent.indexOf("makeThread")!==-1&&s(b))}},500));return function(e,t){"string"==typeof e?n=n.concat({post:{board:"/"+e.split("/")[1]+"/",pruned:!0},op:e.split("/")[2]}):e&&(n=n.concat({post:e,op:t})),_(pref.test_mode.num||500)}}(),features:{catalog:!0},parse_funcs:{catalog_json:{ths:function(e,t){for(var n=[],r=parseInt(t.page||0,10),a=0;a<e.length;a++){var s=Object.create(e[a]);s.sub=e[a].subject,s.board="/"+e[a].board+"/",s.page=r+Math.floor(a/15)+"."+a%15,s.posts=[e[a]],e[a].__proto__=t,n[n.length]=s}return n},op_img_url:function(){return"/distchan.png"},key:function(e){return e.domain+e.board+e.no},has_posts:!1,__proto__:site2.meguca.parse_funcs.catalog_json},thread_json:{ths:function(e,t){return site2.DEFAULT.parse_funcs.thread_json.ths({posts:e,nof_posts:e.length,board:"/"+e[0].board+"/"},t)},__proto__:site2.meguca.parse_funcs.thread_json},__proto__:site2.meguca.parse_funcs},catalog_json2html3:site2.meguca.catalog_json2html3,__proto__:site2["4chan"]});for(var i in site2)if(!pref.test_mode[94]||"dist"!==i){for(var j in site2[i].parse_funcs)if("string"!=typeof site2[i].parse_funcs[j]){for(var k in site2[i].parse_funcs[j])if("proto"!==k&&"string"==typeof Object.getOwnPropertyDescriptor(site2[i].parse_funcs[j],k).value){tgt=site2[i].parse_funcs[j][k].split(".");var tgt_obj=3===tgt.length?site2[tgt[0]].parse_funcs[tgt[1]][tgt[2]]:2===tgt.length&&site2[i].parse_funcs[tgt[0]]&&site2[i].parse_funcs[tgt[0]][tgt[1]]?site2[i].parse_funcs[tgt[0]][tgt[1]]:2===tgt.length&&site2[tgt[0]]&&site2[tgt[0]].parse_funcs[tgt[1]]&&site2[tgt[0]].parse_funcs[tgt[1]][k]?site2[tgt[0]].parse_funcs[tgt[1]][k]:1===tgt.length?site2[i].parse_funcs[tgt[0]]&&site2[i].parse_funcs[tgt[0]][k]:null;tgt_obj&&(site2[i].parse_funcs[j][k]=tgt_obj)}if("DEFAULT"!==i||"common"!==j){var proto=site2[i].parse_funcs[j].hasOwnProperty("proto")?site2[i].parse_funcs[j].proto:site2[i].hasOwnProperty("proto")&&"DEFAULT"!==i?site2[i].proto+"."+j:site2.DEFAULT.parse_funcs[j]&&"DEFAULT"!==i?"DEFAULT."+j:"DEFAULT.common";proto="_template"===j.slice(-9)&&"DEFAULT.common"===proto?site2.DEFAULT.wrap_to_parse.get_getters():proto.indexOf(".")==-1?site2[i].parse_funcs[proto]:site2[proto.substr(0,proto.indexOf("."))].parse_funcs[proto.substr(proto.indexOf(".")+1)],site2[i].parse_funcs[j].__proto__=proto,delete site2[i].parse_funcs[j].proto}}else{var tgt=site2[i].parse_funcs[j];site2[i].parse_funcs[j]=site2[i].parse_funcs[tgt]}"DEFAULT"!==i&&(proto=site2[i].hasOwnProperty("proto")?site2[i].proto:"DEFAULT",site2[i].parse_funcs&&(site2[i].parse_funcs.__proto__=site2[proto].parse_funcs),site2[i].patch&&(site2[i].patch.__proto__=site2[proto].patch),site2[i].__proto__=site2[proto],delete site2[i].proto)}site2.ALL={};var site3={};for(var i in site2)"DEFAULT"!==i&&"common"!==i&&"meguca1"!==i&&"meguca2"!==i&&(site3[i]={boards:null,tags:{cs:[],ci:[]},own_posts:{}},site2[i].hasOwnProperty("check_func")&&(site2[i].check_func(),delete site2[i].check_func),site.nicknames.push(i),site2.ALL[site2[i].domain_url]=i);if(site.embed_to.top||(site.embed_to.top=function(){return site.root_body&&site.root_body.firstChild}),site.embed_to.bottom||(site.embed_to.bottom=function(){return site.root_body&&site.root_body.lastChild}),pref.pref2.KC.summer_time&&(site2.KC.time_offset=2),pref_func.site2_json(!1,!0,["site2","pref_func","site3"]),window.top!=window.self){if(site.nicknames.indexOf(window.name)==-1&&window.name!==site.embed_frame)return;for(var i in site2)site.nicknames.indexOf(i)!=-1&&i!=site.nickname&&delete site2[i]}var pipe_name=pref.script_prefix+".graph."+site.board+"__pipe__",info_raw=site.nickname+site.board;window.SharedWorker||(pref.info_server=!1,pref.info_client=!1),site0.isStep||pref_func.obj_init(),pref3.stats.use=pref.stats.use,pref3.stats.estimate_posts=pref.stats.estimate_posts;var notifier=function(){var e=pref.features.notify.sound?function(){function e(){var e=[],t=function(t){function n(t,n,r){if(1==r)for(var a=0;a<n;a++)e.push("");for(var a=0;a<n;a++)1==r?e[e.length-1-a]=(t%256).toString(16):e.push((t%256).toString(16)),t=Math.floor(t/256)}var r=Math.floor(44100*t);return n(1380533830,4,1),n(r+46,4,0),n(1463899717,4,1),n(1718449184,4,1),n(18,4,0),n(1,2,0),n(1,2,0),n(44100,4,0),n(44100,4,0),n(1,2,0),n(8,2,0),n(0,2,0),n(1684108385,4,1),n(r,4,0),r}(pref.notify.sound.beep_length_f);!function(t,n,r){r*=127;for(var a=0;a<n;a++){var s=Math.floor(Math.sin(6.283185308*t*a/44100)*r+128)%256;e.push(s.toString(16))}}(pref.notify.sound.beep_freq,t,pref.notify.sound.beep_volume_f);for(var n=0;n<e.length;n++)1==e[n].length&&(e[n]="0"+e[n]);return new Audio("data:audio/wav,%"+e.join("%"))}function t(){if("file"===pref.notify.sound.src){var t=pref3.notify.sound.file&&pref3.notify.sound.file.files[0];if(t)return new Audio(URL.createObjectURL(t))}return e()}function n(e,t){a&&a.pause(),"pause"!==(t=t.slice(13))&&(a=null,!pref.notify.sound.notify||"notify"!==t&&"src"!==t&&0!==t.indexOf(pref.notify.sound.src)||r())}function r(){a||(a=t()),a.play()}var a=null;return pref_func.settings.onchange_funcs["notify.sound.*w/"]=n,{play:r}}():{play:function(){}},t=pref.features.notify.favicon?function(){function e(e){if(o!==e){var t=site2[site.nickname].favicon[e];"/"!==t[0]&&(t="data:image/"+t),r.setAttribute("href",t),o=e}}function t(){var t=new liveTag.CountNR;if(pref.liveTag.watch_all)t.count_all();else{var r=cataLog.threads;if(r)for(var a in r)t.count(r[a][19])}pref.notify.favicon&&e(0!=t.nrtm?"reply_to_me":0!=t.nr?"reply":"none"),pref.notify.title.notify&&n(0==t.nr&&pref.notify.title.hide_zero?"":(pref.catalog.footer.nrtm&&t.nrtm?t.nrtm+"/":"")+t.nr+" - ")}function n(e){i!==e&&(a.innerHTML=e+s,i=e)}var r=site2[site.nickname].favicon.get_favicon(),a=site2[site.nickname].favicon.get_title(),s=a.innerHTML,o="none",i="";return{set:new DelayBuffer(t,200).get_binded_delayed_do()}}():{set:function(){}
},n=Notification&&pref.features.notify.desktop?function(){function e(){return"granted"!==Notification.permission&&Notification.requestPermission(function(e){Notification.permission!==e&&(Notification.permission=e)}),"granted"===Notification.permission}function t(t,r,a,s){if(pref.test_mode[94]&&"dist"===site.nickname)return site2[site.nickname].testPoster(num>=0?obj[num]:obj,t.no);i.length+l.length<pref.notify.desktop.limit&&("granted"===Notification.permission||e())&&n(t,r,a,s)}function n(e,t,n,a){if(!t.reply_of_mine||!pref.catalog_footer_ignore_my_own_posts){var s={icon:t.op_img_url,body:t.com||"",title:(a?"New Thread ":"")+(t.reply_to_me&&pref.notify.desktop.reply_to_me?"(You) in ":"")+(e.sub||e.key),tag:pref.script_prefix+"/"+e.key+", "+n,__proto__:t};c.innerHTML=s.body,s.body=c[brwsr.innerText].trim(),0===pref.notify.desktop.delay?r(s):(l[l.length]=s,p())}}function r(e){e||(e=l.shift());var t=new Notification(e.title,e);t.onclick=s;var n=0!=pref.notify.desktop.lifetime?setTimeout(a,1e3*pref.notify.desktop.lifetime):null;i[i.length]=[t,n],l.length>0&&p()}function a(){i.shift()[0].close()}function s(){window.focus();for(var e=i.length-1;e>=0;e--)if(i[e][0]===this||0==e){i[e][1]&&clearTimeout(i[e][1]),i.splice(e,1);break}}function o(){for(;i.length>0;)i[0][1]&&clearTimeout(i[0][1]),a()}e();var i=[],l=[],c=document.createElement("div"),p=new DelayBuffer(r,200).get_binded_delayed_do();return window.addEventListener("beforeunload",o,!1),{show:t}}():{show:function(){}};return{sound:e,favicon:t,desktop:n,changed:function(e,r){(pref.notify.favicon||pref.notify.title.notify)&&t.set();for(var a=!1,s=pref4.refresh.count<=1,o=pref.notify.sound,i=pref.notify.desktop,l=i.show_last?0:r.length-1,c=r.length-1;c>=0;c--)(o.reply||o.reply_to_me&&r[c].reply_to_me)&&(a=!0),c<=l&&i.notify&&(i.reply||i.reply_to_me&&r[c].reply_to_me)&&(s&&i.supp_init||n.show(e,r[c],c));o.notify&&a&&(s&&o.supp_init||notifier.sound.play())},appeared:function(e,t){var r=liveTag.mems[e.domain][e.board][e.no].wt;pref.notify.desktop.notify&&(pref.test_mode[133]&&pref.notify.desktop.appear&&(0===r[0]||!pref.notify.desktop.reply&&!pref.notify.desktop.reply_to_me)||pref.notify.desktop.new_thread&&t)&&n.show(e,e.posts&&e.posts[0]||e,0,!0),pref.notify.sound.notify&&(pref.notify.sound.appear||pref.notify.sound.new_thread&&t)&&notifier.sound.play()}}}(),ports={},messages_to_send={},init_func={},receive_func={},received_messages_404=null,send_message_emu=[];if(window.addEventListener("beforeunload",close_all,!1),window.opener&&(make_port_child(window.opener),site2[window.name]&&site2[window.name].prep_own_posts_event&&(window.addEventListener("storage",site2[window.name].prep_own_posts_event,!1),site2[window.name].prep_own_posts(),site2[window.name].prep_own_posts_event())),pref.cloudflare.auto_reload){var cf_error=document.getElementsByClassName("cf-error-code");cf_error.length>0&&parseInt(cf_error[0].textContent,10)>=500&&setTimeout(function(){location.reload()},6e4*pref.cloudflare.auto_reload_time)}var httpd=function(){function e(){M.id||t()}function t(e,s){if(!z)for(var o=8;o>=0;o--)if(R[o]&&(S<pref.scan.crawler||8==o)){for(;R[o][0]&&0===R[o][0].tgts.length;)R[o].shift();for(var l=R[o][0],c=0;l&&l.ERR_5xx&&s!==l;)l=R[o][++c];if(!l)continue;l.INDICATOR||(l.INDICATOR=(l.indicator||C).shift("limegreen",l.initiator[0],l.initiator,o),l.INDICATOR.report({start:Date.now(),prog:l}),l.IDX=0,l.FINISHED=0,l.SUC=0,l.max||(l.max=l.tgts.length));var p=l.get_tgt_func?l.get_tgt_func(l):{REQ:l,__proto__:l.tgts[l.IDX++]};return l.IDX>=l.max&&r(l,o),S++,void(p?(l.INDICATOR.report({tgt:p.tgt||n(p.url)}),p.domain===site.nickname&&!p.domain_xhr||"indirect"!==pref.network.cross_domain?i(e,p):(e&&(j[j.length]=e),a(p)),pref.scan.crawler_adaptive?M.restart(pref.scan.crawler_idle_time_to_spawn):S<pref.scan.crawler&&t()):(l.IDX<l.max&&(l.refresh||l.found_threads<l.max_threads)||(r(l,o),l.FINISHED+=l.max-l.IDX,l.IDX=l.max),setTimeout(function(){u({type:"SKIPPED_TO_END"},e,{REQ:l},!0,{date:Date.now(),status:200})},0)))}M.id&&M.stop(),e&&(j[j.length]=e)}function n(e){return e.substr(e.lastIndexOf("/")+1)}function r(e,t){R[t]&&R[t].length>1?R[t].shift():R[t]=null,U[U.length]=e}function a(e){var t=e.domain_xhr||e.domain;if(!N[t]){var n=function(t){u({type:"SKIPPED"},void 0,t||e,!1,{date:Date.now(),status:499})};if(void 0===N[t])cnst.make_iframe(t),N[t]=window.open(site2[t]&&site2[t].home||e.url,t),send_message(t,["HTTPD",["SUB_FRAME_INIT"]],N[t]),I[t]=[setTimeout(function(){N[t]=!1,I[t].slice(1).forEach(function(e){n(e)}),delete I[t]},1e3*pref.network.timeout)];else if(N[t]===!1)return void setTimeout(n,0)}L[t]=null,D[O]=e,e.archive||(e.responseType="text"),send_message(t,["HTTPD",["SUB_GET",[{ID:O++,url:e.url,responseType:e.responseType,domain:e.domain,board:e.board,no:e.no,key:e.key,archive:e.archive,to_file:e.to_file,to_idb:e.to_idb,kind:e.kind,timestamp:e.timestamp,domain_xhr:e.domain_xhr}]]]),I[t]&&I[t].push(e)}function s(e){clearTimeout(I[e[0]][0]),delete I[e[0]]}function o(e){i(void 0,e[0])}function i(e,t){e||(j.length>0?e=j.pop():"GM"===pref.network.cross_domain?e=new q:(e=new XMLHttpRequest,e.onload=d,e.onerror=d,e.onabort=d)),E.set(e,t),e.open("GET",t.url),e.responseType=t.responseType,e.send(),l(e,Date.now(),t)}function l(e,t,n){n.TIMEOUT=(n.TIMEOUT?n.TIMEOUT:t)+1e3*pref.network.timeout,H[H.length]=e,1===H.length&&F.restart(1e3*pref.network.timeout)}function c(e,t){var n=H.indexOf(e);if(n<0)return!0;if(H.splice(n,1),0===n)if(H.length>0){var r=E.get(H[0]).TIMEOUT-t;r>0?F.restart(r):p()}else F.stop()}function p(){var e=H[0];pref.debug_mode[25]&&console.log("xhr_timeout: "+e.readyState+", "+e.responseURL),e.onreadystatechange?d({target:e,type:"TIMEOUT"}):(e.onreadystatechange=_,e.onprogress=_,_({target:e}))}function _(e){var t=e.target,n=E.get(t);pref.debug_mode[25]&&console.log("xhr_onreadystatechange: "+n.url+("progress"===e.type?": "+e.loaded+"/"+e.total:"")),"progress"===e.type&&(e.target.onreadystatechange=null);var r=Date.now();c(t,r),l(t,r,n)}function d(e){var t=e.target,n=Date.now();if(!c(t,n)){t.onreadystatechange=null,t.onprogress=null;var r=E.get(t),a=200===t.status||304===t.status;u(e,t,r,a,"text"===t.responseType?{date:n,status:t.status,responseText:a?t.responseText:null}:{date:n,status:t.status,response:a?t.response:null})}}function u(r,a,s,o,i){if(A){S--;var l=++s.REQ.FINISHED===s.REQ.IDX&&s.REQ.IDX>=s.REQ.max;t(a,i.status<500?s:null),l&&h(s.REQ),o?(s.REQ.SUC++,g(s,i)):(i.status>=500&&!s.REQ.ERR_5xx&&(s.REQ.ERR_5xx=setTimeout(function(t){return function(){delete t.ERR_5xx,e()}}(s.REQ),3e4)),s.REQ.INDICATOR.report({err_str:(s.tgt||n(s.url))+"("+i.status+("load"!==r.type?":"+r.type:"")+")"}),s.REQ.callback_1_fail&&s.REQ.callback_1_fail(s,i,s.REQ)),l&&w(s.REQ,i.date),s.REQ=null}else send_message("parent",["HTTPD",["SUB_ACK",[s.ID,{type:s.archive?"ARCHIVE":r.type},o,s.archive?{date:i.date,status:i.status,responseText:"",response:{}}:i]]]),j[j.length]=a,o&&s.archive&&b(s,i)}function f(e){var t=D[e[0]];delete D[e[0]],u(e[1],void 0,t,e[2],e[3])}function h(e){U.splice(U.indexOf(e),1),e.archive&&(e.TAR_FLUSH=L),m()}function m(){if(0===S){if(E.clear(),A)for(var e in L)send_message(e,["HTTPD",["SUB_FREE"]]);O=0,L={}}else for(var t=0;t<j.length;t++)E.delete(j[t]);j=[]}function g(e,t){"text"===e.responseType&&("html"===e.data_type?t.response=B.parseFromString(t.responseText,"text/html"):"json"===e.data_type&&(t.response=JSON.parse(t.responseText))),e.REQ.callback_1(e,t,e.REQ)}function b(e,t){if("string"==typeof e.archive)return void archiver.download_url4(t.response,e.archive);e.from&&A&&delete archiver.list_all_obj_downloading[e.from];var n="indirect"!==pref.network.cross_domain;if((e.domain_xhr||e.domain)===site.nickname||n){var r=e.kind+"_"+e.url.replace(/.*\//g,"");e.to_file&&archiver.download_url3(t.response,e,r,e.timestamp),e.to_idb&&(pref.test_mode[65]&&A||IDB.req(e.domain,e.board,e.no,r,t.response,"put"))}if(A&&e.REQ.TAR_FLUSH){archiver.tar.flush(0===S?void 0:e.timestamp);for(var a in e.REQ.TAR_FLUSH)send_message(a,["HTTPD",["SUB_TAR_FLUSH",[0===S?void 0:e.timestamp]]])}}function v(e,t){e.from&&delete archiver.list_all_obj_downloading[e.from]}function y(e){if(R[0]&&R[0][0]&&R[0][0].timestamp===e&&R[0][0].tgts.length>0)return!1;for(var t=0;t<U.length;t++)if(U[t].timestamp===e)return!1;return archiver.tar.flush(0===S?void 0:e),!0}function w(e,t){e.callback&&e.callback(e),e.INDICATOR.report({end:t})}function k(e){archiver.tar.flush(e[0])}function x(){A=!1,send_message("parent",["HTTPD",["SUB_FRAME_INIT_ACK",[window.name]]])}function T(){z>0?--z>0&&P.delayed_do():(P.cancel(),e())}var C,N={},I={},A=!0,B=new DOMParser,E=new Map,j=[],S=0,L={},O=0,D={},R=[],U=[],z=0,M=new Watchdog(t,pref.scan.crawler_idle_time_to_spawn),H=[],F=new Watchdog(p,3e4),q=function(){this.onload=this.onload.bind(this),this.onerror=this.onerror.bind(this),this.onabort=this.onabort.bind(this)};q.prototype={open:function(e,t){this.method=e,this.url=t},send:function(){this.response=null,GM_xmlhttpRequest(this)},onload:function(e){this.response=e.response,this.response||(this.response="document"===this.responseType?(new DOMParser).parseFromString(e.responseText,"text/xml"):"json"===this.responseType?JSON.parse(e.responseText):e.responseText),this.onXXX("load",e,d)},onerror:function(e){this.onXXX("error",e,d)},onabort:function(e){this.onXXX("abort",e,d)},onXXX:function(e,t,n){this.type=e,this.result=t,n(this)},onXXX_factory:function(e,t){return function(n){this.onXXX(e,n,t)}.bind(this)},set onreadystatechange(e){this._onreadystatechange=e?this.onXXX_factory("readystatechange",e):e},get onreadystatechange(){return this._onreadystatechange||this.dummy_func},set onprogress(e){this._onprogress=e?this.onXXX_factory("progress",e):e},get onprogress(){return this._onprogress||this.dummy_func},dummy_func:function(){},get status(){return this.result&&this.result.status||1404},get responseText(){return this.result.responseText},get target(){return this},result:null};var P=new DelayBuffer(T,1e4),W={SUB_GET:o,SUB_ACK:f,SUB_FREE:m,SUB_TAR_FLUSH:k,SUB_FRAME_INIT:x,SUB_FRAME_INIT_ACK:s};return{req:function(e,n){R[n]?R[n].push(e):R[n]=[e],0!==e.tgts.length&&t()},req_add:function(t,n){R[n]&&0!==R[n].length?R[n][R[n].length-1].tgts=R[n][R[n].length-1].tgts.concat(t.tgts):R[n]=[t],e()},check_timestamp_and_flush:y,onload_archive:b,onload_archive_fail:v,sub_funcs:function(e){W[e[0]](e[1])},pause_req:function(){z++,P.delayed_do()},pause_cancel:T,set_health_indicator:function(e){C=e},get isLocal(){return A}}}();if(!site0.isStep||!pref.test_mode[142]){var http_req={get:function(e,t,n,r,a,s,o,i){var l=t.indexOf(",")==-1?common_func.name2dbt(t):t.split(",");""===n?n=site2[l[0]].make_url4(l):"string"==typeof n&&(n=[n,"raw"]),t=l.join(","),httpd.req({initiator:t,tgts:[{url:n[0],responseType:"html"===n[1]?"document":"raw"===n[1]?"text":n[1],tgt:t,data_type:n[1],domain:l[0]}],callback_1:function(e,n){r(t,n,o)},INDICATOR:{shift:function(){},report:function(){}},IDX:0,FINISHED:0,SUC:0,max:1},6)}},cnst=function(){function e(e){var t=e.target,n="click"===e.type?"BUTTON"===t.tagName&&w[t.name]||"BUTTON"===t.parentNode.tagName&&w[t.parentNode.name]:("DIV"===t.tagName||"SPAN"===t.tagName)&&w.roll_toggle;n&&(e.stopPropagation(),n.call(w,e,y.get(e.currentTarget.parentNode)))}function t(e){e.stopPropagation(),"BUTTON"!==e.target.tagname&&w.exit.call(w,e,y.get(e.currentTarget.parentNode))}function n(e){var t=y.get(e.currentTarget);(t&&t.float||cnst.tack_float_nSblgs)(e)}function r(e){var t=y.get(y.get(e.currentTarget.parentNode).tack);(t&&t.embed||cnst.tack_dock_nSblgs)(e)}function a(e){_(e,e.currentTarget.parentNode)}function s(e,t){return document.documentElement.clientHeight-parseInt(e,10)-t.offsetHeight}function o(e,t){return document.documentElement.clientWidth-parseInt(e,10)-t.offsetWidth}function i(e){(pref.proto.popup2_resize||gGEH.pns_resize.has(e.currentTarget))&&l(e)||"sel"===pref.proto.popup2_sel||u(e)||pref[cataLog.embed_mode].thumbnail.hover.dragfloat&&cataLog.DIH&&cataLog.DIH.hover_ex||_(e,e.currentTarget)}function l(e){for(var t=e.currentTarget,n=e.target,r=t.style,a="fixed"===r.position,i=a?e.clientY-(r.top?parseInt(r.top,10):s(r.bottom,t)):e.offsetY+(t===n?0:n.offsetTop-t.offsetTop),l=a?e.clientX-(r.left?parseInt(r.left,10):o(r.right,t)):e.offsetX+(t===n?0:n.offsetLeft-t.offsetLeft),_=t.offsetHeight-i,d=t.offsetWidth-l,u=[i,l,_,d],f=0;f<4;f++)if(u[f]<=pref.proto.popup2_resize_bw){for(var h=0;h<4;h++)u[h]=u[h]<=pref.proto.popup2_resize_cw?parseInt(window.getComputedStyle(t)[h%2?"width":"height"],10):null;return document.body.addEventListener("mouseup",p,!1),document.body.addEventListener("dragend",p,!1),document.body.addEventListener("drag",c,!1),k=e.screenX,x=e.screenY,u.push(parseInt(r.top,10),parseInt(r.left,10),parseInt(r.bottom,10),parseInt(r.right,10),t,r.width,r.height),T=u,e.stopPropagation(),t.draggable=!0,!0}return!1}function c(e){if(0!==e.screenX){var t=T,n=t[8],r=n.style,a=e.screenX-k,s=e.screenY-x;t[0]&&(r.height=t[0]-s+"px",r.top&&(r.top=t[4]+s+"px")),t[1]&&(r.width=t[1]-a+"px",r.left&&(r.left=t[5]+a+"px")),t[2]&&(r.height=t[2]+s+"px",r.bottom&&(r.bottom=t[6]-s+"px")),t[3]&&(r.width=t[3]+a+"px",r.right&&(r.right=t[7]-a+"px")),e.stopPropagation()}}function p(e){var t=e.currentTarget;t.removeEventListener("drag",c,!1),t.removeEventListener("dragend",p,!1),t.removeEventListener("mouseup",p,!1),e.stopPropagation(),t.draggable=!1;var n=T[8],r=gGEH.pns_resize.get(n)||null;r&&(n.childNodes[1].style.width=parseInt(n.style.width,10)-6+"px",n.childNodes[1].style.height=parseInt(n.style.height,10)-n.childNodes[0].offsetHeight-3+"px",T[9]||(n.style.width=null),T[10]||(n.style.height=null),r()),T=null}function _(e,t){t.draggable=!0,t.addEventListener("dragstart",f,!1),t.addEventListener("mouseup",d,!1),e.stopPropagation()}function d(e){e.currentTarget.removeEventListener("mouseup",d,!1),e.currentTarget.draggable=!1}function u(e){if("INPUT"===e.target.tagName||"TEXTAREA"===e.target.tagName||"SELECT"===e.target.tagName)return!0;if("move"===pref.proto.popup2_sel)return!1;for(var t=e.target.childNodes,n=new Range,r=0;r<t.length;r++){var a="BUTTON"===t[r].tagName||"SELECT"===t[r].tagName?0:pref.proto.popup2_sel_tolerance;n.selectNode(t[r]);for(var s=n.getClientRects(),o=0;o<s.length;o++){var i=s[o];if(i.bottom>e.clientY&&e.clientY>=i.top&&i.left-a<e.clientX&&e.clientX<i.right+a)return!0}}return!1}function f(e){e.currentTarget.removeEventListener("dragstart",f,!1),e.currentTarget.removeEventListener("mouseup",d,!1),w.roll_if_auto(e,!0),h(e,!0)}function h(e,t){var n=e.currentTarget;k=e.screenX,x=e.screenY,e.dataTransfer.setData("text/plain",""),e.dataTransfer.effectAllowed="move",e.dataTransfer.dropEffect="move",e.stopPropagation(),n.style.opacity=.4,n.addEventListener("dragend",t?g:b,!1),C.addEventListener("dragover",m,!1)}function m(e){e.preventDefault(),e.dataTransfer.dropEffect="move"}function g(e){b(e,!0),w.roll_if_auto(e,!1),e.currentTarget.draggable=!1}function b(e,t){C.removeEventListener("dragover",m,!1);var n=e.currentTarget,r=n.style;n.removeEventListener("dragend",t?g:b,!1),r.left?r.left=parseInt(r.left,10)+e.screenX-k+"px":r.right=parseInt(r.right,10)-e.screenX+k+"px",r.bottom?r.bottom=parseInt(r.bottom,10)-e.screenY+x+"px":r.top=parseInt(r.top,10)+e.screenY-x+"px",r.opacity=1,e.stopPropagation()}function v(e){var t=brwsr.ff?40*-e.detail:e.wheelDelta,n=e.currentTarget.style;n.bottom?n.bottom=parseInt(n.bottom,10)-t+"px":n.top=parseInt(n.top,10)+t+"px",e.preventDefault()}var y=new WeakMap,w={op_p:function(e){var t=e.currentTarget.parentNode.style,n=parseFloat(t.opacity)||1;t.opacity="op_p"===e.target.name?n+.1>=1?1:n+.1:n-.1<=.1?.1:n-.1},roll_toggle:function(e,t){t.tb.classList.contains(pref.script_prefix+"_autoTp")?t.cn.style.height=parseInt(t.cn.style.height,10)?null:t.tb.offsetHeight+"px":"none"==t.cn.style.display?this.rolldown(t):this.rollup(t)},roll_if_auto:function(e,t){var n=y.get(e.currentTarget);n&&(t?n.auto_roll&&"none"!==n.cn.style.display&&(t?(n.auto_unroll=[n.cn.parentNode.style.height],n.cn.parentNode.style.height=n.cn.parentNode.offsetHeight+"px"):n.auto_unroll=!0,this.rollup(n)):n.auto_unroll&&"none"===n.cn.style.display&&(this.rolldown(n),Array.isArray(n.auto_unroll)&&(n.cn.parentNode.style.height=n.auto_unroll[0]),n.auto_unroll=!1))},rolldown:function(e){e.tb.style.width="",e.cn.style.display="",e.rolldown&&e.rolldown.call(e.this_obj)},rollup:function(e){e.tb.style.width=e.tb.offsetWidth+"px",e.cn.style.display="none",e.rollup&&e.rollup.call(e.this_obj)},top:function(e,t){this.maximize(t.pn,t.tb,t.cn,e.target.name,t,e.target)},maximize:function(e,t,n,r,a,s){var o=a.maximize_state,i=(a.maximize_tgt||n).style;if(pref.test_mode[130]){var l=o[0];if(o[5].style.display=null,"max"!==l?o=[r,e.style.left,e.style.top,e.style.width,e.style.height,s,e.style.right,e.style.bottom,i.width,i.height]:(common_func.overwrite_prop(e.style,{left:o[1],top:o[2],width:o[3],height:o[4],right:o[6],bottom:o[7]}),common_func.overwrite_prop(i,{width:o[8],height:o[9]}),o[0]=r,o[5]=s),"max"===r){var c=site.header_height(),p=document.documentElement.clientWidth,_=document.documentElement.clientHeight-c;common_func.overwrite_prop(e.style,{left:"0px",top:c+"px",position:"fixed",width:p+"px",height:_+"px",zIndex:pref.style.zIndex}),common_func.overwrite_prop(i,{width:p-6+"px",height:_-t.offsetHeight-3+"px"})}else if("float"===r)common_func.overwrite_prop(e.style,{position:"fixed",zIndex:pref.style.zIndex});else{var d=site.embed_to[r]();d&&(common_func.overwrite_prop(e.style,{position:"static",zIndex:null}),d.parentNode.insertBefore(e,d),t.classList.remove(pref.script_prefix+"_autoTp"))}a.maximize_state=o}else{var u=e.style;if(o.btn.style.display=null,"max"===r&&(o.before_max={pns:{width:u.width,height:u.height},cns:{width:i.width,height:i.height}}),"max"===o.now?(common_func.overwrite_prop(u,o.before_max.pns),common_func.overwrite_prop(i,o.before_max.cns)):"float"===o.now&&(o.float={left:u.left,top:u.top,right:u.right,bottom:u.bottom}),"max"===r){var c=site.header_height(),p=document.documentElement.clientWidth,_=document.documentElement.clientHeight-c;common_func.overwrite_prop(u,{left:"0px",top:c+"px",position:"fixed",width:p+"px",height:_+"px",zIndex:pref.style.zIndex,right:null,bottom:null,float:null}),common_func.overwrite_prop(i,{width:p-6+"px",height:_-t.offsetHeight-3+"px"})}else if("float"===r)common_func.overwrite_prop(u,{position:"fixed",float:null,zIndex:pref.style.zIndex,__proto__:o.float});else{var d=site.embed_to[r]();d&&(common_func.overwrite_prop(u,{position:"relative",float:"left",zIndex:null,top:null,left:null,right:null,bottom:null}),d.parentNode.insertBefore(e,d))}o.now=r,o.btn=s}s.style.display="none",a.maximize&&a.maximize.call(a.this_obj,r,l)},exit:function(e,t){t.exit?t.exit.call(t.this_obj,e):cnst.div_destroy(t.pn,!0)},settings:function(e,t){var n="BUTTON"===e.target.tagName?e.target:e.target.parentNode,r=y.get(n)||t.cn.childNodes[0];r.style.display="none"===r.style.display?null:"none",cnst.toggleButton(n)}};w.op_m=w.op_p,w.bottom=w.top,w.float=w.top,w.max=w.top,w.filter=w.settings;var k,x,T=null,C=document.body,N={left:0,bottom:0,last_pn:null};return{init3:function(e){return this.init(e.func_str,null,null,null,null,e.pn_st,e)},init2:function(e){return this.init(e.func_str,e.rolldown_func,e.rollup_func,e.exit_func,e.maximize_func,e.pn_st)},init:function(n,r,s,o,l,c,p){var _=void 0!==p;void 0===p&&(p={rolldown:r,rollup:s,exit:o,maximize:l});var d=p.pn||document.createElement("span");if(p.pn=d,c)return d.textContent=" "+n.replace(/.*:button:/,"").replace(/:.*/,""),d.setAttribute("style","cursor:pointer"),c.appendChild(document.createTextNode(" ")),c.appendChild(d),d;d.style||(d.style={}),d.style.position="fixed",d.draggable=!0,d.style.padding="0px",d.style.zIndex=pref.style.zIndex,d.style.float="left",d.style.display="inline-block";var u=n.split(":"),f=0;if("pop"!=u[0]);else{var m=!0;d.addEventListener(brwsr.mousewheel,v,!1),d.name="catalog_pop",f=1,d.draggable=!1}d.classList.add(pref.script_prefix+"_window");for(var g=d;f<u.length;){var b=u[f++];if("tb"===b||"ftb"===b||"fitb"===b){d.classList.remove(pref.script_prefix+"_window"),d.classList.add(pref.script_prefix+"_titleBar"),"fitb"!==b&&(d.innerHTML='<div class="'+pref.script_prefix+'_window" style="margin: 0px 3px 3px 3px"></div>');var w=d.firstChild,k=pref_func.format_html_str('<div style="height:auto;overflow:hidden"><div style="float: left"><BTN"roll_toggle,-"><BTN"op_m,&lt;"><BTN"op_p,&gt;"><span style="width:16px;display:inline-block"></span></div><div style="float: right"><BTN"top,^"><BTN"bottom,v"><BTN"float,o" style="display:none"><BTN"max,[]">'+("fitb"===b?'<BTN"exit,x">':"")+'<BTN"exit,X"></div><div></div></div>'),x=d.insertBefore(cnst.dom(k),"tb"===b?w:w.nextSibling);if(g=w,p.maximize_state=pref.test_mode[130]?["float",null,null,null,null,x.childNodes[1].childNodes[2]]:{now:"float",btn:x.childNodes[1].childNodes[2]},d.draggable=!1,x.onclick=e,x.ondblclick=e,x.onmousedown=a,p.tb=x,p.cn=w,y.set(d,p),"ftb"!=b&&"fitb"!=b||(x.style.width="100%",x.classList.add(pref.script_prefix+"_autoTp"),w.style.margin="3px"),"ftb"===b){var T=pref[cataLog.embed_mode].thumbnail.hover;T.df_dblC&&(w.ondblclick=t),T.df_mW&&(d["on"+brwsr.mousewheel]=v)}}else if("tb_press"==b){var C=u[f++];"float"!==C&&e({target:x.getElementsByTagName("button")[C],currentTarget:x,type:"click",stopPropagation:function(){}})}else"embed"==b?(x.childNodes[0].onmousedown=null,x.childNodes[1].onmousedown=null,x.childNodes[2].onmousedown=null,x.onmousedown=null):"bottom_top"==b?this.bottom_top(d):"txt"==b||brwsr.ff&&"button"==b?(g.appendChild(document.createTextNode(u[f++])),g.style.cursor="pointer",g.style.padding="2px 5px 2px 5px"):"button"==b?(g.innerHTML='<input type="button" value="'+u[f++]+'">',g.style.padding="0",g.style.border="0",g.style.background="none"):"Show2"==b?site.root_body!==site.root_body2&&site.root_body2?(d.style.position="static",site.root_body2.appendChild(d)):site.root_body.appendChild(d):"Show"==b?site.script_body.appendChild(d):"tile"==b||"tile2"==b?"set"==u[f++]?"left"==u[f]?(N[u[f]]=parseInt(d.style[u[f]].replace(/px/,""),10)+d.offsetWidth,f++):(N[u[f]]=parseInt(d.style[u[f]].replace(/px/,""),10)+d.offsetHeight,f++):"tile"===b?(d.style[u[f]]=N[u[f]]+"px",f++):(d.style[u[f]]=N[u[f]]+parseInt(u[f+1],10)+"px",f+=2):g.style[b]=u[f++]}return x||m?d.addEventListener("mousedown",i,!1):d.addEventListener("dragstart",h,!1),N.last_pn=d,_?p:d},tile_set_bottom:function(){N.last_pn&&(N.bottom=N.last_pn.offsetHeight)},tile_set_left:function(){N.last_pn&&(N.left=N.last_pn.offsetWidth)},left2right:o,bottom_top:function(e){var t=e.style;t.bottom&&(t.top=s(t.bottom,e)+"px",t.bottom=null),t.right&&(t.left=o(t.right,e)+"px",t.right=null)},void_func:function(){},div_mousedown:i,div_dragstart:h,div_scroll:v,div_destroy:function(e,t,n){return t&&e.parentNode.removeChild(e),e.name||y.has(e)?e.removeEventListener("mousedown",i,!1):e.removeEventListener("dragstart",h,!1),e.name&&e.removeEventListener(brwsr.mousewheel,v,!1),null},tb_prep_for_embed:function(e){e.childNodes[0].innerHTML="",e.childNodes[1].innerHTML="",e.childNodes[3].removeAttribute("style"),e.ondblclick=null},add_to_tb:function(e,t){var n=document.createElement("div");return n.style.float="right",n.style.resize="none",n.style.overflow="visible",n.innerHTML=t,e.childNodes[0].insertBefore(n,e.childNodes[0].childNodes[e.childNodes[0].childNodes.length-1]),brwsr.ff&&n.setAttribute("style","float: right"),n},show_hide:function(e,t,n){"none"==e.style.display?(e.style.display="",t&&(t.style.height=parseInt(t.style.height.replace(/px/,""),10)-e.offsetHeight+"px"),n&&(n.style.top=parseInt(n.style.top.replace(/px/,""),10)+e.offsetHeight+"px")):(t&&(t.style.height=parseInt(t.style.height.replace(/px/,""),10)+e.offsetHeight+"px"),n&&(n.style.top=parseInt(n.style.top.replace(/px/,""),10)-e.offsetHeight+"px"),e.style.display="none")},name2domainboardthread:common_func.name2domainboardthread,get_time:function(){var e=new Date,t=e.getHours(),n=e.getMinutes(),r=e.getSeconds();return t<10&&(t="0"+t),n<10&&(n="0"+n),r<10&&(r="0"+r),t+":"+n+":"+r},make_destroy:function(e,t,n,r){e[t]?e[t]=r():e[t]=n()},make_popup:function(e,t,n,r){e[t]=cnst.init("left:0px:tile:get:bottom:Show:tb",cnst.void_func,cnst.void_func,function(){e[t]=cnst.div_destroy(e[t],!0)},cnst.void_func),e[t].childNodes[1].innerHTML=n,pref_func.add_onchange(e[t].childNodes[1],r)},make_iframe:function(e){if(!(site2[e]&&site2[e].X_FRAME_OPTIONS&&pref.network.overXFO||site2[site.nickname].CONTENT_SECURITY_POLICY_FRAME&&pref.network.overCSPF)){var t=document.createElement("iframe");return t.name=e,t.setAttribute("style","display:none"),site.script_body.appendChild(t),t}},subscribe:function(e,t){e.push(t)},unsubscribe:function(e,t){var n=e.indexOf(t);n!=-1&&e.splice(n,1)},foreach:function(e,t){for(var n=0;n<e.length;n++)t(e[n])},auto_shrink_board_selector:function(){function e(){this.removeAttribute("style");for(var e=0;e<this.length;e++)this.options[e].text=pref.catalog_board_list_obj[e][0].key,r(this.options[e],e)}function t(){for(var e=0;e<this.length;e++)e!=this.selectedIndex&&(this.options[e].text="");r(this,this.selectedIndex)}function n(e,t){void 0===t&&(t=e.selectedIndex),e.length=0;for(var n=0;n<pref.catalog_board_list_obj.length;n++)e.length++,e.options[e.length-1].text=pref.catalog_board_list_obj[n][0].key;e.selectedIndex=t>=e.length?0:t,e.onblur()}function r(e,t){pref3.stats.use&&(pref.stats.auto_acquisition||pref.stats.auto_acquisition_all)&&stats.query_auto_acquisition(t)?e.setAttribute("style","background:#b5fbda"):e.removeAttribute("style")}var a=[];return{setup:function(r,s){r.onfocus=e,r.onblur=t,n(r,s),cnst.subscribe(a,r)},str_changed:function(){cnst.foreach(a,n)},destroy:function(e){cnst.unsubscribe(a,e)},color:function(){cnst.foreach(a,function(e){r(e,e.selectedIndex)})}}}(),auto_shrink_selector:function(){function e(){for(var e=n[this.getAttribute("name")],t=0;t<this.length;t++)""===this.options[t].text&&(this.options[t].text=e[t])}function t(){for(var e=[],t=0;t<this.length;t++)e[t]=this.options[t].text,t!=this.selectedIndex&&(this.options[t].text="");n[this.getAttribute("name")]=e}var n=Object.create(null);return function(n){n.onfocus=e,n.onblur=t,n.onblur()}}(),config_expander:function(){function e(){var e=pref[cataLog.embed_mode].t2h_num_of_posts;return["Same as the page",pref[cataLog.embed_mode].t2h_L+" posts",pref[cataLog.embed_mode].t2h_M+" posts",e+" posts",e+" + all unread posts","All unread posts","All"]}function t(){for(var t=e(),n=0;n<this.length;n++)""===this.options[n].text&&(this.options[n].text=t[n])}function n(){for(var e=0;e<this.length;e++)e!=this.selectedIndex&&(this.options[e].text="")}return function(r,a){var s=document.createElement("select");return s.className=pref.script_prefix+"_expander",s.setAttribute("data-key",r),s.length=7,void 0===a&&(a=0),s.selectedIndex=a,s.options[a].text=0===a?"Expand...":e()[a],s.onfocus=t,s.onblur=n,s}}(),icons:{filter:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcAQAAAABaduI5AAAAAnRSTlMAAQGU/a4AAABUSURBVAjXY/j///8HBjAx////CQz8//8zMLD//8fAwPz/DwND4/8fAgwH/n8wYHhQ/6CA4YP9gQ8MP+QbPzD84Wf+wPCPnx2ol5+fLKJfHmovnAAAn79HiYOE2q8AAAAldEVYdGRhdGU6Y3JlYXRlADIwMTUtMTAtMjlUMDI6MTM6MzkrMDk6MDBxKtFiAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE1LTEwLTI5VDAyOjEzOjM5KzA5OjAwAHdp3gAAAABJRU5ErkJggg==",settings:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcAQAAAABaduI5AAAAAnRSTlMAAQGU/a4AAABWSURBVAjXdY6xDcAgDAQvGzAKG2QllykiwWgexWxgKQ2dI4yULs1X9/dPWHMyHrudYZegvVQ6FBQqdqrgzRwLF0ZM4YjJfySS8K4tQaq2dOlzKCe/By9fz0MDWLKIZgAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAxNS0xMC0yOVQwMjowMzowNiswOTowMMhjeagAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMTUtMTAtMjlUMDI6MDM6MDYrMDk6MDC5PsEUAAAAAElFTkSuQmCC",refresh:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcAQAAAABaduI5AAAAAnRSTlMAAQGU/a4AAABmSURBVAjXbY6xDYAwDASfijLegBUYLRuAlCIljITEAowQNnCZIspjQ0tzkvX6e4NKBREudIw7KgaBTqugLEVwUwWnI9HOzMNh6UarhR+8QWaXD4nNBW02VY0ujdAA9SH1yXfcYG88J0BH+yT9vZAAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTUtMTAtMjhUMjM6NDg6MDYrMDk6MDASyn1kAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE1LTEwLTI4VDIzOjQ4OjA2KzA5OjAwY5fF2AAAAABJRU5ErkJggg==",img:function(e){return'<img src="'+e+'" style="width:14px;height:14px">'},button_settings:function(){return'<button type="button" name="settings">'+this.img(this.settings)+"</button>"}},toggleButton:function(e){e.style&&e.style.border?e.style.border="":e.style.border="inset 2px"},createElement:function(e){var t=document.createElement("div");return t.innerHTML=e,1===t.childNodes.length?t.childNodes[0]:t.querySelectorAll("*")},set_tack_float:function(e,t,r){return(t||r)&&y.set(e,{float:t,embed:r}),e.onclick=n,e},tack_float_nSblgs:function(e,t,n){var a=e.currentTarget,s=a.nextSibling,o=s.getBoundingClientRect(),i=cnst.init3({func_str:"left:"+o.left+"px:top:"+o.top+"px:overflow:hidden:"+(n?"fitb":"Show:tb"),exit:r,tack:a,pn:n?s:null});if(!n){i.cn.innerHTML='<div style="display: none"></div><div></div>';var l=i.cn.childNodes[1];if(s.parentNode.insertBefore(i.pn,s),l.appendChild(s),t)for(;i.pn.nextSibling;)l.appendChild(i.pn.nextSibling)}return a.style.display="none",i},tack_dock_nSblgs:function(e,t){var n=e.currentTarget.parentNode,r=y.get(n),a=r.tack.parentNode,s=r.tack.nextSibling;if(t)n.style.position="static",n.removeChild(r.tb),r.tack.nextSibling!==n&&a.insertBefore(n,r.tack.nextSibling);else for(var o=r.cn.childNodes[1];o.firstChild;)a.insertBefore(o.firstChild,s);return cnst.div_destroy(n,!t),r.tack.style.display=null,r},tack_dock_e2tack:function(e){var t=e.currentTarget.parentNode;return y.get(t).tack},set_target_of_button:function(e,t){y.set(e,t)},dom:function(){var e=document.createElement("div");return function(t){return e.innerHTML=t,e.firstChild}}(),doms_insertBefore:function(){var e=document.createElement("div");return function(t,n,r){for(e.innerHTML=n;e.firstChild;)t.insertBefore(e.firstChild,r)}}()}}(),Triage=site0.isStep?null:function(){var e={KILL:"Hide this thread permanently, and set style",TIME:"Hide this thread until it gets new replies, and set style",NONE:'Delete "hidden" mark and set style',KILL_N:"Hide this thread permanently",TIME_N:"Hide this thread until it gets new replies",ATTR:"Set style additionally",WATCH:"Watch and mark as I've read all posts so far",UNWATCH:'Delete "watched" mark',SHOW:"Show always without regard to filter",UNSHOW:'Remove "show" mark',STICKY:"Sticky this thread",UNSTICKY:"Unsticky this thread",GO:"Open this thread",UNDO:"Undo last modification",ARC1:"Take an archive (one-shot archive)",ARC:"Start archiving this thread",UNARC:"Stop archiving this thread",MERGEB:"Mark as marge base",MERGE:"Merge this thread with merge base",MERGEOP:"Merge all threads in OP",UNMERGE:"Unmerge this thread",SPC:"Spacer for caption. Nothing happen",MENU:"Open menu",PMENU:"Open post menu",PWATCH:"Mark as I've read all posts before this"};pref_func.tooltips.str.triage=function(t){var n=t.target.getAttribute("data-cmd"),r=t.target.getAttribute("data-attr"),a=["NONE","ATTR","KILL","TIME"].indexOf(n)!==-1;return e[n]+"."+(a?"\nSet style "+(r||"default")+".":"")};var t=function(e,t){for(var n=t.onclick?this.prep_func_onclick(t.onclick):null,r=[],a=t.embed?"span":"div",s=["WATCH","UNWATCH","SHOW","UNSHOW","STICKY","UNSTICKY","ARC","ARC1","UNARC"],o=cnst.dom("<"+a+(t.style?' style="'+t.style+'"':"")+' class="'+pref.script_prefix+"_"+(t.class||"triage")+'"></'+a+">"),i=e.replace(/\s*\/\/.*/gm,"").split("\n").filter(function(e){return e}),l=0;l<i.length;l++){0==l||t.menu||o.appendChild(document.createElement("br"));for(var e=i[l].split(","),c=0;c<e.length;c+=3)if("SPC"!==e[c]){var p=t.embed?document.createElement("a"):cnst.dom('<button name="triage" type="button"></button>');if(p.textContent=e[c+1],p.setAttribute("style","pointer-events:auto;"+(t.child_style||"")+e[c+2]),t.child_class&&p.setAttribute("class",pref.script_prefix+"_"+t.child_class),p.setAttribute("data-cmd",e[c]),e[c+2]&&p.setAttribute("data-attr",e[c+2]),n&&(p.onclick=n),t.onmousewheel&&(p["on"+brwsr.mousewheel]=t.onmousewheel),t.menu){var _=document.createElement("div");_.appendChild(p),
_.appendChild(document.createElement("br")),p=_}o.appendChild(p),s.indexOf(e[c])!=-1&&(r[r.length]=[p,e[c]])}else o.appendChild(document.createTextNode(e[c+1]))}this.pn=o,this.format_tgt=0!==r.length?r:null,pref_func.tooltips.add_root(o)};return t.prototype.destroy=function(){pref_func.tooltips.remove_root(this.pn)},t.prototype.tooltips=e,t.prototype.prep_func_onclick=function(e){return function(t){var n=t.target.getAttribute("data-cmd");n&&e(n,t.target.getAttribute("data-attr")||"")}},t.prototype.howto="3,How to describe triage:<br>4,Each line will be each line of triage.<br>4,1st column : command<br>"+["KILL","TIME","NONE","KILL_N","TIME_N","ATTR","WATCH","UNWATCH","STICKY","UNSTICKY","SHOW","UNSHOW","GO","UNDO","ARC1","ARC","UNARC","MERGEB","MERGE","MERGEOP","UNMERGE","SPC","MENU"].map(function(t){return"5,"+t+" : "+e[t]+("UNDO"===t?". Effective to commands above":"")+".<br>"}).join("")+"4,2nd column : caption on the triage button.<br>4,3rd column : style applied to the thread.<br>4,Repeat these as you wish.",Object.defineProperty(t.prototype,"postMenu_html",{value:'<span class="'+pref.script_prefix+'_embeddedTriage" data-cmd="PMENU">▶</span>',enumerable:!0,configurable:!0}),t.prototype.postMenu=cnst.dom(t.prototype.postMenu_html),t}(),timer_obj,chart_obj,setting_obj,post_form_obj,catalog_obj,cnst_obj=function(){function e(e){return cnst.init2({func_str:"tile:get:left:tile:get:bottom:button:"+e+":Show2:tile:set:left",pn_st:a})}site.script_body=document.createElement("div"),site.script_body.className=pref.script_prefix,site.script_body.innerHTML='<div style="display:none"></div><div></div>',site.popup_body=site.script_body.childNodes[1],site.root_body.appendChild(site.script_body);var t=site.features,n=pref.features;if(t.postform&&n.postform&&null==site.postform&&!site2[site.nickname].postform.activation){var r=document.createElement("div");r.innerHTML='<div><textarea style="height:5em;display:none" cols="20" name="'+pref.script_prefix+'_draft"></textarea><button name="'+pref.script_prefix+'_send" style="display:none">send</button></div>',site.script_body.appendChild(r),r=r.childNodes[0],site.components.postform_comment=r.childNodes[0],site.postform=site.components.postform_comment,site.components.postform_submit=r.childNodes[1]}if(site.settings){site.settings.innerHTML="<span>[CC</span><span></span>]",site.settings.setAttribute("style","float:right;");var a=site.settings.childNodes[1];site.settings.childNodes[0].setAttribute("style","cursor:pointer"),site.settings.childNodes[0].onclick=function(){cnst.show_hide(a)},site.settings.childNodes[1].setAttribute("style","display:none")}if(t.setting&&n.setting&&e("settings").addEventListener("click",pref_func.settings.show_hide,!1),t.catalog&&n.catalog&&(catalog_obj=make_catalog_obj(pref[site.whereami]&&pref[site.whereami].embed&&pref.test_mode[114]?null:e("Watcher")),pref.catalog.embed&&"catalog"===site.whereami&&site2[site.nickname].catalog_native_frame_prep(e("Frame"))),pref.test_mode[94]||cnst.tile_set_left(),chart_obj=make_chart_obj(t.graph&&n.graph&&pref3.stats.use?e("Graph"):null),t.setting2&&n.setting2&&(setting_obj=make_setting_obj(e("settings2"))),t.postform&&n.postform&&(null!=site.postform||site2[site.nickname].postform.activation)&&(post_form_obj=make_post_form_obj(e(r?"Draft":"PostForm"))),t.debug&&n.debug&&make_debug_obj(e("debug")),t.page&&n.page){var s=cnst.init2({func_str:"tile:get:left:tile:get:bottom:txt:init:Show2",pn_st:a});timer_obj=make_timer_obj(s)}if(cnst.tile_set_bottom(),t.catalog&&n.catalog&&pref.catalog.board.board_tags_same&&pref_func.settings.onchange_funcs["tag.same_tag_refresh"](),site.settings3){var o={CC:function(e){cnst.show_hide(e.target.previousSibling)},entry:function(e){"A"===e.target.tagName&&o[e.target.textContent](e)},Settings:pref_func.settings.show_hide};site.settings3.innerHTML='<span style="float:right">[<span style="display:none">'+(t.setting&&n.setting?"<a>Settings</a> ":"")+(t.catalog&&n.catalog?"<a>Watcher</a> ":"")+(t.catalog&&n.catalog&&pref.catalog.embed&&"catalog"===site.whereami?"<a>Frame</a> ":"")+(t.graph&&n.graph&&pref3.stats.use?"<a>Graph</a> ":"")+(t.postform&&n.postform&&(null!=site.postform||site2[site.nickname].postform.activation)?"<a>"+(r?"Draft":"PostForm")+"</a> ":"")+(t.debug&&n.debug?"<a>debug</a> ":"")+"</span><a>CC</a>]</span>",site.settings3.setAttribute("style","float:right;"),site.settings3.addEventListener("click",o.entry,!1)}}(),uip_tracker=null,liveTag={pn:null,pn_summary:null,active:{pk:0,in:0,ex:0},tags_ci:null,tags:Object.create(Object.create(null)),mems:Object.create(null,{getFromName:{value:function(e){var t=common_func.fullname2dbt(e);return t[2]?this[t[0]][t[1]][t[2]]:this[t[0]][t[1]]}},init:{value:function(){function e(e){this[e.domain]=Object.create(Object.create(this.acc,{domain:{value:e.domain}}),{p:{value:Object.create(null)}}),site2[e.domain].lth_init&&site2[e.domain].lth_init(e)}function t(e){var t="#"+e.board.substr(1,e.board.length-2);liveTag.tags[t]&&liveTag.tags[t].ref_tag===t&&(t=liveTag.tags[t].ref_tag),this[e.domain][e.board]=Object.create(Object.create(Object.getPrototypeOf(this[e.domain]),{board:{value:e.board},btag:{value:t,writable:!0}}),{nr:{value:0,writable:!0},nrtm:{value:0,writable:!0},u:{value:0,writable:!0},o:{value:null,writable:!0},p:{value:{},configurable:!0,writable:!0},pgs:{value:null,writable:!0},d:{value:0,writable:!0}}),pref.liveTag.inherit_board_name&&(liveTag.update_tags_in_th_sub([],{},[t],{},1,null,0,this[e.domain][e.board]),liveTag.update_pn_buf.delayed_do())}function n(e){var t=this[e.domain][e.board];t[e.no]=Object.create(Object.getPrototypeOf(t),{1:{value:void 0,writable:!0},2:{value:[8585216,0,0]},u:{value:0,writable:!0},no:{value:e.no,writable:!0}})}return function(r){return void 0===this[r.domain]&&e.call(this,r),r.board?(void 0===this[r.domain][r.board]&&t.call(this,r),r.no?(void 0===this[r.domain][r.board][r.no]&&n.call(this,r),this[r.domain][r.board][r.no]):this[r.domain][r.board]):this[r.domain]}}()},acc:{value:Object.create(null,{0:{get:function(){var e=this.btags;return this.tl&&(e=e?e.concat(this.tl):this.tl),e||[]},set:function(e){var t=this.btags;if(t){pref.liveTag.ci&&(t=t.map(function(e){return e.toLowerCase()}));for(var n=0;n<e.length;n++)t.indexOf(pref.liveTag.ci?e[n].toLowerCase():e[n])!=-1&&e.splice(n--,1)}e.length>0?this.tl=e:void 0!==this.tl&&delete this.tl}},t:{get:function(){return this[1]}},t0:{get:function(){return this[0]},set:function(e){this[0]=e}},t1:{get:function(){return this[1]},set:function(e){this[1]=e}},wt:{get:function(){return this[2]},set:function(e){this[2]=e}},key:{get:function(){return this.domain+this.board+(this.no?this.no:"")}},tags:{get:function(){return(this[0]||[]).concat(this[1]||[])}},btags:{get:function(){var e=pref.liveTag.inherit_board_name&&pref.liveTag.lock_board_name?[this.btag]:null;return this.btag2&&pref.liveTag.inherit_board_tags&&pref.liveTag.lock_board_tags?e?e.concat(this.btag2):this.btag2:e}},watched:{get:function(){return 786432&this[2][0]}},time_checked:{get:function(){return this[2][2]}},archived:{get:function(){return(7340032&this[2][0])>>20},set:function(e){this[2][0]=4287627263&this[2][0]|(7&e)<<20}},posts_saved:{get:function(){return(33554432&this[2][0])>>25},set:function(e){this[2][0]=4261412863&this[2][0]|(1&e)<<25}},force_ar:{get:function(){return(5242880&this[2][0])>>20}},rescan_dp:{get:function(){return(16777216&this[2][0])>>24},set:function(e){this[2][0]=4278190079&this[2][0]|(1&e)<<24}},nrtm:{get:function(){return this[2][1]>>16}},nr:{get:function(){return 65535&this[2][1]}},nof_posts:{get:function(){return 65535&this[2][0]},set:function(e){this[2][0]=(4294901760&this[2][0])+e}},LS_synced:{get:function(){return 1&this.d},set:function(e){this.d=4294967294&this.d|1&e}},IDB_synced:{get:function(){return(2&this.d)>>1},set:function(e){this.d=4294967293&this.d|(1&e)<<1}}})}}),postprocess_board_add_btag:function(e,t){for(var n=0;n<e.length;n++)e[n]="#"+e[n].replace(/[&<>'"#]/g,""),e[n].length>pref.liveTag.maxstr&&e.splice(n--,1);var r=t.btag2&&t.btag2.length===e.length;if(r)for(var n=0;n<e.length;n++)if(e[n]!==t.btag2[n]){r=!1;break}if(!r){for(var n=0;n<e.length;n++)liveTag.tags[e[n]]&&liveTag.tags[e[n]].ref_tag===e[n]&&(e[n]=liveTag.tags[e[n]].ref_tag);Object.defineProperty(Object.getPrototypeOf(t),"btag2",{value:e,writable:!0}),pref.liveTag.inherit_board_tags&&liveTag.inherit_board_tags_changed_1(e,t)}},retag:function(e,t){t&&(t.list_nup.add_scan(e),e.wt[0]|=131072);var n={com:e.tags.join(" "),parse_funcs:{type_com:"txt"},__proto__:e};liveTag.prep_tags(n,!0),cataLog.threads[e.key]&&cataLog.Footer.update_force(e.key,null,e)},retag_db:DelayBuffer.prototype.delayed_do.bind(new DelayBuffer(function(){cataLog.catalog_filter_changed&&cataLog.catalog_filter_changed()},10)),inherit_board_name_changed:function(){for(var e in this.mems)for(var t in this.mems[e])this.inherit_board_tags_changed_1([this.mems[e][t].btag],this.mems[e][t],!pref.liveTag.inherit_board_name)},inherit_board_tags_changed:function(){for(var e in this.mems)for(var t in this.mems[e])this.mems[e][t].btag2&&this.inherit_board_tags_changed_1(this.mems[e][t].btag2,this.mems[e][t],!pref.liveTag.inherit_board_tags)},inherit_board_tags_changed_1:function(e,t,n){for(var r=0;r<e.length;r++)this.retag_in_th_sub(e[r],t,n);for(var a in t){t.domain,t.board,t[a].no;this.retag(t[a],n&&t[a].tags.length>=pref.liveTag.max)}this.retag_db(),this.update_pn_buf.delayed_do()},ex_list_changed:function(){if(pref.liveTag.ex_list)for(var e in this.mems)for(var t in this.mems[e])for(var n in this.mems[e][t]){var r=this.mems[e][t][n],a=r.tags.length;this.exclude_tags(r,r.t0,r.t1,!0)&&this.retag(r,a>=pref.liveTag.max)}},exclude_tags:function(e,t,n,r){var a=pref_func.merge_obj5a(e,pref.liveTag.ex_list_obj5,null);if(a){var s=this.exclude_tags_1(t,a,r?e:null),o=this.exclude_tags_1(n,a,r?e:null);return r&&(s&&(e.t0=s),o&&(e.t1=o)),s||o}},exclude_tags_1:function(e,t,n){var r=!1;if(e)for(var a=e.length-1;a>=0;a--)e:for(var s=0;s<t.length;s++)if(t[s].test(e[a])){n&&this.delete_tags(e[a],n.key),e.splice(a,1),r=!0;break e}return r?e:null},key_dirty:Object.create(null),tags_array_old:[],tags_proto:{pk:!1,in:!1,ex:!1,pn:null,mems_keys_obj:function(){var e={};for(var t of this.mems.keys())if(void 0===t.no)for(var n in t)e[t[n].key]=this.mems.get(t);else e[t.key]=this.mems.get(t);return e},mems_keys:function*(){for(var e of this.mems.keys())if(void 0===e.no)for(var t in e)yield e[t];else yield e},mems_keys_length:function(){var e=0;for(var t of this.mems.keys())if(void 0===t.no)for(var n in t)++e;else++e;return e},mems_keys_length_and_set_top:function(){var e=0,t={};for(var n of this.mems.keys()){var r=this.mems.get(n);if(void 0===t[r]&&(t[r]=0),void 0===n.no)for(var a in n)++t[r],++e;else++t[r],++e}for(var a in t)(t[a]>t[this.key]||t[a]==t[this.key]&&a<this.key)&&(this.key=a);return this.key===this.ref_tag&&(this.key=this.ref_tag),e},mems_boards:function(){var e={};for(var t of this.mems.keys())e[t.key.substr(0,t.key.lastIndexOf("/")+1)]=null;return e}},scan_regex:/#[^#, \.:;\n\|"<>&]+(?=[#, \.:;\n\|"<>&]|$)/g,update_tags_in_th_sub:function(e,t,n,r,a,s,o,i,l){for(var c=e.length,p=0;c<a&&p<n.length;){var _=n[p++],d=pref.liveTag.ci?_.toLowerCase():_;if(d===_&&(d=_),void 0===r[d]&&void 0===t[d]){if(t[d]=_,void 0===this.tags[_]){if(void 0===this.tags_ci[d]){null===this.key_dirty[d]&&this.update_pn();var u=new Map;this.tags_ci[d]={key:_,mems:u,ref_tag:_,num:0,ur:o,__proto__:this.tags_proto},this.tags_array_old[this.tags_array_old.length]=this.tags_ci[d]}_!==d&&(this.tags[_]=this.tags_ci[d],void 0===this.tags_ci[d].sb?this.tags_ci[d].sb=[_]:this.tags_ci[d].sb[this.tags_ci[d].sb.length]=_)}var f=this.tags[_].mems;if(_===this.tags[_].ref_tag)_=this.tags[_].ref_tag;else for(var h in f)if(_===f.get(h)){_=f.get(h);break}if(f.has(i))l||(this.key_dirty[d]=null);else{var m=null===s?i:i[s.no],g=f.get(m);void 0!==g&&g===_||(this.key_dirty[d]=null),f.set(m,_)}e[c++]=_}var b=this.tags_reserved[d];if(null===s){var v=this.tags_ci[d].pk;(void 0!==b||v)&&this.tags_reserved_found_scan(d,!0,b,v,i)}else void 0!==b&&this.tags_reserved_found(d,!0,b)}return p},retag_in_th_sub:function(e,t,n){if(n)this.tags[e]&&this.delete_tags(e,t.key);else{this.update_tags_in_th_sub([],{},[e],{},1,null,0,t);var r=this.tags[e].mems;for(var a in t)r.has(a)&&r.delete(a)}},update_tags_in_th:function(e,t,n,r,a,s,o){var i=this.generate_ur(s[1]),l=[],c={};if(this.update_tags_in_th_sub(l,c,e,n,r,a,i,o),t)for(var p=this.update_tags_in_th_sub(l,c,t,n,r,a,i,o);p<t.length;){var _=t[p++],d=pref.liveTag.ci?_.toLowerCase():_;void 0===n[d]&&(c[d]!==_&&(this.key_dirty[d]=null),void 0===c[d]&&this.delete_tags(_,a.key))}for(var p in n)this.check_update_tags_color(n[p],i);for(var p=0;p<l.length;p++)this.check_update_tags_color(l[p],i);return e=null,this.keys_fix=c,l},remove_tags_in_th:function(e){var t=this.mems[e[0]][e[1]][e[2]];if(t){for(var n=t.tags,r=0;r<n.length;r++)this.delete_tags(n[r],t.key);var a=t.btags;if(pref3.stats.use&&stats.thread_removed(e),t.q&&(t.q=null),t.nr&&(pref.notify.favicon||pref.notify.title.notify)&&notifier.favicon.set(),delete this.mems[e[0]][e[1]][e[2]],a)for(var r=0;r<a.length;r++)this.key_dirty[pref.liveTag.ci?a[r].toLowerCase():a[r]]=null,pref.liveTag.style.use&&this.update_ur_1(a[r]);this.update_pn_buf.delayed_do()}},delete_tags:function(e,t,n){if(!n&&0!=this.subscribers.length)for(var r=0;r<this.subscribers.length;r++)this.delete_tags.call(this.subscribers[r],e,t,!0);var a=pref.liveTag.ci?e.toLowerCase():e;if(this.key_dirty[a]=null,this.tags[e]&&(this.tags[e].mems.delete(this.mems.getFromName(t))&&pref.liveTag.style.use&&this.update_ur_1(e),0==this.tags[e].mems.size)){this.tags[e].pn;null!==this.tags[e].pn&&this.pn.removeChild(this.tags[e].pn);for(var r in this.active)this.tags[e][r]&&this.active[r]--;var s=this.tags_ci[a].sb;if(s)for(var r=0;r<s.length;r++)delete this.tags[s[r]];delete this.tags_ci[a],pref.debug_mode[3]&&console.log("Remove: "+e)}},check_update_tags_color:function(e,t){var n=this.tags[e].ur;this.tags[e].ur|=t,~n&t&&this.update_tag_node(e,null,!0)},rm_404_list:function(e,t,n){var r={};if(this.mems[e]&&this.mems[e][t]){var a=this.mems[e][t];for(var s in a)void 0===n[s]&&(r[s]=a[s])}return r},rm_404_1:function(e,t,n,r){var a=e+t+n;pref.test_mode[65]||pref.archive.IDB.auto_clean&&IDB.req(e,t,n,"pruned_time",Date.now(),"check_clean"),pref.test_mode[67]||archiver.clean_list(e,t,n),!r&&!pref.test_mode[65]&&pref.archive.IDB.auto_restore&&cataLog.threads[a]&&cataLog.restore_th_from_IDB(e,t,n),r||this.rm_404_2(e,t,n)},rm_404_2:function(e,t,n){this.remove_tags_in_th([e,t,n]),pref[cataLog.embed_mode].deleted_posts.auto_clean&&site2[e].clean_up_deleted_posts_1(t+n)},tooltip:function(e,t){var n,r=e.target;if("checkbox"===r.type){var a=r.name.substr(-2,2);n=r.getAttribute("name").slice(0,-3),t+=("pk"===a?"Fetch":"in"===a?"Show":"Hide")+" threads which have "+n+"."}else{n=r.getAttribute("name"),t+=n+": "+liveTag.make_info(n)+"<br>";var s=new RegExp("^"+site.nickname);for(var o of liveTag.tags[n].mems.keys())t+=o.key.replace(s,"")+", "}return t},boardlist_click_entry:function(e){if(!e.ctrlKey){e.preventDefault();var t=e.target.textContent;this.cbx_changed(t,pref.liveTag.click_func_bl,null,e.target)}},generate_ur:function(e){return e>>16!=0?3:0!=(65535&e)?1:0},CountNR:function(){var e=function(){this.nrtm=0,this.nr=0,this.nth=0};return e.prototype={count:function(e){if(786432&e[0]){var t=65535&e[1];t&&(this.nrtm+=e[1]>>16,this.nr+=t,this.nth++)}},count_all:function(){for(var e in liveTag.mems)for(var t in liveTag.mems[e]){var n=liveTag.mems[e][t];if(n.nr<0){var r=new liveTag.CountNR;for(var a in n)r.count(n[a].wt);n.nrtm=r.nrtm,n.nr=r.nr}this.nrtm+=n.nrtm,this.nr+=n.nr}}},e}(),update_ur:function(e,t,n){var r=common_func.fullname2dbt(e);this.mems[r[0]][r[1]].nr=-1;for(var a=this.mems[r[0]][r[1]][r[2]].tags,s=0;s<a.length;s++)n?this.update_ur_1(a[s]):this.tags[a[s]]&&this.check_update_tags_color(a[s],t)},update_ur_1:function(e){var t=this.tags[e].ur,n=0;if(pref.test_mode[24])for(var r of this.tags[e].mems_keys())n|=liveTag.generate_ur(r.wt[1]);else{var a=this.tags[e].mems_keys_obj();for(var r in a){var s=this.mems.getFromName(r);s&&(n|=liveTag.generate_ur(s.wt[1]))}}t!=n&&(this.tags[e].ur=n,this.update_tag_node(e,null,!0))},count_ur:function(e){var t=0,n={},r=new this.CountNR;if(pref.test_mode[24])for(var a of this.tags[e].mems_keys())r.count(a.wt),n[a.domain+a.board]=null,t++;else{var s=this.tags[e].mems_keys_obj();for(var a in s){var o=common_func.fullname2dbt(a),i=this.mems[o[0]][o[1]][o[2]].wt;i&&r.count(i),n[o[0]+o[1]]=null}t=this.tags[e].mems_keys_length()}var l=Object.keys(this.tags[e].mems_boards()).length;return[r.nrtm,r.nr,r.nth,t,Object.keys(n).length,l]},make_info:function(e){var t=liveTag.count_ur(e);return"U: "+t[0]+"/"+t[1]+"/"+t[2]+" / T: "+t[3]+" / B: "+t[4]+"/"+t[5]},tag_onmouseover:function(e){return liveTag.make_info(e.target.textContent)},filter_changed_broadcast:function(){if(this.NC)this.clg.filter_changed();else for(var e=gClg.Clgs,t=0;t<e.length;t++)e[t].liveTag.NC||e[t].filter_changed()},cbx_changed:function(e,t,n,r,a){var s=this.tags[e],o=s.in===!1&&s.ex===!0,i=s.in===!1&&s.ex===!1,l=s.in===!0&&s.ex===!1,c="pkin"===t||"in"===t||"inex"===t&&(a?!i:!o),p="pkin"===t&&s.pk===s.in,_="ex"===t||"inex"===t&&(a?!l:!i);c&&this.cbx_emulate_inv(e,"in",n),p&&this.cbx_emulate_inv(e,"pk",n),_&&this.cbx_emulate_inv(e,"ex",n),this.filter_changed_broadcast(),this.update_tag_node(e,r)},filter_onchange:function(e,t,n){e.rexps=common_func.kwd_prep_regexp(e),this===liveTag||!e.rexps||this.subscribed||this.subscribe(),t&&!this.subscribed||this.update_pn(n)},tags_reserved:Object.create(null),tags_reserved_found_scan:function(e,t,n,r,a){("pk"===n||r)&&(scan.list_nup.add_board(a,0),scan.scan("b",a.domain)),void 0!==n&&this.tags_reserved_found(e,t,n)},tags_reserved_found:function(e,t,n){this.tags_ci[e][n]!=t&&this.cbx_changed(e,"pk"===n?"pkin":n,!0),delete this.tags_reserved[e]},tags_reserved_init:function(e,t){this.tags_reserved=Object.create(null);for(var n={},r=0;r<e.length;r++){var a="!"===e[r][0]?"ex":"#"===e[r][1]?"pk":"in",s="in"===a?e[r]:e[r].slice(1),o=pref.liveTag.ci?s.toLowerCase():s;if(this.tags_ci[o]){if(this.tags_reserved_found(o,t,a),t&&"pk"===a){var i=liveTag.tags_ci[o].mems_boards();for(var l in i)n[l]=null}}else t&&(this.tags_reserved[o]=a)}return n},update_pn_last_filter_active:!1,sort_func:function(e,t){return t.num-e.num||t.mems.size-e.mems.size||(t.key>e.key?-1:1)},update_pn_disp_func:function(e,t){if(null===e)return 0;for(var n=0;n<e.length;n++)if(e[n].test(t))return 1;return 0},update_pn_buf:null,setup_pn:function(e,t){this.pn=e.getElementsByTagName("div")["catalog.filter.tag_list"],this.pn.onchange=this.cbx_onchange_entry.bind(this),this.pn_summary=this.pn.previousSibling.childNodes[0],this.filter_onchange(t,!0,!0)},update_pn:function(e){null!==this.pn&&(this.update_pn_1_lazy.cancel(),this.update_pn_1(e,!0))},update_pn_pos:null,update_pn_1_lazy:null,update_pn_1:function(e,t){var n=this===liveTag,r=this.tags_array_old,a=0,s=0;for(var o in this.key_dirty)this.tags_ci[o]?n&&(this.tags_ci[o].num=pref.liveTag.ci?this.tags_ci[o].mems_keys_length_and_set_top():this.tags_ci[o].mems_keys_length()):s++,a++;n&&(a||pref.test_mode[73])&&r.sort(this.sort_func),a&&(t=!0);var i=e||this.update_pn_pos,l=pref.liveTag.lazy_each,c=this.clg?this.clg.pref.catalog.filter.tag_search.rexps:pref.catalog.filter.tag_search.rexps,p=c||this.update_pn_last_filter_active;if(p||s){for(var _=t?this.pn.firstChild:this.update_pn_pos[0],d=t?0:this.update_pn_pos[2],u=_?null:document.createDocumentFragment(),f=this.clg?this.clg.pref.catalog.filter.tag_search.show_nof_boards:pref.catalog.filter.tag_search.show_nof_boards,h=t?0:this.update_pn_pos[1];h<r.length;h++){var m=r[h].key,g=pref.liveTag.ci?m.toLowerCase():m,b=g in this.key_dirty,v=this.tags_ci[g]||!n&&b&&(this.prep_NC(m),this.tags_ci[g]);if(v){if(p){var y=v.pn;if(i||b){var w=this.update_pn_disp_func(c,g);0===w?null!==y&&(_===y&&(_=y.nextSibling),this.pn.removeChild(y),v.pn=null):(null!==y?b&&(v.pn.childNodes[3].textContent=v.num+": "+m):l>0&&(y=document.createElement("div"),y.setAttribute("name",m),y.innerHTML='<input type="checkbox" name="'+g+'.pk" '+(v.pk?"checked":"")+'><input type="checkbox" name="'+g+'.in" '+(v.in?"checked":"")+'><input type="checkbox" name="'+g+'.ex" '+(v.ex?"checked":"")+">"+v.num+(f?"/"+Object.keys(this.tags[m].mems_boards()).length:"")+": "+m,v.pn=y),_!==y?l>0&&(u?u.appendChild(y):(this.pn.insertBefore(y,_),_=y.nextSibling),0==--l&&(this.update_pn_pos=[_,h+1,d])):_=y.nextSibling,d++)}else y&&(_=y.nextSibling,d++)}}else n&&r.splice(h--,1);if((a<=0||b&&--a<=0)&&(!p||l<=0))break}l<=0&&this.update_pn_pos[1]<r.length?this.update_pn_1_lazy.delayed_do(pref.liveTag.lazy_delay):this.update_pn_pos=null,u&&this.pn.appendChild(u),this.pn_summary.textContent=c?d+(this.update_pn_pos?"...":"")+"/"+r.length:""}if(this.update_pn_last_filter_active=c,n){if(pref.virtualBoard.show&&!e&&this.update_boardlist(),0!=this.subscribers.length){for(var h=0;h<this.subscribers.length;h++)for(var k in this.key_dirty)this.subscribers[h].key_dirty[k]=null;if(null===this.update_pn_pos&&!e&&t)for(var h=0;h<this.subscribers.length;h++)this.subscribers[h].update_pn_buf.delayed_do()}this.sub_tagSearch&&null===this.update_pn_pos&&this.sub_tagSearch()}else c||this.unsubscribe();this.key_dirty=Object.create(null)},subscribers:[],subscribe:function(){this.NC||(this.tags_ci={},this.tags=Object.create(this.tags_ci));for(var e=0;e<this.tags_array_old.length;e++)this.prep_NC(this.tags_array_old[e].key);liveTag.subscribers.push(this),this.subscribed=!0},unsubscribe:function(e){if(e)for(var t in this.tags_ci)this.tags_ci[t].pn&&this.tags_ci[t].pn.remove();if(this.NC){for(var t in this.tags_ci)this.tags_ci[t].pk||this.tags_ci[t].in||this.tags_ci[t].ex||delete this.tags_ci[t];for(var t in this.tags)this.tags[t].pk||this.tags[t].in||this.tags[t].ex||delete this.tags[t]}else delete this.tags_ci,delete this.tags;liveTag.subscribers.splice(liveTag.subscribers.indexOf(this),1),this.subscribed=!1},factory:function(e,t,n){var r={clg:e,footer:t,pn:null,pn_summary:null,NC:n,subscribed:!1,key_dirty:Object.create(null),__proto__:liveTag};return r.update_pn_buf=new DelayBuffer(liveTag.update_pn.bind(r),pref.liveTag.disp_delay),r.update_pn_1_lazy=new DelayBuffer(liveTag.update_pn_1.bind(r,!0),pref.liveTag.lazy_delay),n&&(r.tags_ci={},r.tags=Object.create(r.tags_ci),r.active={pk:0,in:0,ex:0}),r},popup_filter:function(){var e={"catalog.filter.tag_search.str":function(){this["."]?this["."].liveTag.filter_onchange(this["."].pref.catalog.filter.tag_search,null,!0):liveTag.filter_onchange(pref.catalog.filter.tag_search,null,!0)},__proto__:pref_func.settings.oninput_funcs.__proto__},t={"catalog.filter.tag_search.re":e["catalog.filter.tag_search.str"],"catalog.filter.tag_search.show_nof_boards":function(){for(var e=pref.catalog.filter.tag_search.show_nof_boards,t=0;t<liveTag.tags_array_old.length;t++){var n=liveTag.tags_array_old[t].key,r=liveTag.tags[n];r&&r.pn&&(r.pn.childNodes[3].textContent=r.num+(e?"/"+Object.keys(liveTag.tags[n].mems_boards()).length:"")+": "+n)}},__proto__:e};return{html:'<div style="float:left"><input type="checkbox" name="catalog.filter.tag"> Tag :</div><div style="float:left"><div> Fetcn / In / Out / Threads / Tag <ITBL25"catalog.filter.tag_search.str" placeholder="Search tags..."> <ICBX"catalog.filter.tag_search.re">RE</div><div><span></span>'+pref_func.settings.html_funcs.rollup('<IC"catalog.filter.tag_search.show_nof_boards">Show number of boards<br><BTN"tagB.shown_t_pk,T"><BTN"tagB.shown_t_in,T"><BTN"tagB.shown_t_ex,T"> Toggle checkboxes of shown tags<br><BTN"tagB.shown_c_pk,C"><BTN"tagB.shown_c_in,C"><BTN"tagB.shown_c_ex,C"> Clear checkboxes of shown tags<br><BTN"tagB.all_c_pk,C"><BTN"tagB.all_c_in,C"><BTN"tagB.all_c_ex,C"> Clear checkboxes of all tags')+'<br></div><div style="overflow:auto;resize:both;float:left;height:16px;width:250px" name="catalog.filter.tag_list"></div>'+pref_func.settings.html_funcs.rollup('<div style="clear:both"><BTN"tag2bList,Add"> selected tags to the last of board group<br>1,Label: <ITBL20"catalog.filter.tag2bList.label" placeholder="default: topmost tag"><br>1,<IR"catalog.filter.tag2bList.by,tag">By tag<br>1,<IR"catalog.filter.tag2bList.by,board">By board<br></div>')+'</div><div style="clear:both"></div>',oninput_funcs:e,onchange_funcs:t,embed:function(n){if(!liveTag.pn){var r=document.createElement("div");r.innerHTML="<div>"+pref_func.format_html_str(this.html)+"</div>",r.appendChild(n),liveTag.setup_pn(r,pref.catalog.filter.tag_search);var a=site2[site.nickname].make_tack();return a.onclick=cnst.tack_float_nSblgs,a.setAttribute("style","float:right;font-size:2em"),r.insertBefore(a,r.firstChild),pref_func.add_onchange(r,t,e),pref_func.apply_prep(r,!1),pref_func.tooltips.add_root(r),liveTag.update_pn(!0),r}},popup:function(){if(!liveTag.pn){var n=function(){pref_func.tooltips.remove_root(r.pn),liveTag.pn=null,cnst.div_destroy(r.pn,!0)},r=cnst.init3({func_str:"top:0px:left:0px:Show:tb",exit:n});r.cn.innerHTML=pref_func.format_html_str(liveTag.popup_filter.html),pref_func.add_onchange(r.cn,t,e),pref_func.apply_prep(r.pn,!1),pref_func.tooltips.add_root(r.pn),liveTag.update_pn(!0)}}}}(),cbx_all_onchange:function(e){var t=this["."]&&this["."].liveTag||liveTag,n=e.target,r="c"===n.name.substr(-4,1),a=n.name.substr(-2,2),s="all"===n.name.substr(-8,3),o=null;for(var i in t.tags_ci){var l=t.tags_ci[i];if((s||l.pn)&&(!r||l[a])&&(t.cbx_emulate_inv(i,a,!0),t.update_tag_node(i),"pk"===a&&l[a])){var c=liveTag.tags_ci[i].mems_boards();if(o)for(var p in c)o[p]=c[p];else o=c}}o&&0!=Object.keys(o).length&&scan.scan_ui("refresh_tag",{tgts:o,options:{callback:function(){scan.scan("t")},priority:6}}),t.filter_changed_broadcast()},cbx_emulate_inv:function(e,t,n,r){var a=this.tags[e],s=!a[t];a[t]=s,null!==a.pn&&(a.pn.childNodes["pk"===t?0:"in"===t?1:2].checked=s),this.cbx_onchange(e,t,s,n,r)},cbx_onchange_entry:function(e){var t=e.target,n=t.name.slice(0,-3),r=t.name.substr(-2,2);this.tags[n]||this.prep_NC(n),this.tags[n][r]=t.checked,this.cbx_onchange(n,r,this.tags[n][r]),this.filter_changed_broadcast(),this.update_tag_node(n)},cbx_onchange:function(e,t,n,r,a){if(a&&!this.NC||(this.active[t]+=n?1:-1),"pk"===t&&(n&&!this.tags[e].in&&this.cbx_emulate_inv(e,"in"),!a&&n&&!r&&gClg)){var s=this.tags[e].mems_boards();0!=Object.keys(s).length&&scan.scan_ui("refresh_tag",{tgts:s,options:{callback:function(){scan.scan("t")},priority:6}})}if("in"!==t&&"ex"!==t||this.active.in+this.active.ex===(n?1:0)&&this.clg&&(this.clg.pref.catalog.filter.tag=n,this.clg.components.tag_use.checked=n),!a&&!this.NC)for(var o=gClg.Clgs,i=0;i<o.length;i++)this!==o[i].liveTag&&!o[i].liveTag.NC&&(o[i].liveTag===liveTag&&this.subscribed||o[i].liveTag.subscribed)&&(o[i].liveTag.subscribed&&!o[i].liveTag.tags[e]&&o[i].liveTag.prep_NC(e),o[i].liveTag.cbx_emulate_inv(e,t,r,!0))},add_tags_to_boardlist:function(){var e,t=liveTag.tags_array_old,n=pref.catalog.filter.tag2bList.label||(t.filter(function(e){return e.in})[0]||t.filter(function(e){return e.pk})[0]||t.filter(function(e){return e.ex})[0]).key;if("tag"===pref.catalog.filter.tag2bList.by)e=[t.filter(function(e){return e.in}).map(function(e){return e.key}).join(","),t.filter(function(e){return e.pk}).map(function(e){return"#"+e.key}).join(","),t.filter(function(e){return e.ex}).map(function(e){return"!"+e.key}).join(",")];else{for(var r=t.filter(function(e){return e.in}).map(function(e){return e.mems_boards()}),a=t.filter(function(e){return e.pk}).map(function(e){return e.mems_boards()}),s=t.filter(function(e){return e.ex}).map(function(e){return e.mems_boards()}),o={},i=0;i<r.length;i++)for(var l in r[i])o[l]=null;for(var i=0;i<a.length;i++)for(var l in a[i])o[l]=null;for(var i=0;i<s.length;i++)for(var l in s[i])delete o[l];e=Object.keys(o)}pref_func.settings.onchange_funcs["tag.add_to_list"](n+" ,"+e.filter(function(e){return e}).join(","))},search_by_tags:function(e){var t=!this.active.in,n=e.tags;if(this.active.in)for(var r=0;r<n.length;r++)if(n[r]in this.tags&&this.tags[n[r]].in){t=!0;break}if(t&&this.active.ex)for(var r=0;r<n.length;r++)if(n[r]in this.tags&&this.tags[n[r]].ex){t=!1;break}return t},keys_fix:null,prep_tags:function(e,t){var n=this.mems.init(e),r=n.wt;if((65536&r[0]&&pref.liveTag.watch_all&&e.time_created||8388608==(8650752&r[0])&&(e.time_created>0||e.time_posted>0))&&(cataLog.set_watch_time_thread(e.key,cataLog.embed_mode,e.time_created,e.time_posted,e,r),pref.archive.store_watched&&n.watched&&!n.archived&&archiver.start_1("ARC",n)),65536&r[0]||t){65536&r[0]&&(!pref.test_mode[64]&&pref[cataLog.embed_mode].deleted_posts.merge&&archiver.prep_deleted_posts(e,n),pref.test_mode[67]||archiver.check_op(e,n),r[0]=4294836224&r[0]);var a=(pref.liveTag,[[],[]]);if(pref.liveTag.inherit_board_name){a[pref.liveTag.lock_board_name?0:1][0]=n.btag}if(pref.liveTag.inherit_board_tags&&n.btag2){var s=pref.liveTag.lock_board_tags?0:1;a[s]=a[s].concat(n.btag2)}var o=site2[e.domain].check_reply.check_t1_op(e);if(0!=o.length){var i=pref.liveTag.lock_tags_in_op?0:1;a[i]=a[i].concat(o)}this.exclude_tags(e,a[0],a[1]),e.parse_funcs.has_editing&&e.posts[0].editing&&0!=a[0].length&&(a[0]=this.extract_tags_trim_editing(e,n,a[0])),0!=a[0].length&&(n.t0=this.update_tags_in_th(a[0],null,{},a[0].length<pref.liveTag.max?a[0].length:pref.liveTag.max,e,r,this.mems[e.domain][e.board])),0!=a[1].length?this.extract_tags(e,a[1],this.keys_fix):(null!==n.t1&&(n.t1=null),this.update_pn_buf.delayed_do())}return n},update_tags_in_editing_posts:function(e,t,n){for(var r=e.parse_funcs.posts_obj(e,t.ed_t[t.ed_t.length-1].no),a=!1,s=t.ed_t.length-1;s>=0;s--)if("string"!=typeof t.ed_t[s]){var o=r[t.ed_t[s].no];if(o&&!o.editing){if("post"===pref.liveTag.from||o.no==e.no){site2[e.domain].wrap_to_parse.posts({posts:[o],__proto__:e});var i=site2[e.domain].check_reply.check_t1_op(o);0!=i.length&&(a=!0),t.ed_t=t.ed_t.slice(0,s).concat(i).concat(t.ed_t.slice(s+1))}else t.ed_t.splice(s,1);n[n.length]=o}}if(0!=n.length)return pref.debug_mode[24]&&console.log(e.key+": retag_req: "+i+", "+a+", "+(t.ed_t&&t.ed_t.map(function(e){return"string"==typeof e?e:e.no+"("+e.time+")"}))),0==t.ed_t.length?void(t.ed_t=null):a?this.extract_tags(e,t.ed_t,null,null,!0):i?this.extract_tags_trim_editing(e,t,t.ed_t,!0)&&void 0:void 0},extract_tags_trim_editing:function(e,t,n,r){for(var a=null,s=n.length-1;s>=0;s--)"string"!=typeof n[s]&&(a||(a=n.slice(0,s+1)),n.splice(s,1));return(a||r)&&(t.ed_t=r||!t.ed_t?a:a.concat(t.ed_t),pref.debug_mode[24]&&console.log(e.key+": lth.ed_t: "+(t.ed_t&&t.ed_t.map(function(e){return"string"==typeof e?e:e.no+"("+e.time+")"})))),n},extract_tags:function(e,t,n,r,a){var s=this.mems[e.domain][e.board][e.no];if(e.parse_funcs.has_editing&&(t=this.extract_tags_trim_editing(e,s,t,a)),!n){this.keys_fix={};var o=s.t0;if(null!==o&&0!=o.length)if(pref.liveTag.ci)for(var i=0;i<o.length;i++)this.keys_fix[o[i].toLowerCase()]=o[i];else for(var i=0;i<o.length;i++)this.keys_fix[o[i]]=o[i]}var l=void 0!==o?o.length:s.t0.length,c=this.update_tags_in_th(t,s.t1,this.keys_fix,pref.liveTag.max-l,e,s.wt,this.mems[e.domain][e.board],r);return(0!=c.length||s.t1&&0!==s.t1.length)&&(s.t1=c),this.update_pn_buf.delayed_do(),this.keys_fix=null,s},tags_boardlist:null,update_boardlist:function(e){if(site.components.boardlist){null===this.tags_boardlist&&(this.tags_boardlist=[],pref_func.settings.onchange_funcs["virtualBoard.search.show"](null,!0),this.filter_onchange(pref.virtualBoard.search,!0));for(var t=0,n=e,r=0,a=0,s="both"===pref.virtualBoard.p_board&&pref.virtualBoard.p_remove,o=pref.virtualBoard.search.show&&pref.virtualBoard.search.rexps;a<pref.virtualBoard.max&&t<this.tags_array_old.length;){var i=this.tags_array_old[t].key;s&&"/"+i.substr(1)+"/"in this.mems[site.nickname]?r++:o&&!this.update_pn_disp_func(o,pref.liveTag.ci?i.toLowerCase():i)||(this.tags_boardlist[a]!==i&&(this.tags_boardlist[a]=i,n=!0),a++),t++}
a!=this.tags_boardlist.length&&(this.tags_boardlist.splice(a,this.tags_boardlist.length-a),n=!0),n&&site2[site.nickname].show_boardlist(this.tags_boardlist,this.boardlist_click_entry)}},update_tag_node:function(e,t,n){if(null!==cataLog.threads){var r=liveTag.tags[e].mems_keys_obj(),a=n||!this.NC?gClg.footer:this.footer;for(var s in r)a.color_tag_node(s,e,n)}if(!this.NC){var o=this.tags_ci[pref.liveTag.ci?e.toLowerCase():e].key,i=t||site2[site.nickname].query_tag_node(o);i&&this.color_tag_node(i,o)}},color_tag_node:function(e,t){var n=pref.liveTag.style,r=this.tags[t],a=n.use?r?r.ur:liveTag.tags[t].ur:0,s=r&&r.ex?a>=2?n.exurtm:a>=1?n.exur:n.ex:r&&r.in?a>=2?n.inurtm:a>=1?n.inur:n.in:a>=2?n.urtm:a>=1?n.ur:null;s?e.setAttribute("style",s):e.removeAttribute("style")},update_tag_nodes:function(e,t,n,r,a){for(var s=pref.debug_mode[35]?a&&a.slice():null,o=s?[]:null,i=r||document.createElement("span"),l=i.firstChild,c=0;c<e.length;c++){var p=a&&a.slice();s&&o.push(l&&l.textContent||null);var _=null,d=e[c];if(a&&d==a[c])l&&(l=l.nextSibling),l&&c!=e.length-1&&(l=l.nextSibling),s&&o.push("same");else{var u=a?a.indexOf(d,c):-1;if(u==-1)i.insertBefore(this.create_tag_node_1(d,n,"span"),l),_=!0,a&&a.splice(c,0,d),s&&o.push("new");else if(u==c+1){var f=l,h=l.nextSibling;l=h.nextSibling;var m=e.indexOf(a[c],c+1),g=a.splice(c,1)[0];if(m==-1)i.removeChild(h),i.removeChild(f),s&&o.push("remove");else{var b=i.childNodes[2*(m+1)-1]||null;i.insertBefore(h,b),i.insertBefore(f,b),a.splice(m,0,g),s&&o.push("down")}l=l.nextSibling,l&&c!=e.length-1&&(l=l.nextSibling)}else{var f=i.childNodes[2*u];_=f.previousSibling,i.insertBefore(f,l),a.splice(c,0,a.splice(u,1)[0]),s&&o.push("up")}}c==e.length-1||l&&!_||i.insertBefore(_!==!0&&_||document.createTextNode(t),l),s&&(a&&e.slice(0,c+1).toString()!==a.slice(0,c+1).toString()&&console.log("ERROR: update_tag_nodes: arr: ",c,a,e,p,s,o),a&&0!=i.textContent.indexOf(a.slice(0,c+1).join(t))&&console.log("ERROR: update_tag_nodes_1: ",c,i.textContent,a,p,s,o))}if(l){for(;l.nextSibling;)i.removeChild(l.nextSibling);i.removeChild(l)}return s&&i.textContent!==this.create_tag_nodes(e,t,n).textContent&&console.log("ERROR: update_tag_nodes: ",i.textContent,e,s),i},create_tag_nodes:function(e,t,n){for(var r=document.createElement("span"),a=0;a<e.length;a++)0!=a&&t&&r.appendChild(document.createTextNode(t)),r.appendChild(this.create_tag_node_1(e[a],n,"span"));return r},create_tag_node_1:function(e,t,n){var r=document.createElement(n);return r.setAttribute("class",pref.script_prefix+"_tag"),r.textContent=e,this.color_tag_node(r,e),r},tag_node_onclick:function(e){var t=e.target.textContent;this.tags[t]||this.prep_NC(t),this.cbx_changed(t,pref.liveTag.click_func,null,null,e.ctrlKey)},prep_NC:function(e){if(this!==liveTag){var t=pref.liveTag.ci?e.toLowerCase():e;if(liveTag.tags_ci[t]){if(!this.tags_ci[t]){var n=liveTag.tags_ci[t];this.tags_ci[t]=this.NC?{pn:null,pk:!1,in:!1,ex:!1,__proto__:n}:{pn:null,pk:n.pk,in:n.in,ex:n.ex,__proto__:n}}this.tags[e]||(this.tags[e]=this.tags_ci[t])}}}};liveTag.update_pn_buf=new DelayBuffer(liveTag.update_pn.bind(liveTag),pref.liveTag.disp_delay),liveTag.update_pn_1_lazy=new DelayBuffer(liveTag.update_pn_1.bind(liveTag,!0),pref.liveTag.lazy_delay),liveTag.tags_ci=Object.getPrototypeOf(liveTag.tags),pref_func.site2_json(!1,!0,["liveTag"]);var IDB=function(){function e(e){console.log("IDB: ERROR: ",e),P.report({err_str:"IDB_ERROR:"+e.target.error.name});for(var t of L.keys())console.log(L.get(t));console.log("last_closed: ",S)}function t(e){pref.debug_mode[21]&&console.log("IDB: BLOCKED: "+e.oldVersion+" -> "+e.newVersion)}function n(e){console.log("IDBT: ABORT: "+e.target.error.name,e),P.report({err_str:"IDBT_ABORT:"+e.target.error.name});var t=e.target,n=t.db;navigator.webkitTemporaryStorage&&navigator.webkitTemporaryStorage.queryUsageAndQuota(console.log.bind(console)),x(n,t,"IDBT_abort:"+t.error.name)}function r(e){console.log("IDBT: ERROR: "+e.target.error.name,e),P.report({err_str:"IDBT_ERROR:"+e.target.error.name});var t=e.target.transaction;x(e.target.db||e.target.transaction&&e.target.transaction.db,t,"IDBT_onerror:"+t.error.name)}function a(e){e.target.onsuccess=null,s(e,!0)}function s(e,t){var n=e.target.result;D[n.name]=n.version,delete R[n.name+(t?"vc":"rw")];var r=t&&U[n.name]||z[n.name];if(pref.debug_mode[20]){var a=r&&r.debug_query()||null;console.log("IDB: opened: "+(L.size+1)+" "+n.name.replace(/^[^\/]*/,"")+" v"+n.version+", "+(a&&a.length)+" req(s), "+e.type+", "+(a&&a.coms))}var s={type:e.type,tr_count:1,reqs:r,pass:0,wdg:null,crawler:1,oss:{},tr_info:new Map,req_kinds:{},coms:a&&a.coms,done:0,done_put:0};if(L.set(n,s),r){for(var l=0;l<n.objectStoreNames.length;l++)s.oss[n.objectStoreNames[l]]=null;if(t){var _=e.target.transaction;if(C(n),u(_,function(){k({target:{db:n}})}),1==n.version)return delete R[n.name+"rw"],pref4.archive.IDB_board_sel_options=null,n.createObjectStore("Meta"),i(n,t);for(var d=0;;){X();var f=r.shift();if(s.pass++,!f)break;pref.debug_mode[20]&&s.done++,pref.debug_mode[22]&&"put"!==f.kind&&console.log("req_upgrade: "+f.no+", "+f.kind+", "+f.key+", "+r.debug_query().length),s.req_kinds[f.kind]=null;var h=null===s.oss[f.no];"put"===f.kind?h?(B(z,n.name,f),pref.debug_mode[22]&&d++):(p(n,f,k),s.oss[f.no]=null,pref.debug_mode[22]&&console.log("req_upgrade: "+f.no+", "+f.kind+", "+f.key+", "+r.debug_query().length)):"delete_th"===f.kind&&h&&c(n,f,_)}pref.debug_mode[22]&&d&&console.log("req_upgrade: downgraded: "+d),i(n,t)}else{var m=function e(){o(n,r,t,e)};s.complete_func=m,o(n,r,t,m)}}else i(n,t)}function o(e,t,n,r){var a=L.get(e);if(a){X();var s=void 0!==R[e.name+"vc"]?null:t.shift();if(a.pass++,s){pref.debug_mode[20]&&a.done++,pref.debug_mode[22]&&"put_m"!==s.kind&&console.log(e.name.replace(/^[^\/]*/,"")+s.no+", "+s.kind+", "+s.key+", "+t.debug_query().length);var l=null===a.oss[s.no];if("get_all_m"===s.kind){for(var c=[],p={},u=0;u<s.reqs.length;u++)null===a.oss[s.reqs[u].no]&&(c[c.length]=s.reqs[u],p[s.reqs[u].no]=null);0!==c.length?v(e,{nos:Object.keys(p),reqs:c},r):r()}else if("list_os"===s.kind)s.obj(site.nickname,e.name.substr(pref.script_prefix.length+1),Array.prototype.slice.call(e.objectStoreNames).filter(function(e){return"Meta"!==e})),r();else if("put_m"===s.kind){for(var c=[],p={},u=0;u<s.reqs.length;u++)null!==a.oss[s.reqs[u].no]?B(U,e.name,s.reqs[u]):(c[c.length]=s.reqs[u],p[s.reqs[u].no]=null);pref.debug_mode[22]&&console.log(e.name.replace(/^[^\/]*/,"")+(c[0]&&c[0].no||"skipped")+"("+Object.keys(p).length+"), "+s.kind+"("+c.length+"), "+s.key+", "+t.debug_query().length),c.length>1?(s.reqs=c,s.nos=Object.keys(p),_(e,s,r)):1==c.length?_(e,c[0],r):r()}else if("put"===s.kind)l?_(e,s,r):(B(U,e.name,s),r());else if("delete"===s.kind)l?d(e,s,r):r();else if("clean_up"===s.kind||"clean_m"===s.kind){O[e.name]||(O[e.name]={list:[],write:null});for(var f=O[e.name].list,m=f.length,p={Meta:null,__proto__:s.obj},u=0;u<f.length;u++)p[f[u].no]=null;if("clean_up"===s.kind)for(var b=Date.now(),y=e.objectStoreNames,u=0;u<y.length;u++)null!==p[y[u]]&&(f[f.length]={no:y[u],pruned_time:b});else for(var u=0;u<s.reqs.length;u++)null===a.oss[s.reqs[u].no]&&null!==p[s.reqs[u].no]&&(f[f.length]={no:s.reqs[u].no,pruned_time:s.reqs[u].obj});null===O[e.name].write?(O[e.name].write=!1,h(e,s,r)):g(e,null,r,f.length!==m)}else r();a.crawler<pref.archive.IDB.nof_tr&&!t.isEmpty&&(a.crawler++,o(e,t,n,r))}else 0==--a.crawler&&i(e,n)}}function i(e,t){k({target:{db:e}});var n=t&&U[e.name]&&U||z;n[e.name]&&n[e.name].isEmpty&&delete n[e.name],M[e.name]&&l(e.name),t?z[e.name]&&!z[e.name].isEmpty&&I(e.name):U[e.name]&&!U[e.name].isEmpty&&I(e.name,!0),0===Object.keys(z).length&&0===Object.keys(U).length&&0===Object.keys(M).length&&K.stop()}function l(e){z[e]?z[e].push_all(M[e]):z[e]=M[e],delete M[e]}function c(e,t,n){e.deleteObjectStore(t.no),pref.debug_mode[23]&&console.log("IDB: delete_th: "+e.name+t.no+", "+e.objectStoreNames.length)}function p(e,t,n){C(e);var r=e.createObjectStore(t.no).transaction;u(r,function(r){return function(a){pref.test_mode[66]?(B(z,e.name,t),n({target:{db:e}})):_(e,t,n),r&&r(a)}}(r.oncomplete))}function _(t,n,r){var a=n.reqs||[n];try{for(var s=u(t.transaction(n.nos||n.no,"readwrite",n),r,n,t),o=0;o<a.length;o++){var i=a[o];if(pref.test_mode[82]&&i.obj instanceof Blob)if(pref.test_mode[83])i.obj=null;else if(pref.test_mode[84]){for(var l="";2*l.length<i.obj.size;)l+=Math.random();i.obj=l}else{for(var c=[],p=0;2*p<i.obj.size;p++)c[p]=Math.floor(65536*Math.random());i.obj=String.fromCharCode.apply(null,c)}pref.debug_mode[23]&&console.log("put_"+(n.nos?"m: ":"1: ")+t.name.replace(/^[^\/]*/,"")+i.no+", "+i.key+("posts"===i.key?":"+i.obj.length:"")+(n.nos?" "+(o+1)+"/"+n.nos.length+"/"+n.reqs.length:""));s.objectStore(i.no).put("posts"!==i.key?i.obj:JSON.stringify(i.obj,archiver.store_json_func),"posts"!==i.key?i.key:i.key+"_"+i.obj[0].no).onerror=e}pref.debug_mode[20]&&(L.get(t).done_put+=a.length)}catch(e){console.log("IDB: fail to put: "+e.name+": "+JSON.stringify(i,["no","key","kind"]),e,L.get(t)),"InvalidStateError"===e.name&&(B(M,t.name,i),pref.debug_mode[20]&&console.log("IDB: re-scheduled:")),r({target:{db:t}})}}function d(e,t,n){u(e.transaction(t.no,"readwrite"),n).objectStore(t.no).delete(t.key)}function u(e,t,a,s){return e.oncomplete=a?f:t,e.onabort=n,e.onerror=r,a&&L.get(s).tr_info.set(e,{req:a,func:t}),e}function f(e){var t=L.get(e.target.db);if(t){var n=t.tr_info.get(e.target).func;t.tr_info.delete(e.target),n&&n(e)}}function h(e,t,n){e.objectStoreNames.contains("Meta")?u(e.transaction("Meta","readwrite"),n).objectStore("Meta").get("pruned_time").onsuccess=m:(O[e.name].write=!0,g(e,t,n,!0))}function m(e,t){var n=e.target.transaction.db,r=e.target.result;if(r){var a=L.get(n),s=a&&a.oss||{};r=r.filter(function(e){return null===s[e.no]});for(var o={},i=0;i<r.length;i++)void 0!==o[r[i].no]&&r.splice(o[r[i--].no],1),o[r[i].no]=i;O[n.name].list=r.concat(O[n.name].list.filter(function(e){return void 0===o[e.no]}))}O[n.name].write=!0,g(n,null,null,!0)}function g(e,t,n,r){for(var a=O[e.name].list,s=Date.now()-36e5*pref.archive.IDB.prune,o=0;o<a.length&&a[o].pruned_time<s;)pref.archive.IDB.auto_restore_remove&&gClg.Remove_thread_refresh(site.nickname+e.name.replace(/^[^\/]*/,"")+a[o].no,null,!0),pref.archive.IDB.prune_flush?B(z,e.name,{no:a[o++].no,key:null,obj:b,kind:"get_all"},!0):B(U,e.name,{no:a[o++].no,key:null,obj:null,kind:"delete_th"},!0);o>0&&a.splice(0,o),O[e.name].write&&(r||0!==o)&&B(z,e.name,{no:"Meta",key:"pruned_time",obj:a,kind:"put"}),n&&n()}function b(e,t,n,r){var a="CatChan_archive_pruned_"+e+"-"+t.slice(1,-1)+"-"+n+".tar",s="pruned_"+e+t+n+Date.now();archiver.event_funcs.export_thread(e,t,n,r,s,a),N(e,t,n,null,null,"delete_th")}function v(e,t,n){for(var r=u(e.transaction(t.nos,"readonly"),n),a=0;a<t.reqs.length;a++){var s=t.reqs[a];pref.debug_mode[23]&&console.log("get_all: "+e.name.replace(/^[^\/]*/,"")+s.no+", "+s.key);var o=r.objectStore(s.no).openCursor("posts"===s.key?IDBKeyRange.bound("posts","postt",!1,!0):void 0);o.onsuccess=w,s.result={},j.set(o,s)}}function y(e){var t=e.target.transaction.db,n=L.get(t);return n&&n.pass++,t}function w(e){var t=(y(e),e.target),n=j.get(t),r=e.target.result;if(r)n.result[r.key]=r.key.indexOf&&0===r.key.indexOf("posts")?JSON.parse(r.value):r.value instanceof ArrayBuffer?common_func.arraybuffer2blob(r.key,r.value):r.value,r.continue();else{j.delete(t);var a=e.target.transaction.db.name.replace(pref.script_prefix+".",""),s=e.target.source.name;if(setTimeout(function(e,t,n){return function(){e.obj(site.nickname,t,n,e.result)}}(n,a,s),0),pref.debug_mode[29]){var o=0;for(var i in n.result)o+=0===i.indexOf("posts")?2*JSON.stringify(n.result[i]).length:n.result[i]&&n.result[i].size;console.log("IDB: "+a+s+": "+Object.keys(n.result).length+" files, "+o.toLocaleString()+" bytes.")}}}function k(e){var t=e.target.source&&e.target.source.transaction.db||e.target.db||e.target.result,n=L.get(t);n&&(1!==n.tr_count?n.tr_count-=1:T(t,n))}function x(e,t,n){var r=L.get(e);if(r&&"readonly"!==t.mode){var a=r.tr_info.get(t).req;B("delete_th"===a.kind?U:M,e.name,a),console.log(n+": close and re-req, "+a.kind)}}function T(e,t,n){if(t||(t=L.get(e)),n&&t)for(var r of t.tr_info.keys())x(e,r,n);L.delete(e);var a=!n&&void 0!==t.req_kinds.delete_th&&1===Object.keys(t.req_kinds).length||1==e.version;pref.debug_mode[26]&&a&&console.log("Hit the case of test_mode[78]"),!a||pref.test_mode[78]?e.close():setTimeout(function(){e.close()},0),pref.debug_mode[20]&&console.log("IDB: closed: "+L.size+" "+e.name.replace(/^[^\/]*/,"")+" v"+e.version+", "+(t?t.type+", done:"+t.done+", done_put:"+t.done_put+", "+t.coms:"")),t&&(t.db=e),S=t,X()}function C(e){L.get(e).tr_count+=1}function N(e,t,n,r,a,s){if(e===site.nickname){var o=pref.script_prefix+"."+t,i={no:n,key:r,obj:a,kind:s};B("delete_th"===s?U:z,o,i,!0)}else"function"==typeof a&&(H[e+t+n]=a,a="sub_callback"),pref.test_mode[86]&&a instanceof ArrayBuffer?send_message(e,["IDB",["ACC",[e,t,n,r,null,s]]],null,[a]):send_message(e,["IDB",["ACC",[e,t,n,r,a,s]]])}function I(n,r,o){var i=n+(r?"vc":"rw");if(void 0!==R[i]&&(!o||++R[i]<L.size))return void(pref.debug_mode[27]&&o&&console.log("IDB: WATCHDOG: "+i+", "+R[i]));R[i]=0;var l=window.indexedDB.open(n,r&&D[n]+1||void 0);l.onerror=e,l.onsuccess=s,l.onupgradeneeded=a,l.onblocked=t}function A(e,t,n,r,a,s){if(e===site.nickname){var o={no:n,key:r,obj:a,kind:s};B("delete_th"===s?U:z,t,o,!0)}}function B(e,t,n,r){if(W++,!P&&q?(P=q.shift("limegreen","w","IDB",0),P.report({start:Date.now(),prog_str:"Opening"})):X(),e[t]){var a=e===z&&e[t].isEmpty;if(e[t].push(n),a)for(var s of L.keys()){var o=L.get(s);if(o.crawler<pref.archive.IDB.nof_tr&&s.name===t&&"success"===o.type){o.crawler++,setTimeout(o.complete_func,100);break}}}else e[t]=new F(t,e!==U,n),r&&I(t,e===U);K.start(1e3*pref.archive.IDB.watchdog)}function E(){var e=0;for(var t of L.keys())e+=L.get(t).crawler;for(var n=[0,0,0,0,0,0,Object.keys(U).length,Object.keys(z).length,Object.keys(M).length,e,L.size,Object.keys(R).length],r=[U,z,M],a=0;a<3;a++)if(n[a+6])for(var s in r[a])n[a+3]+=r[a][s].length,n[a]+=r[a][s].length_whole;return{sums:n,total:n.reduce(function(e,t){return e+t}),str:n.join("/")+"/"+W}}var j=new Map,S=null,L=new Map,O={},D={},R={},U={},z={},M={},H={},F=function(e,t,n){this.ary=[],this.ary_ro=[],this.allow_multi=t,this.reqs[e]||(this.reqs[e]={}),this.reqs=this.reqs[e],this.cls={},n&&this.push(n),this.cl=null,this.cl_idx=0};F.prototype={shift:function(){for(var e=this.allow_multi?pref.archive.IDB.nof_cl_max:1,t=0;t<this.ary_ro.length&&t<e&&"get_all"===this.ary_ro[t].kind;)t++;if(0!=t)return{kind:"get_all_m",reqs:this.ary_ro.splice(0,t)};if(0!==this.ary_ro.length)return this.ary_ro.shift();if(0===this.ary.length&&!this.cl)return null;if(pref.test_mode[79]){for(;t<e;){var n=this.ary[t];if(!n)break;if(n.cl&&(this.ary=this.ary.slice(0,t+1).concat(n.cl,this.ary.slice(t+1)),n.cl=null),"put"!==n.kind)break;this.cls[n.no]=null,delete this.cls[n.no+n.key],t++}return t>1?{kind:"put_m",reqs:this.ary.splice(0,t)}:this.ary.shift()}var r=[];if(pref.test_mode[81])for(;r.length<e;){var n;if(null===this.cl){if(!(n=this.ary[t])||"put"!==n.kind)break;t++,n.cl&&(this.cls[n.no]=null,this.cl=n.cl,this.cl_idx=0,n.cl=null)}else n=this.cl[this.cl_idx++],this.cl_idx>=this.cl.length&&(this.cl=null);r[r.length]=n,delete this.reqs[n.no+n.key]}else{for(var a;r.length<e;){var n=this.ary[t];if(!n||"put"!==n.kind)break;if(void 0!==a&&(!n.no||a!==n.no))break;n.cl?(void 0===n.idx&&(this.ary[t]={kind:"put",cl:[n].concat(n.cl),idx:0,no:n.no},n.cl=null,n=this.ary[t],this.cls[n.no]=n),n.idx>=n.cl.length-1&&(this.cls[n.no]=null,t++),n=n.cl[n.idx++]):(this.cls[n.no]=null,t++),r[r.length]=n,delete this.reqs[n.no+n.key],r.length===pref.archive.IDB.nof_cl-1&&(a=n.no)}if(this.ary[t]&&this.ary[t].cl&&this.ary[t].idx<this.ary[t].cl.length){var s=this.ary.splice(t,1)[0];this.ary[this.ary.length]=s}}return t>0&&this.ary.splice(0,t),0===t&&this.ary[0]&&"check_clean"===this.ary[0].kind&&(this.cls.check_clean=null),r.length>1?{kind:"put_m",reqs:r}:r.length>0?r[0]:this.ary.shift()},push:function(e){if("get_all"===e.kind||"list_os"===e.kind)return void(this.ary_ro[this.ary_ro.length]=e);if("put"===e.kind)var t=e.no+e.key,n=this.reqs[t];if(n)n.obj="posts"===e.key?n.obj.concat(e.obj):e.obj;else if(t){"posts"!==e.key&&"pruned_time"!==e.key&&"posts_deleted"!==e.key||(this.reqs[t]=e);var r=this.cls[e.no];r?r.cl?r.cl[r.cl.length]=e:r.cl=[e]:(this.ary[this.ary.length]=e,this.cls[e.no]=e)}else if("check_clean"===e.kind){var t=null+e.key,n=this.cls[t];n?n.reqs[n.reqs.length]=e:(e={kind:"clean_m",reqs:[e],no:null},this.cls[t]=e,this.ary[this.ary.length]=e)}else this.ary[this.ary.length]=e},push_all:function(e){for(;!e.isEmpty;)this.push(e.shift())},get length(){return this.ary.length+this.ary_ro.length},get length_whole(){for(var e=0,t=0;t<this.ary.length;t++)e+=this.ary[t].cl?this.ary[t].cl.length-(this.ary[t].idx||0):1;return e+this.ary_ro.length},get isEmpty(){return 0===this.ary.length&&!this.cl&&0===this.ary_ro.length},reqs:{},debug_query:function(){for(var e=Array.prototype.concat.apply(this.ary_ro,this.ary.map(function(e){return e.cl?pref.test_mode[81]?[e].concat(e.cl):e.cl.slice(e.idx||0):e})),t=[],n=1,r=0;t.length<20&&r++<e.length;)e[r]&&e[r-1].kind===e[r].kind?n++:(t[t.length]=e[r-1].kind+(1!=n?"*"+n:""),n=1);return r<e.length&&(t[t.length-1]+="..."),{coms:t,length:this.ary_ro.length+"/"+this.ary.length+"/"+e.length}}};var q=null,P=null,W=0,X=function(){},X=DelayBuffer.prototype.delayed_do.bind(new DelayBuffer(function(){if(P){var e=E();P.report({prog_str:e.str}),0===e.total&&(P.report({end:Date.now()}),P=null,W=0)}},100)),K=new Watchdog(function(){function e(){t.str&&(P.report({err_str:"WDG: "+t.str}),t.str="")}var t=E();pref.debug_mode[27]&&console.log("IDB: "+t.str);var n={};for(var r of L.keys()){var a=L.get(r);pref.debug_mode[27]&&console.log(a),a.wdg!==a.pass?(a.wdg=a.pass,n[r.name]=null):(e(),T(r,a,"IDB: WDG"))}for(var s in U)null===n[s]||U[s].isEmpty||I(s,!0,!0);for(var s in z)null===n[s]||U[s]&&!U[s].isEmpty||z[s].isEmpty||I(s,void 0,!0);for(var s in M)null===n[s]||U[s]&&!U[s].isEmpty||z[s]&&!z[s].isEmpty||M[s].isEmpty||(l(s),I(s,void 0,!0));for(var o in R){var i=o.replace(/(rw|vc)$/,"");null===n[i]||U[i]||z[i]||(e(),I(i,o.search(/vc$/)!=-1,!0))}0!==t.total&&K.start(1e3*pref.archive.IDB.watchdog)},6e4);return{req:N,req_raw:A,clean_up:function(e,t,n){D[pref.script_prefix+"."+t]&&(N(e,t,null,null,n,"clean_up"),liveTag.mems[e][t].IDB_synced=1)},set_indicator:function(e){q||(q=e)},sub_funcs:function(e,t){if("ACC"===e[0])"sub_callback"===e[1][4]?e[1][4]=IDB.sub_ack:t.length>0&&(e[1][4]=t[0]),N.apply(this,e[1]);else if("ACK"===e[0]){var n=e[1].slice(0,3).join("");H[n]&&H[n].apply(this,e[1]),delete H[n]}},sub_ack:function(e,t,n,r){send_message("parent",["IDB",["ACK",[e,t,n,r]]])}}}(),archiver=function(){function e(e,n,r,s){window.URL&&(b||a(),t(new Blob([e],{type:n}),r,s,b))}function t(e,t,r,a){pref.archive.tar?m.add_blob(e,t,r,a):n(e,"CatChan_"+t.key.replace(/\//g,"_")+"_"+r)}function n(e,t){if(e instanceof ArrayBuffer&&(e=common_func.arraybuffer2blob(t,e)),brwsr.ff&&!httpd.isLocal)return void send_message("parent",["ARCHIVER",["DOWNLOAD",[e,t]]]);var n=window.URL.createObjectURL(e);r(n,t),window.URL.revokeObjectURL(n)}function r(e,t){if(!pref.test_mode[70]){var n=document.createElement("div");n.innerHTML="<a href="+e+' download="'+t+'">',brwsr.ff&&site.script_body.appendChild(n),n.childNodes[0].click(),brwsr.ff&&site.script_body.removeChild(n)}}function a(){var e=(new Date).toString().split(" ").slice(1,5);b=[e[2],v[e[0]],e[1],e[3].replace(/:/g,"")].join(""),httpd.req({tgts:[],timestamp:b,__proto__:g},0)}function s(e){httpd.req_add({tgts:e,timestamp:b,__proto__:g},0)}function o(e,t,n,r,s,o,i,l,c){for(var p=0;p<r.length;p++){var _="tn"===e?site2[t.domain].catalog_json2html3_thumbnail(r[p],t.board):site2[t.domain].catalog_json2html3_src(r[p],t.board);if(_){b||a();var d={domain:t.domain,board:t.board,no:t.no,key:t.key,kind:e,to_file:s||i,to_idb:o||l,timestamp:b,__proto__:g};if(site2[t.domain].archive_patch_domain&&site2[t.domain].archive_patch_domain(d),(".webm"===_.substr(-5,5)?i||l:s||o)&&(c[c.length]={url:_,__proto__:d}),r[p].extra_files)for(var u=0;u<r[p].extra_files.length;u++)_="tn"===e?site2[t.domain].catalog_json2html3_thumbnail(r[p].extra_files[u],t.board):site2[t.domain].catalog_json2html3_src(r[p].extra_files[u],t.board),(".webm"===_.substr(-5,5)?i||l:s||o)&&(c[c.length]={url:_,__proto__:d})}}}function l(){function e(e){return function(t,n){var r=e.call(this,t,n);return r&&t.localArchive?archiver.url2file(t.localArchive,r):r}}for(var t in site2)if(site2[t].hasOwnProperty("catalog_json2html3_thumbnail")&&(site2[t].catalog_json2html3_thumbnail=e(site2[t].catalog_json2html3_thumbnail)),site2[t].hasOwnProperty("catalog_json2html3_src")&&(site2[t].catalog_json2html3_src=e(site2[t].catalog_json2html3_src)),site2[t].hasOwnProperty("parse_funcs"))for(var n=["catalog_html","page_html","thread_html","post_html"],r=0;r<n.length;r++)site2[t].parse_funcs.hasOwnProperty(n[r])&&site2[t].parse_funcs[n[r]].hasOwnProperty("op_img_url")&&(site2[t].parse_funcs[n[r]].op_img_url=e(site2[t].parse_funcs[n[r]].op_img_url))}function c(e,t,n,r,a){if(window.URL){var s=r?t:"text/html"===e.type?(new DOMParser).parseFromString(t,"text/html"):JSON.parse(t),o="auto"===pref.archive.format?common_func.name2domainboardthread(e.name.replace(/\.[^\.]*$/,"").split("_")[0].split("-").slice(0,3).join("/"),!0):[site0.domains[pref.archive.domain],"/"+pref.archive.board.replace(/\//g,"")+"/"];if(pref.test_mode[80]&&(o[1]=o[1].slice(0,-1)+(r?"_IDB/":"_File/")),pref.archive.fix_inconsistency&&"meguca"!==o[0]){s.posts[0].no!=o[2]&&(s.posts=[common_func.deep_copy(s.posts[0])].concat(s.posts),s.posts[0].no=parseInt(o[2],10),console.log("Archiver: Fixed: added dummy OP: "+o.join("")));for(var i=0;i<s.posts.length;i++)s.posts[i].filename===!1&&(s.posts[i].filename="LOST_AT_ARCHIVE",console.log("Archiver: Fixed: filename was lost: "+o.join("")+"#"+s.posts[i].no))}w||(l(),w=!0);return cataLog.scan_boards_keyword_callback2(o[0]+","+o[1]+","+k+++",thread_"+("text/html"===e.type?"html":"json"),{date:Date.now(),status:200,response:s},["archive_restore",{localArchive:n,page:r?"IDB":"File",archiveFile:r?"IDB":e,refresh:a||pClg,__proto__:cataLog.scan_boards_keyword_callback2_default_args}])[0]}}function p(e,t,n,r){"ARC"===e||"ARC1"===e?(t.archived|="ARC"===e?6:1,r||scan.list_nup.add_scan(t)):"UNARC"===e&&(t.archived=0,archiver.clean_list(t.domain,t.board,t.no)),n&&pref.catalog.footer.archived&&cataLog.Footer.update_force(t.key)}function _(e,t){return null===x[e]?void 0:t}function d(){pref.debug_mode[28]&&console.log("list_all_obj_downloading: ",I);for(var e in liveTag.mems){var t=site2[e].parse_funcs.post_json.time_unit;for(var n in liveTag.mems[e]){var r=N[e]&&N[e][n],a=r||{};for(var s in liveTag.mems[e][n]){var o=liveTag.mems[e][n][s],i=I[o.key]||o.time_checked/t;o.ed_t&&(i=pref.archive.editing_timeout?u(o)||i:o.ed_t[o.ed_t.length-1].time-1),o.archived?I[o.key]?a[s]=I[o.key]:(!a[s]||a[s]<i)&&(a[s]=i):o.posts_saved&&(a[s]=-i)}r||0===Object.keys(a).length?r&&0===Object.keys(r).length&&delete N[e][n]:(N[e]||(N[e]={}),N[e][n]=a)}N[e]&&0===Object.keys(N[e])&&delete N[e]}}function u(e){for(var t=Date.now()/1e3,n=e.ed_t.length-1;n>=0;n--)if("string"!=typeof e.ed_t[n]){var r=e.ed_t[n].time;if(t-r<3600)return r}return null}function f(e){e&&e.key!==C||(N=JSON.parse(e&&e.newValue||localStorage[C]||"{}"))}function h(){pref3.archive.working&&localStorage&&(d(),0===Object.keys(N).length?delete localStorage[C]:localStorage[C]=JSON.stringify(N),pref.debug_mode[28]&&console.log("list_all_obj: ",N))}var m=function(){function e(e,n,a){var s=new Uint8Array(512);a="tn_"===a.substr(0,3)?"thumbs/"+r(a.substr(3)):"img_"===a.substr(0,4)?"images/"+r(a.substr(4)):r(a),t(s,0,n.domain+"/"+r(n.board.slice(1,-1))+"/"+n.no+"/"+a,100),t(s,100,"100777",8),t(s,108,"0",8),t(s,116,"0",8),t(s,124,(e.byteLength||e.size||0).toString(8),12),t(s,136,Math.floor(Date.now()/1e3).toString(8),12),t(s,148,"        ",8),s[156]=48;var o=0;for(i=0;i<157;i++)o+=s[i];return t(s,148,o.toString(8),8),s}function t(e,t,n,r){for(var a=0;a<n.length&&a<r;)e[t++]=255&n.charCodeAt(a++);a<r&&(e[t++]=0)}function r(e){return encodeURIComponent(e).replace(/[!'()*]/g,function(e){return"%"+e.charCodeAt(0).toString(16)})}var a={},s=0;return{add_blob:function(t,n,r,s,o){a[s]||(a[s]={files:[],size:0});var i=a[s],l=t.byteLength||t.size;i.files[i.files.length]=e(t,n,r),i.size+=1,i.files[i.files.length]=t,l%512!=0&&(i.files[i.files.length]=new Uint8Array(512-l%512)),i.size+=Math.floor((l+511)/512),!o&&(i.size>2*pref.archive.tarsize*1024||pref.test_mode[71])&&this.flush(s)},flush:function(e,t){if(e)a[e]&&(a[e].files[a[e].files.length]=new Uint8Array(1024),n(new Blob(a[e].files,{type:"application/x-tar"}),t||"CatChan_archive_updates_"+site.nickname+"_"+e+"_"+s+++".tar"),delete a[e]);else for(var r in a)this.flush(r)}}}(),g={initiator:"archive",get responseType(){return pref.test_mode[85]?"blob":"arraybuffer"},archive:!0,callback_1:httpd.onload_archive,callback_1_fail:httpd.onload_archive_fail,get max(){return this.tgts.length},get tgt(){return this.key+this.url.substr(this.url.lastIndexOf("/"))}},b=null,v={Jan:"01",Feb:"02",Mar:"03",Apr:"04",May:"05",Jun:"06",Jul:"07",Aug:"08",Sep:"09",Oct:"10",Nov:"11",Dec:"12"},y=DelayBuffer.prototype.delayed_do.bind(new DelayBuffer(function(){httpd.check_timestamp_and_flush(b)},5e3)),w=(new Map,!1),k=0,x={pn:null,time_bumped:null,time_created:null,time_posted:null,flag:null,footer:null,time_tu:null,pn_menu:null,nof_posts:null,nof_files:null,tags:null,page:null,parse_funcs:null,quotes:null,backlinks:null,reply_to_me:null,reply_of_mine:null,op_img_url:null},T=function(){var e={html:function(){var e=document.createElement("div"),t={A:null,SPAN:null,DIV:null,BLOCKQUOTE:null,BR:null,WBR:null,U:null,S:null,STRIKE:null,B:null,I:null,BIG:null,SMALL:null,TT:null,SUB:null,SUP:null,EM:null,STRONG:null};return function(n,r,a){e.innerHTML=r;for(var s=e.getElementsByTagName("*"),o=0;o<s.length;o++)if(null!==t[s[o].tagName])return void(a[n]="")}}(),string:function(e,t,n){t.search(/[<>"'&]/)!=-1&&(n[e]="")}};return function(t){if(t)for(var n=0;n<t.length;n++){var r=t[n];for(var a in r)"string"==typeof r[a]&&("com"===a?e.html(a,r[a],r):e.string(a,r[a],r))}return t}}(),C=pref.script_prefix+".archived",N={};localStorage&&f(),pref.debug_mode[28]&&console.log("list_all_obj: ",N);var I={};return window.addEventListener("storage",f,!1),window.addEventListener("beforeunload",h,!1),{clean_list:function(e,t,n){N[e]&&N[e][t]&&delete N[e][t][n]},check_op:function(e,t){var n=pref.archive.kwd;(pref.archive.store_auto&&n.str&&(n.sub||n.name||n.com)&&cataLog.threads&&cataLog.catalog_filter_query_keyword.kwd(pref.archive.kwd,e.posts,e.domain,e)||this.check_archived_time(e,e.parse_funcs.time_unit,!0)!==!1)&&p("ARC",t,!1,!0)},check_archived_time:function(e,t,n){var r=n&&pref.archive.list&&pref_func.merge_obj5(e.key,pref3.archive.list_obj2,null);return r&&r.time?r.time/t||0:(pref.archive.list_inherit||!n||r)&&N[e.domain]&&N[e.domain][e.board]&&N[e.domain][e.board][e.no]||!1},update_archived_time:function(e){if(pref3.archive.working=!0,pref3.archive.list_obj2[e]&&pref3.archive.list_obj2[e].time){var t=new RegExp("(^|,)"+e.replace(/\+/,"\\+")+"([\\^@!][^,\n]*)*(,|\n|$)","mg");pref.archive.list_str=pref.archive.list_str.value.replace(t,",")+","+e+"\n",pref.archive.list_str=str.replace(/,,+/g,",").replace(/^,/g,"").replace(/\n,/g,"\n").replace(/\n\n+/g,"\n").replace(/^\n/,""),pref3.archive.list_obj2[e].time=null}},store_entry:function(e,t){if(cataLog.threads)for(var n in cataLog.threads){var r=liveTag.mems.getFromName(n);("stored"===pref.archive.src||"watched"===pref.archive.src&&r.watched||"shown"===pref.archive.src&&pClg.filter_test(n,pClg.threads[n]))&&p(e,r,!0)}},start_1:p,restore_posts_from_IDB:function(t,n,r,a,s,o){var i=this.event_funcs.consolidate_IDB_result(o);if(i.posts.length>1){var l=n.lth;i.time_loaded=i.posts[i.posts.length-1].time;var c=this.check_deleted_posts(t,n,l,i,!0);if(l.archived&&c&&2&l.archived&&pref.archive.live.post){var p=n.key.replace(/\//g,"-");e(JSON.stringify(site2[n.domain].parse_funcs.thread_json.prep_to_archive(c)),"text/plain",l,p+"_deleted.json")}}},store_th_to_mem:function(e,t,n,r,a){if("no"!==r){if(a&&n.ta.posts)for(var s=n.ta.posts,o=s.length-1,i=a.length-1;i>=0;i--){for(;o>=0&&s[o].no!=a[i].no;)o--;o>=0?s[o]=a[i]:o=s.length-1}var l=pref[cataLog.embed_mode].deleted_posts.detect,c=t.posts&&t.posts.length>1&&t.nof_posts>t.posts.length&&n.ta&&"passive"!==l?site2[t.domain].update_posts_replace_prep(t.posts,n.ta.posts,"number"==typeof r?r:-1):t.parse_funcs.has_posts?t.posts:n.ta&&n.ta.posts||t.posts;if(!pref.test_mode[65]&&(n.archived&&pref.archive.live.post_idb||"full_IDB"===l)){n.ta||"full_IDB"!==l||IDB.req(t.domain,t.board,t.no,"posts",this.restore_posts_from_IDB.bind(this,e,{posts:t.posts,__proto__:t}),"get_all");var p;n.ta?p=n.ta.posts[n.ta.posts.length-1].time:(p=N[t.domain]&&N[t.domain][t.board]&&N[t.domain][t.board][t.no])<0&&(p=-p);var _;if(p&&(!n.ta||n.ta.posts.length===n.ta.nof_posts||t.posts.length<t.nof_posts)){for(var i=t.posts.length;i>0&&t.posts[i-1].time>p;)i--;_=t.posts.slice(i)}else _=t.posts;a&&(_=a.concat(_)),_.length>0&&("html"===t.type_data&&cataLog.format_html.prepare_html_extract_params({posts:_,__proto__:t}),IDB.req(t.domain,t.board,t.no,"posts",_,"put"),n.posts_saved=1),pref.debug_mode[28]&&_.length>0&&console.log("posts_saved: "+t.key+", "+p+", "+_[_.length-1].time+" "+new Date(_[_.length-1].time*t.parse_funcs.time_unit).toLocaleString()+", LS:"+(N[t.domain]&&N[t.domain][t.board]&&N[t.domain][t.board][t.no]))}n.ta={posts:c,nof_posts:t.nof_posts,time_loaded:t.time_loaded}}else n.ta&&delete n.ta},check_deleted_posts:function(e,t,n,r,a){if("no"!==pref[cataLog.embed_mode].deleted_posts.detect&&r&&r.posts.length>1){var s=t.posts,o=r.posts,i=t.nof_posts===t.posts.length||"thread"===t.type_source,l=1,c=1;i?n.rescan_dp=0:(l=r.nof_posts-o.length+1-(t.nof_posts-s.length),c=1,l<1&&(c+=1-l,l=1));for(var p,d=0,u=0,f=n.pd||[],h=a?[]:null;c<o.length;){if(l<s.length){for(;d<f.length&&s[l].no>f[d].no;)d++;if(d<f.length&&s[l].no==f[d].no){t.native_prep?d++:p=f.splice(d,1);continue}if(s[l].no===o[c].no){l++,c++,i=!0;continue}if(s[l].no<o[c].no){i&&a&&(h[h.length]=s[l]),l++;continue}}for(;u<f.length&&o[c].no>f[u].no;)u++;if(u<f.length&&o[c].no===f[u].no)c++;else if(i){if(p=o[c++],!p.deleted_after){!pref.debug_mode[33]||void 0!==p.no&&null!==p.no||alert("Stopped by illegal deleted posts,(BUG)"),p.deleted_after=r.time_loaded,p.deleted_before=e&&e.date||null;var m={posts:[r.posts[0]].concat(p),__proto__:t};site2[t.domain].wrap_to_parse.posts(m)}f.splice(u++,0,p)}else 0===pref[cataLog.embed_mode].deleted_posts.detect.indexOf("full")&&(n.rescan_dp=1,scan.list_nup.add_scan(n)),c++}if(n.pd=f.length>0?f:null,p){if("no"!==pref[cataLog.embed_mode].deleted_posts.store&&t.domain===site.nickname){var g="LS"===pref[cataLog.embed_mode].deleted_posts.store?localStorage:sessionStorage;if(g){var b=site2[t.domain].ls_key_deletedPosts+t.board+t.no;f.length>0?g[b]=JSON.stringify(f,_):delete g[b]}}pref.test_mode[65]||"full_IDB"!==pref[cataLog.embed_mode].deleted_posts.detect||this.store_deleted_posts_to_IDB(t,f)}if(h&&h.length>0&&(t.domain!==site.nickname&&(h=JSON.parse(JSON.stringify(h,_))),IDB.req(t.domain,t.board,t.no,"posts",h,"put")),pref.debug_mode[19]&&p&&n.pd)for(var l=0;l<n.pd.length-1;l++)n.pd[l].no>=n.pd[l+1].no&&console.log("BUG: inorder of posts_deleted: "+t.key+", "+l+", "+n.pd[l].no+", "+n.pd[l+1].no)}return p?f:null},store_deleted_posts_to_IDB:function(e,t){IDB.req(e.domain,e.board,e.no,"posts_deleted",JSON.stringify(t,_),t.length>0?"put":"delete")},store_json_func:_,store:function(t,n,r,a,i,l,c,p){var d=this.check_deleted_posts(t,n,r,r.ta);if(this.store_th_to_mem(t,n,r,l,c),r.archived&&!p){var u=n.parse_funcs.time_unit,f=this.check_archived_time(n,u,4&r.archived)||0;if(i/=u,
f<i&&(f=i),!(1&r.archived)&&4&r.archived&&(n.posts[n.posts.length-1].time<=f||n.time_posted<=f*u)&&!c)return void(r.archived&=2);n.parse_funcs.posts_full&&n.parse_funcs.posts_full(n);var h=2&r.archived,m=1&r.archived,g=h&&pref.archive.live.post||m&&pref.archive.oneshot.post,b=h&&pref.archive.live.post_idb||m&&pref.archive.oneshot.post_idb,v=n.key.replace(/\//g,"-");d&&(g&&e(JSON.stringify(site2[n.domain].parse_funcs.thread_json.prep_to_archive(d)),"text/plain",r,v+"_deleted.json"),b&&"full_IDB"!==pref[cataLog.embed_mode].deleted_posts.detect&&this.store_deleted_posts_to_IDB(n,d));var w="html"===n.type_data?"text/html":"text/plain",k="thread"===n.type_source||n.posts.length===n.nof_posts?n.posts:r.ta&&r.ta.posts.length===n.nof_posts?r.ta.posts:null;if(g){var x=(n.posts[0].sub||"").replace(/\..*/,""),T=v+(pref.archive.sub_in_filename&&x?"_"+x:"")+("html"===n.type_data?".html":".json");if(!k)return void this.store_rescan(r);e("thread"===n.type_source?t.responseText:JSON.stringify(site2[n.domain].parse_funcs.thread_json.prep_to_archive(k),_),w,r,T)}if(a||5&r.archived||c){var C=h&&pref.archive.live.tn||m&&pref.archive.oneshot.tn,N=h&&pref.archive.live.tn_idb||m&&pref.archive.oneshot.tn_idb,A=h&&pref.archive.live.img||m&&pref.archive.oneshot.img,B=h&&pref.archive.live.img_idb||m&&pref.archive.oneshot.img_idb,E=h&&pref.archive.live.webm||m&&pref.archive.oneshot.webm,j=h&&pref.archive.live.webm_idb||m&&pref.archive.oneshot.webm_idb;if(C||N||A||B||E||j||b){if(5&r.archived){if(!k&&(m||(!n.posts[1]||n.posts[1].time>f)&&(!r.ta.posts[1]||r.ta.posts[1].time>f)))return void this.store_rescan(r);if(m)a=k;else{for(var S=n.posts[1]&&n.posts[1].time<=f?n.posts:r.ta.posts,L=S.length;L>0&&S[L-1].time>f;)L--;a=S.slice(L)}}if(c&&(a=c.concat(a||[])),0!=a.length){pref.debug_mode[28]&&console.log("archive: "+n.key+", "+a.length+"/"+n.nof_posts);var O=[];(C||N)&&o("tn",n,r,a,C,N,E,j,O),(A||B||E||j)&&o("img",n,r,a,A,B,E,j,O),0!=O.length&&(O[O.length-1].from=n.key,I[n.key]=f,s(O)),!pref.test_mode[65]&&b&&5&r.archived&&IDB.req(n.domain,n.board,n.no,"posts",a,"put")}}}!g||!d&&!k||O&&0!==O.length&&n.domain===site.nickname||!pref.archive.tar||y(),r.archived&=2,this.update_archived_time(n.key)}},store_rescan:function(e){scan.list_nup.add_scan(e),e.archived|=4},restore_entry:function(e,t,n,r){for(var a={},s=0;s<t.length;s++)void 0===a[t[s].name]?a[t[s].name]={file:t[s]}:Array.isArray(a[t[s].name])?a[t[s].name].push({file:t[s]}):a[t[s].name]=[a[t[s].name],{file:t[s]}];var o={};if(!pref.test_mode[64]&&pref[cataLog.embed_mode].deleted_posts.merge)for(var s=0;s<r.length;s++)o[r[s].name]=r[s];var i=0;pref.archive.clear_threads&&cataLog.threads&&cataLog.catalog_clear_threads(0);var l,p=new FileReader;p.onerror=function(e){console.log("ERROR at loading json file, "+e)},p.onload=function(t){if(l){var r=l.slice(0,-13).replace(/\-/g,"/");pref.test_mode[80]&&(r=r.replace(/\/\d+$/,"_File$&"));var s=liveTag.mems.getFromName(r);archiver.prep_deleted_posts(s.th,s,p.result)}else if(c(e[i-1],p.result,a),!pref.test_mode[64]&&pref[cataLog.embed_mode].deleted_posts.merge&&(l=e[i-1].name.replace(/(_|\.).*/,"")+"_deleted.json",o[l]))return void p.readAsText(o[l]);l=null,e.length>i?p.readAsText(e[i++]):pref.archive.clear_files&&n()},p.readAsText(e[i++])},url2file:function(e,t){var n=e[t.replace(/[^\/]*\//g,"")];return n?(Array.isArray(n)&&(n=t.search(/thumb/)!=-1?n[0]:n[n.length-1]),n.url||(n.url=window.URL.createObjectURL(n.file)),n.url+("video/webm"===n.file.type?'" data-ext=".webm':"")):t},prep_deleted_posts:function(e,t,n,r,a){var s=n?r||JSON.parse(n):"LS"===pref[cataLog.embed_mode].deleted_posts.store&&localStorage?T(JSON.parse(localStorage[site2[e.domain].ls_key_deletedPosts+e.board+e.no]||null)):"SS"===pref[cataLog.embed_mode].deleted_posts.store&&sessionStorage?JSON.parse(sessionStorage[site2[e.domain].ls_key_deletedPosts+e.board+e.no]||null):null;if(!pref.test_mode[123]&&s){for(var o={},i=0;i<e.posts.length;i++)o[e.posts[i].no]=null;for(var i=s.length-1;i>=0;i--)s[i].no&&null!==o[s[i].no]||s.splice(i,1);0===s.length&&(s=null)}if(s){s=site2[e.domain].parse_funcs.thread_json.rip_from_archive(s);var l={posts:[e.posts[0]].concat(s),parse_funcs:site2[e.domain].parse_funcs.thread_json,type_parse:"thread_json",type_source:"thread",type_data:"json",__proto__:e};if(site2[e.domain].wrap_to_parse.posts(l,1),n&&t.th){t.pd=t.pd?site2[e.domain].update_posts_merge_prep(l.posts,t.pd,-1,!0).slice(1):s;var c=a||cataLog;"page"!==cataLog.embed_mode&&"thread"!==cataLog.embed_mode||pref.test_mode[64]||!pref[cataLog.embed_mode].deleted_posts.merge||(e.posts=site2[e.domain].update_posts_merge_prep(e.posts,t.pd,-1,!0),c.threads[e.key][16].th=e),c.footer.update_force(e.key)}else t.pd=s}},refresh_start:function(){h(),b=null},list_all_obj_downloading:I,download_url3:t,download_url4:n,tar:m,sub_funcs:function(e,t){if("SUB_INIT"===e[0])if(cataLog.catalog_clear_threads(0),cataLog.auto_update.stop_if_running(),pref.stats.auto_acquisition=!1,pref[cataLog.embed_mode].t2h_sel="All",pref.common.blur_404=!1,e[1].IDB)IDB.req(e[1].domain,e[1].board,e[1].no,null,t?function(e,n,r,a){archiver.event_funcs.restore3(e,n,r,a),t()}:archiver.event_funcs.restore3.bind(archiver.event_funcs),"get_all");else for(var r=e[1],a=parseInt(r.files_sel,10),s=window.opener.document.getElementsByClassName(pref.script_prefix)[0].querySelectorAll('span[name="FILES_ARCHIVE'+a+'"]')[0].querySelectorAll('input[type="file"]'),o=0;o<s.length;o++)for(var i=0;i<s[o].files.length;i++){var l=s[o].files[i];if(l.name===r.name&&l.size===r.size&&l.lastModified===r.lastModified)return void archiver.event_funcs.restore2(null,Array.prototype.slice.call(s[o+a].files),[l])}else"DOWNLOAD"===e[0]&&n(e[1][0],e[1][1])},restore:c,event_funcs:pref_func.settings.onchange_funcs.archive}}(),recovery=pref.features.recovery&&localStorage?function(){function e(){o=site2[site.nickname].ls_key_comment+site.board+site.no;var e=pref.script_prefix+".comment."+site.nickname+site.board+site.no;if(pref.recovery.comment){var t=localStorage[o]||localStorage[e]||"";t&&(site.components.postform_comment&&(site.components.postform_comment.value=t),site.components.postform_comment2&&(site.components.postform_comment2.value=t))}}function t(){i=this,c()}function n(){var e=i.value;(!l||l.length<=e.length)&&(l=e),i=null,p()}function r(){l?localStorage[o]=l:delete localStorage[o],l=null}function a(){i&&(l=i.value),null!==l&&r()}function s(e,n,r){if(!e&&pref.recovery.comment&&n){var a=t.bind(n);n.addEventListener("change",a,!1),n.addEventListener("keyup",a,!1),r.addEventListener("click",a,!1),e=[n,r,a]}else!e||pref.recovery.comment&&n||(e[0].removeEventListener("change",e[2],!1),e[0].removeEventListener("keyup",e[2],!1),e[1].removeEventListener("click",e[2],!1),e=null);return e}var o;e();var i=null,l=null,c=new DelayBuffer(n,1e3).get_binded_delayed_do(),p=new DelayBuffer(r,1e3*pref.recovery.interval).get_binded_delayed_do(),_=s(null,site.components.postform_comment,site.components.postform_submit),d=null;return window.addEventListener("beforeunload",a,!1),{setup:function(){_=s(_,site.components.postform_comment,site.components.postform_submit),d=s(d,site.components.postform_comment2,site.components.postform_submit2)},setup2:function(){d=s(d,site.components.postform_comment2,site.components.postform_submit2)},reentry:function(){a(),e()}}}():null,scan=function(){function e(e,t,n){return("b"===e?"scan":"scan_threads")+"_"+t+":"+(n||0)}function t(t,n){for(var a=e(t,n,0).replace(/0$/,""),s=8;s>=0;s--){var o=r.prototype.scanners[a+s];if(o||o===!1)return s}return-1}var n={add:function(e,t,n){"string"==typeof e&&(e=this.get_th(e)),t=(t||0)<<4,0===e.u?e.u=t|(n?7:3):e.u>0&&e.u<t&&(e.u=t|15&e.u)},add_scan:function(e){this.add(e),scan.scan_threads_delayed_do()},issued:function(e){return"string"==typeof e&&(e=this.get_th(e)),e&&(e.u=(1==(3&e.u)?4294967040:0)|(0===e.u?2:e.u-1)),e&&e.no&&e.archived},got_200:function(e){var t=this.get_th(e.key);0===t.u||4&t.u&&"thread"!==e.type_source||(t.u=0)},got_404:function(e){"string"==typeof e&&(e=this.get_th(e)),e&&(e.u=-1)},get_th:function(e){var t=common_func.fullname2dbt(e);return t[2].search(/(p|q)[0-9]+$/)!=-1?null:("t"===t[2][0]?t[2]=t[2].substr(1):t[2].search(/^[0-9]/)==-1&&(t[2]=""),liveTag.mems.init({domain:t[0],board:t[1],no:t[2]}))},priority_th:[0,16,32,48,64,80,96,112,128,144,160,176,192,208,224,240,256],get_list_thread:function(e,t){var n=this.priority_th[t||0],r=0;for(var a in liveTag.mems[e])for(var s in liveTag.mems[e][a])liveTag.mems[e][a][s].u>n&&r++;return 0===r?null:[r,function*(t){for(var n in liveTag.mems[e])for(var r in liveTag.mems[e][n])liveTag.mems[e][n][r].u>t&&(yield liveTag.mems[e][n][r])}(n)]},get_list_thread2:function(e,t){var n=this.priority_th[t||0],r=[];for(var a in liveTag.mems[e])for(var s in liveTag.mems[e][a])liveTag.mems[e][a][s].u>n&&(r[r.length]=liveTag.mems[e][a][s]);return r},get_list_board:function(e,t){var n=this.priority_th[t||0],r=0;for(var a in liveTag.mems[e])liveTag.mems[e][a].u>n&&r++;return 0===r?null:[r,function*(t){for(var n in liveTag.mems[e])liveTag.mems[e][n].u>t&&(yield liveTag.mems[e][n])}(n)]},get_list_board2:function(e,t){var n=this.priority_th[t||0],r=[];for(var a in liveTag.mems[e])liveTag.mems[e][a].u>n&&(r[r.length]=liveTag.mems[e][a]);return r},add_domain:function(e,t,n){var r=pref4.scan.max;if(liveTag.active.pk){if(n)for(var a in liveTag.mems[e]){liveTag.tags[liveTag.mems[e][a].btag].pk&&this.add_board(e+a,null,t);var s=liveTag.mems[e][a].btag2;if(s)for(var o=0;o<s.length;o++)liveTag.tags[s[o]].pk&&this.add_board(e+a,null,t)}else for(var o=0;o<r;o++)if(liveTag.tags_array_old[o])for(var i of liveTag.tags[liveTag.tags_array_old[o].key].mems.keys())i.no?this.add(i,null,t):this.add_board(i,null,t)}else if(n)for(var o=0;o<n.length;o++)this.add_board(e+n[o],null,t);else for(var a in liveTag.mems[e])null!==liveTag.mems[e][a].o&&liveTag.mems[e][a].o<r&&this.add_board(e+a,null,t)},add_board:function(e,t,n,r,a){if("string"==typeof e&&(e=this.get_th(e)),2!==n){if(!r||e.read_max<e.max){var s=(t||0)<<4|(a?8:0)|(n?4:0);0===e.u?e.u=3|s:e.u>0&&e.u<t&&(e.u=s|15&e.u)}}else for(var o in e)e[o].ta&&e[o].nof_posts===e[o].ta.posts.length||this.add(e[o],t,!0)},got_200_board:function(e){if("string"==typeof e&&(e=this.get_th(e)),4&e.u)for(var t in e)this.add(e[t],240&e.u,!0);e.max&&(e.read_max=e.max),e.u=0},scan_boards_enumerate:function(e,t,n){var r="thread"===pref.virtualBoard.scan_domains[e]||n.has(liveTag.mems[e]),a=pref4.scan.max;for(var s in liveTag.mems[e])if((r||0!=Object.keys(liveTag.mems[e][s]).length)&&!n.has(liveTag.mems[e][s])&&null!==liveTag.mems[e][s].o&&liveTag.mems[e][s].o<a&&(!t||t(liveTag.mems[e][s])))return!0}},r=function(e,t,n,r){this.type=e,this.domain=t,this.key=r,this.priority=n||0,this.scanners[r]=this};r.prototype={scanners:Object.create(null),func_entry:function(){var e;pref.test_mode[51]?(e="b"===this.type?scan.list_nup.get_list_board(this.domain,this.priority):scan.list_nup.get_list_thread(this.domain,this.priority),e?this.func_scan(e,{tgts_iterator:e[1],max:e[0]}):this.exit()):(e="b"===this.type?scan.list_nup.get_list_board2(this.domain,this.priority):scan.list_nup.get_list_thread2(this.domain,this.priority),0!=e.length?this.func_scan(e,null):this.exit())},func_scan:function(e,t,n){this.wdg||(this.wdg=new Watchdog(this.abort.bind(this),3e4)),cataLog.scan_init(this.key,e,{callback:this.func_cont.bind(this),watchdog:this.wdg.restart.bind(this.wdg),priority:this.priority,__proto__:t},n)},func_cont:function(){this.req?(this.req=!1,this.func_entry()):this.exit()},exit:function(){this.wdg&&this.wdg.stop(),this.scanners[this.key]=null,"b"===this.type?this.aborted||scan.scan("t",this.domain,this.priority):"t"===this.type&&cataLog.catalog_refresh_end&&cataLog.catalog_refresh_end(),this.callback&&this.callback();var n=t(this.type,this.domain),a=e(this.type,this.domain,n);this.scanners[a]===!1&&new r(this.type,this.domain,n,a).func_entry()},abort:function(){pref.debug_mode[7]&&console.log("Scanner_abort: "+this.key),cataLog.scan_boards.scan_abort(this.key),void 0===this.aborted?(this.aborted=!0,this.wdg.restart()):this.exit()}};var a=function(e,t){this.key=e,this.arg=t,this.scanners[e]=this,this.callback=this.arg.options&&this.arg.options.callback};a.prototype={scanners:Object.create(null),priority:8,func_entry:function(){this.func_scan(this.arg.tgts,this.arg.options,!0)},func_cont:function(){this.queue&&this.queue.length>0?(this.arg=this.queue.shift(),this.func_entry()):this.exit()},__proto__:r.prototype};var s=new Set;return{scan_refresh:function(e,t,r,a){s.clear();for(var o=0;o<t.length;o++){var i=common_func.name2domainboardthread(t[o],!0);0===i[2].search(/^[cj]/)||""===i[2]?s.add(liveTag.mems[i[0]][i[1]]):0===i[2].search(/^t*[0-9]+/)&&s.add(liveTag.mems[i[0]][i[1]]["t"===i[2][0]?i[2].substr(1):i[2]])}for(var o in a)s.add(liveTag.mems[o]);if(scan.scan("t",null,r),!pref.liveTag.use)for(var l in liveTag.tags)if(liveTag.tags[l].pk)for(var c of liveTag.tags[l].mems.keys())s.has(c)||(c.no?scan.list_nup.add(c,2):scan.list_nup.add_board(c,2));for(var p in liveTag.mems)pref.liveTag.use?site2[p].utilize_boards_json&&pref.pref2[p].utilize_boards_json?n.scan_boards_enumerate(p,null,s)?site2[p].get_boards_json("boards_"+p,function(e){return function(){scan.scan_refresh_1(e,!0)}}(p),!0,e):scan.scan("t",p):scan.scan_refresh_1(p,!1):scan.scan("b",p)},scan_refresh_1:function(e,t){n.scan_boards_enumerate(e,function(e){scan.list_nup.add_board(e,null,null,t)},s),scan.scan("b",e)},scan:function(n,a,s){if(a){var o=e(n,a,s),i=r.prototype.scanners[o];i?i.req=!0:t(n,a)>=s?r.prototype.scanners[o]=!1:"b"===n&&(i=r.prototype.scanners[e("t",a,s)])?i.callback=function(){scan.scan(n,a,s)}:new r(n,a,s,o).func_entry()}else for(var l in liveTag.mems)this.scan(n,l,s)},abort:function(){for(var e in r.prototype.scanners){var t=r.prototype.scanners[e];t&&(t.wdg&&t.wdg.stop(),t.abort())}},scan_ui:function(e,t){new a(e,t).func_entry()},scan_threads_delayed_do:DelayBuffer.prototype.delayed_do.bind(new DelayBuffer(function(){scan.scan("t")},200)),keyword_load:function(e,t){var n=!0;for(var r in pref.virtualBoard.scan_domains)"none"!==pref.virtualBoard.scan_domains[r]&&(this.keyword_load_1(r,e,null,t),n=!1);n&&this.keyword_load_1(site.nickname,e,null,t)},keyword_load_1:function(e,t,n,r){if(!site3[e].boards&&(!t&&"none"!==pref.virtualBoard.scan_domains[e]||t&&liveTag.active.pk||!n))return void site2[e].get_boards_json("kwd_load",function(){scan.keyword_load_1(e,t,n,r)},!1,r);("thread"===pref.virtualBoard.scan_domains[e]||t)&&(scan.list_nup.add_domain(e,pref.catalog.filter.kwd.post&&t,n),scan.scan("b",e))},list_nup:n}}(),stats=pref3.stats.use?function(){function e(e){var t=liveTag.mems[e[0]][e[1]][e[2]];if(t.ss)if(Array.isArray(t.ss))for(var r=0;r<t.ss.length;r++)t.ss[r].rm&&t.ss[r].rm.update_thread(t.s,0,!0);else t.ss.rm&&t.ss.rm.update_thread(t.s,0,!0);pref.stats.retain_404&&t.s&&(u[e[0]]||(u[e[0]]={}),u[e[0]][e[1]]||(u[e[0]][e[1]]={}),u[e[0]][e[1]][e[2]]=liveTag.mems[e[0]][e[1]][e[2]],(pref.test_mode[44]||u[e[0]][e[1]].sr||Object.keys(u[e[0]][e[1]]).length>64)&&n(u[e[0]][e[1]]))}function t(e){for(var t=0;t<g.length;t++){pref_func.merge_obj5(e.key,g[t].tgts_obj2,null)&&g[t].check_and_add_thread(e)}}function n(e){e.sr||(r(e,"sr"),r(e,"srt"));for(var t in e){if(e[t].s)for(var n=0;n<h.length;n++)c(e.sr[n],null,0,e[t].s.length,e[t].s,h[n],s,0),c(e.srt[n],null,0,1,e[t].s,h[n],s,0);delete e[t]}}function r(e,t){Object.defineProperty(e,t,{value:[],configurable:!0,writable:!1});for(var n=0;n<h.length;n++)e[t][n]=[null,n<3?[]:{length:pref.stats.len_capture+2,__proto__:Array.prototype},[],0],a(e[t][n],h[n]);"s"===t&&(e[t][h.length]=-Object.keys(e).length)}function a(e,t,n){var r=Math.floor((Date.now()/6e4+e[3])/t)*t,a=r-t*pref.stats.len_capture;if(!e[0])return void(e[0]=a);if(a!==e[0]||n){var s=(a-e[0])/t,o=0;return n>s&&pref.stats.tolerant&&(e[3]+(n-s)*t<pref.stats.tolerance?(e[3]=n*t,o=n-s):(e[3]=pref.stats.tolerance,o=Math.floor((pref.stats.tolerance-e[3])/t))),e[1].splice(0,s+o),Array.isArray(e[1])||(e[1].length=pref.stats.len_capture+2),e[0]=a+o*t,s+o}}function s(e,t){e[t]=(e[t]||0)+1}function o(e,t,n,r){var a=n.posts[r].no||n.no;(void 0===e[t]||e[t]<a)&&(e[t]=a)}function i(e,t,n,r){var a=n.posts[r].no||n.no;(void 0===e[t]||e[t]>a)&&(e[t]=a)}function l(e,t,n,a){e.s||r(e,"s");for(var s=0;s<h.length;s++)c(e.s[s],t,n,a.length,a,h[s],pref.stats.patch_tm?i:o,t.posts.length);e.s[h.length]++}function c(e,t,n,r,s,o,i,l){for(var c,p=e[0],_=e[1],d=r-1;d>=n;d--){var u=Math.floor((s[d]-p)/o);if(!(--l>=0&&u===c)||pref.stats.patch_tm){var f=u-pref.stats.len_capture-1;if(f>0?(u-=a(e,o,f),u>pref.stats.len_capture+1&&(u=pref.stats.len_capture+1),p=e[0]):u<0&&(u=0),i(_,u,t,l),0===u&&!pref.stats.patch_tm)break;c=u}}for(var h=0;h<e[2].length;h++)e[2][h].update_posts_no(p,u)}function p(e){return pref.catalog_board_list_obj[e][0].key}function _(){if(pref.stats.auto_acquisition&&"thread"!==cataLog.embed_mode)for(var e=pref.catalog_board_list_obj.length-1;e>=0;e--)if(void 0!==x["@"+p(e)]){var t=pClg.refresh_1("chart",!1,!1,!1,!1,e,!1,!0);"function"!=typeof t&&new b(null,t,p(e),!1).destroy()}}function d(e){if(pref.stats.auto_acquisition&&pClg&&pClg.refresh_1&&"thread"!==cataLog.embed_mode){for(void 0===e&&(e=pref.catalog_board_list_obj.length-1);e>=0&&(!pref.catalog_board_list_obj[e][0].cmds||pref.catalog_board_list_obj[e][0].cmds.indexOf("stats")===-1);)e--;if(e>=0){pref.stats.auto_acquisition&&stats.register_auto_acquisition(e);var t=pClg.refresh_1("chart",!1,!1,!1,"stats_ac",e,!1,!0,function(){d(e-1)});"function"==typeof t&&t(function(){d(e)})}}}var u={},f={hour:function(e){return new Date(6e4*e).toString().split(" ")[4].replace(/:\d*$/,"")},day:function(e){return new Date(6e4*e).toString().replace(/\s\d{4}.*/,"")},sunday:function(e){var t=new Date(6e4*e).toString();return"Sun"==t.split(" ")[0]?t.replace(/\s\d{4}.*/,""):""},month:function(e){var t=new Date(6e4*e).toString();return"01"==t.split(" ")[2]?t.replace(/\s\d{4}.*/,""):""},quarter_year:function(e){var t=new Date(6e4*e).toString().split(" ");return t[2]<=7&&["Jan","Apr","Jul","Oct"].indexOf(t[1])!=-1?t.slice(1,4).join(" "):""}};f[1]=[60,f.hour,1],f[10]=[60,f.hour,1],f[60]=[1440,f.day,1],f[1440]=[1440,f.sunday,0],f[10080]=[1440,f.quarter_year,0];var h=[1,10,60,1440,10080],m=Math.floor(Date.now()/6e4),g=[],b=function(e,t,n){g.push(this),this.chart=e,this.tolerance=0,this.draw=DelayBuffer.prototype.delayed_do.bind(new DelayBuffer(this.refresh.bind(this),1e3*pref.stats.draw_delay)),this.wdg_tick=new Watchdog(this.prep_time.bind(this),6e4),this.fromNo=pref3.stats.estimate_posts?new w(this):null,this.tgts_changed(t,n,!0),this.time_unit_changed(pref.chart.inst.time_sel,!0),this.len_changed(this.chart&&this.chart.len>pref.stats.len_capture?this.chart.len:pref.stats.len_capture)};b.prototype={destroy:function(){this.chart=null,this.save_all_unsubscribe(!0),this.wdg_tick.stop(),g.splice(g.indexOf(this),1)},merge_1:function(e,t){if(t)for(var n=0;n<t.length;n++)e[n]<t[n]&&(e[n]=t[n]);return e},merge_1_hier:function(e,t,n){for(var r=this.time_unit/n.time_unit,a=Math.ceil((n.time_base-this.time_base)/this.time_unit),s=(r-n.time_base%this.time_unit/n.time_unit)%r;s<t.length;)this.merge_1_hier_1(e,t,a,s,r,n),s+=r,a++},merge_1_hier_1:function(e,t,n,r,a,s){for(var o=0,i=t.length>=r+a?a:t.length-r,l=0;l<i;l++)o+=t[r+l];pref.debug_mode[15]&&o>e[n]&&console.log("merge_1_hier_1: "+this.time_unit+": "+n+", "+e[n]+"->"+o+", "+new Date(6e4*(this.time_base+n*this.time_unit)).toLocaleString()+", "+new Date(6e4*(s.time_base+r*s.time_unit)).toLocaleString()+", "+a),o>e[n]&&(e[n]=o)},save_all_unsubscribe:function(e){if(this.tgts&&pref.stats.save&&void 0!==x["@"+this.key]){var t=Math.floor(Date.now()/6e4);if(x["@"+this.key]!==t){var n=this.chart;this.chart=null;for(var r=h.indexOf(this.time_unit),a=null,s=0;s<h.length;s++)this.time_unit_changed(s),this.save(a),a={data_p:this.data_p,data_t:this.data_t,time_unit:this.time_unit,time_base:this.time_base};e||this.time_unit_changed(r),this.chart=n,x["@"+this.key]=t}}this.tgts&&(this.prep("both",this.prep_thread_unsubscribe),this.fromNo&&this.fromNo.prep("live",this.fromNo.prep_board_unsubscribe))},Zcompress:function(e){return e.replace(/0,(0,)+/g,function(e){return"z"+e.length/2+","})},Zdecompress:function(e){return e.replace(/z(\d+),/g,function(e,t){for(var n="",r=parseInt(t,10),a=0;a<r;a++)n+="0,";return n})},get_ls_key:function(){return pref.test_mode[38]?pref.script_prefix+".graph."+this.time_unit+"."+this.key+"_test38":pref.script_prefix+".graph."+this.time_unit+"."+this.key},save:function(e){if(this.data_p&&pref.stats.load&&pref.stats.save&&localStorage){this.merge_1(this.data_p,this.data_p_old),this.merge_1(this.data_t,this.data_t_old),e&&(this.merge_1_hier(this.data_p,e.data_p,e),this.merge_1_hier(this.data_t,e.data_t,e));for(var t=0;t<this.data_p.length&&0===this.data_p[t]&&0===this.data_t[t];)t++;var n=[this.time_base+t*this.time_unit,this.data_p.slice(0,this.len+1).slice(t),this.data_t.slice(0,this.len+1).slice(t)];if(!pref.test_mode[42]&&this.fromNo){var r=this.fromNo;if(r.valid=!0,r.prep("live",r.prep_board_check_valid),r.valid){if(r.data_p_old){var a=r.data_p_old.length-1;r.data_p[a]>r.data_p_old[a]&&(r.data_p_old[a]=r.data_p[a])}}else for(var s=0;s<r.data_p.length;s++)r.data_p[s]=0;r.data_p_old&&(r.data_p=r.data_p_old.concat(r.data_p.slice(r.data_p_old.length)));for(var s=r.data_p.length-2-this.tolerance;s<r.data_p.length;s++)r.data_p[s]=0;n[3]=r.data_p.slice(0,this.len+1).slice(t)}localStorage[this.get_ls_key()]=this.Zcompress(JSON.stringify(n)),pref.debug_mode[15]&&console.log("saved: "+this.get_ls_key())}},load:function(){if(pref.stats.load&&localStorage){var e=localStorage[this.get_ls_key()];if(e){e=JSON.parse(this.Zdecompress(e));var t=(this.time_base-e[0])/this.time_unit,n=Math.floor((m-this.time_last)/this.time_unit);if(0===n&&(n=void 0),t>=0?(this.data_p_old=e[1].slice(t,n),this.data_t_old=e[2].slice(t,n),this.fromNo&&e[3]&&(this.fromNo.data_p_old=e[3].slice(t,n))):(this.data_p_old=this.array_init([],0,0).slice(0,-t).concat(e[1].slice(0,n)),this.data_t_old=this.array_init([],0,0).slice(0,-t).concat(e[2].slice(0,n)),this.fromNo&&e[3]&&(this.fromNo.data_p_old=this.array_init([],0,0).slice(0,-t).concat(e[3].slice(0,n)))),this.fromNo&&this.fromNo.data_p_old)for(;0===this.fromNo.data_p_old[this.fromNo.data_p_old.length-1];)this.fromNo.data_p_old.pop()}else this.data_p_old=null,this.data_t_old=null}},tgts_changed:function(e,t,n){this.save_all_unsubscribe(),this.tgts=e,this.key=t,pref_func.str2obj2(this,"tgts_obj2",e.join(","),null,!0),this.prep("both",this.prep_thread_subscribe),n||this.init()},time_unit_changed:function(e,t){this.fromNo&&this.fromNo.prep("live",this.fromNo.prep_board_unsubscribe),this.time_sel=e,this.time_unit=h[e],t||this.init()},len_changed:function(e){this.len=e,this.init()},init:function(){this.time_last=null,this.data_p=[],this.data_t=[],this.data_l=[],this.rm=this.chart&&(this.chart.show.ep||this.chart.show.et)?new v(this):null,this.fromNo&&(this.fromNo.data_p=[],this.fromNo.data_p_old=[],this.fromNo.min_idx=0),this.refresh(!0)},array_init:function(e,t,n){for(var r=t;r<this.len+2;r++)void 0===e[r]&&(e[r]=n);return e},tz_offset:(new Date).getTimezoneOffset(),label_init:function(e){for(var t=f[this.time_unit],n=t[2]?Math.floor((Math.floor((this.time_base-this.tz_offset+(this.len+2)*this.time_unit)/t[0])*t[0]-(this.time_base-this.tz_offset))/this.time_unit):this.len+2;n>=e;)this.data_l[n]=t[1](this.time_base+n*this.time_unit),n-=t[2]?t[0]/this.time_unit:1},prep_time:function(e){var t=Math.floor((Date.now()/6e4+this.tolerance)/this.time_unit)*this.time_unit;if(this.time_last!==t){var n=(t-this.time_last)/this.time_unit;this.time_last=t,this.time_base=t-this.time_unit*this.len;var r=0;e||0===n||(n>this.len&&(n=this.len),this.data_p.splice(0,n),this.data_t.splice(0,n),this.data_l.splice(0,n),this.rm&&(this.rm.data_p.splice(0,n),this.rm.data_t.splice(0,n)),this.fromNo&&(this.fromNo.data_p.splice(0,n),this.fromNo.data_p_old&&(this.fromNo.data_p_old.splice(0,n),0===this.fromNo.data_p_old.length&&(this.fromNo.data_p_old=null)),this.fromNo.min_idx-=n),this.data_p_old&&(this.data_p_old.splice(0,n),0===this.data_p_old.length&&(this.data_p_old=null)),this.data_t_old&&(this.data_t_old.splice(0,n),0===this.data_t_old.length&&(this.data_t_old=null)),r=this.len-n,this.min_idx-=n,this.min_idx<0&&(this.min_idx=0)),this.array_init(this.data_p,r,0),this.array_init(this.data_t,r,0),this.array_init(this.data_l,r,""),this.rm&&(this.array_init(this.rm.data_p,r,0),this.array_init(this.rm.data_t,r,0)),this.fromNo&&this.array_init(this.fromNo.data_p,r,0),this.label_init(r),this.shift=e?0:this.shift+n}this.wdg_tick.restart(6e4*this.time_unit)},prep:function(e,t,n){for(var r=0;r<this.tgts.length;r++){var a=common_func.name2domainboardthread(this.tgts[r],!0);"live"!==e&&"both"!==e||this.prep_1(liveTag.mems,a,t,n),"dead"!==e&&"both"!==e||this.prep_1(u,a,t,n)}},prep_1:function(e,t,n,r){t[2]?e[t[0]]&&e[t[0]][t[1]]&&e[t[0]][t[1]][t[2]]&&null!==r&&(r?r:n).call(this,e[t[0]][t[1]][t[2]]):t[1]?e[t[0]]&&e[t[0]][t[1]]&&this.prep_board(e[t[0]][t[1]],n,r):e[t[0]]&&this.prep_domain(e[t[0]],n,r)},prep_domain:function(e,t){for(var n in e)this.prep_board(e[n],t,func_t)},prep_board:function(e,t){for(var n in e)t.call(this,e[n])},prep_thread_init:function(e){e.s&&this.update_thread(e.s,0)},check_and_add_thread:function(e){e.s&&!this.prep_thread_unsubscribe(e,!0)&&(this.update_thread(e.s,0,!0),this.prep_thread_subscribe(e))},prep_thread_subscribe:function(e){Array.isArray(e.ss)?e.ss.push(this):e.ss?e.ss=[e.ss,this]:e.ss=this},prep_thread_unsubscribe:function(e,t){if(Array.isArray(e.ss)){var n=e.ss.indexOf(this);if(t)return n!==-1;n!=-1&&(e.ss.splice(n,1),1===e.ss.length&&(e.ss=e.ss[0]))}else{if(e.ss!==this)return!1;if(t)return!0;delete e.ss}},refresh:function(e){pref.debug_mode[15]&&console.log("updated: "+this.data_p.slice(this.len-10).toString()+", "+this.min_idx),this.prep_time(e),e?(this.prep("live",this.prep_thread_init),this.rm_tmp=new v(this,this.data_p,this.data_t),this.rm_tmp.prep("dead",this.rm_tmp.prep_board_init,this.prep_thread_init),this.rm&&this.rm.prep("dead",this.rm.prep_board_init,this.prep_thread_init),this.fromNo&&this.fromNo.prep("live",this.fromNo.prep_board_init,!0),this.load(),this.chart&&this.chart.replace_data(this)):0===this.shift&&this.min_idx===this.data_p.length||(this.fromNo&&this.fromNo.prep("live",this.fromNo.prep_board_init,!1,!0),this.chart&&this.chart.update_data2(this)),this.min_idx=this.data_p.length},update_thread:function(e,t,n){e&&(0===t&&this.update_thread_1(this.data_t,e,0,0),this.update_thread_1(this.data_p,e,t,e.length-1),n&&this.draw())},update_thread_1:function(e,t,n,r){for(var a=r;a>=n;a--){var s=Math.floor((t[a]-this.time_base)/this.time_unit),o=s-this.len-1;if(o>0&&(pref.stats.tolerant&&(this.tolerance=o*this.time_unit+this.tolerance,this.tolerance>pref.stats.tolerance&&(this.tolerance=pref.stats.tolerance),this.prep_time(!1)),s=this.len+1),!(s>=0))break;e[s]++,s<this.min_idx&&(this.min_idx=s)}}};var v=function(e,t,n){this.data_p=t||[],this.data_t=n||[],Object.defineProperty(this,"min_idx",{set:function(e){this.__proto__.min_idx=e},get:function(){return this.__proto__.min_idx},configurable:!0,enumerable:!0});for(var r in y)this[r]=y[r];this.__proto__=e},y={prep_board:function(e,t,n){if(e.sr)t.call(this,e);else for(var r in e)n.call(this,e[r])},prep_board_init:function(e){this.prep_board_init_1(e.sr,this.data_p),this.prep_board_init_1(e.srt,this.data_t)},prep_board_init_1:function(e,t){for(var n=e[this.time_sel][1],r=(this.time_base-e[this.time_sel][0])/this.time_unit,a=r;a<n.length;)n[a]&&(t[a-r]+=n[a]),a++}},w=function(e){this.data_p=[],this.min_idx=0;for(var t in k)this[t]=k[t];this.__proto__=e},k={prep_board_subscribe:function(e){e.s||r(e,"s"),e.s[this.time_sel][2].push(this)},prep_board_unsubscribe:function(e){if(e.s&&this.time_sel){var t=e.s[this.time_sel][2].indexOf(this);t!=-1&&e.s[this.time_sel][2].splice(t,1)}},prep:function(e,t,n,r){if(n&&this.__proto__.prep.call(this.fromNo,"live",this.fromNo.prep_board_subscribe,null),r)for(var a=this.min_idx;a<this.data_p.length;a++)this.data_p[a]=0;this.new_vals={},this.__proto__.prep.call(this,"live",t,null);for(var a in this.new_vals)this[a]=this.new_vals[a];delete this.new_vals},prep_board:function(e,t){t.call(this,e)},prep_board_init:function(e,t){var n=e.s[this.time_sel][1],r=(this.time_base-e.s[this.time_sel][0])/this.time_unit,a=this.min_idx+r;a<2&&(a=2);for(var s,o=a-1;o>0&&!n[o];)o--;if(o>0)s=n[o];else{for(;a<n.length&&!n[a];)a++;s=n[a++]}if(pref.stats.patch_tm){for(var i=(o>0?o:a-1)-r,l=i;a<n.length;)n[a]&&(this.data_p[i]+=n[a]-s,s=n[a],l=i,i=a-r),a++;(void 0===this.new_vals.min_idx||this.new_vals.min_idx>l)&&(this.new_vals.min_idx=l)}else{for(;a<n.length;)n[a]&&(this.data_p[a-r]+=n[a]-s,s=n[a]),a++;(void 0===this.new_vals.min_idx||this.new_vals.min_idx>a-r)&&(this.new_vals.min_idx=a-r)}},update_posts_no:function(e,t){var n=(e-this.time_base)/this.time_unit+t;n>=0&&n<this.min_idx&&(this.min_idx=n)},prep_board_check_valid:function(e,t){this.valid&=e.s[h.length]>=0}},x={};return window.addEventListener("beforeunload",_,!1),{aggregate:function(e){if(e.posts){var n=liveTag.mems[e.domain][e.board],r=n[e.no];r.s||(r.s=[]);var a=e.parse_funcs.time_unit,s=r.s.length,o=s;r.pd&&pref.test_mode[128]&&(e={posts:site2[r.domain].update_posts_merge_prep(e.posts,r.pd,-1,!0),__proto__:e});var i=e.posts.length-(e.nof_posts-r.s.length);if(!(i<0)){for(;i<e.posts.length;)r.s[o++]=Math.floor(e.posts[i++].time*a/6e4);if(r.ss)if(Array.isArray(r.ss))for(var i=0;i<r.ss.length;i++)r.ss[i].update_thread(r.s,s,!0);else r.ss.update_thread(r.s,s,!0);else 0===s&&t(r);pref3.stats.estimate_posts&&l(n,e,s,r.s,e.posts.length)}}},thread_removed:e,Stats:b,register_auto_acquisition:function(e){x["@"+p(e)]=null,cnst.auto_shrink_board_selector.color()},query_auto_acquisition:function(e){return void 0!==x["@"+p(e)]},auto_acquisition_init:d}}():null,listener=null;site.features.listener&&pref.features.listener&&(listener=make_listener());var pn_debug=0;brwsr.sw_cache=brwsr.sw_cache&&window.SharedWorker&&(pref.info_server||pref.info_client)?function(){function e(e){if(!e){
var r=new Blob(['          var ports = [];          var store = {};          var connections = 0;          self.addEventListener("connect", function(e){            var port = e.ports[0];            var no = connections++;            var func = function(e){msg_parser(e,port,no)};            port.addEventListener("message", func, false);            port.start();            port.postMessage(JSON.stringify(["INFO","Connected: #" + no]));            ports.push({port:port, func:func, echo:true, subscribe:false});          }, false);          function msg_parser(e,port,no){            if (ports[no].echo) port.postMessage(e.data);            var fields = JSON.parse(e.data);            if (fields[0]=="ECHO") ports[no].echo = fields[1];            else if (fields[0]=="GET") port.postMessage(JSON.stringify(["ACK",fields[1],store[fields[1]]]));            else if (fields[0]=="CLOSE") {              port.removeEventListener("message", ports[no].func, false);              ports[no] = null;            }/*            else if (fields[0]=="SET") store[fields[1]]=fields[2];*/            else if (fields[0]=="SET") {              var old_val = store[fields[1]];              if (old_val!=fields[2]) {                var msg = JSON.stringify(["EVENT",fields[1]]);                for (var i=0;i<ports.length;i++)                  if (i==no) store[fields[1]]=fields[2];                  else if (ports[i] && ports[i].subscribe) ports[i].port.postMessage(msg);              }            } else if (fields[0]=="STAT") stat_post(port,"STAT_ACK",fields[1]);else if (fields[0]=="SUBSCRIBE") ports[no].subscribe = fields[1];}var gc = setInterval(gc_func, 600000);function gc_func(){var date = Date.now() - 3600000;for (var i in store) if (store[i].date < date) delete store[i];}function stat_post(port,str,dump){var live = 0;for (var i=0;i<ports.length;i++) if (ports[i]) live++;var msg = JSON.stringify([str,"Connected: "+live+"/"+connections+", Stored: "+Object.keys(store).length]);port.postMessage(msg);var count = 0;if (dump) for (var i in store) port.postMessage(JSON.stringify(["DUMP_ACK",(count++)+": "+i+", "+JSON.stringify(store[i])]));}        '],{type:"text/javascript"});e=URL.createObjectURL(r),localStorage[o]=e}try{return a=new unsafeWindow.SharedWorker(e),a.port.addEventListener("message",t,!1),a.port.addEventListener("message",n,!1),a.port.start(),!0}catch(e){return!1}}function t(e){console.log((new Date).toLocaleTimeString()+", Worker said : "+e.data.substr(0,120)),s||(a.port.postMessage(JSON.stringify(["STAT"])),pref.debug_mode[0]||a.port.postMessage(JSON.stringify(["ECHO",!1])),window.addEventListener("beforeunload",function(){a.port.postMessage(JSON.stringify(["CLOSE"])),a.port.close()},!1)),s=!0,pref.debug_mode[0]||a.port.removeEventListener("message",t,!1)}function n(e){if(p=JSON.parse(e.data),"ACK"==p[0]){var t=p[1];clearTimeout(c[t]),l[t]&&(l[t][0](t,p[2],l[t][1]),delete l[t])}else if("EVENT"==p[0]){if(pref.info_client&&p[1].search(info_raw)!=-1&&"p"==p[1].substr(info_raw.length,1)){var n=(p[1].substr(info_raw.length+1),timer_obj?timer_obj.timer():null);null!=n&&brwsr.sw_cache.trygetItem(p[1],n.page_check5)}pref.info_client&&catalog_obj&&null!=catalog_obj.catalog_func()&&pref.catalog_snoop_refresh&&catalog_obj.catalog_func().catalog_insert(p[1])}p=null}function r(e){l[e][0](e,null,l[e][1]),delete l[e]}if(!localStorage)return null;var a=null,s=!1,o=pref.script_prefix+".bs",i=localStorage[o];i?e(i)||e():e(),!brwsr.ff&&a&&setTimeout(function(){null===i||s||(a.port.removeEventListener("message",t,!1),a.port.close(),e()||(brwsr.sw_cache=null))},5e3);var l=[],c=[],p=null;return a?{setItem:function(e,t){a.port.postMessage(JSON.stringify(["SET",e,t]))},trygetItem:function(e,t,n){l[e]=[t,n],c[e]=setTimeout(function(){r(e)},2e3),a.port.postMessage(JSON.stringify(["GET",e]))},subscribe:function(e){a.port.postMessage(JSON.stringify(["SUBSCRIBE",e]))},addEventListener:function(){}}:null}():null,function(){var e="CatChan_archive_"+window.name,t=pref.catalog.embed_page&&"page"===site.whereami&&sessionStorage&&sessionStorage[e]?function(){catalog_obj.show_hide(),setTimeout(function(){var t=JSON.parse(sessionStorage[e]);sessionStorage[e+"M"]&&(t[2]=function(){if(send_message_emu=JSON.parse(sessionStorage[e+"M"]),receive_message_emu(window.name),pref.archive.IDB.redirect_404_CSP){var t=document.head.innerHTML+document.body.innerHTML,n=new Blob([t],{type:"text/html"}),r=URL.createObjectURL(n);window.open(r,window.name+"B")}}),send_message_emu=[t],receive_message_emu(window.name)},100)}:catalog_obj&&catalog_obj.show_hide;"404"===site.whereami&&pref.archive.IDB.redirect_404?sessionStorage&&setTimeout(function(){var t=e+"A";if(sessionStorage[t])delete sessionStorage[t];else{var n=common_func.fullname2dbt(window.name);sessionStorage[t]=JSON.stringify(["ARCHIVER",["SUB_INIT",{IDB:!0,domain:n[0],board:n[1],no:n[2]}]]),received_messages_404&&(sessionStorage[t+"M"]=JSON.stringify(received_messages_404));var r=site2[site.nickname].make_url4([site.nickname,site.board,"0","page_html"])[0];window.name=window.name+"A",window.open(r,"_self")}},5e3):(pref.catalog.embed&&"catalog"===site.whereami||pref.catalog.embed_page&&"page"===site.whereami||pref.thread.embed&&"thread"===site.whereami||pref.catalog.embed_archive&&"archive"===site.whereami)&&catalog_obj&&(site2[site.nickname].catalog_native_prep_wait_loop?site2[site.nickname].catalog_native_prep_wait_loop(site.whereami,t):pref.patch.delayed_invoke.use?setTimeout(t,1e3*pref.patch.delayed_invoke.sec):t()),setTimeout(thread_reader_init,0),setTimeout(uip_tracker_init,0)}(),options.func0_prep=function(e,t,n){function r(){if(null==l&&null==c){var t=e.childNodes[1].childNodes[1].selectedIndex,n=e.childNodes[1].childNodes[2].value,r=parseInt(n.substr(0,n.indexOf(":")),10),s=parseInt(n.substr(n.indexOf(":")+1),10),p=Date.now();0==t?(i=(new Date).setHours(r,s,0))<p&&(i+=864e5):i=p+1e3*(3600*r+60*s),a()}else null!=l&&(clearTimeout(l),l=null),null!=c&&(clearInterval(c),c=null),_.innerHTML="";o(!1)}function a(){var e=Date.now(),t=i-e;l=t%6e4>=1e3&&t>6e4?setTimeout(a,t%6e4):t<9e4?setTimeout(function(){c=s(30),l=null},t-3e4):setTimeout(a,(t+3e4)%6e4+3e4);var n="";t%6e4>=1e3&&t%6e4<=59499&&(n=Math.round(t%6e4/1e3)+"s"),t>=59500&&(n=Math.floor((t+500)%36e5/6e4)+"m"+n),t>=3599500&&(n=Math.floor((t+500)/36e5)+"h"+n),_.innerHTML=n}function s(e){function t(){if(e-=1,_.innerHTML=e+"s",0==e){var t=document.createEvent("MouseEvents");t.initUIEvent("click",!1,!0,window,1),site.components.postform_submit.dispatchEvent(t),r()}}return _.innerHTML=e+"s",o(!0),setInterval(t,1e3)}function o(t){n.style.background=t?"#ffc0cb":null!=l?"#f5ecf9":d.checked?"#e5f4f9":p;var r=t||null!=l?"Cancel":"Schedule";e.childNodes[1].childNodes[0].value=r}cnst.add_to_tb(t,cnst.icons.button_settings());e.innerHTML='<div style="float:left"><input type="checkbox">autobumper</div><div style="float:right"><input type="button" value="Schedule"><select name="time_sel"><option>at</option><option>later</option></select><input type="time" name="time" value="08:41"></div><div style="float:right"></div>',e.childNodes[1].childNodes[0].addEventListener("click",r,!1);var i,l=null,c=null,p=e.parentNode.style.background,_=e.childNodes[2],d=e.childNodes[0].childNodes[0];d.onchange=function(){o(!1)};var u=null;options.func0_exe=function(e){var t=document.getElementsByClassName("postreply").length-document.getElementsByClassName("de-post-deleted").length;parseFloat(e)>=site.max_page-1&&d.checked&&null==u&&t<site.autosage&&(c=s(30),u=setTimeout(function(){u=null},36e5))}}}}}();
//# sourceMappingURL=https://raw.github.com/Dogman8/CatChan/master/CatChan.user.js.map
