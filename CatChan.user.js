// ==UserScript==
// @name CatChan
// @version 2017.07.02.1
// @description Cross domain catalog for imageboards
// @include http*://*krautchan.net/*
// @include http*://boards.4chan.org/*
// @include http*://i.4cdn.org/*
// @include http://*.2chan.net/*
// @include http*://8chan.co/*
// @include http*://8ch.net/*
// @include http*://lainchan.org/*
// @include http*://lainchan.jp/*
// @include http*://*meguca.org/*
// @require https://cdnjs.cloudflare.com/ajax/libs/Chart.js/1.0.1-beta.4/Chart.min.js
// @updateURL https://raw.github.com/Dogman8/CatChan/master/CatChan.meta.js
// @grant unsafeWindow
// @grant GM_xmlhttpRequest
// ==/UserScript==
//
//    Copyright 2014 DogMan8
//
//    This program is free software: you can redistribute it and/or modify
//    it under the terms of the GNU Affero General Public License as published by
//    the Free Software Foundation, version 3 of the License.
//
//    This program is distributed in the hope that it will be useful,
//    but WITHOUT ANY WARRANTY; without even the implied warranty of
//    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
//    GNU Affero General Public License for more details.
//
//    You should have received a copy of the GNU Affero General Public License
//    along with this program.  If not, see <http://www.gnu.org/licenses/>.
//
!function(){function pref_default(){for(var e={image_hover:!1,image_hover_zIndex:101,image_prefetch:!1,click:"none",click_area:"thumbnail",format:{show:{style:!0,contents:!0,layout:!0,posts:!1,fileinfo:!1,images_2nd:!0},hover:{style:!0,contents:!1,layout:!1,posts:!0,fileinfo:!0,images_2nd:!0},search:{style:!1,contents:!1,layout:!1,posts:!0,fileinfo:!0,images_2nd:!0},thumb:{resize:!1}},footer:{ctime:!1,btime:!1,ptime:!1,br:!0,prate:!1,archived:!0,nd:!1,nl:!1},draw_on_demand:!0,load_on_demand:!1,t2h_sel:"page",t2h_L:100,t2h_M:50,get t2h_N(){return this.t2h_num_of_posts},t2h_num_of_posts:5,save_board_list_sel:!1,board_list_sel:0,mark_new_posts:!0,auto_update:!1,auto_update_period:10,auto_update_countdown:!0,popup:!0,colorID:!0,backlink:!0,popup_truncated:!0,link_show_op:!0,expand_thumbnail_inline:!0,localtime:!0,expand_thumbnail_inline_all_after:!1,expand_thumbnail_initial:!1,hide_posts_without_images:!1,thumbnail:{inline:{limit_width:!0,limit_height:!1,margin_width:40,margin_height:0,webm:!0,webm_mute:!1,webm_loop:!1,ondemand:!0,ref_height:400},hover:{limit_width:!0,limit_height:!0,margin_width:40,margin_height:0,webm:!1,webm_mute:!0,webm_loop:!1}},open_spoiler_text:!1,open_spoiler_image:!1,merge:!1,lazyDraw_merge:!0,lazyDraw_merge_step:16,merge_list:!0,merge_list_str:"",merge_list_obj6:null,merge_first:!0,scroll_lock:!1,use_expander_always:!1,popup2:"no",posts_search_op:"opaque",posts_search_op_opacity:40,deleted_posts:{detect:"acc",store:"LS",merge:!0,auto_clean:!0},auto_config_posts_search:!0,imagesearch:{use:!0,google:!0,iqdb:!0,saucenao:!0,whatAnime:!0,desustorage:!0,exhentai:!0},env:{disp_offset:0,disp_filler:null,popup_native:!0,expand_thumbnail_inline_native:!0,image_hover_native:!1,colorID_native:!0,backlink_native:!0,localtime_native:!0,auto_update_native:!1,event_dynamic:!1}},t={script_prefix:"CatChan",features:{page:!0,graph:!0,setting:!0,setting2:!0,postform:!0,catalog:!0,listener:!0,uip_tracker:!0,thread_reader:!0,debug:!1,notify:{desktop:!0,sound:!0,favicon:!0},recovery:!0},max_capture:576,interval_found:10,write_to_ls:!0,aggregator:"true",server:!0,load_pref:!0,load_data:!0,check_page:!1,check_post:!1,check_thread:!1,import_format:"obj",max_graph:576,scale_thread:10,auto_start:!0,workaround_for_dollchan:!1,prevent_redirection:!1,graph_animation:!1,autoconf:"auto",info_server:!1,info_client:!1,wafd_tb:"tb",wafd_open_spoiler:!1,show_page_fraction:!0,catalog_max_page:5,catalog_max_page_auto:!0,catalog_max_page_select:"auto",catalog_snoop_refresh:!0,catalog_auto_rollup_when_moving:!0,catalog_size_width:240,catalog_size_height:350,catalog_size_text_width:400,catalog_size_text_height:16,catalog_size_tn1_width:240,catalog_size_tn1_height:240,catalog_size_tn2_width:80,catalog_size_tn2_height:80,catalog_size_frame0_width:30,catalog_size_frame1_width:69,catalog_load_on_demand_timeout:10,catalog_2nd_images_show:!1,catalog_2nd_images_hover:!0,catalog_2nd_images_search:!0,catalog_posts_on_demand:!0,catalog_refresh_clear:!0,catalog_popdown:"delay",catalog_popup_delay:300,catalog_popdown_delay:500,catalog_popup_size_fix:!0,catalog_open_last50:"exist_watch",catalog_board_list_str:"//sample of board group\n//board_name[,nickname+board_name[+thread No.]['*'+up to X page]]..., [#Tag|##Tag]..., [!stats]\nGlobal/int/,8chan/int/,KC/int/,4chan/int/\nGlobal/b/,8chan/b/,KC/b/,4chan/b/\nv+gg,8chan/v/,8chan/gamergatehq/,4chan/v/\nInter/pol/,8chan/pol/,4chan/pol/\nJapanShoppingMall,8chan/jpck/,8chan/japan2/\ntech,meguca/g/,lain/tech/,8chan/tech/,4chan/g/,KC/t/\n",catalog_board_list_obj:[],catalog_promiscuous:!1,get catalog_board_list_sel(){return cataLog&&cataLog.embed_mode&&this[cataLog.embed_mode]?this[cataLog.embed_mode].board_list_sel:0},set catalog_board_list_sel(e){cataLog&&cataLog.embed_mode&&this[cataLog.embed_mode]&&(this[cataLog.embed_mode].board_list_sel=e)},localtime_offset:-((new Date).getTimezoneOffset()/60),catalog_footer:!0,catalog_footer_show_site_name:!1,catalog_footer_show_board_name:!0,catalog_footer_show_thread_no:!1,catalog_footer_show_nof_rep_to_me:!0,catalog_footer_show_nof_rep:!0,catalog_footer_ignore_my_own_posts:!0,catalog_footer_show_flag:!0,catalog_footer_show_page:!0,catalog_footer_show_tag:!0,catalog_footer_tag_letters:3,catalog_footer_design:"native",catalog_no_popup_at_expanded:!0,catalog_open_in_new_tab:!0,catalog_open_where:"named",catalog_open_where_click:!0,catalog_triage:!0,catalog_triage_place:"topLeft",catalog_triage_hist:16,triage:{show_always:!1,popdown_delay:2e3,hide_toggle:!0},catalog_triage_str:"KILL,X,,TIME,v,,WATCH,W,,UNWATCH,UW,,UNDO,U,",catalog_auto_update_countdown:!0,catalog_expand_at_initial:!1,catalog_expand_at_initial_embed:!0,catalog_expand_with_hr:!1,overwrite_site2_json_str:'//{"site2":{"KC":{"time_offset":2}}} // summer time for KC.\n//{"site2":{"4chan":{"protocol":"https:"}}} // use https to 4chan.\n//{"pref":{"patch":{"rm_404_blacklist":["8chan"]}}} // 8chan sends corrupted data.\n',overwrite_site2_eval_str:"",tooltips:{help:{show:!0,popup_delay:2e3,popdown_delay:1e3},info:{show:!0,popup_delay:300,popdown_delay:500}},catalog:{indexing:0,max_threads_at_refresh:500,filter:{kwd:{use:!1,str:"",re:!1,ci:!0,match:0,op:!0,post:!1,sub:!0,name:!0,trip:!1,com:!0,file:!1,kwds:[],meta:!1,sentence:!1},tag:!1,tag_ci:!1,time:!1,time_creation:!1,time_str:new Date(Date.now()-864e5).toLocaleString(),time_obj:!0,time_ago_str:"0:00",time_ago_str_sync_at_refresh:!1,time_track:!1,desktopime_mark_str:"",time_watch:!1,time_watch_creation:!1,list_time_scroll:!0,list:!0,list_str:"",list_obj2:{},attr_list:!0,attr_list_str:"",attr_list_obj2:{},bookmark_list:!0,bookmark_list_str:"",bookmark_list_obj2:{},watch_list_str:"",watch_list_obj2:{},tag_search:{str:"",re:!1,get ci(){return pref.liveTag.ci},sentence:!1,rexps:[]}},bookmark_list_rm404:!0,auto_load_filter:!1,auto_save_filter:!1,auto_save_filter_at_refresh:!1,tag:{ignore:12,max:12},board:{recommendation:!0,all_boards:!1,board_tags:!1,ex_list:!1,ex_list_str:"",ex_list_obj2:{},board_tags_same:!1},style_general_list:!0,style_general_list_str:"//^background:#e5ecf9\n//^border:1px solid black\n//8chan^background:#eef2ff;border:1px solid #d6daf0\n//8chan^background:#eef2ff\n//KC^background:#e0e0fc;border:1px solid #aaaacc\n//4chan^background:#ffffee;border:1px solid #f0e0d6\n",style_general_list_obj2:{},refresh:{initial:!0,except_bt:!0,at_switch:!0},design:"auto",catalog_json:!0,embed:!0,embed_page:!0,embed_frame:!0,order:{reply_to_me:!0,reply:!0,watch:"dont_care",sticky:"dont_care"},auto_watch:!0,unmark_on_hover:!0,mimic_base_site:!0,text_mode:{mode:"graphic",sub:!0,name:!1,com:!0},appearance:{titleBar:{filter:!0,settings:!0,refresh:!0,num_of_pages:!0,boards_selector:!0},initial:{state:"maximized",width:400,height:400}},t2h_sel:"no",click:"open",env:Object.create(e.env),__proto__:e},filter:{disable_list_when_kwd_active:!0},page:{get embed(){return pref.catalog.embed_page},infinite:!1,format:{show:{style:!1,contents:!1,layout:!1,posts:!0,fileinfo:!0,images_2nd:!0},__proto__:e.format},image_hover:!0,footer:{br:!1,__proto__:e.footer},draw_on_demand:!0,load_on_demand:!0,env:Object.create(e.env),__proto__:e},thread:{embed:!1,format:{show:{style:!1,contents:!1,layout:!1,posts:!0,fileinfo:!0,images_2nd:!0},__proto__:e.format},image_hover:!0,footer:{br:!1,__proto__:e.footer},env:{auto_update_native:!0,__proto__:e.env},t2h_num_of_posts:-1,auto_update:!1,__proto__:e},float:{click:"open",format:{thumb:{resize:!0},__proto__:e.format},save_board_list_sel:!0,env:Object.create(e.env),__proto__:e},common:{clear_at_manual_scan:!1},uip_tracker:{on:!1,posts:!0,deletion:!0,interval:10,adaptive:!0,highlight_str:"color:red",auto_open:!1,auto_open_th:300,auto_open_kwd:"",deletion:{show:!0,name:!0,name_str:"color:red",addName:!0,addName_str:"DELETED_",post:!1,post_str:"opacity:0.4"},sage:{detect:!0,name:!0,name_str:"color:blue",addName:!1,addName_str:"SAGE_",post:!1,post_str:"opacity:0.4",tolerance:1,patch_bug:!1,patch_bug2:!1,patch_bug2nth:8,patch_bug3:!0}},thread_reader:{use:!0,sync:!0,triage:!0,triage_close:!0,check_num_of_children:!0,own_posts_tracker:!1,show_own_post_by:"anchor",show_reply_to_me_by:"anchor",clean_up_own_posts:!0},settings:{indexing:0},tag:{gen:!1,gen_str:""},cloudflare:{auto_reload:!0,auto_reload_time:5},scan:{max:1e4,lifetime:20,crawler:50,max_threads:1e3,crawler_adaptive:!0,crawler_idle_time_to_spawn:100},notify:{sound:{notify:!1,src:"beep",beep_freq:1e3,beep_length_f:.2,beep_volume_f:1,reply_to_me:!0,reply:!0,new_thread:!0,appear:!0},desktop:{notify:!0,reply_to_me:!0,reply:!0,new_thread:!0,appear:!0,lifetime:30,show_last:!1,limit:brwsr.ff?10:30,delay:brwsr.ff?500:0},favicon:!0,title:{notify:!0,hide_zero:!0}},liveTag:{use:!0,max:12,maxstr:25,from:"post",lock_tags_in_op:!0,ci:!0,inherit_board_name:!0,lock_board_name:!0,inherit_board_tags:!0,lock_board_tags:!0,show_info_onmouseover:!0,style:!0,style_urtm_str:"color:lime;font-weight:bold",style_ur_str:"color:limegreen;font-weight:bold",style_in_str:"color:red",pickup_interval:10,rm_404_immediately:!0,disp_delay:{fg:500,bg:5e3},click_func:"in",click_func_bl:"pkin",watch_all:!0,ex_list:!0,ex_list_str:"8chan:#selection\n",ex_list_obj5:[],rm_list:!0,rm_list_str:"http*\n",rm_list_obj5:[]},virtualBoard:{show:!0,max:20,scan:!1,scanDelay:5,p_board:"replace",p_remove:!1,v_remove:!0,scan_domains:{meguca:"none",lain:"none","8chan":"none","4chan":"none",KC:"none",lainjp:"none"},instant_scan:!0,search:{show:!0,str:"",re:!1,get ci(){return pref.liveTag.ci},sentence:!1,rexps:[]}},style:{sel:"fix",fix:{titleBar_str:"background:#b5ccf9;border:1px solid blue;font-weight:normal",window_str:"background:#e5ecf9;color:#000000;font-weight:normal",popUp_str:"background:#e5f4f9;color:#000000;border:2px solid blue;"},copy:{titleBar_str:"body",window_str:"body",popUp_str:""},post_editing:"background:#cec952 !important",post_new:"border:2px solid red"},recovery:{comment:!0,interval:10,auto_clean:!0},healthIndicator:{show:!0,max:10,expand_running:!1,dont_retire_running:!0,cancel:!0},network:{cross_domain:"indirect",fetch_actively:!0,adaptive:!0,th100:5,th100_delay:500,th20:10,th20_delay:100,timeout:15,overXFO:!0,overCSPF:!0},stats:{use:!1,retain_404:!0,draw_delay:10,estimate_posts:!0,save:!0,load:!0,len_capture:1440,auto_acquisition:!0,auto_acquisition_scan:!0,auto_acquisition_scan_delay:120,auto_acquisition_all:!1,tolerant:!0,tolerance:90},chart:{off_anime_blur:!0,window_width:400,window_height:400,instant_scan:!0,load_on_demand:!1,inst:{len:120,scale_thread:10,time_sel:1,board_sel:0,show_legend:!0,show:{np:!0,p:!1,ep:!1,nt:!1,t:!0,et:!1},clip_np:!1,clip_np_val:0,options:{bezierCurve:!1,animation:!1,pointDot:!0,pointDotRadius:4}}},archive:{load_img:!0,restore_auto:!0,clear_threads:!0,clear_files:!1,format:"auto",domain:0,board:"",src:"shown",store_auto:!1,dir_dled:null,open_local:!1,fix_inconsistency:!0,oneshot:{post:!0,tn:!0,img:!0,webm:!0,post_idb:!0,tn_idb:!0,img_idb:!0,webm_idb:!0},live:{post:!0,tn:!0,img:!1,webm:!1,post_idb:!0,tn_idb:!0,img_idb:!1,webm_idb:!1},deleted:{post:!0,tn:!0,img:!1,webm:!1,post_idb:!0,tn_idb:!0,img_idb:!1,webm_idb:!1},IDB:{auto_clean:!0,auto_clean_init:!0,prune:168,prune_flush:!1,nof_tr:10,nof_cl:20,nof_cl_max:80,auto_restore:!1,auto_restore_remove:!0,watchdog:120},kwd:{use:!0,str:"",re:!1,ci:!0,match:0,op:!0,post:!1,sub:!0,name:!0,trip:!1,com:!0,file:!1,meta:!1,sentence:!1},list:!0,list_str:"",list_obj6:null,list_inherit:!1,tar:!0,tarsize:100,sub_in_filename:!0,files_sel:0,IDB_board_sel:0,IDB_board_sel_gfunc_pre:pref4.archive.IDB_board_sel_gfunc_pre,IDB_thread_sel:0,IDB_thread_sel_gfunc_pre:pref4.archive.IDB_thread_sel_gfunc_pre,IDB_select_multiple:!0},debug_mode:{unread_count:"",parse_error:!1,site2func:"",site2func_expand:!0,pfunc:"",pfunc_expand:!0,pfunc_all:"",pfunc_all_expand:!0,pfunc_comp:"",pfunc_comp_expand_same:!0,pfunc_comp_expand_diff:!0,pfunc_comp_proto:""},test_mode:{tips:!1,num:0,num_f:0,test_str:""},patch:{delayed_invoke:{use:!1,sec:10},rm_404_blacklist:[]},pref2:{KC:{summer_time:!1},meguca:{historyAPI:!0,utilize_boards_json:!0,utilize_boards_json_domain:!0},"8chan":{utilize_boards_json:!0}},easy:{posts_ago:24,threads_ago:24,max_boards:50},easy2:{reset:!0,presets:0,time_post:24,time_op:24,basics:!0,auto_update:!1,auto_update_period:10,VB:{local:0,global:0},LTfrom:0,limits:0,virtualBoard:{show:!0,scan:!0,max:100},liveTag:{use:!1,from:"op"},catalog:{embed:!0,embed_page:!0,max_threads_at_refresh:500,auto_load_filter:!0,auto_save_filter:!0,auto_save_filter_at_refresh:!0,auto_update:!0,auto_update_period:10,filter:{time_watch:!1,time_watch_creation:!1}},page:{auto_update:!0,auto_update_period:10},thread:{embed:!1,auto_update:!0,auto_update_period:10},notify:{desktop:{notify:!0}},stats:{use:!1},scan:{max:100,max_threads:1e3},network:{fetch_actively:!1},healthIndicator:{expand_running:!1}},proto:e},a=0;a<40;a++)t.debug_mode[a]=!1;for(var a=0;a<100;a++)t.test_mode[a]=!1;return site&&site2[site.nickname].pref_default&&pref_func.pref_overwrite(t,site2[site.nickname].pref_default),t}function make_port_parent(e,t){function a(e,t,a){if(pref.debug_mode[0]&&console.log(window.name+": Connecting from "+e.data),e.source==a&&new RegExp(site.nicknames.join("|")).test(e.data)||e.source==site.embed_frame_win&&"frame"===site.whereami&&e.data.indexOf("CLOSE")==-1){if(pref.debug_mode[0]&&console.log(window.name+": Connected successfully."),brwsr.ff?init_receive_port(t,a):init_receive_port(t,e.ports[0]),window.removeEventListener("message",init_func[t],!1),delete init_func[t],messages_to_send[t]){for(var n=0;n<messages_to_send[t].length;n++)send_message(t,messages_to_send[t][n][0],null,messages_to_send[t][n][1]);delete messages_to_send[t]}"_blank"==t&&send_message(t,[["CLOSE"]])}else pref.debug_mode[0]&&console.log(window.name+": FAIL.")}ports[e]&&send_message(e,[["CLOSE"]]),ports[e]="init",init_func[e]=function(n){a(n,e,t)},window.addEventListener("message",init_func[e],!1),pref.debug_mode[0]&&console.log(window.name+": Waiting for connection from "+e+" ...")}function make_port_child(e){if(pref.debug_mode[0]&&console.log(window.name+": Try to connect to parent..."),brwsr.ff)init_receive_port("parent",e),e.postMessage(window.name,"*");else{var t=new MessageChannel;init_receive_port("parent",t.port1),e.postMessage(window.name,"*",[t.port2])}}function init_receive_port(e,t){ports[e]=t,receive_func[e]=function(t){receive_message(t,e)},brwsr.ff?window.onmessage=receive_func[e]:(t.addEventListener("message",receive_func[e],!1),t.start())}function close_connection(e){brwsr.ff||ports[e].close(),ports[e].removeEventListener("message",receive_func[e],!1),delete receive_func[e],delete ports[e]}function send_message(e,t,a,n){Array.isArray(t)&&Array.isArray(t[0])&&(t=t[0]),a&&make_port_parent(e,a),"init"===ports[e]?(messages_to_send[e]||(messages_to_send[e]=[]),messages_to_send[e].push([t,n])):(ports[e]||(e="parent"),pref.debug_mode[0]&&console.log(window.name+": Sent to "+e+": "+JSON.stringify(t).substr(0,80)),brwsr.ff?ports[e].postMessage(t,"*",n):ports[e].postMessage(t,n),"CLOSE"==t[0]&&close_connection(e))}function receive_message_emu(){for(;send_message_emu.length>0;)receive_message({data:send_message_emu.shift()},site.key)}function receive_message(e,t){pref.debug_mode[0]&&console.log(window.name+": Received from "+t+": "+e.data.toString().substr(0,80));var a=e.data,n=e.ports;if("string"==typeof a&&(a=JSON.parse(a)),"HTTPD"==a[0])httpd.sub_funcs(a[1]);else if("IDB"==a[0])IDB.sub_funcs(a[1],n);else if("ARCHIVER"==a[0])archiver.sub_funcs(a[1]);else if("CLOSE"==a[0])close_connection(t);else if("MARK"==a[0]&&a[1]>0){var r=common_obj.thread_reader&&pref.test_mode[16]?common_obj.thread_reader.mark_newer_posts(a[1]):site2[site.nickname].mark_newer_posts(document,a[1],pref.catalog.unmark_on_hover,!0);r?scrollTo(0,r.offsetTop-site.header_height()):scrollTo(0,document.body.clientHeight-window.innerHeight),common_obj.thread_reader&&common_obj.thread_reader.mark_posts_from_parent(a[1])}else"OWN_POSTS"==a[0]?site2[a[1]].prep_own_posts_event_received?site2[a[1]].prep_own_posts_event_received(a[2]):site3[a[1]].own_posts=a[2]:"TRIAGE"==a[0]?catalog_obj&&null!=catalog_obj.catalog_func()&&catalog_obj.catalog_func().triage_exe_pipe(a[1]):pref.test_mode[34]&&"ECHO"===a[0]&&setTimeout(function(){send_message(window.name?"parent":"meguca",[["ECHO",a[1]]])},5e3)}function close_all(){for(var e in ports)send_message(e,[["CLOSE"]])}function make_uip_tracker(){function e(){d=null,site2[site.nickname].uip_check(o,c)}function t(e,t){var a=site2[site.nickname].parse_json_catalog(t.responseText);k.max=0;for(var n=0;n<a.length;n++)for(var o=0;o<a[n].threads.length;o++){var s=a[n].threads[o].no;k[s]={},k[s].sub=a[n].threads[o].sub,k[s].com=a[n].threads[o].com,k.max<s&&(k.max=s)}r(),x=!0}function a(){T.observe(u.pn,{childList:!0})}function n(){T.disconnect()}function r(){var e=pref.uip_tracker.auto_open_kwd;""===e&&(e=".*");for(var a in w)if(k[a]&&a>site.no&&void 0===N[a]){var n=!1;n|=k[a].sub&&k[a].sub.search(e)!=-1,n|=k[a].name&&k[a].name.search(e)!=-1,n|=k[a].com&&k[a].com.search(e)!=-1,pref.debug_mode[0]&&console.log("auto_opener: "+a+": "+n),n&&(window.open(site2[site.nickname].make_url4([site.nickname,site.board,a,"thread_html"])[0],"_blank"),N[a]=a),delete w[a]}else k.max>a&&delete w[a];0!=Object.keys(w).length&&x&&(x=!1,http_req.get("uip_auto",m,f,t,!1,!1))}function o(e,t){l(e,t,!0)}function s(e,t){i()}function i(){n();for(var e=0;e<h.length;e++){var t=h[e],r=site2[site.nickname].uip_tgt_post(t[0]);if(r){var o=document.createElement("span");if(o.innerHTML=" (<span>"+t[2]+"</span>)",t[4]&&o.childNodes[1].setAttribute("style",pref.uip_tracker.highlight_str),pref.uip_tracker.posts&&(pn_posts=document.createElement("span"),pn_posts.innerHTML="<span>"+t[1]+"</span>"+(t[5]&&pref.uip_tracker.deletion.show?"("+t[5].join()+")":"")+"/",t[3]&&pn_posts.childNodes[0].setAttribute("style",pref.uip_tracker.highlight_str),o.insertBefore(pn_posts,o.childNodes[1])),t[5]&&(pref.uip_tracker.deletion.name||pref.uip_tracker.deletion.addName||pref.uip_tracker.deletion.post))for(var s=0;s<t[5].length;s++)p({no:t[5][s]},pref.uip_tracker.deletion,!0);var i=site2[site.nickname].uip_post_num(r);i[i.length-1].appendChild(o),h.splice(e--,1)}}a()}function l(t,a,n){if(v++,200==a.status){var o=site2[site.nickname].parse_json_thread("response"in a?a.response:JSON.parse(a.responseText),n),s=o.posts.length,l=o.posts[s-1].unique_ips||g[2],c=o.posts[s-1].no;if(g[0]!=c||g[1]!=s||g[2]!=l){pref.debug_mode[31]&&console.log(new Date(a.date).toLocaleTimeString()+", "+c+", "+s+", "+l);for(var p={},u=0;u<o.posts.length;u++)p[o.posts[u].no]=null;if(pref.uip_tracker.auto_open&&pref.uip_tracker.auto_open_th<=s&&0!=g[0]){for(var f=document.createElement("span"),u=o.posts.length-1;u>=1&&void 0===b[o.posts[u].no];)u--;for(;++u<o.posts.length;){f.innerHTML=o.posts[u].com;for(var m=f.getElementsByTagName("a"),k=0;k<m.length;k++){var x=m[k].textContent.match(/>>([0-9]+)$/);x&&(x=x[1],void 0===p[x]&&void 0===b[x]&&(w[x]=x))}}r()}var N=o.posts.length<g[1]||o.posts[g[1]-1].no!=g[0];if(pref.uip_tracker.deletion.show||pref.uip_tracker.deletion.name||pref.uip_tracker.deletion.addName||pref.uip_tracker.deletion.post){var T=[];for(var u in b)void 0===p[u]&&(T[T.length]=u);pref.debug_mode[31]&&""!==T&&console.log("uip_deleted "+T)}g=[c,s,l,N,g[2]!=l,0!=T.length?T:null],h.push(g),v=0,b=p}i()}if(pref.uip_tracker.on){if(n){y=0!=v&&pref.uip_tracker.adaptive?v%8==0?y>=1800?3600:2*y:y:pref.uip_tracker.interval>10?pref.uip_tracker.interval:10;var j=200==a.status?o.posts[0]:null;404==a.status||j&&(j.archived||j.closed)?_():d=setTimeout(e,1e3*y)}}else _()}function c(e){for(var t in A)p(A[t])&&delete A[t];if(e&&e.posts){for(var t=e.posts.length-1;t>=1&&("sage"===e.posts[t].email&&void 0===j[e.posts[t].no]);t--)p(e.posts[t]);if(pref.uip_tracker.sage.patch_bug)for(var t=e.posts.length-1;t>=1;t--)if("sage"!==e.posts[t].email){if(null!==j[e.posts[t].no]&&!A[e.posts[t].no])break;pref.debug_mode[30]&&console.log("OVERDETECTION: "+e.posts[t].no),null===j[e.posts[t].no]&&p(e.posts[t],{name_str:"",addName_str:"OVERDETECTED_",post_str:"",__proto__:pref.uip_tracker.sage}),delete A[e.posts[t].no],delete j[e.posts[t].no]}}}function p(e,t,a){var n=site2[site.nickname].uip_tgt_post(e.no);if(n){var r=site2[site.nickname].parse_funcs.post_html.pn_name({pn:n,__proto__:e});return t||(t=pref.uip_tracker.sage),t.name&&r.setAttribute("style",t.name_str),t.addName&&(r.textContent=t.addName_str+r.textContent),t.post&&n.setAttribute("style",t.post_str),a||(j[e.no]=null),!0}a||(A[e.no]=e)}function _(){n(),uip_tracker=null}var d,u=site2[site.nickname].wrap_to_parse.get(document,site.nickname,site.board,"thread_html",{thread:site.myself})[0],f=site2[site.nickname].get_json_url_catalog(site.board),m=site.nickname+site.board+site.no,h=[],g=[0,1,1],b={},v=0,y=0;e();var k={},w={},x=!0,N={},T=new MutationObserver(s);T.observe(u.pn,{childList:!0}),a();var j={},A={};return function(){return d}}function uip_tracker_init(){null===uip_tracker&&site.features.uip_tracker&&pref.features.uip_tracker&&site.isthread&&pref.uip_tracker.on?uip_tracker=make_uip_tracker():pref.uip_tracker.on||(uip_tracker&&clearTimeout(uip_tracker()),uip_tracker=null)}function make_thread_reader(){function e(e){e.addEventListener("click",site2[site.nickname].check_reply.remake_own_posts,!1),u&&e.addEventListener("click",u.get_my_posts_no,!1)}function t(e){e.removeEventListener("click",site2[site.nickname].check_reply.remake_own_posts,!1),u&&e.removeEventListener("click",u.get_my_posts_no,!1)}function a(e){if(e/=site2[site.nickname].parse_funcs.thread_html.time_unit,m=!0,d[0]&&d[0].time<e){for(var t=1;t<d.length&&d[t].time<=e;)t++;o({target:d[t-1].pn})}else{var a=site.nickname+(site2[site.nickname+"_live"]?"_live":""),n=site2[site.nickname].wrap_to_parse.get(document,site.nickname,site.board,"thread_html",{thread:site.no,parse_funcs:site2[a].parse_funcs.thread_html})[0],r=n.posts.length;if(d[0])for(;r>0&&n.posts[r-1].time>=d[0].time;)r--;for(var t=r;t>0&&n.posts[t-1].time>e;)n.posts[--t].pn.addEventListener("mouseover",o,!1);d=n.posts.slice(t,r).concat(d)}}function n(e,t){for(var a=e.length-1;a>=0;a--)e[a].pn.addEventListener("mouseover",o,!1),d.push(e[a]);_[p][19][1]=(4294901760&_[p][19][1])+d.length,u&&u.update_own_posts(e,t)}function r(e){if(this===window&&m)return void(m=!1);if(0!=d.length){var t=brwsr.document_body.scrollTop;t<=h||(h=t,t+=window.innerHeight-50,o(e,t))}}function o(e,t){for(var a;0!=d.length&&!(t&&d[0].pn.offsetTop>t);){var n=d.shift();if(n.pn.removeEventListener("mouseover",o,!1),a=n.time*site2[site.nickname].parse_funcs.post_json.time_unit,e.currentTarget===n.pn)break}if(a){_[p][19][1]=d.length;for(var r=0;r<d.length;r++)d[r].reply_to_me&&(_[p][19][1]+=65536);notifier.favicon.set(_),pref.thread_reader.sync&&window.opener&&send_message("parent",[["TRIAGE",[p,"WATCH","",!1,a]]])}}function s(e){for(var t=null,a=0;a<d.length&&d[a].time<e;)a++;for(a<d.length&&(t=d[a].pn);a<d.length;)d[a].marked=!0,d[a].pn.setAttribute("style","border:2px solid red"),a++;return m=!0,t}function i(){var e=this.name.split(","),t=parseInt(e[0].replace(/[^\(]*\(/,""),10),a=parseInt(e[1].replace(/\).*/,""),10);l(f.str[t][a],f.str[t][a+2])}function l(e,t){send_message("parent",[["TRIAGE",[p,e,t,!0,site2.DEFAULT.check_reply.get_checked_time(_[p][19])]]]),pref.thread_reader.triage_close&&window.close()}function c(a,n){return!a&&pref.thread_reader.own_posts_tracker&&n?(e(n),a=n):!a||pref.thread_reader.own_posts_tracker&&n||(t(a),a=null),a}var p=site.nickname+site.board+site.myself,_={};_[p]=[],_[p][19]=liveTag.mems.init({domain:site.nickname,board:site.board,no:site.myself})[2],_[p][19][0]=983040;var d=[],u=function(){function e(){n=!0}function t(e,t){if(0==e.length)return void(n=!1);if(n){var a=pref.script_prefix+".own_posts."+site.board+site.myself,r=JSON.parse(localStorage[a]||"[]"),o=[];if(t)for(var s=0,i=e.length-1;s<r.length;){for(;i>0&&r[s]>e[i].no;)i--;r[s]===e[i].no&&(o[o.length]=e[i]),s++}else o[0]=e[e.length-1],r[r.length]=o[0].no,localStorage[a]=JSON.stringify(r);for(var s=0;s<o.length;s++){var l=o[s].parse_funcs_html.pn_name(o[s]);"plain"===pref.thread_reader.show_own_post_by?l.parentNode.insertBefore(document.createTextNode(" (You)"),l.nextSibling):l.innerHTML=l.innerHTML+" (You)"}n=!1}for(var s=0;s<e.length;s++)site2[site.nickname].check_reply.add_you(e[s])}function a(){"post"===this.name&&e()}var n=!0;return{update_own_posts:t,get_my_posts_no:e,event_submit:a}};pref.thread_reader.own_posts_tracker?(u=u(),site.components.postform_submit||window.addEventListener("submit",u.event_submit,!1)):u=null;var f,m=!1,h=0,g=document.createElement("div");g.innerHTML='<button name="thread_reader.buttons.B" type="button">B</button><button name="thread_reader.buttons.UB" type="button">UB</button>'+(window.opener?'<button name="thread_reader.buttons.X" type="button">X</button><button name="thread_reader.buttons.v" type="button">v</button>':"");var b=g.getElementsByTagName("*");b["thread_reader.buttons.B"].onclick=function(){common_func.modify_bookmark(p,!0)},b["thread_reader.buttons.UB"].onclick=function(){common_func.modify_bookmark(p,!1)},window.opener&&(b["thread_reader.buttons.X"].onclick=function(){l("KILL","")},b["thread_reader.buttons.v"].onclick=function(){l("TIME","")});var v=site.embed_to.bottom;v.parentNode.insertBefore(g,v),window.opener&&pref.thread_reader.triage&&(f=new common_func.Triage(pref.catalog_triage_str,{onclick:i,wheelpatch:!1,name:"thread_reader_triage"}),v.parentNode.insertBefore(f.pn,v)),pref_func.tooltips.add_hier(g),pref.notify.favicon&&window.addEventListener("scroll",r,!1);var y=c(null,site.components.postform_submit),k=c(null,site.components.postform_submit2);return window.addEventListener("storage",site2[site.nickname].check_reply.remake_own_posts,!1),{mark_newer_posts:s,destroy:function(){return observer.disconnect(),window.removeEventListener("storage",site2[site.nickname].check_reply.remake_own_posts,!1),y&&t(y),k&&t(k),null},setup_submit2:function(){k=c(k,site.components.postform_submit2)},own_posts_tracker:u,updated:n,mark_posts_from_parent:a}}function thread_reader_init(){null===common_obj.thread_reader&&site.features.thread_reader&&pref.features.thread_reader&&"thread"===site.whereami&&pref.thread_reader.use?common_obj.thread_reader=make_thread_reader():!pref.thread_reader.use&&common_obj.thread_reader&&(common_obj.thread_reader=common_obj.thread_reader.destroy())}function make_catalog_obj(e){function t(){d=null===d?s(e):d.destroy()}function a(){i=pref.catalog.embed&&"catalog"===site.whereami,l=pref.catalog.embed_page&&"page"===site.whereami,c=pref.catalog.embed_frame&&"frame"===site.whereami,p=pref.catalog.embed&&"catalog"===site.whereami?"catalog":pref.catalog.embed_page&&"page"===site.whereami?"page":pref.thread.embed&&"thread"===site.whereami?"thread":"float",_="float"!==p,cataLog.embed_mode=p}function n(e,t,a){var n=!0;void 0===a&&(a={cs:{},ci:{}},n=!1);for(var o in e){var s=e[o].tags;if(s){for(var i=cnst.name2domainboardthread(o,!0),l={},c=s.length-1;c>=0;c--)void 0===l[s[c]]?l[s[c]]=null:s.splice(c,1);if(s.length<=pref.catalog.tag.max)for(var p=pref.catalog.tag.ignore<s.length?pref.catalog.tag.ignore:s.length,c=0;c<p;c++)for(var _ in a){var d="cs"===_?s[c]:s[c].toLowerCase();void 0===a[_][d]?a[_][d]={num:1,mem:{}}:a[_][d].num++,a[_][d].mem[i[0]+i[1]]?a[_][d].mem[i[0]+i[1]]++:a[_][d].mem[i[0]+i[1]]=1}}}if(!n)return r(a,t,{cs:[],ci:[]})[0]}function r(e,t,a){for(var n in e){for(var r in e[n])for(var s="cs"===n?r:r.toLowerCase(),i=0;i<a[n].length;i++){var l="cs"===n?a[n][i].key:a[n][i].key.toLowerCase();if(s===l){for(var c in e[n][r].mem)a[n][i].mem[c]=e[n][r].mem[c];a[n][i].num=0;for(var c in a[n][i].mem)a[n][i].num+=a[n][i].mem[c];delete e[n][r];break}}for(var r in e[n])a[n].push({key:r,num:e[n][r].num,mem:e[n][r].mem});a[n].sort(function(e,t){return t.num!=e.num?t.num-e.num:t.key>e.key?-1:1})}for(var n=0;n<a.ci.length;n++)for(var p=a.ci[n].key.toLowerCase(),r=0;r<a.cs.length;r++)if(p===a.cs[r].key.toLowerCase()){a.ci[n].key=a.cs[r].key;break}return o(a,t)}function o(e,t){for(var a=pref.catalog.filter.tag_ci?e.ci:e.cs,n="",r=0;r<a.length;r++){n=n+'<input type="checkbox"'+t+"> "+(a[r].num+": "+a[r].key)+"<br>"}return[n,e]}function s(e){function a(){pref.catalog_auto_rollup_when_moving&&("none"!=$e.style.display?(Ve(),et=!0):et&&(Ve(),et=!1))}function r(){pref.catalog.auto_save_filter&&"thread"!==p&&ft.save(),window.removeEventListener("beforeunload",r,!1)}function o(){ht=_?site2[site.nickname].catalog_get_native_area():$e,cataLog.parent=ht}function s(e){var t;if(("graphic"!==pref.catalog.text_mode.mode||"catalog_size_text_width"!==e.name&&"catalog_size_text_height"!==e.name)&&("text"!==pref.catalog.text_mode.mode||"catalog_size_width"!==e.name&&"catalog_size_height"!==e.name)){t=e.name.substr(e.name.lastIndexOf("_")+1);var a=0==pref[e.name]?"":pref[e.name]+"px";for(var n in We)We[n][0].style[t]=a}}function i(e,t){var a=Date.now()-t;wt.value=new Date(a).toLocaleString(),pref_func.apply_prep(wt,!0,!0)}function l(){Bt.off(),pref_func.tooltips.remove_hier(yt),d()}function d(){var e=new common_func.Triage(pref.catalog_triage_str,{onclick:f,wheelpatch:_?null:u,name:"pn_catalog_triage"});yt=e.pn,kt=e.str,yt.style.position="absolute",pref_func.tooltips.add_hier(yt),yt.onmouseover=Bt.triage_in,yt.onmouseout=Bt.triage_out,pref.triage.hide_toggle||(e.format_tgt=null),Bt.set_trg(e)}function u(e){Bt.off(),pref_func.tooltips.hide(),e.preventDefault();var t=document.createEvent("MouseEvents");t.initMouseEvent(e.type,e.canBubble,e.cancelable,e.view,e.detail,e.screenX,e.screenY,e.clientX,e.clientY,e.ctrlKey,e.altKey,e.shiftKey,e.metaKey,e.button,e.relatedTarget),ht.dispatchEvent(t)}function f(){var e=this.name.split(","),t=parseInt(e[0].replace(/[^\(]*\(/,""),10),a=parseInt(e[1].replace(/\).*/,""),10);h(Bt.get_triaged_thread_name(),kt[t][a],kt[t][a+2],!0)}function m(e){h(e[0],e[1],e[2],e[3],e[4])}function h(e,t,a,n,r){if(["ARC","ARC1","UARC"].indexOf(t)!=-1)return void(pref.test_mode[67]||archiver.start_1(t,liveTag.mems.getFromName(e),!0));var o=g(e,t,a,n,r);e=o.name,o.attr&&_e(e,We[e][0]),o.ex&&(We[e][9]=me(e)),o.watch&&(O(e),pref[p].mark_new_posts&&"catalog"!==p&&Ct.update(e)),(o.ex||o.watch)&&Kt(e),Bt.get_trg().format_tgt&&Bt.format_buttons(o.name),pref_func.tooltips.hide()}function g(e,t,a,n,r){"UNWATCH"===t&&common_func.modify_bookmark(e,!1);var o={ex:!1,attr:!1,watch:!1,name:e};if("GO"===t)return V(e,"force"),o;if("UNDO"!==t){n&&(Et.length>=4*pref.catalog_triage_hist&&Et.splice(0,4),Et.push(arguments),Et.push(Nt.value),Et.push(Tt.value),Et.push(xt.value));var s=new RegExp("(^|,)"+e.replace(/\+/,"\\+")+"([\\^@!][^,\n]*)*(,|\n|$)","mg");if(["KILL","TIME","WATCH","UNWATCH","DELETE","KILL_N","TIME_N"].indexOf(t)!=-1){r||(r="DELETE"!==t?We[e][8][4]||We[e][8][0]:0);var i=r%1e3,l="@"+new Date(r).toLocaleString()+(r%1e3==0?"":"."+i),c=xt.value;if("UNWATCH"===t&&c.indexOf(s)==-1)var p=!0;c=c.replace(s,","),"DELETE"!==t&&("WATCH"===t||("TIME"===t||"TIME_N"===t)&&pref.catalog.auto_watch?(c+=","+e+l+"\n",ne(e,!0)):(p&&(c+=","+e+"@0\n"),ne(e,!1))),xt.value=c.replace(/,,+/g,",").replace(/^,/g,"").replace(/\n,/g,"\n").replace(/\n\n+/g,"\n").replace(/^\n/,""),o.watch=!0}if(["KILL","TIME","NONE","DELETE","UNWATCH","KILL_N","TIME_N"].indexOf(t)!=-1){var _=Nt.value.replace(s,",");["KILL","KILL_N","TIME","TIME_N"].indexOf(t)!=-1&&(_=_+","+e+("TIME"===t||"TIME_N"===t?l:"")+"\n"),Nt.value=_.replace(/,,+/g,",").replace(/^,/g,"").replace(/\n,/g,"\n").replace(/\n\n+/g,"\n").replace(/^\n/,""),o.ex=!0}if(["KILL","TIME","NONE","DELETE","ATTR","SHOW","UNSHOW","STICKY","UNSTICKY"].indexOf(t)!=-1){var d;if("DELETE"===t)d="";else{var d=Tt.value.match(s);d=d?d[0]:e;var u={val_obj2:null,val_obj3:null};if(pref_func.str2obj2(u,"val_obj2",d),"ATTR"===t&&a&&pref_func.str2obj2(u,"val_obj2",e+"^"+a,!0),u=u.val_obj2[e],u.style||(u.style={}),u.cmd||(u.cmd={}),
"SHOW"===t?u.cmd.show=!0:"UNSHOW"===t?delete u.cmd.show:"STICKY"===t?We[o.name][16].systemSticky?delete u.cmd.sticky:u.cmd.sticky=!0:"UNSTICKY"===t&&(We[o.name][16].systemSticky?u.cmd.sticky=!1:delete u.cmd.sticky),d=e,["KILL","TIME","NONE"].indexOf(t)!=-1)""!==a&&(d+="^"+a);else{var f=Object.keys(u.style);if(0!=f.length){for(var m=0;m<f.length;m++)f[m]+=":"+u.style[f[m]];d+="^"+f.join(";")}}if(f=Object.keys(u.cmd),0!=f.length){for(var m=0;m<f.length;m++)u.cmd[f[m]]===!1&&(f[m]+=":false");d+="!"+f.join(";")}d=d===e?"":d+"\n"}d=Tt.value.replace(s,",")+d,Tt.value=d.replace(/,,+/g,",").replace(/^,/g,"").replace(/\n,/g,"\n").replace(/\n\n+/g,"\n").replace(/^\n/,""),o.attr=!0}}else if(0!=Et.length){o.watch=xt.value!==Et[Et.length-1],o.attr=Tt.value!==Et[Et.length-2],o.ex=Nt.value!==Et[Et.length-3],xt.value=Et.pop(),Tt.value=Et.pop(),Nt.value=Et.pop();var h=Et.pop();o.name=h[0]}if("DELETE"===t){if(null===a)return o;for(;0!=a.length;){var b=a.shift(),v=g(b,t,null,n,r);o.watch|=v.watch,o.ex|=v.ex,o.attr|=v.attr}}return o.watch&&pref_func.apply_prep(xt,!0),o.ex&&pref_func.apply_prep(Nt,!0),o.attr&&pref_func.apply_prep(Tt,!0),"UNDO"!==t||!o.watch&&"KILL"!==h[1]||We[o.name]&&(site2.DEFAULT.check_reply.set_watch_time(We[o.name][19],A(o.name,We[o.name][8][1],null,!0),o.name),bt.scan_init("triage_undo",[o.name],{refresh:!0,priority:8})),o}function b(e,t,a,n){pref.test_mode[7]||pref.test_mode[8]||(pref.test_mode[9]||(pref.test_mode[10]||(pref.test_mode[11]||a.fileinfo||site2[t].remove_files_info(e),pref.test_mode[12]||pref[p].t2h_num_of_posts>=0&&site2[t].remove_posts(e,a.posts?pref[p].t2h_num_of_posts:0),pref.test_mode[13]||a.contents&&site2[t].format_thread_contents(e)),a.layout&&site2[t].format_thread_layout(e),a.style&&site2[t].format_thread_style(e),site2[t].format_thread_always(e)),pref[p].localtime&&site2[t].localtime(e))}function v(e,t,a,n){var r=te(n,pref[p].mark_new_posts,pref[p].mark_new_posts,pref[p].mark_new_posts);r>0&&site2[t].mark_newer_posts(e,r),pref[p].format.thumb.resize&&site2[t].format_remove_tn_area_size(e)}function y(){this.removeEventListener("load",common_func.image_resize1_onload,!1),common_func.image_resize(this,pref.catalog_size_tn1_width,pref.catalog_size_tn1_height)}function k(){this.removeEventListener("load",common_func.image_resize2_onload,!1),common_func.image_resize(this,pref.catalog_size_tn2_width,pref.catalog_size_tn2_height)}function w(e,t,a,n){var t=t,r=e.key;pref.test_mode[28]||site2[e.domain].preprocess_doc&&!n&&site2[e.domain].preprocess_doc(e.pn),pref.test_mode[26]&&(n||"html"!==e.type_data||(e.pn=document.adoptNode(e.pn))),pref.test_mode[27]&&(n||"html"!==e.type_data||(e.pn=document.importNode(e.pn,!0)));var o=!1,s=We[r],i=[e.time_bumped,e.time_created,e.nof_posts,e.nof_files,e.time_posted];s&&s[16].needs_update&&(s[16].needs_update===!0?(s[7]&&(e.page=s[7].page),Be(r),s=void 0):delete s[16].needs_update),void 0==s&&(pref.test_mode[19]&&e.parse_funcs_html.th_init&&e.parse_funcs_html.th_init(e),o=!0,We[r]=[!!n&&e.pn,n,"page"===p?[Bt.thread_in,null]:[E,B],null,e.posts?e.posts:{sub:e.sub,com:e.com,name:e.name,trip:e.trip,filename:e.filename},[],null,null,i,[!0,0,!0,0],null,null,null,t,e.page,0,{dbt:common_func.name2domainboardthread(r,!0),parse_funcs:e.parse_funcs,systemSticky:e.sticky,type_html:e.type_html,domain_html:e.domain_html,parse_funcs_html:e.parse_funcs_html,icon_sticky:null,icon_show_always:null,show_always:null,th:e,__proto__:Lt},null,e.type_html,null,e.sticky,!1,{},null,null,null],s=We[r],s[17]=liveTag.prep_tags(e),s[19]=liveTag.mems[e.domain][e.board][e.no][2],"catalog"===p&&e.domain===site.nickname||!("KC"===e.domain&&"catalog"===e.type_source||e.posts[0].editing)||(s[16].needs_update=!0,"catalog"===e.type_source&&scan.list_nup.add(e.key))),e.parse_funcs.posts_full&&e.parse_funcs.posts_full(e),i[0]||(i[0]=s[8][0]),i[4]||(i[4]=s[8][4]<i[0]?i[0]:s[8][4]?s[8][4]:site2[e.domain].check_reply.get_checked_time(s[19])),s[8]=i,8388608==(8650752&s[19][0])&&(i[1]>0||i[4]>0)&&x(r,p,i[1],i[4],e,s[19]);var l="catalog"===p&&"no"===pref[p].t2h_sel&&e.parse_funcs.has_posts&&pref.catalog.filter.kwd.posts_active&&e.posts&&("sr"===pref[p].popup2||"srpv"===pref[p].popup2&&Vt.kwd(pref.catalog.filter.kwd,e.posts,e.domain,e));l&&(e.posts=Vt.kwd_make_result(e.posts,e.domain,e),e.posts&&(e.posts[0].__proto__.search_result=e.posts[0].search_result,e.posts[0]=e.posts[0].__proto__)),o&&s[0]&&(We[r][16].posts=e.posts),("page"===e.type_source||"4chan"===e.domain&&"catalog_json"===e.type_parse)&&(We[r][16].t2h_page=e.posts.length-1);var c=Ct.get_t2h_num_of_posts(s,e.type_source);return c!==!1&&o&&(c<0||c+1>e.posts.length)&&e.posts.length<e.nof_posts&&"page"===p&&(We[r][16].expand_posts=!0,scan.list_nup.add_scan(e.key)),!e.parse_funcs.has_posts||!pref.test_mode[49]&&l||(c!==!1&&(s[16].th&&(e.posts=site2[e.domain].update_posts_replace_prep(e.posts,s[16].th.posts,c)),s[16].posts&&(e.posts=site2[e.domain].update_posts_replace_prep(e.posts,s[16].posts,c))),!pref.test_mode[64]&&pref[p].deleted_posts.merge&&e.lth.pd&&(e.posts=site2[e.domain].update_posts_merge_prep(e.posts,e.lth.pd,c===!1?e.posts.length-1:c+("unread"===c||"N_unread"===c?e.lth.pd.length:0),!0))),!e.page&&s[16].th&&(e.page=s[16].th.page),!o&&e.parse_funcs.has_posts&&(s[16].th=e),(pref.test_mode[49]||"no"===pref[p].t2h_sel)&&!site2[site.nickname].historyAPI||s[7]&&!e.parse_funcs.has_posts||(s[7]=e),"no"===pref[p].t2h_sel&&(e.posts=e.posts.slice(0,1)),e.lth.th=e,We[r][9][2]=null,s[9]=me(r,!0),_e(e.key,s[0]),(n||s[16].expand_posts&&s[1]&&!pref.catalog.filter.kwd.posts_active||pref.test_mode[36])&&N(s,o,n,null,e),"meguca"===e.domain&&s[16].needs_update!==!0&&(e.lth.ed_p||s[16].needs_update<e.replyTime||null===s[16].needs_update)&&(s[16].needs_update=!e.lth.ed_p||e.posts[1]&&e.posts[1].no<=e.lth.ed_p[0]?e.replyTime:null),O(r)}function x(e,t,a,n,r,o){var s=A(e,a,n,!0);s>0?site2.DEFAULT.check_reply.set_watch_time(o,s,e):0===s&&"thread"===t&&pref.catalog.auto_watch?site2.DEFAULT.check_reply.set_watched_to_last(o,n||a,e):site2.DEFAULT.check_reply.set_unwatch(o)}function N(e,t,a,n,r){var r=e[16].th||r;Ct.prepare_html_prep_posts(r),(t||"page"===p||"thread"===p)&&Ct.prepare_html(r,t),t&&T(e,t,a,n,r),e[0]&&j(r,r.key,t,a),e[16].th=null}function T(e,t,a,n,r){if(t){var o=e[0];e[3]=[o.innerHTML,r.domain],o.name=r.key,("float"===p||r.domain!==site.nickname&&!pref.catalog.mimic_base_site)&&(o.style.width=("text"===pref.catalog.text_mode.mode?pref.catalog_size_text_width:pref.catalog_size_width)+"px",o.style.height=("text"===pref.catalog.text_mode.mode?pref.catalog_size_text_height:pref.catalog_size_height)+"px",o.style.float="left",o.style.overflow="hidden"),o.style||(o.style={}),e[0].addEventListener("mouseover",e[2][0],!1),common_func.dom_addEventListener(e[5],r.pn,"click",Q),common_func.dom_addAttribute(r.pn,"class",pref.script_prefix+"_thread");var s=r.parse_funcs_html.tn_as(r);if("page"!==p&&"thread"!==p)for(var i=0;i<s.length;i++)s[i].onclick=J,common_func.dom_addAttribute(s[i],"class",pref.script_prefix+"_thumbnail");var l=r.parse_funcs_html.tn_imgs(r);if(pref[p].format.thumb.resize)for(var i=0;i<l.length;i++)l[i].addEventListener("load",0==i?y:k,!1);if(e[20]===!0&&(e[16].icon_sticky=a?site2[r.domain_html].get_icon(e[0],r.type_html,"sticky",e[16]):site2[r.domain_html].add_icon(e[0],r.type_html,"sticky",e[16])),_e(r.key,e[0]),"float"===p&&"text"===pref.catalog.text_mode.mode){var c=document.createElement("span");c.innerHTML=(pref.catalog.text_mode.sub&&r.sub?"&emsp;"+r.sub:"")+(pref.catalog.text_mode.name&&r.name?"&emsp;"+r.name:"")+(pref.catalog.text_mode.com&&r.com?"&emsp;"+r.com:"");var _=r.footer,d=document.createElement("span");d.innerHTML=_.innerHTML,r.footer=d,r.pn.innerHTML="",r.pn.appendChild(r.footer),r.pn.appendChild(c),e[18]="text"}e[24]=L(r,e[24])}}function j(e,t,a,n,r){site2.DEFAULT.check_reply.set_own_posts(e);var o;if(a||n&&"meguca"===site.nickname){if("page"===e.type_html||"thread"===e.type_html){var s=e.parse_funcs_html.get_thread_links(e.pn?e:{pn:We[t][0],__proto__:e});if(s)for(var i=0;i<s.length;i++)s[i].onclick=Z}if("page"===p||"thread"==p?o=Ct.update_posts_in_page(e,t,!0):(We[t][16].posts=e.posts,o=e.posts),n&&"page"===p&&pref[p].use_expander_always&&site2[e.domain_html].page_json2html3_replace_expander(e.posts,Ct.get_t2h_index(We[t]),t),"page"===e.type_html||"thread"===e.type_html)for(var l=n?{colorID:pref[p].colorID&&!pref[p].env.colorID_native,backlink:pref[p].backlink&&!pref[p].env.backlink_native,localtime:pref[p].localtime&&!pref[p].env.localtime_native}:pref[p],i=0;i<e.posts.length;i++)Ct.prepare_html_post(e,e.posts[i],e.tags.q,l)}else"KC"===e.domain&&"page"===p&&pref[p].use_expander_always&&site2[e.domain_html].page_json2html3_replace_expander(e.posts,Ct.get_t2h_index(We[t]),t),"page"!==p&&"thread"!==p||!pref.catalog_expand_at_initial_embed&&!pref.catalog_expand_at_initial||e.parse_funcs.has_posts&&(o=Ct.update_posts_in_page(e,t)),"catalog"!==e.type_source&&"float"===p&&(We[t][3][0]=e.pn.innerHTML);var c=a?0:1;if("page"==p&&"json"===e.type_data){e.domain_html=site.nickname,e.parse_funcs_html=site2[e.domain_html].parse_funcs.page_html;for(var i=c;i<e.posts.length;i++)e.posts[i].pn||(e.posts[i].pn=site2[e.domain_html].post_json2html(e.posts[i],e.board));for(var i=c;i<e.posts.length;i++)e.posts[i].tn_imgs=e.parse_funcs_html.tn_imgs(e.posts[i]);o=e.posts.slice(c)}if(o&&("page"===p||"thread"===p)){var _=!pref[p].env.expand_thumbnail_inline_native||!n||pref[p].expand_thumbnail_inline_all_after&&pref[p].env.event_dynamic,d=pref[p].expand_thumbnail_initial,u=pref[p].thumbnail.inline.ondemand;if(_||d)for(var f=0;f<o.length;f++){var m=e.parse_funcs_html.tn_imgs(o[f]);if(m)for(var i=0;i<m.length;i++)m[i].onclick=q,d&&(u?(K(m[i]),d=!1):q.call(m[i],null,!0))}}if(o&&("catalog"===p&&a||"page"===p||"thread"===p)&&(pref[p].image_prefetch||pref[p].image_hover&&(!pref[p].env.image_hover_native||!n)))if(!e.parse_funcs.has_posts||"page"!==p&&"thread"!==p){if(a&&!e.parse_funcs_html.dynamic_image_hover)for(var m=e.parse_funcs_html.tn_imgs(e),i=0;i<m.length;i++)m[i].onmouseover=U}else for(var f=0;f<o.length;f++){var m=e.parse_funcs_html.tn_imgs(o[f]);if(m)for(var i=0;i<m.length;i++)m[i].onmouseover=U}("page"===p||"thread"===p)&&pref[p].popup&&site2[e.domain].popups_add&&"catalog"!==e.type_html&&site2[e.domain].popups_add(We[t][16],e,!(n&&pref[p].env.popup_native||pref[p].env.event_dynamic&&site.nickname===e.domain)),pref.catalog.filter.kwd.post&&e.posts&&(We[t][4]=e.posts),pref[p].hide_posts_without_images&&Ct.hide_posts_without_images(e,t),"catalog"!==p&&Ct.update_draw(t,We[t][0],We[t][16])}function A(e,t,a,n){var r=te(e,pref.catalog.filter.time_watch||pref.catalog.filter.time_watch_creation,!0,!0,n);return n&&r<0?-r:a&&r>a?0:!pref.catalog.filter.time_watch&&pref.catalog.filter.time_watch_creation&&r>t?0:r}function E(e){ye(e,this.name),Bt.thread_in(e)}function B(e){ye(e,this.name)}function L(e,t){var a=e.footer;a.classList.add(pref.script_prefix+"_footer"),e.parse_funcs_html.footer_clear(e);var n=a.innerHTML.replace(/ *R:[0-9 \/]*I:[0-9 \/]*/,"");if(n=n.replace(/P:[0-9 \/]*/,""),n=n.replace(/ *\(sticky\) */,""),""!==n&&(a.innerHTML="<span></span>"+n,a=a.childNodes[0]),pref[p].footer.br){var r=a.getAttribute("style");r=(r?r+";":"")+"clear:both",a.setAttribute("style",r)}return t?[a,e.flags,t[2],t[3],7]:[a,e.flags,null,null,7]}function C(e,t,a,n,r){var o=We[e][24];if(o&&o[0]){var s=liveTag.mems.getFromName(e),i=We[e][8];a?o[2]=a:a=o[2]||"?";var l=(pref.catalog_footer_show_nof_rep_to_me?s.nrtm+"/":"")+s.nr,c=pref.catalog.footer.nl&&s.ta&&s.ta.posts?s.ta.posts.length+"/":"",_=pref.catalog.footer.nd&&s.pd?"+"+s.pd.length:"",d=(pref.catalog.footer.archived&&s.archived?"A ":"")+("native"===pref.catalog_footer_design?(pref.catalog_footer_show_nof_rep&&s.watched?"U: "+l+" / ":"")+"R: "+c+(i[2]-1)+_+" / I: "+i[3]+(pref.catalog_footer_show_page?" / P: "+a:""):(pref.catalog_footer_show_nof_rep&&s.watched?l+"/":"")+c+i[2]+_+"/"+i[3]+(pref.catalog_footer_show_page?"/"+a:""));if(d&&(d+="&emsp;"),pref.catalog.footer.ctime||pref.catalog.footer.btime||pref.catalog.footer.ptime){var u=new RegExp((new Date).toLocaleDateString(),"g");pref.catalog.footer.ctime&&(d+=new Date(i[1]).toLocaleString().replace(u,"")+"&emsp;"),pref.catalog.footer.btime&&i[0]&&(d+=new Date(i[0]).toLocaleString().replace(u,"")+"&emsp;"),pref.catalog.footer.ptime&&i[4]&&(d+=new Date(i[4]).toLocaleString().replace(u,"")+"&emsp;")}if(pref.catalog.footer.prate&&(d+=Math.floor(i[2]/((Date.now()-i[1])/864e5))+"&emsp;"),pref.catalog_footer_show_board_name||pref.catalog_footer_show_thread_no||pref.catalog_footer_show_site_name){var f=common_func.name2domainboardthread(e,!0);d+=(pref.catalog_footer_show_site_name?f[0]:"")+(pref.catalog_footer_show_board_name?f[1]:"")+(pref.catalog_footer_show_thread_no?f[2]:"")}if(o[0].innerHTML=pref.catalog_footer?d:"",pref.catalog_footer&&pref.catalog_footer_show_tag){if(o[3]||(o[3]=document.createElement("span"),o[3].innerHTML="<span></span><span></span>"),n)for(var m=0;m<2;m++){var h=liveTag.update_tag_string(n[m],", ",liveTag.tag_node_onclick);o[3].removeChild(o[3].childNodes[m]),o[3].insertBefore(h,o[3].childNodes[m]||null)}o[3].parentNode!==o[0]&&o[0].appendChild(o[3])}if(pref.catalog_footer_show_flag&&(t||o[1])&&pref.catalog_footer&&pref[p].t2h_num_of_posts>=0){t?o[1]=t:t=o[1];var m=t.length-pref[p].t2h_num_of_posts;for(m<1&&(m=1),t[0]&&o[0].appendChild(t[0]);m<t.length;)t[m]&&o[0].appendChild(t[m]),m++}o[4]=0}}function I(){for(var e in We)C(e)}function S(){for(var e=[],t=0;t<Pe.length;t++)"ODL:"===Pe[t].substr(0,4)&&(e[e.length]=Pe[t]);Pe=[];for(var t in We)St.insert(t);for(var t=0;t<e.length;t++)Pe[Pe.length]=e[t];Ht=0,Kt()}function O(e){var t=Pe.indexOf(e);t!=-1&&Pe.splice(t,1);var a=St.insert(e);return a===t&&"page"!==p||!(a<Ht||t<Ht)?"page"===p&&Ht===!0&&(Ht=0):Ht=0,a!==t||We[e]&&We[e][9][0]!=We[e][1]}function D(e){""==We[e][0].style.width?(pref.catalog_expand_with_hr&&"catalog"!==p&&pe(e,"shrink"),We[e][0].style.width=pref.catalog_size_width+"px",We[e][0].style.height=pref.catalog_size_height+"px"):(We[e][0].style.width="",We[e][0].style.height="",pref.catalog_expand_with_hr&&"catalog"!==p&&pe(e,"add"))}function z(e,t){var a=F(e,"hover",null,t);if(a)return a.style.position="fixed",a.style.top="0px",a.style.right="0px",a.style.pointerEvents="none",a}function U(e,t){if(pref[p].image_hover){var a,n=Dt&&Dt[1]===this;if(n)a=Dt[0],a.style.display="",Dt=null;else if(!(a=z(this,t)))return;a.style.zIndex=pref[p].image_hover_zIndex,this.onmouseout=R,n||site.script_body.appendChild(a),e.preventDefault(),httpd.pause_req(),a.onload=httpd.pause_cancel,a.onerror=httpd.pause_cancel,Ot&&R(),Ot=a}if(Dt&&(Dt[0].parentNode.removeChild(Dt[0]),Dt=null),pref[p].image_prefetch){var r=(G(this),site2[site.nickname].get_next_image(this));if(r){var o=z(r);o.style.display="none",site.script_body.appendChild(o),Dt=[o,r]}}}function R(){Ot&&site.script_body.removeChild(Ot),Ot=null}function M(e){Ot&&Ot.src===e.src&&(Ot.src=H(e))}function H(e,t,a){var n=G(e);if(a||!pref[p].env.event_dynamic||void 0===t||("inline"===t?!pref[p].env.expand_thumbnail_inline_native:!pref[p].env.image_hover_native)){if(!n)return e.src;var r=pref.catalog.mimic_base_site?site.nickname:We[n][16].domain_html;if("catalog"!==p)return site2[r].parse_funcs.post_html.img2src(e)||e.src;var o=liveTag.mems.getFromName(n);return site2[o.domain].parse_funcs[o.th.type_parse].get_op_src(o.th,e)}}function F(e,t,a,n){var r=e.cloneNode();if(n||(n=H(e,t,a)),n){var o=0===n.search(/^blob/)?site2.DEFAULT.parse_funcs.post_html.img2ext(e):"";if(n.indexOf("data-ext")!=-1&&(o=n.slice(n.indexOf("data-ext")+10).replace(/".*/,""),n=n.replace(/".*/,"")),".webm"===n.substr(-5,5)||".webm"===o||".webm"===e.getAttribute("data-ext")){if(!pref[p].thumbnail[t].webm||a)return null;if(Ot&&Ot.src===n)r=Ot,Ot=null,r.style.position="",r.style.top="",r.style.right="",r.style.pointerEvents="";else{var r=document.createElement("video");r.controls=!0,r.autoplay=!0}pref.test_mode[63]||(r.loop=pref[p].thumbnail[t].webm_loop,r.muted=pref[p].thumbnail[t].webm_mute)}return r.src=n,r.style.width="auto",r.style.height="auto",pref[p].thumbnail[t].limit_width&&(r.style.maxWidth=window.innerWidth-pref[p].thumbnail[t].margin_width+"px"),pref[p].thumbnail[t].limit_height&&(r.style.maxHeight=window.innerHeight-pref[p].thumbnail[t].margin_height+"px"),r}}function q(e,t){if(pref[p].expand_thumbnail_inline&&Ut.indexOf(this)==-1){var a=F(this,"inline",t);if(!a)return void W.call(this);"VIDEO"!==a.tagName&&(a.style.display="none",a.addEventListener("load",X,!1),this.style.opacity=.5),this.parentNode.insertBefore(a,this.nextSibling),Ut.push(a),e&&e.preventDefault(),"VIDEO"===a.tagName&&(X.call(a),a.play())}}function X(){this.previousSibling.style.display="none",this.style.display="",this.previousSibling.style.opacity="",this.removeEventListener("load",X,!1),this.onclick=Y,site2[site.nickname].format_expanded_thumbnail&&site2[site.nickname].format_expanded_thumbnail(this);var e=Ut.indexOf(this);e>=0&&Ut.splice(e,1),site.patch.expand_thumbnail_inline_load&&site.patch.expand_thumbnail_inline_load.call(this),W.call(this)}function W(){if(pref[p].expand_thumbnail_inline&&(pref[p].expand_thumbnail_initial||pref[p].expand_thumbnail_inline_all_after)){var e=site2[site.nickname].get_next_image(this,se());e&&"none"!==e.style.display&&P(e)}}function P(e){var t,a=oe(pref[p].thumbnail.inline.ref_height/100);if(Array.isArray(e)){for(var n,r=se(),o=0;o<e.length;o++){var s=e[o].offsetTop;(s>=r&&s<t||0===o)&&(n=e[o],t=s)}e=n}else t=e.offsetTop;t<a||!pref[p].thumbnail.inline.ondemand?(zt=null,q.call(e,null,!0)):zt=e}function K(e){zt?Array.isArray(zt)?zt[zt.length]=e:zt=[zt,e]:zt=e,Ft()}function Y(e){if(this.previousSibling.style.display="",e.preventDefault(),this.getAttribute("data-originalWidth")){this.parentNode.parentNode.style.width=this.getAttribute("data-originalWidth")}this.parentNode.removeChild(this)}function G(e){for(;e&&!e.name;)e=e.parentNode;return e&&e.name}function J(e){"none"!==pref[p].click&&(e.preventDefault(),"entire"!==pref[p].click_area&&V(G(this),this.classList.contains(pref.script_prefix+"_link")?this.getAttribute("href"):null))}function Q(){"entire"===pref[p].click_area&&V(this.name)}function V(e,t){t?ae("force"===t?null:t,e):"open"===pref[p].click?ae(null,e):"catalog"!==We[e][18]&&"expand"===pref[p].click&&D(e)}function Z(e){e.preventDefault(),this.href&&ae(this.href,G(this))}function $(e,t){for(var a=0;a<t.length;a++){var n=t[a][0],r=t[a][1],o=function(){ae(r,e),"expand"===pref[p].click&&D(e)};n.addEventListener("click",o,!1),t[a][1]=o}return t}function ee(e){for(var t=0;t<e.length;t++)e[t][0].removeEventListener("click",e[t][1],!1);return null}function te(e,t,a,n,r){if(n){var o=pref_func.merge_obj5(e,pref.catalog.filter.watch_list_obj2,{hit:!1});if("time"in o)return r?-o.time:o.time}if(a){if("time"in(o=pref_func.merge_obj5(e,pref.catalog.filter.list_obj2,{hit:!1})))return o.time;if(o.hit)return 0}return t&&""!==pref.catalog.filter.time_str?Date.parse(pref.catalog.filter.time_str):0}function ae(e,t){var a=common_func.fullname2dbt(t);if(We[t][16].archiveFile)e=site2[pref.archive.open_local?site.nickname:a[0]].make_url4([site.nickname,site.board,"0","page_html"])[0];else if(null===e&&(e=site2[a[0]].make_url4(common_func.name2dbt(t))[0],"no"!==pref.catalog_open_last50)){var n=document.createElement("div");n.innerHTML=site2[a[0]].short_link(t,We[t][8][2],null,"","");for(var r=n.getElementsByTagName("a"),o=0;o<r.length;o++)if("exist"===pref.catalog_open_last50||!(786432&We[t][19][0])||parseInt(r[o].textContent,10)>(65535&We[t][19][1])){e=r[o].getAttribute("href");break}}var s=site.embed_frame_win?site.embed_frame:"named"===pref.catalog_open_where?t+(We[t][16].archiveFile?"A":""):"_blank"===pref.catalog_open_where?t+"_"+Date.now():pref.catalog_open_where,i=pref[p].mark_new_posts?A(t,We[t][8][1]):0,l=["MARK",i];if(site2[site.nickname].historyAPI&&site2[a[0]].historyAPI&&pref.pref2.meguca.historyAPI){if(site2[site.nickname].historyAPI_blocking)return;send_message_emu.push(l)}else{if(send_message(s,l,window.open(e,s)),We[t][16].archiveFile){var c=We[t][16].archiveFile;send_message(s,["ARCHIVER",["SUB_INIT","IDB"===c?{IDB:!0,domain:a[0],board:pref.test_mode[80]?a[1].slice(0,-5)+"/":a[1],no:a[2]}:{name:c.name,size:c.size,lastModified:c.lastModified,files_sel:pref.archive.files_sel}]])}}pref.catalog.auto_watch&&h(t,"WATCH","",!0)}function ne(e,t){t?site2.DEFAULT.check_reply.set_watched_to_last(We[e][19],We[e][8][4]||We[e][8][0],e):site2.DEFAULT.check_reply.set_unwatch(We[e][19]),pref.liveTag.style&&liveTag.update_ur(e,0,!0),C(e),pref.notify.favicon&&notifier.favicon.set(We)}function re(){qt=null,Ht!==!0?Kt():cataLog.catalog_obj2.lazy_draw&&cataLog.catalog_obj2.lazy_draw(),zt&&P(zt)}function oe(e){return e||(e=1.5),qt||(qt={scrollTop:At===window?brwsr.document_body.scrollTop:At.scrollTop,innerHeight:At===window?window.innerHeight:At.clientHeight}),qt.scrollTop+qt.innerHeight*e}function se(){return _?brwsr.document_body.scrollTop:ht.scrollTop}function ie(e){for(var t={posts:[],__proto__:e},a=0;a<e.posts.length;a++)t.posts[a]={__proto__:e.posts[a]};return t}function le(e,t,a,n){for(var r="drawn_idx:"+e+", drawn_y:"+t+", ref_count:"+a+" ",o=0;o<n.length;o++)We[n[o]]&&!We[n[o]][1]||(r+=n[o]+", ");return r+="::: "+JSON.stringify(n)}function ce(e){var t=ht.childNodes.length,a=pref.script_prefix+"_hs";return e<t&&ht.childNodes[e].className===a&&e++,e}function pe(e,t){if("catalog"!==p){var a=We[e][0],n=pref.script_prefix+"_hs";if("add"===t&&""===a.style.width&&""===a.style.height&&(a.previousSibling&&a.previousSibling.className!==n&&a.parentNode.insertBefore(site2[site.nickname].horizontal_separator_in_index(),a),a.nextSibling&&a.nextSibling.className!==n&&a.parentNode.insertBefore(site2[site.nickname].horizontal_separator_in_index(),a.nextSibling)),"shrink"===t||"remove"===t&&""===a.style.width&&""===a.style.height||"add"===t&&(""!==a.style.width||""!==a.style.height)){var r=a.previousSibling&&a.previousSibling.className===n?a.previousSibling.previousSibling:null;!r||""===r.style.width&&""===r.style.height||a.parentNode.removeChild(a.previousSibling);var r=a.nextSibling&&a.nextSibling.className===n?a.nextSibling.nextSibling:null;!r||""===r.style.width&&""===r.style.height||a.parentNode.removeChild(a.nextSibling)}"remove"===t&&a.previousSibling&&a.previousSibling.className===n&&a.nextSibling&&a.nextSibling.className===n&&a.parentNode.removeChild(a.nextSibling)}}function _e(e,t){var a=We[e],n=null;if(pref.catalog.filter.attr_list&&(pref.catalog.style_general_list&&(n=pref_func.merge_obj5(e,pref.catalog.style_general_list_obj2,n)),pref.catalog.filter.attr_list&&(n=pref_func.merge_obj5(e,pref.catalog.filter.attr_list_obj2,n))),a[0]){var r=a[22];if(n&&n.style)for(var o in n.style)o in r||(r[o]=t.style[o]),t.style[o]=n.style[o];for(var o in r)n&&n.style&&o in n.style||(void 0===r[o]?delete t.style[o]:t.style[o]=r[o],delete r[o])}if(n&&n.cmd||a[16].icon_sticky||a[16].icon_show_always||a[16].systemSticky){var s=!!(n&&n.cmd&&void 0!==n.cmd.sticky?n.cmd.sticky:a[16].systemSticky);s^a[20]&&(a[20]=s,a[20]!=a[16].icon_sticky&&(a[16].icon_sticky=site2[site.nickname].add_icon(a[0],a[16].type_html,"sticky",a[16]))),(n&&n.cmd&&n.cmd.show)^!!a[16].icon_show_always&&(a[16].icon_show_always=site2[site.nickname].add_icon(a[0],a[16].type_html,"show_always",a[16]),a[16].show_always=n.cmd.show,a[9]=me(e),Kt&&Kt(e))}}function de(e,t,a){t.str_old="",t.fail_list={},t.suc_list={},ue(e,t,a)}function ue(e,t,a){t||(t=pref.catalog.filter.kwd),t.kwds=common_func.kwd_prep_regexp(t),fe(e,t,a)}function fe(e,t,a){t||(t=pref.catalog.filter.kwd);var n=t.posts_active,r=t.use&&0!==t.kwds.length&&(t.sub||t.name||t.com||t.file||t.meta);if(t.active=r&&(t.op||t.post),t.posts_active=r&&t.post,a||t.posts_active||!n||Ct.posts_search_inactivated(),t.timestamp=Qt++,!pref.test_mode[59]){if(!e||"catalog.filter.kwd.str"!==e.target.name||0!==t.match||t.re&&!/^[\w\s]*$/.test(t.str))t.fail_list={},t.suc_list={};else{for(var o in t.fail_list)0!==t.str.indexOf(t.fail_list[o])?delete t.fail_list[o]:t.fail_list[o]===t.str&&(t.timestamp=o);for(var o in t.suc_list)0!==t.suc_list[o].indexOf(t.str)?delete t.suc_list[o]:t.suc_list[o]===t.str&&(t.timestamp=o)}t.str&&(t.fail_list[t.timestamp]=t.str,t.suc_list[t.timestamp]=t.str)}a||be()}function me(e,t){var a=We[e],n=a[9][0];return a[9][0]=he(e,a),t||n===a[9][0]||(Ht=0),a[9]}function he(e,t){if(t[16].show_always&&!pref.catalog.filter.kwd.active)return!0;if(pref.catalog.filter.tag&&!liveTag.search_by_tags(t[17]))return!1;if(pref.catalog.filter.time&&(t[8][4]||t[8][0])<=pref3.catalog.filter.time_obj)return!1;if(pref.catalog.filter.time_creation&&t[8][1]<=pref3.catalog.filter.time_obj)return!1;if(pref.catalog.filter.list&&(!pref.catalog.filter.kwd.active||!pref.filter.disable_list_when_kwd_active)){var a=ge(e);if(a[0]===!1)return t[9]=a,t[9][0]}if(pref.catalog.filter.kwd.active){var n=pref.catalog.filter.kwd.post&&"no"!==pref[p].t2h_sel&&t[16].th&&t[16].th.posts||t[4];if(pref.test_mode[59]){if(!Vt.kwd(pref.catalog.filter.kwd,n,common_func.fullname2dbt(e)[0]))return!1}else if(pref.catalog.filter.kwd.fail_list[t[9][3]]&&t[9][2]===!1||pref.catalog.filter.kwd.suc_list[t[9][3]]&&t[9][2]===!0?pref.debug_mode[18]&&t[9][2]!==Vt.kwd(pref.catalog.filter.kwd,n,common_func.fullname2dbt(e)[0])&&console.log("BUG, test59, "+e):(t[9][3]=pref.catalog.filter.kwd.timestamp,t[9][2]=Vt.kwd(pref.catalog.filter.kwd,n,common_func.fullname2dbt(e)[0])),!t[9][2])return!1}return!0}function ge(e){var t=pref_func.merge_obj5(e,pref.catalog.filter.list_obj2,{hit:!1});return t.time?[!pref.catalog.filter.list||t.time<(We[e][8][4]||We[e][8][0]),t.time]:t.hit?[!pref.catalog.filter.list]:[!0]}function be(){if(pref.test_mode[60])if(pref.catalog.filter.kwd.use||pref.catalog.filter.tag||pref.catalog.filter.time||pref.catalog.filter.list)for(var e in We)We[e][9]=me(e);else{for(var e in We)We[e][9][0]=!0;Ht=0}else{var t=!(pref.catalog.filter.kwd.use||pref.catalog.filter.tag||pref.catalog.filter.time||pref.catalog.filter.list)||null;for(var e in We)We[e][9][0]=t;Ht=0}Kt&&Kt()}function ve(){pref_func.apply_prep(Tt,!0);for(var e in We)_e(e,We[e][0])}function ye(e,t){"no"!==pref[p].popup2&&("imm"==pref.catalog_popdown||Ke[t]?ke(e,t):(Zt[t]?clearTimeout(Zt[t]):(We[t][0].addEventListener("mousemove",We[t][2][1]),We[t][6]=function(){clearTimeout(Zt[t])},We[t][0].addEventListener("mouseout",We[t][6])),Zt[t]=setTimeout(function(){ke(e,t)},pref.catalog_popup_delay)))}function ke(e,t){if(Ke[t])return void we(t);var a=We[t][0];Zt[t]&&(a.removeEventListener("mousemove",We[t][2][1]),a.removeEventListener("mouseout",We[t][6]),delete Zt[t]);var n=We[t][7]||We[t][16];if(!pref.test_mode[49]&&pref.catalog.filter.kwd.posts_active&&n)var r="sr"===pref[p].popup2||"srpv"===pref[p].popup2?Vt.kwd_make_result(n.posts,n.domain,n):null;if("sr"!==pref[p].popup2||r){var o=cnst.init("pop:border:1px solid blue");if(document.documentElement.clientWidth/2-e.clientX>0?o.style.left=e.clientX+10+"px":o.style.right=document.documentElement.clientWidth-e.clientX+10+"px",document.documentElement.clientHeight/2-e.clientY>0?o.style.top=e.clientY+10+"px":o.style.bottom=document.documentElement.clientHeight-e.clientY+10+"px","chart"!==pref[p].popup2)if(pref.test_mode[49]){o.innerHTML=We[t][3][0],b(o,We[t][3][1],pref[p].format.hover,t),v(o,We[t][3][1],pref[p].format.hover,t);var s=t.replace(/\/.*/,""),i=te(t,pref[p].mark_new_posts,pref[p].mark_new_posts,pref[p].mark_new_posts);i>0&&site2[s].mark_newer_posts(o,i),We[t][12]=$(t,site2[s].modify_thread_link(o)),_e(t,o)}else{if(n){var l=n.lth;n="dp"===pref[p].popup2?{posts:[{search_result:!1,__proto__:n.posts[0]}].concat(l&&l.pd||[]),__proto__:n}:"pv"!==pref[p].popup2&&r&&{posts:r,__proto__:n}||n,Ct.prepare_html_prep_posts(n);var c=site2[site.nickname].page_json2html3(n,n.board,n.op_img_url,!0);site2.DEFAULT.check_reply.set_own_posts(n);for(var _=0;_<n.posts.length;_++)site2[n.domain_html].format_pn(n.posts[_].pn,l&&l.q&&l.q[n.posts[_].no],null,n.posts[_]);pref[p].mark_new_posts&&Ct.update_draw(n.key,c,n)}else c=document.createTextNode("You must be set to store posts at least 1, see 'Catalog' tab in settings.");o.appendChild(c),_e(t,o.childNodes[0])}o=site.root_body.appendChild(o),pref.catalog_popup_size_fix&&(o.style.width=o.offsetWidth+"px",o.style.height=o.offsetHeight+"px"),Ke[t]=[null,function(){xe(t)},function(){we(t)},a,o],"chart"===pref[p].popup2&&(chart_obj&&pref3.stats.use?Ke[t][5]=new chart_obj.PostChart(o,[t]):o.innerHTML="Statistics needs to be activated."),"imm"==pref.catalog_popdown?document.documentElement.clientHeight/2-e.clientY>0?parseInt(o.style.top.replace(/px/,""),10)+o.offsetHeight>document.documentElement.clientHeight&&(o.offsetHeight>document.documentElement.clientHeight?o.style.top="0px":(o.style.top="",o.style.bottom="0px")):parseInt(o.style.bottom.replace(/px/,""),10)+o.offsetHeight>document.documentElement.clientHeight&&(o.style.bottom="",o.style.top="0px"):(o.addEventListener("mouseover",Ke[t][2],!1),o.addEventListener("mouseout",Ke[t][1],!1)),a.addEventListener("mouseout",Ke[t][1],!1)}}function we(e){Ke[e][0]&&(clearTimeout(Ke[e][0]),Ke[e][0]=null)}function xe(e){Ke[e][0]||(Ke[e][0]=setTimeout(function(){Ne(e)},"imm"==pref.catalog_popdown?0:pref.catalog_popdown_delay))}function Ne(e){Ke[e][5]&&Ke[e][5].destroy(),ch=Ke[e][3],pn=Ke[e][4],ch.removeEventListener("mouseout",Ke[e][1],!1),"imm"!=pref.catalog_popdown&&(pn.removeEventListener("mouseover",Ke[e][2],!1),pn.removeEventListener("mouseout",Ke[e][1],!1)),We[e][12]&&(We[e][12]=ee(We[e][12])),pn=cnst.div_destroy(pn,!0),delete Ke[e]}function Te(e,t){var a=pref.catalog_board_list_obj[t]&&pref.catalog_board_list_obj[t][0].tags||null;return a?liveTag.tags_reserved_init(a,e):null}function je(e,t,a){var n=[],r={};"boards"===site.whereami&&0==e&&pref_func.str2obj("catalog_board_list_str");var o=pref.catalog_board_list_obj[e].slice(),s=o[0].domains_for_all_boards;if(s){for(var i=0;i<s.length;i++){var l=s[i];if(!site3[l].boards)return function(e){site2[l].get_boards_json("refresh_boards_json",e,!1,st)}}for(var i=0;i<s.length;i++)if(a&&site2[s[i]].utilize_boards_json&&pref.pref2[s[i]].utilize_boards_json&&pref.pref2[s[i]].utilize_boards_json_domain)r[s[i]]=null;else for(var c in liveTag.mems[s[i]])o[o.length]=liveTag.mems[s[i]][c]}var p=Te(!0,e);for(var _ in p){for(var c=1;c<o.length&&o[c].key!==_;c++);c==o.length&&(o[o.length]=liveTag.mems.getFromName(_))}t&&(n=t.replace(/\s*\/\/.*$/gm,",").replace(/\n/g,",").replace(/,,+/g,",").replace(/^,/,"").replace(/,$/,"").split(",")),""===n[0]&&(n=[]);for(var c=0;o.length>1;){for(var i=1;i<o.length;i++){var d=o[i].key.replace(/\s/g,""),u=cnst.name2domainboardthread(d,!0),f="auto"===pref.catalog_max_page_select&&liveTag.mems[u[0]]&&liveTag.mems[u[0]][u[1]]&&liveTag.mems[u[0]][u[1]].pgs||pref.catalog_max_page;u[2]?0==c?n.push(d):o.splice(i--,1):(!o[i].max_page||c<o[i].max_page)&&c<f?n.push(d+(pref.catalog.catalog_json?"q":"p")+c):o.splice(i--,1)}c++}return{tgts:n,tgt_domains:r}}function Ae(e,t,a){if(pref.catalog.board.ex_list)for(var n=e.length-1;n>=0;n--){var r=pref_func.merge_obj5(e[n],pref.catalog.board.ex_list_obj2,{hit:!1});r.hit&&e.splice(n,1)}if("catalog"===pref.catalog.design||"auto"===pref.catalog.design&&"catalog"===a||"chart"===a)for(var n=e.length-1;n>=0;n--){var o=cnst.name2domainboardthread(e[n],!0);"no"===site2[o[0]].trim_list&&"chart"!==a||e[n].search(/\/[pq][0-9]*/)==-1||(e[n].search(/\/[pq]0$/)==-1||t&&o[1]==site.board&&o[0]==site.nickname&&"force_init"!==site2[o[0]].trim_list&&!pref3.stats.use?e[n].search(/\/[pq][0-9]$/)!=-1&&e.splice(n,1):e[n]=e[n].replace(/[pq]0/,pref.catalog.catalog_json||"force_init"===site2[o[0]].trim_list?"j0":"c0"))}if("page"===a&&t){if(pref.liveTag.use){for(var s={},n=0;n<e.length;n++){var o=cnst.name2domainboardthread(e[n],!0);s[o[0]+o[1]+(pref.catalog.catalog_json?"j0":"c0")]=null}for(var n in s)e[e.length]=n}e[0]&&0===e[0].search(site.nickname+site.board+"[pq]0")&&e.splice(0,1),pref[a].load_on_demand&&(Ht=0)}
"thread"===a&&0===at.selectedIndex&&(t?e.splice(0,1):e=[site.nickname+site.board+site.no]);for(var n=e.length-1;n>=0;n--){var o=common_func.name2dbt(e[n]),i=site2[o[0]].make_url4(o,"page"!==pref.catalog.design&&(0!==pref.catalog.indexing||"none"!==pref.liveTag.from));i?i[2]&&i[2]!==e[n]&&(e.indexOf(i[2])!=-1?e.splice(n,1):e[n]=i[2]):e.splice(n,1)}return e}function Ee(e){We[e][0]&&We[e][0].removeEventListener("mouseover",We[e][2][0],!1),common_func.dom_removeEventListener(We[e][5]),We[e][11]&&(We[e][11]=ee(We[e][11]))}function Be(e,t){var a=Pe.indexOf(e);if("ODL:"!==e.substr(0,4)){if(!We[e])return;var n=common_func.fullname2dbt(e),r=liveTag.mems.getFromName(e);if(!t&&We[e][16].popups)for(var o in We[e][16].popups)site2[n[0]].popups_release(r.q,o,e);Ee(e),We[e][1]&&(Ke[e]&&Ne(e),We[e][0]&&We[e][0].parentNode===ht&&Pt.func_hide(e),site2.DEFAULT.update_posts_merge_bases.remove_th(We[e][16],!0),a<Ht&&(Ht=0))}if(t)return We[e][0]=!1,We[e][1]=!1,We[e][16].th=We[e][7],We[e][16].posts=null,void(We[e][24]&&(We[e][24][0]=null));delete We[e],pref.debug_mode[2]&&console.log("removed: "+e),a>=0&&Pe.splice(a,1)}function Le(e,t){if(null!==$t){for(var a in $t)We[a]&&$t[a]===(We[a][8][0]>We[a][8][4]?We[a][8][0]:We[a][8][4]||We[a][8][0])&&Be(a);$t=null}}function Ce(e,t){for(var a=0;a<Pe.length&&a<e;)"ODL:"===Pe[a++].substr(0,4)&&e++;if(t)for(null===$t&&($t={});Pe.length>e;){var n=Pe[e++];"ODL:"===n.substr(0,4)?(Be(n),e--):$t[n]=We[n][8][0]>We[n][8][4]?We[n][8][0]:We[n][8][4]||We[n][8][0]}else for(Bt.off_delay();Pe.length>e;){var n=Pe[Pe.length-1];Be(n)}}function Ie(e,t,a,n){pref.test_mode[67]||t||archiver.refresh_start(),n||t||!pref.catalog.auto_save_filter_at_refresh||ft.save();var r=Se(p,e,t,a,"refresh",at.selectedIndex,pref.catalog.filter.bookmark_list_str,!1,void 0,n);"function"==typeof r&&r(function(){Ie(e,t,a)})}function Se(e,t,a,n,r,o,s,i,l,c){var p=je(o,s,t);if("function"==typeof p)return p;var _=p.tgts;if(i)for(var d={},u=0;u<_.length;u++){var f=common_func.name2domainboardthread(_[u],!0);f[2][0].search(/^[pqcj]/)!=-1?d[f[0]+f[1]]=null:d[f[0]+f[1]+f[2].replace(/^t/,"")]=null}r&&pref3.stats.use&&pref.stats.auto_acquisition_all&&stats.register_auto_acquisition(o),_=Ae(_,a,e);var m=t?n?2:4:0;return 0===_.length?t?scan.scan_refresh(st,_,m,p.tgt_domains):_:(t&&(Le(),pref.catalog_refresh_clear&&!a&&Ce(pref.catalog.max_threads_at_refresh,!0)),r&&bt.scan_init(r,_,{refresh:t,callback:function(){scan.scan_refresh(st,_,m,p.tgt_domains),l&&l()},from_auto:n,load_on_demand:pref[e].load_on_demand,priority:m}),i?Object.keys(d):_)}function Oe(){if((pref.notify.favicon||pref.notify.title.notify)&&notifier.favicon.set(We),pref.debug_mode[3]){var e=0;for(var t in liveTag.mems)for(var a in liveTag.mems[t])for(var n in liveTag.mems[t][a])e++;var r={};for(var o in liveTag.tags_ci)for(var s of liveTag.tags_ci[o].mems.keys())r[s.key]=null;console.log("refresh_end: tags_ci+tags: "+Object.keys(liveTag.tags_ci).length+"+"+Object.keys(liveTag.tags).length+", threads:"+e+", "+Object.keys(r).length)}pref[p].load_on_demand&&Kt()}function De(e){var t=[],a=bt.scan_boards_keyword_callback2(site.nickname+","+site.board+","+("thread"===site.whereami?site.no:"0")+","+site.whereami+"_html",{date:Date.now(),status:200,response:document},["native_prep",{native_prep:!0,ext_posts:t,force_annotate:e===!0,__proto__:cataLog.scan_boards_keyword_callback2_default_args}],!0);return"thread"===p&&common_obj.thread_reader&&0!==t.length&&common_obj.thread_reader.updated(t,ea),ea=!1,a}function ze(e){var t=e.split(",");(pref.catalog_promiscuous||t[0]+t[1]in boards)&&bt.scan_init("snoop",[e],{lifetime:3600,crawler_max:1,tgt_raw:!0})}function Ue(e,t){ta[e]||(ta[e]={}),ta[e][t]||(ta[e][t]={}),IDB.req(e,t,null,null,Re,"list_os")}function Re(e,t,a){for(var n=0;n<a.length;n++)!pref.test_mode[80]&&We[e+t+a[n]]||Me(e,t,a[n])}function Me(e,t,a){IDB.req(e,t,a,null,archiver.event_funcs.restore3.bind(archiver.event_funcs),"get_all"),ta[e]||(ta[e]={}),ta[e][t]||(ta[e][t]={}),ta[e][t][a]=!0}function He(e,t,a){if(pref.patch.rm_404_blacklist.indexOf(e)==-1){for(var n=Object.create(pref.archive.IDB.auto_restore&&ta[e]&&ta[e][t]||null),r=0;r<a.length;r++)n[a[r].no]=null;var o=e+t;pref.catalog.bookmark_list_rm404&&(o in pref.catalog.filter.list_obj3||o in pref.catalog.filter.attr_list_obj3||o in pref.catalog.filter.watch_list_obj3)&&Fe(o,n),pref.liveTag.rm_404_immediately&&liveTag.rm_404(e,t,n),pref.test_mode[67]||archiver.clean_list_all(e,t,n);var s=liveTag.mems[e][t];s.LS_synced||(site2[e].clean_up_LS(e,t,n),s.LS_synced=1),pref.test_mode[65]||s.IDB_synced||!pref.archive.IDB.auto_clean_init||IDB.clean_up(e,t,n)}}function Fe(e,t){for(var a=[[pref.catalog.filter.list_str,pref.catalog.filter.list_obj2,Nt],[pref.catalog.filter.attr_list_str,pref.catalog.filter.attr_list_obj2,Tt],[pref.catalog.filter.watch_list_str,pref.catalog.filter.watch_list_obj2,xt]],n=e.length,r=0;r<a.length;r++){var o=[];for(var s in a[r][1])s.length>n&&0===s.indexOf(e)&&!(s.substr(n)in t)&&(pref.debug_mode[2]&&console.log("rm_items_404: "+s),o[o.length]=s);o.length>0&&g(o[0],"DELETE",o.slice(1),!1)}}function qe(e){var t=Ge.getElementsByTagName("textarea")["catalog.filter.bookmark_list_str"];t.value=Xe(e,t.value),pref_func.apply_prep(t,!0)}function Xe(e,t){var a=pref.catalog.bookmark_list_rm404?"":"//$&",n=e.split(",");return t.replace(new RegExp(n[0]+n[1]+n[2]+"(!page)*(,|\n|$)","g"),a)}cataLog.embed_mode=p,pref[p].open_spoiler_text&&styleSheet.open_spoiler_text(),brwsr.sw_cache&&pref.info_client&&brwsr.sw_cache.subscribe(!0);var We={};cataLog.threads=We;var Pe=[],Ke={},Ye=!0,Ge=document.createElement("div"),Je=cnst.init("left:0px:tile:get:bottom:resize:both:Show:tb:width:"+pref.catalog.appearance.initial.width+"px:height:"+pref.catalog.appearance.initial.height+"px:resize:both:overflow:auto",function(){Ge.style.display=""},function(){Ge.style.display="none"},t,Ft),Qe=Je[0];_&&(Qe.style.display="none");var Ve=Je[1];cnst.bottom_top(Qe);var Ze=Qe.childNodes[0],$e=Qe.childNodes[1];$e.id="catalog_debug";var et=!1;Qe.addEventListener("dragstart",a,!1),Qe.addEventListener("dragend",a,!1);var tt=cnst.add_to_tb(Qe,'<button name="filter">'+(site2[site.nickname].CONTENT_SECURITY_POLICY_DATAURI?"F":'<img src="'+cnst.icons.filter+'" style="width:14px;height:14px">')+'</button><button name="settings">'+(site2[site.nickname].CONTENT_SECURITY_POLICY_DATAURI?"S":'<img src="'+cnst.icons.settings+'" style="width:14px;height:14px">')+'</button><button name="refresh">'+(site2[site.nickname].CONTENT_SECURITY_POLICY_DATAURI?"R":'<img src="'+cnst.icons.refresh+'" style="width:14px;height:14px">')+'</button><span name="num_of_pages"><span name="hide_at_embed"> up to <input type="text" name="catalog_max_page" size="2" style="text-align: right;">pages in </span></span><span name="boards_selector"><select name="catalog_board_list_sel"></select></span>'),at=tt.getElementsByTagName("select").catalog_board_list_sel;cnst.auto_shrink_board_selector.setup(at,pref.catalog_board_list_sel),pref_func.apply_prep(tt,!1);for(var nt=["filter","settings","refresh","num_of_pages","boards_selector"],rt=0;rt<nt.length;rt++)pref.catalog.appearance.titleBar[nt[rt]]||(tt.getElementsByTagName("*")[nt[rt]].style.display="none");$e.style.width=Ze.offsetWidth+"px";var ot=function(){function e(e){u=this,t.call(this,e)}function t(e){var t=this.name||this.getAttribute("name"),a=p[t];if(a){if(a.prog&&(a.prog_str=a.prog.IDX?a.prog.IDX+"/"+a.prog.tgts.length+", "+a.tgt:a.prog.found_threads+"/"+a.prog.scanned+", "+a.prog.found_boards+"/"+a.prog.idx+"/"+a.prog.max+", "+a.tgt),u&&u.getAttribute("name")===t){var r=!a.end&&!pref.healthIndicator.cancel,o="Initiator: "+a.initiator+"&emsp;"+(r?'<button name="'+t+'">Cancel</button>':"")+"<br>"+(a.start?"Start: "+new Date(a.start).toLocaleTimeString()+"<br>":"")+(a.prog_str?"Progress: "+a.prog_str+"<br>":"")+"Priority: "+a.priority+"<br>"+(a.start&&!a.end&&a.prog?"Crawler: "+a.prog.crawler+"<br>":"")+(a.err_str?'<span style="color:red">Errors: '+a.err_str+"</span><br>":"")+(a.abort_str?'<span style="color:red">Abort: '+a.abort_str+"</span><br>":"")+(a.end?"End: "+new Date(a.end).toLocaleTimeString()+"<br>":"");pref_func.tooltips.show_1.call(u,e,o,r?n:null,!0)}!e&&pref.healthIndicator.expand_running&&a.start&&!a.end&&this.set(null," :"+a.prog_str)}}function a(e){u=null}function n(e){e.getElementsByTagName("button")[0].onclick=o}function r(){pref.healthIndicator.cancel&&o.call(this)}function o(){var e=this.getAttribute("name");p[e]&&!p[e].end&&cataLog.scan_boards.scan_abort(p[e].initiator)}function s(){for(var e=pref.healthIndicator.show?"":"none",t=0;t<l.length;t++)l[t].pn.childNodes[1].style.display=e}function i(){if(!pref.healthIndicator.expand_running)for(var e=0;e<l.length;e++)for(var t=0;t<l[e].elems.length;t++)l[e].elems[t].pn.textContent.length>1&&l[e].elems[t].set(null,"r")}var l=[],c=0,p={},_=function(){this.pn=document.createElement("span"),this.pn.innerHTML='<span style="color:limegreen"></span><span></span>',this.pn_countdown=this.pn.childNodes[0],this.pn_hi=this.pn.childNodes[1],pref.healthIndicator.show||(this.pn.style.display="none"),l.push(this),this.elems=[]};_.prototype={shift:function(e,t,a,n){for(var r=this.elems.length-pref.healthIndicator.max;r>=0;r--)this.elems[r].remove_from_parent()&&this.elems.splice(r,1);var o=new d(e,t,a,n);return this.pn_hi.insertBefore(o.pn,this.pn_hi.firstChild),this.elems.push(o),o},destroy:function(){this.pn.parentNode.removeChild(this.pn),l.splice(l.indexOf(this),1)}};var d=function(n,o,s,i){this.pn=document.createElement("span"),this.name="healthIndicator."+c++,this.pn.setAttribute("name",this.name),this.set(n,o),this.pn.onmouseover=e,this.pn.onmouseout=a,this.pn.onclick=r,p[this.name]={initiator:s,priority:i},this.show_tooltip_delayed=new DelayBuffer(t.bind(this),100).get_binded_delayed_do()},u=null;return d.prototype={set:function(e,t){t&&(this.pn.textContent=t),e&&this.pn.setAttribute("style","color:"+e)},remove_from_parent:function(){return!(pref.healthIndicator.dont_retire_running&&!p[this.name].end)&&(delete p[this.name],this.pn.parentNode.removeChild(this.pn),this.pn===u&&a(),!0)},remove:function(){if(this.remove_from_parent())for(var e=0;e<l.length;e++){var t=l[e].elems.indexOf(this);if(t!=-1)return void l[e].elems.splice(t,1)}},report:function(e){var t=p[this.name];if(t){var a=t.prog;if(e)for(var n in e)if("err_str"===n?(t.err_str||this.set("orange"),t[n]=(t[n]?t[n]+", ":"")+e[n]):t[n]=e[n],"end"===n){a&&(t.prog_str=t.prog.IDX?a.IDX+"/"+a.tgts.length:a.found_threads+"/"+a.scanned+", "+a.found_boards+"/"+a.max,t.prog=null);var r=t.err_str&&"IDB"!==t.initiator?a&&a.SUC?"▲":"X":"●";this.set("X"===r?"red":null,r)}(u||pref.healthIndicator.expand_running)&&this.show_tooltip_delayed()}}},{HealthIndicator:_,show:s,shrink_running:i}}();cataLog.healthIndicator=ot;var st=new ot.HealthIndicator;httpd.set_health_indicator(st),Ze.childNodes[3].appendChild(st.pn);var it=document.createElement("span");it.textContent=" ",Ze.childNodes[3].appendChild(it);var lt=new ot.HealthIndicator;IDB.set_indicator(lt),Ze.childNodes[3].appendChild(lt.pn),"float"===p&&Ge.setAttribute("class",pref.script_prefix+"_window"),Ge.style="margin:0px 3px; clear:both",Ze.appendChild(Ge),Ge.innerHTML=pref_func.format_html_str('<div style="float:right"><div style="float:right"><ICBX"'+p+'.auto_update"> Auto update<br>1,<ITB3"'+p+'.auto_update_period"> min.<br><ICBX"catalog_refresh_clear"> Clear latter than<br>1,<ITB4"catalog.max_threads_at_refresh">th at update<br><BTN"clear_threads,ClearAllThreads"></div><div style="float:right"><div name="hide_at_embed"><select name="catalog.indexing"><option>Bump order</option><option>Creation date</option><option>Reply count</option><option>Image count</option><option>Last reply</option><option>Fast</option><option>/Bump order</option><option>/Creation date</option><option>/Reply count</option><option>/Image count</option><option>/Last reply</option><option>Slow</option></select><br>size <span name="catalog.text_mode.mode.graphic"><input type="text" name="catalog_size_width" size="4" style="text-align: right;"> x <input type="text" name="catalog_size_height" size="4" style="text-align: right;"></span><span name="catalog.text_mode.mode.text"><input type="text" name="catalog_size_text_width" size="4" style="text-align: right;"> x <input type="text" name="catalog_size_text_height" size="4" style="text-align: right;"></span></div><div><ICBX"catalog.order.reply_to_me"> New reply to me at first<br><ICBX"catalog.order.reply"> New reply at first<br>'+pref_func.settings.html_funcs.rollup_radio("catalog.order.watch"," :Watch listed",1,"",["first:at first","last:at last","dont_care:don't care"])+"<br>"+pref_func.settings.html_funcs.rollup_radio("catalog.order.sticky"," :Sticky",1,"",["first:at first","last:at last","dont_care:don't care"])+'<br></div></div></div><div align="left" style="float:left"><div data-show3="kwd"><a name="HIDE3" style="cursor:pointer">[-]</a><ICBX"catalog.filter.kwd.use"> Keyword :<input type="text" name="catalog.filter.kwd.str" size="25"> <ICBX"catalog.filter.kwd.ci">CI '+pref_func.settings.html_funcs.make_sel("catalog.filter.kwd.match",["match all","match any","unmatch all","unmatch any"])+' <ICBX"catalog.filter.kwd.sentence">Sentence <ICBX"catalog.filter.kwd.re">RE<br>1,(<ICBX"catalog.filter.kwd.sub">Subject <ICBX"catalog.filter.kwd.name">Name <ICBX"catalog.filter.kwd.com">Comment <ICBX"catalog.filter.kwd.file">Filename <ICBX"catalog.filter.kwd.meta">No.) (<ICBX"catalog.filter.kwd.op">OP <ICBX"catalog.filter.kwd.post">Posts)<button name="scanBoard">></button><button name="scanSite">>></button></div><div style="clear:both" data-show3="time"><a name="HIDE3" style="cursor:pointer">[-]</a>Time: Posted/Created <ICBX"catalog.filter.time"><ICBX"catalog.filter.time_creation">Hide <ICBX"catalog.filter.time_watch"><ICBX"catalog.filter.time_watch_creation">Watch <ITBL25"catalog.filter.time_str"><select name="catalog.filter.time_quick_sel"><option>quick select...</option><option>now</option><option>1 hour ago</option><option>2 hours ago</option><option>4 hous ago</option><option>12 hours ago</option><option>1 day ago</option><option>3 days ago</option><option>1 week ago</option></select><br></div><div style="clear:both;display:none" data-show3="tag"><a name="HIDE3" style="cursor:pointer;float:left">[-]</a><div style="float:left"><input type="checkbox" name="catalog.filter.tag"> Tag :</div><div style="float:left;overflow:auto;resize:both;" name="catalog.filter.tag_list"></div><div style="float:left;overflow:auto;resize:both;" name="catalog.filter.tag_board_list"></div><ITBL25"catalog.filter.tag_search.str" placeholder="Search tags..."> <ICBX"catalog.filter.tag_search.re">RE</div><div style="clear:both;display:none" data-show3="list"><a name="HIDE3" style="cursor:pointer;float:left">[-]</a><div style="float:left"><input type="checkbox" name="catalog.filter.list"> Exclusive list:<br>&emsp;<textarea style="height:1em" cols="20" name="catalog.filter.list_str"></textarea></div><div style="float:left"><input type="checkbox" name="catalog.filter.attr_list"> Attribute list:<br>&emsp;<textarea style="height:1em" cols="20" name="catalog.filter.attr_list_str"></textarea></div><div style="float:left">Watch time list:<br>&emsp;<textarea style="height:1em" cols="20" name="catalog.filter.watch_list_str"></textarea></div><div style="float:left"><input type="checkbox" name="catalog.filter.bookmark_list"> Bookmark list:<br>&emsp;<textarea style="height:1em" cols="10" name="catalog.filter.bookmark_list_str"></textarea></div><div style="float:left"><button name="load">load</button><input type="checkbox" name="catalog.auto_load_filter">Auto&emsp;<button name="load_default">clear_filters</button><br><button name="save">save</button><input type="checkbox" name="catalog.auto_save_filter">Auto&emsp;<input type="checkbox" name="catalog.auto_save_filter_at_refresh">Auto at refresh<br></div></div><a name="SHOW3" style="cursor:pointer;float:left;display:none" data-show3="kwd">[+ keyword filter]</a><a name="SHOW3" style="cursor:pointer;float:left;display:none" data-show3="time">[+ Time filter]</a><a name="SHOW3" style="cursor:pointer;float:left" data-show3="tag">[+ Tag search]</a><a name="SHOW3" style="cursor:pointer;float:left" data-show3="list">[+ List filters]</a></div><div style="clear:both"></div>'),cataLog.components={catalog:{indexing:Ge.getElementsByTagName("select")["catalog.indexing"]},pn12_0:Ze,pn12_0_4:Ge,pn_hi:null},"catalog"!==p&&"page"!==p||(tt.getElementsByTagName("span").hide_at_embed.style.display="none",Ge.getElementsByTagName("div").hide_at_embed.style.display="none","catalog"===p&&site2[site.nickname].catalog_native_frame_prep(Qe,e));var ct="text"===pref.catalog.text_mode.mode?"catalog.text_mode.mode.graphic":"catalog.text_mode.mode.text";Ge.getElementsByTagName("span")[ct].style.display="none",de(null,pref.catalog.filter.kwd,!0),pref_func.tooltips.add_root(Ge),pref_func.apply_prep(Ge,!1,null,null,!0);for(var pt=Ge.getElementsByTagName("select"),rt=0;rt<pt.length;rt++)cnst.auto_shrink_selector(pt[rt]);var _t,dt=Ge.childNodes[1],ut={"catalog.filter.kwd.str":function(){var e=dt.getElementsByTagName("*")["catalog.filter.kwd.use"];return function(t){pref.catalog.filter.kwd.use==!pref.catalog.filter.kwd.str&&(pref.catalog.filter.kwd.use=!pref.catalog.filter.kwd.use,pref_func.apply_prep(e,!1)),t&&".str"===t.target.name.substr(-4,4)&&pref3.catalog.filter.kwd.str(t),ue(t,pref.catalog.filter.kwd)}}(),"catalog.filter.list_str":function(){be(),pref[p].mark_new_posts&&Ct.time_filter_changed()},"catalog.filter.attr_list_str":function(){pref.catalog.filter.attr_list&&ve()},"catalog.filter.tag_search.str":function(){liveTag.filter_onchange(pref.catalog.filter.tag_search)},__proto__:pref_func.settings.onchange_funcs.__proto__};cataLog.oninput_funcs=ut;var ft={filter:function(){cnst.show_hide(dt,$e),cnst.toggleButton(this)},settings:function(){cnst.show_hide(mt,$e),cnst.toggleButton(this)},refresh:function(){vt.timer_tgt(!0)},catalog_board_list_sel:function(e,t){t||(e.target.blur(),pref.catalog.auto_save_filter&&ft.save(_t),pref.catalog.refresh.at_switch&&Ce(0),Te(!1,_t)),ta=Object.create(null),pref.catalog.auto_load_filter&&ft.load(),t||Ie(pref.catalog.refresh.at_switch,null,!1,!0),pref[p].auto_config_posts_search&&(pref.catalog.filter.kwd.post=!1,pref_func.apply_prep(Ge.getElementsByTagName("input")["catalog.filter.kwd.post"],!0)),_t=pref.catalog_board_list_sel},catalog_size_width:s,catalog_size_height:s,catalog_size_text_width:s,catalog_size_text_height:s,"catalog.indexing":S,"*.auto_update":function(){vt.set()},"*.auto_update_period":"*.auto_update",clear_threads:function(){Ce(0),Kt()},load:function(){if(localStorage){pref_func.pref_overwrite(pref.catalog.filter,pref_default().catalog.filter);try{pref_func.pref_overwrite(pref.catalog.filter,JSON.parse(localStorage.getItem(ft.load_save_key(at.selectedIndex))),!0),pref_func.apply_prep(dt,!1,null,null,!0),de(null,pref.catalog.filter.kwd,Ye),liveTag.filter_onchange(pref.catalog.filter.tag_search,!0),ve()}catch(e){}}},save:function(e){if(localStorage){void 0===e&&(e=pref.catalog_board_list_sel);var t=pref.catalog.filter,a=JSON.stringify(pref_func.obj_elim_the_same(pref_default().catalog.filter,pref.catalog.filter),t.time||t.time_watch||t.time_watch_creation||t.time_creation?void 0:function(e,t){return"time_str"===e?void 0:t}),n=ft.load_save_key(e);if(!n)return;"{}"===a?delete localStorage[n]:localStorage.setItem(n,a)}},load_default:function(){pref_func.pref_overwrite(pref.catalog.filter,pref_default().catalog.filter),pref_func.apply_prep(Ge,!1,null,null,!0),ue(null,pref.catalog.filter.kwd),ve()},load_save_key:function(e){var t=pref.catalog_board_list_obj[e];return t?pref.script_prefix+".catalog.filter."+t[0].key:null},"catalog.filter.kwd.use":fe,"catalog.filter.kwd.match":ue,"catalog.filter.kwd.re":ue,"catalog.filter.kwd.ci":ue,"catalog.filter.kwd.sentence":ue,"catalog.filter.kwd.op":fe,"catalog.filter.kwd.sub":fe,"catalog.filter.kwd.name":fe,"catalog.filter.kwd.file":fe,"catalog.filter.kwd.com":fe,"catalog.filter.kwd.trip":fe,"catalog.filter.kwd.meta":fe,"catalog.filter.kwd.post":function(e){if(fe(e),pref[p].auto_config_posts_search){if(e.target.checked)pref[p].t2h_sel="ALL_agg","catalog"===p&&(pref[p].popup2="sr"),ft.scanBoard();else{var t=pref_default();pref[p].t2h_sel=t[p].t2h_sel,"catalog"===p&&(pref[p].popup2=t[p].popup2)}pref_func.apply_prep(pref_func.mirror_targets.pn13_1,!1)}},"catalog.filter.tag":be,"catalog.filter.time":ut["catalog.filter.list_str"],"catalog.filter.time_creation":"catalog.filter.time","catalog.filter.time_str":"catalog.filter.time","catalog.filter.list":"catalog.filter.time","catalog.filter.watch_list_str":"catalog.filter.time","catalog.filter.attr_list":ve,scanBoard:function(){pref.common.clear_at_manual_scan&&ft.clear_threads(),scan.keyword_load_1(site.nickname,!0,[site.board],st)},scanSite:function(){pref.common.clear_at_manual_scan&&ft.clear_threads(),scan.keyword_load(!0,st)},"catalog.order.reply_to_me":S,"catalog.order.reply":S,"catalog.order.watch":S,"catalog.order.sticky":S,"catalog.filter.time_quick_sel":function(){i(null,36e5*[0,0,1,2,4,12,24,72,168][this.selectedIndex])},"catalog.filter.tag_search.re":"catalog.filter.tag_search.str",__proto__:ut};window.addEventListener("beforeunload",r,!1),ut=pref_func.add_onchange_format(ut),ft=pref_func.add_onchange_format(ft),pref_func.add_onchange(tt,ft,ut),cataLog.event_func=pref_func.add_onchange(Ge,ft,ut),window.addEventListener("storage",site2[site.nickname].prep_own_posts_event,!1),site2[site.nickname].check_reply.make_own_posts(),Ye&&pref.virtualBoard.scan&&"thread"!==p&&setTimeout(function(){scan.keyword_load(!1,st)},1e3*pref.virtualBoard.scanDelay);var mt=Ge.childNodes[0];mt.style.display="none";var ht;o(),cataLog.triage_parent_set=o,ft.catalog_board_list_sel(null,!0);var gt=new RegExp("#[^#, .:;\n]+(?=#|,| |.|:|;|\n|$)","g"),bt=function(){function e(e){return!i.args[e]||(i.args[e].max!=i.args[e].idx?(i.args[e].max=i.args[e].idx,i.args[e].indicator&&i.args[e].indicator.report({abort_str:"canceled"})):(i.args[e].indicator&&i.args[e].indicator.report({abort_str:"aborted",end:Date.now()}),delete i.args[e]),!1)}function t(t,n,r,o){if(pref.debug_mode[5]&&console.log("scan_init: "+t),o||e(t,!1)){if(Array.isArray(n)||(n=Object.keys(n)),0==n.length)return void(r.callback&&r.callback(r.callback_args));a(t,n,r)}}function a(e,t,a){i.pool||(i.pool={div:document.createElement("div"),parser:new DOMParser,doc:null,ths:null,dbt:null,tgts:null,tags:{cs:{},ci:{}},name:null,sticky:null,type:null,wrapper_obj:null}),i.args[e]={key:e,idx:0,max:t.length,max_threads:pref.scan.max_threads,found_threads:0,found_boards:0,scanned:0,crawler:0,obj:t,lifetime:0,cache_write:!1,callback:null,callback_args:null,pool:i.pool,refresh:null,indicator:null,tgt_raw:!1,watchdog:null,from_auto:null,load_on_demand:null,senders_returned:[],priority:0,tgts_iterator:null,__proto__:i.args_proto};for(var n in a)i.args[e][n]=a[n];var o=i.args[e];if(o.load_on_demand&&!o.tgts_iterator){for(var n=0;n<o.obj.length;n++){var s=r(o,n);0===common_func.name2domainboardthread(s,!0)[2].search(/[cjpq][1-9]/)&&(St.insert_odl(s),o.obj.splice(n--,1))}if(0===o.obj.length){if(o.indicator&&o.indicator.remove(),o.callback)var l=o.callback,a=o.callback_args;return delete i.args[o.key],l?l(a):void 0}Jt.get()&&(o.callback=o.callback?function(e){return function(){Jt.release(),e()}}(o.callback):Jt.release),o.max=o.obj.length,Ht=0}i.args_proto.init_func(o),httpd.req(o,o.priority<7?o.priority+1:1)}function r(e,t){var a=e.tgts_iterator?e.tgts_iterator.next().value:e.obj[t];if(a&&"string"!=typeof a){var n=128&a.u;a=a.key}var r;return a&&(r=cnst.name2domainboardthread(a,!0)),a?e.tgt_raw?a:""===r[2]?a+(pref.catalog.catalog_json|n?"j0":"c0"):pref.catalog.catalog_json&&r[2][0].search(/[0-9]/)!=-1?r[0]+r[1]+"t"+r[2]:a:a}function o(e,t,a,n){var r=a[1],o=e.split(",");if((200==t.status||304==t.status)&&t.response&&r.found_threads<r.max_threads)if("meguca1"===o[0]&&"catalog_json"===o[3]){for(var i=0;i<t.response.length;i++)liveTag.mems.init({domain:o[0],board:o[1],no:t.response[i]}),l[o[1]+t.response[i]]={page:parseInt(i/10)+"."+i%10,refresh:r.refresh||l[o[1]+t.response[i]]&&l[o[1]+t.response[i]].refresh},scan.list_nup.add(o[0]+o[1]+t.response[i],r.priority);scan.list_nup.got_200_board(o[0]+o[1])}else{var c={},_="thread_html"===o[3]||"thread_json"===o[3]?{thread:o[2]}:{page:o[2]};r.localArchive&&(_.localArchive=r.localArchive,_.page=r.page);var d=site2[o[0]].wrap_to_parse.get(t.response,o[0],o[1],o[3],_);if(r.localArchive){for(var i=0;i<d.length;i++)d[i].key=d[i].key.substr(0,d[i].key.lastIndexOf("/")+1)+d[i].posts[0].no;1===d.length&&(o[2]=d[0].posts[0].no)}if(r.force_annotate)for(var i=0;i<d.length;i++)We[d[i].key]&&d[i].pn&&We[d[i].key][0]!==d[i].pn&&(We[d[i].key][0]=d[i].pn,We[d[i].key][1]=!0,T(We[d[i].key],!0,!0,!0,d[i]),We[d[i].key][16].posts=d[i].posts);if(r.scanned+=d.length,pref.test_mode[22]){var u=r.pool.div,f="catalog_json"===o[3]||"catalog_html"===o[3];pref.catalog.filter.kwd.active||pref.catalog.filter.tag&&jt.length}else var m=pref.catalog.filter.kwd.active,h=pref.catalog.filter.tag&&liveTag.active.in;var g=r.refresh;if("meguca1"===o[0]&&"thread_json"===o[3]){var b=l[o[1]+o[2]];void 0!==b&&(g=b.refresh,d[0].page=b.page,delete l[o[1]+o[2]])}for(var v="post"===pref.liveTag.from||pref.stats.use||0===pref[p].deleted_posts.detect.indexOf("full")||"ALL_agg"===pref[p].t2h_sel||site2[o[0]].parse_funcs[o[3]].has_editing&&("page"===p||"thread"===p),i=0;i<d.length;i++){var y=d[i];if(y.no)if(y.time_loaded=t.date,r.native_prep&&(y.native_prep=!0),pref.test_mode[33]&&"meguca1"===o[0]&&"thread_json"===o[3])scan.list_nup.got_200(y);else{if(pref.test_mode[22])r.scan_tag&&f&&("json"===y.type_data?u.innerHTML=y.name+"\n"+y.sub+"\n"+y.com:u=y.pn,y.tags=u[brwsr.innerText].match(gt));else{var k=liveTag.prep_tags(y);y.tags=k;var x=k[2],N=We[y.key],j=N?void 0:y.tags,A=!(v||2883584&x[0])&&null;if(y.parse_funcs.has_editing&&y.parse_funcs.has_posts&&(k.ed_t&&(j=liveTag.update_tags_in_editing_posts(y,k)||j),k.ed_p))for(var E=0;E<k.ed_p.length;E++){var B=y.posts_obj?y.posts_obj[k.ed_p[E]]:y.parse_funcs.posts_obj(y,k.ed_p[E]);if(B&&!B.editing){if(1===k.ed_p.length){k.ed_p=null;break}k.ed_p.splice(E--,1)}}k.q&&k.q.waiting&&y.parse_funcs.has_posts&&site2[y.domain].popups_fetched(y,k);var L=null;if(null!==A&&(k.nof_posts<y.nof_posts||393216&x[0])?"thread"===y.type_source||y.parse_funcs.has_posts&&y.posts.length>y.nof_posts-k.nof_posts&&(k.ta||0!==pref[cataLog.embed_mode].deleted_posts.detect.indexOf("full"))||1===y.nof_posts&&y.posts[0].time>=0&&!y.parse_funcs.dont_have_com?(A=!0,L=site2[y.domain].check_reply.check(y,x,N,r.ext_posts||[]),j=L.tags||j,scan.list_nup.got_200(y),(k.archived||"no"!==pref[p].deleted_posts.detect)&&(pref.test_mode[67]||r.localArchive||archiver.store(t,y,k,L.posts,L.time_check_old))):scan.list_nup.add(y.key,r.priority):(r.localArchive||scan.list_nup.got_200(y),(k.rescan_dp||k.force_ar||k.nof_posts!=y.nof_posts&&y.parse_funcs.has_posts&&(k.archived||"no"!==pref[p].deleted_posts.detect))&&(pref.test_mode[67]||r.localArchive||archiver.store(t,y,k)),k.nof_posts!=y.nof_posts&&(k.nof_posts=y.nof_posts)),y.parse_funcs.has_editing){if(L)for(var E=0;E<L.posts.length;E++)L.posts[E].editing&&(k.ed_p?k.ed_p[k.ed_p.length]=L.posts[E].no:k.ed_p=[L.posts[E].no]);"catalog"===y.type_source&&"catalog"!==p&&N&&(N[16].needs_update<y.replyTime||null===N[16].needs_update)&&scan.list_nup.add(y.key,r.priority)}}if(!pref.test_mode[32]||"meguca1"!==o[0]||"thread_json"!==o[3]){k.th&&(N?k.th.parse_funcs.missing_info&&(!y.parse_funcs.missing_info||y.parse_funcs.missing_info<k.th.parse_funcs.missing_info)&&(k.th.pn&&(y.pn=k.th.pn),k.th=y):delete k.th);var C="thread"===y.type_source&&"ALL_agg"===pref[p].t2h_sel,I=m&&Vt.kwd(pref.catalog.filter.kwd,y.posts,y.domain,y),S=h&&liveTag.search_by_tags(y.tags),O=I||S,D=void 0===N?void 0:N[9][0],z=N&&(N[16].expand_posts||"thread"===y.type_source&&(N[16].needs_update===!0||N[16].needs_update<y.replyTime||null===N[16].needs_update))||C;if(g||A&&N||O||z){if(null===A&&N){var U=N[8];A=!((U[0]>U[4]?U[0]:U[4]||U[0])>=(y.time_bumped>y.time_posted?y.time_bumped:y.time_posted||y.time_bumped)&&U[2]==y.nof_posts&&U[3]==y.nof_files)||"thread"===y.type_source}(A||O||void 0===D||z)&&(pref[p].scroll_lock&&Mt.set(),w(y,t.date,I,n&&d[i].pn),c[y.key]=!0,N=We[y.key]),r.found_threads++,r.from_auto&&!D&&N[9][0]&&notifier.appeared(y,void 0===D)}pref.test_mode[31]||N&&It.update(y.key,A?y.flags:null,y.page,void 0!==D?j:y.tags,y)}}}if(pref.test_mode[22]&&r.scan_tag&&f&&s(d,r),"catalog_json"!==o[3]&&"catalog_html"!==o[3]||(scan.list_nup.got_200_board(o[0]+o[1]),He(o[0],o[1],d)),pref.catalog_max_page_auto&&("page_html"===o[3]||"catalog_json"===o[3]&&site2[o[0]].parse_funcs[o[3]].get_max_page)){var R=site2[o[0]].parse_funcs[o[3]].get_max_page(t.response);R&&(liveTag.mems[o[0]][o[1]].pgs=R)}if(pref[p].load_on_demand){var M=d[d.length-1];!M||"page"!==M.type_source||site2[M.domain].all_boards&&site2[M.domain].all_boards.indexOf(site.board)==-1||St.raise_odl(M)}0===Object.keys(c).length||r.native_prep||(r.found_boards++,Kt(c))}else 404!=t.status||"thread_json"!==o[3]&&"thread_html"!==o[3]||(pref.liveTag.rm_404_immediately&&liveTag.rm_404_1(o[0],o[1],o[2]),scan.list_nup.got_404(o[0]+o[1]+o[2])),r.found_threads<r.max_threads&&404==t.status&&qe(e),null===t.response&&200==t.status&&(pref.debug_mode[16]&&console.log("ERROR!!! Inconsistency in server. Server returned null with status 200 for "+site2[o[0]].make_url4(o)[0]+" , "+e),t.status=-200);return!r.refresh||pref.test_mode[65]||!pref.archive.IDB.auto_restore||ta[o[0]]&&ta[o[0]][o[1]]||"catalog_json"!=o[3]&&"catalog_html"!==o[3]&&"page_json"!=o[3]&&"page_html"!==o[3]||window.opener||Ue(o[0],o[1]),d}function s(e,t){for(var a={},r=0;r<e.length;r++)a[e[r].key]=e[r];n(a,"",t.pool.tags)}var i={args:{},pool:null};i.args_proto={callback_1:function(e,t,a){o(e.key2,t,[null,a])},get_tgt_func:function(e){if(e.IDX<e.max&&(e.refresh||e.found_threads<e.max_threads)){do{var t=r(e,e.IDX++)}while(e.IDX<e.max&&(!t||pref.catalog.board.ex_list&&pref_func.merge_obj5(t,pref.catalog.board.ex_list_obj2,{hit:!1}).hit));if(e.IDX<=e.max){var a=scan.list_nup.issued(t),n=common_func.name2dbt(t),o=site2[n[0]].make_url4(n),s=n.join(",");return{REQ:e,url:o[0],responseType:a?"text":"html"===o[1]?"document":o[1],tgt:t,key2:s,data_type:o[1],domain:n[0]}}}},callback:function(e){e.found_threads>=e.max_threads&&e.INDICATOR.report({err_str:"Aborted.(Reached upper limit)"}),delete i.args[e.key],0==Object.keys(i.args).length&&(i.pool=null),e.callback2&&e.callback2(e.callback_args)},init_func:function(e){Object.defineProperty(e,"idx",{get:function(){return this.IDX},configurable:!0}),Object.defineProperty(e,"indicator",{get:function(){return this.INDICATOR},configurable:!0}),Object.defineProperty(e,"tgts",{get:function(){return this.obj},configurable:!0}),Object.defineProperty(e,"initiator",{get:function(){return this.key},configurable:!0}),e.hasOwnProperty("callback")&&(e.callback2=e.callback,delete e.callback)}},i.args_proto.callback_1_fail=i.args_proto.callback_1,cataLog.scan_boards_keyword_callback2_default_args={refresh:!0,found_threads:0,max_threads:pref.scan.max_threads,found_board:0,scanned:0};var l={};return cataLog.scan_boards_keyword_callback2=o,cataLog.scan_init=t,{scan_init:t,scan_abort:function(e){t(e,{},{})},scan_boards_keyword_callback2:o}}();cataLog.scan_boards=bt;var vt=function(){function e(){a&&(clearTimeout(a),a=null),pref.catalog_auto_update_countdown&&(st.pn_countdown.textContent="")}function t(){st.pn_countdown.textContent=--n,n<=0?r():a=setTimeout(t,1e3)}var a=null,n=0,r=function(e){a=null,Ie(!0,null,!e),vt.set()};return{set:function(){if(e(),pref[p].auto_update){var o=pref[p].auto_update_period||.5;pref.catalog_auto_update_countdown?(n=60*o,t()):a=setTimeout(r,6e4*o)}},stop_if_running:e,timer_tgt:function(){a&&(clearTimeout(a),a=null),r(!0)}}}();vt.set(),dt.style.display="none"
;var yt,kt,wt=dt.getElementsByTagName("*")["catalog.filter.time_str"],xt=dt.getElementsByTagName("textarea")["catalog.filter.watch_list_str"],Nt=dt.getElementsByTagName("textarea")["catalog.filter.list_str"],Tt=dt.getElementsByTagName("textarea")["catalog.filter.attr_list_str"],jt=[],At=_?site2[site.nickname].catalog_get_native_scroll_area?site2[site.nickname].catalog_get_native_scroll_area():window:ht,Et=[],Bt=function(){function e(e){for(var n=t.format_tgt,r=We[e],o=liveTag.mems.getFromName(e),s=0;s<n.length;s++)n[s][0].style.display=a[n[s][1]](r,o)?"none":""}var t=null,a={WATCH:function(e){return 786432&e[19][0]&&0===e[19][1]},UNWATCH:function(e){return!(786432&e[19][0])},SHOW:function(e){return e[16].icon_show_always},UNSHOW:function(e){return!e[16].icon_show_always},STICKY:function(e){return e[16].icon_sticky},UNSTICKY:function(e){return!e[16].icon_sticky},ARC:function(e,t){return t.archived},ARC1:function(e,t){return t.archived},UARC:function(e,t){return!t.archived}},n=function(){function a(){ht.appendChild(yt),_=!1}function n(a){if(pref.catalog_triage){var n=a.currentTarget;if(l.cancel(),i===n)return;s||(_?yt=ht.appendChild(yt):yt.style.display=""),pref.triage.show_always||(p.cancel(),p.delayed_do()),i&&i.removeEventListener("mouseout",c,!1);var r=n.offsetLeft-ht.scrollLeft;"topLeft"===pref.catalog_triage_place||"bottomLeft"===pref.catalog_triage_place?(yt.style.left=r+"px",yt.style.right=""):(yt.style.right=ht.offsetWidth-r-n.offsetWidth+"px",yt.style.left="");var d=n.offsetTop-ht.scrollTop;"topLeft"===pref.catalog_triage_place||"topRight"===pref.catalog_triage_place?(d<ht.offsetTop&&(d=ht.offsetTop),yt.style.top=d+"px",yt.style.bottom=""):(yt.style.bottom=window.innerHeight-d-n.offsetHeight+"px",yt.style.top=""),i=a.currentTarget,s=i.name,i.addEventListener("mouseout",c,!1),t.format_tgt&&e(s)}else o()}function r(){i&&(i.removeEventListener("mouseout",c,!1),i=null),o()}function o(){s&&(_?yt=yt.parentNode.removeChild(yt):yt.style.display="none",s=null)}var s=null,i=null,l=new DelayBuffer(r,100),c=DelayBuffer.prototype.delayed_do.bind(l),p=new DelayBuffer(o,pref.triage.popdown_delay),_=!0;return{get_triaged_thread_name:function(){return s},change_mode:a,thread_in:n,off:o,off_delay:function(){p.delayed_do(500)},triage_in:function(){p.cancel(),l.cancel()},triage_out:function(){pref.triage.show_always||p.delayed_do(),l.delayed_do()}}}();return{get_triaged_thread_name:n.get_triaged_thread_name,change_mode:n.change_mode,thread_in:n.thread_in,off:n.off,off_delay:n.off_delay,triage_in:n.triage_in,triage_out:n.triage_out,set_trg:function(e){t=e},get_trg:function(){return t},format_buttons:e}}();d(),cataLog.triage=Bt;var Lt={get no(){return this.dbt[2]},get board(){return this.dbt[1]},get domain(){return this.dbt[0]},get key(){return this.dbt.join("")},get nof_posts(){return liveTag.mems.getFromName(this.key).nof_posts},get nof_files(){return We[this.key][8][3]},get tags(){return liveTag.mems.getFromName(this.key)}};cataLog.set_watch_time_thread=x;var Ct={prepare_html_prep_posts:function(e){site2[e.domain].wrap_to_parse.posts(e),"html"===e.type_data&&this.prepare_html_extract_params(e)},prepare_html_extract_params:function(e){if(!e.extracted){if(e.parse_funcs.filename){for(var t=0;t<e.posts.length;t++)e.posts[t].pn&&(e.posts[t].filename=e.parse_funcs.filename(e.posts[t]));e.filename=e.parse_funcs.filename(e)}e.parse_funcs.prep_mimic&&e.parse_funcs.prep_mimic(e),e.extracted=!0}},prepare_html:function(e,t){var a=We[e.key],n=(e.domain!==site.nickname||site.whereami+"_html"!==e.type_mimic)&&pref.catalog.mimic_base_site,r="page"!==p&&"thread"!==p||!site2[site.nickname].page_json2html3?"catalog":"page";if(pref.test_mode[92]&&(r="catalog"),n){if(t){var o="page"===r?site2[site.nickname].page_json2html3(e,e.board,e.op_img_url,!0):site2[site.nickname].catalog_json2html3(e,e.board,e.op_img_url);Object.defineProperty(e,"pn",{value:o,writable:!0,enumerable:!0,configurable:!0})}e.type_html=r,e.domain_html=site.nickname,e.parse_funcs_html=site2[site.nickname].parse_funcs[e.type_html+"_html"]}else"html"===e.type_data&&site2.common.remove_by_tagname(e.pn,"script");t&&(a[0]===!1&&(a[0]=e.pn,a[16].type_html=e.type_html,a[16].domain_html=e.domain_html,a[16].parse_funcs_html=e.parse_funcs_html),Object.defineProperty(e,"footer",{value:e.parse_funcs_html.footer(e),writable:!0,enumerable:!0,configurable:!0}),site2[e.domain].toplevel_anchor(e,e.no),site.nickname!==e.domain&&site2[e.domain].absolute_link(e))},prepare_html_post:function(e,t,a,n){t.pn||(t.pn=site2[e.domain_html].parse_funcs.post_json.pn(t)),n||(site2[e.domain].toplevel_anchor(t,e.no),site.nickname!==e.domain&&site2[e.domain].absolute_link(t)),site2[e.domain_html].format_pn(t.pn,a?a[t.no]:null,n,t),t.editing&&t.pn.classList.add(pref.script_prefix+"_post_editing")},get_t2h_from_index:function(e){return["page","L","M","N","N_unread","unread","all"][e]},get_t2h_index:function(e){var t=e[16].t2h_sel||pref[p].t2h_sel;return"page"===t?0:"L"===t?1:"M"===t?2:"N"===t?3:"N_unread"===t?4:"unread"===t?5:6},get_t2h_num_of_posts:function(e,t){var a=e[16]&&e[16].t2h_sel||pref[p].t2h_sel;return!("page"===a&&"page"===t&&!e[16].expand_posts)&&("page"===a?e[16].t2h_page||pref[p].t2h_num_of_posts:"L"===a?pref[p].t2h_L:"M"===a?pref[p].t2h_M:"N"===a?pref[p].t2h_num_of_posts:"N_unread"===a?pref[p].t2h_num_of_posts+(786432&e[19][0]?65535&e[19][1]:0):"unread"===a?786432&e[19][0]?65535&e[19][1]:e[16].t2h_page:"no"===a?0:-1)},update_posts_in_page:function(e,t,a){var n=We[t],r=[],o=site2.DEFAULT.update_posts_merge_bases,s=!a||!n[1]&&o.initialized?null:o.base_tgts(e.key),i=n[1]&&s?o.query(n[16].posts&&n[16].posts!==e.posts?{pn:n[0],__proto__:n[16]}:e,s,!0):o.bases[e.key];return!s||n[1]||o.initialized||o.setup_hook(),!a||n[16].posts&&n[16].posts!==e.posts?(a&&(r=e.posts.slice()),site2[e.domain_html].update_posts_replace(e,n[16],n[0],i,n[1],r),n[16].expand_posts&&(n[16].expand_posts=null)):(n[16].posts=e.posts,r=e.posts),r},replace_posts_by_search:function(e){var t=e[7];if(pref.catalog.filter.kwd.posts_active){if(e[10]!=pref.catalog.filter.kwd.timestamp||e[16].th){e[10]=pref.catalog.filter.kwd.timestamp;var a=Vt.kwd_make_result(t.posts,t.domain,t);if(a){var n=!e[16].posts||e[16].posts.length!==a.length;if(!n){for(var r=a.length-1;r>=0;){if(e[16].posts[r].no!==a[r].no){n=!0;break}r--}!n&&e[16].posts&&e[16].posts[0]&&e[16].posts[0].pn&&e[16].posts[0].pn.classList.contains("CatChan_search_miss")==a[0].search_result&&site2[t.domain_html].update_posts0_class(e[16].posts[0].pn,a[0].search_result)}n?(Ct.prepare_html_prep_posts(t),e[16].th={posts:a,__proto__:t}):e[16].th&&(e[16].th=null)}else e[9][0]=!1,e[16].th=null}}else(e[10]||e[16].th)&&(e[16].th||(e[16].th=ie(t)),e[10]=!1);e[16].th&&e[7]&&e[16].posts===e[7].posts&&(e[7].posts=e[7].posts.slice())},posts_search_inactivated:function(){for(var e in We){var t=We[e][7],a=We[e][16];a.posts&&a.posts[0]&&a.posts[0].pn&&a.posts[0].pn.classList.contains("CatChan_search_miss")&&site2[t.domain_html].update_posts0_class(a.posts[0].pn,!0)}Ht=0},hide_posts_without_images:function(e,t){for(var a=We[t][16].posts,n=0;n<a.length;n++){0===e.parse_funcs_html.tn_imgs(e.posts[n]).length&&(a[n].pn.style.display="none")}},update_draw:function(e,t,a){if(pref[p].mark_new_posts&&786432&We[e][19][0]){var n=te(e,pref.catalog.filter.time_watch||pref.catalog.filter.time_watch_creation,!0,!0);0===n&&"thread"===p&&(n=site2.DEFAULT.check_reply.get_checked_time(We[e][19])),n>0&&site2[We[e][16].domain_html].mark_newer_posts(t,n,null,!0,a)}},update:function(e){var t=pref[p].mark_new_posts&&786432&We[e][19][0]?te(e,!0,!0,!0):0;0===t&&(t=1/0),We[e][0]&&site2[We[e][16].domain_html].mark_newer_posts(We[e][0],t,null,!1,We[e][16])},time_filter_changed:function(){if("catalog"!==p)for(var e in We)this.update(e)}};cataLog.format_html=Ct,cataLog.get_watch_time_of_a_thread=A;var It={update:function(e,t,a,n,r){var o=We[e][24];o&&(We[e][1]?C(e,t,a,n||(4&o[4]?liveTag.mems.getFromName(e):null)):(o[4]=(o[4]||0)|(t?1:0)|(a?2:0)|(n?4:0),t&&(o[1]=t),a&&(o[2]=a)))},draw:function(e){var t=We[e][24];t&&t[4]&&C(e,null,null,4&t[4]?liveTag.mems.getFromName(e):null)}};cataLog.Footer=It,cataLog.insert_footer3=C;var St=function(){function e(e){var t=parseInt(e.substr(e.lastIndexOf("/")+2),10);return 0===t?{8:[void 0,void 0,void 0,void 0,void 0],__proto__:p}:{8:[-t,-t,-t,-t,-t],__proto__:p}}function t(t){return 0===t.indexOf(_)?c[t]||e(t):We[t]}function a(e,a){for(var n=i;n<l&&a(t(Pe[n]));)n++;a(e)?l=n:i=n}function n(e){i=0,l=Pe.length;var n=t(e);pref.catalog.order.reply_to_me&&a(n,d.reply_to_me),pref.catalog.order.reply&&a(n,d.reply),"dont_care"!==pref.catalog.order.watch&&a(n,"last"===pref.catalog.order.watch?d.watch_last:d.watch_first),"dont_care"!==pref.catalog.order.sticky&&a(n,"last"===pref.catalog.order.sticky?d.sticky_last:d.sticky_first);for(var r=pref.catalog.indexing%6,o=pref.catalog.indexing,s=0===r||4===r?function(e){return e[8][r]||e[8][0===r?4:0]}:5===r?function(){var e=Date.now();return function(t){return(e-t[8][1])/t[8][2]}}():function(e){return e[8][r]},c=s(n),p=o>=5&&o<11?function(e){return c>=s(e)}:function(e){return c<=s(e)},_=i;_<l&&p(t(Pe[_]));)_++;return _==Pe.length?Pe[Pe.length]=e:Pe.splice(_,0,e),_}function r(e){var t=(pref.catalog.indexing,Pe.indexOf(e.key));if(t!=-1)for(var a="ODL:"+e.domain+e.board;++t<Pe.length;)if(0===Pe[t].indexOf(a)){c[Pe[t]]={8:[e.time_posted||e.time_bumped,e.time_created,e.nof_posts,e.nof_files,e.time_bumped||e.time_posted],__proto__:p},n(Pe.splice(t,1)[0]);break}}function o(e){for(var t=0;t<e.length;t++)delete c[_+e[t]]}function s(e){delete c[_+e],O(_+e)}var i,l,c={},p={8:[0,0,0,0,0],19:[0,0,0]},_="ODL:",d={reply_to_me:function(e){return 786432&e[19][0]&&e[19][1]>>16!=0},reply:function(e){return 786432&e[19][0]&&0!=e[19][1]},watch_first:function(e){return 786432&e[19][0]},watch_last:function(e){return!(786432&e[19][0])},sticky_first:function(e){return e[20]},sticky_last:function(e){return!e[20]}};return{insert:n,raise_odl:r,delete_odl:o,insert_odl:s}}(),Ot=null,Dt=null,zt=null,Ut=[];cataLog.image_hover_add=U,cataLog.image_hover_remove=R,cataLog.image_hover_reentry=M;var Rt,Mt=function(){function e(){r.cancel(),n=null}function t(){var e=n[0].offsetTop||0,t=e-n[1]+n[2];t<0&&(t=0),e&&se()!==t&&(window.scrollTo(0,t),s())}function a(e){if(null===n||e){if(!e&&!(e=o.id?i:cataLog.general_event_handler.get_last_viewed()||i))return;n=[e,e.offsetTop,se()],i=e}o.restart(),s()}var n=null,r=new Watchdog(t,5),o=new Watchdog(e,100),s=Watchdog.prototype.restart.bind(r),i=null;return{modified:function(e){e.pn&&n&&n[0]===e.pn?(t(),n=null,a(site2[site.nickname].general_event_handler[site.whereami].get_mark_from_height(e.pn.offsetTop)),cataLog.general_event_handler.clear_last_viewed()):a()},set:a}}();cataLog.show_catalog_scroll_lock=Mt;var Ht=0,Ft=new DelayBuffer(re,200).get_binded_delayed_do();cataLog.show_catalog_cont=Ft;var qt=null;cataLog.get_ref_height=oe;var Xt,Wt={show_catalog:function(e,t){if(pref.debug_mode[11])var a=le(Ht,this.drawn_y,this.ref_count,Pe);pref.test_mode[23]&&(Ht=0);var n=pref[p].draw_on_demand&&this.permit_draw_on_demand,r=n&&pref.network.adaptive,o=0;if(n){var s=oe(pref[cataLog.embed_mode].merge?4:r?null!==Gt.id?.2:1:1.5);if(0!==Ht&&this.drawn_y>=s){if(!(ht.offsetHeight<this.drawn_y))return;Ht=0}}pref[p].scroll_lock&&Mt.set();var i;"string"==typeof e?(i={},i[e]=null):i=e;var l=Bt.get_triaged_thread_name(),c="float"===p&&pref.catalog_expand_with_hr||pref[p].env.disp_filler;if(void 0!==i)for(var _=0;_<Ht;_++)if(Pe[_]in i){Ht=_;break}this.ref_count_init=pref[p].env.disp_offset,c&&(this.ref_count_init=ce(this.ref_count_init)),n&&0!==Ht&&Ht!==!0||this.func_track_reset();for(var d="",_=0,u=Ht,f=null;_<Pe.length;){var m=Pe[_];if("ODL:"===m.substr(0,4)){if(""===d){d=m,Jt.call([d.substr(4)])&&Pe.splice(_,1);break}}else{if(n&&this.drawn_y>=s){if(!this.lazy_draw||!pref.proto.merge_first||pref[cataLog.embed_mode].merge)break;if(!f){f=new Set;var h=site2.DEFAULT.update_posts_merge_bases;for(var m of h.shown.values())f.add(pref_func.merge_obj5a_sc(m,pref3.proto.merge_list_obj2,null));var g=_}if(!f.has(pref_func.merge_obj5a_sc(m,pref3.proto.merge_list_obj2,null))){_++;continue}}if("END"===i)break;if(_>=u&&(n||void 0===i||m in i))if(null===We[m][9][0]&&(We[m][9]=me(m,!0)),We[m][9][0]&&"page"===p&&!pref.test_mode[52]&&Ct.replace_posts_by_search(We[m]),We[m][9][0]){if(We[m][0]&&!We[m][16].th||(N(We[m],!We[m][0],!1,!0),r&&(++o==pref.network.th100?(s=oe(1),Yt.delayed_do()):o===pref.network.th20&&(s=oe(.2),Yt.cancel(),Gt.delayed_do(),r=!1))),cataLog.Footer.draw(m),f){We[m][1]||this.func_show(m,null,c)&&(We[m][1]=!0),_++;continue}var b;if(void 0!==i){for(var v=_-1;v>=0&&("ODL:"===Pe[v].substr(0,4)||!We[Pe[v]][1]||this.func_search_ref&&this.func_serach_ref(Pe[v]));)v--;v>=0?(b=We[Pe[v]][0].nextSibling,c&&b&&(b=b.nextSibling)):b=ht.childNodes[this.ref_count_init],delete i[m],0===Object.keys(i).length&&(i="END")}else b=ht.childNodes[this.ref_count];b===We[m][0]&&We[m][1]||(this.func_show(m,b,c)&&(We[m][1]=!0),l&&(Bt.off_delay(),l=null)),We[m][1]&&this.func_track_shown(m,n)}else We[m][1]&&(Ke[m]&&xe(m),this.func_hide(m,c)&&(We[m][1]=!1),l&&(Bt.off_delay(),l=null));_++}l===m&&(l=null)}if(f&&(_=g),Ht=!n||_==Pe.length||(_<u?u:_),this.lazy_draw&&this.lazy_draw(),pref.debug_mode[11]&&"thread"!==p&&!pref[p].merge){for(var y=-1,k=0,w=0;w<_;w++)if("O"!==Pe[w][0]&&We[Pe[w]][1]){var x,T,j=common_func.fullname2dbt(Pe[w]);if("page"===p&&"4chan"===site.nickname?(x=ht.getElementsByClassName("CatChan_thread")[k++],T=site.board+x.id.substr(1)):"page"===p&&"8chan"===site.nickname?(x=ht.getElementsByClassName("CatChan_thread")[k++],T="/"+x.getAttribute("data-board")+"/"+x.id.substr(7)):(x=ht.childNodes[pref[p].env.disp_offset+k++],T="page"===p?"/"+x.getAttribute("data-board")+"/"+x.id.substr(7):x.getElementsByTagName("a")[0].getAttribute("href").replace("res/","").replace(".html","").replace(/.*lainchan.org/,"").replace(/.*8ch.net/,"").replace("thread/","").replace(/.*4chan.org/,"").replace(/.*meguca.org/,"").replace(/.*krautchan.net/,"").replace(/thread\-/,""),"4chan"===j[0]&&"catalog"===p&&(T=T.substr(0,T.lastIndexOf("/")))),j[1]+j[2]!==T){for(var A="",v=w+1;v<w+5;v++)A+=Pe[v]+", ";console.log("ERROR: "+w+", "+T+", "+Pe[w]+": "+_+", "+A),y=_}}var E=le(Ht,this.drawn_y,this.ref_count,Pe);if(y!=-1){console.log("PREV: "+Xt),console.log("IN:   "+a);for(var _=0;_<y+5;_++)ht.childNodes[_]&&console.log(ht.childNodes[_]);console.log("OUT:  "+E)}Xt=E}},func_show:function(e,t){return ht.insertBefore(We[e][0],t&&t.parentNode===ht?t:null),!0},func_hide:function(e){return ht.removeChild(We[e][0]),!0},func_track_shown:function(e,t){t&&(this.drawn_y=We[e][0].offsetTop),this.ref_count+=this.ref_step},func_track_reset:function(){this.ref_count=this.ref_count_init,this.drawn_y=0,Ht=0},permit_draw_on_demand:!0,ref_step:1,drawn_y:0,ref_count:0,ref_count_init:0};At.addEventListener("scroll",Ft,!1),window.addEventListener("resize",Ft,!1);var Pt=Wt;"page"===p&&site2[site.nickname].all_boards&&site2[site.nickname].all_boards.indexOf(site.board)!=-1?Pt={func_show:function(e){var t=We[e][0];return!(!t.previousSibling||"H2"!==t.previousSibling.tagName)&&(t.previousSibling.style.display="",t.style.display="",!0)},func_hide:function(e){var t=We[e][0];return!(!t.previousSibling||"H2"!==t.previousSibling.tagName)&&(t.previousSibling.style.display="none",t.style.display="none",!0)},permit_draw_on_demand:!1,__proto__:Wt}:pref[p].env.disp_filler?Pt=function(e){return{func_show:function(e,t){var a=We[e][1]&&We[e][0].nextSibling||this.filler.cloneNode(!1);return ht.insertBefore(We[e][0],t),ht.insertBefore(a,t),!0},func_hide:function(e){return ht.removeChild(We[e][0].nextSibling),ht.removeChild(We[e][0]),!0},ref_step:2,filler:e,__proto__:Wt}}("<"===pref[p].env.disp_filler[0]?document.createElement("hr"):document.createTextNode(pref[p].env.disp_filler)):"float"===p&&pref.catalog_expand_with_hr&&(Pt={func_show:function(e,t){return We[e][1]&&pe(e,"remove"),ht.insertBefore(We[e][0],t&&t.parentNode===ht?t:null),pe(e,"add"),!0},func_hide:function(e){return pe(e,"remove"),ht.removeChild(We[e][0]),!0},func_track_shown:function(e,t){this.__proto__.func_track_shown(e,t),this.ref_count=ce(this.ref_count)},__proto__:Wt});var Kt=Pt?Pt.show_catalog.bind(Pt):Wt.show_catalog.bind(Wt);cataLog.show_catalog=Kt,cataLog.catalog_obj2=Pt;var Yt=new DelayBuffer(Kt,pref.network.th100_delay),Gt=new DelayBuffer(Kt,pref.network.th20_delay),Jt=function(){function e(){a&&(clearTimeout(a),a=null),t=!0}var t=!0,a=null;return{call:function(e){return!!this.get()&&(St.delete_odl(e),bt.scan_init("on_demand_load",e,{refresh:!0,crawler_max:1,callback:Jt.release_draw}),!0)},release:e,release_draw:function(){e(),Kt()},get:function(){var n=t;return n&&(a=setTimeout(e,1e3*pref.catalog_load_on_demand_timeout)),t=!1,n}}}(),Qt=0,Vt=function(){function e(e,a,n,r,o){if(e.op&&t(e,a,n[0].DUMMY&&o||n[0],r))return!0;if(e.post)for(var s=1;s<n.length;s++)if(t(e,a,n[s],r))return!0;return!1}function t(e,t,n,r){if(e.sub&&n.sub&&t.test(n.sub))return!0;if(e.name&&n.name&&t.test(n.name))return!0;if(e.com)if(n.parse_funcs&&"txt"===n.parse_funcs.type_com||pref.test_mode[53]){if(t.test(n.body||n.com))return!0}else{var o=site2[r].post_com2txt(n);if(o&&(o.search(/&[#\w\d]+;/)==-1||pref.test_mode[58]||(pref.debug_mode[17]&&console.log("not interpreted html: "+o),a.innerHTML=n.com,o=a[brwsr.innerText]),t.test(o)))return!0}if(e.file){if(n.filename&&t.test(n.filename))return!0;if(n.extra_files)for(var s=n.extra_files.length-1;s>=0;s--)if(n.extra_files[s].filename&&t.test(n.extra_files[s].filename))return!0}return!!(e.meta&&n.no&&t.test(n.no))}var a=document.createElement("div");return{kwd:function(t,a,n,r){if(!t.use||0==t.kwds.length)return!0;for(var o=t.match%2==0,s=!!(t.match<2^o),i=0;i<t.kwds.length;i++)if(s===e(t,t.kwds[i],a,n,r))return!o;return o},kwd_1:function(e,a,n){for(var r=e.match<2,o=0;o<e.kwds.length;o++)if(t(e,e.kwds[o],a,n))return r;return!r},kwd_make_result:function(e,t){var a=[Object.create(e[0])];a[0].search_result=this.kwd_1(pref.catalog.filter.kwd,e[0],t);for(var n=1;n<e.length;n++)this.kwd_1(pref.catalog.filter.kwd,e[n],t)&&(a[a.length]=e[n]);return 1!=a.length||this.kwd_1(pref.catalog.filter.kwd,e[0],t)?a:null}}}();cataLog.catalog_filter_query_keyword=Vt,cataLog.catalog_filter_query=me,cataLog.catalog_filter_changed=be;var Zt={};cataLog.remove_thread=Be;var $t=null;cataLog.catalog_clear_threads=Ce,cataLog.catalog_refresh_1=Se,cataLog.catalog_refresh_end=Oe,c?site2[site.nickname].catalog_frame_prep(Qe):"float"===p&&("maximized"===pref.catalog.appearance.initial.state?Ze.childNodes[1].childNodes[3].onclick():"top"===pref.catalog.appearance.initial.state?Ze.childNodes[1].childNodes[0].onclick():"bottom"===pref.catalog.appearance.initial.state&&Ze.childNodes[1].childNodes[1].onclick()),_&&setTimeout(function(){site2[site.nickname].catalog_native_prep(Date.now(),Ge,Ze,"catalog"===p);var e=De();if("page"===p&&site2[site.nickname].all_boards&&site2[site.nickname].all_boards.indexOf(site.board)!=-1||"thread"===p&&pref.thread.env.auto_update_native){new MutationObserver(De).observe("page"===p?e[0].pn.parentNode:e[0].pn,{childList:!0}),Bt.change_mode()}if(Rt&&Rt(),!pref.catalog.filter.kwd.active||"page"!==p&&"catalog"!==p||Kt(),0!==pref.catalog_board_list_sel&&(!pref.catalog.board.all_boards||pref.catalog_board_list_sel!==pref.catalog_board_list_obj.length-1)){var t=cataLog.catalog_refresh_1(p,!1,!1,!1,!1,pref.catalog_board_list_sel,!1,!1),a=site.nickname+site.board+("catalog"===p?"c0":"page"===p?"p0":site.no),n=site.nickname+site.board+("catalog"===p?"j0":"page"===p?"q0":"t"+site.no);Array.isArray(t)&&pref.catalog.refresh.at_switch&&t.indexOf(a)===-1&&t.indexOf(n)===-1&&Ce(0)}Qe.parentNode.removeChild(Qe)},0);var ea=!0;cataLog.insert_myself=De,window.opener&&window.name&&"A"===window.name.slice(-1)||setTimeout(function(){Ie(pref.catalog.refresh.initial&&"boards"!==site.whereami,_,!1)},1),pref[p].merge&&setTimeout(site2.DEFAULT.update_posts_merge_bases.onchange_merge({target:{name:p+".merge"}}),2);var ta=Object.create(null);cataLog.restore_th_from_IDB=Me;Ye=!1,pref_func.mirror_targets.pn12_0_2=tt,pref_func.mirror_targets.pn12_0_4=Ge;var aa=function(e){this.parent=e,this.subscribers=[],this.valid=!1,this.last_viewed=null,this.last_Y=0};return aa.prototype={setup:function(e){!pref[p].scroll_lock||this.valid||e?this.valid&&(this.parent.removeEventListener("mouseover",this.mouseover.bind(this),!0),this.valid=!1):(this.parent.addEventListener("mouseover",this.mouseover.bind(this),!0),this.valid=!0)},mouseover:function(e){this.last_viewed=e.target,this.last_Y=e.clientY},change:function(){var e=pref.script_prefix+"_expander";return function(t){if(t.target.className===e){var a=t.target.getAttribute("data-key");We[a][16].t2h_sel=Ct.get_t2h_from_index(t.target.selectedIndex),We[a][16].expand_posts=!0,scan.scan_ui("expand_page",{tgts:[a],options:{refresh:!0}}),t.target.blur()}}}(),click:function(e){function t(e,t,a){var a=t.target,n=document.createElement("span");if(n.innerHTML=' [<a data-cmd="'+pref.script_prefix+'_remove_next">Remove</a>] ',!a.nextSibling||a.nextSibling.innerHTML!==n.innerHTML){t.target.parentNode.insertBefore(n,a.nextSibling);var r=document.createElement("div");r.innerHTML='<iframe src="'+e+'" width="640" height="360" frameborder="0" allowfullscreen=""></iframe>',r.classList.add("media-embed"),a.parentNode.insertBefore(r,n.nextSibling)}t.stopPropagation(),t.preventDefault()}var a=e.target;if("A"===a.tagName){if(pref.test_mode[93]){var n=a.getAttribute("download");if(n){var r=a.getAttribute("href"),o=r.search(/^(https*:)*\/\//)!=-1&&r.replace(/^(https*:)*\/\//,"").match(/^([^\/]*)\//)[1];if(site2.ALL[o]&&(o=site2[site2.ALL[o]].nickname),o!=site2[site.nickname].domain_url)return httpd.req({tgts:[{url:r,domain:o,archive:n,responseType:"blob"}],max:1,initiator:"download",callback_1:function(){}},6),e.preventDefault(),void e.stopPropagation()}}if(pref.test_mode[87])if(a.href.indexOf("//www.youtube.com")!==-1)t(a.href.replace(/watch\?v=/,"embed/"),e);else if(a.href.indexOf("//youtu.be")!==-1)t(a.href.replace(/youtu.be/,"youtube.com/embed"),e);else{var s=a.getAttribute("data-cmd");s&&0===s.indexOf(pref.script_prefix)&&"remove_next"===(s=s.substr(pref.script_prefix.length+1))&&function(e){e.target.parentNode.parentNode.removeChild(e.target.parentNode.nextSibling),e.target.parentNode.parentNode.removeChild(e.target.parentNode)}(e)}}},get_last_viewed:function(){return this.last_viewed?site2[site.nickname].general_event_handler[site.whereami].get_mark(this.last_viewed,se()+this.last_Y):null},clear_last_viewed:function(){this.last_viewed=null},init:function(e){var t=site2[site.nickname].parse_funcs[site.whereami+"_html"].dynamic_image_hover,a=site2[site.nickname].general_event_handler[site.whereami];a&&a.mouseover&&(a.add_mouseover||t)&&common_func.dom_addEventListener(this.subscribers,this.parent,"mouseover",a.mouseover),common_func.dom_addEventListener(this.subscribers,this.parent,"change",this.change),(pref.test_mode[87]||pref.test_mode[93])&&common_func.dom_addEventListener(this.subscribers,this.parent,"click",this.click),this.setup()},destroy:function(){this.setup(!0),common_func.dom_removeEventListener(this.subscribers)}},cataLog.GEH=aa,cataLog.general_event_handler=new aa(ht),setTimeout(cataLog.general_event_handler.init.bind(cataLog.general_event_handler),500),{destroy:function(){cataLog.general_event_handler.destroy(),Bt.off();for(var e in We)Be(e);pref_func.mirror_targets.pn12_0_2=null,pref_func.mirror_targets.pn12_0_4=null,Ce(0),brwsr.sw_cache&&brwsr.sw_cache.subscribe&&brwsr.sw_cache.subscribe(!1),st.destroy(),cnst.auto_shrink_board_selector.destroy(at),r(),pref_func.tooltips.remove_hier(yt),pref_func.tooltips.remove_root(Ge),pref_func.tooltips.hide(),vt.stop_if_running(),Qe.parentNode.removeChild(Qe),window.removeEventListener("storage",site2[site.nickname].prep_own_posts_event,!1),At.removeEventListener("scroll",Ft,!1),window.removeEventListener("resize",Ft,!1),Qe.removeEventListener("dragstart",a,!1),Qe.removeEventListener("dragend",a,!1),Qe=null,liveTag.pn=null;for(var t in cataLog)cataLog[t]=null;return null},remake_triage:l,triage_exe_pipe:m,catalog_insert:ze,update_all_footers:I,pn12_0_4:Ge,pn12_0_2:tt,catalog_resized:s,get_threads:function(){return We},catalog_filter_changed:be,scan_boards:bt,show_catalog:Kt,catalog_liveTag_scan_site:ft.scanSite}}var i,l,c,p,_,d=null;return cataLog.set_embed_xxxx=a,a(),_||e.addEventListener("click",t,!1),styleSheet.init(p),{catalog_func:function(){return d},scan_tags_common:n,show_hide:t}}function make_chart_obj(e){function t(){cnst.subscribe(c,new _),1===c.length&&(common_func.dom_addEventListener(common_obj.events_beforeunload,window,"focus",a),common_func.dom_addEventListener(common_obj.events_beforeunload,window,"blur",n))}function a(){cnst.foreach(c,function(e){e.chart_posts.options.animation=e.options.animation})}function n(){pref.chart.off_anime_blur&&cnst.foreach(c,function(e){e.chart_posts.options.animation=!1})}function r(){cnst.foreach(c,function(e){e.destroy()})}function o(){return{labels:["dummy","dummy"],datasets:[]}}function s(e,t,a){return{label:e,fillColor:"rgba("+t+","+a+")",strokeColor:"rgba("+t+",1)",pointColor:"rgba("+t+",1)",pointStrokeColor:"#fff",pointHighlightFill:"#fff",pointHighlightStroke:"rgba("+t+",1)",data:[0,0]}}var i='<select name="chart.inst.time_sel"><option>1 min</option><option>10 mins</option><option>1 hour</option><option>1 day</option><option>1 week</option><select>',l=['Number of points: <input type="text" name="chart.inst.len" size="3" style="text-align: right;"><br>','Scale of new thread: <input type="text" name="chart.inst.scale_thread" size="3" style="text-align: right;"><br>',"Show: Posts/Threads:<br>",'&emsp;&emsp;<input type="checkbox" name="chart.inst.show.np"><input type="checkbox" name="chart.inst.show.nt" disabled style="opacity:0"> Estimated, <input type="checkbox" name="chart.inst.clip_np">Clip: <input type="text" name="chart.inst.clip_np_val" size="4" style="text-align: right;"><br>','&emsp;&emsp;<input type="checkbox" name="chart.inst.show.p"><input type="checkbox" name="chart.inst.show.t"> Observed<br>','&emsp;&emsp;<input type="checkbox" name="chart.inst.show.ep"><input type="checkbox" name="chart.inst.show.et"> Alive<br>','<input type="checkbox" name="chart.inst.show_legend">Legend<br>','<input type="checkbox" name="chart.inst.options.animation">Animation (Doesn\'t work on FF)<br>','<input type="checkbox" name="chart.inst.options.pointDot">Point dot: radius <input type="text" name="chart.inst.options.pointDotRadius" size="1" style="text-align: right;"><br>'];if(!e)return{time_unit_sel_html:i,chart_options_str:l};e.addEventListener("click",t,!1);var c=[];window.addEventListener("beforeunload",r,!1);var p=0,_=function(e,t){if(common_func.deep_copy(this,pref.chart.inst),e)this.pn_canvas_root=e,this.pn_canvas_root.style.width=pref.chart.window_width+"px",this.pn_canvas_root.style.height=pref.chart.window_height+"px",this.show={np:!1,p:!0,ep:!1,nt:!1,t:!0,et:!1};else{this.name="graph_"+p++,this.pn2_obj=cnst.init3({this_obj:this,__proto__:this.pn2_template});var a=this.pn2_obj.pn,n=(cnst.add_to_tb(a,i+'<select name="chart.inst.board_sel"><select><button name="settings"><img src="'+cnst.icons.settings+'" style="width:14px;height:14px"></button>'),document.createElement("div"));n.className="CatChan_window",n.style="display:none;clear:both",n.innerHTML=pref_func.format_html_str('<div style="float:right">'+l.join("")+'</div><div style="clear:both"></div>'),a.childNodes[0].appendChild(n),pref_func.apply_prep(a,!1);var r=a.getElementsByTagName("*");cnst.auto_shrink_selector(r["chart.inst.time_sel"]),this.pn_board_sel=r["chart.inst.board_sel"],cnst.auto_shrink_board_selector.setup(this.pn_board_sel,pref.catalog_board_list_sel),this.board_sel=pref.catalog_board_list_sel,this.pn_canvas_root=a.childNodes[1]}this.pn_canvas=document.createElement("canvas"),this.pn_canvas_root.appendChild(this.pn_canvas),this.chart_size_changed(!0),e||(this.legend=cnst.init3({func_str:"border:1px solid lightblue:cursor:move:position:absolute:left:80px:top:40px"}),this.pn2=a,this.set_legend_str(),this.show_legend&&this.append_legend()),this.stats=e?new stats.Stats(this,t,"popup"):new stats.Stats(this,this.get_tgts(),pref.catalog_board_list_obj[this.board_sel][0].key),e||(a.childNodes[0].onchange=this.onchange_entry.bind(this),r.settings.onclick=this.toggle_settings.bind(this),this.pn2_settings=n),this.pn_canvas_root.onclick=this.chart_size_changed.bind(this),e||cnst.bottom_top(a)};return _.prototype={get_tgts:function(e){return cataLog.catalog_refresh_1?cataLog.catalog_refresh_1("chart",!1,!1,!1,e,this.board_sel,!1,!0):[site.nickname+site.board]},board_sel_changed:function(e){e.target.blur();var t=this.get_tgts(pref.chart.instant_scan?this.name:null);"function"==typeof t?t(this.board_sel_changed.bind(this)):this.stats.tgts_changed(t,pref.catalog_board_list_obj[this.board_sel][0].key)},len_changed:function(){this.len>this.stats.len?this.stats.len_changed.call(this.stats,this.len):this.stats.len!=pref.stats.len_capture?this.stats.len_changed.call(this.stats,pref.stats.len_capture):this.replace_data(this.data_src)},chart_size_changed:function(e){this.pn_canvas.style.width=this.pn_canvas_root.style.width,this.pn_canvas.style.height=this.pn_canvas_root.style.height.replace(/px/,"")-10+"px",this.pn_canvas.width=this.pn_canvas_root.clientWidth,this.pn_canvas.height=this.pn_canvas_root.clientHeight-10,e!==!0&&this.chart_redraw()},chart_redraw:function(){this.chart_posts&&this.chart_posts.destroy(),this.data_graph=o();var e=this.data_graph.datasets,t=this.data_src.fromNo,a=this.data_src.rm,n=this.data_src,r=0;this.idxs={};var i=this.idxs;i.np=t&&this.show.np?r++:-1,i.p=this.show.p?r++:-1,i.ep=a&&this.show.ep?r++:-1,i.t=this.show.t?r++:-1,i.et=a&&this.show.et?r++:-1,i.np!=-1&&(e[i.np]=s("post_fromNo","151,187,205",.2)),i.p!=-1&&(e[i.p]=s("Posts","98,152,179",.2)),i.ep!=-1&&(e[i.ep]=s("exist_p","66,119,136",.15)),i.t!=-1&&(e[i.t]=s("Threads","204,0,0",.2)),i.et!=-1&&(e[i.et]=s("exist_t","140,0,0",.2)),pref.test_mode[39]&&e[pref.test_mode.num]&&(e[pref.test_mode.num]=s(e[pref.test_mode.num].label,pref.test_mode.test_str,pref.test_mode.num_f));var l=this.len<this.stats.len?this.stats.len-this.len:0;if(this.data_graph.labels=n.data_l.slice(l),i.p!=-1&&(e[i.p].data=this.stats.merge_1(n.data_p.slice(l),n.data_p_old?n.data_p_old.slice(l):null)),i.t!=-1&&(e[i.t].data=this.stats.merge_1(n.data_t.slice(l),n.data_t_old?n.data_t_old.slice(l):null),1!=this.scale_thread&&this.scale_setup(e[i.t].data)),a&&(i.ep!=-1&&(e[i.ep].data=this.arr_dec_slice(n.data_p,a.data_p,l)),i.et!=-1&&(e[i.et].data=this.arr_dec_slice(n.data_t,a.data_t,l),1!=this.scale_thread&&this.scale_setup(e[i.et].data)),pref.test_mode[40]&&(e[r]=s("old_p","0,255,0",.1),e[r++].data=n.data_p_old.slice(l),e[r]=s("p_raw","98,152,179",.2),e[r++].data=n.data_p.slice(l))),t&&i.np!=-1){if(e[i.np].data=t.data_p_old?t.data_p_old.concat(t.data_p.slice(t.data_p_old.length)).slice(l):t.data_p.slice(l),t.data_p_old){var c=t.data_p_old.length-1;t.data_p[c]>t.data_p_old[c]&&c-l>=0&&(e[i.np].data[c-l]=t.data_p[c])}if(this.clip_np)for(var p=e[i.np].data,_=0;_<p.length;_++)p[_]=this.clip_np_func(p[_]);pref.test_mode[41]&&(e[r]=s("post_fromNo_old","0,255,0",.2),e[r++].data=t.data_p_old.slice(l),e[r]=s("post_fromNo","0,128,0",0),e[r++].data=t.data_p.slice(l))}this.scale_thread_old=this.scale_thread;var d=this.pn_canvas.getContext("2d");this.chart_posts=new Chart(d).Line(this.data_graph,this.options)},clip_np_func:function(e){return e<0?0:e>this.clip_np_val?this.clip_np_val:e},arr_dec_slice:function(e,t,a){for(var n=[],r=0,o=a;o<e.length;o++)n[r++]=e[o]-t[o];return n},scale_setup:function(e,t){if(void 0!==t)for(var a=0;a<e.length;a++)e[a].value=e[a].value/t*this.scale_thread;else for(var a=0;a<e.length;a++)e[a]*=this.scale_thread;return e},scale_changed:function(){this.set_legend_str(),
0!==this.scale_thread_old?(this.scale_setup(this.chart_posts.datasets[this.idxs.t].points,this.scale_thread_old),void 0!==this.idxs.et&&this.data_graph.datasets[this.idxs.et]&&this.scale_setup(this.chart_posts.datasets[this.idxs.et].points,this.scale_thread_old),this.chart_posts.update()):this.chart_redraw(),this.scale_thread_old=this.scale_thread},set_legend_str:function(){var e='<span style="color:rgba(98,152,179,1)">●</span><span style="color: black;"> Posts</span><br><span style="color:rgba(204,0,0,1)">●</span><span style="color: black;"> Threads '+(1==this.scale_thread?"":"x"+this.scale_thread+" ")+"</span>";this.legend.pn.innerHTML=e},toggle_settings:function(e){cnst.show_hide(this.pn2_settings,null,this.legend.pn),cnst.toggleButton(e.currentTarget)},destroy:function(){return brwsr.ff||this.chart_posts.stop(),this.chart_posts.destroy(),this.stats.destroy(),this.stats=null,this.pn2&&(cnst.div_destroy(this.legend.pn,!1,this.legend),cnst.div_destroy(this.pn2,!0,this.pn2_obj),cnst.auto_shrink_board_selector.destroy(this.pn_board_sel),cnst.unsubscribe(c,this)),null},replace_data:function(e){this.stats||(this.stats=e),this.data_src=e,this.chart_redraw()},update_data2:function(e){for(var t=e.shift;t>0;)this.chart_posts.removeData(),t--;for(var a=[],t=e.data_p.length-e.shift;t<e.data_p.length;t++)e.fromNo&&this.idxs.np!=-1&&(a[this.idxs.np]=this.clip_np?this.clip_np_func(e.fromNo.data_p[t]):e.fromNo.data_p[t]),this.idxs.p!=-1&&(a[this.idxs.p]=e.data_p[t]),this.idxs.t!=-1&&(a[this.idxs.t]=e.data_t[t]*this.scale_thread),e.rm&&(this.idxs.ep!=-1&&(a[this.idxs.ep]=e.data_p[t]-e.rm.data_p[t]),this.idxs.et!=-1&&(a[this.idxs.et]=(e.data_t[t]-e.rm.data_t[t])*this.scale_thread)),this.chart_posts.addData(a,e.data_l[t]);var n=this.idxs.p!=-1?this.chart_posts.datasets[this.idxs.p]:null,r=this.idxs.t!=-1?this.chart_posts.datasets[this.idxs.t]:null,o=this.idxs.ep!=-1&&e.rm?this.chart_posts.datasets[this.idxs.ep]:null,s=this.idxs.et!=-1&&e.rm?this.chart_posts.datasets[this.idxs.et]:null,i=this.idxs.np!=-1&&e.fromNo?this.chart_posts.datasets[this.idxs.np]:null,l=e.min_idx-(this.stats.len-this.len),t=e.min_idx;for(l<0&&(t+=-l,l=0);t<e.data_p.length-e.shift;)n&&(n.points[l].value=e.data_p_old&&e.data_p_old[t]>e.data_p[t]?e.data_p_old[t]:e.data_p[t]),r&&(r.points[l].value=(e.data_t_old&&e.data_t_old[t]>e.data_t[t]?e.data_t_old[t]:e.data_t[t])*this.scale_thread),o&&(o.points[l].value=e.data_p[t]-e.rm.data_p[t]),s&&(s.points[l].value=(e.data_t[t]-e.rm.data_t[t])*this.scale_thread),i&&(i.points[l].value=this.clip_np?this.clip_np_func(e.fromNo.data_p[t]):e.fromNo.data_p[t]),l++,t++;e.shift=0,this.chart_posts.update()},append_legend:function(){this.pn2.appendChild(this.legend.pn)},remove_legend:function(){this.pn2.removeChild(this.legend.pn)}},_.prototype.pn2_template={get func_str(){return"left:"+(p-1)%5*20+"px:tile2:get:bottom:"+(p-1)%5*20+":resize:both:float:left:Show:tb:width:"+pref.chart.window_width+"px:height:"+pref.chart.window_height+"px:resize:both:overflow:hidden"},rolldown:_.prototype.append_legend,rollup:_.prototype.remove_legend,maximize:_.prototype.chart_size_changed,maximize_embed_style_pn:{left:"auto",top:"auto",position:"relative",resize:"none"},maximize_embed_style_pnch1:{},maximize_float_style_pnch1:{},exit:_.prototype.destroy},_.prototype.onchange_entry=function(e){var t=pref_func.get_tgt(e.target.name.replace(/chart.inst./,""),this),a=t[1],n="checkbox"===e.target.type?e.target.checked:"text"===e.target.type?parseInt(e.target.value,10):e.target.selectedIndex;t[0][a]=n,this.onchange_funcs[a]&&this.onchange_funcs[a].call(this,e)},_.prototype.onchange_funcs={pointDot:_.prototype.chart_redraw,pointDotRadius:_.prototype.chart_redraw,scale_thread:_.prototype.scale_changed,animation:function(){this.chart_posts.options.animation=this.options.animation},len:_.prototype.len_changed,separate:function(){this.stats.init()},time_sel:function(e){e.target.blur(),this.stats.time_unit_changed(this.time_sel)},board_sel:_.prototype.board_sel_changed,show_legend:function(e){e.target.checked?this.append_legend():this.remove_legend()},clip_np:_.prototype.chart_redraw,clip_np_val:_.prototype.chart_redraw},_.prototype.onchange_funcs.np=_.prototype.onchange_funcs.separate,_.prototype.onchange_funcs.p=_.prototype.onchange_funcs.separate,_.prototype.onchange_funcs.ep=_.prototype.onchange_funcs.separate,_.prototype.onchange_funcs.t=_.prototype.onchange_funcs.separate,_.prototype.onchange_funcs.et=_.prototype.onchange_funcs.separate,{clear:function(){},dump:function(e){},data_update:function(e,t,a){},PostChart:_,time_unit_sel_html:i,chart_options_str:l}}function make_setting_obj(e){function t(){n=a(null==n)}function a(e){function a(e){pref_func.apply_prep(r,e),e&&(listener(),timer_obj.init(),null!=wafd&&wafd.workaround_for_dollchan_pref_changed())}function o(e){var n=e.currentTarget.value;"apply"==n?a(!0):"cancel"==n?t():"ok"==n?(a(!0),t()):"apply+save"==n?(a(!0),localStorage&&(localStorage[pref.script_prefix+".pref"]=JSON.stringify(pref))):"load_default"==n?(pref=pref_default(),a(!1),a(!0),pref_func.obj_init()):"load_samples"==n?pref_func.pref_samples.init():"Dump(csv)"==n?chart_obj.dump("csv"):"Dump(obj)"==n?chart_obj.dump("obj"):"Clear data"==n?chart_obj.clear():"JSON"==n?(pref_func.apply_prep(r.getElementsByTagName("TEXTAREA").overwrite_site2_json_str,!0),pref_func.site2_json()):"EVAL"==n&&(pref_func.apply_prep(r.getElementsByTagName("TEXTAREA").overwrite_site2_eval_str,!0),pref_func.site2_eval())}if(e&&(pref.test_mode[17]?(n=document.createElement("div"),n.innerHTML="<div></div><div></div>",site.root_body.appendChild(n)):n=cnst.init("left:0px:tile:get:bottom:Show:tb",cnst.void_func,cnst.void_func,t,cnst.void_func)[0],r=pref.test_mode[17]?n:n.childNodes[1],r.innerHTML='<div><div style="float:left">Statistics:<br>&emsp;Interval: <input type="text" name="interval_found" size="6" style="text-align: right;">min<br>&emsp;<input type="checkbox" name="check_page"> Show page no. of this thread<br>&emsp;&emsp;<input type="checkbox" name="show_page_fraction"> Show fraction of page No.<br>&emsp;<input type="checkbox" name="check_post"> Show num of new posts in this board<br>&emsp;<input type="checkbox" name="check_thread"> Show num of new threads in this board<br>&emsp;&emsp; Max_capture: <input type="text" name="max_capture" size="6" style="text-align: right;"> points<br>&emsp;&emsp;&emsp;Show recent : <input type="text" name="max_graph" size="6" style="text-align: right;"> points in graph<br>&emsp;&emsp;&emsp;Scale of #threads in graph: <input type="text" name="scale_thread" size="6" style="text-align: right;"><br><!-- &emsp;&emsp;<input type="radio" name="autoconf" value="auto"> Automatic configuration<br>&emsp;&emsp;<input type="radio" name="autoconf" value="manual"> Manual configuration<br> -->&emsp;&emsp;&emsp;<input type="radio" name="aggregator" value="true"> Aggregate data<br>&emsp;&emsp;&emsp;&emsp;<input type="checkbox" name="write_to_ls"> Write to localStrage (server)<br>&emsp;&emsp;&emsp;<input type="radio" name="aggregator" value="false"> Listen from localStrage (client)<br>&emsp;&emsp;<input type="checkbox" name="load_data"> Load data from localStrage at the start<br>&emsp;&emsp;Import format (drop whole text on graph)<br>&emsp;&emsp;&emsp;<input type="radio" name="import_format" value="csv"> csv<br>&emsp;&emsp;&emsp;<input type="radio" name="import_format" value="obj"> obj<br>&emsp;&emsp;<input type="button" value="Dump(csv)"><input type="button" value="Dump(obj)">&emsp;<input type="button" value="Clear data"><br><input type="checkbox" name="auto_start"> Start automatically (Delayed 10sec.)<br><br>For dollchan: (workaround for bugs)<br>&emsp;<input type="checkbox" name="workaround_for_dollchan"> Consistency checker for thubmnails of attached images<br>&emsp;&emsp;runs at<br>&emsp;&emsp;<input type="radio" name="wafd_tb" value="tb">every time when mouse leaves from thumbnail\'s area<br>&emsp;&emsp;<input type="radio" name="wafd_tb" value="reply">only when mouse hovers on the reply button<br>&emsp;<input type="checkbox" name="wafd_open_spoiler"> Open text spoilers<br>&emsp;&emsp;(You must turn off the same function in dollchan beforehand)<br><!-- Post form:<br>&emsp;<input type="checkbox" name="hide_rules"> Hide rules<br>&emsp;<input type="checkbox" name="hide_Go"> Hide \'Go\'<br> --><br><br></div></div><div style="clear: both"><input type="button" value="cancel"><input type="button" value="apply"><input type="button" value="ok">&emsp;<input type="button" value="apply+save"><input type="button" value="load_default"><input type="button" value="load_samples"></div>',pref.test_mode[17]||(a(!1),cnst.bottom_top(n))),!pref.test_mode[17])for(var s=r.getElementsByTagName("input"),i=0;i<s.length;i++)"button"==s[i].type&&(e?s[i].addEventListener("click",o,!1):s[i].removeEventListener("click",o,!1));return e?n:pref.test_mode[17]?(r.innerHTML="",n.parentNode.removeChild(n),null):(r=null,cnst.div_destroy(n,!0))}e.addEventListener("click",t,!1);var n=null,r=null}function make_listener(){function e(e){if(null!==e.newValue&&e.key===pipe_name&&"false"===pref.aggregator){var t=brwsr.JSON_parse(e.newValue);t[0]!=a&&(a=t[0],chart_obj.data_update(t[0],t[1],t[2]),timer_obj.show_page([null,"+"+t[1]+"+"+t[2]+"@"+t[0]]))}}function t(){n||"false"!==pref.aggregator?n&&"true"===pref.aggregator&&(window.removeEventListener("storage",e,!1),n=!1):(window.addEventListener("storage",e,!1),n=!0)}var a,n=!1;return t(),t}function make_timer_obj(e){function t(t){null==n&&(pref.check_page||"true"==pref.aggregator&&(pref.check_thread||pref.check_post))?n=make_timer(e):null!=n&&(t&&(pref.check_page||"false"!=pref.aggregator&&(pref.check_thread||pref.check_post))?t&&n.timer().restart(!1):a())}function a(){n=n.destroy(),e.style.color="gray"}e.addEventListener("click",function(){t(!1)},!1);var n=null;pref.auto_start&&setTimeout(function(){t(!1)},1e4);var r=["",""];return{init:function(){t(!0)},finished:function(){a()},timer:function(){return n},show_page:function(t){null!=t[0]&&(r[0]=t[0]+"@"+cnst.get_time()),t.length>=2&&null!=t[1]&&(r[1]=t[1]),t.length>=3&&null!=t[2]&&(r[0]=t[2]),""!=r[0]&&""!=r[1]?e.textContent=r[0]+", "+r[1]:e.textContent=r[0]+r[1]}}}function make_timer(e){function t(e,t,n){var r=common_func.name2domainboardthread(e,!0)[2].substr(1);a(t.date,r,(new DOMParser).parseFromString(t.responseText,"text/html"))}function a(e,t,a){for(var n=site.get_ops(a),r=_.myself(),o=0;o<n.length;o++)if(r==n[o]){s.str_set(t,o);var i=s.str_get()+"@"+new Date(e).toLocaleTimeString();timer_obj.show_page([null,null,i]),s.prep_next(),_.restart(!0),pref.check_page&&options.func0_exe(s.str_get());break}}function n(e){var t=s.no();if(r(e,_.myself(),t),s.all_got()&&s.no()!=site.max_page){var a=0==i?0:l-i,n="";pref.check_page&&(n=s.str_get()),pref.check_post&&(n=n+"+"+a),pref.check_thread&&(n=n+"+"+p),timer_obj.show_page([n]),s.prep_next(),_.found(),a=parseInt(a,10),(isNaN(a)||null==a)&&(a=0),(pref.check_post||pref.check_thread)&&chart_obj.data_update(_.timestr(),a,p),i=l,pref.check_page&&options.func0_exe(s.str_get())}else timer_obj.show_page([t+"?"]),s.step(),_.missing()}function r(e,t,a){for(var n=site.get_ops(e),r=0;r<n.length;r++)if(t==n[r]){s.str_set(a,r),s.flag_set(2);break}if(t==-1)return n[0];if(0==a&&(s.flag_set(0),l=o(e)),a==site.max_page-1){s.flag_set(1);var i=c.length;if(0!=i){for(var _=n[n.length-1],r=0;r<i&&_!=c[i-r-1];)r++;p=r}else p=0;c=n}}function o(e){for(var t=site.get_posts(e),a=t[0],n=1;n<t.length;n++)t[n]>a&&(a=t[n]);return a}var s=function(){function e(){var e=0;t[0]=-1,t[1]=-1,pref.check_post&&(t[e++]=0),pref.check_thread&&(t[e++]=site.max_page-1);var r=(n+1)%(site.max_page+1);n!=t[0]&&n!=t[1]&&(t[e++]=n),r!=t[0]&&r!=t[1]&&(t[e++]=r);for(var s=0;s<=site.max_page;s++)s!=n&&s!=r&&s!=t[0]&&s!=t[1]&&(t[e++]=s);flag=[!pref.check_post,!pref.check_thread,!o],a=0}var t=[],a=0,n=0,r="",o=pref.check_page;return window.location.href.search(site.thread_keyword)==-1&&(o=!1),e(),{no:function(){return t[a]},step:function(){a=(a+1)%(site.max_page+1)},prep_next:function(){e()},flag_set:function(e){flag[e]=!0},all_got:function(){return flag[0]&&flag[1]&&flag[2]},str_set:function(e,t){o&&e!=site.max_page&&(r=e+"."+t,n=e)},str_get:function(){return r},init:function(){e()}}}(),i=0,l=0,c=[],p=0,_=function(){function t(e){var t=new DOMParser;if(404==p.status)_.dead();else{var a=Date.now();pref.info_server&&s.no()!=site.max_page&&brwsr.sw_cache&&brwsr.sw_cache.setItem(info_raw+"p"+s.no(),{date:a,status:p.status,responseText:p.responseText}),pref.catalog_snoop_refresh&&null!=catalog_obj.catalog_func()&&catalog_obj.catalog_func().catalog_insert(info_raw+"p"+s.no(),{date:a,status:p.status,responseText:p.responseText}),n(t.parseFromString(p.responseText,"text/html"))}}function a(e){p.open("GET",e,!0),p.send(null)}function o(){u||(u=!0,d=cnst.get_time(),i())}function i(){var e=site2[site.nickname].make_url4([site.nickname,site.board,s.no(),"page_html"])[0];s.no()==site.max_page&&(e=window.location.href),a(e)}function l(e){(e||g!=pref.interval_found)&&(c(!1),h=setInterval(o,6e4*pref.interval_found)),g=pref.interval_found}function c(t){null!=h&&clearInterval(h),h=null,t&&(e.style.color="gray")}var p=new XMLHttpRequest;p.addEventListener("load",t,!1),p.addEventListener("error",t,!1),p.addEventListener("abort",t,!1);var d,u=!1,f=0,m=site.max_page+1+5,h=null,g=0;l(!0),o(),e.style.color="#000000";var b=window.location.href.search(site.thread_keyword)!=-1?r(document,-1,-1):-2;return{req:p,found:function(){f=0,u=!1},missing:function(){200==p.status&&f++<m?setTimeout(i,1e3):(f=0,u=!1)},stop:function(e){c(e)},dead:function(){timer_obj.show_page(["Dead"]),c(!0),timer_obj.finished()},myself:function(){return b},restart:function(e){l(e)},timestr:function(){return d},destroy:function(){p.removeEventListener("load",t,!1),p.removeEventListener("error",t,!1),p.removeEventListener("abort",t,!1)}}}();return brwsr.sw_cache&&pref.info_client&&brwsr.sw_cache.subscribe(!0),{destroy:function(){return brwsr.sw_cache&&brwsr.sw_cache.subscribe(!1),_.stop(!0),_.destroy(),null},timer:function(){return _},page_check5:t}}function make_wafd(){function e(t){1==pref.workaround_for_dollchan?(t&&a(),"tb"==pref.wafd_tb?document.getElementById("postform_label_comment").addEventListener("mouseout",e,!1):site.components.postform_submit.addEventListener("mouseenter",e,!1)):"tb"==pref.wafd_tb?document.getElementById("postform_label_comment").removeEventListener("mouseout",e,!1):site.components.postform_submit.removeEventListener("mouseenter",e,!1)}function t(){1==pref.workaround_for_dollchan&&(pref.workaround_for_dollchan=!1,pref.wafd_tb="tb"==pref.wafd_tb?"reply":"tb",e(null),pref.workaround_for_dollchan=!0,pref.wafd_tb="tb"==pref.wafd_tb?"reply":"tb",e(null)),n()}function a(){for(var e=document.getElementsByTagName("input"),t=[],a=0;a<e.length;a++)"file"==e[a].type&&t.push(e[a]);for(var n,r=document.getElementById("postform_row_files"),a=0;a<r.childNodes.length;a++)"left"==r.childNodes[a].align&&(n=r.childNodes[a]);for(var a=0;a<t.length;a++){var o=parseInt(t[a].name.replace(/file_/,""));n.childNodes[o].appendChild(t[a]);var s=document.createEvent("UIEvents");s.initUIEvent("change",!1,!0,window,1),t[a].dispatchEvent(s)}for(var i=document.getElementById("postform_label_comment"),l=!0,a=0;a<t.length;a++){if(""==t[a].value){var c=i.getElementsByTagName("img")[0];void 0!=c&&c.parentNode.removeChild(c)}""!=t[a].value||l?(i.childNodes[a].style.display="",""==t[a].value&&(l=!1)):i.childNodes[a].style.display="none"}}function n(){if(1==pref.wafd_open_spoiler){o=[];for(var e=0;e<document.styleSheets.length;e++)for(var t=0;t<document.styleSheets[e].cssRules.length;t++)document.styleSheets[e].cssRules[t].selectorText&&document.styleSheets[e].cssRules[t].selectorText.search(/spoiler/)!=-1&&o.push(e,t);document.styleSheets[o[0]].cssRules[o[1]].selectorText.search(/hover/)!=-1&&(o.push(o.shift()),o.push(o.shift())),r=document.styleSheets[o[0]].cssRules[o[1]].style.cssText,document.styleSheets[o[0]].cssRules[o[1]].style.cssText=document.styleSheets[o[2]].cssRules[o[3]].style.cssText}else null!=r&&(document.styleSheets[o[0]].cssRules[o[1]].style.cssText=r)}1==pref.workaround_for_dollchan&&e(!1);var r=null,o=[];return 1==pref.wafd_open_spoiler&&n(),{workaround_for_dollchan_pref_changed:function(){t()}}}function make_post_form_obj(e){function t(){site2[site.nickname].postform.activation&&site2[site.nickname].postform.activation();var e=site.postform;if(i){for(site2[site.nickname].postform&&site2[site.nickname].postform.off(o);0!=l.length;)l.pop().style.display="";o.parentNode.insertBefore(o.childNodes[1].childNodes[1].lastChild,o),o.parentNode.removeChild(o)}else{if(null==o){var n=e.offsetLeft-e.scrollLeft,c=e.offsetTop-e.scrollTop+site.header_height();o=cnst.init("left:"+n+"px:top:"+c+"px:overflow:hidden:Show:tb",function(){site.components.postform_comment.focus()},cnst.void_func,t,cnst.void_func)[0],o.id="pn10_debug",s=cnst.add_to_tb(o,'<input type="checkbox" name="prevent_redirection">prevent redirection'),pref_func.apply_prep(s,!1),r=s.childNodes[0],r.onchange=a,o.childNodes[1].innerHTML='<div style="display: none"></div><div></div>',options.func0_prep(o.childNodes[1].childNodes[0],o)}e.parentNode.insertBefore(o,e),o.childNodes[1].childNodes[1].appendChild(e);for(var p=document.getElementsByClassName("label"),_=0;_<p.length;_++)"Go to:"!=p[_].innerHTML&&"Password:"!=p[_].innerHTML||"none"!=p[_].parentNode.style.display&&(p[_].parentNode.style.display="none",l.push(p[_].parentNode));null!=site.postform_rules&&(site.postform_rules.style.display="none",l.push(site.postform_rules)),site2[site.nickname].postform&&site2[site.nickname].postform.on(site.postform),site.components.postform_comment.focus()}i=!i,e.getAttribute("name")===pref.script_prefix+"_draft"&&(e.style.display=i?"":"none")}function a(){if(null!=s&&pref_func.apply_prep(s,!0),1==pref.prevent_redirection){g||(g=cnst.make_iframe("redirect_target"),g.onload=function(){g.location&&"about:blank"!=g.location.href&&g.location.replace("about:blank")});for(var e=0;e<c.length;e++)h[e]=_[e].target,_[e].target="redirect_target"}else for(var e=0;e<c.length;e++)_[e].target=h[e]}if(e.addEventListener("click",t,!1),site2[site.nickname].postform){var n=site2[site.nickname].postform.init();n&&n.addEventListener("click",t,!1)}for(var r,o=null,s=null,i=!1,l=[],c=[],p=[],_=document.getElementsByTagName("form"),d=0;d<_.length;d++)"post"==_[d].method&&p.push(_[d]);for(var d=0;d<p.length;d++)for(var u=p[d].getElementsByTagName("input"),f=0;f<u.length;f++)"submit"==u[f].type&&c.push(u[f]);for(var m=!1,h=[],d=0;d<c.length;d++)c[d].addEventListener("click",function(){m=!0},!1);var g;return 1==pref.prevent_redirection&&a(),{debug:function(){debug()}}}function make_debug_obj(e){function t(e){console.log("debug"),null!=site.components.postform_submit&&(site.components.postform_submit.disabled=!1),post_form_obj&&post_form_obj.debug()}e.addEventListener("click",t,!1)}if(window.top==window.self||""!==window.name){var brwsr={ff:navigator.userAgent.indexOf("Firefox")!=-1,sw_cache:!0,JSON_parse:function(e){var t=JSON.parse(e);for(var a in t)"string"==typeof t[a]&&t[a].search(/^\[.*\]$/)!=-1&&(t[a]=brwsr.JSON_parse(t[a]));return t}};brwsr.innerText=brwsr.ff?"textContent":"innerText",brwsr.Date_parse=brwsr.ff?function(e){var t=Date.parse(e);if(isNaN(t)){var a=e.lastIndexOf(".");t=Date.parse(e.substr(0,a))+parseInt(e.substr(a+1,3))}return t}:Date.parse,brwsr.document_body=brwsr.ff?document.documentElement:document.body,brwsr.mousewheel=brwsr.ff?"DOMMouseScroll":"mousewheel";var DelayBuffer=function(e,t){this.tgt=e,this.delay=t,this.id=null,this.do_tgt=this.do_tgt.bind(this)};DelayBuffer.prototype={do_tgt:function(){this.id=null,this.tgt()},delayed_do:function(e){null===this.id&&(void 0===e&&(e=this.delay),this.id=setTimeout(this.do_tgt,"number"==typeof e?e:this.hasFocus?e.fg:e.bg))},cancel:function(){null!==this.id&&(clearTimeout(this.id),this.id=null)},get_binded_delayed_do:function(){return this.delayed_do.bind(this)},hasFocus:!0};var Watchdog=function(e,t){DelayBuffer.call(this,e,t)};Watchdog.prototype={start:function(e){this.delayed_do(e)},stop:function(){this.cancel()},restart:function(e){this.cancel(),this.delayed_do(e)},__proto__:DelayBuffer.prototype};var pref4={funcs:{set_options_to_selector:function(e,t){e.length=t.length;for(var a=0;a<t.length;a++)e.options[a].text=t[a]}},archive:{IDB_board_sel_gfunc_pre:function(e,t,a,n,r){pref4.funcs.set_options_to_selector(r,pref4.archive.IDB_board_sel_options||["Wait..."])},IDB_board_sel_options:null,IDB_thread_sel_gfunc_pre:function(e,t,a,n,r){pref4.funcs.set_options_to_selector(r,pref4.archive.IDB_thread_sel_options||["Wait..."])},IDB_thread_sel_options:null}},pref=pref_default(),pref3={stats:{use:null,estimate_posts:null},reload_required:!1,catalog:{indexing_old:0,filter:{time_str:function(e,t,a){e[t.replace(/str$/,"obj")]=Date.parse(a)},time_obj:0,kwd:{str:function(e){this.obj&&(this.obj[this.obj[0]===e.target?1:0].value=pref.catalog.filter.kwd.str)},obj:null,clear:function(){this.obj[1].value="",this.obj[1].oninput({target:this.obj[1],currentTarget:this.obj[1]})},init:function(e,t){var a;return this.obj?a=this.obj[1]:(a=e.cloneNode(!1),a.name="catalog.filter.kwd.str",a.oninput=cataLog.event_func,this.obj=[t.getElementsByTagName("input")["catalog.filter.kwd.str"],a]),e.setAttribute("style","display:none"),e.parentNode.insertBefore(a,e.nextSibling),this.clear(),a}}}},notify:{sound:{file:null}},archive:{working:!1,list_str:function(e,t,a){pref_func.str2obj2(e,t.replace(/str$/,"obj2"),a)},list_obj2:null,list_obj3:null,jsons:null,imgs:null,dir:null},proto:{merge_list_str:function(e,t,a){this.merge_list_obj2_old||(this.merge_list_obj2_old=this.merge_list_obj2);var n=null;pref_func.str2obj2(e,"merge_list_obj2",a.replace(/\s*\+/g,",+"),null,null,function(e,t){var a=e.search(/^\s*\+\s*/)!=-1,r=e.replace(/^\s*\+\s*/,"")||"DEFAULT";a&&n?(t[r]=t[n],t[r][t[r].length]=r):(t[r]=[r],n=r)})},merge_list_obj2:null,merge_list_obj2_old:null},test_mode:{js_file:null}};Object.defineProperties(pref3.catalog.filter.kwd,{clear:{value:pref3.catalog.filter.kwd.clear,configurable:!0,enumerable:!1,writable:!0},init:{value:pref3.catalog.filter.kwd.init,configurable:!0,enumerable:!1,writable:!0}});var cataLog={threads:null,insert_footer3:null,scan_boards:null,scan_init:null,catalog_filter_query:null,embed_mode:null,format_html:null,show_catalog:null,show_catalog_cont:null,get_ref_height:null,catalog_obj2:null,healthIndicator:null,parent:null,open_spoiler_text:null,show_catalog_scroll_lock:null,general_event_handler:null,catalog_refresh_1:null,catalog_refresh_end:null,catalog_filter_changed:null,image_hover_add:null,image_hover_reentry:null,image_hover_remove:null,scan_boards_keyword_callback2:null,scan_boards_keyword_callback2_default_args:null,catalog_clear_threads:null,catalog_filter_query_keyword:null,set_watch_time_thread:null,get_watch_time_of_a_thread:null,remove_thread:null,event_func:null,restore_th_from_IDB:null,components:null,triage:null,GEH:null,insert_myself:null},pref_func=function(){return{mirror_targets:{pn12_0_2:null,pn12_0_4:null,pn13_1:null},apply_prep:function(e,t,a,n,r){if(e){var o;if(n){o=[];for(var s in this.mirror_targets)if(this.mirror_targets[s]){var i=this.mirror_targets[s].getElementsByTagName("input")[e.name];i&&(Array.isArray(i)?o=o.concat(Array.prototype.slice.call(i)):o[o.length]=i)}for(var s=o.length-1;s>=0;s--)o[s]===e&&o.splice(s,1);if(0==o.length)return}else if(Array.isArray(e))o=e;else{var l="input,textarea,select"+(t?"":",span[data-class=show_value]");o=Array.prototype.slice.call(e.querySelectorAll(l)),0==o.length&&(o=[e])}this.apply_prep_2(o,t,a,n,r)}},apply_prep_2:function(e,t,a,n,r){for(var o=0;o<e.length;o++){var s=e[o].getAttribute("name");if(s&&"button"!=e[o].type){var i=pref_func.get_tgt(s),l=i[0],c=i[1],p=e[o].tagName;if("INPUT"===p)"file"===e[o].type?(i=pref_func.get_tgt(s,pref3),l=i[0],c=i[1],!t&&l[c]&&l[c]!==e[o]?(e[o].parentNode.insertBefore(l[c],e[o]),e[o].parentNode.removeChild(e[o])):l[c]=e[o]):t?("number"==typeof l[c]?"_f"===e[o].name.substr(-2,2)?l[c]=isNaN(parseFloat(e[o].value))?0:parseFloat(e[o].value):l[c]=isNaN(parseInt(e[o].value,10))?0:parseInt(e[o].value,10):"boolean"==typeof l[c]?l[c]=e[o].checked:"string"==typeof l[c]&&("text"===e[o].type||e[o].checked)&&(l[c]=e[o].value),n||"radio"===e[o].type||this.apply_prep(e[o],!1,!1,!0)):"number"==typeof l[c]?e[o].value=l[c]:"boolean"==typeof l[c]?e[o].checked=l[c]:"string"==typeof l[c]&&("text"===e[o].type?e[o].value=l[c]:l[c]===e[o].value&&(e[o].checked=!0)),(t||r)&&"string"==typeof l[c]&&"text"===e[o].type&&"str"===c.substr(-3,3)&&l[c.substr(0,c.length-3)+"obj"]&&pref_func.str2obj6(l,c,e[o].value,s);else if("TEXTAREA"===p)t?l[c]=e[o].value:e[o].value=l[c],(t||r)&&(c.search(/str$/)!=-1&&l[c.replace(/str$/,"obj")]&&pref_func.str2obj(c),c.search(/str$/)!=-1&&l[c.replace(/str$/,"obj2")]&&pref_func.str2obj2(l,c.replace(/str$/,"obj2"),e[o].value),"str"===c.substr(-3,3)&&l[c.substr(0,c.length-3)+"obj5"]&&pref_func.str2obj5(l,c.substr(0,c.length-3)+"obj5",e[o].value),"str"===c.substr(-3,3)&&null===l[c.substr(0,c.length-3)+"obj6"]&&pref_func.str2obj6(l,c,e[o].value,s));else if("SELECT"===p)t?void 0!==l[c]&&(l[c]=e[o].selectedIndex):(l[c+"_gfunc_pre"]&&l[c+"_gfunc_pre"](l,c,l[c],s,e[o]),l[c]>=e[o].length&&(l[c]=0),e[o].selectedIndex=l[c]);else if("SPAN"===p&&!t&&"show_value"===e[o].getAttribute("data-class")){var _=l[c],d=this.apply_prep_2_str[c+":"+l[c]];d&&(_="string"==typeof d?d:d(l)),e[o].textContent=_.toString().replace(/^./,function(e){return e.toUpperCase()})}a&&(e[o].oninput&&e[o].oninput.call(e[o],{currentTarget:e[o],target:e[o]},!0),e[o].onchange&&e[o].onchange.call(e[o],{currentTarget:e[o],target:e[o]},!0))}}sessionStorage&&(t||r)&&(sessionStorage[pref.script_prefix+".pref"]=JSON.stringify(pref))},apply_prep_2_str:{"t2h_sel:L":function(e){return e.t2h_L},"t2h_sel:M":function(e){return e.t2h_M},"t2h_sel:N":function(e){return e.t2h_N},"t2h_sel:N_unread":function(e){return e.t2h_N+"+unread"},"t2h_sel:unread":"All unread","posts_search_op:opaque":function(e){return"opaque "+e.posts_search_op_opacity+"%"},"popup2:sr":"SearchResult","popup2:srpv":"SearchResult/Preview","popup2:pv":"Preview","popup2:chart":"PostRateChart","popup2:dp":"DeletedPosts"},catalog_board_list_str_or:"",catalog_board_list_str_bt:"",catalog_board_list_str_bt_same:"",add_onchange:function(e,t,a){return this.set_event_target(e,this.add_onchange_entry_func.bind(t),a)},add_onchange_entry_func:function(e,t){var a=e.currentTarget.getAttribute("name");if(t||["INPUT","TEXTAREA","SELECT"].indexOf(e.currentTarget.tagName)==-1||pref_func.apply_prep(e.currentTarget,!0),this[a])this[a].call(e.currentTarget,e);else{var n=a.indexOf(".");if(n!=-1){var r="*"+a.substr(n);if(this[r])this[r].call(e.currentTarget,e);else{var o=a.lastIndexOf(".");if(o!=-1){var r=a.substr(0,o+1)+"*";if(this[r])this[r].call(e.currentTarget,e);else if(n!=-1){var s=a.substr(0,n),i=a.substr(n+1);this[s]&&this[s][i]&&this[s][i](e)}}}}}},add_onchange_format:function(e){for(var t=Object.keys(e),a=0;a<t.length;a++)"string"==typeof e[t[a]]&&(e[t[a]]=e[e[t[a]]]);return e},set_event_target:function(){function e(e){a=e?e.target:null}function t(){a&&pref_func.apply_prep(a,!0)}var a=null;return window.addEventListener("beforeunload",t,!1),function(t,n,r){var o=function(e,t){a=null,n.call(this,e,t)},s=t.getElementsByTagName("*");0==s.length&&(s=[t]);for(var i=0;i<s.length;i++){var l=s[i].getAttribute("name");if(l){var c=s[i].tagName;"INPUT"===c||"TEXTAREA"===c||"SELECT"===c?r&&r[s[i].name]?s[i].oninput=o:(s[i].onchange=o,("INPUT"===c&&"text"===s[i].type||"TEXTAREA"===c)&&(s[i].oninput=e)):"BUTTON"===c?s[i].onclick=o:"A"===c?"SHOW"!==l&&"SHOWALL"!==l&&"HIDEALL"!==l&&"SHOW2"!==l&&"SHOW3"!==l&&"HIDE3"!==l||(s[i].onclick=n):"SPAN"===c&&("SUB"===l&&(s[i].onchange=n),"SHOW2_I"===l&&(s[i].onclick=n))}}return o}}(),str2obj:function(e){var t=e.replace(/str$/,"obj");pref[t]=[],t=pref[t];var a="boards"===site.whereami?site2[site.nickname].boards_sel_from_tags():site.board+("thread"===site.whereami?site.no:"");if("//"===a&&(a="/ROOT_DUMMY/"),a+=","+a+"\n"+pref[e]+"\n",pref.catalog.board.recommendation){var n=site2[site.nickname].get_owners_recommendation();pref_func.catalog_board_list_str_or=n,a=a+n+"\n"}pref.catalog.board.board_tags&&""!==pref_func.catalog_board_list_str_bt&&(a=a+pref_func.catalog_board_list_str_bt+"\n"),pref.catalog.board.board_tags_same&&""!==pref_func.catalog_board_list_str_bt_same&&(a=a+pref_func.catalog_board_list_str_bt_same+"\n");for(var r=a.split("\n"),o=-1,s=0;s<r.length;s++){for(var i=r[s].replace(/\s*\/\/.*/,"").replace(/, +/g,",").split(","),l=0;l<i.length&&""==i[l];)l++;if(i[l]){t[++o]=[],t[o][0]={},t[o][0].key=i[l++];for(var c=0;l<i.length;)""!==i[l]&&(i[l].search(/^\s*#/)!==-1?(t[o][0].tags||(t[o][0].tags=[]),t[o][0].tags[t[o][0].tags.length]=i[l].replace(/\s/g,"")):i[l].search(/^\s*!/)!==-1?(t[o][0].cmds||(t[o][0].cmds=[]),t[o][0].cmds[t[o][0].cmds.length]=i[l].replace(/\s/g,"").substr(1)):(t[o][++c]={},t[o][c].key=i[l].replace(/[\*\^!].*/,"").replace(/\s/g,""),i[l].search(/\*/)!=-1&&(t[o][c].max_page=parseInt(i[l].replace(/[^\*\^!]*[\*\^!]/,"").replace(/[\^!].*/,""),10)),i[l].search(/\^/)!=-1&&(t[o][c].style=i[l].replace(/[^\*\^!]*[\*\^!]/,"").replace(/[\*!].*/,"")))),l++}}pref.catalog.board.all_boards&&(t[t.length]=[{key:"ALL"},{key:site.nickname}]);for(var s=0;s<t.length;s++)for(var l=1;l<t[s].length;l++){var p=t[s][l].key.replace(/\/.*/,"");""==p&&(p=site.nickname);var _="/"+t[s][l].key.replace(/[^\/]*\//,"").replace(/\/.*/,"")+"/";1==l?(t[s][0].domain=p,t[s][0].board=_):(t[s][0].domain!=p&&(t[s][0].domain=null),t[s][0].board!=_&&(t[s][0].board=null))}for(var s=0;s<t.length;s++)for(var l=1;l<t[s].length;l++){var d=common_func.name2domainboardthread(t[s][l].key,!1);t[s][l].key=common_func.name2domainboardthread(t[s][l].key,!0).join(""),""===d[1]&&""===d[2]&&(t[s][0].domains_for_all_boards||(t[s][0].domains_for_all_boards=[]),t[s][0].domains_for_all_boards[t[s][0].domains_for_all_boards.length]=d[0],t[s].splice(l--,1))}},get_tgt:function(e,t,a){t||(t="#"===e[0]?liveTag.tags:pref);for(var n=e.split("."),r=0;r<n.length;r++){if(a&&void 0===t[n[r]])return null;if(r==n.length-1)return[t,n[r]];t=t[n[r]]}},str2obj2:function(){function e(e,t,a,n){if(a){e[t]||(e[t]={});for(var r=a[0].substr(1).split(";"),o=0;o<r.length;o++){var s=r[o].split(":");n&&(1===s.length||"true"===s[1]?s[1]=!0:"false"===s[1]&&(s[1]=!1)),e[t][s[0]]=s[1]}}}function t(t,a){var n=t.replace(/[@\^!].*/,"")||"DEFAULT";void 0===a[n]&&(a[n]={});var r=t.match(/@([^\^!]*)/);r&&(a[n].time=0==r[1]?0:brwsr.Date_parse(r[1])),e(a[n],"style",t.match(/\^[^@!]*/)),e(a[n],"cmd",t.match(/![^@\^]*/),!0)}return function(e,a,n,r,o,s){r||(e[a]={}),tgt=e[a];var i=n.replace(/\s*\/\/.*/gm,"").replace(/\n/g,",").split(/\s*,\s*/);s||(s=t);for(var l=0;l<i.length;l++)i[l]&&s(i[l],tgt);if(o)return tgt;var c=a.replace(/_obj2/,"_obj3");e[c]={};var p=e[c];for(var l in tgt)p[l.replace(/\/[0-9]+$/,"/")]=!0}}(),str2obj5:function(e,t,a){e[t]={},tgt=e[t];for(var n=a.replace(/\s*\/\/.*/gm,"").replace(/\n/g,",").split(","),r=0;r<n.length;r++)if(""!=n[r]){var o=n[r].indexOf(":"),s=o!=-1?n[r].substr(0,o):"DEFAULT";void 0===tgt[s]&&(tgt[s]=[]),tgt[s][tgt[s].length]="/"===n[r][o+1]?new RegExp(n[r].substr(o+2,n[r].lastIndexOf("/")-o-2),n[r].substr(n[r].lastIndexOf("/")+1)):"ex_list_obj5"===t?new RegExp(n[r].substr(o+1).replace(/\*/g,".*")):new RegExp(n[r].substr(o+1).replace(/\*/g,"\\S*(\\s|$)"),"g")}},merge_obj5:function(e,t,a){return this.merge_obj5_all(e,t,a,this.merge_obj5_1)},merge_obj5a:function(e,t,a){return this.merge_obj5_all(e,t,a,this.merge_obj5_1a)},merge_obj5a_sc:function(e,t,a){if(!t)return a;var n=common_func.fullname2dbt(e);return t[e]||t[n[1]+n[2]]||t[n[0]+n[2]]||t[n[2]]||t[n[0]+n[1]]||t[n[1]]||t[n[0]]||t.DEFAULT||a},merge_obj5_all:function(e,t,a,n){var r=common_func.fullname2dbt(e);return a=n(a,t,"DEFAULT"),a=n(a,t,r[0]),a=n(a,t,r[1]),a=n(a,t,r[0]+r[1]),a=n(a,t,r[2]),a=n(a,t,r[0]+r[2]),
a=n(a,t,r[1]+r[2]),a=n(a,t,e)},merge_obj5_1:function(e,t,a){if(t[a]){var n=t[a];e||(e={}),void 0!==e.hit&&(e.hit=!0);for(var r in n)if("object"!=typeof n[r])e[r]=n[r];else{void 0===e[r]&&(e[r]={});for(var o in n[r])e[r][o]=n[r][o]}}return e},merge_obj5_1a:function(e,t,a){return t[a]?t[a].concat(e||[]):e},str2obj6:function(e,t,a,n){var r=pref_func.get_tgt(n,pref3);r[0][r[1]](r[0],t,a)},obj_init_hier:function(e,t){for(var a in e)"object"==typeof e[a]&&t[a]?this.obj_init_hier(e[a],t[a]):"function"==typeof e[a]&&e[a](e,a,t[a])},obj_init:function(){pref_func.str2obj("catalog_board_list_str"),pref_func.str2obj2(pref.catalog,"style_general_list_obj2",pref.catalog.style_general_list_str),pref_func.str2obj2(pref.catalog.board,"ex_list_obj2",pref.catalog.board.ex_list_str),pref_func.str2obj5(pref.liveTag,"ex_list_obj5",pref.liveTag.ex_list_str),pref_func.str2obj5(pref.liveTag,"rm_list_obj5",pref.liveTag.rm_list_str),pref_func.settings.onchange_funcs.archive["kwd.*"](),this.obj_init_hier(pref3,pref)},obj_elim_the_same:function(e,t,a){var n=!0;for(var r in e)"object"==typeof e[r]&&t[r]&&"object"==typeof t[r]?pref_func.obj_elim_the_same(e[r],t[r],!0)?delete e[r]:(n=!1,(Array.isArray(e[r])||Array.isArray(t[r]))&&(e[r]=t[r])):e[r]===t[r]?delete e[r]:(e[r]=t[r],n=!1);return(Array.isArray(e)||Array.isArray(t))&&e.length!==t.length&&(n=!1),a?n:e},site2_json_ex_remove:function(){var e=pref_default();return delete e.catalog_board_list_obj,delete e.catalog.style_general_list_obj2,delete e.catalog.board.ex_list_obj2,delete e.liveTag.ex_list_obj5,delete e.liveTag.rm_list_obj5,e.settings&&delete e.settings,pref_func.obj_elim_the_same(e,pref),e},site2_json_ex:function(e,t){var a=this.site2_json_ex_remove();t||a.catalog.filter&&delete a.catalog.filter,e||a.catalog_board_list_str&&delete a.catalog_board_list_str,a.overwrite_site2_json_str&&delete a.overwrite_site2_json_str,pref.overwrite_site2_json_str=t?'{"pref":{"catalog":{"filter":'+JSON.stringify(a.catalog.filter)+"}}}":'{"pref":'+JSON.stringify(a)+"}"},pref_overwrite:function(e,t,a){for(var n in t)if(void 0!==e[n]){if(a&&typeof t[n]!=typeof e[n])continue;"object"!=typeof t[n]||Array.isArray(t[n])?e[n]!==t[n]&&(e[n]=t[n]):pref_func.pref_overwrite(e[n],t[n],a)}},pref_query:function(e,t){var a="";for(var n in t)void 0!==e[n]&&(a+='"'+n+'":'+("object"!=typeof t[n]||Array.isArray(t[n])?JSON.stringify(e[n]):pref_func.pref_query(e[n],t[n]))+",");return"{"+a.substr(0,a.length-1)+"}"},site2_json:function(query,disable_others,disable_site3){var pn_out=document.getElementsByName("JSON_result")[0];pn_out&&(pn_out.style={});try{if(""!==pref.overwrite_site2_json_str){for(var fields=pref.overwrite_site2_json_str.split('"'),i=0;i<fields.length;)if(fields[i].search(/\/\/.*/)!=-1){for(;i+1<fields.length&&fields[i].search(/\/\/[^\n]*\n/)==-1;)fields[i]+=fields.splice(i+1,1);fields[i]=fields[i].replace(/\/\/[^\n]*(\n|$)/,"")}else i+=2;for(var str=fields.join('"'),ex_count=0,str_out="",count=0,start=0,j=0;j<str.length;j++)if(0==count&&"{"!==str[j]&&" "!==str[j]&&"\n"!==str[j]&&ex_count++,"{"===str[j]&&count++,"}"===str[j]&&0==--count){var obj=JSON.parse(str.substr(start,j-start+1));for(var i in obj)(disable_others||"site2"!==i&&"pref"!==i&&"pref_func"!==i&&"liveTag"!=i)&&(disable_site3||"site3"!==i)||(query?str_out='{"'+i+'":'+pref_func.pref_query(eval(i),obj[i])+"}":pref_func.pref_overwrite(eval(i),obj[i]));start=j+1}pn_out&&(pn_out.textContent=(0!=ex_count?"OK, but there are extra useless strings, ":0!=count?"OK, but there are non-closed brackets, ":"OK, ")+(new Date).toLocaleString(),pn_out.style.color="",""!==str_out&&(document.getElementsByName("overwrite_site2_json_str")[0].value=str_out,pref.overwrite_site2_json_str=str_out))}}catch(e){pn_out&&(pn_out.textContent="ERROR!!!, "+(new Date).toLocaleString(),pn_out.style.color="red"),console.log("ERROR in overwtite strings:"),console.log(pref.overwrite_site2_json_str),console.log(e)}},site2_eval:function(){},tooltips:function(){function e(e){for(var t=e.getElementsByTagName("*"),n=0;n<t.length;n++){var r=t[n].getAttribute("name");r&&(b[r]||b[r]!==!1&&pref.test_mode.tips)&&a(t[n])}}function t(e){for(var t=e.getElementsByTagName("*"),a=0;a<t.length;a++)t[a].hasAttribute("name")&&n(t[a])}function a(e){m.hasOwnProperty(e.name)||(m[e.name]=[]),m[e.name].push(e),e.addEventListener("mouseover",s,!1)}function n(e){if(m.hasOwnProperty(e.name))for(var t=m[e.name],a=0;a<t.length;a++)if(e===t[a]){e.removeEventListener("mouseover",s,!1),t.splice(a,1),0==t.length&&delete m[e.name];break}}function r(e){e.addEventListener("mouseover",s,!1)}function o(e){e.removeEventListener("mouseover",s,!1)}function s(e){if(pref.tooltips.help.show){var t=null,a=e&&(e.target.name||e.target.getAttribute("name"))||this.name;if(a||"LABEL"!==e.target.tagName||(a=e.target.childNodes[0].name),"SHOW2_I"===a&&(a=e.target.previousSibling.childNodes[1].getAttribute("name")),"SHOW2"===a&&(a=e.target.childNodes[1].getAttribute("name")),a){if(null===t&&(t="function"==typeof b[a]?b[a]():b[a],t||(t=b[a.substr(0,a.lastIndexOf(".")+1)+"*"]),t||(t=_(b,a,"")||""),pref.test_mode.tips&&(t="Name: "+a+"\n"+t),t=t.replace(/\n/gm,"<br>").replace(/  /g,"&emsp;")),"#"===a[0])return void b["#*"](e,t);t&&i.call(this,e,t)}}}function i(e,t,a,n){f=n?"info":"help",pref.tooltips[f].show&&(d.innerHTML=t,a&&a(d),null!==g&&(clearTimeout(g),g=null),e&&u!==e.target&&(d.style.left=e.clientX+20+"px",d.style.top=e.clientY+20+"px",u?u.removeEventListener("mouseout",c,!1):(null!==h&&clearTimeout(h),h=setTimeout(l,pref.tooltips[f].popup_delay)),u=e.target,this.addEventListener("mouseout",c,!1)))}function l(e){site.root_body.appendChild(d),h=null}function c(){null===g&&(g=setTimeout(p,pref.tooltips[f].popdown_delay))}function p(){u&&(null===h?d.parentNode.removeChild(d):(clearTimeout(h),h=null),u.removeEventListener("mouseout",c,!1),u=null),g=null}function _(e,t){if(!e)return null;var a=t.indexOf(".");return a==-1?e[t]||e["*"]||null:_(e[t.substr(0,a)],t.substr(a+1))}var d=document.createElement("div");d.style.position="fixed",d.setAttribute("class",pref.script_prefix+"_popUp"),d.style.fontWeight="normal",d.style.zIndex=100;var u=null,f="help",m={},h=null,g=null,b={catalog_refresh_clear:"Clear all threads at update.",catalog_promiscuous:"Gather information whatever.",catalog:{filter:{kwd:{re:"Regular Expression.",ci:"Case insensitive. Don't distinguish uppercase and lowercase.",sentence:'"XXXX YYYY" matches itself instead of matching "XXXX" and/or "YYYY"'},time:"Time : Hide threads which have no posts after the time.",time_creation:"Time(Creation Time) : Hide threads which are created before the time.",time_watch:"Watch: watch threads which have posts after the time.",time_watch_creation:"Watch(Creation Time): watch threads which are created after the time."}},"catalog.filter.tag_search.str":"String for searching tags.","catalog.filter.tag_list":!1,"network.cross_domain":"Use 'direct' if you could, because it's quite light, but it doesn't work in almost of all environments.\n'indirect' usually works well and gives full functionality.\nOr you can use 'GreaseMonkeyM's extension if your browser tend to close steps for cross domain when you connect over X-Frame-Options, but this doesn't provide localStorage/IDB features in remote domains.",debug_mode:"Debug mode.",show_tooltip:"Show this tooltip.","liveTag.rm_list_str":function(){return this.TagExLists()},"liveTag.ex_list_str":function(){return this.TagExLists()},TagExLists:function(){return"String, ...  or\n/RegularExpression/, ... or \nIdentifier:String, ... or \nIdentifier:/RegularExpression/, ...\n\nRegularExpression must be embraced by shashes.\nString list is applied BEFORE extraction, so it costs more than tag list which is applied AFTER extraction. Regular expression in string list accepts flags, so don't forgot to add 'g' flag for usual work, like /some_regexp/g, or it removes the first match only. You can remove both cases using 'i' flag.\n"+this.GeneralRules},catalog_board_list_str:function(){return"How to write 'Board groups'.\n\nName,Identifier, ...\n\nFirst column is a name of board group. The name is shown on the top right corner of catalog and become a key when you store its filter setting to local Storage.\nSecond or later columns are members. Each member is expressed by 'Identifier'. Each line becomes each board group.\nYou can add tags for filtering or picking up threads. Single # means filter, double #(##) means pick up and filter. For example,\n\nCC, lain/λ/, #CatChan // load lain/λ/ and filter by #CatChan, then shows a thread for CatChan in lain/λ/.\nlain#lainchan, lain, #lainchan // load all boards of lain and filter by #lainchan, then show all threads which have the tag(#lainchan).\n#tech, ##tech // load all boards which have #tech from sites which are set in VirtualBoard, and filter by #tech, then show all threads which have the tag(#tech) from sites.\nAnd you can add commands to the last of each line. '!stats' takes statistics if the function is enabled.\n"+this.GeneralRules},GeneralRules:"Double slash(//) is a beginning of comment.\n\nIdentifier:\nIdentifier is a string which contains domain, board and/or thread. You can omit some of them. When some identifiers are dropped, it'll be interpreted as follows. Upper case has the priority.\n\ndomain/board/thread\n/board/thread\ndomain/thread\nthread\ndomain/board/\n/board/\ndomain\n\n'Board identifier' must be expressed in a couple of slashes, like /int/. 'Thread identifier' must be numeric. If the identifier is a word, it'll be treated as a 'Thread identifier' if it is numeric, or it'll be a 'Domain identifier'. Domain identifiers must be one of meguca, lain, 4chan, 8chan or KC","catalog.style_general_list_str":function(){return"Identifier^Style_string\nStyle_string is a string and set to its object.style.XXXX. Therefore you can use all of styles in CSS, which ranges from 'background' or 'border' to 'fontSize', 'width' or 'height'\n"+this.GeneralRules},"catalog.board.recommendation":"Scans 'board announcement' and gets owner's recommendation. This recommendation must be start 'Recommendation: ', and the following part of the line is treated as a line of board groups. The recommendation can be seen in a last line of board groups.",catalog_triage_str:"// 1st column :\n//   KILL : delete forever, and set its style.\n//   TIME : delete until the thread gets new replies, and set its style.\n//   NONE : Don't hide the thread and set its style.\n//   KILL_N : delete forever.\n//   TIME_N : delete until the thread gets new replies.\n//   ATTR : Set its style additionally.\n//   UNDO : undo the last modification.\n//   WATCH : watch this thread, or I've read all replies in this thread.\n//   UNWATCH : unwatch this thread.\n//   STICKY : sticky this thread.\n//   UNSTICKY : unsticky this thread.\n//   SHOW : show this thread always without regard to filter setteings.\n//   UNSHOW : remove 'show' mark.\n// 2nd column : strings in the button.\n// 3rd column : style in HTML.\n// Repeat these as you wish.",overwrite_site2_eval_str:"For developers. This function is killed by security reason. If you want to use, you must uncomment the function 'pref_func.site2_eval' by yourself.","thread_reader.buttons.B":"Bookmark this thread to current catalog.","thread_reader.buttons.UB":"Unbookmark this thread from current catalog.","thread_reader.buttons.X":function(){return"Kill this thread from parent catalog"+(pref.thread_reader.triage_close?", and close.":".")},"thread_reader.buttons.v":function(){return"Hide this thread from parent catalog untill it gets new posts"+(pref.thread_reader.triage_close?", and close.":".")},catalog_open_where:"this tab: open the thread in this tab, and catalog will be closed.\nnew tab always: this enables you to open a thread in multiple tabs.\nnamed tab: this prevents you from opening a thread in multiple tabs.\na fixed tab: this enables you to use a catalog window as a dashboard.","virtualBoard.scan_domains.*":"None: Don't scan.\nBoard: Read boards.json and set them to boardlist, not scan threads at startup. Threads are scanned when you read them.\nThread: Scan all threads at startup.",scanBoard:"Scan selected virtual boards.\nScan this physical board if no virtual board is selected.",scanSite:"Scan all virtual boards.\nScan all boards in this site if no virtual board is selected.","style.fix.*":"Write style strings.","style.copy.*":"Write exact selectorText in CSS, then its styles are copied.",debug_mode:["pipe","","removed threads from catalog"],dummy:"",archive:{kwd:null},"#*":function(e,t){liveTag.tooltip(e,t)}};return b.archive.kwd=b.catalog.filter.kwd,b["catalog.filter.tag_search.re"]=b.catalog.filter.kwd.re,Object.defineProperty(b,"catalog_triage_str",{value:b.catalog_triage_str,enumerable:!0,configurable:!0,writable:!1}),{add_hier:e,remove_hier:t,add_root:r,remove_root:o,show:s,show_1:i,hide:c,str:b}}(),pref_samples:{simple:{catalog_triage_str:"KILL,X,",catalog:{style_general_list_str:"%border:4px solid #d6daf0\n%margin:4px",format:{show:{posts:!0}}}},backwash:{catalog_triage_str:"NONE,O,width:;height:,NONE,O,border:4px solid #ff0000;width:100px;height:100px,NONE,O,border:4px solid #00ff00;width:100px;height:100px,NONE,O,border:4px solid #0000ff;width:100px;height:100px,NONE,O,border:4px solid #ffff00;width:100px;height:100px,NONE,O,border:4px solid #ff00ff;width:100px;height:100px,NONE,O,border:4px solid #00ffff;width:100px;height:100px",catalog_expand_at_initial:!0,page:{click:"expand"},catalog:{format:{show:{style:!0,contents:!0,layout:!0,posts:!0,fileinfo:!0,images_2nd:!0}}}},recommend:{max_threads_at_refresh:500,catalog:{auto_load_filter:!0,auto_save_filter:!0,auto_save_filter_at_refresh:!0,order:{sticky:"first"},board:{board_tags_same:!0},auto_update:!0,auto_update_period:1},page:{auto_update:!0,auto_update_period:1},float:{auto_update:!0,auto_update_period:1}},get easy2(){return pref.easy2},"easy2.presets":function(){var e=[{liveTag:{use:!1,scan:!1},LTfrom:0,VB:{local:0,global:0},network:{fetch_actively:!1}},{liveTag:{use:!1,scan:!0},LTfrom:0,VB:{local:1,global:0},network:{fetch_actively:!1}},{liveTag:{use:!1,scan:!0},LTfrom:0,VB:{local:1,global:1},network:{fetch_actively:!1}},{liveTag:{use:!0,scan:!0},LTfrom:0,VB:{local:2,global:0},network:{fetch_actively:!0}},{liveTag:{use:!0,scan:!0},LTfrom:0,VB:{local:2,global:1},network:{fetch_actively:!0}},{liveTag:{use:!0,scan:!0},LTfrom:0,VB:{local:2,global:2},network:{fetch_actively:!0}},{liveTag:{use:!0,scan:!0},LTfrom:1,VB:{local:2,global:0},network:{fetch_actively:!0}},{liveTag:{use:!0,scan:!0},LTfrom:1,VB:{local:2,global:1},network:{fetch_actively:!0}},{liveTag:{use:!0,scan:!0},LTfrom:1,VB:{local:2,global:2},network:{fetch_actively:!0}}],t=["none","board","thread"],a={catalog:{auto_load_filter:!0,auto_save_filter:!0,auto_save_filter_at_refresh:!0,draw_on_demand:!0},page:{draw_on_demand:!0,load_on_demand:!0}};return function(n){var r=pref.easy2;void 0!==n&&pref_func.pref_overwrite(r,e[n]),r.virtualBoard.scan_domains={};for(var o in pref.virtualBoard.scan_domains)r.virtualBoard.scan_domains[o]=t[o===site.nickname?r.VB.local:r.VB.global];r.liveTag.from=0===r.LTfrom?"op":"post";var s={auto_update:pref.easy2.auto_update,auto_update_period:pref.easy2.auto_update_period};return r.catalog.embed&&pref_func.pref_overwrite(r,{catalog:s}),r.catalog.embed_page&&pref_func.pref_overwrite(r,{page:s}),r.thread.embed&&pref_func.pref_overwrite(r,{thread:s}),(r.catalog.filter.time_watch||r.catalog.filter.time_watch_creation)&&(r.catalog.filter.time_str=new Date(Date.now()-36e5*(r.catalog.filter.time_watch?r.time_post:r.time_op)).toLocaleString()),pref.easy2.basics&&pref_func.pref_overwrite(r,a),r}}(),"easy2.limits":function(){var e=[{virtualBoard:{max:100},scan:{max:100,max_threads:1e3},catalog:{max_threads_at_refresh:500}},{virtualBoard:{max:50},scan:{max:100,max_threads:1500},catalog:{max_threads_at_refresh:1500}},{virtualBoard:{max:150},scan:{max:100,max_threads:15e3},catalog:{max_threads_at_refresh:15e3}},{virtualBoard:{max:100},scan:{max:50,max_threads:15e3},catalog:{max_threads_at_refresh:15e3}},{virtualBoard:{max:150},scan:{max:100,max_threads:3e4},catalog:{max_threads_at_refresh:15e3}},{virtualBoard:{max:200},scan:{max:500,max_threads:1e5},catalog:{max_threads_at_refresh:15e3}},{virtualBoard:{max:200},scan:{max:1e4,max_threads:1e5},catalog:{max_threads_at_refresh:15e3}},{virtualBoard:{max:150},scan:{max:100,max_threads:15e3},catalog:{max_threads_at_refresh:15e3}}];return function(){pref_func.pref_overwrite(pref.easy2,e[pref.easy2.limits])}}(),"easy.virtualBoard_10_passive":{virtualBoard:{show:!0,scan:!0,max:20},catalog:{auto_load_filter:!0,auto_save_filter:!0,auto_save_filter_at_refresh:!0,auto_update:!0,auto_update_period:10},page:{auto_update:!0,auto_update_period:10},float:{auto_update:!0,auto_update_period:10},func:function(){for(var e in pref.virtualBoard.scan_domains)pref.virtualBoard.scan_domains[e]=e===site.nickname?"board":"none"}},"easy.virtualBoard_10":{virtualBoard:{show:!0,scan:!0,max:20},catalog:{auto_load_filter:!0,auto_save_filter:!0,auto_save_filter_at_refresh:!0,auto_update:!0,auto_update_period:10},page:{auto_update:!0,auto_update_period:10},float:{auto_update:!0,auto_update_period:10},func:function(){for(var e in pref.virtualBoard.scan_domains)pref.virtualBoard.scan_domains[e]=e===site.nickname?"thread":"none"}},"easy.virtualBoard_1":{virtualBoard:{show:!0,scan:!0,max:100,scanDelay:20},catalog:{auto_load_filter:!0,auto_save_filter:!0,auto_save_filter_at_refresh:!0,auto_update:!0,auto_update_period:1},page:{auto_update:!0,auto_update_period:1},float:{auto_update:!0,auto_update_period:1},func:function(){for(var e in pref.virtualBoard.scan_domains)pref.virtualBoard.scan_domains[e]=e===site.nickname?"thread":"none"}},"easy.virtualBoard_8_50":{virtualBoard:{show:!0,scan:!0,max:100,scanDelay:20},catalog:{auto_load_filter:!0,auto_save_filter:!0,auto_save_filter_at_refresh:!0,auto_update:!0,auto_update_period:5},page:{auto_update:!0,auto_update_period:5},float:{auto_update:!0,auto_update_period:5},func:function(){pref.scan.max=pref.easy.max_boards;for(var e in pref.virtualBoard.scan_domains)pref.virtualBoard.scan_domains[e]=e===site.nickname?"thread":"none"}},"easy.virtualBoard_8_all":{virtualBoard:{show:!0,scan:!0,max:100,scanDelay:20},scan:{max:1e4},catalog:{auto_load_filter:!0,auto_save_filter:!0,auto_save_filter_at_refresh:!0,auto_update:!0,auto_update_period:5},page:{auto_update:!0,auto_update_period:5},float:{auto_update:!0,auto_update_period:5},func:function(){for(var e in pref.virtualBoard.scan_domains)pref.virtualBoard.scan_domains[e]=e===site.nickname?"thread":"none"}},"easy.virtualBoard_interSite":{virtualBoard:{show:!0,scan:!0,max:100,scanDelay:20},catalog:{auto_load_filter:!0,auto_save_filter:!0,auto_save_filter_at_refresh:!0,auto_update:!0,auto_update_period:10},page:{auto_update:!0,auto_update_period:10},float:{auto_update:!0,auto_update_period:10},func:function(){for(var e in pref.virtualBoard.scan_domains)pref.virtualBoard.scan_domains[e]=e===site.nickname?"thread":"board"}},"easy.posts_0h":{catalog:{filter:{time_str:null,time_watch:!0}},func:function(){pref_func.pref_samples["easy.posts_0h"].catalog.filter.time_str=(new Date).toLocaleString()}},"easy.posts_24h":{catalog:{filter:{time_str:null,time_watch:!0}},func:function(){pref_func.pref_samples["easy.posts_24h"].catalog.filter.time_str=new Date(Date.now()-36e5*pref.easy.posts_ago).toLocaleString()}},"easy.threads_24h":{catalog:{filter:{time_str:null,time_watch_creation:!0}},func:function(){pref_func.pref_samples["easy.threads_24h"].catalog.filter.time_str=new Date(Date.now()-36e5*pref.easy.threads_ago).toLocaleString()}},"easy.embed_index":{catalog:{embed_page:!0,auto_load_filter:!0,auto_save_filter:!0,auto_save_filter_at_refresh:!0}},"easy.embed_index_lazy":{catalog:{embed_page:!0,auto_load_filter:!0,auto_save_filter:!0,auto_save_filter_at_refresh:!0,auto_watch:!1},liveTag:{use:!1},notify:{desktop:{notify:!1}},network:{fetch_actively:!1}},"easy.light":{catalog:{embed_page:!0,auto_load_filter:!0,auto_save_filter:!0,auto_save_filter_at_refresh:!0,draw_on_demand:!0,filter:{time_watch:!1,time_watch_creation:!1}},liveTag:{use:!1},stats:{use:!1},network:{fetch_actively:!1}},"easy.embed_index_infinite":{catalog_max_page_auto:!0,catalog:{embed_page:!0,auto_load_filter:!0,auto_save_filter:!0,auto_save_filter_at_refresh:!0}},"easy.embed_index_backwash":{catalog_max_page_auto:!0,catalog:{embed_page:!0,auto_load_filter:!0,auto_save_filter:!0,auto_save_filter_at_refresh:!0,auto_update:!0,auto_update_period:0},page:{auto_update:!0,auto_update_period:0},float:{auto_update:!0,auto_update_period:0}},"easy.stat_activate":{stats:{use:!0},virtualBoard:{scan:!0,scan_domains:{}},liveTag:{use:!0,from:"post"},func:function(){this.virtualBoard.scan_domains[site.nickname]="board"}},triage_simple_kill:{catalog_triage_str:"KILL,X,"},triage_simple:{catalog_triage_str:"KILL,X,,TIME,v,,WATCH,W,,UNWATCH,UW,,UNDO,U,"},triage_basic:{catalog_triage_str:"KILL,X,,TIME,v,,WATCH,W,,UNWATCH,UW,,SHOW,★,,UNSHOW,☆,,STICKY,S,,UNSTICKY,US,,UNDO,U,"},triage_basic_color:{catalog_triage_str:"KILL_N,X,,TIME_N,v,,WATCH,W,,UNWATCH,UW,,SHOW,★,,UNSHOW,☆,,STICKY,S,,UNSTICKY,US,,UNDO,U,\nNONE,O,,ATTR,O,background:#c3dcf9,ATTR,O,background:#b8efc2,ATTR,O,background:#efedbe,ATTR,O,background:#fbd5fb,ATTR,O,background:#fac2c5\nATTR,O,border:3px solid blue,ATTR,O,border:3px solid lime,ATTR,O,border:3px solid yellow,ATTR,O,border:3px solid orange,ATTR,O,border:3px solid red\n"},triage_colorful:{catalog_triage_str:"KILL,X,,KILL,X,background:#c3dcf9,KILL,X,background:#b8efc2,KILL,X,background:#efedbe,KILL,X,background:#fbd5fb,KILL,X,background:#fac2c5\nTIME,v,,TIME,v,background:#c3dcf9,TIME,v,background:#b8efc2,TIME,v,background:#efedbe,TIME,v,background:#fbd5fb,TIME,v,background:#fac2c5\nNONE,O,,NONE,O,background:#c3dcf9,NONE,O,background:#b8efc2,NONE,O,background:#efedbe,NONE,O,background:#fbd5fb,NONE,O,background:#fac2c5\nUNDO,U,,WATCH,W,,UNWATCH,UW,,GO,G,\n"},triage_borders:{catalog_triage_str:"KILL,X,,KILL,X,border:3px solid blue,KILL,X,border:3px solid lime,KILL,X,border:3px solid yellow,KILL,X,border:3px solid orange,KILL,X,border:3px solid red\nTIME,v,,TIME,v,border:3px solid blue,TIME,v,border:3px solid lime,TIME,v,border:3px solid yellow,TIME,v,border:3px solid orange,TIME,v,border:3px solid red\nNONE,O,,NONE,O,border:3px solid blue,NONE,O,border:3px solid lime,NONE,O,border:3px solid yellow,NONE,O,border:3px solid orange,NONE,O,border:3px solid red\nUNDO,U,,WATCH,W,,UNWATCH,UW,,GO,G,\n"},triage_samples:{catalog_triage_str:"KILL,delete forever,\nTIME,hide until new replies,\nNONE,back to default design,background:;border:;\nNONE,border and background,background:#c3dcf9;border:3px solid blue\nNONE,border 3px,border:3px solid blue\nNONE,background,background:#c3dcf9\nNONE,border 5px,border:5px solid blue\nNONE,border 1px,border:1px solid blue\nNONE,transparent,background:\nNONE,shrink,width:100px;height:100px\nGO,open this thread,\n"},triage_test:{catalog_triage_str:"KILL,X,,TIME,v,,WATCH,W,,UNWATCH,UW,,SHOW,★,,UNSHOW,☆,,STICKY,S,,UNSTICKY,US,,UNDO,U,,ARC,A+,,ARC1,A1,,UARC,A-,"},pn_samples:null,init:function(){if(!pref_func.pref_samples.pn_samples){cnst.make_popup(pref_func.pref_samples,"pn_samples",'General samples:<br><button name="simple">simple</button><br><button name="backwash">backwash</button><br><button name="recommend">recommend for desktop/note</button><br>Triages:<br><button name="triage_simple_kill">simple_kill</button><br><button name="triage_simple">simple</button><br><button name="triage_basic">basic</button><br><button name="triage_basic_color">basic_color</button><br><button name="triage_colorful">colorful</button><br><button name="triage_borders">borders</button><br><button name="triage_samples">samples</button><br><button name="triage_test">test</button><br>',pref_func.pref_samples.onclick_event)}},get_name:function(e,t,a){for(var n in e)"object"!=typeof e[n]?t.push(a+n):pref_func.pref_samples.get_name(e[n],t,a+n+".");return t},onclick_event:function(e,t){t||(t=pref_func.pref_samples[this.name]),t.func&&"function"==typeof t.func&&t.func(),pref_func.pref_overwrite(pref,t),pref_func.pref_overwrite(pref_func.tooltips.str,t);for(var a=pref_func.pref_samples.get_name(t,[],""),n=Array.prototype.slice.call(document.querySelectorAll("*[name]")),r=n.length-1;r>=0;r--)a.indexOf(n[r].name)==-1&&n.splice(r,1);n.length>0&&pref_func.apply_prep(n,!1,!0,null,!0)}},settings:{pn13:null,show_hide:function(e){if(null===pref_func.settings.pn13){var t=(2*e.clientX>window.innerWidth?"right":"left")+":0px:"+(2*e.clientY>window.innerHeight?"bottom:0":"top:"+site.header_height())+"px",a=cnst.init(t+":Show:tb",cnst.void_func,cnst.void_func,pref_func.settings.show_hide,cnst.void_func)[0],n=cnst.add_to_tb(a,'<select name="settings.indexing"><option>'+pref_func.settings.options.join("</option><option>")+"</option></select>");n.getElementsByTagName("select")["settings.indexing"].selectedIndex=pref.settings.indexing,pref_func.settings.pn13=a,pref_func.mirror_targets.pn13_1=a.childNodes[1],pref_func.settings.onchange_funcs["settings.indexing"](),pref_func.add_onchange(n,pref_func.settings.onchange_funcs_formatted),pref_func.tooltips.add_root(pref_func.mirror_targets.pn13_1),cnst.bottom_top(a)}else pref_func.settings.files_store(),pref_func.mirror_targets.pn13_1=null,pref_func.settings.pn13=cnst.div_destroy(pref_func.settings.pn13,!0)},apply_pn13_1:function(e,t){pref_func.apply_prep(pref_func.settings.pn13.childNodes[1],e,t),pref_func.settings.onchange_funcs.pn13_1_warning()},files_store:function(){var e=pref_func.mirror_targets.pn13_1.querySelectorAll('span[name="FILES_ARCHIVE0"]')[0];e&&site.script_body.firstChild.appendChild(e);var t=pref_func.settings.pn13.querySelectorAll("input[type=file]");t.length>0&&pref_func.apply_prep_2(t,!0)},insert_menu:function(e,t){var a=pref_func.settings.options.length-1;pref_func.settings.options.splice(a,0,e),pref_func.settings.htmls.splice(a,0,t)},html_funcs:{show_hide_all_to_header:function(e){return"<span>"+e+'<a name="SHOWALL" style="float:right;cursor:pointer" data-str="[all▲]">[all▼]</a></span>'},show_hide_all:function(e,t){return'<a name="SHOWALL" style="cursor:pointer">['+e+']</a><a name="HIDEALL" style="cursor:pointer">['+t+"]</a>"},show_hide:function(e,t,a){return'<a name="SHOW" style="cursor:pointer" data-str="'+t+'">'+e+'</a><span style="display:none" name="SUB"><br>'+a+"</span>"},expand_thumbnail_inline:function(e){return'2,<ICBX"'+e+'.expand_thumbnail_inline"> Image expansion at click'+this.rollup('3,<ICBX"'+e+'.expand_thumbnail_initial"> Expand all images at initial<br>3,<ICBX"'+e+'.expand_thumbnail_inline_all_after"> Expand all images after clicked one<br>4,<ICBX"'+e+'.thumbnail.inline.ondemand"> On demand loading: <ITB3"'+e+'.thumbnail.inline.ref_height"> % of browser<br>'+this.expand_thumbnail_1(e,"inline"))+"<br>"},expand_thumbnail_hover:function(e){return'2,<ICBX"'+e+'.image_hover"> Image hover'+this.rollup('3,<ICBX"'+e+'.image_prefetch"> Prefetch next image<br>'+this.expand_thumbnail_1(e,"hover")+'<br>3,zIndex: <ITB3"'+e+'.image_hover_zIndex">')+"<br>"},expand_thumbnail_1:function(e,t){var a=e+".thumbnail."+t+".";return'3,<ICBX"'+a+'webm"> Play webm<br>4,<ICBX"'+a+'webm_loop"> Loop<br>4,<ICBX"'+a+'webm_mute"> Mute<br>3,<ICBX"'+a+'limit_width"> Limit to browser\'s width - <ITB3"'+a+'margin_width"> px<br>3,<ICBX"'+a+'limit_height"> Limit to browser\'s height - <ITB3"'+a+'margin_height"> px'},env:function(e,t){return"1,Environment values:(advanced option)"+this.rollup('2,You are using native function of:<br>3,<ICBX"'+e+'.popup_native"> Pop up reply<br>3,<ICBX"'+e+'.expand_thumbnail_inline_native"> Image expansion<br>3,<ICBX"'+e+'.image_hover_native"> Image hover<br>3,<ICBX"'+e+'.colorID_native"> Color ID<br>3,<ICBX"'+e+'.backlink_native"> Backlink<br>3,<ICBX"'+e+'.localtime_native"> Local time'+t)+"<br>"},op_in_search_result:function(e){return"2,"+this.rollup_radio(e+".posts_search_op"," :Unmatched OP in search result",3,"",["show:Show",'opaque:Opaque: <ITB3"'+e+'.posts_search_op_opacity"> %',"hide:Hide"])+'<br>2,<ICBX"'+e+'.auto_config_posts_search"> Auto config and scan at searching posts<br>'},deleted_posts_detection:function(e){return"2,"+this.rollup_radio(e+".deleted_posts.detect"," :Detect deleted posts",4,"3,Detection:<br>",["no:No","passive:Passive detection. Don't make any request","acc:Best effort without any additional requests","full:Full detection, read all posts at first","full_IDB:Full detection with IndexedDB"],'<br>3,<ICBX"'+e+'.deleted_posts.merge"> Merge deleted posts with live posts')},radios:function(e,t,a){for(var n=t+',<IR"'+e+",",r=0;r<a.length;r++)a[r]=n+a[r].replace(/:/,'">');return a.join("<br>")},rollup_radio:function(e,t,a,n,r,o){return'<a name="SHOW2" style="cursor:pointer" data-str="▲]">[<SSV"'+e+'"></span>▼]</a><span name="SHOW2_I">'+t+'</span><span style="display:none" name="SUB"><br>'+n+this.radios(e,a,r)+(o||"")+"</span>"},rollup:function(e){return"&emsp;"+this.show_hide("[▼]","[▲]",e)},format_posts:function(e,t){return'2,<ICBX"'+e+'.open_spoiler_text"> Open text spoiler<br>2,<ICBX"'+e+'.colorID"> Color ID<br>2,<ICBX"'+e+'.backlink"> Backlink<br>2,<ICBX"'+e+'.localtime"> Local time<br>'+t.deleted_posts_detection(e)+'<br>2,<ICBX"'+e+'.mark_new_posts"> Mark new posts<br>'},updates:function(e){return'2,<ICBX"'+e+'.auto_update"> Auto update, every <ITB2"'+e+'.auto_update_period"> min.<br>2,<ICBX"'+e+'.hide_posts_without_images"> Hide posts without images<br>2,<ICBX"'+e+'.merge"> Merge all threads'+this.rollup('2,<ICBX"'+e+'.merge_list"> Merge listed threads<br>3,<textarea style="height:1em" cols="40" name="proto.merge_list_str" placeholder="4chan/c/2887897 + 4chan/c/2880944 + 4chan/c/2888255,"></textarea>')+"<br>"},vb_domains:function(){for(var e="2,Scan targets:<br>3,None/Board/Thread(No/Passive/Active)<br>",t=this.get_domains(),a=0;a<t.length;a++)e+='3,<input type="radio" name="virtualBoard.scan_domains.'+t[a]+'" value="none"><input type="radio" name="virtualBoard.scan_domains.'+t[a]+'" value="board"><input type="radio" name="virtualBoard.scan_domains.'+t[a]+'" value="thread"> '+t[a]+"<br>";return e},get_domains:function(){var e=Object.keys(pref.virtualBoard.scan_domains);return e.unshift(e.splice(e.indexOf(site.nickname),1)[0]),e},make_sel:function(e,t){for(var a='<select name="'+e+'" style="float:none">',n=0;n<t.length;n++)a+="<option>"+t[n]+"</option>";return a+"</select>"}},options:["Easy Setting2:","Easy Setting:","Virtual Board:","Catalog:","Index Page:","Thread:","Floating Catalog:","Gerenal 0","General 1","Board Group","Live Tag","Statistics","Design of FC","Footer","Watcher","Notifiers","JSON Archiver: Store","JSON Archiver: Restore","UIP tracker for 4chan","Command Line Interface","Networking","General 2","Styles","Features","About"],
htmls:['Easy Setting2: --- Welcome to CatChan! ---<br><br>1,0. <button name="easy2.beginner">I\'m a beginner and I just want to try</button>, click this.<br>2,Then a reload will be occur after loading settings for beginner.<br>2,(This will be default after a certain period of test.)<br>2,Or follow next steps to choose your favorite settings.<br><br>1,1. <input type="checkbox" name="easy2.reset"> Reset all settings before loading new one if you prefer.<br>1,2. Select a preset: <select name="easy2.presets" style="float:none"><option>Safe default</option><option>Silent inter-board operability (for beginner)</option><option>Silent inter-site operability</option><option>Active inter-board operability</option><option>Active inter-site ondemand operability</option><option>Active inter-site operability</option><option>Active in-board operability with LiveTag</option><option>Active inter-board operability with LiveTag</option><option>Active inter-site operability with LiveTag</option></select><br>1,3. Select limits for safe: <select name="easy2.limits" style="float:none"><option>General</option><option>/all/ for lain, meguca</option><option>/all/ for 4chan</option><option>8chan with top 50 boards</option><option>8chan with top 100 boards</option><option>8chan with top 500 boards</option><option>8chan with all boards</option><option>/all/ for KC</option></select><br>1,4. Modify details if you want.<br>2,<input type="checkbox" name="easy2.virtualBoard.show"> VirtualBoards, shows <input type="text" name="easy2.virtualBoard.max" size="3" style="text-align: right;"> virtual boards<br>4,Local: <select name="easy2.VB.local" style="float:none"><option>No</option><option>Passive</option><option>Active</option></select>&emsp;Global: <select name="easy2.VB.global" style="float:none"><option>No</option><option>Passive</option><option>Active</option></select><br>2,<input type="checkbox" name="easy2.liveTag.use"> LiveTag, from: <select name="easy2.LTfrom" style="float:none"><option>OP</option><option>Posts</option></select><br>2,<input type="checkbox" name="easy2.catalog.embed"> Use CatChan in catalog<br>2,<input type="checkbox" name="easy2.catalog.embed_page"> Use CatChan in index page<br>2,<input type="checkbox" name="easy2.thread.embed"> Use CatChan in thread<br>2,<input type="checkbox" name="easy2.auto_update"> Auto update, every <input type="text" name="easy2.auto_update_period" size="2" style="text-align: right;"> min.<br>2,<input type="checkbox" name="easy2.notify.desktop.notify"> Desktop notification<br>2,<input type="checkbox" name="easy2.catalog.filter.time_watch"> Hide all threads which have no posts in recent <input type="text" name="easy2.time_post" size="3" style="text-align: right;"> hours<br>2,<input type="checkbox" name="easy2.catalog.filter.time_watch_creation"> Hide all threads which are created before <input type="text" name="easy2.time_op" size="3" style="text-align: right;"> hours ago<br>2,<input type="checkbox" name="easy2.stats.use"> Statistics<br>2,<input type="checkbox" name="easy2.healthIndicator.expand_running"> Show details of running indicators<br>2,<input type="checkbox" name="easy2.network.fetch_actively"> Fetch missing info actively<br>2,<input type="checkbox" name="easy2.basics"> Other basic settings<br>2,Limits for safe: <br>3,At scan: <ITB6"easy2.scan.max"> boards, <ITB6"easy2.scan.max_threads"> threads.<br>3,In a catalog: <ITB6"easy2.catalog.max_threads_at_refresh"> threads.<br>1,5. Click <button name="easy2.apply">Apply</button><br>1,6. Click <button name="save">Save</button> if you want to save your settings to localStorage<br>1,7. Click <button name="reload">Reload</button>, because some setting may need<br>','Easy Setting:<br>&emsp;VBs: virtual boards<br>&emsp;AU: auto update every X min<br>&emsp;<button name="easy.virtualBoard_10_passive">Click</button> 20 VBs / AU 10 min. / passive scan. (for all)<br>&emsp;<button name="easy.virtualBoard_10">Click</button> 20 VBs / AU 10 min. (for lainchan and meguca)<br>&emsp;<button name="easy.virtualBoard_1">Click</button> 100 VBs / AU 1 min. (for 4chan)<br>&emsp;<button name="easy.virtualBoard_8_50">Click</button> 100 VBs / AU 5 min from top <input type="text" name="easy.max_boards" size="3" style="text-align: right;"> boards. (for 8chan)<br>&emsp;<button name="easy.virtualBoard_8_all">Click</button> 100 VBs / AU 5 min from all boards. (for 8chan)<br>&emsp;<button name="easy.virtualBoard_interSite">Click</button> 100 VBs / AU 10 min from all sites. / passive scan. (for all)<br><br>&emsp;<button name="easy.posts_0h">Click</button> I want to check all new posts from now.<br>&emsp;<button name="easy.posts_24h">Click</button> I want to check all posts from <input type="text" name="easy.posts_ago" size="3" style="text-align: right;"> hours ago.<br>&emsp;<button name="easy.threads_24h">Click</button> I want to check all new threads from <input type="text" name="easy.threads_ago" size="3" style="text-align: right;"> hours ago.<br><br>&emsp;<button name="easy.embed_index_lazy">Click</button> Setup for narrow band.<br>&emsp;<button name="easy.embed_index_infinite">Click</button> Setup for infinite scroll.<br>&emsp;<button name="easy.embed_index_backwash">Click</button> Backwash style. (infinite scroll/quick auto update)<br><br>&emsp;<button name="easy.light">Click</button> Setup for light start up.<br>',function(e){return'Virtual Board:<br>&emsp;<input type="checkbox" name="virtualBoard.show"> Show virtual boards, up to: <input type="text" name="virtualBoard.max" size="3" style="text-align: right;"><br>2,<ICBX"virtualBoard.search.show"> Show search bar in boardlist<br>3,<ICBX"virtualBoard.search.re"> Regular Expression<br>&emsp;<input type="checkbox" name="virtualBoard.scan"> Scan at start up, delay: <input type="text" name="virtualBoard.scanDelay" size="2" style="text-align: right;">s<br>&emsp;&emsp;&emsp;Scan: <button name="virtualBoard.scanStart">Start</button>&emsp;<button name="virtualBoard.scanStop">Stop</button><br>'+e.vb_domains()+'&emsp;&emsp;<input type="checkbox" name="virtualBoard.instant_scan"> Instant scan<br>&emsp;Physical boards in boardlist:<br>&emsp;&emsp;<input type="radio" name="virtualBoard.p_board" value="both"> Show as they are<br>&emsp;&emsp;&emsp;<input type="checkbox" name="virtualBoard.p_remove"> Remove virtual boards of the same name<br>&emsp;&emsp;<input type="radio" name="virtualBoard.p_board" value="replace"> Replace with virtual boards<br>&emsp;<input type="checkbox" name="liveTag.show_info_onmouseover"> Show infomation on hover<br>&emsp;Style of selected board:<input type="text" name="liveTag.style_in_str" size="30"><br>&emsp;<input type="checkbox" name="liveTag.style"> Add style:<br>&emsp;&emsp;Unread replies to me:<input type="text" name="liveTag.style_urtm_str" size="30"><br>&emsp;&emsp;Unread replies:<input type="text" name="liveTag.style_ur_str" size="30"><br>'},function(e){return e.show_hide_all_to_header("Catalog:")+'<br>&emsp;<input type="checkbox" name="catalog.embed"> Use CatChan in catalog<br>'+e.expand_thumbnail_hover("catalog")+'&emsp;&emsp;<input type="checkbox" name="catalog.open_spoiler_text"> Open text spoiler<br>&emsp;&emsp;<input type="checkbox" name="catalog.auto_update"> Auto update, every <input type="text" name="catalog.auto_update_period" size="2" style="text-align: right;"> min.<br>&emsp;&emsp;<input type="checkbox" name="page.mark_new_posts"> Mark new posts when you open a thread<br>&emsp;&emsp;<input type="checkbox" name="catalog.save_board_list_sel"> Save board group index<br>2,'+e.rollup_radio("catalog.click_area"," :Click to open the thread",3,"",["thumbnail:Thumbnail","entire:Entire thread card"])+"<br>2,"+e.rollup_radio("catalog.popup2"," :Pop up",3,"",["no:No","sr:Search result","srpv:Search result or preview","pv:Preview","chart:Post rate chart (statistics must be activated)","dp:Deleted posts"])+"<br>2,"+e.rollup_radio("catalog.t2h_sel"," :Num of posts to store for search/preview",3,"3,Posts are stored after the thread was shown at once,<br>3,and you can utilize them to search or get preview.<br>3,The last option is for incremental search for posts.<br>",["no:No (Need a scan for every search)",'N:Last <ITB3"catalog.t2h_num_of_posts"> posts (N posts)',"N_unread:N + all unread posts","unread:All unread posts","ALL:All posts","ALL_agg:All posts from all scanned threads"])+"<br>"+e.op_in_search_result("catalog")+e.deleted_posts_detection("catalog")+"<br><br>1,Environment values:(advanced option)"+e.rollup('2,Native has:<br>3,<ICBX"catalog.env.image_hover_native"> Image hover')+"<br>"},function(e){return e.show_hide_all_to_header("Index Page:")+'<br>&emsp;<input type="checkbox" name="catalog.embed_page"> Use CatChan in index page'+e.rollup('3,Refresh up to:<br>4,<IR"catalog_max_page_select,manual"> <ITB2"catalog_max_page"> pages<br>4,<IR"catalog_max_page_select,auto"> Max pages<br>5,<ICBX"catalog_max_page_auto"> Update automatically')+'<br>&emsp;&emsp;<input type="checkbox" name="page.popup"> Pop up reply<br>'+e.expand_thumbnail_inline("page")+e.expand_thumbnail_hover("page")+e.format_posts("page",e)+'2,<ICBX"page.use_expander_always"> Use CatChan\'s expander always<br>2,'+e.rollup_radio("page.t2h_sel"," :Num of posts to show or search",3,"",["page:Inherit from index page",'L: <ITB3"page.t2h_L"> posts(L posts)','M: <ITB3"page.t2h_M"> posts(M posts)','N: <ITB3"page.t2h_num_of_posts"> posts(N posts)',"N_unread:N + all unread posts","unread:All unread posts","ALL:All posts","ALL_agg:All posts (for incremental posts search)"])+"<br>"+e.op_in_search_result("page")+e.updates("page")+'&emsp;&emsp;<input type="checkbox" name="page.scroll_lock"> Don\'t scroll at update<br>&emsp;<input type="checkbox" name="page.save_board_list_sel"> Save board group index<br><br>'+e.env("page.env","")},function(e){return e.show_hide_all_to_header("Thread:")+'<br>&emsp;<input type="checkbox" name="thread.embed"> Use CatChan in thread<br>&emsp;&emsp;<input type="checkbox" name="thread.popup"> Pop up reply<br>'+e.expand_thumbnail_inline("thread")+e.expand_thumbnail_hover("thread")+e.format_posts("thread",e)+e.updates("thread")+"<br>"+e.env("thread.env",'<br>3,<input type="checkbox" name="thread.env.auto_update_native"> Auto update')},'Floating Catalog:<br>&emsp;&emsp;<input type="checkbox" name="float.auto_update"> Auto update, every <input type="text" name="float.auto_update_period" size="2" style="text-align: right;"> min.<br>&emsp;Click to:<br>&emsp;&emsp;<input type="radio" name="float.click" value="open">Go to/open the thread<br>&emsp;&emsp;<input type="radio" name="float.click" value="expand">Expand/shrink the OP in catalog<br>&emsp;&emsp;&emsp;&emsp;<input type="checkbox" name="catalog_expand_at_initial"> Expand at initial<br>&emsp;&emsp;&emsp;&emsp;<input type="checkbox" name="catalog_expand_at_initial_embed"> Expand at initial in index.<br>&emsp;&emsp;&emsp;&emsp;<input type="checkbox" name="catalog_expand_with_hr"> Insert horizontal splitter when it is expanded<br>&emsp;&emsp;&emsp;<input type="checkbox" name="catalog_no_popup_at_expanded"> Don\'t popup when the catalog is expanded<br>&emsp;&emsp;<input type="radio" name="float.click" value="none">None<br>&emsp;Click area:<br>&emsp;&emsp;<input type="radio" name="float.click_area" value="thumbnail">Thumbnail<br>&emsp;&emsp;<input type="radio" name="float.click_area" value="entire">Entire thread card<br>&emsp;<input type="checkbox" name="float.popup2"> Use pop-up window<br>&emsp;&emsp;appear/disappear:<br>&emsp;&emsp;&emsp;<input type="radio" name="catalog_popdown" value="imm">immediately<br>&emsp;&emsp;&emsp;<input type="radio" name="catalog_popdown" value="delay">delayed <input type="text" name="catalog_popup_delay" size="6" style="text-align: right;"><input type="text" name="catalog_popdown_delay" size="6" style="text-align: right;"> ms<br>&emsp;&emsp;<input type="checkbox" name="catalog_popup_size_fix"> Fix size when you move it<br>&emsp;At initial:<br>&emsp;&emsp;<input type="radio" name="catalog.appearance.initial.state" value="maximized">Maximized<br>&emsp;&emsp;<input type="radio" name="catalog.appearance.initial.state" value="floating">Floating <input type="text" name="catalog.appearance.initial.width" size="4" style="text-align: right;"> x <input type="text" name="catalog.appearance.initial.height" size="4" style="text-align: right;"><br>&emsp;&emsp;<input type="radio" name="catalog.appearance.initial.state" value="top">Embed to top<br>&emsp;&emsp;<input type="radio" name="catalog.appearance.initial.state" value="bottom">Embed to bottom<br>&emsp;<input type="checkbox" name="float.save_board_list_sel"> Save board group index<br>','General 0:<br>&emsp; Open short link<br>&emsp;&emsp;<input type="radio" name="catalog_open_last50" value="no">No. Open entire thread<br>&emsp;&emsp;<input type="radio" name="catalog_open_last50" value="exist">If it exists<br>&emsp;&emsp;<input type="radio" name="catalog_open_last50" value="exist_watch">If it exists and all unread posts are in it<br>&emsp; Open the thread in<br>&emsp;&emsp;<input type="radio" name="catalog_open_where" value="_self">this tab<br>&emsp;&emsp;<input type="radio" name="catalog_open_where" value="_blank">new tab always<br>&emsp;&emsp;<input type="radio" name="catalog_open_where" value="named">named tab<br>&emsp;&emsp;<input type="radio" name="catalog_open_where" value="CatChan_tgt">a fixed tab<br>2,<ICBX"pref2.meguca.historyAPI"> Use historyAPI in meguca<br>&emsp;<input type="checkbox" name="catalog_triage"> Enable triage pop-up<br>&emsp;&emsp;Where to show triage:<br>&emsp;&emsp;&emsp;<input type="radio" name="catalog_triage_place" value="topLeft"> Top left&emsp;&emsp;&emsp;<input type="radio" name="catalog_triage_place" value="topRight"> Top right<br>&emsp;&emsp;&emsp;<input type="radio" name="catalog_triage_place" value="bottomLeft"> Bottom left&emsp;&emsp;<input type="radio" name="catalog_triage_place" value="bottomRight"> Bottom right<br>&emsp;&emsp;pop down delay: <input type="text" name="triage.popdown_delay" size="4" style="text-align: right;">ms<br>&emsp;&emsp;&emsp;<input type="checkbox" name="triage.show_always"> Don\'t pop down while the mouse is on the thread<br>&emsp;&emsp;<input type="checkbox" name="triage.hide_toggle"> Hide useless toggle buttons<br>&emsp;&emsp;Style:<br>&emsp;&emsp;&emsp;<textarea style="height:1em" cols="40" name="catalog_triage_str"></textarea><br><!-- &emsp;<input type="checkbox" name="catalog_enable_cross_board"> Enable cross-board catalog<br> --><!-- &emsp;<input type="checkbox" name="catalog_enable_cross_domain"> Enable cross-domain catalog<br> --><!-- &emsp;&emsp; Cache working in <textarea style="height:1em" cols="20" name="catalog_sw_domain"></textarea><br> -->&emsp;&emsp;Sample triage:<br>&emsp;&emsp;&emsp;<button name="triage_simple_kill">simple_kill</button>&emsp;<button name="triage_simple">simple</button>&emsp;<button name="triage_basic">basic</button>&emsp;<button name="triage_basic_color">basic_color</button><br>&emsp;&emsp;&emsp;<button name="triage_colorful">colorful</button>&emsp;<button name="triage_borders">borders</button>&emsp;<button name="triage_samples">samples</button>&emsp;<button name="triage_test">test</button><br>','General 1:<br>&emsp;Shows in title bar:<br>&emsp;&emsp;<input type="checkbox" name="catalog.appearance.titleBar.filter">Checkbox to show filter<br>&emsp;&emsp;<input type="checkbox" name="catalog.appearance.titleBar.settings">Checkbox to show settings<br>&emsp;&emsp;<input type="checkbox" name="catalog.appearance.titleBar.refresh">Refresh button<br>&emsp;&emsp;<input type="checkbox" name="catalog.appearance.titleBar.num_of_pages">Num of pages to refresh<br>&emsp;&emsp;<input type="checkbox" name="catalog.appearance.titleBar.boards_selector">Boards selector<br><br>&emsp;<input type="checkbox" name="catalog.embed_frame"> Embed to frame<br>&emsp;&emsp;Frame size : &emsp;&emsp;<input type="text" name="catalog_size_frame0_width" size="4" style="text-align: right;">%, &emsp;&emsp;<input type="text" name="catalog_size_frame1_width" size="4" style="text-align: right;">%<br>&emsp;<input type="checkbox" name="catalog.refresh.initial"> Refresh at initial<br>&emsp;&emsp;<input type="checkbox" name="catalog.refresh.except_bt"> Except the page of selecting boards\' tag.<br>&emsp;<input type="checkbox" name="catalog.refresh.at_switch"> Clear and refresh when boards are switched<br>&emsp;<input type="checkbox" name="common.clear_at_manual_scan"> Clear all threads at manual scan<br>&emsp;<input type="checkbox" name="liveTag.rm_404_immediately"> Remove 404 threads immediately<br>&emsp;<input type="checkbox" name="catalog.bookmark_list_rm404"> Remove 404 threads from bookmark<br>&emsp;<input type="checkbox" name="pref2.8chan.utilize_boards_json"> Utilize boards.json in 8chan<br>1,<ICBX"pref2.meguca.utilize_boards_json"> Utilize boardTimestamps in meguca<br>2,<ICBX"pref2.meguca.utilize_boards_json_domain"> Utilize boardTimestamps at refresh in meguca<br>&emsp;<input type="checkbox" name="filter.disable_list_when_kwd_active"> Disable list filter when keyword filter is active<br>','Board Group:<br>&emsp;configuration:<br>&emsp;&emsp;<textarea rows="1" cols="60" name="catalog_board_list_str"></textarea><br>&emsp;&emsp;<input type="checkbox" name="catalog.board.recommendation"> Read owner\'s recommendation &emsp;&emsp;<button name="tag.recommendation_add">Add to list</button><br>&emsp;&emsp;<input type="checkbox" name="catalog.board.all_boards"> Generate all boards group<br>&emsp;&emsp;<input type="checkbox" name="catalog.board.board_tags"> Generate board groups from tags &emsp;&emsp;<button name="tag.scan">Scan</button><br>&emsp;&emsp;<input type="checkbox" name="catalog.board.board_tags_same"> Pick up boards which have the same tag&emsp;&emsp;<button name="tag.same_tag_refresh">Refresh</button><br>&emsp;<input type="checkbox" name="catalog.board.ex_list"> Use exclusive list<br>&emsp;&emsp;<textarea rows="1" cols="40" name="catalog.board.ex_list_str"></textarea><br>&emsp;<input type="checkbox" name="catalog.style_general_list"> Use general style<br>&emsp;&emsp;<textarea rows="1" cols="40" name="catalog.style_general_list_str"></textarea><br>&emsp;<input type="checkbox" name="catalog.mimic_base_site"> Mimic base site<br>&emsp;Scan:<br>&emsp;&emsp;Max scan boards <input type="text" name="scan.max" size="6" style="text-align: right;"><br>&emsp;&emsp;Max found threads <input type="text" name="scan.max_threads" size="6" style="text-align: right;"><br>&emsp;&emsp;Num of crawler: <input type="text" name="scan.crawler" size="2" style="text-align: right;"><br>&emsp;&emsp;&emsp;<input type="checkbox" name="scan.crawler_adaptive"> Spawn adaptively at idle<input type="text" name="scan.crawler_idle_time_to_spawn" size="2" style="text-align: right;">ms<br>','Live Tag:<br>1,From:<br>2,<IR"liveTag.from,op">OP<br>2,<IR"liveTag.from,post">All posts<br>1,<ICBX"liveTag.use"> Live<br>1,max: <ITB2"liveTag.max">, max string length: <ITB2"liveTag.maxstr"><br>1,<ICBX"liveTag.ci"> Case insensitive<br>1,<ICBX"liveTag.inherit_board_name"> Inherits board\'s name<br>2,<ICBX"liveTag.lock_board_name"> Lock & sticky<br>1,<ICBX"liveTag.inherit_board_tags"> Inherits board\'s tags<br>2,<ICBX"liveTag.lock_board_tags"> Lock & sticky<br>1,<ICBX"liveTag.lock_tags_in_op"> Lock & sticky tags in OP<br>1,<ICBX"liveTag.ex_list"> Use exclusive list<br>2,String list to remove before extracting tags<br>3,<textarea rows="1" cols="40" name="liveTag.rm_list_str"></textarea><br>2,Tag list to remove after extracting tags<br>3,<textarea rows="1" cols="40" name="liveTag.ex_list_str"></textarea><br>1,Delay to display:<br>2,Foreground: <ITB4"liveTag.disp_delay.fg">ms<br>2,Background: <ITB4"liveTag.disp_delay.bg">ms<br>1,Click function: tags in <br>2,boardlist / threads<br>2,<IR"liveTag.click_func_bl,pkin"><IR"liveTag.click_func,pkin">None -> Pickup/Include -> None<br>2,<IR"liveTag.click_func_bl,in"><IR"liveTag.click_func,in">None -> Include -> None<br>2,<IR"liveTag.click_func_bl,inex"><IR"liveTag.click_func,inex">None -> Include -> Exclude -> None<br>2,<IR"liveTag.click_func_bl,ex"><IR"liveTag.click_func,ex">None -> Exclude -> None<br>',function(e){return'Statistics:<br>1,<ICBX"stats.use"> Take statistics<br>2,<ICBX"stats.estimate_posts"> Estimate num of posts from posts\' No.<br>2,Default settings:<br>3,Time unit: '+chart_obj.time_unit_sel_html+"<br>3,"+chart_obj.chart_options_str.join("&emsp;&emsp;&emsp;")+'3,Size of window: <ITB4"chart.window_width"> x <ITB4"chart.window_height"><br><br>2,Accumulation:<br>3,<ICBX"stats.load"> Load data<br>4,<ICBX"stats.save"> Save data: <ITB4"stats.len_capture"> points<br>4,Auto acquisition of data:<br>5,<ICBX"stats.auto_acquisition_all"> All board groups which you saw once<br>5,<ICBX"stats.auto_acquisition"> Board groups with \'!stats\'<br>6,<ICBX"stats.auto_acquisition_scan"> Scan all targets at startup with <ITB2"stats.auto_acquisition_scan_delay"> secs delay<br>5,(Targets are colored <span style="background:#b5fbda">green</span> in board selector)<br><br>2,<ICBX"chart.instant_scan"> Instant scan at switching board group<br>2,Delay to draw: <ITB2"stats.draw_delay"> sec.<br>2,<ICBX"chart.off_anime_blur"> Off animation in background<br>2,<ICBX"stats.tolerant"> Tolerant of inaccuracy of server and local clocks<br>5,up to <input type="text" name="stats.tolerance" size="2" style="text-align: right;"> min<br>'},'Design of Floating Catalog:<br><input type="radio" name="catalog.text_mode.mode" value="graphic"> Graphical mode: <input type="text" name="catalog_size_width" size="4" style="text-align: right;"> x <input type="text" name="catalog_size_height" size="4" style="text-align: right;"><br>&emsp;&emsp;<input type="checkbox" name="catalog.format.thumb.resize">Resize thumbnails in embed catalog<br>&emsp;&emsp;<input type="checkbox" name="page.format.thumb.resize">Resize thumbnails in embed page<br>&emsp;&emsp;<input type="checkbox" name="float.format.thumb.resize">Resize thumbnails in float catalog<br>&emsp;&emsp;&emsp;1st thumbnail: <input type="text" name="catalog_size_tn1_width" size="4" style="text-align: right;"> x <input type="text" name="catalog_size_tn1_height" size="4" style="text-align: right;"><br>&emsp;&emsp;&emsp;2nd and later: <input type="text" name="catalog_size_tn2_width" size="4" style="text-align: right;"> x <input type="text" name="catalog_size_tn2_height" size="4" style="text-align: right;"><br>&emsp;Catalog/Pop-up/Search<br><!-- &emsp;&emsp;<input type="checkbox" name="float.format.show.images_2nd"><input type="checkbox" name="float.format.hover.images_2nd"><input type="checkbox" name="float.format.search.images_2nd"> 2nd or more images in OP<br> -->&emsp;&emsp;<input type="checkbox" name="float.format.show.posts"><input type="checkbox" name="float.format.hover.posts"><input type="checkbox" name="float.format.search.posts"> Posts<br>&emsp;&emsp;<input type="checkbox" name="float.format.show.fileinfo"><input type="checkbox" name="float.format.hover.fileinfo"><input type="checkbox" name="float.format.search.fileinfo"> File information<br><!--&emsp;&emsp;<input type="checkbox" name="catalog_checkbox_deletion_show"><input type="checkbox" name="catalog_checkbox_deletion_hover"><input type="checkbox" name="catalog_checkbox_deletion_search"> Checkbox for deletion<br> -->&emsp;&emsp;<input type="checkbox" name="float.format.show.contents"><input type="checkbox" name="float.format.hover.contents"><input type="checkbox" name="float.format.search.contents"> Format contents<br>&emsp;&emsp;<input type="checkbox" name="float.format.show.layout"><input type="checkbox" name="float.format.hover.layout"><input type="checkbox" name="float.format.search.layout"> Format layout<br>&emsp;&emsp;<input type="checkbox" name="float.format.show.style"><input type="checkbox" name="float.format.hover.style"><input type="checkbox" name="float.format.search.style"> Format style<br><!-- &emsp;&emsp;<input type="checkbox" name="catalog_border_show">&emsp;&emsp;&emsp; Show border<br> --><!-- &emsp;&emsp;<input type="checkbox" name="catalog_enable_background">&emsp;&emsp;&emsp; Use backgfound color<br> -->&emsp;Num of posts in thread headline: <input type="text" name="float.t2h_num_of_posts" size="3" style="text-align: right;"><br><input type="radio" name="catalog.text_mode.mode" value="text"> Text mode: <input type="text" name="catalog_size_text_width" size="4" style="text-align: right;"> x <input type="text" name="catalog_size_text_height" size="4" style="text-align: right;"><br>&emsp;<input type="checkbox" name="catalog.text_mode.sub"> Show title<br>&emsp;<input type="checkbox" name="catalog.text_mode.name"> Show op\'s name<br>&emsp;<input type="checkbox" name="catalog.text_mode.com"> Show op\'s comment<br>','Footer:<br>&emsp;<input type="checkbox" name="catalog_footer"> Show information footer<br>&emsp;&emsp;&emsp;<input type="checkbox" name="catalog.footer.br"> Always over/under the image<br>&emsp;&emsp;<input type="checkbox" name="catalog_footer_show_site_name"> Show site\'s name(site)<br>&emsp;&emsp;<input type="checkbox" name="catalog_footer_show_board_name"> Show board\'s name(board)<br>&emsp;&emsp;<input type="checkbox" name="catalog_footer_show_thread_no"> Show thread\'s no(thread)<br>&emsp;&emsp;<input type="checkbox" name="catalog_footer_show_nof_rep"> Show num of new replies(nr)<br>&emsp;&emsp;&emsp;<input type="checkbox" name="catalog_footer_show_nof_rep_to_me"> Show num of new replies to me(nrtm)<br>2,<ICBX"catalog.footer.nl"> Show num of stored live posts(nl)<br>2,<ICBX"catalog.footer.nd"> Show num of deleted posts(nd)<br>&emsp;&emsp;<input type="checkbox" name="catalog.footer.ctime"> Show created time(ctime)<br>&emsp;&emsp;<input type="checkbox" name="catalog.footer.btime"> Show bumped time(btime)<br>&emsp;&emsp;<input type="checkbox" name="catalog.footer.ptime"> Show last posted time(ptime)<br>&emsp;&emsp;<input type="checkbox" name="catalog.footer.prate"> Show post rate(prate)<br>&emsp;&emsp;<input type="checkbox" name="catalog_footer_show_flag"> Show recent flags(flags)<br>&emsp;&emsp;<input type="checkbox" name="catalog_footer_show_page"> Show page No.(page)<br>&emsp;&emsp;<input type="checkbox" name="catalog_footer_show_tag"> Show tags<br>&emsp;&emsp;<input type="checkbox" name="catalog.footer.archived"> Show archived<br>&emsp;&emsp;Design:<br>&emsp;&emsp;&emsp;<input type="radio" name="catalog_footer_design" value="native"> U: nrtm/nr / R: r / I: i / P: page site/board/ flags<br>&emsp;&emsp;&emsp;<input type="radio" name="catalog_footer_design" value="condensed"> nrtm/nr/r/i/page site/board/ flags<br>','Watcher:<br>&emsp;<input type="checkbox" name="liveTag.watch_all"> Watch all boards<br>&emsp;<input type="checkbox" name="catalog.auto_watch"> Auto add to watch list<br>&emsp;<input type="checkbox" name="catalog.unmark_on_hover"> Unmark post on hover<br>&emsp;<input type="checkbox" name="thread_reader.use"> Thread reader<br>&emsp;&emsp;<input type="checkbox" name="thread_reader.own_posts_tracker"> Own posts tracker<br>&emsp;&emsp;&emsp;&emsp;>> (You)<br>&emsp;&emsp;&emsp;&emsp;<input type="radio" name="thread_reader.show_reply_to_me_by" value="anchor"> anchor text<br>&emsp;&emsp;&emsp;&emsp;<input type="radio" name="thread_reader.show_reply_to_me_by" value="plain"> plain text (for dollchan)<br>&emsp;&emsp;&emsp;&emsp;(You) in name field<br>&emsp;&emsp;&emsp;&emsp;<input type="radio" name="thread_reader.show_own_post_by" value="anchor"> name string<br>&emsp;&emsp;&emsp;&emsp;<input type="radio" name="thread_reader.show_own_post_by" value="plain"> plain text<br>&emsp;&emsp;&emsp;<input type="checkbox" name="thread_reader.clean_up_own_posts"> Clean up localStorage at loading embed native catalog<br>&emsp;&emsp;<input type="checkbox" name="thread_reader.sync"> Sync with parent catalog<br>&emsp;&emsp;&emsp;<input type="checkbox" name="thread_reader.triage"> Show triage to parent catalog<br>&emsp;&emsp;&emsp;<input type="checkbox" name="thread_reader.triage_close"> Close window when triage is clicked<br>','Notifiers:<br>&emsp;<input type="checkbox" name="notify.desktop.notify"> Desktop<br>&emsp;&emsp;&emsp;<input type="text" name="notify.desktop.lifetime" size="3" style="text-align: right;"> secs (0 means permanent)<br>&emsp;&emsp;&emsp;max: <input type="text" name="notify.desktop.limit" size="3" style="text-align: right;">, delay: <input type="text" name="notify.desktop.delay" size="3" style="text-align: right;">ms<br>&emsp;&emsp;&emsp;<input type="checkbox" name="notify.desktop.show_last"> Show the last post only<br>&emsp;&emsp;<input type="checkbox" name="notify.desktop.reply_to_me"> New replies to me<br>&emsp;&emsp;<input type="checkbox" name="notify.desktop.reply"> New replies<br>&emsp;&emsp;<input type="checkbox" name="notify.desktop.new_thread"> New threads<br>&emsp;&emsp;<input type="checkbox" name="notify.desktop.appear"> Appear threads<br>&emsp;<input type="checkbox" name="notify.favicon"> Favicon<br>&emsp;<input type="checkbox" name="notify.title.notify"> Show number of unread replies in title<br>&emsp;&emsp;<input type="checkbox" name="notify.title.hide_zero"> Hide unread count in title bar when it is zero<br>&emsp;<input type="checkbox" name="notify.sound.notify"> Sound&emsp;&emsp;<button name="notify.sound.pause">Pause</button><br>&emsp;&emsp;&emsp;<input type="radio" name="notify.sound.src" value="beep">Beep &emsp;freq:<input type="text" name="notify.sound.beep_freq" size="4" style="text-align: right;"> length:<input type="text" name="notify.sound.beep_length_f" size="4" style="text-align: right;"> volume:<input type="text" name="notify.sound.beep_volume_f" size="4" style="text-align: right;"><br>&emsp;&emsp;&emsp;<input type="radio" name="notify.sound.src" value="file">File &emsp;<input type="file" accept="audio/*" name="notify.sound.file"><br>&emsp;&emsp;<input type="checkbox" name="notify.sound.reply_to_me"> New replies to me<br>&emsp;&emsp;<input type="checkbox" name="notify.sound.reply"> New replies<br>&emsp;&emsp;<input type="checkbox" name="notify.sound.new_thread"> New threads<br>&emsp;&emsp;<input type="checkbox" name="notify.sound.appear"> Appear threads<br>',function(e){return archiver.event_funcs.queryQuota(),
"JSON Archiver: Store<br><br>1,1. Make sure DOWNLOAD DIRECTORY to be set correctly."+e.rollup("2,All files will be into the directory.<br>2,And also, make sure each download doesn't ask you anything.<br>2,So many files will be downloaded.")+'<br>1,2. Select sources for each target:<br>2,File: Manual/Auto<br>3,<ICBX"archive.oneshot.post"><ICBX"archive.live.post"> Posts<br>3,<ICBX"archive.oneshot.tn"><ICBX"archive.live.tn"> Thumbnails<br>3,<ICBX"archive.oneshot.img"><ICBX"archive.live.img"> Images (original size)<br>3,<ICBX"archive.oneshot.webm"><ICBX"archive.live.webm"> Webms<br>2,IndexedDB: Manual/Auto'+e.rollup('4,<ICBX"archive.IDB.auto_clean"> Automatic clean up<br>4,<ICBX"archive.IDB.auto_clean_init"> Automatic clean up at start up<br>4,Delayed pruning: <ITB3"archive.IDB.prune"> hours<br>5,<ICBX"archive.IDB.prune_flush"> Archive to file at pruning<br>4,num of transactions: <ITB3"archive.IDB.nof_tr"><br>4,num of requests in a cluster: <ITB3"archive.IDB.nof_cl"> - <ITB3"archive.IDB.nof_cl_max"><br>4,watchdog timer: <ITB3"archive.IDB.watchdog">s')+'<br>4,used / limit: <span name="SHOW_QUOTA"></span><button name="archive.queryQuota"><img src="'+cnst.icons.refresh+'" style="width:1em;height:1em"></button><br>3,<ICBX"archive.oneshot.post_idb"><ICBX"archive.live.post_idb"> Posts<br>3,<ICBX"archive.oneshot.tn_idb"><ICBX"archive.live.tn_idb"> Thumbnails<br>3,<ICBX"archive.oneshot.img_idb"><ICBX"archive.live.img_idb"> Images (original size)<br>3,<ICBX"archive.oneshot.webm_idb"><ICBX"archive.live.webm_idb"> Webms<br>1,3. <ICBX"archive.list_inherit"> Inherit previous archiving list<br>1,4a. <ICBX"archive.store_auto"> Auto archiving if OP matches:<br>2,Keyword: <input type="text" name="archive.kwd.str" size="25">'+pref_func.settings.html_funcs.make_sel("archive.kwd.match",["match all","match any","unmatch all","unmatch any"])+'<br>3,<ICBX"archive.kwd.sub">Subject <ICBX"archive.kwd.name">Name <ICBX"archive.kwd.com">Comment <br>3,<ICBX"archive.kwd.ci">CI <ICBX"archive.kwd.sentence">Sentence <ICBX"archive.kwd.re">RE<br>1,4b. <ICBX"archive.list"> List picker<br>2,<textarea rows="1" cols="40" name="archive.list_str" placeholder="lain  // whole lainchan\n/tech/  // whole /tech/\n/q/1234  // thread /q/1234"></textarea><br>1,4c. <BTN"archive.oneshot,OneShotArchive"> or <BTN"archive.start,StartArchiving"><br>3,<IR"archive.src,shown"> All shown threads<br>3,<IR"archive.src,watched"> All watched threads<br>3,<IR"archive.src,stored"> All stored threads<br>1,4d. You can select target threads individually using triage<br>'},function(e){return 2===pref.archive.files_sel&&archiver.event_funcs.queryList(),'JSON Archiver: Restore<br><br>1,1. Open a live catalog, index page or thread to be overriden.<br>2,CatChan must be working in it.<br>1,2. Select where to extract<br>2,<IR"archive.format,auto">Select from filename: Domain-Board-No_Sub.json<br>2,<IR"archive.format,manual">Set manually: '+e.make_sel("archive.domain",e.get_domains())+'/<ITB5"archive.board">/No.<br>1,3a. <ICBX"archive.IDB.auto_restore"> Automatic restore from IndexedDB<br>3,<ICBX"archive.IDB.auto_restore_remove"> Remove deleted thread from display<br>1,3b. Select source from: '+e.make_sel("archive.files_sel",["Dir","Files","IndexedDB"])+'<br><span name="FILES_ARCHIVE0"'+(0===pref.archive.files_sel?"":' style="display:none"')+'>&emsp;&emsp;<span><IF"archive.dir" multiple webkitdirectory directory><BTN"archive.files_clear,X"></span><br></span><span name="FILES_ARCHIVE1"'+(1===pref.archive.files_sel?"":' style="display:none"')+'>&emsp;&emsp;JSONs/HTMLs: <IF"archive.jsons" multiple accept=".html,.json,text/*"><br>2,<ICBX"archive.load_img"> Images: <IF"archive.imgs" multiple webkitdirectory directory><br></span><span name="FILES_ARCHIVE2"'+(2===pref.archive.files_sel?"":' style="display:none"')+'>&emsp;&emsp;<span><select name="archive.IDB_board_sel"'+(pref.archive.IDB_select_multiple?" multiple":"")+' style="float:none"></select><select name="archive.IDB_thread_sel" style="float:none'+(pref4.archive.IDB_thread_sel_options?'"':';display:none"')+(pref.archive.IDB_select_multiple?" multiple":"")+"></select></span>"+e.rollup('&emsp;&emsp;<ICBX"archive.IDB_select_multiple"> Multiple select<br>&emsp;&emsp;Export selected &emsp;&emsp;&emsp;&emsp;<BTN"archive.IDB.export_thread,Threads"><br>&emsp;&emsp;Reset archived time of selected <BTN"archive.IDB.reset_time,Threads">')+e.rollup('&emsp;&emsp;Delete selected <BTN"archive.IDB.delete_board,Boards"><BTN"archive.IDB.delete_thread,Threads"><BTN"archive.IDB.delete_imgs,Images">')+'<br></span>&emsp;&emsp;<BTN"archive.restore_button,Restore"> <ICBX"archive.restore_auto"> Auto restore after selection<br>3,<ICBX"archive.clear_threads"> Clear all threads at opening an archive<br>3,<ICBX"archive.fix_inconsistency"> Fix inconsistencies at open<br>'},'UIP tracker for 4chan:<br>1,<ICBX"uip_tracker.on"> Show num of unique IPs after post No.<br>3, Check interval: <ITB3"uip_tracker.interval">sec, <ICBX"uip_tracker.adaptive"> Adaptive<br>3, Style of changes: <ITBL30"uip_tracker.highlight_str"><br>2,<ICBX"uip_tracker.posts"> Show num of posts<br>2,<ICBX"uip_tracker.deletion.show"> Show deleted posts\' No.<br>2, Apply style to deleted post:<br>3,<ICBX"uip_tracker.deletion.name"> Add style to name: <ITBL30"uip_tracker.deletion.name_str"><br>3,<ICBX"uip_tracker.deletion.addName"> Add <ITBL30"uip_tracker.deletion.addName_str"> to name<br>3,<ICBX"uip_tracker.deletion.post"> Add style to post: <ITBL30"uip_tracker.deletion.post_str"><br>2,<ICBX"uip_tracker.auto_open"> Open next thread automatically<br>3,Conditions:<br>4,After <input type="text" name="uip_tracker.auto_open_th" size="3" style="text-align: right;">th post<br>4,OP contains <textarea style="height:1em" cols="20" name="uip_tracker.auto_open_kwd"></textarea><br>2,<ICBX"uip_tracker.sage.detect"> Sage detection, tolerance: <ITB2"uip_tracker.sage.tolerance"> sec<br>3,<ICBX"uip_tracker.sage.name"> Add style to name: <ITBL30"uip_tracker.sage.name_str"><br>3,<ICBX"uip_tracker.sage.addName"> Add <ITBL30"uip_tracker.sage.addName_str"> to name<br>3,<ICBX"uip_tracker.sage.post"> Add style to post: <ITBL30"uip_tracker.sage.post_str"><br>3,Bug patch for corrupted data<br>4,<ICBX"uip_tracker.sage.patch_bug3"> Ignore corrupted data at head by history<br>4,<ICBX"uip_tracker.sage.patch_bug2"> Loose detection, to <ITB2"uip_tracker.sage.patch_bug2nth">th thread<br>4,<ICBX"uip_tracker.sage.patch_bug"> Re-evaluate and recover<br>','Command interface for overwriting preference<br>&emsp;<textarea style="height:1em" cols="40" name="overwrite_site2_json_str"></textarea><br>&emsp;<button name="JSON_ex">extract</button><button name="JSON_ex_full">extract_full</button><button name="JSON_ex_filter">extract_current_filter</button>&emsp;<button name="JSON_query">query</button>&emsp;<button name="JSON_query_boards">query_boards</button>&emsp;&emsp;<button name="JSON">JSON</button><span name="JSON_result"></span><br>&emsp;<textarea style="height:1em" cols="40" name="overwrite_site2_eval_str"></textarea><br>&emsp;<button name="EVAL">EVAL</button><br>',function(e){return'Networking:<br>1,Timeout: <ITB3"network.timeout"> sec.<br>&emsp;Cross domain connection:<br>'+e.radios("network.cross_domain",2,["direct: Direct connection",'indirect: Indirect connection<br>3,<ICBX"network.overXFO"> Over X-Frame-Options<br>3,<ICBX"network.overCSPF"> Over Content Security Policy frame',"GM: GreaseMonkey's extension"])+'<br>&emsp;Data source:<br>&emsp;&emsp;<input type="radio" name="catalog.design" value="page">Page<br>&emsp;&emsp;<input type="radio" name="catalog.design" value="auto">Auto<br>&emsp;&emsp;<input type="radio" name="catalog.design" value="catalog">Catalog<br>&emsp;&emsp;&emsp;<input type="checkbox" name="catalog.catalog_json"> From json file<br>1,Lazy load/draw<br>2,Catalog/IndexPage/Float <br>3,<ICBX"catalog.lazyDraw_merge" style="opacity:0"><ICBX"page.lazyDraw_merge"><ICBX"float.lazyDraw_merge" style="opacity:0"> Draw posts<br>3,<input type="checkbox" name="catalog.draw_on_demand"><input type="checkbox" name="page.draw_on_demand"><input type="checkbox" name="float.draw_on_demand"> Draw threads<br>3,<input type="checkbox" name="catalog.load_on_demand"><input type="checkbox" name="page.load_on_demand"><input type="checkbox" name="float.load_on_demand"> Load HTMLs/JSONs<br>2,<input type="checkbox" name="network.adaptive"> Adaptive<br>3,100%: new <input type="text" name="network.th100" size="3" style="text-align: right;"> threads, <input type="text" name="network.th100_delay" size="4" style="text-align: right;"> ms delay<br>3,20%: new <input type="text" name="network.th20" size="3" style="text-align: right;"> threads, <input type="text" name="network.th20_delay" size="4" style="text-align: right;"> ms delay<br>1,<input type="checkbox" name="network.fetch_actively"> Fetch missing info actively<br>1,<input type="checkbox" name="healthIndicator.show"> Health indicator, history: <input type="text" name="healthIndicator.max" size="2" style="text-align: right;"><br>2,<input type="checkbox" name="healthIndicator.expand_running"> Show details of running indicators<br>2,<input type="checkbox" name="healthIndicator.dont_retire_running"> Don\'t retire running indicators<br>2,<input type="checkbox" name="healthIndicator.cancel"> Cancel scan when it is clicked<br>'},'General 2:<br>&emsp;Localtime offset<input type="text" name="localtime_offset" size="2" style="text-align: right;"><br>Share loaded html with other tabs to update<br>&emsp;<input type="checkbox" name="info_server"> Broadcast loaded html to other tabs (server)<br>&emsp;<input type="checkbox" name="info_client"> Listen other tab\'s broadcasting (client)<br>Cloudflare<br>&emsp;<input type="checkbox" name="cloudflare.auto_reload"> Auto reload at server error<br>&emsp;&emsp;<input type="text" name="cloudflare.auto_reload_time" size="2" style="text-align: right;"> minutes after<br><br><input type="checkbox" name="tooltips.info.show"> Show infotips<br>&emsp;pop up delay: <input type="text" name="tooltips.info.popup_delay" size="4" style="text-align: right;"> ms<br>&emsp;pop down delay: <input type="text" name="tooltips.info.popdown_delay" size="4" style="text-align: right;"> ms<br><input type="checkbox" name="tooltips.help.show"> Show tooltips<br>&emsp;pop up delay: <input type="text" name="tooltips.help.popup_delay" size="4" style="text-align: right;"> ms<br>&emsp;pop down delay: <input type="text" name="tooltips.help.popdown_delay" size="4" style="text-align: right;"> ms<br>Misc.<br><input type="checkbox" name="recovery.comment"> Recover comment when browser was crashed<br><input type="checkbox" name="catalog_auto_update_countdown"> Show count down to auto update<br><input type="checkbox" name="catalog_footer_ignore_my_own_posts"> Ignore my own posts at counting unread posts<br><input type="checkbox" name="pref2.KC.summer_time"> Summer time in KC<br><br>Patches<br><input type="checkbox" name="patch.delayed_invoke.use"> Delayed invoke for 4chan on FF, <input type="text" name="patch.delayed_invoke.sec" size="2" style="text-align: right;">sec.<br>','Styles:<br>1,Windows and popups:<br>2,<IR"style.sel,fix"> Fixed <BTN"style.fix.reset,reset"><br>3,Title bar:<ITBL30"style.fix.titleBar_str"><br>3,Window:<ITBL30"style.fix.window_str"><br>3,Pop up:<ITBL30"style.fix.popUp_str"><br>2,<IR"style.sel,copy"> Copy from CSS <BTN"style.copy.reset,reset"><br>3,Title bar:<ITBL30"style.copy.titleBar_str"><br>3,Window:<ITBL30"style.copy.window_str"><br>3,Pop up:<ITBL30"style.copy.popUp_str"><br>1,Others:<br>2,New post:<ITBL30"style.post_new"><br>2,Editing post:<ITBL30"style.post_editing"><br>','Features:<br><input type="checkbox" name="features.page"> Page<br><input type="checkbox" name="features.graph"> Graph<br><input type="checkbox" name="features.setting2"> Setting2<br><input type="checkbox" name="features.postform"> Postform<br><input type="checkbox" name="features.catalog"> Catalog<br><input type="checkbox" name="features.listener"> Listener<br><input type="checkbox" name="features.uip_tracker"> UIP_tracker<br><input type="checkbox" name="features.thread_reader"> Thread Reader<br><input type="checkbox" name="features.recovery"> Recovery comment<br>Notifications:<br>&emsp;<input type="checkbox" name="features.notify.desktop"> DesktopNotification<br>&emsp;<input type="checkbox" name="features.notify.sound"> Sound<br>&emsp;<input type="checkbox" name="features.notify.favicon"> Favicon<br>','CatChan<br>Version 2017.07.02.1<br><a href="https://github.com/DogMan8/CatChan">GitHub</a><br><a href="https://github.com/DogMan8/CatChan/raw/master/CatChan.user.js">Get stable release</a><br><a href="https://github.com/DogMan8/CatChan/raw/develop/CatChan.user.js">Get BETA release</a><br><br><br>Debug mode<br><input type="checkbox" name="debug_mode.0"><input type="text" name="debug_mode.unread_count" size="30" style="text-align: right;"><input type="checkbox" name="debug_mode.2"><input type="checkbox" name="debug_mode.3"><input type="checkbox" name="debug_mode.4">&emsp;<input type="checkbox" name="debug_mode.5"><input type="checkbox" name="debug_mode.parse_error"><input type="checkbox" name="debug_mode.7"><br><input type="text" name="debug_mode.site2func" size="15" style="text-align: right;" placeholder="catalog_json2html3"><button name="debug_site2">dump_site2</button><input type="checkbox" name="debug_mode.site2func_expand">func<br><input type="text" name="debug_mode.pfunc" size="15" style="text-align: right;" placeholder="4chan:catalog_json"><button name="debug_pfunc">dump_parse_funcs</button><input type="checkbox" name="debug_mode.pfunc_expand">func<br><input type="text" name="debug_mode.pfunc_comp" size="15" style="text-align: right;" placeholder="4chan:catalog_json"><button name="debug_pfunc_comp">compare_parse_funcs</button><input type="checkbox" name="debug_mode.pfunc_comp_expand_same"><input type="checkbox" name="debug_mode.pfunc_comp_expand_diff">func <br>1,<input type="text" name="debug_mode.pfunc_comp_proto" size="40" style="text-align: right;" placeholder="temporal prototype, DEFAULT:catalog_json"><br><input type="text" name="debug_mode.pfunc_all" size="15" style="text-align: right;"  placeholder="op_img_url"><button name="debug_pfunc_all">find_parse_funcs</button><input type="checkbox" name="debug_mode.pfunc_all_expand">func<br><input type="checkbox" name="debug_mode.9"><br>'+function(){for(var e="",t=9;void 0!==pref.debug_mode[++t];)e+='<ICBX"debug_mode.'+t+'">'+(t%10==4?"&emsp;":t%10==9?"<br>":"");return e}()+"Test mode<br>"+function(){for(var e="",t=-1;void 0!==pref.test_mode[++t];)e+='<ICBX"test_mode.'+t+'">'+(t%10==4?"&emsp;":t%50==49?"<br><br>":t%10==9?"<br>":"");return e}()+'<input type="checkbox" name="test_mode.tips"><input type="text" name="test_mode.num" size="6" style="text-align: right;"><input type="text" name="test_mode.test_str" size="30" style="text-align: right;"><input type="text" name="test_mode.num_f" size="6" style="text-align: right;">&emsp;<button name="button_test">test</button><br>&emsp;<button name="load_samples">setting_samples</button><br><IF"test_mode.js_file" accept=".js,text/*"><BTN"test_mode.js_load,JS_load"><br>'],html_common:'<span name="reload_recommended" style="display:none;background:yellow">&emsp;&emsp;RELOAD IS REQUIRED TO GET LIGHT FEELING&emsp;&emsp;<br></span><span name="reload_required" style="display:none;background:red;color:white">&emsp;&emsp;RELOAD IS REQUIRED&emsp;&emsp;</span><br><button name="close">close</button>&emsp;<button name="save">save</button><button name="load_default">load_default</button><button name="load_default_of_this_page">load_default_of_this_page</button>',tag_gen:null,get onchange_funcs_formatted(){return Object.defineProperty(this,"onchange_funcs_formatted",{value:pref_func.add_onchange_format(this.onchange_funcs),writable:!0,enumerable:!0,configurable:!0}),pref_func.add_onchange_format(this.onchange_funcs.archive),this.onchange_funcs_formatted},onchange_funcs:{__proto__:{SHOWALL:function(e){this.TOGGLE(e.target,"HIDEALL","",null,"no"),Array.prototype.slice.call(e.target.parentNode.parentNode.querySelectorAll("[name=SHOW],[name=SHOW2],[name=SHOW3]")).forEach(function(e){e.onclick({target:e,currentTarget:e})})},HIDEALL:function(e){this.TOGGLE(e.target,"SHOWALL","",null,"no"),Array.prototype.slice.call(e.target.parentNode.parentNode.querySelectorAll("[name=HIDE],[name=HIDE2],[name=HIDE3]")).forEach(function(e){e.onclick({target:e,currentTarget:e})})},SHOW:function(e){this.TOGGLE(e.target,"HIDE","")},HIDE:function(e){this.TOGGLE(e.target,"SHOW","none")},TOGGLE:function(e,t,a,n,r){n||(n=e);var o=e.getAttribute("data-str");e.setAttribute("data-str",n.textContent),n.textContent=o,e.setAttribute("name",t),"no"!==r&&(r||(r=e.nextSibling),r.style.display=a)},SHOW2:function(e){this.TOGGLE2(e.target,"HIDE2","")},HIDE2:function(e){this.TOGGLE2(e.target,"SHOW2","none")},TOGGLE2:function(e,t,a){"A"!==e.tagName&&(e=e.parentNode),this.TOGGLE(e,t,a,e.childNodes[2],e.nextSibling.nextSibling)},SHOW3:function(e){for(var t=e.target.getAttribute("data-show3"),a=e.target.previousSibling;a.getAttribute("data-show3")!==t;)a=a.previousSibling;a.style.display="",e.target.style.display="none"},HIDE3:function(e){for(var t=e.target.parentNode.getAttribute("data-show3"),a=e.target.parentNode.nextSibling;a.getAttribute("data-show3")!==t;)a=a.nextSibling;a.style.display="",e.target.parentNode.style.display="none"},SHOW2_I:function(e){e.target.previousSibling.onclick({target:e.target.previousSibling})},SUB:function(e){var t=e.currentTarget.previousSibling.previousSibling;if(t&&t.querySelectorAll){var a=t.querySelectorAll("span[data-class=show_value]");a.length>0&&pref_func.apply_prep_2(a,!1)}}},"uip_tracker.on":uip_tracker_init,"healthIndicator.show":function(){cataLog.healthIndicator.show()},"healthIndicator.expand_running":function(){cataLog.healthIndicator.shrink_running()},"settings.indexing":function(e){var t=pref_func.settings,a=pref_func.settings.pn13.childNodes[1];pref_func.settings.files_store();var n;17===pref.settings.indexing&&(n=site.script_body.querySelectorAll('span[name="FILES_ARCHIVE0"]')[0]);var r=("function"==typeof t.htmls[pref.settings.indexing]?t.htmls[pref.settings.indexing](t.html_funcs):t.htmls[pref.settings.indexing])+t.html_common;if(a.innerHTML=pref_func.format_html_str(r),n){var o=a.querySelectorAll('span[name="FILES_ARCHIVE0"]')[0];o.parentNode.insertBefore(n,o),o.parentNode.removeChild(o)}pref_func.add_onchange(a,pref_func.settings.onchange_funcs_formatted),pref_func.settings.apply_pn13_1()},pn13_1_warning_reload:function(){pref3.reload_required=!0,pref_func.settings.onchange_funcs.pn13_1_warning()},pn13_1_warning:function(){var e=pref_func.settings.pn13.childNodes[1],t=e.getElementsByTagName("span").reload_required;t.style.display=pref3.reload_required||pref3.stats.use!==pref.stats.use||pref.stats.estimate_posts&&!pref3.stats.estimate_posts?"":"none";var t=e.getElementsByTagName("span").reload_recommended;t.style.display=!pref.stats.estimate_posts&&pref3.stats.estimate_posts?"":"none"},"tag.scan":function(){pref.catalog.board.board_tags=!0,pref_func.settings.onchange_funcs["tag.generate_caller"]("tag.scan")},"tag.same_tag_refresh":function(){pref.catalog.board.board_tags_same=!0,pref_func.settings.onchange_funcs["tag.generate_caller"]("tag.same_tag_refresh")},"tag.generate_caller":function(e){http_req.get("tag","8chan","https://"+site2["8chan"].domain_url+"/boards.json",pref_func.settings.onchange_funcs["tag.generate_callback"],!1,!1,e),pref_func.settings.pn13&&pref_func.settings.apply_pn13_1()},"tag.generate_callback":function(e,t,a){site3["8chan"].boards="response"in t?t.response:JSON.parse(t.responseText),pref_func.settings.onchange_funcs["tag.re_generate"](a)},"tag.re_generate":function(e){var t=catalog_obj.scan_tags_common(site3["8chan"].boards,'name="tag.gen"');if(pref_func.settings.tag_gen)pref_func.settings.tag_gen.childNodes[1].childNodes[1].innerHTML=t;else if("tag.same_tag_refresh"!==e){var a='<div><button name="tag.scan">Refresh</button><br><textarea style="height:1em" cols="20" name="tag.gen_str"></textarea><button name="tag.gen_add">Add to list</button></div><div>'+t+"</div>";cnst.make_popup(pref_func.settings,"tag_gen",a,pref_func.settings.onchange_funcs);var n=pref_func.settings.tag_gen.childNodes[1];n.style.height="200px",n.style.width="200px",n.style.overflow="auto",n.style.resize="both",cnst.bottom_top(n)}pref_func.settings.tag_gen&&pref_func.add_onchange(pref_func.settings.tag_gen.childNodes[1].childNodes[1],pref_func.settings.onchange_funcs_formatted);for(var t="",r=site3["8chan"].boards,o=0;o<r.length-1&&site.board!=="/"+r[o].uri+"/";)o++;for(var s=0;s<r[o].tags.length;s++){var i=r[o].tags[s];t=t+"#"+i;for(var l=0;l<r.length;l++)for(var c=0;c<r[l].tags.length;c++)r[l].tags[c]===i&&(t=t+",8chan/"+r[l].uri+"/");t+="\n"}pref_func.catalog_board_list_str_bt_same=t,pref_func.catalog_board_list_str_bt="",pref_func.settings.onchange_funcs.board_sel_refresh()},"tag.gen":function(){for(var e=pref_func.settings.tag_gen.childNodes[1].getElementsByTagName("input"),t="",a=pref_func.settings.tag_gen.childNodes[1].getElementsByTagName("textarea")[0].value,n=site3["8chan"].boards,r=0;r<e.length;r++)if(e[r].checked){var o=e[r].nextSibling.textContent.replace(/ [0-9]*: /,"");""===a&&(a="#"+o);for(var s=0;s<n.length;s++)for(var i=0;i<n[s].tags.length;i++)n[s].tags[i]==o&&(t=t+"8chan/"+n[s].uri+"/,")}pref_func.catalog_board_list_str_bt=a+","+t,pref_func.settings.onchange_funcs.board_sel_refresh()},"tag.gen_add":function(){pref_func.settings.onchange_funcs["tag.gen"](),pref_func.settings.onchange_funcs["tag.add_to_list"](pref_func.catalog_board_list_str_bt)},"tag.recommendation_add":function(){pref_func.settings.onchange_funcs["tag.add_to_list"](pref_func.catalog_board_list_str_or)},"tag.add_to_list":function(e){""!==e&&(pref.catalog_board_list_str.search(/\n$/)==-1&&(pref.catalog_board_list_str=pref.catalog_board_list_str+"\n"),pref.catalog_board_list_str=pref.catalog_board_list_str+e+"\n",pref_func.settings.pn13&&pref_func.settings.apply_pn13_1(),pref_func.settings.onchange_funcs.board_sel_refresh())},board_sel_refresh:function(){pref_func.str2obj("catalog_board_list_str"),cnst.auto_shrink_board_selector.str_changed()},"stats.use":"pn13_1_warning","stats.estimate_posts":"pn13_1_warning","stats.auto_acquisition":function(){cnst.auto_shrink_board_selector.color()},"stats.auto_acquisition_all":"stats.auto_acquisition","catalog.board.recommendation":"board_sel_refresh","catalog.board.board_tags":"board_sel_refresh",catalog_board_list_str:"board_sel_refresh","catalog.board.all_boards":"board_sel_refresh",JSON:function(){pref_func.site2_json()},JSON_query_boards:function(){pref.overwrite_site2_json_str='{"site2":{"'+site.nickname+'":{"boards_json":""}}}',pref_func.site2_json(!0)},JSON_query:function(){pref_func.site2_json(!0)},JSON_ex:function(){pref_func.site2_json_ex(!1),pref_func.settings.apply_pn13_1()},JSON_ex_full:function(){pref_func.site2_json_ex(!0),pref_func.settings.apply_pn13_1()},JSON_ex_filter:function(){pref_func.site2_json_ex(!1,!0),pref_func.settings.apply_pn13_1()},EVAL:function(){pref_func.site2_eval()},close:function(){pref_func.settings.show_hide()},save:function(){localStorage&&(localStorage[pref.script_prefix+".pref"]=JSON.stringify(pref_func.site2_json_ex_remove()))},load_default:function(e){var t=pref_default();if(delete t.settings.indexing,delete t.catalog_board_list_sel,delete t.catalog.filter,"load_default_of_this_page"===e.target.name){for(var a=e.target.parentNode.getElementsByTagName("*"),n=0;n<a.length;n++)if(a[n].name){var r=pref_func.get_tgt(a[n].name,t,!0);if(r){var o=pref_func.get_tgt(a[n].name);o[0][o[1]]=r[0][r[1]]}}}else 0===e.target.name.indexOf("easy2")&&delete t.easy2,pref_func.pref_overwrite(pref,t),pref3.reload_required=!0;pref_func.obj_init(),pref_func.settings.apply_pn13_1(),pref_func.settings.apply_pn13_1(!0,"load_default_of_this_page"===e.target.name&&cataLog.threads)},load_default_of_this_page:"load_default",load_samples:function(){pref_func.pref_samples.init()},catalog_triage_str:function(){catalog_obj&&null!==catalog_obj.catalog_func()&&catalog_obj.catalog_func().remake_triage()},"triage.hide_toggle":"catalog_triage_str",catalog_footer_show_nof_rep:"catalog_footer",catalog_footer_show_nof_rep_to_me:"catalog_footer",catalog_footer_show_site_name:"catalog_footer",catalog_footer_show_board_name:"catalog_footer",catalog_footer_show_thread_no:"catalog_footer",catalog_footer_show_flag:"catalog_footer",catalog_footer_show_page:"catalog_footer",catalog_footer_design:"catalog_footer",catalog_footer_show_tag:"catalog_footer","catalog.footer.*":"catalog_footer",catalog_footer:function(){catalog_obj&&null!==catalog_obj.catalog_func()&&catalog_obj.catalog_func().update_all_footers()},"thread_reader.use":thread_reader_init,"catalog.appearance.titleBar.settings":"catalog.appearance.titleBar.filter","catalog.appearance.titleBar.refresh":"catalog.appearance.titleBar.filter","catalog.appearance.titleBar.num_of_pages":"catalog.appearance.titleBar.filter","catalog.appearance.titleBar.boards_selector":"catalog.appearance.titleBar.filter","catalog.appearance.titleBar.filter":function(){catalog_obj&&null!==catalog_obj.catalog_func()&&(catalog_obj.catalog_func().pn12_0_2.getElementsByTagName("*")[this.name.substr(this.name.lastIndexOf(".")+1)].style.display=this.checked?"":"none")},catalog_size_text_height:"catalog_size_width",catalog_size_text_width:"catalog_size_width",catalog_size_height:"catalog_size_width",catalog_size_width:function(){catalog_obj&&null!==catalog_obj.catalog_func()&&catalog_obj.catalog_func().catalog_resized(this)},"catalog.click_area":function(){styleSheet.make_rule_click_area()},"style.sel":function(){styleSheet.styles_changed()},"style.fix.titleBar_str":"style.sel","style.fix.window_str":"style.sel","style.fix.popUp_str":"style.sel","style.copy.titleBar_str":"style.sel","style.copy.window_str":"style.sel","style.copy.popUp_str":"style.sel","style.fix.reset":function(){var e=pref_default(),t=this.name.split(".")[1];pref_func.pref_overwrite(pref.style[t],e.style[t]),pref_func.settings.apply_pn13_1(),pref_func.settings.onchange_funcs["style.sel"]()},"style.copy.reset":"style.fix.reset","virtualBoard.p_board":function(){liveTag.update_boardlist(!0)},"virtualBoard.p_remove":"virtualBoard.p_board","virtualBoard.max":"virtualBoard.p_board","virtualBoard.show":"virtualBoard.p_board","easy.virtualBoard_10_passive":"easy.virtualBoard_10","easy.virtualBoard_10":function(){pref_func.settings.onchange_funcs.pn13_1_warning_reload(),pref_func.pref_samples.onclick_event.call(this)},"easy.virtualBoard_1":"easy.virtualBoard_10","easy.virtualBoard_8_50":"easy.virtualBoard_10","easy.virtualBoard_8_100":"easy.virtualBoard_10","easy.virtualBoard_8_500":"easy.virtualBoard_10","easy.virtualBoard_8_all":"easy.virtualBoard_10","easy.virtualBoard_interSite":"easy.virtualBoard_10","easy.posts_0h":"easy.virtualBoard_10","easy.posts_24h":"easy.virtualBoard_10","easy.threads_24h":"easy.virtualBoard_10","easy.embed_index":"easy.virtualBoard_10","easy.embed_index_lazy":"easy.virtualBoard_10","easy.embed_index_infinite":"easy.virtualBoard_10","easy.embed_index_backwash":"easy.virtualBoard_10","easy.light":"easy.virtualBoard_10","easy.stat_activate":"easy.virtualBoard_10","easy2.beginner":function(e){pref.easy2.presets=1,pref_func.settings.onchange_funcs["easy2.presets"](e,pref.easy2.presets),pref_func.settings.onchange_funcs["easy2.apply"](e,!0),pref_func.settings.onchange_funcs.reload(e)},"easy2.presets":function(e,t){pref_func.pref_samples["easy2.presets"](void 0!==t?t:pref.easy2.presets),pref_func.settings.apply_pn13_1()},"easy2.limits":function(e,t){pref_func.pref_samples["easy2.limits"](),pref_func.settings.apply_pn13_1()},"easy2.apply":function(e,t){(pref.easy2.reset||t)&&pref_func.settings.onchange_funcs.load_default(e),pref_func.pref_samples["easy2.presets"](),pref_func.settings.onchange_funcs.pn13_1_warning_reload(),pref_func.pref_samples.onclick_event(null,pref.easy2)},reload:function(){location.reload()},triage_simple_kill:"triage_simple",triage_simple:function(){pref_func.pref_samples.onclick_event.call(this)},triage_basic:"triage_simple",triage_basic_color:"triage_simple",triage_colorful:"triage_simple",triage_borders:"triage_simple",triage_samples:"triage_simple",triage_test:"triage_simple","virtualBoard.scanStart":function(){catalog_obj&&null!==catalog_obj.catalog_func()&&catalog_obj.catalog_func().catalog_liveTag_scan_site()},"virtualBoard.scanStop":function(){scan.abort()},"virtualBoard.scan_domains.*":function(){if(pref.virtualBoard.instant_scan){var e=this.name.replace("virtualBoard.scan_domains.","");scan.keyword_load_1(e)}},"virtualBoard.search.show":function(e,t){if(site.components.boardlist){var a=site.components.boardlist.getElementsByTagName("input")["virtualBoard.search.str"];pref.virtualBoard.search.show?a||(a=document.createElement("input"),a.type="text",a.name="virtualBoard.search.str",a.size=10,a.style="float:right",a.value=pref.virtualBoard.search.str,pref_func.add_onchange(a,pref_func.settings.onchange_funcs_formatted,pref_func.settings.onchange_funcs_formatted),site.settings.parentNode.insertBefore(a,site.settings),t||liveTag.update_pn()):a&&(site.settings.parentNode.removeChild(a),liveTag.update_pn())}},"virtualBoard.search.str":function(){liveTag.filter_onchange(pref.virtualBoard.search)},debug_site2:function(){pref.debug_mode.site2func&&common_func.debug_site2func(pref.debug_mode.site2func)},debug_pfunc:function(){pref.debug_mode.pfunc&&common_func.debug_parse_funcs_entry(pref.debug_mode.pfunc)},debug_pfunc_comp:function(){pref.debug_mode.pfunc_comp&&common_func.debug_parse_funcs_entry(pref.debug_mode.pfunc,pref.debug_mode.pfunc_comp)},debug_pfunc_all:function(){pref.debug_mode.pfunc_all&&common_func.debug_parse_funcs_all(pref.debug_mode.pfunc_all)},"liveTag.ex_list_str":function(){liveTag.ex_list_changed()},"liveTag.inherit_board_name":function(){liveTag.inherit_board_name_changed()},"liveTag.inherit_board_tags":function(){liveTag.inherit_board_tags_changed()},"page.mark_new_posts":function(){cataLog.format_html&&cataLog.format_html.time_filter_changed()},"recovery.comment":function(){recovery.setup()},"*.open_spoiler_text":function(){styleSheet.open_spoiler_text()},"*.scroll_lock":function(){cataLog.general_event_handler.setup()},button_test:function(){function e(e,t,a,n){console.log(n)}IDB.req_raw("meguca","meguca","mine",null,e,"get_all",!0)},"*.posts_search_op":function(e,t){t||(t=cataLog.embed_mode),styleSheet.register(".CatChan_search_miss","opaque"===pref[t].posts_search_op?"opacity:"+pref[t].posts_search_op_opacity/100+" !important":"hide"===pref[t].posts_search_op?"display:none !important":null)},"*.posts_search_op_opacity":"*.posts_search_op","style.post_editing":function(){styleSheet.register("."+pref.script_prefix+"_post_editing",pref.style.post_editing)},archive:{restore2:function(e,t,a){if(cataLog.threads&&(!e||pref.archive.restore_auto||"archive.restore_button"===e.target.name)){a||(t=Array.prototype.slice.call(pref3.archive.dir.files),a=t.filter(function(e,t,a){return e.name.search(/\.(json|html*)$/)!=-1}),a=a.filter(function(e,t,a){return e.name.indexOf("_deleted.json")==-1}));var n=t.filter(function(e,t,a){return e.name.search(/\.(json|html*)$/)==-1});0!==a.length&&archiver.restore_entry(a,n,this.clear_files_button,t.filter(function(e,t,a){return e.name.indexOf("_deleted.json")!=-1}))}},dir:"restore2",files_sel:function(e){e.target.parentNode.querySelectorAll('span[name="FILES_ARCHIVE0"]')[0].style.display=0===pref.archive.files_sel?"":"none",e.target.parentNode.querySelectorAll('span[name="FILES_ARCHIVE1"]')[0].style.display=1===pref.archive.files_sel?"":"none",e.target.parentNode.querySelectorAll('span[name="FILES_ARCHIVE2"]')[0].style.display=2===pref.archive.files_sel?"":"none",2===pref.archive.files_sel&&this.queryList()},restore_button:function(e){0===pref.archive.files_sel&&this.restore2(e),
2===pref.archive.files_sel?this.IDB_thread_sel(e):this.restore(e)},restore:function(e){var t=pref3.archive.jsons.files,a=pref3.archive.imgs.files;0===t.length||pref.archive.load_img&&0===a.length||this.restore2(null,Array.prototype.slice.call(a),t)},jsons:"restore",imgs:"restore",clear_files_button:function(){for(var e=[pref3.archive.jsons,pref3.archive.imgs],t=0;t<e.length;t++)if(e[t]&&e[t].parentNode){var a=e[t].parentNode.insertBefore(e[t].cloneNode(e[t]),e[t]);a.onchange=e[t].onchange,e[t].parentNode.removeChild(e[t]),a.onchange({target:e[t],currentTarget:e[t]})}},get pn_IDB_board_sel(){return pref_func.settings.pn13&&pref_func.settings.pn13.querySelector('select[name="archive.IDB_board_sel"]')},get pn_IDB_thread_sel(){return pref_func.settings.pn13&&pref_func.settings.pn13.querySelector('select[name="archive.IDB_thread_sel"]')},IDB_select_multiple:function(){this.pn_IDB_board_sel.multiple=pref.archive.IDB_select_multiple,this.pn_IDB_thread_sel.multiple=pref.archive.IDB_select_multiple},queryQuota:function(){navigator.webkitTemporaryStorage&&navigator.webkitTemporaryStorage.queryUsageAndQuota(this.showQuota.bind(this))},showQuota:function(e,t){var a=pref_func.settings.pn13.querySelector('span[name="SHOW_QUOTA"]');a&&(a.textContent=e.toLocaleString()+" / "+t.toLocaleString()+" ("+(100*e/t).toString().slice(0,5)+"%)")},queryList:function(){pref.test_mode[65]||pref4.archive.IDB_board_sel_options||(brwsr.ff?setTimeout(function(){this.showList({target:{result:Object.keys(liveTag.mems[site.nickname])}})}.bind(this),0):window.indexedDB.webkitGetDatabaseNames().onsuccess=this.showList.bind(this))},showList:function(e){if(e){for(var t=e.target.result,a=["Select board"],n=0;n<t.length;n++)a[a.length]=t[n].replace(/^[^\/]*/,"");a[a.length]="ALL ("+t.length+")"}else a=null;pref4.archive.IDB_board_sel_options=a,pref_func.apply_prep(this.pn_IDB_board_sel,!1)},IDB_board_sel:function(){pref4.archive.IDB_thread_sel_options=null;var e=this.pn_IDB_thread_sel;pref_func.apply_prep(e,!1),e.style.display="";for(var t=this.IDB_selected_boards(),a=0;a<t.length;a++)IDB.req(site.nickname,t[a],null,null,this.showThreadList_fromIDB.bind(this),"list_os")},IDB_selected_boards:function(){return 0===pref.archive.IDB_board_sel?[]:pref4.archive.IDB_board_sel_options&&pref.archive.IDB_board_sel===pref4.archive.IDB_board_sel_options.length-1?pref4.archive.IDB_board_sel_options.slice(1,-1):Array.prototype.slice.call(this.pn_IDB_board_sel.options).filter(function(e){return e.selected}).map(function(e){return e.textContent})},showThreadList_fromIDB:function(e,t,a){1==this.IDB_selected_boards().length&&(t="");for(var n=pref4.archive.IDB_thread_sel_options||["ALL"],r=0;r<a.length;r++)n[n.length]=t+a[r];n[0]=" ",n.sort(),n[0]="ALL ("+(n.length-1)+")",pref4.archive.IDB_thread_sel_options=n,pref_func.apply_prep(this.pn_IDB_thread_sel,!1)},IDB_thread_sel:function(e){cataLog.threads&&(pref.archive.restore_auto||"archive.restore_button"===e.target.name)&&(pref.archive.clear_threads&&cataLog.threads&&cataLog.catalog_clear_threads(0),this["IDB.selected_threads"](IDB.req,null,this.restore3.bind(this),"get_all"))},"IDB.selected_threads":function(e,t,a,n){var r=0===pref.archive.IDB_thread_sel?pref4.archive.IDB_thread_sel_options.slice(1):Array.prototype.slice.call(this.pn_IDB_thread_sel.options).filter(function(e){return e.selected}).map(function(e){return e.textContent}),o=this.IDB_selected_boards(),s=1===o.length?o[0]:"";if(!e){for(var i={domain:site.nickname,boards:o},l=0;l<r.length;l++)r[l]={board:s||r[l].replace(/[^\/]*$/,""),no:r[l].replace(/\/[^\/]*\//,""),__proto__:i};return r}for(var l=0;l<r.length;l++)e(site.nickname,s||r[l].replace(/[^\/]*$/,""),r[l].replace(/\/[^\/]*\//,""),t,a,n)},restore3:function(e,t,a,n){var r=this.consolidate_IDB_result(n,e);if(r.posts.length>0){var o=archiver.restore({name:(site.nickname+t+a).replace(/\//,"-")},site2[e].parse_funcs.thread_json.prep_to_archive(r.posts),r.tn,!0);if(r.posts_deleted.length>0){pref.test_mode[80]&&(t=t.slice(0,-1)+"_IDB/");var s=liveTag.mems.init({domain:e,board:t,no:a});archiver.prep_deleted_posts(o,s,!0,r.posts_deleted)}}},consolidate_IDB_result:function(e,t){for(var a=[],n=[],r={},o=Object.create(r),s=Object.keys(e),i=0;i<s.length;i++)if(0===s[i].indexOf("posts_deleted"))n=n.concat(e[s[i]]);else if(0===s[i].indexOf("posts"))a=a.concat(e[s[i]]);else{if("pruned_time"===s[i])continue;var l=s[i].replace(/[^\.]*./,""),c="webm"===l?"video/webm":"image",p={type:c,file:e[s[i]]};0===s[i].indexOf("tn_")?o[s[i].substr(3)]=p:r[s[i].substr(4)]=p}for(var i=0;i<a.length-1&&a[i].no<a[i+1].no;)i++;if(i!==a.length-1)for(a.sort(this.consolidate_IDB_sort_func),i=0;i<a.length-1;){if(a[i].no===a[i+1].no){for(var _=i+2;_<a.length&&a[i].no===a[_].no;)_++;for(;--_>i;)a.splice(_,1)}i++}_=0;for(var i=0;i<n.length;i++){for(;_<a.length&&a[_].no<n[i].no;)_++;_<a.length&&a[_].no===n[i].no&&a.splice(_,1)}var d=t&&site2[t].parse_funcs.thread_json.consolidate_IDB_result_sub;return d&&0!==a.length&&d(a),{posts:a,posts_deleted:n,img:r,tn:o}},consolidate_IDB_sort_func:function(e,t){return e.no!==t.no?e.no-t.no:e.com<t.com?-1:1},"IDB.delete_board":function(){for(var e=this.IDB_selected_boards(),t=0;t<e.length;t++)window.indexedDB.deleteDatabase(pref.script_prefix+"."+e[t]);var a=this.pn_IDB_thread_sel;a&&(a.style.display="none"),this.showList(null),this.queryList()},"IDB.delete_thread":function(){this["IDB.selected_threads"](IDB.req,null,null,"delete_th"),this.IDB_board_sel(null)},"IDB.delete_imgs":function(){this["IDB.selected_threads"](IDB.req,IDBKeyRange.bound("img_","img`",!1,!0),null,"delete")},"IDB.export_thread":function(){for(var e=this["IDB.selected_threads"](),t="CatChan_IDB_"+e[0].domain+"-"+(1==e[0].boards.length?e[0].board.slice(1,-1):e[0].boards.length)+"-"+(1===e.length?e[0].no:e.length)+".tar",a="IDB_extract_"+Date.now(),n=function(n){var r=e.length;return function(e,o,s,i){n.export_thread(e,o,s,i,a),0==--r&&archiver.tar.flush(a,t)}}(this),r=0;r<e.length;r++)IDB.req(e[r].domain,e[r].board,e[r].no,null,n,"get_all")},export_thread:function(e,t,a,n,r,o){for(var s=this.consolidate_IDB_result(n,e),i=Object.keys(s),l=0;l<i.length;l++)for(var c=Array.isArray(s[i[l]])?["dummy"]:Object.keys(s[i[l]]),p=0;p<c.length;p++){var _=0===i[l].indexOf("posts");if(!_||0!==s[i[l]].length){var d=_?new Blob([JSON.stringify(site2[e].parse_funcs.thread_json.prep_to_archive(s[i[l]]))],{type:"text/plain"}):s[i[l]][c[p]].file,u=_?e+"-"+t.slice(1,-1)+"-"+a+i[l].substr(5)+".json":i[l]+"_"+c[p];archiver.tar.add_blob(d,{domain:e,board:t,no:a},u,r,!0)}}o&&archiver.tar.flush(r,o)},"IDB.reset_time":function(){this["IDB.selected_threads"](archiver.clean_list)},start:function(e){archiver.store_entry("archive.start"===e.target.name?"ARC":"ARC1")},oneshot:"start","kwd.*":function(){pref.archive.kwd.kwds=common_func.kwd_prep_regexp(pref.archive.kwd)}},"test_mode.js_load":function(){var e=pref_func.settings.pn13.getElementsByTagName("input")["test_mode.js_file"].files[0],t=window.URL.createObjectURL(e),a=document.createElement("script");a.src=t,site.script_body.appendChild(a)},"page.merge":function(e){site2.DEFAULT.update_posts_merge_bases.onchange_merge(e)},"page.merge_list":"page.merge","proto.merge_list_str":"page.merge"}},bind_myself:function(e,t){for(var a of t)e[a]=e[a].bind(e)},format_html_str:function(e){return e=e.replace(/<br>([1-9]),/g,function(e,t){for(var a="<br>",n=0;n<t;n++)a+="&emsp;";return a}),e=e.replace(/<ICBX"/g,'<input type="checkbox" name="'),e=e.replace(/<ITBL(\d+)"/g,'<input type="text" size="$1" name="'),e=e.replace(/<ITB(\d+)"/g,'<input type="text" style="text-align: right;" size="$1" name="'),e=e.replace(/<IR"([\w\.]+),([^"]+)">/g,'<input type="radio" name="$1" value="$2">'),e=e.replace(/<SSV("[\w\.]+")>/g,'<span data-class="show_value" style="font-weight:bold" name=$1></span>'),e=e.replace(/<BTN"([\w.]+),([^"]+)"([^>]*)>/g,'<button name="$1"$3>$2</button>'),e=e.replace(/<IF"/g,'<input type="file" name="'),e.replace(/<input type="(checkbox|radio)[^>]+>[^<]+/g,"<label>$&</label>")}}}();pref_func.settings.onchange_funcs["catalog.tag.ignore"]=pref_func.settings.onchange_funcs["tag.re_generate"],pref_func.settings.onchange_funcs["catalog.tag.max"]=pref_func.settings.onchange_funcs["tag.re_generate"],pref_func.settings.onchange_funcs["tag.gen_str"]=pref_func.settings.onchange_funcs["tag.gen"],pref_func.bind_myself(pref_func.settings.onchange_funcs.__proto__,["SHOW","HIDE","SHOW2","HIDE2","SHOW3","HIDE3","TOGGLE2","SHOWALL","HIDEALL"]);var styleSheet=function(){function e(e,t){c.cssRules[t]&&c.deleteRule(t),c.insertRule(e,t)}function t(){e("."+pref.script_prefix+("entire"===pref.catalog.click_area?"_thread":"_thumbnail")+" {cursor: pointer}",2)}function a(){var t=[pref.style.fix.titleBar_str,pref.style.fix.window_str,pref.style.fix.popUp_str];if("copy"===pref.style.sel)for(var a=[pref.style.copy.titleBar_str,pref.style.copy.window_str,pref.style.copy.popUp_str],r=document.styleSheets.length-1;r>=0;r--){var o=document.styleSheets[r].cssRules;if(o){for(var s=o.length-1;s>=0;s--){for(var i=0;i<3;i++)a[i]&&o[s].selectorText===a[i]&&(t[i]=n(o[s].cssText),a[i]=null);if(!t[0]&&!t[1]&&!t[2])break}if(!t[0]&&!t[1]&&!t[2])break}}e("."+pref.script_prefix+"_titleBar {"+t[0]+"}",4),e("."+pref.script_prefix+"_window {"+t[1]+"}",5),e("."+pref.script_prefix+"_popUp {"+t[2]+"}",6)}function n(e){for(var t=e.replace(/.*\{/,"").replace(/\}.*/,"").split(";"),a=t.length-1;a>=0;a--)t[a].split(":")[0].search(/\s*(background|color)/)==-1&&t.splice(a,1);return t.join(";")}function r(e){new MutationObserver(o).observe(e,{attributes:!0})}function o(){if(c){var e=document.createElement("img");e.src=this.href,e.onerror=s,document.getElementsByTagName("body")[0].appendChild(e)}}function s(){this.parentNode.removeChild(this),a()}function i(){if(cataLog.embed_mode){var e=site2[site.nickname].spoiler_text;if(e.spoiler){if(!p&&!_&&e&&pref[cataLog.embed_mode].open_spoiler_text)for(var t=0;t<document.styleSheets.length;t++)if(document.styleSheets[t].cssRules)for(var a=0;a<document.styleSheets[t].cssRules.length;a++){var n=document.styleSheets[t].cssRules[a].selectorText;n&&(n.search(e.spoiler)!=-1&&(p=[t,a,document.styleSheets[t].cssRules[a].style.cssText]),n.search(e.open)!=-1&&(_=[t,a,document.styleSheets[t].cssRules[a].style.cssText]))}p&&_&&(document.styleSheets[p[0]].cssRules[p[1]].style.cssText=p[2]+(pref[cataLog.embed_mode].open_spoiler_text?_[2]:""))}else pref[cataLog.embed_mode].open_spoiler_text?(_=[document.styleSheets.length-1,document.styleSheets[document.styleSheets.length-1].cssRules.length,e.open_rule],document.styleSheets[_[0]].insertRule(_[2],_[1])):_&&document.styleSheets[_[0]].deleteRule(_[1])}}function l(e,t){var a=d.indexOf(e);a!=-1&&c.deleteRule(a),null===t||""===t?a!=-1&&d.splice(a,1):(a===-1&&(a=d.length,d[a]=e),c.insertRule(e+" {"+t+"}",a))}var c,p=null,_=null,d=["dummy","dummy","dummy","dummy","dummy","dummy","dummy"];return{init:function(e){c=document.head.appendChild(document.createElement("style")).sheet,c.insertRule(".catalog_triage_parent {pointer-events: none;}",0),c.insertRule(".catalog_triage_button {pointer-events: auto;}",1),t(),c.insertRule("."+pref.script_prefix+"_tag {cursor:pointer;}",3),a(),pref_func.settings.onchange_funcs["*.posts_search_op"](null,e),pref_func.settings.onchange_funcs["style.post_editing"]()},make_rule_click_area:function(){c&&t()},styles_changed:function(){c&&a()},add_to_watch:r,open_spoiler_text:i,register:l}}(),options={func0_prep:function(){},func0_exe:function(){}},common_func={overwrite_prop:function(e,t){for(var a in t)void 0===t[a]&&e[a]?delete e[a]:"object"==typeof e[a]&&"object"==typeof t[a]?common_func.overwrite_prop(e[a],t[a]):e[a]=t[a]},name2domainboardthread:function(e,t){var a=e.substr(e.lastIndexOf("/")+1),n=e.substr(0,e.indexOf("/")),r=e.substr(n.length,e.length-a.length-n.length);return e===a&&a.search(/[^0-9]/)!=-1&&(n=a,a=""),t&&(""===n&&(n=site.nickname),""===r&&(r=site.board)),[n,r,a]},name2dbt:function(){var e={c:"catalog_html",j:"catalog_json",p:"page_html",q:"page_json",t:"thread_json"};return function(t){var a=this.name2domainboardthread(t,!0);return a[2][0].search(/[A-z]/)!=-1?(a[3]=e[a[2][0]],a[2]=a[2].substr(1)):a[3]="thread_html",a}}(),fullname2dbt:function(e){var t=e.substr(e.lastIndexOf("/")+1),a=e.substr(0,e.indexOf("/"));return[a,e.substr(a.length,e.length-t.length-a.length),t]},dom_addEventListener:function(e,t,a,n){t.addEventListener(a,n,!1),e[e.length]=[t,a,n]},dom_removeEventListener:function(e,t,a,n){for(var r=e.length-1;r>=0;r--)t&&t!==e[r][0]||a&&a!==e[r][1]||n&&n!==e[r][2]||(e[r][0].removeEventListener(e[r][1],e[r][2],!1),e.splice(r,1))},dom_addAttribute:function(e,t,a){var n=e.getAttribute(t);n&&(a=n+" "+a),e.setAttribute(t,a)},Triage:function(e,t){var a={NONE:["Don't hide this thread and set its style.",!0],ATTR:["Set style additionally.",!0],KILL:["Hide this thread permanently.",!0],TIME:["Hide this thread until it gets new replies.",!0],WATCH:["Watch this thread and mark as I've read all posts so far.",!1],UNWATCH:["Unwatch this thread.",!1],SHOW:["Show this thread always without regard to filter setting.",!1],UNSHOW:["Remove 'show' marks.",!1],STICKY:["Sticky this thread.",!1],UNSTICKY:["Unsticky this thread.",!1],UNDO:["Undo last modification.",!1],GO:["Open this thread.",!1],ARC:["Start archiving this thread.",!1],ARC1:["Archive this thread one time.",!1],UARC:["Unarchive this thread.",!1]};a.KILL_N=[a.KILL[0],!1],a.TIME_N=[a.TIME[0],!1];var n=[],r=["WATCH","UNWATCH","SHOW","UNSHOW","STICKY","UNSTICKY","ARC","ARC1","UARC"],o=document.createElement("div");o.name=t.name?t.name:"",o.className="catalog_triage_parent";var s=e.replace(/\s*\/\/.*/gm,"").split("\n");e=[];for(var i=s.length-1;i>=0;i--)""===s[i]&&s.splice(i,1);for(var l=brwsr.ff?[]:["background","background-color"],i=0;i<s.length;i++)e[i]=s[i].split(",");for(var i=0;i<e.length;i++){for(var c=0;c<e[i].length;c+=3){var p=document.createElement("button");p.innerHTML=e[i][c+1],p.name=o.name+"("+i+","+c+")",p.className="catalog_triage_button",p.type="button";for(var _=e[i][c+2]?e[i][c+2].split(";"):[],d=0;d<_.length;d++){for(var u=_[d].replace(/:.*/,""),f=0;f<l.length;f+=2)u=u.replace(l[f],l[f+1]);p.style[u]=_[d].replace(/[^:]*:/,"")}p.onclick=t.onclick,o.appendChild(p),t.wheelpatch&&(p.onmousewheel=t.wheelpatch),o.name&&(pref_func.tooltips.str[p.name]=a[e[i][c]]?a[e[i][c]][0]+(a[e[i][c]][1]?"\nSet style "+(e[i][c+2]?e[i][c+2]:"default")+".":""):""),r.indexOf(e[i][c])!=-1&&(n[n.length]=[p,e[i][c]])}o.appendChild(document.createElement("br"))}this.str=e,this.pn=o,this.format_tgt=0!==n.length?n:null},modify_bookmark:function(e,t){var a=new RegExp("(^|,)"+e.replace(/\+/,"\\+")+"([^@*!][^,\n]*)*(,|\n|$)","mg"),n=pref.catalog.filter.bookmark_list_str;if(n=n.replace(a,",")+(t?","+e+"\n":""),pref.catalog.filter.bookmark_list_str=n.replace(/,,+/g,",").replace(/^,/g,"").replace(/\n,/g,"\n").replace(/\n\n+/g,"\n").replace(/^\n/,""),catalog_obj.catalog_func()){var r=catalog_obj.catalog_func().pn12_0_4.getElementsByTagName("textarea")["catalog.filter.bookmark_list_str"];pref_func.apply_prep(r,!1)}else if(pref.catalog.auto_save_filter&&localStorage){a=pref.script_prefix+".catalog.filter."+pref.catalog_board_list_obj[pref.catalog_board_list_sel][0].key;var o=JSON.parse(localStorage.getItem(a));o.bookmark_list_str=pref.catalog.filter.bookmark_list_str,localStorage.setItem(a,JSON.stringify(o))}},perf_out:function(e){e.push(performance.now());for(var t="",a=null,n=0;n<e.length;n++)"number"==typeof e[n]?(a&&(t+=e[n]-a+", "),a=e[n]):t+=e[n]+", ";console.log(t)},debug_show_proto_func_pool:null,debug_show_proto:function(e,t,a,n){n||(n="proto"),a||(a=["proto"]);for(var r=e+":",o=Object.keys(t),s=0;s<o.length;s++)a.indexOf(o[s])==-1&&(r+=o[s]+",",a.push(o[s]),this.debug_show_proto_func_pool&&(this.debug_show_proto_func_pool[o[s]]=t[o[s]]));return t.hasOwnProperty(n)&&(r+="/"+this.debug_show_proto(t.__proto__[n],t.__proto__,a,n)),r},debug_parse_funcs_entry:function(e,t){if((t?pref.debug_mode.pfunc_comp_expand_same||pref.debug_mode.pfunc_comp_expand_diff:pref.debug_mode.pfunc_expand)&&(this.debug_show_proto_func_pool={}),console.log(this.debug_parse_funcs(e)),t){var a=this.debug_show_proto_func_pool;if(this.debug_show_proto_func_pool={},pref.debug_mode.pfunc_comp_proto){var n=t.split(":"),r=site2[n[0]].parse_funcs[n[1]],o=r.__proto__;n=pref.debug_mode.pfunc_comp_proto.split(":"),(n=site2[n[0]].parse_funcs[n[1]])&&(r.__proto__=n)}console.log(this.debug_parse_funcs(t));var s=this.debug_show_proto_func_pool}if(this.debug_show_proto_func_pool)if(t){for(var i in s){var l=a[i]===s[i];(pref.debug_mode.pfunc_comp_expand_same&&l||pref.debug_mode.pfunc_comp_expand_diff&&!l)&&(console.log(i+": "+(l?"same":"differ")+": "+a[i]),l||console.log(i+": "+(l?"same":"differ")+": "+s[i])),delete a[i]}for(var i in a)console.log(i+": only_in_original: "+a[i])}else for(var i in this.debug_show_proto_func_pool)console.log(i+": "+this.debug_show_proto_func_pool[i]);this.debug_show_proto_func_pool=null,o&&(r.__proto__=o)},debug_parse_funcs:function(e){for(var t in site2)for(var a in site2[t].parse_funcs)site2[t].hasOwnProperty("parse_funcs")&&site2[t].parse_funcs.hasOwnProperty(a)&&(site2[t].parse_funcs[a].debug____proto=t+"."+a);var n=e.split(":"),r=site2[n[0]].parse_funcs[n[1]];return e+"::"+(r?this.debug_show_proto("/"+r.debug____proto,r,["debug____proto","proto"],"debug____proto"):"NONE")},debug_parse_funcs_all:function(e){for(var t=["DEFAULT","4chan","vichan","lain","8chan","KC","meguca","meguca1","meguca2"],a=["","_json","_html"],n=["common","post","thread","page","catalog"],r={},o=0;o<t.length;o++)for(var s=0;s<a.length;s++)if("KC"!==t[o]||"_json"!==a[s])for(var i=0;i<n.length;i++)if("DEFAULT"===t[o]||"common"!==n[i]){var l=n[i]+a[s];if(site2[t[o]].parse_funcs[l]){for(var c=this.debug_parse_funcs(t[o]+":"+l).split(","),p=0;p<c.length;p++){var _=c[p].lastIndexOf(":");if(c[p].substr(_+1)===e){c.splice(p+1,c.length-p-1);var d=c[p>0?p-1:p].replace(/[^\/]*\//g,"").replace(/:[^:]*$/,"").replace(/\./,":"),u=c[0].replace(/::.*/,"");d!==u&&(c[c.length]=" (==="+d+")");break}_===-1?c.splice(p--,1):c[p]=c[p].substr(0,_+1)}var f=site2[t[o]].parse_funcs[l];if(f){var m=f[e],h=!0;for(var p in r)if(r[p][0]===m){c[c.length]=" (==="+p+")",h=!1,r[p][1]++;break}h&&(r[d]=[m,1])}"string"!=typeof f[e]&&"number"!=typeof f[e]||(c[e.length]=", "+f[e]),console.log(c.join(""))}}var g=0;if(pref.debug_mode.pfunc_all_expand)for(var p in r)console.log(g+++"("+r[p][1]+"): "+p+": "+r[p][0])},debug_site2func:function(e){for(var t in site2)site2[t].hasOwnProperty(e)&&(site2[t]["debug____"+e]=t);var a="",n={};for(var t in site2)a+=t+": "+site2[t]["debug____"+e]+", ",n[site2[t]["debug____"+e]]=site2[t][e];if(console.log(a),pref.debug_mode.site2func_expand)for(var t in n)console.log(t+": "+n[t])},shallow_copy_1:function(e){var t=Object.create(null);for(var a in e)e.hasOwnProperty(a)&&(t[a]=e[a]);return t},deep_copy:function(e,t){for(var a in t)t.hasOwnProperty(a)&&(Array.isArray(t[a])?e[a]=t[a].slice():"object"==typeof t[a]?e[a]=this.deep_copy({},t[a]):e[a]=t[a]);return e},image_resize:function(e,t,a){var n=e.naturalWidth,r=e.naturalHeight,o=n>t?n/t:1,s=r>a?r/a:1;s>1&&e.setAttribute("width",o>=s?t:n/s),o>1&&e.setAttribute("height",s>=o?a:r/o)},kwd_prep_regexp:function(e){if(!e.str)return[];for(var t=e.sentence?[e.str]:e.str.split(" "),a=t.length-1;a>=0;a--)if(""===t[a])t.splice(a,1);else{e.re||(t[a]=t[a].replace(/[\.\(\)\[\]\+\?\^\$\{\}]/g,"\\$&").replace(/\*/g,".+"));try{t[a]=new RegExp(t[a],e.ci?"i":"")}catch(e){t.splice(a,1)}}return t},escape:function(){function e(e){return t[e]}var t={"<":"&lt;",">":"&gt;","&":"&amp;",'"':"&quot;","'":"&#039;"};return function(t){return t.replace(/[<>"'&]/g,e)}}(),escape_text:function(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;")},arraybuffer2blob:function(){var e={jpg:"image/jpeg",jpeg:"image/jpeg",gif:"image/gif",png:"image/png",pdf:"application/pdf",svg:"image/svg+xml",svgz:"image/svg+xml",htm:"text/html",html:"text/html",txt:"text/plain",webm:"video/webm",mpg:"video/mpeg",mpeg:"video/mpeg",mp4:"video/mp4",ogv:"video/ogg",mp3:"audio/mp3",gz:"application/x-gzip",tar:"application/x-tar",tgz:"application/x-tar",zip:"application/x-compress","7z":"application/x-7z-compressed",xz:"application/x-xz"};return function(t,a){var n=t.substr(t.lastIndexOf(".")+1),r=e[n]||"text/plain";return new Blob([a],{type:r})}}(),Object_modifyDescriptor:function(e,t,a){a.__proto__=Object.getOwnPropertyDescriptor(e,t),Object.defineProperty(e,t,a)}},common_obj={thread_reader:null,events_beforeunload:[]};common_func.dom_addEventListener(common_obj.events_beforeunload,window,"beforeunload",function(){common_func.dom_removeEventListener(common_obj.events_beforeunload)}),common_func.dom_addEventListener(common_obj.events_beforeunload,window,"focus",function(){DelayBuffer.prototype.hasFocus=!0}),common_func.dom_addEventListener(common_obj.events_beforeunload,window,"blur",function(){DelayBuffer.prototype.hasFocus=!1});var site={max_page:20,autosage:300,board_name:"/int/",url_prefix:"https://krautchan.net/int/",url_prefix2:{},nickname:"KC",nicknames:["CatChan_tgt"],thread_keyword:"thread",postform:null,postform_rules:null,get_ops:null,get_posts:null,server_name:null,protocol:document.location.href.search(/https/)!=-1?"https:":"http:",catalog_threads_in_page:null,remove_posts:function(e){return e},remove_files_info:function(e){return e},remove_checkboxes:function(e){return e},get_time_of_last_post:function(e){return null},header_height:function(){return 0},patch:null,components:{},get key(){return site.nickname+site.board+("thread"===site.whereami?site.no:"")},query_set_component:function(e){var t=site2[site.nickname].components[e],a="string"==typeof t?document.querySelector(t):document.querySelectorAll(t[0])[t[1]];a?site.components[e]=a:delete site.components[e]},config:function(e,t,a){var n=window.location.href,r=n.substr(0,n.indexOf(e)+e.length),o=decodeURI(n.substr(r.length+1))+"/";if(site.board="/"+o.substr(0,o.indexOf("/")+1),site.url_prefix=r+site.board,site.server_name=n.substr(0,n.indexOf(e)-1).replace(/https*:\/\/*/,""),site.nickname=t,site.isthread=window.location.href.search(site2[t].thread_keyword)!=-1,site.myself=site2[site.nickname].get_ops(document)[0],site.no="thread"===site.whereami?site.myself:"",!a){site2[t].features&&pref_func.pref_overwrite(site.features,site2[t].features);for(var s in site2[site.nickname].components)site.query_set_component(s);!site.settings&&site.components.boardlist&&(site.settings=site.components.boardlist.appendChild(document.createElement("span"))),site2[site.nickname].pref_default&&pref_func.pref_overwrite(pref,site2[site.nickname].pref_default),site.patch=site2[site.nickname].patch}},features:{page:!1,graph:!0,setting:!0,setting2:!0,postform:!0,catalog:!0,listener:!1,uip_tracker:!1,thread_reader:!0,debug:!1},owners_recommendation:"",catalog:!1,whereami:null,embed_to:{},root_body:document.getElementsByTagName("body")[0],embed_frame:"CatChan_embed_frame",embed_frame_win:null,boardlist:null,settings:null};site.protocol=document.location.href.search(/https/)!=-1?"https:":"http:",site.root_body2=site.root_body;var site2={};site2.DEFAULT={nickname:"DEFAULT",home:"",check_func:function(){return window.location.href.indexOf(this.nickname)!=-1&&(site.whereami="other",site.config(this.domain_url,this.nickname),!0)},boards_sel_from_tags:function(){return""},protocol:site.protocol,components:{},spoiler_text:{spoiler:/span.spoiler$/,open:/span.spoiler:hover/},postform:function(){function e(e){this.tack&&(this.tack.style.display="none"===this.tack.style.display?"":"none")}return{tack:null,init:function(){return site.postform&&(this.tack=document.createElement("i"),this.tack.setAttribute("class","fa fa-thumb-tack"),this.tack.setAttribute("style","float:right;font-size:2em"),site.postform.parentNode.insertBefore(this.tack,site.postform)),this.tack},on:e,off:e}}(),postform_prep:function(){site.components.postform_submit2=null,site.components.postform_submit2_observer=new MutationObserver(this.postform_submit2_find),site.components.postform_submit2_observer.observe(document.getElementsByTagName("body")[0],{childList:!0})},postform_submit2_find:function(){site.components.postform_submit2;site.query_set_component("postform_submit2"),site.query_set_component("postform_comment2"),common_obj.thread_reader&&common_obj.thread_reader.setup_submit2(),pref.features.recovery&&recovery.setup2()},general_event_handler:function(){var e={common:{subscribe:function(e){this.mouseover&&e.addEventListener("mouseover",this.mouseover,!1)},unsubscribe:function(e){this.mouseover&&e.removeEventListener("mouseover",this.mouseover,!1)},get_mark:function(e,t){return this.get_mark_from_height(t,document.getElementByTagName("div"))},get_mark_from_height:function(e,t){for(var a=t.length,n=a>>1,r=0;n>0;)t[r+n].offsetTop<e&&(r+=n),n>>=1;for(;r+1<a&&t[r+1].offsetTop<e;)r++;return t[r]}}};return e.thread=Object.create(e.common),e.page=Object.create(e.common),e.catalog=Object.create(e.common),e}(),horizontal_separator_in_index:function(){var e=document.createElement("hr");return e.setAttribute("class",pref.script_prefix+"_hs"),e},get_next_image:function(e,t,a){a||(a=cataLog.parent.getElementsByTagName("img"));var n=Array.prototype.indexOf.call(a,e);if(t)for(;a[n+1]&&a[n+1].offsetTop<t;)n++;return n>=0?a[n+1]:null},catalog_threads_in_page:function(e){return[]},remove_posts:function(e,t){},remove_files_info:function(e){return e},postform_rules:null,thread_keyword:"thread",max_page:function(e){return 10},generate_boards_json:function(e,t){for(var a={pages:t},n=[],r=0;r<e.length;r++)n[n.length]=Array.isArray(e[r])?{board:e[r][0],pages:e[r][1],__proto__:a}:{board:e[r],__proto__:a};return{boards:n}},url_boards_json:function(){return""},get_boards_json:function(e,t,a){var e="boards_json_"+this.nickname;this.boards_json?this.get_boards_json_callback(this.nickname,{status:200,response:this.boards_json},[t,a]):httpd.req({initiator:e,tgts:[{domain:this.nickname,url:this.url_boards_json()[0],responseType:"json",data_type:"json"}],callback_1:function(n,r){this.get_boards_json_callback(e,r,[t,a,!0])}.bind(this)},6)},get_boards_json_callback:function(e,t,a){200==t.status&&(this.postprocess_board(t.response),site3[this.nickname].boards||liveTag.update_pn_buf.do_tgt(),site3[this.nickname].boards=!0),a[0]&&(a[1]||200===t.status)&&(a[2]?a[0]():setTimeout(a[0],0))},postprocess_board:function(e){for(var t=0;t<e.boards.length;t++){var a=liveTag.mems.init({domain:this.nickname,board:"/"+e.boards[t].board+"/"});a.o=t,e.boards[t].pages&&!a.pgs&&(a.pgs=e.boards[t].pages),e.boards[t].tags&&0!=e.boards[t].tags.length&&liveTag.postprocess_board_add_btag(e.boards[t].tags,a)}},show_boardlist_boards:Object.create(null,{sel:{value:null,writable:!0}}),show_boardlist_physical_board:function(e,t){var a=this.show_boardlist_boards;if(a.sel===!0&&"replace"===pref.virtualBoard.p_board||a.sel===!1&&"both"===pref.virtualBoard.p_board){var n=a.sel?"v":"p",r=a.sel?"p":"v";for(var o in a){var s=a[o];s[n]&&s[r]&&(s[r].parentNode.insertBefore(s[n],s[r]),s[r].parentNode.removeChild(s[r]))}a.sel=!a.sel}if(null===this.show_boardlist_boards.sel&&"replace"===pref.virtualBoard.p_board){for(var i=site.components.boardlist.getElementsByTagName("a"),o=0;o<i.length;o++){var l=i[o].textContent;this.show_boardlist_physical_extract_func&&(l=this.show_boardlist_physical_extract_func(l)),"#"!==l[0]&&(this.show_boardlist_boards["#"+(pref.liveTag.ci?l.toLowerCase():l)]={p:i[o]})}this.show_boardlist_boards.sel=!1}if("replace"===pref.virtualBoard.p_board){for(var c={},o=e.length-1;o>=0;o--){var l=pref.liveTag.ci?e[o].toLowerCase():e[o],s=this.show_boardlist_boards[l];if(s){if(!s.v){var p=s.p,_=liveTag.update_tag_string([l],"",t,"a").childNodes[0];_.setAttribute("href",p.getAttribute("href")),p.parentNode.insertBefore(_,p),p.parentNode.removeChild(p),s.v=_}e.splice(o,1),c[l]=null}}if(pref.virtualBoard.v_remove)for(var o in this.show_boardlist_boards)if(this.show_boardlist_boards[o].v&&void 0===c[o]){var p=this.show_boardlist_boards[o].p,_=this.show_boardlist_boards[o].v;_.parentNode.insertBefore(p,_),_.parentNode.removeChild(_),delete this.show_boardlist_boards[o].v}}},show_boardlist:function(e,t){var a=site.components.boardlist;if(this.show_boardlist_physical_board(e,t),a.lastChild.getAttribute&&a.lastChild.getAttribute("name")===pref.script_prefix+"_tag_parent"&&a.removeChild(a.lastChild),pref.virtualBoard.show&&0!==e.length){var n=liveTag.update_tag_string(e," / ",t);n.insertBefore(document.createTextNode("[ "),n.firstChild),n.appendChild(document.createTextNode(" ]")),a.appendChild(n)}},get_ops:function(e){return[]},get_posts:function(e){return[]},absolute_link:function(e){for(var t=["src","href"],a=e.pn.getElementsByTagName("*"),n=0;n<a.length;n++)for(var r=0;r<t.length;r++){var o=a[n].getAttribute(t[r]);o&&0!=o.indexOf("http")&&0!=o.indexOf("mailto:")&&0!=o.indexOf("blob")&&"//"!=o.substr(0,2)&&a[n].setAttribute(t[r],this.protocol+"//"+this.domain_url+o)}},absolute_link_1:function(e){return site2[this.nickname].protocol+"//"+site2[this.nickname].domain_url+e},ls_key_own_posts:pref.script_prefix+".own_posts.",prep_own_posts_event:function(e){e&&site2[site.nickname].prep_own_posts_1(e.key),window.name===site.nickname&&send_message("parent",[["OWN_POSTS",window.name,site3[window.name].own_posts]])},prep_own_posts:function(e){if(site3[this.nickname].own_posts={},localStorage)for(var t=e?[this.ls_key_own_posts+e]:Object.keys(localStorage),a=0;a<t.length;a++)this.prep_own_posts_1(t[a])},prep_own_posts_1:function(e){if(0==e.indexOf(this.ls_key_own_posts)){var t=e.substr(this.ls_key_own_posts.length),a=t.substr(0,t.lastIndexOf("/")+1);site3[this.nickname].own_posts[a]||(site3[this.nickname].own_posts[a]={});for(var n=JSON.parse(localStorage[e]||"[]"),r=0;r<n.length;r++)site3[this.nickname].own_posts[a][n[r]]=null}},clean_up_LS:function(e,t,a){e===site.nickname&&localStorage&&(pref.thread_reader.own_posts_tracker&&pref.thread_reader.clean_up_own_posts&&this.clean_up_LS_th(this.ls_key_own_posts,t,a),pref[cataLog.embed_mode].deleted_posts.auto_clean&&this.clean_up_LS_th(this.ls_key_deletedPosts,t,a),pref.recovery.auto_clean&&(this.clean_up_LS_th(this.ls_key_comment,t,a),this.clean_up_LS_th(pref.script_prefix+".comment."+site.nickname,t,a)))},ls_key_deletedPosts:pref.script_prefix+".deletedPosts.",clean_up_deleted_posts_1:function(e){localStorage&&delete localStorage[this.ls_key_deletedPosts+e]},ls_key_comment:pref.script_prefix+".draft.",clean_up_LS_th:function(e,t,a){for(var n=e+t,r=Object.keys(localStorage),o=0;o<r.length;o++)0==r[o].indexOf(n)&&void 0===a[r[o].substr(n.length)]&&delete localStorage[r[o]]},check_reply:function(){function e(e,t){for(var a=e.pn.getElementsByTagName("a"),n=0;n<a.length;n++){var r=!1,i=a[n].textContent;if(o&&null===o[i.substr(2)]&&f.test(i)&&(r=!0),!r&&s&&h.test(i)){var l=i.split("/"),c="/"+l[1]+"/";s[c]&&null===s[c][l[2]]&&(r=!0)}r&&("plain"===pref.thread_reader.show_reply_to_me_by?a[n].parentNode.insertBefore(document.createTextNode(" (You)"),a[n].nextSibling):a[n].textContent=a[n].textContent+" (You)")}if(t&&o&&null===o[e.no]){var p=e.parse_funcs_html.pn_name(e);"plain"===pref.thread_reader.show_own_post_by?p.parentNode.insertBefore(document.createTextNode(" (You)"),p.nextSibling):p.innerHTML=p.innerHTML+" (You)"}}function t(e,t,n,r){var i=o&&e.no in o;if(i&&(e.reply_of_mine=!0),!i||!pref.catalog_footer_ignore_my_own_posts){var l=c?e.com:e.body;if(l){var p=!1;if(o){var f=l.match(_);if(null!==f)for(var m=0;m<f.length;m++){var h=f[m].substr(d);if(null===o[h]){p=!0;break}}}if(!p&&s&&null!==(f=l.match(u)))for(var m=0;m<f.length;m++){var h=f[m].split("/"),g="/"+h[1]+"/";if(s[g]&&null===s[g][h[2]]){p=!0;break}}p&&(e.reply_to_me=!0,t[1]+=65536)}t[1]++}r[r.length]=e,n&&a(e,n)}function a(e,t){if(c){var a=e.com;if(!a)return;a=a.replace(/<[^>]*>|&[^;]*;/g," "),pref.test_mode[47]&&(p.innerHTML=a,a=p[brwsr.innerText])}else{if(e.editing)return void(t[t.length]=e.no);if(!(a=e.body||e.com))return}
if(a.indexOf("#")!==-1){if(l)for(var n=0;n<l.length;n++)a=a.replace(l[n],"\n");var r=a.match(liveTag.scan_regex);if(null!==r)for(var n=0;n<r.length;n++)if(r[n].length<=pref.liveTag.maxstr){if(i){for(var o=i.length-1;o>=0&&!i[o].test(r[n]);o--);if(o>=0)continue}t[t.length]=r[n]}}}function n(e){"txt"===e.parse_funcs.type_com?(_=m,d=2,u=g,c=!1):(_=b,d=8,u=v,c=!0)}function r(e){pref.liveTag.ex_list?(i=pref_func.merge_obj5a(e.key,pref.liveTag.ex_list_obj5,null),l=pref_func.merge_obj5a(e.key,pref.liveTag.rm_list_obj5,null)):(i=null,l=null)}var o,s,i,l,c=!1,p=document.createElement("div"),_="",d=0,u="",f=/^>>[0-9]+/,m=/>>[0-9]+/g,h=/^>>>\/[0-9A-z_\+]+\/[0-9]+/,g=/>>>\/[0-9A-z_\+]+\/[0-9]+/g,b=/&gt;&gt;[0-9]+/g,v=/&gt;&gt;&gt;\/[0-9A-z_\+]+\/[0-9]+/g,y=!0;return{remake_own_posts:function(){y=!0},make_own_posts:function(){site2[site.nickname].prep_own_posts(),y=!1},add_you:e,set_own_posts:function(e){s=site3[e.domain].own_posts,o=s[e.board]||s.ALL,0==Object.keys(s).length&&(s=void 0)},check_t1_op:function(e){n(e),r(e);var t=[];return a(e,t),t},get_checked_time:function(e){return e[2]},set_watch_time:function(e,t,a){t>0&&(e[0]|=262144,8388608&e[0]?e[2]=t:(this.time_watch[a]=t,e[0]&=4286578687))},set_watched_to_last:function(e,t,a){this.set_watch_time(e,t,a),e[1]=0},set_unwatch:function(e){e[0]&=4285792255,e[1]=0},time_watch:{},check:function(e,o,s,i){var l=131072&o[0],c=o[2],p=!1,_=o[2];262144&o[0]&&(8388608&o[0]?(c=0,o[2]=0):(_=this.time_watch[e.key],delete this.time_watch[e.key]),o[1]=0,o[0]=(4286251008&o[0]|524288)+(e.omitted_posts?e.omitted_posts+1:0),p=!0);var d=c,u=e.posts.length-1;if(u>=0){o[2]=e.posts[u].time*e.parse_funcs.time_unit||o[2],1!=e.parse_funcs.time_unit&&(c=Math.floor(c/e.parse_funcs.time_unit),_=p?Math.floor(_/e.parse_funcs.time_unit):c);var f="post"===pref.liveTag.from?[]:null;f&&r(e);var m=liveTag.generate_ur(o[1]),h=786432&o[0];if((h||f)&&n(e),h)for(y&&this.make_own_posts(),liveTag.mems[e.domain][e.board].nr=-1,n(e),this.set_own_posts(e);u>=0&&e.posts[u].time>_;)t(e.posts[u--],o,f,i);if(f)for(;u>0&&(l||e.posts[u].time>c);)a(e.posts[u--],f);if(!common_obj.thread_reader)if(f&&0!=f.length)var g=liveTag.extract_tags(e,f,null,!l);else if(pref.liveTag.style&&h){var b=liveTag.generate_ur(o[1]);m!=b&&liveTag.update_ur(e.key,b,0!=m&&p)}if(pref3.stats.use&&stats&&stats.aggregate(e),_!==c||!h){for(u=e.posts.length;u>0&&e.posts[u-1].time>c;)u--;var v=e.posts.slice(u)}}return o[0]=(4294508544&o[0])+e.nof_posts,s&&786432&o[0]&&(0!=i.length&&pref.notify.desktop.notify&&site2[e.domain].wrap_to_parse.posts({posts:i,__proto__:e}),notifier.changed(e,i)),{tags:g,posts:v||i,time_check_old:d}}}}(),get_post_offsetTop:function(e,t){},favicon:{},get_icon:function(){},add_icon:function(){},time_revised_check:function(e){return!1},format_thread_layout:function(e){},format_thread_style:function(e){},format_thread_contents:function(e){},format_thread_always:function(e){},format_remove_tn_area_size:function(e){},mark_newer_posts_posts:function(e,t,a,n){t/=this.parse_funcs.post_json.time_unit;for(var r=null,o=e.length-1;o>=0;o--){var s=e[o].pn;if(t<e[o].time)s.setAttribute("style",pref.style.post_new),a&&s.addEventListener("mouseover",this.unmark_post_from_event,!1),r=s;else{if(n)break;null!=s.getAttribute("style")&&s.removeAttribute("style")}}return r},mark_newer_posts:function(e,t,a,n,r,o){for(var s=null,i=t.length-1;i>=0;i--){var l=n?n(t[i]):t[i];if(l)if(a<site2[e].parse_funcs.post_html.time_pn(t[i]))l.setAttribute("style",pref.style.post_new),r&&l.addEventListener("mouseover",site2[e].unmark_post_from_event,!1),s=l;else if(null!=l.getAttribute("style")&&l.removeAttribute("style"),o)break}return s},format_pn:function(e,t,a,n){a||(a=pref[cataLog.embed_mode]),a.colorID&&this.colorID(e),a.backlink&&this.backlink(e,t),a.localtime&&this.localtime(e),n&&(site2.DEFAULT.check_reply.add_you(n,!0),n.deleted_after&&e.classList.add("CatChan_search_miss"),void 0!==n.search_result&&site2[n.domain_html].update_posts0_class(e,n.search_result))},colorID:function(){},backlink:function(){},localtime:function(){},unmark_post_from_event:function(e){e.target.removeEventListener("mouseover",site2.common.unmark_post_from_event,!1),site2.DEFAULT.unmark_post(e.target)},unmark_post:function(e){e.removeAttribute("style")},modify_thread_link:function(e){return[]},preprocess_html:function(e){return e},preprocess_doc:null,check_thread_archived:function(e){return!1},get_owners_recommendation:function(){return""},get_board_tags:function(){return{}},get_json_url_catalog:function(e){return""},parse_json_thread:function(e,t){},parse_json_catalog:function(e){return JSON.parse(e)},uip_tgt_post:function(e){return null},uip_post_num:function(e){return null},uip_check:function(e){},catalog_native_prep:function(e){return[]},catalog_native_prep_swap_sortSel:function(e){e.parentNode.insertBefore(cataLog.components.catalog.indexing,e.nextSibling),e.setAttribute("style","display:none")},catalog_frame_prep:function(e){},catalog_native_frame_prep:function(e,t){function a(){o?(site.root_body.removeChild(n),n=null,site.embed_frame_win=null,site2.common.disgorge_children(r)):(r=site2.common.absorb_children(site.root_body),r.style.width=pref.catalog_size_frame0_width+"%",r.style.float="left",r.style.height=window.innerHeight+"px",r.style.overflow="scroll",n=site2[site.nickname].catalog_native_frame_prep_frame(site.root_body,null)),o=!o}var n,r,o=!1;t.addEventListener("click",a,!1)},catalog_native_frame_prep_frame:function(e,t){return ifrm=document.createElement("iframe"),ifrm.setAttribute("name",site.embed_frame),ifrm.style.height=window.innerHeight+"px",ifrm.style.margin="0px",ifrm.style.width=pref.catalog_size_frame1_width+"%",e.insertBefore(ifrm,t),site.embed_frame_win=ifrm.contentWindow,ifrm},catalog_embed_prep:function(e){e.style.position="",e.childNodes[1].style.width="",e.childNodes[1].style.height=window.innerHeight+"px",e.childNodes[0].childNodes[0].style.display="none",e.childNodes[0].childNodes[1].style.display="none",e.style.border="",e.style.left="",e.style.resize="",e.style.top=""},thread2search_obj:function(e){return[e[brwsr.innerText],"","","","","","",""]},popups_op_func_set:function(){return 1},popups_op_func_use:function(e,t,a){e.setAttribute("class",e.getAttribute("class")+" reply")},popups_post_fetch:function(e,t){cataLog.scan_init("popup",[e.domain+t[1]+(pref.catalog.catalog_json?"t":"")+t[2]],{priority:8})},popup_info:null,popups_post_entry:function(e){function t(){a.onmouseout=null,l.parentNode.removeChild(l),site2.DEFAULT.popup_info=null}var a=e.target,n=a.href,r={};if("/"===n[0])r.domain=site.nickname;else{for(var o in liveTag.mems)if(n.indexOf(site2[o].domain_url)!=-1){r.domain=site2[o].nickname;break}n=n.replace(new RegExp("(http)*s*(://)*.*"+site2[r.domain].domain_url),"")}r.domain_html=pref.catalog.mimic_base_site?site.nickname:r.domain;var s=site2[r.domain].popups_href2th_q(a.getAttribute("href"));if(s){var i=s[2];if(!pref[cataLog.embed_mode].env.event_dynamic||!pref[cataLog.embed_mode].env.popup_native||site.nickname!==r.domain){var l,c=a;if(void 0===s[0][s[1]]&&pref.test_mode[80]){r.no=s[2][2];for(var p=["_IDB/","_File/"],_=0;_<2;_++){r.board=s[2][1].slice(0,-1)+p[_];var d=liveTag.mems[r.domain][r.board]&&liveTag.mems[r.domain][r.board][r.no]&&liveTag.mems[r.domain][r.board][r.no].q;if(d){s[0]=d;break}}}if(void 0===s[0][s[1]]||Array.isArray(s[0][s[1]]))site2[r.domain].popups_post_fetch(r,i),l=site2[r.domain_html].post_json2html({time:0,com:"Loading..."},i[1]),site2.DEFAULT.popup_info={node:a,clientX:e.clientX,clientY:e.clientY,key:i[0]+i[1]+i[2]+"#"+i[3],func_out:t},site2.DEFAULT.popups_set_waiting(s[0],parseInt(s[1],10));else{if(site2.DEFAULT.popup_info&&site2.DEFAULT.popup_info.func_out(),!s[0][s[1]].pn||s[0][s[1]].isOP){if(!s[0][s[1]].domain){var u=s[0][s[1]];if(u.domain=r.domain,u.extra_files)for(var _=0;_<u.extra_files.length;_++)u.extra_files[_].domain=r.domain}l=site2[r.domain_html].post_json2html(s[0][s[1]],i[1])}else l=s[0][s[1]].pn.cloneNode(!0);site2[r.domain_html].format_pn(l,s[0][s[1]])}l.style={},l.style.position="fixed",l.style.left=e.clientX+10+"px",pref.test_mode[25]?l.style.bottom=window.innerHeight-e.clientY+20+"px":l.style.top=e.clientY-15+"px",l.style.zIndex=1,"KC"!==site.nickname&&(l.style.borderStyle="solid"),l.style.boxShadow="rgb(153, 153, 153) 1px 1px 1px","4chan"===site.nickname&&l.classList.add("preview"),a.onmouseout=t,l.onmouseover=t,site2[site.nickname].popups_post_pnode(c).appendChild(l),pref.debug_mode[10]&&site2[r.domain].popups_debug("popup: "+s[1]+": ",s[0])}}},popups_post_pnode:function(e){for(;(e.getAttribute("class")||"").indexOf("post")==-1&&e.parentNode;)e=e.parentNode;return e},popups_href2dbtp:function(e,t,a){"#"===e[0]&&(e=a.board+"res/"+a.no+".html"+e,t.setAttribute("href",e));var n=e.split("/"),r=n[n.length-1].substr(n[n.length-1].indexOf("#")+1),o=n[n.length-1].substr(0,n[n.length-1].indexOf(".")),s=n.length>=3?"/"+n[n.length-3]+"/":site.board;return[this.nickname,s,o,r]},popups_href2th_q:function(e,t,a){var n=this.popups_href2dbtp(e,t,a),a=liveTag.mems.init({domain:n[0],board:n[1],no:n[2]});return void 0===a.q&&(a.q={}),liveTag.mems[n[0]][n[1]][n[2]]&&liveTag.mems[n[0]][n[1]][n[2]].q?[liveTag.mems[n[0]][n[1]][n[2]].q,n[3],n]:null},popups_add:function(e,t,a){var n=e.posts;e.popups||(e.popups=Object.create(null));var r=e.popups,o=liveTag.mems[t.domain][t.board][t.no];if(void 0===o.q&&(o.q={}),n&&"html"===t.type_data)for(var s=0;s<n.length;s++)n[s].no||Object.defineProperty(n[s],"no",{value:t.parse_funcs.no(n[s])});var i={};if(n)for(var s=0;s<n.length;s++){var l=n[s].no;i[l]=null,void 0===r[l]&&(this.popups_add_1(t,n[s],a,o.q,0===s,!0),r[l]=null)}if(!pref.catalog.filter.kwd.posts_active)for(var s in r)void 0===i[s]&&(this.popups_release(o.q,s,t.key),delete r[s])},popups_link_regex:/^>>(>\/.+\/)*[0-9]+/,popups_add_1:function(e,t,a,n,r,o){var s=/^>>/+e.no+"(\\s|\\(|$)/",i=[];t.pn||(t.pn=site2[e.domain_html].post_json2html(t,e.board));for(var l=t.pn.getElementsByTagName("a"),c=0;c<l.length;c++){var p=l[c].textContent;if(p.search(this.popups_link_regex)!=-1){a&&(l[c].onmouseover=this.popups_post_entry);var _=site2[e.domain].popups_href2th_q(l[c].getAttribute("href"),l[c],e);pref[cataLog.embed_mode].link_show_op&&0===p.search(s)&&p.indexOf("(OP)")==-1&&(l[c].textContent+=" (OP)");var d=l[c].parentNode.getAttribute("class");if((!d||d.indexOf(site2[e.domain_html].backlink_class)==-1)&&_){var u=parseInt(_[1],10);i[i.length]=[n,u],site2[e.domain_html].popups_add_backlink(n,u,e.key+"#"+t.no,e)}}}this.popups_set(n,t.no,t,o&&0!=i.length&&i),r&&(n[t.no].isOP=site2[e.domain_html].popups_op_func_set(t.pn))},popups_add_backlink:function(e,t,a,n){void 0===e[t]?(e[t]=[a],this.popups_set_waiting(e,t)):Array.isArray(e[t])?e[t].indexOf(a)==-1&&(e[t][e[t].length]=a):(e[t].backlinks||(e[t].backlinks=[]),e[t].backlinks.indexOf(a)==-1&&(e[t].backlinks[e[t].backlinks.length]=a,e[t].pn&&pref[cataLog.embed_mode].backlink&&site2[n.domain_html].add_backlinks(e[t].pn,e[t].backlinks,e[t].backlinks.length-1,n)))},popups_remove_backlink:function(e,t,a){if(e[t]){var n=Array.isArray(e[t])?e[t]:e[t].backlinks,r=n.indexOf(a);r>=0&&n.splice(r,1),0===n.length&&e[t].remove_if_no_backlinks&&delete e[t],pref.debug_mode[10]&&this.popups_debug("popups_remove_backlinks: "+t+": "+a+": ",e)}},popups_set:function(e,t,a,n){void 0===e[t]?(e[t]=a,e[t].backlinks=void 0):Array.isArray(e[t])?(a.backlinks=e[t],e[t]=a):(a.backlinks=e[t].backlinks,e[t]=a),n&&(e[t].quotes=n),a.editing?this.popups_set_waiting(e,t):e.waiting&&this.popups_remove_waiting(e,t)},popups_release:function(e,t,a){var n=e[t];if(n.quotes)for(var r=0;r<n.quotes.length;r++)this.popups_remove_backlink(n.quotes[r][0],n.quotes[r][1],a+"#"+t);n.backlinks&&0!==n.backlinks.length?n.remove_if_no_backlinks=1:delete e[t],pref.debug_mode[10]&&this.popups_debug("popups_release: "+t+": ",e)},popups_set_waiting:function(e,t){if(e.waiting){for(var a=0;a<e.waiting.length&&e.waiting[a]<t;)a++;e.waiting[a]!=t&&e.waiting.splice(a,0,t)}else e.waiting=[t]},popups_remove_waiting:function(e,t){var a=e.waiting.indexOf(t);a!=-1&&e.waiting.splice(a,1),0===e.waiting.length&&delete e.waiting},popups_fetched:function(e,t,a){a||(a=0);for(var n=e.posts.length-1,r=t.q.waiting.length-1;r>=0;r--){for(var o=t.q.waiting[r];n>a&&o<e.posts[n].no;)n--;o===e.posts[n].no?("html"===e.type_data&&this.popups_fetched_html(e.posts[n],e),site2[e.domain].wrap_to_parse.posts({posts:[e.posts[n]],__proto__:e}),cataLog.format_html.prepare_html_post(e,e.posts[n]),this.popups_add_1(e,e.posts[n],pref[cataLog.embed_mode].popup,t.q,o===e.no,!1)):"thread"===e.type_source&&(pref.test_mode[64],this.popups_set(t.q,o,{time:0,com:"DELETED"})),this.popup_info&&this.popup_info.key===e.key+"#"+e.posts[n].no&&this.popups_post_entry({target:this.popup_info.node,__proto__:this.popup_info})}},popups_fetched_html:function(e,t){var a={domain:t.domain,board:t.board,domain_html:t.domain_html,parse_funcs:t.parse_funcs};if(e.extra_files)for(var n=0;n<e.extra_files.length;n++)for(var r in a)e.extra_files[n][r]=a[r];for(var r in a)e[r]=a[r];e.parse_funcs.filename&&(e.filename=e.parse_funcs.filename(e));e.time;return e.sub,e.com,e.name,e.no,e.op_img_url,e.type_data=t.type_data,e},backlink:function(e,t){var a=t?Array.isArray(t)?t:t.backlinks:null;a&&this.add_backlinks(e,a)},popups_debug:function(e,t){var a="";for(var n in t)a+=n+":"+(Array.isArray(t[n])?t[n]:t[n].backlinks||t[n].remove_if_no_backlinks)+", ";console.log(e+a)},toplevel_anchor:function(e,t){for(var a=e.pn.getElementsByTagName("a"),n=0;n<a.length;n++){var r=a[n].getAttribute("href");r&&"#"===r[0]&&a[n].setAttribute("href",this.link_dbtp2href([e.domain,e.board,t,r.substr(1),"href"]))}},wrap_to_parse:function(){function e(){return pref.debug_mode.parse_error?site4.parse_funcs_on_demand_debug:site4.parse_funcs_on_demand}function t(t,a,r){var o=r.substr(0,r.indexOf("_")),s=r.substr(r.indexOf("_")+1),i=n[o]+n[s]+(pref.debug_mode.parse_error?"_debug":""),l=liveTag.mems.init({domain:t,board:a}).p[i];if(!l){var c=liveTag.mems[t].p,l=c[i];if(!l){var p=site2[t].parse_funcs[r+"_template"]||e(),_=pref.catalog.mimic_base_site||site2[t].mimic_always?site.nickname:t;c[i]={domain:t,parse_funcs:site2[t].parse_funcs[r],parse_funcs_html:site2[_].parse_funcs[o+"_html"],type_parse:r,type_source:o,type_data:s,type_html:o,domain_html:_,__proto__:p},l=c[i]}liveTag.mems[t][a].p[i]={board:a,__proto__:l},l=liveTag.mems[t][a].p[i]}return l}var a=/[A-z]/,n={catalog:"c",page:"i",thread:"t",post:"p",shortCatalog:"b",shortThread:"s",html:"h",json:"j"};return{get_getters:e,get:function(e,n,r,o,s){var i=t(n,r,o);return s&&(void 0!==s.thread&&a.test(s.thread)&&(s.thread=s.thread.substr(1)),s.__proto__=i,i=s),o.indexOf("_json")==-1?site2[n].parse_funcs[o].ths({pn:e,__proto__:i}):site2[n].parse_funcs[o].ths(e,i)},posts:function(e,a,n){var r=t(e.domain,e.board,"post_"+e.type_data);n&&(n.__proto__=r,r=n);var o=e.localArchive;if(o&&(r={localArchive:o,__proto__:r}),e.posts)for(var s=a||0;s<e.posts.length;s++)if(!e.posts[s].domain||o){if(e.posts[s].extra_files)for(var i=0;i<e.posts[s].extra_files.length;i++)e.posts[s].extra_files.domain||(e.posts[s].extra_files[i].__proto__=r);e.posts[s].__proto__=r}if(e.extra_files&&(!e.extra_files[0].domain||o))for(var i=0;i<e.extra_files.length;i++)e.extra_files[i].__proto__=r}}}(),parse_pn_dummy:document.createElement("div"),parse_funcs:{common:{finisher:function(){},posts:function(){},com:function(){},flags:function(){},flag:function(){},th_init:null,tn_as:function(e){return e.pn.getElementsByTagName("a")},tn_imgs:function(e){for(var t=[],a=e.pn.getElementsByTagName("a"),n=0;n<a.length;n++){var r=a[n].getElementsByTagName("img")[0];r&&(t[t.length]=r)}return t},key:function(e){return e.domain+e.board+e.no},pn:function(e){return site2[e.domain_html].catalog_json2html3(e,e.board,this.op_img_url(e))},op_img_url:function(e){return site2[e.domain].catalog_json2html3_thumbnail(e,e.board)},get_op_src:function(e){return e.op_img_url},ths_array:function(e,t){var a=[];if(t)for(var n=t.length-1;n>=0;n--){var r="catalog"===e.type_html?Math.floor(n/15)+"."+n%15:"page"===e.type_html?e.page+"."+n:void 0;a[n]={pn:t[n],page:r,__proto__:e.__proto__}}return a},time:function(e){},time_posted:function(e){},time_unit:1,has_posts:!0,txt:function(e){return site2.DEFAULT.parse_pn_dummy.innerHTML=e.com,site2.DEFAULT.parse_pn_dummy[brwsr.innerText]},type_com:"html",footer_clear:function(e){},get_lth_from_node:function(e){for(;e&&!e.name;)e=e.parentNode;return e&&liveTag.mems.getFromName(e.name)||null}},catalog_html:{posts:function(e){return[{sub:e.sub,com:e.com,name:e.name,pn:e.pn}]},time:function(e){return e.time_created},posts_full:function(){var e={posts:null,pn:null,flag:null,flags:null,footer:null,pn_name:null,ths:null,page:null,tn_as:null,tn_imgs:null,txt:null,parse_funcs:null,parse_funcs_html:null,type_parse:null,type_source:null,type_data:null,type_html:null,domain:null,board:null,domain_html:null,exe_sub:null,exe_sub2:null};return function(t){for(var a in t)void 0===e[a]&&t.parse_funcs[a]&&Object.defineProperty(t.posts[0],a,{value:t[a],enumerable:!0,configurable:!0,writable:!0})}}(),has_posts:!1,type_com:"txt",filename:function(e){var t=e.op_img_url.replace(/.*\//,""),a=t.indexOf(".");return e.tim=t.substr(0,a),e.tim}},catalog_json:{ths:function(e,t){for(var a=[],n=0;n<e.length;n++)if(e[n].threads)for(var r=0;r<e[n].threads.length;r++)e[n].threads[r].page=n+"."+r,e[n].threads[r].sticky=1===e[n].threads[r].sticky,e[n].threads[r].type_html="catalog",e[n].threads[r].__proto__=t,a[a.length]=e[n].threads[r];return a},posts:function(e){return[{time:e.time,DUMMY:!0}]},posts_full:function(e){delete e.posts[0].DUMMY;for(var t=Object.keys(e),a=0;a<t.length;a++)"posts"!==t[a]&&"pn"!==t[a]&&(e.posts[0][t[a]]=e[t[a]])},has_posts:!1},page_html:{posts_array:function(e,t){var a=[],n=e.__proto__;if(pref.test_mode[5])a.pns=t,a.idx0=0,a.idx1=t.length-1,a.get0=this.posts_get0,a.get1=this.posts_get1,a.proto=n,Object.defineProperty(a,a.idx0,{get:a.get0,enumerable:!0,configurable:!0}),Object.defineProperty(a,a.idx1,{get:a.get1,enumerable:!0,configurable:!0});else for(var r=0;r<t.length;r++)a[a.length]={pn:t[r],__proto__:n};return a},posts_get0:function(){var e={pn:this.pns[this.idx0],__proto__:this.proto};return Object.defineProperty(this,this.idx0,{value:e,enumerable:!0,configurable:!0,writable:!0}),++this.idx0<this.idx1&&Object.defineProperty(this,this.idx0,{get:this.get0,enumerable:!0,configurable:!0}),e},posts_get1:function(){var e={pn:this.pns[this.idx1],__proto__:this.proto};return Object.defineProperty(this,this.idx1,{value:e,enumerable:!0,configurable:!0,writable:!0}),--this.idx1>this.idx0&&Object.defineProperty(this,this.idx1,{get:this.get1,enumerable:!0,configurable:!0}),e},posts:function(e){return this.posts_array(e,e.pn.getElementsByClassName("post"))},time_posted:"thread_html",time_bumped:function(e){return e.posts[e.posts.length-1].time},time_created:function(e){return e.posts[0].time},key:function(e){return e.domain+e.board+e.no},insert_footer4:function(e){var t=document.createElement("div");return e.parentNode.insertBefore(t,e)},flags:function(e){var t=[],a=e.posts.length-1,n=pref[cataLog.embed_mode].t2h_num_of_posts-1;if(a<n)for(n=0;n<=a;)e.posts[n]&&(t[n]=e.posts[n].flag),n++;else for(;n>=0;)e.posts[a]&&(t[n--]=e.posts[a--].flag),0==n&&(a=0);return t},html_org:function(e){return e.pn.innerHTML},sticky:function(){return!1},type_com:"txt",replace_omitted_info:function(e,t){e.textContent=t.textContent},replace_omitted_info2:"replace_omitted_info",posts_full:"catalog_html",get_max_page:function(e){var t=e.getElementsByClassName("pages")[0];if(t){t=t.childNodes;for(var a=0,n=0;n<t.length;n++)a+1==t[n].textContent&&a++;return a}}},page_json:{ths:function(e,t){var a=[];if(e&&e.threads)for(var n=0;n<e.threads.length;n++){var r=e.threads[n];r&&(r.page=t.page?t.page+"."+n:void 0,r.key=t.domain+t.board+r.posts[0].no,r.posts[0].__proto__=t,r.__proto__=r.posts[0],a[n]=r)}return a}},thread_html:{ths_array:function(e,t){return[{pn:t,page:"?",__proto__:e.__proto__}]},time_posted:function(e){return e.posts[e.posts.length-1].time},posts_full:"catalog_html",type_com:"txt"},thread_json:{ths:function(e,t){return e.key=t.domain+t.board+e.posts[0].no,e.posts[0].__proto__=t,e.__proto__=e.posts[0],[e]},time_created:function(e){return 1e3*e.posts[0].time},time_bumped:function(e){for(var t=e.posts.length-1;t>0&&e.posts[t].email&&"sage"===e.posts[t].email;)t--;return 1e3*e.posts[t].time},time_posted:function(e){return 1e3*e.posts[e.posts.length-1].time},nof_posts:function(e){return e.posts[0].replies+1},nof_files:function(e){return e.posts[0].images+1},has_nof_files:!0,sub:function(e){return e.posts[0].sub||""},name:function(e){return e.posts[0].name||""},com:function(e){return e.posts[0].com||""},sticky:function(e){return 1===e.posts[0].sticky},time_unit:1e3,prep_to_archive:function(e){return{posts:e}},rip_from_archive:function(e){return e.posts||e}},post_html:{sub:function(e){var t=e.pn.getElementsByClassName("subject")[0];return t?t.textContent:""},img2src:function(e){return e.parentNode.href},img2ext:function(e){return e.parentNode.getAttribute("data-ext")}},post_json:{time_unit:1e3,pn:function(e){return site2[e.domain_html].post_json2html(e,e.board)},anchor:function(){}},catalog_json_template:"post_json_template",page_json_template:"post_json_template",thread_json_template:"post_json_template",post_json_template:{sub:"",name:"Anonymous",com:"",sticky:void 0,pn:void 0,no:void 0,time:void 0}},parse_parts:{add_op_img_url:function(e,t,a){for(var n=0;n<e.length;n++)e[n].op_img_url=site2[a].catalog_json2html3_thumbnail(e[n],t)}},update_posts_merge_prep:function(e,t,a,n){if(e){a=a>=0?a+1:(t&&t.length?t.length:0)+e.length,a<e.length&&(e=e.slice(0,1).concat(e.slice(e.length-a+1)));var r=1,o=0,s=[e[0]];if(n)for(;r<e.length&&o<t.length;)e[r].no!==t[o].no?s[s.length]=e[r].no<t[o].no?e[r++]:t[o++]:(s[s.length]=e[r++],o++);else for(;r<e.length&&o<t.length;)s[s.length]=e[r].time*e[r].parse_funcs.time_unit<t[o].time*t[o].parse_funcs.time_unit?e[r++]:t[o++];return s=s.concat(r<e.length?e.slice(r):t.slice(o)),s.length<=a?s:s.slice(0,1).concat(s.slice(s.length-a+1,s.length))}},update_posts_merge_bases:{bases:{},initialized:!1,query:function(e,t,a){var n=e.key;if(this.bases[n])return this.bases[n];var r=t?this.bases[t]:null;return r?(this.bases[n]=r,this.merge_th(e,r),a&&cataLog.catalog_obj2.func_hide_org(n),cataLog.threads[n][0]=r.pn,r):(this.bases[n]=this.base_factory(e,a),this.initialized||this.setup_hook(),this.bases[n])},base_factory:function(){var e={lazy_draw:function(e){e>=this.lazy.length?this.lazy[e]=!0:this.lazy.splice(e,0,!0),this.lazy_idx>e&&(this.lazy_idx=e)},remove:function(e){return this.posts.splice(e,1),e<this.lazy_idx&&this.lazy_idx--,!this.lazy||!this.lazy.splice(e,1)[0]},draw_1_pos:function(e){for(var t=e+1;t<this.lazy.length&&this.lazy[t];)t++;return this.lazy[e]=!1,t}};return function(t,a){return{pn:t.pn,posts:t.posts.slice(),isShown:1,lazy:pref[cataLog.embed_mode].lazyDraw_merge?t.posts.map(function(){return!1}):null,lazy_idx:pref[cataLog.embed_mode].lazyDraw_merge?t.posts.length:null,__proto__:e}}}(),lazy_draw:null,remove_th:function(e,t){var a=this.bases[e.key];if(a){var n=t?null:site2[e.domain_html].page_json2html3_skelton(e);site2[e.domain_html].update_posts_separate(e,a,n),0==--this.bases[e.key].isShown&&(cataLog.catalog_obj2.func_hide_org(e.key),this.shown.delete(a),cataLog.catalog_obj2.lazy_tgts.delete(a)),delete this.bases[e.key],t||(cataLog.threads[e.key][0]=n)}},merge_th:function(e,t){for(var a=0,n=0;n<e.posts.length;n++)a=site2[e.domain_html].update_posts_merge_1(e,t,n,a);this.bases[e.key].isShown++,t.lazy&&t.lazy_idx<t.posts.length&&this.lazy_tgts.set(t,e.key)},base_tgts:function(e){if(pref[cataLog.embed_mode].merge)return Object.keys(this.bases)[0]||e;if(pref[cataLog.embed_mode].merge_list){var t=pref_func.merge_obj5a_sc(e,pref3.proto.merge_list_obj2,null);if(!t)return null;for(var a in this.bases)if(pref_func.merge_obj5a_sc(a,pref3.proto.merge_list_obj2,null)===t)return a;return e}return null},func_show:function(e,t,a){var n=site2.DEFAULT.update_posts_merge_bases,r=n.bases[e];if(!r){var o=n.base_tgts(e);if(o){var s=cataLog.threads[e];r=n.query({pn:s[0],__proto__:s[16]},o,!1)}}return r?(n.shown.has(r.pn)||cataLog.catalog_obj2.func_show_org(e,t,a),!0):this.func_show_org(e,t,a)},func_hide:function(e){var t=site2.DEFAULT.update_posts_merge_bases;return t.bases[e]?(t.remove_th(cataLog.threads[e][16]),!0):this.func_hide_org(e)},func_search_ref:function(e){var t=site2.DEFAULT.update_posts_merge_bases;return t.bases[e]&&t.shown.get(t.bases[e])!==e},func_track_shown:function(e,t){var a=site2.DEFAULT.update_posts_merge_bases,n=a.bases[e];if(n){var r=n.pn;if(a.shown.has(r)&&a.shown.get(r)!==e||(this.func_track_shown_org(e,!pref[cataLog.embed_mode].merge&&t),a.shown.set(r,e)),n.lazy&&n.lazy_idx<n.posts.length&&this.lazy_tgts.set(n,e),pref[cataLog.embed_mode].merge&&t)var o=pref.test_mode[88]?1:pref[cataLog.embed_mode].lazyDraw_merge_step;++this.post_count%o==0&&(this.drawn_y=cataLog.threads[e][16].posts[0].pn.offsetTop)}else this.func_track_shown_org(e,t)},shown:new Map,func_track_reset:function(){site2.DEFAULT.update_posts_merge_bases.shown.clear(),this.post_count=0,this.lazy_tgts.clear(),this.func_track_reset_org()},setup_hook:function(){cataLog.catalog_obj2.func_show_org=cataLog.catalog_obj2.func_show,cataLog.catalog_obj2.func_show=this.func_show,cataLog.catalog_obj2.func_hide_org=cataLog.catalog_obj2.func_hide,cataLog.catalog_obj2.func_hide=this.func_hide,cataLog.catalog_obj2.func_track_shown_org=cataLog.catalog_obj2.func_track_shown,cataLog.catalog_obj2.func_track_shown=this.func_track_shown,cataLog.catalog_obj2.func_track_reset_org=cataLog.catalog_obj2.func_track_reset,cataLog.catalog_obj2.func_track_reset=this.func_track_reset,cataLog.catalog_obj2.func_search_ref=cataLog.catalog_obj2.func_search_ref,cataLog.catalog_obj2.post_count=0;var e=new Map;cataLog.catalog_obj2.lazy_tgts=e,this.lazy_tgts=e,this.initialized=!0,cataLog.catalog_obj2.lazy_draw=function(){var t=cataLog.get_ref_height(4);for(var a of e.keys()){var n=a.lazy_idx;if(n>=1&&a.posts[n-1].pn.offsetTop>t)break;for(var r=0,o=pref.test_mode[88]?1:pref[cataLog.embed_mode].lazyDraw_merge_step,s=pref.catalog.mimic_base_site?site.nickname:cataLog.threads[e.get(a)][16].domain_html;n<a.posts.length;){if(a.lazy[n]){for(r<n&&(r=n+1);r<a.lazy.length&&a.lazy[r];)r++;site2[s].update_posts_insert(a.posts,a.posts,n,r,a.pn,a),a.lazy[n]=!1}if(++cataLog.catalog_obj2.post_count%o==0&&a.posts[n].pn.offsetTop>t)break;n++}if(a.lazy_idx=n,n<a.posts.length)break;e.delete(a)}}},release_hook:function(){},onchange_merge:function(e){var t=(e.target.name||e.target.getAttribute("name")).split(".")[1];if("merge_list_str"!==t||pref[cataLog.embed_mode].merge_list){var a="merge"===t?function(){return!0}:"merge_list"===t?function(e){return pref_func.merge_obj5a_sc(e,pref3.proto.merge_list_obj2,null)||pref_func.merge_obj5a_sc(e,pref3.proto.merge_list_obj2_old,null)}:function(e){var t=pref_func.merge_obj5a_sc(e,pref3.proto.merge_list_obj2,null),a=pref_func.merge_obj5a_sc(e,pref3.proto.merge_list_obj2_old,null);return t?!a||t.join()!==a.join():a};for(var n in cataLog.threads){var r=cataLog.threads[n];r[1]&&a(n)&&cataLog.catalog_obj2.func_hide(n)&&(r[1]=!1)}pref3.proto.merge_list_obj2_old=null,cataLog.catalog_obj2.func_track_reset();var o=site2.DEFAULT.update_posts_merge_bases;o.initialized||o.setup_hook(),"merge"===t?(pref[cataLog.embed_mode].merge&&(pref3.catalog.indexing_old=pref.catalog.indexing),cataLog.components.catalog.indexing.onfocus(),pref.catalog.indexing=pref[cataLog.embed_mode].merge?7:pref3.catalog.indexing_old,pref_func.apply_prep(cataLog.components.catalog.indexing,!1,!0),cataLog.components.catalog.indexing.onblur(),cataLog.components.catalog.indexing.disabled=pref[cataLog.embed_mode].merge):cataLog.show_catalog()}}},update_posts_replace_prep:function(e,t,a){if(!e||e.length<=1)return t;if((a=a>=0?a+1:t.length+e.length-1)==e.length)return e;if(a<e.length)return e.slice(0,1).concat(e.slice(e.length-a+1));for(var n=e[1].no,r=1;r<t.length&&t[r].no<n;)r++;if(1===r)return e;var o=r>a-e.length?r-(a-e.length):1;return e.slice(0,1).concat(t.slice(o,r),e.slice(1))},update_posts0_class:function(e,t){t?e.classList.remove("CatChan_search_miss"):e.classList.add("CatChan_search_miss")},update_posts_replace:function(e,t,a,n,r,o){if(n&&(a=n.pn,r=n.isShown),t.posts){var s=t.parse_funcs_html.get_omitted_info(t.posts[0]),i=e.posts[0].pn?e.parse_funcs_html.get_omitted_info(e.posts[0]):site2[e.domain_html].page_json2html3_add_omitted_info(e,null,e.posts);s?t.parse_funcs_html.replace_omitted_info2(s,i,e):i&&t.parse_funcs_html.set_omitted_info(t.posts[0],i);for(var l=-1,c=e.posts.length-1,p=t.posts.length-1;p>=1;p--){for(;c>1&&e.posts[c].no>t.posts[p].no;)c--;if(e.posts[c].no!=t.posts[p].no)l=this.update_posts_remove_1(t,p,a,r,n,l);else if(t.posts[p].editing&&t.posts[p].pn&&t.posts[p]!==e.posts[c]){var _=liveTag.mems[e.domain][e.board][e.no].q;cataLog.format_html.prepare_html_post(e,e.posts[c]),this.popups_add_1(e,e.posts[c],!0,_,0===c,!0),pref[cataLog.embed_mode].backlink&&_[e.posts[c].no].backlinks&&site2[e.domain_html].add_backlinks(e.posts[c].pn,_[e.posts[c].no].backlinks,void 0,e),t.posts[p].pn.parentNode.insertBefore(e.posts[c].pn,t.posts[p].pn),t.posts[p].pn.parentNode.removeChild(t.posts[p].pn),t.posts[p]=e.posts[c],o[o.length]=e.posts[c]}}}this.update_posts_add(e,t,a,n,r,o)},update_posts_add:function(e,t,a,n,r,o){if(t.posts&&e.posts)for(var s=(liveTag.mems[e.domain][e.board][e.no].q,n&&e.parse_funcs.time_unit,-1),i=n?0:1,l=n?0:1;l<e.posts.length;l++){for(;i<t.posts.length&&e.posts[l].no>t.posts[i].no;)i++;(i>=t.posts.length||e.posts[l].no!=t.posts[i].no)&&(cataLog.format_html.prepare_html_post(e,e.posts[l]),n?s=this.update_posts_merge_1(e,n,l,s):this.update_posts_insert(e.posts,t.posts,l,i,a,n),i<t.posts.length?t.posts.splice(i,0,e.posts[l]):t.posts[t.posts.length]=e.posts[l],o[o.length]=e.posts[l]),i<t.posts.length&&i++}},update_posts_remove_1:function(e,t,a,n,r,o){var s=e.posts[t];return n&&pref[cataLog.embed_mode].scroll_lock&&cataLog.show_catalog_scroll_lock.modified(s),r?(o=o==-1?r.posts.indexOf(s):r.posts.lastIndexOf(s,o),o==-1&&(o=r.posts.lastIndexOf(s)),o>=0&&r.remove(o)&&this.update_posts_remove(e,t,a)):s.pn&&this.update_posts_remove(e,t,a),e.posts.splice(t,1),o},update_posts_merge_1:function(e,t,a,n){var r=e.posts[a].time_tu;for(n==-1&&(n=t.posts.length-1);n>0&&t.posts[n].time_tu>=r;)n--;for(;n<t.posts.length&&(t.posts[n].time_tu<r||t.posts[n].time_tu==r&&t.posts[n].no<=e.posts[a].no);)n++;return t.lazy?t.lazy_draw(n):this.update_posts_insert(e.posts,t.posts,a,n,t.pn,t),t.lazy&&0==a&&(pref[cataLog.embed_mode].merge||pref.test_mode[89]?this.update_posts_insert(e.posts,t.posts,a,t.draw_1_pos(n)-1,t.pn,t):e.posts[0].isOP=!0),n<t.posts.length?t.posts.splice(n,0,e.posts[a]):t.posts[t.posts.length]=e.posts[a],n},update_posts_separate:function(e,t,a){for(var n=0,r=0;r<e.posts.length;r++){var o=e.posts[r];n=t.posts.indexOf(o,n),n==-1&&(n=t.posts.indexOf(o));var s=n!=-1&&t.remove(n);t.isShown&&pref[cataLog.embed_mode].scroll_lock&&cataLog.show_catalog_scroll_lock.modified(o),a?this.update_posts_insert(e.posts,[],r,r,a,!1):s&&this.update_posts_remove(e,r,t.pn)}},short_link:function(){return""},page_json2html3_replace_expander:function(){},page_json2html3_add_omitted_info:function(){},post_json2html_fname_server:function(e){return e.tim+e.ext},post_json2html_fname:function(e){return e.filename+e.ext},post_com2txt:function(e){return e.com?e.com.replace(/<[^>]*>/g," ").replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&amp;/g,"&"):""},patch:{}},site2.common={absorb_children:function(e){for(var t=document.createElement("div");0!=e.childNodes.length;)t.appendChild(e.childNodes[0]);return e.appendChild(t),t},disgorge_children:function(e){for(;0!=e.childNodes.length;)e.parentNode.appendChild(e.childNodes[0]);e.parentNode.removeChild(e)},remove_by_classname:function(e,t,a,n){
void 0===a&&(a=0);for(var r=e.getElementsByClassName(t),o=r.length-1-a;o>=0;o--)n&&r[o].nextSibling&&"BR"===r[o].nextSibling.tagName&&r[o].parentNode.removeChild(r[o].nextSibling),r[o].parentNode.removeChild(r[o])},remove_by_tagname:function(e,t,a){void 0===a&&(a=0);for(var n=e.getElementsByTagName(t),r=n.length-1-a;r>=0;r--)n[r].parentNode.removeChild(n[r])},remove_by_attribute:function(e,t,a){for(var n=e.length-1;n>=0;n--)for(var r=e[n].childNodes.length-1;r>=0;r--)e[n].childNodes[r].getAttribute&&e[n].childNodes[r].getAttribute(t)&&e[n].childNodes[r].getAttribute(t).search(a)!=-1&&e[n].removeChild(e[n].childNodes[r])},remove_attribute:function(e,t){for(var a=e.getElementsByTagName("*"),n=a.length-1;n>=0;n--)a[n].getAttribute&&a[n].getAttribute(t)&&a[n].removeAttribute(t)},add_attribute_by_classname:function(e,t,a,n){for(var r=e.getElementsByClassName(t),o=r.length-1;o>=0;o--)r[o].setAttribute(a,n)},add_attribute_by_tagname:function(e,t,a,n){for(var r=e.getElementsByTagName(t),o=r.length-1;o>=0;o--)r[o].setAttribute(a,n)},add_attribute_by_attribute:function(e,t,a,n,r){for(var o=e.length-1;o>=0;o--)for(var s=e[o].childNodes.length-1;s>=0;s--)e[o].childNodes[s].getAttribute&&e[o].childNodes[s].getAttribute(t)&&e[o].childNodes[s].getAttribute(t).search(a)!=-1&&e[o].setAttribute(n,r)},move_up_and_delete_parent:function(e){for(var t=0;t<e.length;t++){var a=e[t].parentNode,n=a.parentNode;n.insertBefore(e[t],a),n.removeChild(a)}},remove_last_hrs_and_brs:function(e){for(;;){var t=e.childNodes[e.childNodes.length-1];if("HR"!==t.tagName&&"BR"!==t.tagName)break;e.removeChild(t)}},remove_brs:function(e){for(var t=e.getElementsByTagName("br"),a=t.length-1;a>=0;a--)t[a].parentNode.removeChild(t[a])},remove_double_br:function(e){for(var t=e.getElementsByTagName("*"),a=t.length-2;a>=0;a--)"<br>"===t[a].outerHTML&&t[a].nextSibling&&"BR"===t[a].nextSibling.tagName&&t[a].parentNode.removeChild(t[a].nextSibling)},remove_double_tags:function(e,t){for(var a=e.getElementsByTagName("*"),n=a.length-2;n>=0;n--)a[n].tagName===t&&a[n+1].tagName===t&&a[n+1].parentNode.removeChild(a[n+1])},change_utc_to_local:function(e){var t=new Date(e);return t.toLocaleString().replace(/\ /," ("+t.toString().replace(/\ .*/,"")+") ")}};var site4={tb_prep_for_embed:function(e){e.childNodes[0].innerHTML="",e.childNodes[1].innerHTML="",e.childNodes[0].draggable=!1,e.childNodes[3].ondblclick=null,e.childNodes[3].draggable=!1,e.childNodes[3].removeAttribute("style")},parse_funcs_getters:{get no(){return this.exe_sub("no")},get key(){return this.exe_sub("key")},get time_bumped(){return this.exe_sub("time_bumped")},get nof_posts(){return this.exe_sub("nof_posts")},get nof_files(){return this.exe_sub("nof_files")},get time_created(){return this.exe_sub("time_created")},get posts(){return this.exe_sub("posts")},get sub(){return this.exe_sub("sub")},get name(){return this.exe_sub("name")},get com(){return this.exe_sub("com")},get flag(){return this.exe_sub("flag")},get flags(){return this.exe_sub("flags")},get footer(){return this.exe_sub("footer")},get sticky(){return this.exe_sub("sticky")},get pn(){return this.exe_sub("pn")},get time(){return this.exe_sub("time")},get time_posted(){return this.exe_sub("time_posted")},get tn_as(){return this.exe_sub2("tn_as")},get tn_imgs(){return this.exe_sub2("tn_imgs")},get op_img_url(){return this.exe_sub("op_img_url")},get txt(){return this.exe_sub("txt")},get time_tu(){return this.time*this.parse_funcs.time_unit},get lth(){return liveTag.mems[this.domain][this.board][this.no]},get type_mimic(){return this.type_parse}},parse_funcs_on_demand:{},parse_funcs_on_demand_debug:{},parse_funcs_no_cache:{},parse_funcs_one_time:{}};site4.parse_funcs_on_demand={exe_sub:function(e){return Object.defineProperty(this,e,{value:this.parse_funcs[e](this),enumerable:!0,configurable:!0,writable:!0})[e]},exe_sub2:function(e){return this.parse_funcs_html[e](this)},__proto__:site4.parse_funcs_getters},site4.parse_funcs_on_demand_debug={exe_sub:function(e){try{return Object.defineProperty(this,e,{value:this.parse_funcs[e](this),enumerable:!0,configurable:!0,writable:!0})[e]}catch(t){console.log("parse_error: "+this.key+", "+this.type_parse+", "+e),console.trace(),console.log(this)}},exe_sub2:function(e){try{return this.parse_funcs_html[e](this)}catch(t){console.log("parse_error: "+this.key+", "+this.type_parse+", "+e),console.trace(),console.log(this)}},__proto__:site4.parse_funcs_getters},site4.parse_funcs_no_cache={exe_sub:function(e){return this.parse_funcs[e](this)},exe_sub2:function(e){return this.parse_funcs_html[e](this)},__proto__:site4.parse_funcs_getters},site4.parse_funcs_one_time={get posts(){return Object.defineProperty(this,"posts",{value:this.parse_funcs.posts(this),enumerable:!0,configurable:!0,writable:!0}).posts},exe_sub:function(e){return this.parse_funcs[e](this)},exe_sub2:function(e){return this.parse_funcs_html[e](this)},__proto__:site4.parse_funcs_getters},site2["8chan"]={nickname:"8chan",domain_url:"8ch.net",home:site.protocol+"//8ch.net"+(brwsr.ff?"/faq.html":"/favicon.ico"),protocol:site.protocol,features:{uip_tracker:!0},pref_default:{catalog_expand_with_hr:!0,page:{env:{disp_offset:1,disp_filler:"<hr>"}}},utilize_boards_json:!0,check_func:function(){var e=window.location.href;if(e.search(/8chan.co|8ch.net/)!=-1){site2["8chan"].domain_url=e.search(/8ch.net/)!=-1?"8ch.net":"8chan.co",this.home=site.protocol+"//"+this.domain_url+this.home.substr(this.home.lastIndexOf("/"));var t=document.getElementsByTagName("header")[0];return site.whereami=t&&t.innerHTML.indexOf("404 Not Found")!=-1?"404":e.search(/8ch\.net\/?$/)!=-1?"frame":e.search(/catalog\.html/)!=-1?"catalog":e.search(/res\/[0-9\+]*\.html/)!=-1?"thread":e.search(/\/$|(index|[0-9]+)\.html|\/#all$/)!=-1?"page":e.search(/boards.html/)!=-1?"boards":"other",site.config(site2["8chan"].domain_url,"8chan"),site.header_height=function(){var e=document.getElementsByClassName("boardlist")[0];return e?e.offsetHeight:0},site.postform=document.getElementsByTagName("form")[0],site.postform&&this.postform_prep(),site.max_page=site2["8chan"].max_page(site.board),site.catalog=e.search(/catalog\.html/)!=-1,"thread"===site.whereami||"page"===site.whereami?(site.embed_to.top=document.getElementsByName("postcontrols")[0],site.embed_to.bottom=document.getElementsByClassName("boardlist bottom")[0]):"catalog"===site.whereami&&(site.embed_to.top=document.getElementsByClassName("thumbnail")[0].nextSibling,site.embed_to.bottom=document.getElementsByTagName("footer")[0]),site.components.boardlist&&(site.components.boardlist.style.zIndex=0),!0}return brwsr.ff||(this.protocol="https:",this.home=this.protocol+"//"+this.domain_url+this.home.substr(this.home.lastIndexOf("/"))),!1},postprocess_board:function(e){for(var t=0;t<e.length;t++)if(e[t].max>0){var a=liveTag.mems.init({domain:this.nickname,board:"/"+e[t].uri+"/"});a.o=t,e[t].pages&&!a.pgs&&(a.pgs=e[t].pages),Object.defineProperty(a,"max",{value:parseInt(e[t].max,10),writable:!0}),void 0===a.read_max&&Object.defineProperty(a,"read_max",{value:0,writable:!0}),e[t].tags&&0!=e[t].tags.length&&liveTag.postprocess_board_add_btag(e[t].tags,a)}},catalog_frame_prep:function(e){document.getElementsByTagName("header")[0].style.display="none",document.getElementsByClassName("footer")[0].style.display="none";var t=document.getElementsByClassName("menuCol")[0];t.firstChild.style.display="none";var a=document.getElementsByClassName("bodyCol")[0];a.firstChild.style.display="none",t.insertBefore(e,t.firstChild);this.catalog_native_frame_prep_frame(a,a.firstChild);this.catalog_embed_prep(e)},prep_own_posts_event:function(e){e&&"own_posts"===e.key&&site2["8chan"].prep_own_posts(),"8chan"===window.name&&send_message("parent",[["OWN_POSTS",window.name,site3[window.name].own_posts]])},prep_own_posts:function(){var e={},t=JSON.parse(localStorage.getItem("own_posts"));for(var a in t){var n="/"+a+"/";e[n]={};for(var r=0;r<t[a].length;r++)e[n][t[a][r]]=null}site3["8chan"].own_posts=e},preprocess_doc2:{thread_html:function(e){for(var t=e.getElementsByTagName("head")[0];t.firstChild;)t.removeChild(t.firstChild);for(var a=e.getElementsByTagName("body")[0],n=a.childNodes.length-1;n>=0;n--)"postcontrols"!==a.childNodes[n].name&&a.removeChild(a.childNodes[n])}},parse_funcs:{catalog_html:{before_test:["ths",":ITER",":ALL","ths",["key","time_bumped","nof_posts","nof_files"]],after_test:["time_created","sub","name","com","footer","sticky","format"],full_hier:["ths",":ITER",":ALL","ths",["key","time_bumped","nof_posts","nof_files","time_created","sub","name","com","footer","sticky","format"]],ths:function(e){var t=e.pn.getElementsByClassName("mix"),a=[];if(pref.test_mode[0])for(var n=0;n<t.length;n++)"DIV"===t[n].tagName&&(a[a.length]={pn:t[n],page:Math.floor(n/15)+"."+n%15});else{for(var n=0;n<t.length;n++)"DIV"===t[n].tagName&&(a[a.length]=t[n]);a=this.ths_array(e,a)}return a},th_init:function(e){var t=e.pn.getElementsByTagName("div")[0];t.className=t.className.replace(/grid\-size\-[a-z]*/,"grid-size-"+site2["8chan"].catalog_native_size)},no:function(e){return parseInt(e.pn.getAttribute("data-id"),10)},sticky:function(e){return"true"===e.pn.getAttribute("data-sticky")},posts:"DEFAULT.catalog_html",proto:"vichan.catalog_html"},catalog_json:{get_op_src:"thread_json",proto:"vichan.catalog_json"},page_html:{ths:function(e){var t=this.ths_array(e,e.pn.getElementsByClassName("thread"));if("page"!==site.whereami||!pref.catalog.embed_page)for(var a=0;a<t.length;a++)t[a].pn.removeAttribute("class");return t},pn:"page_json",filename:"thread_html",proto:"vichan.page_html"},page_json:{has_posts:!0,proto:"vichan.page_json"},thread_html:{filename:function(e){var t=[],a=(e.pn.classList.contains("op")?e.pn.parentNode:e.pn).getElementsByClassName("files")[0];if(a)for(var n=a.getElementsByClassName("postfilename"),r=0;r<n.length;r++)t[r]=n[r].textContent;if(t.length>1){e.extra_files=[];for(var r=1;r<t.length;r++)e.extra_files[r-1]={filename:t[r],__proto__:e.__proto__}}return t[0]},get_op_src:"thread_json",proto:"vichan.thread_html"},thread_json:{get_op_src:function(e){return e.op_img_url.replace("thumb","src").replace(".jpg",e.ext)},proto:"vichan.thread_json"}},popups_op_func_set:function(e){return e.querySelector(".files")},popups_op_func_use:function(e,t,a){e.setAttribute("class",e.getAttribute("class")+" reply"),e.insertBefore(t[a].isOP.cloneNode(!0),e.firstChild)},update_posts_remove:function(e,t,a){a.removeChild(e.posts[t].pn.nextSibling),a.removeChild(e.posts[t].pn)},update_posts_insert:function(e,t,a,n,r){var o=1==n?t[0].pn.nextSibling||null:n<t.length?t[n].pn.nextSibling&&t[n].pn.nextSibling.nextSibling||null:null;e[a].pn||(e[a].pn=this.post_json2html(e[a],e[a].board)),r.insertBefore(e[a].pn,o),r.insertBefore(document.createElement("br"),o)},catalog_json2html3_thumbnail:function(e,t){return".jpg"===e.ext||".png"===e.ext||".jpeg"===e.ext||".gif"===e.ext||".webm"===e.ext||".mp4"===e.ext?site2["8chan"].protocol+"//"+site2["8chan"].domain_url+t+"thumb/"+e.tim+".jpg":e.embed?"https:"+e.embed.replace(/.*src="/,"").replace(/".*/,""):""},short_link:function(){return""},proto:"vichan"},site2["8chan_live"]={parse_funcs:{thread_html:{posts:function(e){return this.posts_array(e,e.pn.querySelectorAll(":scope>.post.reply"))},proto:"8chan.thread_html"}},proto:"8chan"},site2.vichan={components:{boardlist:".boardlist",postform_comment:['textarea[name="body"]',0],postform_comment2:['textarea[name="body"]',1],postform_submit:['input[name="post"]',0],postform_submit2:['input[name="post"]',1]},general_event_handler:function(){var e={thread:{get_mark:function(e,t){for(;e&&e!==cataLog.parent;)if("BR"!==e.tagName&&e.classList){if(e.classList.contains("post"))return e;if(e.classList.contains("postcontainer"))return e.getElementsByClassName("post")[0];if(e.parentNode&&e.parentNode.id&&e.parentNode.id.search(/^thread/)!=-1){if(e=e.previousSibling)continue;break}if(e.id&&e.id.search(/^thread/)!=-1)break;e=e.parentNode}else e=e.previousSibling||e.parentNode;return this.get_mark_from_height(t)},get_mark_from_height:function(e){return this.__proto__.get_mark_from_height(e,document.getElementsByClassName("post"))},__proto__:site2.DEFAULT.general_event_handler.common}};return e.page={add_mouseover:pref.test_mode[68],mouseover:function(e){var t=e.target;"A"===t.tagName&&pref[cataLog.embed_mode].popup_truncated&&"toolong"===t.parentNode.className&&site2.DEFAULT.popups_post_entry(e)},__proto__:e.thread},e.catalog={mouseover:function(e){var t=e.target;"IMG"===t.tagName&&pref[cataLog.embed_mode].image_hover&&"A"===t.parentNode.tagName&&cataLog.image_hover_add.call(t,e)},__proto__:e.thread},e}(),boards_sel_from_tags:function(){for(var e=document.getElementsByClassName("board-list-tbody")[0],t="SELECTED_BOARDS,",a=0;a<e.childNodes.length;a++)"none"!==e.childNodes[a].style.display&&(t=t+"8chan"+e.childNodes[a].getElementsByClassName("board-uri")[0].getElementsByTagName("a")[0].getAttribute("href")+",");return t+"\n"},get_next_image:function(e,t){var a=Array.prototype.slice.call(cataLog.parent.getElementsByClassName("post-image")).filter(function(e){return".webm"!==e.src.substr(-5,5)});return site2.DEFAULT.get_next_image(e,t,a)},modify_thread_link:function(e){var t=e.getElementsByClassName("post op");if(0==t.length)return[];var a=[];t=t[0].getElementsByTagName("a");for(var n=t.length-1;n>=0;n--)if("[Reply]"==t[n].innerHTML||"[Last 50 Posts]"==t[n].innerHTML){var r=t[n].getAttribute("href");r&&(a.push([t[n],r]),t[n].removeAttribute("href"))}return a},catalog_threads_in_page:function(e){for(var t={domain:site.nickname,pn:e},a=this.parse_funcs.page_html.ths(t),n=0;n<a.length;n++)a[n]=a[n].pn;return a},remove_posts:function(e,t){site2.common.remove_by_classname(e,"post reply",t,!0)},remove_files_info:function(e){site2.common.remove_by_classname(e,"fileinfo"),site2.common.move_up_and_delete_parent(e.getElementsByClassName("post-image"))},postform_rules:null,thread_keyword:"res",max_page:function(){return 15},make_url4:function(e){var t=this.protocol+"//"+this.domain_url+e[1];return"page_html"===e[3]?[t+(0!=e[2]?parseInt(e[2],10)+1:"index")+".html","html"]:"page_json"===e[3]?[t+parseInt(e[2],10)+".json","json"]:"catalog_json"===e[3]?[t+"catalog.json","json"]:"catalog_html"===e[3]?[t+"catalog.html","html"]:"thread_html"===e[3]?[t+"res/"+e[2]+".html","html"]:"thread_json"===e[3]?[t+"res/"+e[2]+".json","json"]:void 0},url_boards_json:function(){return[site2["8chan"].protocol+"//"+site2["8chan"].domain_url+"/boards.json","json"]},get_ops:function(e){for(var t=e.getElementsByClassName("post op"),a=[],n=0;n<t.length;n++)a.push(parseInt(t[n].id.substring(3),10));return a},get_posts:function(e){for(var t=[],a=e.getElementsByClassName("post_no"),n=0;n<a.length;n++)a[n].id&&t.push(parseInt(a[n].id.substr(8),10));return t},get_post_offsetTop:function(e,t){return e.getElementsByClassName("post")[t].offsetTop},get_icon:function(e,t,a,n){return"catalog"===t?this.add_icon(e,t,a,n):"sticky"===a?e.getElementsByClassName("fa-thumb-tack")[0]:null},add_icon:function(e,t,a,n){if(e){var r=n["icon_"+a];if(!r){var o=0;n.icon_sticky&&o++,n.icon_show_always&&o++;var s=document.createElement("i");s.setAttribute("class","sticky"===a?"fa fa-thumb-tack":"fa"),"show_always"===a&&(s.textContent="★");var i;if("catalog"===t)s.setAttribute("style","position:absolute;left:"+16*o+"px"),i=e.getElementsByClassName("thread")[0],i.insertBefore(s,i.firstChild);else{var l=e.getElementsByClassName("op")[0];i=l.getElementsByClassName("mentioned")[0]||l.getElementsByClassName("post_no")[1].nextSibling,i.parentNode.insertBefore(s,i)}return s}r.parentNode.removeChild(r)}return null},favicon:{get_favicon:function(){for(var e=document.getElementsByTagName("head")[0].getElementsByTagName("link"),t=0;t<e.length;t++)if("shortcut icon"==e[t].getAttribute("rel"))return e[t];var a=document.createElement("link");return a.setAttribute("rel","shortcut icon"),a.setAttribute("href",this.none),a.setAttribute("type","image/x-icon"),document.getElementsByTagName("head")[0].appendChild(a)},get_title:function(){var e=document.getElementsByTagName("head")[0].getElementsByTagName("title")[0];return e||(e=document.createElement("title"),e=document.getElementsByTagName("head")[0].appendChild(e)),e},none:"/favicon.ico",reply:"png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAQElEQVR42mNgGEbg/5n/GJgYORQFDQ0IjK4BmxxWzehsQnJYBdFtxCWH1QBcrkKWw2sAWS6gKAwojgWqpIORDQBVkjfW5KYpFQAAAABJRU5ErkJggg==",reply_to_me:"png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAWUlEQVR42mNgAIH/Z/4zNDRgYpA4UQBqADIYZAaAaHRMtAEwjB42cEPQFaCzCclhFcQWK9jk0A1A8QJW2xgYiDeAJBdQFAbYAhLdRryxgByVuOKaYDoY2QAAcHCIXLRHYMUAAAAASUVORK5CYII="},time_revised_check:function(e){return e>300},format_thread_layout:function(e){site2.common.add_attribute_by_tagname(e,"img","style","margin:0px"),site2.common.add_attribute_by_tagname(e,"iframe","style","margin:0px"),site2.common.add_attribute_by_classname(e,"post","style","padding:0px"),site2.common.add_attribute_by_classname(e,"intro","style","margin:0px"),site2.common.add_attribute_by_classname(e,"body","style","margin:12px 5px")},format_thread_contents:function(e){site2.common.remove_by_classname(e,"delete"),site2.common.remove_by_classname(e,"omitted")},localtime:function(e){for(var t=e.getElementsByTagName("time"),a=0;a<t.length;a++)t[a].textContent=site2.common.change_utc_to_local(t[a].getAttribute("datetime"))},format_remove_tn_area_size:function(e){for(var t=e.getElementsByClassName("file"),a=0;a<t.length;a++){var n=t[a].getAttribute("style");n&&(n=(n?n+";":"")+"float:left;",n.indexOf("width")!=-1&&(n=n.replace(/width:[^;]*(;|$)/,"")),n.indexOf("height")!=-1&&(n=n.replace(/height:[^;]*(;|$)/,"")),t[a].setAttribute("style",n))}},mark_newer_posts:function(e,t,a,n){return site2.DEFAULT.mark_newer_posts("8chan",e.getElementsByClassName("post"),t,null,a,n)},get_owners_recommendation:function(){if(document.getElementsByClassName("blotter")[0]){or_str=document.getElementsByClassName("blotter")[0][brwsr.innerText];var e="Recommendation: ",t=or_str.indexOf(e);if(t!=-1)return or_str.substr(t+e.length)}return""},get_json_url_catalog:function(e){return site2["8chan"].protocol+"//"+site2["8chan"].domain_url+e+"catalog.json"},thread2search_obj:function(e){function t(e){if(0!=e.length){for(var t=e[0].parentNode;t.classList.contains("post");)t=t.parentNode;for(var a=t.classList.contains("op")?-1:0,n=a>=0?e[0][brwsr.innerText]:"",r="",o=a+1;o<e.length;o++)r=r+e[o][brwsr.innerText]+"\n";return[n,r]}return["",""]}var a=t(e.getElementsByClassName("body")),n=t(e.getElementsByClassName("subject")),r=t(e.getElementsByClassName("name")),o=e.getElementsByClassName("files"),s=["",""];if(0!=o.length){for(var i=0;i<o.length;i++){var l=o[i].getElementsByClassName("unimportant");s[i]="";for(var c=0;c<l.length;c++)0!=l[c].getElementsByTagName("a").length&&(s[i]=s[i]+l[c].getElementsByTagName("a")[0][brwsr.innerText]+"\n"),0!=l[c].getElementsByTagName("span").length&&(s[i]=s[i]+l[c].getElementsByTagName("span")[0][brwsr.innerText]+"\n")}for(var i=2;i<s.length;i++)s[1]=s[1]+s[i]+"\n";o[0].parentNode!=e&&(s[1]=s[0]+"\n"+s[1],s[0]="")}return[a[0],n[0],r[0],s[0],a[1],n[1],r[1],s[1]]},parse_json_thread:function(e,t){for(var a={posts:[]},n={},r=0,o=document.getElementsByClassName("post"),s=0;s<o.length;s++){a.posts[s]={},a.posts[s].no=o[s].id.replace(/op_/,"").replace(/reply_/,"");var i=o[s].getElementsByClassName("poster_id")[0].textContent;a.posts[s].id=i,void 0===n[i]&&(r++,n[i]=1),a.posts[s].unique_ips=r}return a},uip_check:function(e){e(0,200,"")},uip_tgt_post:function(e){var t=document.getElementById("reply_"+e);return t?t:document.getElementById("op_"+e)},uip_post_num:function(e){return e.getElementsByClassName("intro")},catalog_native_prep:function(e,t,a,n,r){var o="catalog"===site.whereami?document.getElementsByClassName("threads")[0]:document.getElementsByName("postcontrols")[0];if(site4.tb_prep_for_embed(a),"catalog"===site.whereami){var s=document.getElementById("sort_by");if(0!=s.selectedIndex){s.selectedIndex=0;var i=document.createEvent("UIEvents");i.initUIEvent("change",!1,!0,window,1),s.dispatchEvent(i)}s.style.display="none",document.getElementById("image_size").addEventListener("change",site2["8chan"].catalog_native_size_changed,!1);for(var l=document.createElement("span");a.firstChild;)l.appendChild(a.firstChild);a=l,a.appendChild(a.removeChild(a.childNodes[3]).firstChild)}else if("page"===site.whereami){var c=document.getElementsByName("postcontrols")[0];if(!pref.catalog_expand_with_hr||r)for(var p=c.childNodes.length-1;p>=0;p--)"HR"===c.childNodes[p].tagName&&c.removeChild(c.childNodes[p]);else for(var p=c.childNodes.length-1;p>=0;p--)"HR"===c.childNodes[p].tagName&&c.childNodes[p].setAttribute("class",pref.script_prefix+"_hs");c.parentNode.insertBefore(document.createElement("hr"),c.nextSibling)}o.parentNode.insertBefore(a,o),o.parentNode.insertBefore(t,o);var _=t.getElementsByTagName("select")["catalog.indexing"];"catalog"===site.whereami?s.parentNode.insertBefore(_,s):a.childNodes[3].insertBefore(_,a.childNodes[3].firstChild)},catalog_native_size:document.getElementById("image_size")?document.getElementById("image_size").value:"small",catalog_native_size_changed:function(){site2["8chan"].catalog_native_size=this.value},catalog_get_native_area:function(){return"catalog"===site.whereami?document.getElementById("Grid"):document.getElementsByName("postcontrols")[0]},parse_funcs:{catalog_html:{ths:function(e){return this.ths_array(e,e.pn.getElementsByClassName("mix"))},no:function(e){return parseInt(e.pn.getElementsByTagName("img")[0].id.substr(4),10)},time_bumped:function(e){return 1e3*parseInt(e.pn.getAttribute("data-bump"),10)},time_created:function(e){return 1e3*parseInt(e.pn.getAttribute("data-time"),10)},nof_posts:function(e){return parseInt(e.pn.getAttribute("data-reply"),10)+1},nof_files:function(e){return parseInt(e.pn.getElementsByTagName("strong")[0].textContent.replace(/.*I: */,""),10)+1},key:function(e){return pref.test_mode[0]&&(e.hasOwnProperty("no")||Object.defineProperty(e,"no",{value:this.no(e),enumerable:!0,configurable:!0,writable:!0})),e.domain+e.board+e.no},sub:"DEFAULT.post_html",name:function(e){return e.pn.getElementsByTagName("img")[0].getAttribute("data-name")},com:function(e){return e.pn.getElementsByClassName("replies")[0].innerHTML.replace(/\s*<strong>[^<]*<\/strong>\s*(<br>)*/,"").replace(/\s*$/,"")},type_com:"html",footer:function(e){return e.pn.getElementsByTagName("strong")[0]},sticky:function(e){return null},op_img_url:function(e){var t=e.pn.getElementsByTagName("img")[0];return t?t.getAttribute("src"):void 0},dynamic_image_hover:!0,missing_info:2,img2src:function(e){var t=this.get_lth_from_node(e);if(!t)return null;var a=e.src;return t.th&&t.th.ext?a=a.replace(/thumb/,"src").replace(/.[^\.]*$/,t.th.ext):t.th.parse_funcs.missing_info&&scan.scan_ui("image_hover",{tgts:[t.domain+t.board+"j0"],options:{callback:function(){cataLog.image_hover_reentry(e)},priority:6}}),a},get_op_src:"thread_json"},catalog_json:{before_test:["ths",":ITER",":ALL","ths",["key","time_bumped","nof_posts","nof_files"]],after_test:["time_created","pn","footer"],full_hier:["ths",":ITER",":ALL","ths",["key","time_bumped","nof_posts","nof_files","pn","footer"]],ths:"DEFAULT.catalog_json",time_bumped:function(e){return 1e3*e.last_modified},time_created:function(e){return 1e3*e.time},nof_posts:function(e){return e.replies+1},nof_files:function(e){return e.images+e.omitted_images},key:function(e){return e.domain+e.board+e.no},sub:function(e){return e.hasOwnProperty("sub")?e.sub:""},name:function(e){return e.hasOwnProperty("name")?e.name:""},com:function(e){return e.hasOwnProperty("com")?e.com:""},op_img_url:"DEFAULT.common",missing_info:1,get_op_src:"thread_json",time_unit:1e3,type_com:"html",posts:"DEFAULT.catalog_json",posts_full:"DEFAULT.catalog_json",get_max_page:function(e){return e.length},proto:"catalog_html"},page_json:{has_posts:!0,nof_posts:"DEFAULT.thread_json",nof_files:function(e){return e.posts[0].images+e.posts[0].omitted_images},ths:"DEFAULT.page_json",proto:"thread_json"},page_html:{before_test:["ths",":ITER",":ALL","ths",["key","time_bumped","nof_posts","nof_files"]],after_test:["time_created",":ITER",":ALL","posts",["sub","name","com","flag"],":ITER",":GALL","posts",["flags","flag"]],before_test_post:["posts",":ITER",":FL","posts",["time"],"html_org","footer"],ths:function(e){return this.ths_array(e,e.pn.querySelectorAll("div[id^=thread_]"))},th_init:function(e){"page"===site.whereami&&pref.catalog.embed_page||e.pn.removeAttribute("class")},no:function(e){return parseInt(e.pn.id.substring(e.pn.id.indexOf("_")+1),10)},time:function(e){var t=e.pn.getElementsByTagName("time")[0];return t?Date.parse(t.getAttribute("datetime"))/1e3:void 0},time_unit:1e3,time_bumped:function(e){for(var t=e.posts.length;--t>=0;){var a=e.posts[t].pn.getElementsByClassName("email")[0];if(!a||"mailto:sage"!==a.href)return e.posts[t].time}},time_created:function(e){return pref.test_mode[0]&&(e.hasOwnProperty("posts")||this.entry(e,this.before_test_post)),e.posts[0].time},nof_posts:function(e){var t=e.pn.getElementsByClassName("post").length,a=e.pn.getElementsByClassName("fileinfo").length,n=e.pn.getElementsByClassName("omitted")[0];if(n){var r=n.childNodes[0].textContent.replace(/\n/g,"");t+=parseInt(r.replace(/\ post.*/,""),10)||0,a+=parseInt("0"+r.replace(/\ image.*/,"").replace(/[^\ ]*\ /g,""),10)||0}return Object.defineProperty(e,"nof_files",{value:a,enumerable:!0,configurable:!0,writable:!0}),t},nof_files:function(e){return e.hasOwnProperty("nof_posts")||this.nof_posts(e),e.nof_files},key:function(e){return pref.test_mode[0]&&(e.hasOwnProperty("no")||Object.defineProperty(e,"no",{value:this.no(e),enumerable:!0,configurable:!0,writable:!0})),e.domain+e.board+e.no},sub:"DEFAULT.post_html",name:function(e){var t=e.pn.getElementsByClassName("name")[0];return t?t[brwsr.innerText]:""},pn_name:"post_html",com:function(e){var t=e.pn.getElementsByClassName("body")[0];return t?t.innerHTML:""},type_com:"html",footer:function(e){return this.insert_footer4(e.pn.getElementsByClassName("post op")[0])},sticky:function(e){return 0!=e.pn.getElementsByClassName("fa-thumb-tack").length},flag:function(e){var t=e.pn.getElementsByClassName("flag");return 0!=t.length?document.importNode(t[0],!1):null},op_img_url:function(e){var t=e.pn.getElementsByTagName("img");if(t.length>=2){e.op_img_url2=[];for(var a=1;a<t.length;a++){var n=t[a].getAttribute("src");n&&(e.op_img_url2[e.op_img_url2.length]=n)}}return t&&t[0]?t[0].getAttribute("src"):void 0},tn_as:function(e){return e.tn_imgs},tn_imgs:function(e){var t=[],a=(e.pn.classList.contains("op")?e.pn.parentNode:e.pn).getElementsByClassName("files")[0];if(a){a=a.getElementsByClassName("file");for(var n=0;n<a.length;n++){var r=a[n].getElementsByTagName("img")[0]||a[n].getElementsByTagName("video")[0];r&&(t[t.length]=r)}}return t},get_thread_links:function(e){for(var t=[],a=e.pn.getElementsByClassName("post op")[0].getElementsByTagName("a"),n=0;n<a.length;n++)"[Reply]"===a[n].textContent&&t.unshift(a[n]),"[Last 50 Posts]"===a[n].textContent&&t.push(a[n]),a[n].classList.contains(pref.script_prefix+"_link")&&t.push(a[n]);return t},get_omitted_info:function(e){return e.pn.getElementsByClassName("omitted")[0]},set_omitted_info:function(e,t){e.pn.lastChild.appendChild(t)},replace_omitted_info2:function(e,t){e.childNodes[0].textContent=t?t.childNodes[0].textContent:""},filename:"thread_html",get_op_src:"thread_json"},thread_html:{after_test:["time_created",":ITER",":FLx","posts",["sub","name","com","flag"],":ITER",":GFLx","posts",["flags","flag"]],get_op_src:"thread_json",filename:function(e){var t=(e.pn.classList.contains("op")?e.pn.parentNode:e.pn).getElementsByClassName("files")[0];if(t){t=t.querySelectorAll(":scope>.file");for(var a=0;a<t.length;a++){var n=t[a].getElementsByTagName("a")[0];if(n){n=n.textContent,1===a&&(e.extra_files=[]),a>=1&&(e.extra_files[a-1]={domain:e.domain,board:e.board});var r=0===a?e:e.extra_files[a-1];r.filename="lain"===e.domain?t[a].getElementsByTagName("a")[1].getAttribute("download"):t[a].getElementsByClassName("postfilename")[0].textContent.replace(/\..*/,""),r.ext=n.substr(n.indexOf(".")),r.tim=n.substr(0,n.indexOf("."));var o="lainjp"!==e.domain?t[a].getElementsByClassName("details")[0].textContent.split(","):t[a].getElementsByClassName("unimportant")[0].textContent.split(",");r.w=parseInt(o[1].substr(0,o[1].indexOf("x")),10),r.h=parseInt(o[1].substr(o[1].indexOf("x")+1),10);var s=o[0].split(/\s/);s[1]="KB"===s[1]?1024:"MB"===s[1]?1048576:1,r.fsize=parseFloat(s[0].replace(/\(/,""))*s[1];var i=t[a].querySelector("img.post-image");i&&(r.tn_w=parseInt(i.style.width,10),r.tn_h=parseInt(i.style.height,10))}}}return t?e.filename:void 0},proto:"page_html"},thread_json:{nof_posts:function(e){return e.posts.length},nof_files:function(e){for(var t=0,a=1;a<e.posts.length;a++)e.posts[a].filename&&t++,e.posts[a].extra_files&&(t+=e.posts[a].extra_files.length);return t},add_op_img_url:site2.DEFAULT.parse_parts.add_op_img_url,get_op_src:function(e,t){return!e.ext&&e.parse_funcs.missing_info&&scan.scan_ui("image_hover",{tgts:[e.domain+e.board+"j0"],options:{callback:function(){cataLog.image_hover_reentry(t)},priority:6}}),e.ext?e.op_img_url.replace("thumb","src").replace(".png",e.ext):t.src},pn_name:"post_html",proto:"DEFAULT.thread_json"},post_html:{pn_name:function(e){return e.pn.getElementsByClassName("name")[0]},time_pn:function(e){return Date.parse(e.getElementsByTagName("time")[0].getAttribute("datetime"))},txt2com_spoiler_replace_txt:'<span class="spoiler">$1</span>',proto:"DEFAULT.post_html"},post_json:{proto:"DEFAULT.post_json"}},update_posts_remove:function(e,t,a,n){var r=e.posts[t].pn;n&&r.parentNode===a?this.update_posts_insert_pack(r):r=r.parentNode,a.removeChild(r.nextSibling),a.removeChild(r)},update_posts_insert:function(e,t,a,n,r){var o=n<t.length?t[n].pn:null,s=o&&o.parentNode;s&&s!==r&&(o=s),n>=t.length&&(o=r.getElementsByClassName("clear")[0]),e[a].pn||(e[a].pn=this.post_json2html(e[a],e[a].board)),(0===a||e[a].isOP)&&this.update_posts_insert_pack(e[a].pn),0===n&&t[0]&&this.update_posts_insert_pack(t[0].pn);var i=0!==n||0!==a&&!e[a].isOP?this.post_container(e[a].pn,e[a].no):e[a].pn;r.insertBefore(i,o),r.insertBefore(document.createElement("br"),o),0!==a&&!e[a].isOP||0!==n||this.update_posts_insert_unpack(e[a].pn)},update_posts0_class:function(e,t){site2.DEFAULT.update_posts0_class(e,t),this.update_posts_insert_pack_iter(e,t?function(e){e.classList.remove("CatChan_search_miss")}:function(e){e.classList.add("CatChan_search_miss")})},update_posts_insert_pack:function(e){this.update_posts_insert_pack_iter(e,function(t){e.insertBefore(t,e.firstChild)})},update_posts_insert_pack_iter:function(e,t){for(var a=e.previousSibling;a;){var n=a.previousSibling;if(a.classList&&(a.classList.contains(pref.script_prefix+"_footer")||a.classList.contains("files"))&&t(a),a.classList&&a.classList.contains("op"))break;a=n}},update_posts_insert_unpack:function(e){for(;;){var t=e.firstChild;if(!t||!t.classList||!t.classList.contains(pref.script_prefix+"_footer")&&!t.classList.contains("files"))break;e.parentNode.insertBefore(t,e)}},add_backlinks:function(e,t,a,n){var r=e.getElementsByClassName("mentioned")[0];if(!r){var r=document.createElement("span");r.setAttribute("class","mentioned unimportant");var o=e.getElementsByClassName("post_no")[1],s=o.parentNode;do{o=o.nextSibling}while(o&&"I"===o.tagName);s.insertBefore(r,o)}a||(r.innerHTML="");for(var i=a||0;i<t.length;i++){var l=t[i].split(/[\/#]/);l[1]="/"+l[1]+"/";var c=l[0],p=l[1],_=l[3],d=site2[c].link_dbtp2href(l);c!==site.nickname&&(d=site2[c].absolute_link_1(d));var u=null;if(void 0!==a)for(var f=0;f<r.childNodes.length;f++)if(r.childNodes[f].textContent===">>"+_){u=r.childNodes[f];break}if(u||(u=document.createElement("a"),u.setAttribute("class","mentioned"),u.setAttribute("href",d),u.textContent=n&&c!==n.domain?">>>>"+c+p+_:n&&p!==n.board?">>>"+p+_:">>"+_,
u.onclick=this.backlink_onclick,r.appendChild(u),u.onmouseover=this.popups_post_entry),a)break}},link_dbtp2href:function(e){return e[1]+"res/"+e[2]+".html#"+e[3]},backlink_onclick:function(){highlightReply.call(this,parseInt(this.textContent.substr(2),10))},backlink_class:"mentioned",colorID:function(e){var t=e.getElementsByClassName("poster_id")[0];if(t){var a=t.textContent,n=parseInt(a.substr(0,2),16),r=parseInt(a.substr(2,2),16),o=parseInt(a.substr(4,2),16),s=n+r+o>384?0:255;t.setAttribute("style","padding: 0px 5px; border-radius: 8px; color: rgb("+s+","+s+","+s+"); background-color: rgb("+n+","+r+","+o+");")}},post_container:function(e,t){var a=document.createElement("div");return a.setAttribute("id","pc"+t),a.setAttribute("class","postcontainer"),a.innerHTML='<div class="sidearrows">&gt;&gt;</div>',a.appendChild(e),a},short_link:function(e,t,a,n,r){var o=common_func.fullname2dbt(e);return t>100?'<a href="'+o[1]+"res/"+o[2]+'+50.html" class="'+pref.script_prefix+'_link">'+n+"50"+r+"</a>":""},post_json2html:function(e,t,a,n){var r=document.createElement("div"),o=e.parse_funcs&&e.parse_funcs.time_unit||1,s=new Date((e.time||0)*o),i='<div class="post '+(a?"op":"reply")+'" id="reply_'+e.no+'" style="border: none"><p class="intro"><input type="checkbox" class="delete" name="delete_'+e.no+'" id="delete_'+e.no+'"><label for="delete_'+e.no+'">'+(e.sub?'<span class="subject">'+e.sub+" </span>":"")+(e.email?'<a class="email" href="mailto:'+e.email+'">':"")+'<span class="name">'+(e.name||"")+"</span>"+(e.trip?'<span class="trip">'+e.trip+"</span>":"")+(e.capcode?'<span class="capcode" style="color:orange;font-weight:bold">## '+e.capcode+"</span>":"")+(e.email?"</a> ":" ")+(e.country?'<img class="flag flag-'+e.country.toLowerCase()+'" src="/static/blank.gif" style="width:16px;height:11px;" alt="'+e.country_name+'" title="'+e.country_name+'"> ':" ")+'<time datetime="'+s.toISOString()+'">'+s.toLocaleString()+"</time></label>"+(e.id?'<span class="poster_id">'+e.id+"</span>":"")+'&nbsp;<a class="post_no" id="post_no_'+e.no+'">No.</a><a class="post_no">'+e.no+"</a>"+(a?'<a href="'+site2[e.domain].make_url4([e.domain,t,e.no,"thread_html"])[0]+'">[Reply]</a>'+(n?n:""):"")+"</p>";if(e.filename){if(i+='<div class="files">'+this.post_json2html_file(e,t,e.extra_files),e.extra_files)for(var l=0;l<e.extra_files.length;l++)i+=this.post_json2html_file(e.extra_files[l],t,!0);i+="</div>"}return i+='<div class="body">'+(e.com?e.com:"")+"</div></div>",r.innerHTML=i,r.childNodes[0]},post_json2html_file:function(e,t,a){var n=(.005+(e.fsize>1048576?e.fsize/1048576:e.fsize/1024)).toString();n=n.substr(0,n.indexOf(".")+3)+(e.fsize>1048576?" MB":" KB");var r=site2[e.domain].post_json2html_fname_server(e),o=site2[e.domain].post_json2html_fname(e),s=site2[e.domain].catalog_json2html3_src(e,t),i=site2[e.domain].catalog_json2html3_thumbnail(e,t);return'<div class="file'+(a?" multifile":"")+'"'+(a?' style="width:'+(e.tn_w+40)+'px"':"")+'><p class="fileinfo">File: <a href="'+s+'">'+r+'</a> <span class="details">('+n+", "+e.w+"x"+e.h+', <span class="postfilename">'+o+'</span>) </span></p><a href="'+s+'" target="_blank">'+(".webm"!==e.ext?'<img class="post-image" src="'+i+'" style="width: '+e.tn_w+"px; height: "+e.tn_h+'px; max-width: 98%;" alt=""'+(128===e.tn_w&&128===e.tn_h?"onerror=\"this.onerror=null;this.src='/static/spoiler.png';\"":"")+">":'<video class="post-image" src="'+s+'" style="width: '+e.tn_w+"px; height: "+e.tn_h+'px; max-width: 98%;">')+"</a></div>"},page_json2html3_skelton:function(e,t){var a=document.createElement("div");a.setAttribute("id","thread_"+e.no),a.setAttribute("data-board",e.board.slice(1,-1));var n=document.createElement("br");return n.setAttribute("class","clear"),a.appendChild(n),a.appendChild(document.createElement("hr")),t?[a,n]:a},page_json2html3:function(e,t,a,n){var r=this.page_json2html3_skelton(e,!0),o=r[0],s=r[1],i=this.post_json2html(e.posts&&e.posts[0]?e.posts[0]:e,t,!0,site2[e.domain].short_link(e.key,e.nof_posts,2,"[Last "," Posts]")),l=i.getElementsByClassName("files")[0];if(l&&o.insertBefore(l,s),i.setAttribute("class","post op"),e.posts&&e.posts[0]&&e.posts[0].extra_files&&i.setAttribute("style","clear:both;"),o.insertBefore(i,s),!n&&e.posts[0].pn||(e.posts[0].pn=i),e.posts){for(var c=1;c<e.posts.length;c++){var p=this.post_json2html(e.posts[c],t);o.insertBefore(this.post_container(p,e.posts[c].no),s),o.insertBefore(document.createElement("br"),s),!n&&e.posts[c].pn||(e.posts[c].pn=p)}this.page_json2html3_add_omitted_info(e,e.posts,e.posts)}return o},page_json2html3_replace_expander:function(e,t,a){var n=e[0].pn.getElementsByClassName("omitted")[0];n&&(n.childNodes.length>=3&&n.removeChild(n.childNodes[2]),n.childNodes.length>=2&&n.removeChild(n.childNodes[1]),n.appendChild(cnst.config_expander(a,t)))},page_json2html3_add_omitted_info:function(e,t,a){for(var n=0,r=1;r<a.length;r++)n+="html"===a[r].type_data?a[r].pn.getElementsByClassName("file").length:a[r].filename?a[r].extra_files?a[r].extra_files.length+1:1:0;var o=e.nof_files-n,s=e.nof_posts-a.length,i=t?t[0].pn.getElementsByClassName("omitted")[0]:null;return 0!=s?(i||(i=document.createElement("span"),i.setAttribute("class","omitted"),i.innerHTML="dummy",i.appendChild(cnst.config_expander(e.key)),t&&t[0].pn.appendChild(i)),i.childNodes[0].textContent=s+" post"+(1!==s?"s":"")+(o?" and "+o+" image repl"+(1===o?"y":"ies"):"")+" omitted. "):i&&t&&t[0].pn.removeChild(i),i},catalog_json2html3_thumbnail:function(e,t){return".jpg"===e.ext||".jpeg"===e.ext||".gif"===e.ext||".png"===e.ext?"https://"+this.domain_url+t+"thumb/"+e.tim+e.ext:""},catalog_json2html3_src:function(e,t){return".jpg"===e.ext||".jpeg"===e.ext||".gif"===e.ext||".png"===e.ext||".webm"===e.ext?"https://"+this.domain_url+t+"src/"+e.tim+e.ext:""},catalog_json2html3:function(e,t,a){var n=document.createElement("div");return n.setAttribute("class","mix"),n.setAttribute("style","display: inline-block;"),n.innerHTML='<div class="thread grid-li grid-size-'+site2[site.nickname].catalog_native_size+'"><a href="'+site2[e.domain].make_url4([e.domain,e.board,e.no,"thread_html"])[0]+'"><img src="'+a+'" id="img-'+e.no+'" data-subject="'+e.sub+'" data-name="'+e.name+'" data-muhdifference="" data-last-reply="" data-last-subject="" data-last-name="" data-last-difference=""class="'+t+' thread-image" title="'+new Date(1e3*e.last_modified).toLocaleString()+" "+e.ext+'"></a><div class="replies"><strong>R: '+(e.nof_posts-1)+" / I: "+e.nof_files+"</strong>"+(e.sub?'<p class="intro"><span class="subject">'+e.sub+"</span></p>":"<br>")+e.com+"</div></div>",n},catalog_from_json3:function(e,t){var a;return pref.test_mode[0]?(a={domain:"8chan",board:site.board,obj:e},this.parse_funcs.catalog_json.entry(a,this.parse_funcs.catalog_json.full_hier),a.ths):site2[this.nickname].wrap_to_parse.get(e,this.nickname,t,"catalog_json")},patch:{expand_thumbnail_inline_load:function(){var e=this.parentNode&&this.parentNode.parentNode;e&&e.classList&&e.classList.contains("multifile")&&e.style.width&&(this.setAttribute("data-originalWidth",e.style.width),e.style="")}},proto:"DEFAULT"},site2.KC={nickname:"KC",domain_url:"krautchan.net",components:{boardlist:".menu",postform_comment:"#postform_comment",postform_submit:"#postform_submit"},postform:{init:function(){return this.tack=document.createElement("img"),this.tack.setAttribute("src","/images/sticky.gif"),this.tack.setAttribute("style","float:right;font-size:2em;"),site.postform.parentNode.insertBefore(this.tack,site.postform),this.tack},__proto__:site2.DEFAULT.postform},pref_default:{thread_reader:{own_posts_tracker:!0,check_num_of_children:!1},proto:{env:{popup_native:!1,expand_thumbnail_inline_native:!1,image_hover_native:!1,colorID_native:!1,backlink_native:!1,localtime_native:!1,auto_update_native:!1}},page:{use_expander_always:!0}},boards_json:site2.DEFAULT.generate_boards_json([["b",15],["int",20],"vip","a","c","co","d","e","f","fb","fe","fit","jp","k","l","li",["m",5],"n","ng","p","ph","prog","sp","t",["trv",18],"tu","tv","v","w","we","wk","wp","z","zp","ft","r",["h",8],"s","bans","kc","rfk",["rvss",15]],10),check_func:function(){site2.KC.force_https||(site2.KC.protocol=site.protocol);var e=window.location.href;return e.search(/krautchan.net/)!=-1&&(site.whereami=document.getElementsByTagName("head")[0].innerHTML.indexOf("404 Not Found")!=-1?"404":e.search(/krautchan\.net\/?$/)!=-1?"frame":e.search(/catalog/)!=-1?"catalog":e.search(/thread/)!=-1?"thread":e.search(/\/$|(index|[0-9]+)\.html|\/#all$/)!=-1?"page":"other","page"!==site.whereami&&"thread"!==site.whereami||(this.components.boardlist="body > div:nth-child(3)",delete this.show_boardlist_physical_extract_func),site.config("krautchan.net","KC"),site.max_page=void 0==site2.KC.max_page_kc[site.board]?10:site2.KC.max_page_kc[site.board],"catalog"===site.whereami&&("/"===e[e.length-1]&&(e=e.substr(0,e.length-1)),site.board=e.substr(e.lastIndexOf("/"))+"/"),"frame"===site.whereami&&(site.root_body2=document.createElement("div"),site.embed_frame="main",site.embed_frame_win=main,navigation.onload=function(){site.root_body=navigation.document.body,site.root_body.appendChild(site.root_body2)}),"thread"!==site.whereami&&"page"!==site.whereami||(site.embed_to.top=document.querySelector('form[action="/delete"]'),site.embed_to.bottom=document.querySelector('form[action="/delete"]').nextSibling),site.postform=document.getElementById("postform"),site.postform_rules=document.getElementById("rules_row"),!0)},force_https:!1,protocol:"https:",home:site.protocol+"//krautchan.net/regeln.html",show_boardlist_physical_extract_func:function(e){return e.substr(1,e.length-2)},catalog_frame_prep:function(e){var t=[navigation.document.body,main.document.body];site2.common.absorb_children(t[0]).style.display="none",site2.common.absorb_children(t[1]).style.display="none",t[0].insertBefore(e,t[0].firstChild),t[0].insertBefore(e,t[0].firstChild),site.root_body.appendChild(site.root_body2),this.catalog_embed_prep(e)},catalog_threads_in_page:function(e){return e.getElementsByClassName("thread_body")},max_page_kc:{"/int/":20,"/b/":15,"/trv/":13,"/m/":5},max_page:function(e){return site2.KC.max_page_kc[e]},make_url4:function(e){var t=this.protocol+"//"+this.domain_url;return e[3]=e[3].replace(/_json/,"_html"),"page_html"===e[3]?[t+e[1]+(0==e[2]?"":e[2]+".html"),"html"]:"catalog_html"===e[3]?[t+"/catalog"+e[1].substr(0,e[1].length-1),"html"]:"thread_html"===e[3]?[t+e[1]+"thread-"+e[2]+".html","html"]:void 0},trim_list:"no",get_next_image:function(e,t){var a=Array.prototype.slice.call(document.querySelectorAll("img[id^=thumbnail]")).filter(function(e){return".webm"!==e.src.substr(-5,5)});return site2.DEFAULT.get_next_image(e,t,a)},get_ops:function(e){for(var t=[],a=e.getElementsByTagName("div"),n=0;n<a.length;n++)"thread"!=a[n].className&&"thread kc_showReplies"!=a[n].className||t.push(a[n].id.substring(7));return t},get_posts:function(e){for(var t=[],a=e.getElementsByTagName("a"),n=0;n<a.length;n++)""!=a[n].name&&t.push(a[n].name);return t},modify_thread_link:function(e){for(var t=[],a=e.getElementsByClassName("postheader")[0].getElementsByTagName("a"),n=0;n<a.length;n++)if("Reply"==a[n][brwsr.innerText]||"Antworten"==a[n][brwsr.innerText]){var r=a[n].getAttribute("href");t.push([a[n],r]),a[n].removeAttribute("href")}return t},time_offset:1,mark_newer_posts:function(e,t,a,n){var r=site2.DEFAULT.mark_newer_posts("KC",e.getElementsByTagName("table"),t,function(e){return e.getElementsByClassName("postreply")[0]},a,n);return null!=r?r.offsetParent:null},localtime:function(e){var t=e.getElementsByClassName("postdate")[0];if(t){var a=t.cloneNode(!1);a.setAttribute("class","CatChan_localtime"),a.textContent=site2.common.change_utc_to_local(site2.KC.parse_funcs.post_html.time_pn_1(t)),t.parentNode.insertBefore(a,t.nextSibling),t.setAttribute("style","display:none")}},remove_files_info:function(e){site2.common.remove_by_classname(e,"filename"),site2.common.remove_by_classname(e,"fileinfo");for(var t=e.getElementsByTagName("img"),a=0;a<t.length;a++)t[a].id&&t[a].id.search("thumbnail")!=-1&&(t[a].removeAttribute("onmouseover"),t[a].removeAttribute("onmouseout"),t[a].removeAttribute("onload"),site2.common.move_up_and_delete_parent([t[a]]));for(var n=e.getElementsByClassName("file_thread"),a=0;a<n.length;a++)site2.common.remove_brs(n[a]);for(var a=0;a<n.length;a++)site2.common.remove_by_attribute([n[a]],"id","filename")},remove_posts:function(e,t){for(var a=e.getElementsByTagName("table"),n=a.length-1-t;n>=0;n--)a[n].previousSibling.previousSibling&&a[n].parentNode.removeChild(a[n].previousSibling.previousSibling),a[n].parentNode.removeChild(a[n].previousSibling),a[n].parentNode.removeChild(a[n])},format_thread_layout:function(e){site2.common.add_attribute_by_classname(e,"file_thread","style","float:left;margin:5px"),site2.common.add_attribute_by_classname(e,"file_reply","style","float:left;margin:5px"),e.getElementsByTagName("blockquote")[0].setAttribute("style","margin:5px;clear:both")},format_thread_style:function(e){site2.common.add_attribute_by_classname(e,"postreply","style","background:#cacaec")},format_thread_contents:function(e){site2.common.remove_by_tagname(e,"input"),site2.common.remove_by_classname(e,"report_parent"),site2.common.remove_by_attribute(e.getElementsByClassName("postheader"),"onclick","hideThread"),site2.common.remove_by_attribute(e.getElementsByClassName("file_thread"),"onclick","toggleThumbnail"),site2.common.remove_by_attribute(e.getElementsByClassName("file_thread"),"href","shipainter"),site2.common.remove_by_tagname(e,"hr"),site2.common.remove_by_classname(e,"omittedinfo")},preprocess_html:function(e,t){return e&&(t&&(e=e.replace(/<script[> ].*<\/script>/gm,"")),e=e.replace(/onload="imageFinishedLoading\([0-9]*\)"/gm,""),e=e.replace(/onmouseover="[^"]*"/gm,""),e=e.replace(/onmouseout="[^"]*"/gm,""),e=e.replace(/onclick="[^"]*"/gm,"")),e},preprocess_doc:function(e){site2.common.remove_attribute(e,"onload"),site2.common.remove_attribute(e,"onmouseover"),site2.common.remove_attribute(e,"onmouseout"),site2.common.remove_attribute(e,"onclick"),site2.common.remove_attribute(e,"onchange"),site2.common.remove_attribute(e,"onfocus"),site2.common.remove_attribute(e,"onsubmit");for(var t=e.getElementsByTagName("*"),a=t.length-1;a>=0;a--)t[a].getAttribute&&t[a].getAttribute("href")&&0==t[a].getAttribute("href").indexOf("javascript:")&&t[a].removeAttribute("href");pref.test_mode[28]&&(e.getElementsByTagName("html")[0].innerHTML=e.getElementsByTagName("html")[0].innerHTML)},catalog_native_prep:function(e,t,a,n){var r="catalog"===site.whereami?document.getElementsByClassName("catalog")[0]:document.querySelector('form[action="/delete"]');site4.tb_prep_for_embed(a);var o=t.getElementsByTagName("select")["catalog.indexing"];o.setAttribute("style","float:left"),r.parentNode.insertBefore(o,r),a.childNodes[3].setAttribute("style","float:left"),r.parentNode.insertBefore(a,r)},catalog_get_native_area:function(){return"page"===site.whereami?document.querySelector('form[action="/delete"]'):document.getElementsByClassName("catalog")[0]},parse_funcs:{catalog_html:{ths:function(e){for(var t=this.ths_array(e,e.pn.getElementsByClassName("thread")),a=Date.now()-36e5*pref.localtime_offset,n=0;n<t.length;n++)t[n].time_bumped<0&&(t[n].time_bumped+=a);return t},no:function(e){return parseInt(e.pn.getAttribute("id").substr(7),10)},time_bumped:function(e){return-1-16*parseInt(e.page.substr(0,e.page.indexOf(".")),10)-parseInt(e.page.substr(e.page.indexOf(".")+1))},time_created:function(e){return 0},nof_posts:function(e){var t=e.pn.getElementsByClassName("omitted_text")[0],a=t?parseInt(t.textContent.match(/[0-9]+/),10):0;return isNaN(a)?1:a+1},nof_files:function(e){return 0},key:function(e){return e.domain+e.board+e.no},sub:function(e){var t=e.pn.getElementsByTagName("header")[0].textContent.trim();return 0==t.search(/^#[0-9]+$/)?"":t},name:function(e){return""},com:function(e){return e.pn.getElementsByTagName("section")[0].innerHTML},type_com:"html",footer:function(e){var t=e.pn.getElementsByClassName("omitted_text")[0];return t.innerHTML="",t},sticky:function(e){return!1},op_img_url:function(e){var t=e.pn.getElementsByClassName("thumbnail"),a=t[0]?t[0].getElementsByTagName("img"):null;return a&&a[a.length-1]?a[a.length-1].getAttribute("src"):void 0},get_op_src:"thread_html",filename:function(e){var t=(e.pn.classList.contains("thread")||e.pn.classList.contains("thread_body"),e.pn.getElementsByClassName("post_files")[0].getElementsByTagName("figure"));if(t)for(var a=0;a<t.length;a++){var n=t[a].getElementsByTagName("img")[0].getAttribute("src");1===a&&(e.extra_files=[]),a>=1&&(e.extra_files[a-1]={domain:e.domain,board:e.board});var r=n.lastIndexOf("/"),o=0===a?e:e.extra_files[a-1];o.filename=t[a].getElementsByTagName("img")[0].getAttribute("alt"),o.filename_server=n.substr(r+1)}return e.filename},prep_mimic:"page_html",tn_imgs:function(){return[]},img2src:function(e){return th.op_img_url.replace("thumbnails","files")},dynamic_image_hover:!0},catalog_json:{proto:"catalog_html"},page_html:{ths:function(e){return this.ths_array(e,e.pn.getElementsByClassName("thread"))},th_init:function(e){e.pn.removeAttribute("class"),e.pn.style.clear="none"},no:function(e){return parseInt(e.pn.id?e.pn.id.replace(/[^_\-]*./,""):e.pn.getElementsByClassName("postnumber")[0].getElementsByTagName("a")[1].textContent,10)},posts:function(e){return this.posts_array(e,e.pn.querySelectorAll(".thread_body, td.postreply"))},time:"post_html.time",nof_posts:function(e){var t=e.pn.getElementsByTagName("table").length+1,a=e.pn.getElementsByClassName("filename").length,n=e.pn.getElementsByClassName("omittedinfo");if(n[0]){var r=n[0][brwsr.innerText].replace(/\n/g,"");t+=parseInt(r.replace(/\ post.*/,""),10),a+=parseInt("0"+r.replace(/\ file.*/,"").replace(/[^\ ]*\ /g,""),10)}return Object.defineProperty(e,"nof_files",{value:a,enumerable:!0,configurable:!0,writable:!0}),t},nof_files:function(e){return e.hasOwnProperty("nof_posts")||this.nof_posts(e),e.nof_files},sub:function(e){var t=e.pn.getElementsByClassName("postsubject")[0];return t?t.textContent:""},name:function(e){return e.pn.getElementsByClassName("postername")[0][brwsr.innerText]},pn_name:function(e){return e.pn.getElementsByClassName("postername")[0]},com:function(e){return(e.pn.getElementsByClassName("postbody")[0]||e.pn).getElementsByTagName("p")[0].innerHTML.replace(/^\s*/,"").replace(/\s*$/,"")},type_com:"html",footer:function(e){return this.insert_footer4(e.pn.getElementsByClassName("file_thread")[0])},flag:function(e){for(var t=e.pn.getElementsByTagName("img"),a=0;a<t.length&&t[a].getAttribute("src").search(/images\/balls/)==-1;a++);if(a<t.length){var n=document.importNode(t[a],!1);return n.setAttribute("src",site2.KC.absolute_link_1(n.getAttribute("src"))),n}return null},op_img_url:function(e){var t=e.pn.getElementsByClassName("file_thread"),a=t[0]?t[0].getElementsByTagName("img"):null,n=a&&a[a.length-1]?a[a.length-1].getAttribute("src"):void 0;if(t.length>=2){e.op_img_url2=[];for(var r=1;r<t.length;r++){a=t[r].getElementsByTagName("img");var o=a&&a[a.length-1]?a[a.length-1].getAttribute("src"):void 0;o&&(e.op_img_url2[e.op_img_url2.length]=o)}}return site2[e.domain].protocol+"//"+site2[e.domain].domain_url+n},get_op_src:"thread_html",get_thread_links:function(e){for(var t=e.pn.getElementsByClassName("postheader")[0].getElementsByTagName("a"),a=0;a<t.length;a++)if("Reply"===t[a].textContent||"Antworten"===t[a].textContent)return[t[a]]},get_omitted_info:function(e){return e.pn.getElementsByClassName("omittedinfo")[0]},set_omitted_info:function(e,t){e.pn.insertBefore(t,e.pn.getElementsByClassName("postbody")[0].nextSibling)},replace_omitted_info2:function(e,t){e.childNodes[0].textContent=t?t.childNodes[0].textContent:""},filename:function(e){var t=e.pn.classList.contains("thread")||e.pn.classList.contains("thread_body"),a=e.pn.getElementsByClassName(t?"file_thread":"file_reply");if(a)for(var n=0;n<a.length;n++){var r=a[n].getElementsByClassName("filename")[0].getElementsByTagName("a")[0].getAttribute("href");1===n&&(e.extra_files=[]),n>=1&&(e.extra_files[n-1]={domain:e.domain,board:e.board});var o=r.lastIndexOf("/"),s=0===n?e:e.extra_files[n-1];s.filename=r.substr(o+1),s.filename_server=r.substr(0,o).replace(/[^\/]*\//g,"").replace(/jpeg$/,"jpg");var i=a[n].getElementsByClassName("fileinfo")[0].textContent.replace(/\s/g,"").split(",");s.w=parseInt(i[1].substr(0,i[1].indexOf("x")),10),s.h=parseInt(i[1].substr(i[1].indexOf("x")+1),10);var l=i[1].split(/\s/);l[1]="kB"===l[1]?1e3:"MB"===l[1]?1e6:1,s.fsize=parseInt(l[0],10)*l[1];var c=a[n].querySelector("img[id^=thumbnail]");c&&(s.tn_w=parseInt(c.getAttribute("width"),10),s.tn_h=parseInt(c.getAttribute("height"),10))}return e.filename},tn_imgs:function(e){return e.pn.querySelectorAll("img[id^=thumbnail]")},prep_mimic:function(e){e.op_img_url=e.parse_funcs.op_img_url(e)},get_op_src:function(e){return site2.KC.catalog_json2html3_src(e)},get_max_page:function(e){for(var t=e.querySelectorAll("form[action*=delete]")[0].lastChild.previousSibling.previousSibling.previousSibling.childNodes[1].childNodes[1].childNodes[0].childNodes[3].childNodes,a=0,n=0;n<t.length;n++){var r=t[n].textContent.replace(/\s+/g,"");a+1!=r&&"["+(a+1)+"]"!==r||a++}return a}},thread_html:{com:function(e){return e.pn.getElementsByTagName("blockquote")[0].innerHTML.replace(/^\s*/,"").replace(/\s*$/,"")},type_com:"html",time_created:function(e){return e.parse_funcs.time(e.posts[0])},time_bumped:function(e){return e.parse_funcs.time(e.posts[e.posts.length-1])},get_op_src:function(e){return e.op_img_url.replace("thumbnails","files")},proto:"page_html"},post_html:{flag:"page_html",time:function(e){return site2.KC.parse_funcs.post_html.time_pn(e.pn)},time_pn:function(e){var t=e.getElementsByClassName("postdate")[0];return t?site2.KC.parse_funcs.post_html.time_pn_1(t):void 0},time_pn_1:function(e){return Date.parse(e.textContent)+36e5*(pref.localtime_offset-site2.KC.time_offset)}},post_json:{time_unit:1}},general_event_handler:{catalog:{mouseover:function(e){var t=e.target;"IMG"===t.tagName&&pref[cataLog.embed_mode].image_hover&&"thumbnail"===t.parentNode.className&&cataLog.image_hover_add.call(e.target,e,e.target.src.replace(/thumbnail/,"file"))},__proto__:site2.DEFAULT.general_event_handler.catalog}},popups_href2dbtp:function(e,t,a){"#"===e[0]&&a&&(e=this.link_dbtp2href([a.domain,a.board,a.no,e.substr(1)]),t.setAttribute("href",e));var n=e.split(/[\/#]/),r=n[n.length-1],o=n[n.length-2].replace("thread-","").replace(".html","");return["KC",n.length>=3?"/"+n[n.length-3]+"/":site.board,o,r]},link_dbtp2href:function(e){return e[1]+"thread-"+e[2]+".html#"+e[3]},post_json2html_fname_server:function(e){return e.filename_server},post_json2html_fname:function(e){return e.filename},catalog_json2html3_src:function(e){return site.protocol+"//"+site2[e.domain].domain_url+"/files/"+e.filename_server},catalog_json2html3_thumbnail:function(e){return site.protocol+"//"+site2[e.domain].domain_url+"/thumbnails/"+e.filename_server},post_json2html:function(e,t,a,n,r){var o=document.createElement("div"),s=e.parse_funcs&&e.parse_funcs.time_unit||1,i=new Date((e.time||0)*s-36e5*(pref.localtime_offset-site2.KC.time_offset)),l="";if(e.filename&&(l+=this.post_json2html_file(e,t,e.extra_files),e.extra_files))for(var c=0;c<e.extra_files.length;c++)l+=this.post_json2html_file(e.extra_files[c],t,!0);return o.innerHTML='<div class="'+(a?"thread_body":'postreply" id="post-'+e.no)+'"><div class="postheader"><input name="post_'+e.no+'" value="delete" type="checkbox">'+(e.flag?e.flag.innerHTML:"")+'<span class="postsubject">'+e.sub+'</span> <span class="postername">'+e.name+'</span> <span class="postdate">'+i.toLocaleString()+'</span> <span class="postnumber"><a href="/int/thread-'+r+".html#"+e.no+'" class="quotelink">No.</a><a href="/int/thread-'+r+".html#q"+e.no+'" class="quotelink">'+e.no+'</a></span> <div class="report_parent"><a href="/report/int/'+r+'" class="report_link"><img src="/images/icon-report.png"></a></div>'+(a?' [<a href="'+t+"thread-"+e.no+'.html">Reply</a>] ':"")+"</div>"+l+"<div"+(a?' class="postbody"':"")+'><blockquote><p id="post_text_'+e.no+'">'+e.com+"</p></blockquote></div></div>",o.childNodes[0]},post_json2html_file:function(e,t,a){var n=(.005+(e.fsize>1048576?e.fsize/1048576:e.fsize/1024)).toString();n=n.substr(0,n.indexOf(".")+3)+(e.fsize>1048576?" MB":" KB");var r=site2[e.domain].post_json2html_fname_server(e),o=site2[e.domain].post_json2html_fname(e),s=site2[e.domain].catalog_json2html3_src(e,t),i=site2[e.domain].catalog_json2html3_thumbnail(e,t);return'<div class="file_thread"><span class="filename"><a href="/download/'+r+"/"+o+'">'+o+'</a></span><br><span class="fileinfo"> '+o.substr(o.lastIndexOf(".")+1).toUpperCase()+", "+e.w+"x"+e.h+", "+n+'</span><br><a href="'+s+'" target="_blank"><img style="display: block" id="thumbnail_'+r+'" src="'+i+'" width="'+e.tn_w+'" height="'+e.tn_h+'"></a></div>'},page_json2html3:function(e,t,a,n){n=!0;var r=document.createElement("div");r.setAttribute("id","thread_"+e.no),r.setAttribute("style","clear:both"),r.innerHTML="<hr><a name="+e.no+"></a>";var o=this.post_json2html(e.posts&&e.posts[0]?e.posts[0]:e,t,!0,site2[e.domain].short_link(e.key,e.nof_posts,2,"[Last "," Posts]"),e.no);if(r.appendChild(o),!n&&e.posts[0].pn||(e.posts[0].pn=o),e.posts){for(var s=1;s<e.posts.length;s++){var i=this.post_json2html(e.posts[s],t);this.update_posts_insert_1(this.post_container(i,e.posts[s].no),e.posts[s].no,null,r),!n&&e.posts[s].pn||(e.posts[s].pn=i)}this.page_json2html3_add_omitted_info(e,e.posts,e.posts)}return r},page_json2html3_replace_expander:function(e,t,a){var n=e[0].pn.getElementsByClassName("omittedinfo")[0];n&&n.appendChild(cnst.config_expander(a,t))},page_json2html3_add_omitted_info:function(e,t,a){for(var n=0,r=1;r<a.length;r++)n+="html"===a[r].type_data?a[r].pn.getElementsByClassName("file_thread").length:a[r].filename?a[r].extra_files?a[r].extra_files.length+1:1:0;var o=e.nof_files-n,s=e.nof_posts-a.length,i=t?t[0].pn.getElementsByClassName("omittedinfo")[0]:null;return e.nof_posts>1?(i||(i=document.createElement("span"),i.setAttribute("class","omittedinfo"),i.innerHTML="dummy",i.appendChild(cnst.config_expander(e.key)),t&&t[0].pn.insertBefore(i,t[0].pn.getElementsByClassName("postbody")[0].nextSibling)),i.childNodes[0].textContent=0!==s?s+" post"+(1!==s?"s":"")+(o?" and "+o+" file"+(1===o?"":"s"):"")+" are not shown. ":""):i&&t&&t[0].pn.removeChild(i),i},update_posts_remove:function(e,t,a,n){a=a.getElementsByClassName("thread_body")[0];var r=e.posts[t].pn;n&&r.parentNode===a?this.update_posts_insert_pack(r):r=r.parentNode.parentNode.parentNode,r.previousSibling&&"A"===r.previousSibling.tagName&&a.removeChild(r.previousSibling),a.removeChild(r)},update_posts_insert:function(e,t,a,n,r){var o=t[n];o=o?o.pn:null;var s=o&&o.parentNode&&o.parentNode.parentNode&&o.parentNode.parentNode.parentNode;s&&s.parentNode&&s.parentNode.parentNode===r&&(o=s),e[a].pn||(e[a].pn=this.post_json2html(e[a],e[a].board)),0===a&&this.update_posts_insert_pack(e[0].pn),0===n&&o&&this.update_posts_insert_pack(t[0].pn);var i=0===n&&0===a?e[a].pn:this.post_container(e[a].pn,e[a].no);this.update_posts_insert_1(i,e[a].no,o,r),0===a&&0===n&&this.update_posts_insert_unpack(e[0].pn)},update_posts_insert_1:function(e,t,a,n){n=n.getElementsByClassName("thread_body")[0];var r=document.createElement("a");r.setAttribute("name",t),n.insertBefore(r,a),n.insertBefore(e,a)},update_posts0_class:site2.vichan.update_posts0_class,update_posts_insert_pack:site2.vichan.update_posts_insert_pack,update_posts_insert_pack_iter:function(e,t){for(var a=e.previousSibling;a;){var n=a.previousSibling;if(a.classList&&(a.classList.contains(pref.script_prefix+"_footer")||a.classList.contains("file_thread")||a.classList.contains("post_header"))&&t(a),a.classList&&a.classList.contains("postbody"))break;a=n}},update_posts_insert_unpack:function(e){for(;;){var t=e.firstChild;if(!(t&&t.classList&&(t.classList.contains(pref.script_prefix+"_footer")||t.classList.contains("file_thread")||t.classList.contains("post_header"))))break;e.parentNode.insertBefore(t,e)}},post_container:function(e,t){var a=document.createElement("table");return a.innerHTML='<tbody><tr><td valign="top">&gt;&gt;</td></tr></tbody>',a.childNodes[0].childNodes[0].appendChild(e),a},catalog_json2html3:function(e,t,a){var n=document.createElement("article");n.setAttribute("class","thread teaser"),n.setAttribute("id","thread-"+e.no);var r=null;return e.flags&&e.flags[0]&&(r=document.importNode(e.flags[0],!1),r.setAttribute("class","post_country")),n.innerHTML='<article class="thread_OP" id="'+e.no+'"><div class="post"><header><a><h1>'+(r?r.outerHTML:"")+(e.sub?e.sub:"#"+e.no)+'</h1></a></header><div class="post_body"><a><div class="post_files multiple"><figure><div class="thumbnail"><img src="'+e.op_img_url+'"></div></figure>'+(e.op_img_url2&&e.op_img_url2[0]?'<figure><div class="thumbnail"><img src="'+e.op_img_url2[0]+'"></div></figure>'+(e.op_img_url2&&e.op_img_url2[1]?'<figure><div class="thumbnail"><img src="'+e.op_img_url2[1]+'"></div></figure>'+(e.op_img_url2&&e.op_img_url2[2]?'<figure><div class="thumbnail"><img src="'+e.op_img_url2[2]+'"></div></figure>':""):""):"")+'</div></a><div class="omittedposts"><span class="omitted_text">R: 0 / I: 0 / P: 0.0&emsp;/catalog/</span></div><div class="post_text"><section>'+e.com+"</section></div></div></div></article>",n.getElementsByClassName("thumbnail")[0].childNodes[0].addEventListener("load",site2.KC.catalog_json2html3_onload,!1),n},catalog_json2html3_onload:function(){this.removeEventListener("load",site2.KC.catalog_json2html3_onload,!1);var e=this.naturalWidth,t=this.naturalHeight,a=(e>t?e:t)/200;this.setAttribute("width",e/a),this.setAttribute("height",t/a)},favicon:{__proto__:site2.vichan.favicon,none:"/favicon.ico",reply:"png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAIAAACQkWg2AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAKJJREFUOE9jZPh/hgECfv4yts59/PgxlAujZGVlzx6dzMDOBhMAaoCjtEA01SAuUBBZDQrnwEwsGoCCKBp+HEPwPx6QkZFB1gPifjyAUABUbGxsDLIUaAxEItQFxRIgFygIlAIqSAsEKYYDkGGhLpaWlsgaQNxQFxRrxcTEsLgbhxBI8SDUQLKnSQ9WUiOO9KRBfuL7cQzoH2C0oAGQJ5GcDQBwM6RhinByrgAAAABJRU5ErkJggg==",reply_to_me:"png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAIAAACQkWg2AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAMxJREFUOE9jZPh/hgECfv4yts59/PgxlAujZGVlzx6dzMDOBhMAavh/5j8MoKkGcdMCQYbCEYSFT8OBmagafhxD1iAjI4NsCYj78QBCA1CxsbEx0FKEDaEuKK4CcoFOAOoB2pMWCFIMAXANlpaWyBpA3FAXFGvFxMSQNWDxNJIQSDFEA5EAoQFfKGG1gQQNcP0gn4W6EPY0JFhBoQYJb8LBCo44KPp4gHDEoUQ70B5MgJ40kBMW0G2YAGviA9nz4xjQP8CQRgMgTyI5GwD2xdfU779fsgAAAABJRU5ErkJggg=="},add_backlinks:function(e,t,a,n){}},site2["4chan_i"]={home:void 0,nickname:"4chan_i",domain_url:"i.4chan.org",check_func:site2.DEFAULT.check_func,proto:"4chan"},site2["4chan"]={nickname:"4chan",home:site.protocol+"//boards.4chan.org/favicon.ico",protocol:"http:",postform_rules:null,postform:{init:function(){return this.tack=document.createElement("img"),this.tack.setAttribute("src","//s.4cdn.org/image/sticky.gif"),this.tack.setAttribute("class","stickyIcon retina"),this.tack.setAttribute("style","float:right;font-size:2em;"),site.postform.parentNode.insertBefore(this.tack,site.postform),this.tack},activation:function(){document.getElementById("togglePostFormLink").getElementsByTagName("a")[0].click(),this.activation=null},__proto__:site2.DEFAULT.postform},features:{uip_tracker:!0},components:{boardlist:".boardList",postform_comment:'textarea[name="com"]',postform_submit:'input[type="submit"]',postform_comment2:['textarea[name="com"]',1],postform_submit2:['input[type="submit"]',2]},pref_default:{catalog_expand_with_hr:!0,page:{env:{disp_filler:"<hr>"}},patch:{delayed_invoke:{use:brwsr.ff}},catalog:{t2h_sel:"N",image_hover_zIndex:100001},proto:{env:{event_dynamic:!0}},easy2:{limits:2}},spoiler_text:{
open_rule:"s,s a:not(:hover) {color: #fff!important;}"},general_event_handler:function(){var e={thread:{get_mark:function(e,t){for(;e&&e!==cataLog.parent;){if(e.classList.contains("post"))return e;if(e.classList.contains("postContainer"))return e.getElementsByClassName("post")[0];if(e.parentNode&&e.parentNode.classList.contains("thread")){if(e=e.previousSibling)continue;break}if(e.classList.contains("thread"))break;e=e.parentNode}return this.get_mark_from_height(t)},get_mark_from_height:function(e){return this.__proto__.get_mark_from_height(e,document.getElementsByClassName("post"))},__proto__:site2.DEFAULT.general_event_handler.common}};return e.page=Object.create(e.thread),e.catalog={mouseover:function(e){var t=e.target;"IMG"===t.tagName&&pref[cataLog.embed_mode].image_hover&&"A"===t.parentNode.tagName&&cataLog.image_hover_add.call(t,e)},__proto__:e.thread},e}(),domain_url:"boards.4chan.org",check_func:function(){return window.location.href.search(/4chan.org/)!=-1&&(site.whereami=document.getElementsByTagName("head")[0].innerHTML.indexOf("404 Not Found")!=-1?"404":window.location.href.search(/catalog/)!=-1?"catalog":window.location.href.search(/thread\/[0-9]+/)!=-1?"thread":window.location.href.search(/archive/)!=-1?"archive":window.location.href.search(/\/$|(index|[0-9]+)(\.html)*|\/#all$/)!=-1?"page":"other",site.config("4chan.org","4chan"),this.postform_prep(),site.max_page=site2["4chan"].max_page(site.board),site.header_height=function(){var e=document.getElementById("header");return e?e.offsetHeight:0},"thread"===site.whereami?(site.embed_to.top=document.getElementsByClassName("navLinks")[0],site.embed_to.bottom=document.getElementsByClassName("bottomad")[0]||document.getElementById("boardNavDesktopFoot")):"page"===site.whereami?(site.embed_to.top=document.getElementById("ctrl-top"),site.embed_to.bottom=document.getElementsByClassName("pagelist")[0]):"catalog"===site.whereami&&(site.embed_to.top=document.getElementById("content").previousSibling,site.embed_to.bottom=document.getElementsByClassName("navLinksBottom")[0].nextSibling),site.postform=document.getElementsByClassName("postForm")[0],!0)},get_next_image:function(e,t){var a=cataLog.parent.querySelectorAll("img[data-md5]"),n=Array.prototype.indexOf.call(a,e.previousSibling);if(t)for(;a[n+1]&&a[n+1].offsetTop<t;)n++;if(n>=0){for(;a[n+1]&&a[n+1].parentNode.getAttribute("href").search(/\.webm$/)!=-1;)n++;return a[n+1]}return null},format_expanded_thumbnail:function(e){e.removeAttribute("data-md5"),e.className="expanded-thumb"},catalog_threads_in_page:function(e){return e.getElementsByClassName("thread")},catalog_posts_in_thread:function(e){return e.getElementsByClassName("replyContainer")},max_page:function(){return 10},make_url4:function(e,t){var a=site.protocol+"//"+this.domain_url+e[1],n=site.protocol+"//a.4cdn.org"+e[1];return("catalog_html"===e[3]||t&&0==e[2]&&"page_json"===e[3])&&(e[3]="catalog_json"),"page_json"===e[3]?[n+(parseInt(e[2],10)+1)+".json","json",t?"4chan"+e[1]+"j0":void 0]:"catalog_json"===e[3]?[n+"catalog.json","json","4chan"+e[1]+"j0"]:"thread_json"===e[3]?[n+"thread/"+e[2]+".json","json"]:"page_html"===e[3]?[a+(0!=e[2]?parseInt(e[2],10)+1:""),"html"]:"thread_html"===e[3]?[a+"thread/"+e[2],"html"]:null},trim_list:"force_init",url_boards_json:function(){return[site.protocol+"//a.4cdn.org/boards.json","json"]},archive_patch_domain:function(e){Object.defineProperty(e,"domain_xhr",{get:function(){return this.url.indexOf("i.4cdn.org/")===-1?null:"4chan_i"},configurable:!0,enumerable:!0})},get_ops:function(e){for(var t=[],a=e.getElementsByClassName("thread"),n=0;n<a.length;n++)t.push(a[n].id.substring(1));return t},get_posts:function(e){for(var t=[],a=e.getElementsByClassName("postContainer"),n=0;n<a.length;n++)t.push(parseInt(a[n].id.substring(2),10));return t},modify_thread_link:function(e){var t=e.getElementsByClassName("replylink")[0];if(t){var a=t.getAttribute("href");return t.removeAttribute("href"),[[t,a]]}return[]},check_thread_archived:function(e){return 0!=e.getElementsByClassName("archivedIcon").length},mark_newer_posts:function(e,t,a,n){return site2.DEFAULT.mark_newer_posts("4chan",e.getElementsByClassName("postContainer"),t,function(e){return e.getElementsByClassName("post reply")[0]},a,n)},localtime:function(e){for(var t=e.getElementsByClassName("dateTime"),a=0;a<t.length;a++)t[a].textContent=site2.common.change_utc_to_local(1e3*parseInt(t[a].getAttribute("data-utc"),10))},remove_files_info:function(e){site2.common.remove_by_classname(e,"fileText"),site2.common.remove_by_classname(e,"mFileInfo");for(var t=e.getElementsByClassName("fileThumb"),a=0;a<t.length;a++)site2.common.move_up_and_delete_parent([t[a].childNodes[0]])},remove_posts:function(e,t){site2.common.remove_by_classname(e,"postContainer replyContainer",t,!0)},format_thread_layout:function(e){site2.common.add_attribute_by_classname(e,"post op","style","padding:0px"),site2.common.add_attribute_by_tagname(e,"blockquote","style","margin:12px 5px")},format_thread_contents:function(e){site2.common.remove_by_tagname(e,"input"),site2.common.remove_by_classname(e,"mobile"),site2.common.remove_by_classname(e,"sideArrows"),site2.common.remove_by_classname(e,"summary")},get_json_url_catalog:function(e){return site.protocol+"//a.4cdn.org"+e+"catalog.json"},uip_check:function(e,t){var a=[site.nickname,site.board,site.no,"thread_json"];http_req.get("uip",a.join(),"",e,!1,!1),pref.uip_tracker.sage.detect&&(a[3]="catalog_json",http_req.get("sage_detection",a.join(),"",this.sage_detect,!1,!1,t))},sage_detect_last_bumps:{},sage_detect:function(e,t,a){var n=e.split(","),r=site2["4chan"].wrap_to_parse.get(t.response,n[0],n[1],n[3],{page:0});a(site2["4chan"].parse_funcs.catalog_json.add_sage(r,site2["4chan"].sage_detect_last_bumps,site.no))},parse_json_thread:function(e,t){if(t)return e.posts[e.posts.length-1].unique_ips=e.posts[0].unique_ips,e;for(var e={posts:[]},a={},n=0,r=document.getElementsByClassName("postContainer"),o=0;o<r.length;o++){e.posts[o]={},e.posts[o].no=r[o].id.replace(/pc/,"");var s=r[o].getElementsByClassName("posteruid")[0];s&&(s=s.textContent,e.posts[o].id=s,void 0===a[s]&&(n++,a[s]=1)),e.posts[o].unique_ips=n}return e.posts[r.length-1].unique_ips=0,e},uip_tgt_post:function(e){return document.getElementById("p"+e)},uip_post_num:function(e){return e.getElementsByClassName("postNum")},prep_own_posts_reg:/^4chan\-track\-[0-9A-z]+\-[0-9]+$/,prep_own_posts_event:function(e){e&&site2["4chan"].prep_own_posts_1(e.key)&&(e=null),"4chan"!==window.name||e||send_message("parent",[["OWN_POSTS",window.name,site3[window.name].own_posts]])},prep_own_posts:function(e){if(site3[this.nickname].own_posts={},localStorage)for(var t=e?[("4chan-track"+e).replace(/\//g,"-")]:Object.keys(localStorage||"{}"),a=0;a<t.length;a++)this.prep_own_posts_1(t[a])},prep_own_posts_1:function(e){if(this.prep_own_posts_reg.test(e)){var t="/"+e.replace(/^4chan\-track\-/,"").replace(/\-[0-9]+$/,"")+"/";site3[this.nickname].own_posts[t]||(site3[this.nickname].own_posts[t]={});var a=JSON.parse(localStorage[e]||"{}");for(var n in a)site3[this.nickname].own_posts[t][n.substr(2)]=null;return!0}return!1},catalog_native_prep:function(e,t,a,n){var r="catalog"===site.whereami?document.getElementById("ctrl"):document.getElementById("ctrl-top");if("thread"===site.whereami||!r)for(var r=document.getElementsByClassName("navLinks"),o=0;o<r.length;o++)if("none"!==window.getComputedStyle(r[o]).display){r=r[o];break}if(site4.tb_prep_for_embed(a),"catalog"===site.whereami){var s=document.getElementById("order-ctrl");if(0!=s.selectedIndex){s.selectedIndex=0;var i=document.createEvent("UIEvents");i.initUIEvent("change",!1,!0,window,1),s.dispatchEvent(i)}s.style.display="none",document.getElementById("size-ctrl").addEventListener("change",site2["4chan"].catalog_native_size_changed,!1),pref3.catalog.filter.kwd.init(document.getElementById("qf-box"),t).id=null;var l=pref3.catalog.filter.kwd.clear.bind(pref3.catalog.filter.kwd);document.getElementById("qf-ctrl").addEventListener("click",l,!1),document.getElementById("qf-clear").addEventListener("click",l,!1)}else site.whereami;r.appendChild(a);var c=t.getElementsByTagName("select")["catalog.indexing"];"catalog"===site.whereami?s.parentNode.insertBefore(c,s):a.childNodes[3].insertBefore(c,a.childNodes[3].firstChild)},catalog_native_prep_clonenode:function(e,t){var a=e.cloneNode(t);return a.setAttribute("name",(a.name?a.name:"clone_node")+"_CatChan"),e.parentNode.insertBefore(a,e.nextSibling),e.setAttribute("style","display:none"),a},catalog_get_native_area:function(){return"catalog"===site.whereami?document.getElementById("threads"):document.getElementsByClassName("board")[0]},catalog_native_size:document.getElementById("size-ctrl")?document.getElementById("size-ctrl").value:"small",catalog_native_size_changed:function(){site2["4chan"].catalog_native_size=this.value;var e=catalog_obj.catalog_func().get_threads();for(var t in e)e[t][0]&&site2["4chan"].catalog_json2html3_size_changed(e[t][0].getElementsByTagName("img")[0]);catalog_obj.catalog_func().show_catalog()},parse_funcs:{catalog_html:{ths:"thread_html",no:function(e){return parseInt(e.pn.getAttribute("id").substr(7),10)},time_bumped:function(e){return-1},time_created:function(e){return-1},nof_posts:function(e){var t=e.pn.getElementsByClassName("meta")[0],a=t.textContent.match(/[0-9]+/g);return null===a?a=[0,0]:1==a.length&&(a[1]=0),Object.defineProperty(e,"nof_files",{value:parseInt(a[1],10),enumerable:!0,writable:!0,configurable:!0}),Object.defineProperty(e,"footer",{value:t,enumerable:!0,writable:!0,configurable:!0}),t.innerHTML="",parseInt(a[0],10)},nof_files:function(e){return e.hasOwnProperty("nof_posts")||(e.nof_posts=this.nof_posts(e)),e.nof_files},key:function(e){return e.domain+e.board+e.no},sub:function(e){var t=e.pn.getElementsByClassName("teaser")[0],a=t?t.getElementsByTagName("b"):null,n=t?a&&a[0]?t.childNodes[1]?t.childNodes[1].textContent:"":t.childNodes[0].textContent:"";return Object.defineProperty(e,"com",{value:n,enumerable:!0,writable:!0,configurable:!0}),a&&a[0]?a[0].textContent:""},name:function(e){return""},com:function(e){return e.hasOwnProperty("sub")||Object.defineProperty(e,"sub",{value:this.sub(e),enumerable:!0,writable:!0,configurable:!0}),e.com},footer:function(e){var t=e.pn.getElementsByClassName("meta")[0];return t.innerHTML="",t},sticky:function(e){return void 0!==e.pn.getElementsByClassName("stickyIcon")[0]},tn_as:function(e){return e.pn.getElementsByTagName("a")},tn_imgs:function(e){return e.tn_as[0]?[e.tn_as[0].getElementsByTagName("img")[0]]:[]},class_thread:"thread",class_thumbnail:"thumb",op_img_url:function(e){return e.tn_imgs[0]?e.tn_imgs[0].getAttribute("src"):void 0},get_op_src:"thread_json",dynamic_image_hover:!0,missing_info:1,img2src:function(e){var t=this.get_lth_from_node(e);if(!t)return null;var a=e.src;return t.th&&t.th.ext?a=a.replace(/thumb/,"src").replace(/s\.[^\.]*$/,t.th.ext):t.th.parse_funcs.missing_info&&scan.scan_ui("image_hover",{tgts:[t.domain+t.board],options:{callback:function(){cataLog.image_hover_reentry(e)},priority:6}}),a},time_unit:1e3},catalog_json:{ths:function(e,t){for(var a=[],n=0;n<e.length;n++)if(e[n].threads)for(var r=0;r<e[n].threads.length;r++){var o=e[n].threads[r];o.__proto__=t,a[a.length]={page:n+"."+r,key:t.domain+t.board+o.no,__proto__:o}}return a},time_posted:function(e){return e.last_replies?1e3*e.last_replies[e.last_replies.length-1].time:e.time_created},time_bumped:function(e){return e.bumplimit?void 0:e.time_posted},time_created:function(e){return 1e3*e.time},nof_posts:function(e){return e.replies+1},nof_files:function(e){return e.images+1},op_img_url:"DEFAULT.common",posts:function(e){return e.last_replies?[e.__proto__].concat(e.last_replies):[e.__proto__]},has_posts:!0,add_op_img_url:site2.DEFAULT.parse_parts.add_op_img_url,time_unit:1e3,get_op_src:"thread_json",type_com:"html",posts_full:null,missing_info:void 0,tn_as:"catalog_html",tn_imgs:"catalog_html",footer:"catalog_html",class_thread:"catalog_html",class_thumbnail:"catalog_html",add_sage:function(e,t,a){for(var n=0;n<e.length&&e[n].sticky;){if(e[n].no===a)return e[n];n++}if(pref.uip_tracker.sage.patch_bug3){for(var r=t.ALL||0;n<e.length&&e[n].last_modified<r;){if(e[n].no===a)return e[n];n++}n<e.length&&(t.ALL=e[n].last_modified)}if(n!=e.length){if(e[n].no==a)return e[n];r=e[n].last_modified;for(var o=pref.uip_tracker.sage.tolerance;++n<e.length;){var s=e[n];if(!s.bumplimit){for(var i=s.posts.length-1;i>=1;i--){var l=s.posts[i].time;if(t[s.no]>=l)break;if(r+o>=l)break;s.posts[i].email="sage",pref.debug_mode[30]&&console.log("detect: sage: p:"+Math.floor(n/15)+"."+n%15+", "+s.key+"#"+s.posts[i].no+", "+l+", "+r)}0===i&&(l=s.posts[0].time),1!==s.posts.length&&s.posts[s.posts.length-1].time==s.last_modified||(l=s.last_modified),(!t[s.no]||t[s.no]<l)&&(t[s.no]=l),r=pref.uip_tracker.sage.patch_bug2&&n<pref.uip_tracker.sage.patch_bug2nth?s.last_modified:t[s.no]}if(s.no==a)return s}}},proto:"DEFAULT.catalog_json"},page_html:{ths:"thread_html",th_init:function(e){e.pn.removeAttribute("class")},no:"post_html",time:"post_html",nof_posts:function(e){var t=e.pn.getElementsByClassName("postContainer").length,a=e.pn.getElementsByClassName("fileText").length,n=e.pn.getElementsByClassName("summary desktop")[0];if(n){var r=n[brwsr.innerText].replace(/\n/g,"");t+=parseInt(r.replace(/\ post.*/,""),10),a+=parseInt("0"+r.replace(/\ image.*/,"").replace(/[^\ ]*\ /g,""),10)}return Object.defineProperty(e,"nof_files",{value:a,enumerable:!0,configurable:!0,writable:!0}),t},nof_files:function(e){return e.hasOwnProperty("nof_posts")||this.nof_posts(e),e.nof_files},sub:"DEFAULT.post_html",name:function(e){return e.pn.getElementsByClassName("name")[0][brwsr.innerText]},com:function(e){return e.pn.getElementsByClassName("postMessage")[0][brwsr.innerText]},footer:function(e){return this.insert_footer4(e.pn.getElementsByClassName("postInfo desktop")[0])},sticky:function(e){return 0!=e.pn.getElementsByClassName("stickyIcon").length},flag:"post_html",op_img_url:function(e){var t=e.pn.getElementsByTagName("img")[0];return t?t.getAttribute("src"):void 0},get_thread_links:function(e){return e.pn.querySelectorAll(".replylink,."+pref.script_prefix+"_link")},get_omitted_info:function(e){var t=e.pn.parentNode.nextSibling;return t&&t.classList.contains("summary")?t:void 0},set_omitted_info:function(e,t){e.pn.parentNode.parentNode.insertBefore(t,e.pn.parentNode.nextSibling)},replace_omitted_info:function(e,t){e.childNodes[1].textContent=t.childNodes[1].textContent},replace_omitted_info2:function(e,t,a){if("A"===e.tagName){var n=document.createElement("span");n.setAttribute("class","summary"),n.appendChild(document.createElement("span")),n.appendChild(e),e=n}t?("none"===e.childNodes[1].style.display&&(a.domain===site.nickname&&e.childNodes[0].removeAttribute("style"),e.childNodes[1].removeAttribute("style")),this.replace_omitted_info(e,t)):(e.childNodes[0].setAttribute("style","display:none"),e.childNodes[1].setAttribute("style","display:none"))},get_op_src:"thread_json",time_unit:1e3,pn_name:"post_html"},page_json:{ths:"DEFAULT.page_json",get_op_src:"thread_json",proto:"thread_json"},thread_html:{ths:function(e){return this.ths_array(e,e.pn.getElementsByClassName("thread"))},get_op_src:"thread_json",time_unit:1e3,pn_name:"post_html",proto:"page_html"},thread_json:{tn_as:"catalog_html.tn_as",sticky:function(e){return e.posts[0].sticky},time_bumped:function(e){return e.posts[0].bumplimit?void 0:1e3*e.posts[e.posts.length-1].time},get_op_src:function(e,t){return e.op_img_url.indexOf("s.4cdn.org")!=-1?e.op_img_url:(!e.ext&&e.parse_funcs.missing_info&&scan.scan_ui("image_hover",{tgts:[e.domain+e.board+"j0"],options:{callback:function(){cataLog.image_hover_reentry(t)},priority:6}}),e.localArchive?site2[e.domain].catalog_json2html3_src(e,e.board):e.ext?e.op_img_url.replace(/s(\.\w+)$/,e.ext):t.src)},consolidate_IDB_result_sub:function(e){e[0].nof_posts=e.length;for(var t=0,a=0;a<e.length;a++)e[a].filename&&t++;e[0].nof_files=t},proto:"DEFAULT.thread_json"},post_html:{no:function(e){return parseInt(e.pn.id.substr(1),10)||parseInt(e.pn.id.substr(2),10)},time:function(e){return parseInt(e.pn.getElementsByClassName("dateTime")[0].getAttribute("data-utc"),10)},time_pn:function(e){return 1e3*parseInt(e.getElementsByClassName("dateTime")[0].getAttribute("data-utc"),10)},flag:function(e){var t=e.pn.getElementsByClassName("flag");return 0!=t.length?document.importNode(t[0],!1):null},txt2com_anchor_class:"quotelink",txt2com_spoiler_replace_txt:"<s>$1</s>",time_unit:1e3,pn_name:function(e){return e.pn.getElementsByClassName("desktop")[0].getElementsByClassName("name")[0]},proto:"DEFAULT.post_html"},post_json:{proto:"DEFAULT.post_json"}},popups_href2dbtp:function(e,t,a){"#"===e[0]&&a&&(e=this.link_dbtp2href([a.domain,a.board,a.no,e.substr(1),"href"]),t.setAttribute("href",e));var n=e.split(/[\/#]/),r=n[n.length-1].substr(1),o=n[n.length-2];return["4chan",n.length>=4?"/"+n[n.length-4]+"/":site.board,o,r]},update_posts_remove:function(e,t,a){pref.debug_mode[13]&&e.posts[t].pn.parentNode.parentNode!==a&&console.log(e.posts[t].pn);var n=e.posts[t].pn.parentNode,r=0==t?n.nextSibling:null;a.removeChild(n),r&&"SPAN"===r.tagName&&a.removeChild(r)},update_posts_insert:function(e,t,a,n,r){var o=n<t.length?t[n].pn.parentNode:null;e[a].pn||(e[a].pn=this.post_json2html(e[a],e[a].board));var s=e[a].pn.parentNode||this.post_container(e[a].pn,e[a].no),i=0==a||e[a].isOP?s.nextSibling:null;r.insertBefore(s,o),i&&"SPAN"===i.tagName&&r.insertBefore(i,o)},post_container:function(e,t,a){var n=document.createElement("div");return n.setAttribute("id","pc"+t),n.setAttribute("class","postContainer "+(a?"op":"reply")+"Container"),a||(n.innerHTML='<div class="sideArrows" id="sa'+t+'">&gt;&gt;</div>'),n.appendChild(e),n},add_backlinks:function(e,t,a){if(!pref.test_mode[35]){var n=e.getElementsByClassName(this.backlink_parent_class)[0];n||(n=document.createElement("div"),n.setAttribute("class",this.backlink_parent_class),e.getElementsByClassName("desktop")[0].appendChild(n)),a||(n.innerHTML="");for(var r=a||0;r<t.length;r++){var o=t[r].split(/[\/#]/);o[1]="/"+o[1]+"/";var s=o[0],i=(o[1],o[3]),l=site2[s].link_dbtp2href(o);s!==site.nickname&&(l=site2[s].absolute_link_1(l));var c=null;if(void 0!==a)for(var p=n.getElementsByTagName("a"),_=0;_<p.length;_++)if(p[_].textContent===">>"+i){c=p[_];break}if(!c){c=document.createElement("a"),c.setAttribute("class",this.backlink_class),c.setAttribute("href",l),c.textContent=">>"+i,("4chan"!==o[0]||pref.test_mode[91])&&(c.onclick=this.backlink_onclick,c.onmouseover=this.popups_post_entry);var d=document.createElement("span");d.appendChild(c),d.appendChild(document.createTextNode(" ")),n.appendChild(d)}if(a)break}}},link_dbtp2href:function(e){return e[1]+"thread/"+e[2]+("href"===e[4]?"#":"#p")+e[3]},backlink_onclick:function(){highlightReply.call(this,parseInt(this.textContent.substr(2),10))},backlink_class:"quotelink",backlink_parent_class:"backlink",backlink_parent_prevSib:function(e){return e.getElementsByClassName("postNum")[1]},post_com2txt:function(e){return e.com?e.com.replace(/<[^>]*>/g," ").replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&quot;/g,'"').replace(/&#039;/g,"'").replace(/&#0*44;/g,",").replace(/&amp;/g,"&"):""},post_json2html:function(e,t,a,n,r){var o=document.createElement("div"),s=e.parse_funcs&&e.parse_funcs.time_unit||1,i=new Date((e.time||0)*s),l=e.name||"Anonymous";if(e.ext){var c=(.005+(e.fsize>1048576?e.fsize/1048576:e.fsize/1024)).toString();c=c.substr(0,c.indexOf(".")+3)+(e.fsize>1048576?" MB":" KB");var p=site2[e.domain].catalog_json2html3_src(e,t),_=site2[e.domain].catalog_json2html3_thumbnail(e,t),d=a?1:(e.tn_w>e.tn_h?e.tn_w:e.tn_h)/150,u='<div class="file" id="f'+e.no+'"><div class="fileText" id="fT'+e.no+'">File: <a href="'+p+'" target="_blank">'+e.filename+"</a> ("+c+", "+e.w+"x"+e.h+')</div><a class="fileThumb" href="'+p+'" target="_blank"><img src="'+_+'" alt="'+c+'" data-md5="'+e.md5+'" style="height: '+(a?e.tn_h:e.tn_h/d)+"px; width:"+(a?e.th_w:e.tn_w/d)+'px;"><div data-tip="" data-tip-cb="mShowFull" class="mFileInfo mobile">'+c+" "+e.ext.substr(1).toUpperCase()+"</div></a></div>"}return o.innerHTML='<div id="p'+e.no+'" class="post reply"><div class="postInfoM mobile" id="pim'+e.no+'"><span class="nameBlock"><span class="name">'+l+'</span><br></span><span class="dateTime postNum" data-utc="'+e.time+'">'+site2.common.change_utc_to_local(i)+"</span></div>"+(e.ext&&a?u:"")+'<div class="postInfo desktop" id="pi'+e.no+'"><input type="checkbox" name="'+e.no+'" value="delete"> '+(e.sub?'<span class="subject">'+e.sub+"</span> ":"")+'<span class="nameBlock"><span class="name">'+l+"</span> "+(e.capcode?'<strong class="capcode hand id_mod" title="Highlight posts by Moderators">##'+e.capcode+"</strong>":"")+"</span> "+(e.trip?'<span class="postertrip">'+e.trip+"</span> ":"")+'<span class="dateTime" data-utc="'+e.time+'">'+site2.common.change_utc_to_local(i)+'</span> <span class="postNum desktop"><a href="thread/'+r+"#p"+e.no+'" title="Link to this post">No.</a><a href="thread/'+r+"#q"+e.no+'" title="Reply to this post">'+e.no+"</a></span> &nbsp; "+(a?'<span>[<a href="'+site2[e.domain].make_url4([e.domain,t,e.no,"thread_html"])[0]+'" class="replylink">Reply</a>]</span>'+(n?n.replace(/>\[/g,">").replace(/<a/g,"<span>[<a").replace(/\]<\/a/g,"</a>]</span"):""):"")+"</div>"+(e.ext&&!a?u:"")+'<blockquote class="postMessage" id="m'+e.no+'">'+(e.com||"")+"</blockquote></div>",o.removeChild(o.childNodes[0])},page_json2html3_skelton:function(e){var t=document.createElement("div");return t.setAttribute("id","t"+e.no),t},page_json2html3:function(e,t,a,n){var r=this.page_json2html3_skelton(e),o=this.post_json2html(e.posts&&e.posts[0]?e.posts[0]:e,t,!0,site2[e.domain].short_link(e.key,e.nof_posts,2,"[Last "," Posts]"),e.posts[0].no);if(o.setAttribute("class","post op"),r.appendChild(this.post_container(o,e.posts[0].no,!0)),!n&&e.posts[0].pn||(e.posts[0].pn=o),e.posts){for(var s=1;s<e.posts.length;s++){var i=this.post_json2html(e.posts[s],t);r.appendChild(this.post_container(i,e.posts[s].no)),!n&&e.posts[s].pn||(e.posts[s].pn=i)}this.page_json2html3_add_omitted_info(e,e.posts,e.posts)}return r},page_json2html3_replace_expander:function(e,t,a){var n=e[0].pn.parentNode.parentNode.getElementsByClassName("summary")[0];n&&n.appendChild(cnst.config_expander(a,t))},page_json2html3_add_omitted_info:function(e,t,a){for(var n=0,r=1;r<a.length;r++)n+="html"===a[r].type_data?a[r].pn.getElementsByClassName("file").length:a[r].filename?1:0;var o=e.nof_files-n,s=e.nof_posts-a.length,i=t?this.parse_funcs.page_html.get_omitted_info(t[0]):null;return 0!=s?(i||(i=document.createElement("span"),i.setAttribute("class","summary"),i.innerHTML='<img class="extButton expbtn" title="Expand thread" alt="+" data-cmd="expand" data-id="'+a[0].no+'" src="//s.4cdn.org/image/buttons/burichan/post_expand_plus.png"><span class="summary"></span><span style="display: none;">Showing all replies.</span>',("4chan"!==e.domain||pref[cataLog.embed_mode].use_expander_always)&&i.appendChild(cnst.config_expander(e.key)),t&&this.parse_funcs.page_html.set_omitted_info(t[0],i)),i.childNodes[1].textContent=s+(1==s?" reply":" replies")+(o?" and "+o+" image"+(1!==s?"s":""):"")+" omitted.",e.domain!==site.nickname&&(i.childNodes[0].style.display="none")):i&&t&&t[0].pn.removeChild(i),i},catalog_json2html3_thumbnail:function(e,t){return e.ext?this.protocol+"//i.4cdn.org"+t+e.tim+"s"+(".jpg"===e.ext||".png"===e.ext||".gif"===e.ext||".webm"===e.ext?".jpg":e.ext):""},catalog_json2html3_src:function(e,t){return e.ext?this.protocol+"//i.4cdn.org"+t+e.tim+e.ext:""},catalog_json2html3:function(e,t,a){var n=document.createElement("div");return n.setAttribute("class","thread"),n.setAttribute("id","thread-"+e.no),n.innerHTML='<a href="'+this.protocol+"//boards.4chan.org"+e.board+"thread/"+e.no+(e.sub?"/"+e.sub.replace(/ /,"-"):"")+'"><img alt="" id="thumb-'+e.no+'" class="thumb"'+(e.tn_w?'width="'+("small"===this.catalog_native_size?3*e.tn_w/5:e.tn_w)+'"':"")+(e.tn_h?'height="'+("small"===this.catalog_native_size?3*e.tn_h/5:e.tn_h)+'"':"")+"src="+a+' data-id="'+e.no+'"></a><div title="(R)eplies / (I)mages" id="meta-'+e.no+'" class="meta">R: <b>'+e.nof_posts+"</b> / I: <b>"+e.nof_files+'</b></div><div class="teaser">'+(e.sub?"<b>"+e.sub+"</b>":"")+(e.com?(e.sub?": ":"")+e.com:"")+"</div>",n.childNodes[0].childNodes[0].addEventListener("load",site2["4chan"].catalog_json2html3_onload,!1),n},catalog_json2html3_onload:function(){this.removeEventListener("load",site2["4chan"].catalog_json2html3_onload,!1),this.tn_w&&this.tn_h||site2["4chan"].catalog_json2html3_size_changed(this),this.removeAttribute("class")},catalog_json2html3_size_changed:function(e){var t=e.naturalWidth,a=e.naturalHeight,n=(t>a?t:a)/("small"===site2["4chan"].catalog_native_size?150:250);e.setAttribute("width",t/n),e.setAttribute("height",a/n)},favicon:{__proto__:site2.vichan.favicon,none:"/favicon.ico",reply:"png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAoUlEQVQ4T61TwRGAMAiTmexMDuVMOlM1XOEoAj60L20gDUlLy8dF6Kd+dM/TqTEmK6shAe4GW8zfQlLVMAGat2NVgr2dUDWJymomBRlJdUCoAEdbFZ7A4qEHw9jHCM5U/k1TiEyMkiqj8ikIgY1YCXxUUQp2NCW3F8malZno9kk9qKLKMKj4nwAScaGiETw2KRix8RWG5MhEjynB24usXusFrlPCCCmAi/UAAAAASUVORK5CYII=",reply_to_me:"png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAvUlEQVQ4T61TXRrDIAiDXWmeabvTzlSvVGb8hFIK3ct8aeUnJkSZxmLZBF+/hBvHWLafRQDY6Wn5B3WKANUhrIkIADQF0Zqxt0NGbP5PACREDhXMDFZREr22g+Wn9VmTMnj3RlqwmKTNJYNfAGi8MPD61mAvEnzAZlDZmA0xs7q08Q7AW5wCVC54aWaxl4A5qFWVCyE+DF830Tf7Kd/ZCBb/BwBFyMgkxNyJgVKFv5CTXeWYM4DqLsTHlD33Lx2GzAg15eTiAAAAAElFTkSuQmCC"}},site2.meguca1={nickname:"meguca",protocol:"https:",home:"https://meguca.org/favicon.ico",domain_url:"meguca.org",domain_url_image:"meguca.org",features:{page:!1,graph:!1,setting2:!1,thread_reader:!1},components:{boardlist:"#navTop"},pref_default:{catalog:{image_hover:!0}},boards_json:{boards:[{board:"a"},{board:"an"},{board:"cr"},{board:"g"},{board:"v"}]},check_func:function(){var e=window.location.href;return e.indexOf("/meguca.org/")!=-1?(site.whereami=e.indexOf("/catalog")!=-1?"catalog":e.search(/page[0-9]/)!=-1?"page":e.search(/[0-9]+$/)!=-1?"thread":"other",site.config("meguca.org",this.nickname),site.max_page=3,site.header_height=function(){var e=document.getElementById("banner");return e?e.offsetHeight:0},!0):(this.prep_own_posts(),!1)},make_url4:function(e){var t=this.protocol+"//"+this.domain_url;return"page_json"===e[3]&&0==e[2]&&(e[3]="catalog_json"),"page_html"===e[3]?[t+(0!=e[2]?parseInt(e[2],10)+1:""),"html"]:"catalog_json"===e[3]?[t+"/api/board"+e[1].substr(0,e[1].length-1),"json"]:"thread_html"===e[3]?[t+e[1]+e[2],"html"]:"thread_json"===e[3]?[t+"/api/thread/"+e[2],"json"]:void 0},catalog_get_native_area:function(){return"catalog"===site.whereami?document.getElementById("catalog"):document.getElementsByName("postcontrols")[0]},catalog_native_prep:function(e,t,a,n){var r="catalog"===site.whereami?document.getElementsByTagName("threads")[0].getElementsByTagName("aside")[0]:document.getElementsByName("postcontrols")[0];if(site4.tb_prep_for_embed(a),"catalog"===site.whereami){for(var o=document.createElement("span");a.firstChild;)o.appendChild(a.firstChild);a=o,a.appendChild(a.removeChild(a.childNodes[3]).firstChild),a.setAttribute("style","float:right")}else if("page"===site.whereami){var s=document.getElementsByName("postcontrols")[0];s.parentNode.insertBefore(document.createElement("hr"),s.nextSibling)}site.whereami,r.parentNode.insertBefore(a,r),r.parentNode.insertBefore(t,document.getElementById("catalog"));var i=t.getElementsByTagName("select")["catalog.indexing"];i.setAttribute("style","float:left"),"catalog"===site.whereami?r.parentNode.insertBefore(i,r):a.childNodes[3].insertBefore(i,a.childNodes[3].firstChild),r.setAttribute("style","float:left"),r.parentNode.insertBefore(a.childNodes[3],r.nextSibling)},catalog_json2html3:function(e,t,a){var n=document.createElement("article"),r=site2[e.domain].make_url4([e.domain,e.board,e.no,"thread_html"])[0],o=e.tn_w||e.posts[0].tn_w,s=e.tn_h||e.posts[0].tn_h,i=150/(o>s?o:s),l=site2[e.domain].historyAPI&&pref.pref2.meguca.historyAPI?"history":"",c=l+" "+pref.script_prefix+"_link",p=site2[e.domain].short_link(e.key,e.nof_posts,1,"Last ","");return n.innerHTML='<a target="_blank" rel="nofollow" href="'+r+'"'+(l?' class="'+l+'"':"")+'><img src="'+a+'" width="'+o*i+'" height="'+s*i+'" class="expanded"></a><br><small><span title="Replies/Images">'+(e.nof_posts-1)+"/"+(e.nof_files-1)+'</span><span class="act expansionLinks"><a href="'+r+'" class="'+c+'">Expand</a>'+(p?"] ["+p:"")+"</span></small><br>"+(e.sub?"<h3>"+e.sub+" </h3>":"")+(e.com?e.com:""),n},mark_newer_posts:function(e,t,a,n){return site2.DEFAULT.mark_newer_posts("meguca",e.getElementsByTagName("article"),t,null,a,n)},prep_own_posts_event:function(e){e&&"mine"===e.key&&site2.meguca.prep_own_posts(),"meguca"===window.name&&send_message("parent",[["OWN_POSTS",window.name,site3[window.name].own_posts.ALL]])},prep_own_posts_event_received:function(e){site3[this.nickname].own_posts.ALL=e},prep_own_posts:function(e){if(!site3[this.nickname].own_posts.ALL){site3[this.nickname].own_posts.ALL={};for(var t=["/a/","/an/","/cr/","/g/"],a=0;a<t.length;a++)site3[this.nickname].own_posts[t[a]]=Object.create(site3[this.nickname].own_posts.ALL)}if(localStorage){var n=JSON.parse(localStorage.mine||"{}");for(var r in n)site3[this.nickname].own_posts.ALL[r]=null}},wrap_to_parse:{get:site2.DEFAULT.wrap_to_parse.get,posts:function(e){delete Object.getPrototypeOf(e.posts[0]).com}},short_link:function(e,t,a,n,r){var o=this.make_url4(common_func.name2dbt(e))[0],s=pref.script_prefix+"_link";return(!a||a>1?'<a href="'+o+'?last=50" class="'+s+'">'+n+"50"+r+"</a>":"")+'<a href="'+o+'?last=100" class="'+s+'">'+n+"100"+r+"</a>"},catalog_json2html3_src:function(e){return e.image?"/static/src/"+e.image.src:void 0},catalog_json2html3_thumbnail:function(e){return e.image?"/static/"+(void 0===e.image.spoiler||pref[cataLog.embed_mode].open_spoiler_image?void 0!==e.image.thumb?"thumb/"+e.image.thumb:"src/"+e.image.src:"spoil/spoilers"+e.image.spoiler+".png"):void 0},post_json2html_fname_server:function(e){return e.image?e.image.src:void 0},post_json2html_fname:function(e){return e.image?e.image.imgnm:void 0},popups_href2dbtp:function(e,t,a){"#"===e[0]&&a&&(e=a.board+e,t.setAttribute("href",e));var n=e.split(/[\/#]/),r=n[n.length-1],o=n[n.length-2];return["meguca","/"+n[n.length-3]+"/",o,r]},link_dbtp2href:function(e){return e[1]+e[2]+"#"+e[3]},time_offset:-5,parse_funcs:{post_json:{get no(){return this.num},get sub(){return this.subject},name:"Anonymous",get txt(){return this.body},get com(){return this.body?this.body.replace(this.anchor_regex,this.anchor_func):""},get filename(){return this.image?this.image.imgnm:void 0},get w(){return this.image?this.image.dims[0]:void 0},get h(){return this.image?this.image.dims[1]:void 0},get tn_w(){return this.image?void 0===this.image.spoiler||pref[cataLog.embed_mode].open_spoiler_image?this.image.dims[2]:250:void 0},get tn_h(){return this.image?void 0===this.image.spoiler||pref[cataLog.embed_mode].open_spoiler_image?this.image.dims[3]:250:void 0},get fsize(){return this.image?this.image.size:void 0},get ext(){return this.image?this.image.ext:void 0},domain:"meguca",get domain_html(){return site.nickname},get parse_funcs_html(){return site2[site.nickname].parse_funcs[site.whereami+"_html"]},anchor_regex:/(>>)([0-9]+)/g,pn:void 0},thread_json:{ths:function(e,t){for(var a={board:t.board,anchor_func:function(){var e=['<a href="'+t.board+t.thread+"#",'">&gt;&gt;',"</a>"];return function(t,a,n){return e[0]+n+e[1]+n+e[2]}}(),get com(){return this.body},__proto__:site2[t.domain].parse_funcs.post_json},n=0;n<e.length&&void 0===e[n].state;)e[n++].__proto__=a;return n!==e.length&&e.splice(n,e.length-n),[{posts:e,nof_posts:e.length,key:t.domain+t.board+t.thread,no:t.thread,__proto__:t}]},get_op_src:function(e){
return site2[e.domain].protocol+"//"+site2[e.domain].domain_url+"/static/src/"+e.posts[0].image.src},op_img_url:function(e){return site2[e.domain].protocol+"//"+site2[e.domain].domain_url+"/static/"+site2.meguca.catalog_json2html3_thumbnail(e.posts[0])},nof_files:function(e){return e.posts[0].imgctr-1},time:function(e){return e.posts[0].time},time_posted:function(e){return e.posts[e.posts.length-1].time},time_created:function(e){return e.posts[0].time},time_bumped:function(e){for(var t=e.posts.length-1;t>0;){if(!e.posts[t].email||"sage"!==e.posts[t].email)return e.posts[t].time;t++}return e.posts[0].time},sticky:function(e){return!1},com:function(e){return e.posts[0].body},sub:function(e){return e.posts[0].sub},name:function(e){return e.posts[0].name},filename:function(e){return e.posts[0].image.imgnm},type_com:"txt",time_unit:1,add_op_img_url:function(e,t,a){for(var n=0;n<e.length;n++)e[n].image&&(e[n].op_img_url=site2[a].protocol+"//"+site2[a].domain_url+"/static/thumb/"+e[n].image.thumb)},footer:"catalog_html",footer_clear:"catalog_html",proto:"DEFAULT.thread_json"},catalog_html:{footer:function(e){return e.pn.getElementsByClassName("counters")[0]},footer_clear:function(e){e.footer.textContent=""},ths:function(e){if(!pref.pref2.meguca.historyAPI)for(var t=e.pn.getElementsByClassName("history"),a=t.length-1;a>=0;a--)"Expand"===t[a].textContent||"Last 100"===t[a].textContent?t[a].setAttribute("class",pref.script_prefix+"_link"):t[a].removeAttribute("class");var n=this.ths_array(e,e.pn.getElementsByTagName("article"));if("/all/"===site.board)for(var a=n.length-1;a>=0;a--)n[a].board=n[a].pn.getElementsByTagName("a")[0].getAttribute("href").replace(/\d+$/,"");return n},no:function(e){return e.pn.getElementsByTagName("a")[0].getAttribute("href").replace(/.*\//g,"")},time_bumped:function(e){},time_created:function(e){},nof_posts:function(e){return parseInt(e.footer.textContent.split("/")[0],10)},nof_files:function(e){return parseInt(e.footer.textContent.split("/")[1],10)},sub:function(e){var t=e.pn.getElementsByTagName("h3")[0];return t?common_func.escape(t.textContent):void 0},name:function(e){},com:function(e){return e.pn.childNodes[e.pn.childNodes.length-1].textContent},sticky:function(e){return!1},op_img_url:function(e){var t=e.pn.getElementsByTagName("img")[0];return t&&t.getAttribute("src")||""},get_op_src:function(e){return e.op_img_url.replace(/thumb/,"src")},dynamic_image_hover:!0,missing_info:1,img2src:function(e,t){if(t||(t=this.get_lth_from_node(e)),!t)return null;var a=e.src;return t.th&&t.th.posts[0].ext?a=a.replace(/thumb/,"src").replace(/\.\w+$/,t.th.posts[0].ext):t.th.parse_funcs.missing_info&&scan.scan_ui("image_hover",{tgts:[t.key],options:{callback:function(){cataLog.image_hover_reentry(e)},priority:6}}),a}},post_html:{time_pn:function(e){var t=e.getElementsByTagName("time")[0];return Date.parse(t.title||t.textContent)+36e5*(pref.localtime_offset-site2.meguca.time_offset)},pn_name:function(e){return e.pn.getElementsByClassName("name")[0]}}},general_event_handler:{catalog:{mouseover:function(e){var t=e.target;"IMG"===t.tagName&&pref[cataLog.embed_mode].image_hover&&"A"===t.parentNode.tagName&&cataLog.image_hover_add.call(t,e)},__proto__:site2.DEFAULT.general_event_handler.catalog}},favicon:{__proto__:site2.vichan.favicon,none:"/static/favicon.ico",reply:"/static/css/ui/unreadFavicon.ico",reply_to_me:"/static/css/ui/replyFavicon.ico"}},site2.meguca2={home:"https://meguca.org/assets/favicons/default.ico",components:{boardlist:"#banner"},boards_json:void 0,check_func:function(e){var t=window.location.href;if(t.indexOf("/meguca.org/")!=-1){if(site.whereami=t.search(/[A-z]+\/(\?page=\d+)*$/)!=-1?"page":t.search(/[0-9]+(\?last=\d+)*$/)!=-1?"thread":t.search(/catalog\/*$/)!=-1?"catalog":"other",site.config("meguca.org",this.nickname,e),site.no="thread"===site.whereami?parseInt(t.replace(/.*meguca\.org\/\w*\/([0-9]+)/,"$1"),10):"","page"===site.whereami){var a=t.indexOf("?page=");site.page=a!=-1&&parseInt(t.substr(a+6),10)||0}else site.page=null;if(e)return;return site.max_page=3,site.header_height=function(){var e=document.getElementById("banner");return e?e.offsetHeight:0},!0}return!1},check_func_whereami:function(){},utilize_boards_json:!0,url_boards_json:function(){return["https://meguca.org/json/boardTimestamps","json"]},postprocess_board:function(e){var t=0;for(var a in e){var n=liveTag.mems.init({domain:this.nickname,board:"/"+a+"/"});n.o=t++,Object.defineProperty(n,"max",{value:e[a],writable:!0}),void 0===n.read_max&&Object.defineProperty(n,"read_max",{value:0,writable:!0})}},make_url4:function(e){var t=this.protocol+"//"+this.domain_url;return"page"===e[3].substr(0,4)&&0==e[2]&&(e[3]="catalog_json"),"catalog_json"===e[3]?[t+"/json"+e[1],"json","meguca"+e[1]+"j0"]:"thread_html"===e[3]?[t+e[1]+e[2],"html"]:"thread_json"===e[3]?[t+"/json"+e[1]+e[2],"json"]:void 0},catalog_get_native_area:function(){return document.getElementById("catalog"===site.whereami?"catalog":"page"===site.whereami?"index-thread-container":"threads")},catalog_get_native_scroll_area:function(){return"catalog"===site.whereami?document.getElementsByTagName("section")[1]:window},catalog_native_prep_wait_loop_timeout:100,catalog_native_prep_wait_loop:function(e,t){--this.catalog_native_prep_wait_loop_timeout<0||(("catalog"!==e||document.getElementsByName("sortMode")[0])&&("page"!==e||document.getElementById("catalog-controls")&&document.getElementById("index-thread-container"))&&("thread"!==e||document.getElementById("expand-images")&&document.getElementById("threads"))?t():setTimeout(function(){this.catalog_native_prep_wait_loop(e,t)}.bind(this),1e3))},catalog_native_prep:function(e,t,a,n){var r="catalog"===site.whereami?document.getElementsByName("sortMode")[0]:"page"===site.whereami?document.getElementById("catalog-controls").getElementsByTagName("input").search:document.getElementById("expand-images");if("catalog"!==site.whereami||r.nextSibling!==cataLog.components.catalog.indexing){if(a.childNodes[3]&&a.childNodes[3].ondblclick&&site4.tb_prep_for_embed(a),!cataLog.components.initialized){for(var o=document.createElement("span");a.firstChild;)o.appendChild(a.firstChild);a=o,a.setAttribute("style","float:right"),a.setAttribute("style","float:right"),cataLog.components.pn12_0=a,cataLog.components.pn_hi=a.removeChild(a.childNodes[3]).firstChild;var s=function(){cataLog.catalog_obj2.func_track_reset(),cataLog.insert_myself(!0),cataLog.show_catalog()},i=function(e){c.disconnect()};window.addEventListener("focus",i,!1);var l=function(e){pref[site.whereami].embed&&(c.disconnect(),cataLog.general_event_handler.destroy(),cataLog.triage_parent_set(),cataLog.general_event_handler=new cataLog.GEH(cataLog.parent),cataLog.general_event_handler.init(),s(),site2.meguca.catalog_native_prep(null,t,a),p())},c=new MutationObserver(l),p=function(){c.observe(document.getElementById("threads"),{childList:!0})};window.addEventListener("blur",p,!1);var _=document.getElementById("loading-image"),d="none"!==_.style.display,u=function(e){if("none"!==e[0].target.style.display)site2.meguca.historyAPI_blocking=!0,"thread"===site.whereami&&site2.meguca.prep_own_posts();else{if(site2.meguca.historyAPI_blocking=!1,!d){cataLog.image_hover_remove(),cataLog.general_event_handler.destroy();for(var n in cataLog.threads)cataLog.remove_thread(n,!0);site2.meguca.check_func(!0),pref[site.whereami].embed&&(cataLog.set_embed_xxxx(),cataLog.triage_parent_set(),cataLog.general_event_handler=new cataLog.GEH(cataLog.parent),cataLog.general_event_handler.init(),"catalog"!==site.whereami&&"page"!==site.whereami||pref.test_mode[90]||s(),site2.meguca.catalog_native_prep(null,t,a)),recovery.reentry(),receive_message_emu()}d=!1}};new MutationObserver(u).observe(_,{attributes:!0})}if("catalog"===site.whereami?(r.parentNode.appendChild(a),r.parentNode.parentNode.insertBefore(cataLog.components.pn_hi,r.parentNode)):(r.parentNode.insertBefore(a,r),r.parentNode.insertBefore(cataLog.components.pn_hi,r)),"catalog"===site.whereami){var f=document.getElementById("catalog");f.parentNode.insertBefore(t,f)}else r.parentNode.insertBefore(t,document.getElementById("catalog"));"catalog"===site.whereami?site2.DEFAULT.catalog_native_prep_swap_sortSel(r):r.parentNode.insertBefore(cataLog.components.catalog.indexing,r.nextSibling),"catalog"!=site.whereami&&"page"!=site.whereami||(document.getElementById("banner").style="height:auto",pref3.catalog.filter.kwd.init(document.getElementById("catalog-controls").getElementsByTagName("input").search,t)),cataLog.components.initialized=!0}},post_json2html:site2["4chan"].post_json2html,page_json2html3_skelton:site2["4chan"].page_json2html3_skelton,page_json2html3:site2["4chan"].page_json2html3,page_json2html3_replace_expander:site2["4chan"].page_json2html3_replace_expander,page_json2html3_add_omitted_info:site2["4chan"].page_json2html3_add_omitted_info,post_container:site2["4chan"].post_container,wrap_to_parse:site2.DEFAULT.wrap_to_parse,catalog_json2html3_thumbnail:function(e){return e.image?this.protocol+"//"+this.domain_url_image+(void 0===e.image.spoiler||pref[cataLog.embed_mode].open_spoiler_image?"/images/thumb/"+e.image.SHA1+(0===e.image.thumbType||void 0===e.image.thumbType&&0===e.image.fileType?".jpg":".png"):"/spoil/default.jpg"):void 0},catalog_json2html3_src:function(e){return e.image?this.protocol+"//"+this.domain_url_image+"/images/src/"+e.image.SHA1+(e.ext||Object.getOwnPropertyDescriptor(this.parse_funcs.post_json_template,"ext").get.call(e)):void 0},post_json2html_fname_server:function(e){return e.image?e.image.SHA1+(0===e.image.fileType?".jpg":".png"):void 0},post_json2html_fname:function(e){return e.image?e.filename+e.ext:void 0},parse_funcs:{page_html:{get_omitted_info:site2["4chan"].parse_funcs.page_html.get_omitted_info,set_omitted_info:site2["4chan"].parse_funcs.page_html.set_omitted_info,replace_omitted_info:site2["4chan"].parse_funcs.page_html.replace_omitted_info,replace_omitted_info2:site2["4chan"].parse_funcs.page_html.replace_omitted_info2},thread_json:{ths:function(e,t){var a=this.prep_th_posts(e);return a.nof_posts=a.posts.length,e.__proto__=t,pref.catalog.filter.kwd.post&&site2.DEFAULT.wrap_to_parse.posts(a),[a]},prep_th_posts:function(e){var t=Object.create(e);t.sticky&&(t.sticky=!0),t.board="/"+e.board+"/",e.no=e.id,delete e.id;var a=[e];if(e.posts)for(var n=0;n<e.posts.length;n++){var r=e.posts[n];r.id&&(r.no=r.id,delete r.id),a[a.length]=r}return t.posts=a,t},get_op_src:function(e){return site2[e.domain].catalog_json2html3_src(e.posts[0])},op_img_url:"DEFAULT.common",time_unit:1e3,type_com:"txt",posts_full:null,has_editing:!0,posts_obj:function(e,t){for(var a={},n=e.posts.length;--n>=0;){var r=e.posts[n].no;if(a[r]=e.posts[n],r===t)break}return e.posts_obj=a,a[t]},key:"DEFAULT.common"},catalog_json:{ths:function(e,t){var a=[],n=parseInt(t.page||0,10);e.threads&&(e=e.threads);for(var r=0;r<e.length;r++){var o=this.prep_th_posts(e[r]);o.page=n+Math.floor(r/15)+"."+r%15,e[r].__proto__=t,a[a.length]=o}return a},has_posts:!0,proto:"thread_json"},shortCatalog_json_template:{proto:"catalog_json_template"},page_json_template:{proto:"catalog_json_template"},catalog_json_template:{dont_have_com:!0,get nof_posts(){return this.postCtr},proto:"thread_json_template"},thread_json_template:{get time_posted(){return 1e3*this.replyTime},get time_bumped(){return 1e3*this.bumpTime},get time_created(){return 1e3*this.time},get nof_files(){return this.imageCtr},get com(){return this.body},proto:"post_json_template"},post_json:{anchor:function(e,t,a,n,r){return r||(r=(n?"/all/":e)+"#p"+a),'<em><a class="history post-link" data-id="'+a+'" href="'+r+'">&gt;&gt;'+a+'</a><a class="hash-link history" href="'+r+'"> #</a> </em>'}},post_json_template:function(){var e=["jpg","png","gif","webm","pdf","svg","mp4","mp3","ogg","zip","7z","tar.gz","tar.xz"];return{get filename(){return this.image?this.image.name:void 0},get w(){return this.image?this.image.dims[0]:void 0},get h(){return this.image?this.image.dims[1]:void 0},get tn_w(){return this.image?void 0===this.image.spoiler||pref[cataLog.embed_mode].open_spoiler_image?this.image.dims[2]:150:void 0},get tn_h(){return this.image?void 0===this.image.spoiler||pref[cataLog.embed_mode].open_spoiler_image?this.image.dims[3]:150:void 0},get fsize(){return this.image?this.image.size:void 0},get ext(){return this.image?"."+e[this.image.fileType]:void 0},get sub(){return this.subject?common_func.escape(this.subject):""},get capcode(){return this.auth},get md5(){return this.image?this.image.MD5:void 0},get sha1(){return this.image?this.image.SHA1:void 0},name:"Anonymous",get txt(){return this.body},get com(){function e(e,t,a){for(var n=r.links,s=0;s<n.length&&n[s][0]!=a;)s++;return s>=n.length?e:o(r.board,n[s][1],a,r.op!=n[s][1],null)}function t(e){return"<strong>"+e+" ("+(this[a]?this[a++].val:"")+")</strong>"}var a,n=site2[site.nickname].parse_funcs.post_html.txt2com_anchor_class?'" class="'+site2[site.nickname].parse_funcs.post_html.txt2com_anchor_class:"",r=null,o="meguca"===site.nickname?site2.meguca.parse_funcs.post_json.anchor:function(e,t,a,r){return'<a href="'+(r?"/cross/":e)+t+"#p"+a+n+'">&gt;&gt;'+a+"</a>"},s=site2[site.nickname].parse_funcs.post_html.txt2com_spoiler_replace_txt||"<spoiler>$1</spoiler>",i="meguca"===site.nickname?"<em>$1</em>":'<span class="quote">$1</span>';return Object.defineProperty(site2.meguca.parse_funcs.post_json_template,"com",{get:function(){if(!this.body)return"";var n=common_func.escape_text(this.body);return this.links&&(r=this,n=n.replace(/(>>)([0-9]+)/g,e)),n=n.replace(/(^>[^>].*$)/gm,i),n=n.replace(/\*\*(.*?)((\*\*)|$)/gm,s),this.commands&&(a=0,n=n.replace(/^#(pyu|flip|\d*d\d+|8ball)$/gm,t.bind(this.commands))),n=n.replace(/(https*:\/\/[^\s]*)(\s|$)/gm,'<a href="$1" target="_blank">$1</a>$2'),n.replace(/\n/g,"<br>")},enumerable:!0,configurable:!0}),this.com},sticky:!1,pn:void 0,get no(){return this.id},time:void 0,flag:void 0,flags:void 0,get parse_funcs_html(){return Object.defineProperty(site2.meguca.parse_funcs.post_json_template,"parse_funcs_html",{value:site2[site.nickname].parse_funcs[site.whereami+"_html"],writable:!0,enumerable:!0,configurable:!0}),this.parse_funcs_html},proto:"DEFAULT.common"}}()},mimic_always:!0,post_com2txt:function(e){return e.body?e.body.replace(/\*\*([^(\*\*)\n]*)((\*\*)|$)/gm," $1 "):""},proto:"meguca1"},common_func.Object_modifyDescriptor(site2.meguca2,"check_func",{writable:!1}),site2.meguca={domain_url_image:"images.meguca.org/assets",check_func:site2.meguca2.check_func,url_boards_json:function(){return["https://meguca.org/json/board-list","json"]},postprocess_board:function(e){for(var t=0;t<e.length;t++){var a=liveTag.mems.init({domain:this.nickname,board:"/"+e[t].id+"/"});a.o=t,e[t].tags&&0!=e[t].tags.length&&liveTag.postprocess_board_add_btag(e[t].tags,a)}},utilize_boards_json:!1,pref_default:{pref2:{meguca:{utilize_boards_json:!1,utilize_boards_json_domain:!1}},catalog:{auto_load_filter:!0,auto_save_filter:!0,auto_save_filter_at_refresh:!0},thread:{env:{disp_offset:3}},scan:{max:100},liveTag:{use:!1,from:"op"},virtualBoard:{max:100,scan:!0,scan_domains:{meguca:"board"}},network:{fetch_actively:!1},easy2:{presets:1,VB:{local:1},catalog:{auto_update:!1},page:{auto_update:!1}},proto:{env:{event_dynamic:!0}}},catalog_get_native_scroll_area:void 0,make_url4:function(e){var t=this.protocol+"//"+this.domain_url;return"catalog_json"===e[3]?[t+"/json/boards"+e[1]+"catalog","json"]:"page_json"===e[3]?[t+"/json/boards"+e[1]+"?page="+e[2],"json"]:"thread_html"===e[3]?[t+e[1]+e[2],"html"]:"thread_json"===e[3]?[t+"/json/boards"+e[1]+e[2],"json"]:void 0},historyAPI:!1,historyAPI_blocking:!1,short_link:function(e,t,a,n,r){return'<a href="'+this.make_url4(common_func.name2dbt(e))[0]+'?last=100" class="history lastN-link '+pref.script_prefix+'_link">'+n+"100"+r+"</a>"},wrap_to_parse:{get:site2.DEFAULT.wrap_to_parse.get,posts:function(e,t){site2.DEFAULT.wrap_to_parse.posts(e,t,{op:e.no||e.id})}},lth_init:function(e){liveTag.mems.init({board:"/cross/",domain:e.domain}),Object.defineProperty(liveTag.mems.meguca,"/cross/",{value:liveTag.mems.meguca["/cross/"],configurable:!0,enumerable:!1,writable:!0})},prep_own_posts:function(e){window.opener&&"meguca"===window.name?setTimeout(this.prep_own_posts_IDB.bind(this),0):this.prep_own_posts_IDB()},prep_own_posts_IDB:function(e){IDB.req_raw("meguca","meguca","mine",null,this.prep_own_posts_IDB_callback.bind(this),"get_all")},prep_own_posts_IDB_callback:function(e,t,a,n){var r={};for(var o in n)r[n[o].id]=null;site3[this.nickname].own_posts={ALL:r},window.opener&&"meguca"===window.name&&this.prep_own_posts_event()},popups_post_pnode:function(e){for(;"ARTICLE"!==e.tagName&&e.parentNode;)e=e.parentNode;return e},backlink_class:"backlinks",add_backlinks_pn:function(e,t){var a=e.getElementsByClassName("backlinks")[0];return a?{pn:a,hrefs:this.add_backlinks_hrefs(a,t)}:(a=document.createElement("span"),a.setAttribute("class","spaced backlinks"),e.appendChild(a),{pn:a,hrefs:{}})},add_backlinks_hrefs:function(e,t){var a={};if(t)for(var n=e.getElementsByTagName("a"),r=0;r<n.length;r++)a[n[r].getAttribute("href")]=null;else e.innerHTML="";return a},add_backlinks_add_1:function(e,t,a){var n=document.createElement("span");n.innerHTML=site2.meguca.parse_funcs.post_json.anchor(t[1],t[2],t[3],null,a),n=n.childNodes[0],("meguca"!==t[0]||pref.test_mode[91])&&(n.childNodes[0].onclick=this.backlink_onclick,n.childNodes[1].onclick=this.backlink_onclick,n.childNodes[0].onmouseover=this.popups_post_entry,n.childNodes[1].onmouseover=this.popups_post_entry),e.pn.appendChild(n)},add_backlinks:function(e,t,a){for(var n=this.add_backlinks_pn(e,a),r=a||0;r<t.length;r++){var o=t[r].split(/[\/#]/),s=o[0];o[1]="/"+o[1]+"/";var i=site2[s].link_dbtp2href(o);if(s!==site.nickname&&(i=site2[s].absolute_link_1(i)),null!==n.hrefs[i]&&this.add_backlinks_add_1(n,o,i),a)break}},popups_href2dbtp:function(e,t,a){"#"===e[0]&&a&&(e=a.board+a.no+e,t.setAttribute("href",e));var n=e.split(/[\/#]/),r=n[n.length-1].substr(1),o="/"+n[n.length-3]+"/",s=n[n.length-2];return s||(s=-1),["meguca",o,s,r]},link_dbtp2href:function(e){return e[1]+e[2]+"#p"+e[3]},popups_post_fetch:function(e,t){httpd.req({initiator:"popup",tgts:[{url:"https://meguca.org/json/post/"+t[3],responseType:"json",tgt:t[0]+"/*/"+t[2]+"#"+t[3],data_type:"json",domain:e.domain}],callback_1:site2[e.domain].popups_post_fetch_callback.bind(site2[e.domain]),IDX:0,FINISHED:0,SUC:0,max:1,dbt:t},8)},popups_post_fetch_callback:function(e,t,a){var n={domain:a.dbt[0],board:a.dbt[1],no:a.dbt[2],type_data:"json",domain_html:site.nickname,key:a.dbt[0]+a.dbt[1]+a.dbt[2]};delete t.response.board;var r={posts:[n,t.response],__proto__:n};site2[r.domain].wrap_to_parse.posts(r);var o=liveTag.mems.init(r);this.popups_fetched(r,o,1)},post_json2html_imagesearch_href:{google:function(e){return"https://www.google.com/searchbyimage?image_url="+e},iqdb:function(e){return"http://iqdb.org/?url="+e},saucenao:function(e){return"http://saucenao.com/search.php?db=999&amp;url="+e},whatAnime:function(e){return"https://whatanime.ga/?url="+e},desustorage:function(e){return"https://desuarchive.org/_/search/image/"+e},exhentai:function(e){return"http://exhentai.org/?fs_similar=1&amp;fs_exp=1&amp;f_shash="+e}},post_json2html_imagesearch_1:function(e,t,a){return'<a class="image-search '+e+'" target="_blank" rel="nofollow" href="'+this.post_json2html_imagesearch_href[e](t)+'">'+a+"</a>"},post_json2html_imagesearch:function(e,t,a,n){return(e.google?this.post_json2html_imagesearch_1("google",t,"G"):"")+(e.iqdb?this.post_json2html_imagesearch_1("iqdb",t,"Iq"):"")+(e.saucenao?this.post_json2html_imagesearch_1("saucenao",t,"Sn"):"")+(e.whatAnime?this.post_json2html_imagesearch_1("whatAnime",t,"Wa"):"")+(e.desustorage&&a?this.post_json2html_imagesearch_1("desustorage",a,"Ds"):"")+(e.exhentai&&n?this.post_json2html_imagesearch_1("exhentai",n,"Ex"):"")},post_json2html:function(e,t,a,n,r){var o=document.createElement("div"),s=e.parse_funcs&&e.parse_funcs.time_unit||1,i=new Date((e.time||0)*s),l=(e.name,""),c="";if(e.ext){var p=(.005+(e.fsize>1048576?e.fsize/1048576:e.fsize/1024)).toString();p=p.substr(0,p.indexOf(".")+3)+(e.fsize>1048576?" MB":" KB");var _=site2[e.domain].catalog_json2html3_src(e,t),d=site2[e.domain].catalog_json2html3_thumbnail(e,t);a||(e.tn_w>e.tn_h?e.tn_w:e.tn_h);l='<figcaption class="spaced"><a class="image-toggle act" hidden=""></a>'+(pref[cataLog.embed_mode].imagesearch.use?'<span class="spaced image-search-container">'+this.post_json2html_imagesearch(pref[cataLog.embed_mode].imagesearch,_,e.md,e.sha1)+"</span>":"")+'<span class="fileinfo"><span class="filesize">'+p+'</span><span class="dims">'+e.w+"x"+e.h+'</span></span><a href="'+("meguca"===e.domain?_.replace(/images\.meguca\.org/,"meguca.org"):_)+'" download="'+e.filename+e.ext+'">'+e.filename+e.ext+"</a></figcaption>",c='<figure><a target="_blank" href="'+_+'"><img src="'+d+'" width="'+e.tn_w+'" height="'+e.tn_h+'"></a></figure>'}return o.innerHTML='<article id="p'+e.no+'" class="glass'+(e.ext?" media":"")+'"><input type="checkbox" class="deleted-toggle"><header class="spaced"><input type="checkbox" class="mod-checkbox hidden"><b class="name">'+e.name+"</b><time>"+site2.common.change_utc_to_local(i)+'</time><nav><a class="history" href="#p'+e.no+'">No.</a><a class="history quote" href="#p'+e.no+'">'+e.no+"</a></nav>"+(a?'<span><span class="act"><a class="history expand-link" href="'+t+e.no+'">Expand</a></span>'+(n?'<span class="act">'+n+"</span>":"")+"</span>":"")+'<a class="control"><svg xmlns="http://www.w3.org/2000/svg" width="8" height="8" viewBox="0 0 8 8"><path d="M1.5 0l-1.5 1.5 4 4 4-4-1.5-1.5-2.5 2.5-2.5-2.5z" transform="translate(0 1)"></path></svg></a></header>'+l+'<div class="post-container">'+c+"<blockquote>"+e.com+"</blockquote></div></article>",o.removeChild(o.childNodes[0])},post_container:function(e){return e},update_posts_remove:function(e,t,a){a.removeChild(e.posts[t].pn)},update_posts_insert:function(e,t,a,n,r){var o=n<t.length?t[n].pn:r.getElementsByTagName("aside")[0];e[a].pn||(e[a].pn=this.post_json2html(e[a],e[a].board));var s=e[a].pn;r.insertBefore(s,o)},page_json2html3_skelton:function(e,t){var a=document.createElement("section");return a.setAttribute("class","index-thread"),a.setAttribute("data-id",e.no),a.innerHTML='<input type="checkbox" class="deleted-toggle"><aside class="act posting glass"><a href="'+e.board+e.no+'?last=100#bottom">Reply</a></aside>',t?[a,a.childNodes[1]]:a},page_json2html3:function(e,t,a,n){var r=this.page_json2html3_skelton(e,!0),o=r[0],s=r[1],i=this.post_json2html(e.posts&&e.posts[0]?e.posts[0]:e,t,!0,site2[e.domain].short_link(e.key,e.nof_posts,2,"Last ",""),e.no);if(o.insertBefore(i,s),!n&&e.posts[0].pn||(e.posts[0].pn=i),e.posts){for(var l=1;l<e.posts.length;l++){var c=this.post_json2html(e.posts[l],t);o.insertBefore(c,s),!n&&e.posts[l].pn||(e.posts[l].pn=c)}this.page_json2html3_add_omitted_info(e,e.posts,e.posts)}return o},page_json2html3_replace_expander:function(e,t,a){var n=this.parse_funcs.page_html.get_omitted_info(e[0]);n&&n.appendChild(cnst.config_expander(a,t))},page_json2html3_add_omitted_info:function(e,t,a){for(var n=0,r=0;r<a.length;r++)n+="html"===a[r].type_data?a[r].pn.getElementsByClassName("figure").length:a[r].filename?1:0;var o=e.nof_files-n,s=e.nof_posts-a.length,i=t?this.parse_funcs.page_html.get_omitted_info(t[0]):null;return 0!=s?(i||(i=document.createElement("span"),i.setAttribute("class","omit"),i.setAttribute("data-omit",s),i.setAttribute("data-image-omit",o),i.innerHTML=' <span class="act"><a href="'+a[0].no+'" class="history">See All</a></span>',("meguca"!==e.domain||pref[cataLog.embed_mode].use_expander_always)&&i.appendChild(cnst.config_expander(e.key)),t&&this.parse_funcs.page_html.set_omitted_info(t[0],i)),i.childNodes[0].textContent=s+(1==s?" post":" posts")+(o?" and "+o+" image"+(1!==s?"s":""):"")+" omitted "):i&&t&&t[0].pn.removeChild(i),i},catalog_json2html3:function(e,t,a){var n=document.createElement("article");n.id="p"+e.no,n.setAttribute("class","glass media"+(e.deleted?" deleted":"")),n.setAttribute("data-id",e.no);var r=site2[e.domain].make_url4([e.domain,e.board,e.no,"thread_html"])[0];if(a)var o=e.tn_w||e.posts[0].tn_w,s=e.tn_h||e.posts[0].tn_h,i=150/(o>s?o:s);var l=site2[e.domain].historyAPI&&pref.pref2.meguca.historyAPI?"history":"",c=l+(l?" ":"")+pref.script_prefix+"_link",p=site2[e.domain].short_link(e.key,e.nof_posts,1,"Last ","");return n.innerHTML='<input type="checkbox" class="deleted-toggle">'+(a?'<figure><a class="'+l+'" href="'+t+e.no+'"><img width="'+o*i+'" height="'+s*i+'" class="catalog" src="'+a+'"></a></figure>':"")+'<span class="spaced thread-links hide-empty"><b class="board">'+t+'</b><span class="counters" title="Posts/Images">'+(e.nof_posts-1)+"/"+(e.nof_files-1)+'</span><span class="act">'+("meguca"===e.domain?'<a class="'+l+' lastN-link" href="'+t+e.no+'?last=100">Last 100</a></span>':'<a href="'+r+'" class="'+c+' lastN-link">Expand</a>'+(p?"] ["+p:""))+"</span></span><br>"+(e.sub?"<h3>"+e.sub+" </h3>":"")+"<blockquote>"+(e.com?e.com:"")+"</blockquote>",n},mark_newer_posts:function(e,t,a,n,r){for(var o=r?[r]:site2.meguca.wrap_to_parse.get(document,"meguca",site.board,site.whereami+"_html","thread"===site.whereami?{thread:site.no}:null),s=null,i=o.length-1;i>=0;i--)s=o[i].posts[0].pn&&this.mark_newer_posts_posts(o[i].posts,t,a,n)||s;return s},parse_funcs:{shortCatalog_json:{has_posts:!1,proto:"meguca2.catalog_json"},catalog_json:{has_posts:!1},catalog_html:{ths_json:"thread_html",ths:function(e){for(var t=site2.meguca2.parse_funcs.catalog_html.ths(e),a=this.ths_json(e,t.map(function(e){return e.pn}),"shortCatalog_json","catalog_html"),n=0;n<a.length;n++)a[n].page=Math.floor(n/15)+"."+n%15;return a},get_omitted_info:function(){},set_omitted_info:function(){}},page_json:{proto:"meguca2.catalog_json"},post_json:{pn:"DEFAULT.post_json"},page_html:{ths:function(e){for(var t=this.ths_json(e,document.getElementsByClassName("index-thread"),"page_json","page_html"),a=0;a<t.length;a++)t[a].page=site.page+"."+a;return t},get_max_page:function(e){var t=e.getElementsByClassName("pagination")[0].childNodes.length;return t<=1?t:t-1},proto:"thread_html"},thread_html:{ths_json:function(e,t,a,n){var r=JSON.parse(e.pn.getElementById("post-data").innerHTML);r=site2.meguca.wrap_to_parse.get(r,"meguca",e.board,a);for(var o={},s=0;s<t.length;s++)o[t[s].dataset.id]=t[s];for(var s=0;s<r.length;s++){r[s].pn=o[r[s].no];var i=r[s].pn&&r[s].pn.getElementsByTagName("article");if(i){for(var l=0;l<r[s].posts.length;l++)r[s].posts[l].pn=i[l];Object.defineProperty(r[s],"footer",{value:this.footer(r[s]),configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(r[s],"type_mimic",{value:n,configurable:!0,enumerable:!0,writable:!0})}}return r[0].__proto__.__proto__.__proto__.parse_funcs_html=site2.meguca.parse_funcs[n],r},ths:function(e){return this.ths_json(e,[document.getElementById("thread-container")],"thread_json","thread_html")},footer:function(e){return site2.DEFAULT.parse_funcs.page_html.insert_footer4(e.pn.getElementsByClassName("deleted-toggle")[0])},get_thread_links:function(e){return e.pn.querySelectorAll(".expand-link,.lastN-link,."+pref.script_prefix+"_link")},get_omitted_info:function(e){return e.pn&&e.pn.getElementsByClassName("omit")[0]||void 0},set_omitted_info:function(e,t){t&&e.pn.appendChild(t)},replace_omitted_info:function(e,t){e.childNodes[0].textContent=t.childNodes[0].textContent},replace_omitted_info2:function(e,t,a){if(t)"none"===e.childNodes[1].style.display&&(e.insertBefore(e.childNodes[0].childNodes[0],e.firstChild),e.removeChild(e.childNodes[1]),e.childNodes[1].removeAttribute("style")),this.replace_omitted_info(e,t);else{var n=document.createElement("span");n.setAttribute("style","display:none"),e.insertBefore(n,e.childNodes[1]),n.appendChild(e.childNodes[0]),e.childNodes[1].setAttribute("style","display:none")}}}},favicon:{__proto__:site2.vichan.favicon,none:"/assets/favicons/default.ico",reply:"/assets/favicons/unread.ico",reply_to_me:"/assets/favicons/reply.ico"},proto:"meguca2"},common_func.Object_modifyDescriptor(site2.meguca,"check_func",{writable:!1}),site2.imeguca={nickname:"imeguca",domain_url:"images.meguca.org",home:"https://images.meguca.org/assets/favicons/default.ico",check_func:site2.DEFAULT.check_func},site2.lain={nickname:"lain",home:site.protocol+"//lainchan.org/q/index.html",X_FRAME_OPTIONS:!0,CONTENT_SECURITY_POLICY_FRAME:!0,protocol:"https:",domain_url:"lainchan.org",postform_rules:null,features:{page:!1,graph:!0,setting2:!1},pref_default:{page:{env:{disp_offset:1}},catalog:{image_hover:!0,board:{all_boards:!0},env:{disp_offset:1,disp_filler:"                                        "}},proto:{env:{localtime_native:!1,colorID_native:!1}},stats:{time_unit:3,estimate_posts:!1},chart:{inst:{show:{np:!1,p:!0},time_sel:3}},easy2:{limits:1}},boards_json:site2.DEFAULT.generate_boards_json([["λ",5],["diy",2],["sec",6],["tech",6],["inter",2],["lit",3],["music",3],["vis",3],["hum",3],["drg",3],["zzz",2],["layer",1],["q",7],["r",7]],3),check_func:function(){var e=window.location.href;return e.indexOf(this.domain_url)!==-1&&e.search(new RegExp(this.domain_url+"/*$"))==-1&&(site.whereami=e.indexOf("/catalog")!=-1?"catalog":e.indexOf("/res/")!=-1?"thread":document.getElementsByTagName("title")[0]&&"404"===document.getElementsByTagName("title")[0].textContent?"404":"page",site.config(this.domain_url,this.nickname),site.max_page=7,site.header_height=function(){var e=document.getElementsByClassName("boardlist")[0];return e?e.offsetHeight:0},site.myself="thread"===site.whereami?parseInt(e.replace(/.*res\//,"").replace(/\.html/,""),10):0,"thread"===site.whereami||"page"===site.whereami?(site.embed_to.top=document.getElementsByName("postcontrols")[0],site.embed_to.bottom=document.getElementsByTagName("footer")[0]):"catalog"===site.whereami&&(site.embed_to.top=document.getElementsByTagName("header")[0].nextSibling,site.embed_to.bottom=document.getElementsByTagName("footer")[0]),"thread"!==site.whereami&&"page"!==site.whereami||(site.postform=document.getElementsByTagName("form").post,site.postform&&this.postform_prep()),pref.thread_reader.own_posts_tracker=!0,"lain"===this.nickname&&(styleSheet.add_to_watch(document.getElementById("stylesheet")),styleSheet.add_to_watch(document.getElementById("code_stylesheet"))),!0)},catalog_posts_in_thread:function(e){return e.getElementsByClassName("replyContainer")},max_page:function(){return 10},all_boards:["/popular/","/all/","/mega/","/random/","/culture/","/psy/"],make_url4:function(e){return site2.lain.all_boards.indexOf(e[1])!=-1&&"catalog_html"!==e[3]?void 0:site2.vichan.make_url4.call(this,e)},catalog_native_prep:function(e,t,a,n){var r="catalog"===site.whereami?document.getElementsByClassName("threads")[0]:document.getElementsByName("postcontrols")[0];if(site4.tb_prep_for_embed(a),"catalog"===site.whereami){var o=document.getElementById("sort_by");if(0!=o.selectedIndex){o.selectedIndex=0;var s=document.createEvent("UIEvents");s.initUIEvent("change",!1,!0,window,1),o.dispatchEvent(s)}o.style.display="none",document.getElementById("image_size").addEventListener("change",site2.lain.catalog_native_size_changed,!1);for(var i=document.createElement("span");a.firstChild;)i.appendChild(a.firstChild);a=i;for(var l=a.removeChild(a.childNodes[3]);l.firstChild;)a.appendChild(l.firstChild);if("lain"===this.nickname)document.getElementsByClassName("controls")[0].appendChild(a);else{var c=document.getElementsByClassName("threads")[0];c.parentNode.insertBefore(a,c)}r.parentNode.insertBefore(t,r)}else{var p=document.getElementsByName("postcontrols")[0];if("lain"===this.nickname){var _=document.getElementsByClassName("blotter")[0],d=document.createElement("div");d.setAttribute("style","float:left"),d.appendChild(_.nextSibling.nextSibling),d.appendChild(_.nextSibling.nextSibling),"page"===site.whereami&&d.appendChild(document.createTextNode(" | ")),
_.parentNode.insertBefore(d,_.nextSibling.nextSibling),d.parentNode.insertBefore(t,d.nextSibling),d.parentNode.insertBefore(a,d.nextSibling)}else p.parentNode.insertBefore(t,p),p.parentNode.insertBefore(a,p)}var u=t.getElementsByTagName("select")["catalog.indexing"];"catalog"===site.whereami?o.parentNode.insertBefore(u,o):a.childNodes[3].insertBefore(u,a.childNodes[3].firstChild)},catalog_native_size:document.getElementById("image_size")?document.getElementById("image_size").value:"small",catalog_native_size_changed:function(){site2[site.nickname].catalog_native_size=this.value},parse_funcs:{catalog_html:{sticky:function(e){return!1},ths:function(e){var t=this.__proto__.ths(e);if(site2.lain.all_boards.indexOf(site.board)!=-1)for(var a=t.length-1;a>=0;a--)t[a].board="/"+t[a].pn.getAttribute("data-board")+"/";for(var a=0;a<t.length;a++)t[a].page=Math.floor(a/10)+"."+a%10;return t}},page_html:{ths:function(e){var t=this.__proto__.ths(e);if(site2.lain.all_boards.indexOf(site.board)!=-1){for(var a=t.length-1;a>=0;a--){var n=site.nickname+"/"+t[a].pn.getAttribute("data-board")+"/"+t[a].no;cataLog.threads[n]?t.splice(a,1):t[a].board="/"+t[a].pn.getAttribute("data-board")+"/"}0===t.length&&cataLog.show_catalog()}return t}},catalog_json:{time_unit:1e3},post_html:{img2src:function(e){var t=e.parentNode.href;return t.search(/.webm/)!=-1&&(t=t.replace(/.*player.php\?v=/,"").replace(/&t=.*/,"")),t}}},colorID:function(e){var t=e.getElementsByClassName("poster_id")[0];if(t&&t.style&&!t.style.backgroundColor){site2.vichan.colorID(e);var a=t.previousSibling;t.textContent="ID: "+t.textContent," ID: "===a.textContent&&(a.textContent="")}},catalog_json2html3_thumbnail:function(e,t){return".jpg"===e.ext||".jpeg"===e.ext||".gif"===e.ext||".png"===e.ext||".pdf"===e.ext?"https://"+this.domain_url+t+"thumb/"+e.tim+".png":".epub"===e.ext?"https://"+this.domain_url+"/static/lain_epub.jpg":""},catalog_from_json3:function(e,t){return site2[this.nickname].wrap_to_parse.get(e,this.nickname,t,"catalog_json")},favicon:{__proto__:site2.vichan.favicon,none:"/favicon.png",reply:"png;base64,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",
reply_to_me:"png;base64,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"},proto:"vichan"},site2.lainjp={nickname:"lainjp",home:site.protocol+"//lainchan.jp/lainicon.ico",X_FRAME_OPTIONS:!0,CONTENT_SECURITY_POLICY_DATAURI:!0,CONTENT_SECURITY_POLICY_FRAME:!0,protocol:"https:",domain_url:"lainchan.jp",postform_rules:null,features:{page:!1,graph:!0,setting2:!1,postform:!0},pref_default:{page:{env:{disp_offset:1}},proto:{env:{localtime_native:!1,colorID_native:!1}},stats:{time_unit:3,estimate_posts:!1},chart:{inst:{show:{np:!1,p:!0},time_sel:3}},catalog:{image_hover:!0,board:{all_boards:!0},env:{disp_offset:1,disp_filler:" "},auto_load_filter:!0,auto_save_filter:!0,auto_save_filter_at_refresh:!0},thread:{auto_update:!0},thread_reader:{own_posts_tracker:!0},scan:{max:100},liveTag:{style_urtm_str:"color:lime !important;font-weight:bold !important",style_ur_str:"color:limegreen !important;font-weight:bold !important",style_in_str:"color:red !important",use:!1,from:"op"},virtualBoard:{scanDelay:1,max:100,scan:!0,scan_domains:{lainjp:"board"}},network:{fetch_actively:!1},easy2:{limits:1,presets:1,VB:{local:1},catalog:{auto_update:!1},page:{auto_update:!1}},style:{post_new:"border:2px solid red !important"}},boards_json:site2.DEFAULT.generate_boards_json([["cyb",2],["tech",2],["cult",2],["λ",1],["μ",1],["psy",1],["feels",1],["q",2],["r",1]],2),check_func:site2.lain.check_func,components:{boardlist:"#overheader",__proto__:site2.vichan.components},parse_funcs:{catalog_html:{sticky:function(e){return e.pn.getElementsByTagName("strong")[0].textContent.search(/\(sticky\)/)!=-1},proto:"lain.catalog_html"}},post_container:function(e,t){return e},update_posts_remove:function(e,t,a,n){var r=e.posts[t].pn;0==t&&r.classList.contains("op")?this.update_posts_insert_pack(r):a.removeChild(r.nextSibling),a.removeChild(r)},catalog_json2html3_thumbnail:function(e,t){return".jpg"===e.ext||".jpeg"===e.ext||".gif"===e.ext||".png"===e.ext?"https://"+this.domain_url+t+"thumb/"+e.tim+".png":".pdf"===e.ext?"https://"+this.domain_url+"/static/pdf.png":""},favicon:{__proto__:site2.lain.favicon,none:"/lainicon.ico"},proto:"lain"},site2.futaba||(site2.futaba={nickname:"futaba",check_func:function(){return window.location.href.search(/2chan.net/)!=-1&&(site.config("2chan.net","futaba"),site.max_page=site2.futaba.max_page_futaba[site.server_name+site.board],!0)},max_page_futaba:{"may/b/":11,"jun/b/":10,"dec/b/":8},max_page:function(e){return site2.futaba.max_page_futaba[e]},make_url4:function(e){return["http://"+site.server_name+".2chan.net"+e[1]+(0==e[2]?"futaba":e[2])+".htm","html"]},get_ops:function(e){for(var t=[],a=e.getElementsByClassName("hsbn"),n=0;n<a.length;n++)t.push(a[n].getAttribute("href").replace(/res\//,"").replace(/\.htm/,""));return t},get_posts:function(e){for(var t=[],a=e.getElementsByTagName("input"),n=0;n<a.length;n++)"delete"==a[n].value&&t.push(a[n].name);return t},format_thread:function(e){return e}}),localStorage&&localStorage[pref.script_prefix+".pref"]&&pref_func.pref_overwrite(pref,JSON.parse(localStorage[pref.script_prefix+".pref"]),!0);for(var i in{catalog:null,page:null,float:null})pref[i].save_board_list_sel||(pref[i].board_list_sel=0);sessionStorage&&sessionStorage[pref.script_prefix+".pref"]&&pref_func.pref_overwrite(pref,JSON.parse(sessionStorage[pref.script_prefix+".pref"]),!0),pref.pref2.KC.summer_time&&(site2.KC.time_offset=2),pref_func.site2_json(!1,!1,!0),window.opener&&pref_func.pref_overwrite(pref,{catalog:{auto_update:!1},thread:{auto_update:!1},page:{auto_update:!1},float:{auto_update:!1},virtualBoard:{scan:!1},stats:{auto_acquisition_scan:!1}});for(var i in site2){for(var j in site2[i].parse_funcs)if("string"!=typeof site2[i].parse_funcs[j]){for(var k in site2[i].parse_funcs[j])if("proto"!==k&&"string"==typeof Object.getOwnPropertyDescriptor(site2[i].parse_funcs[j],k).value){tgt=site2[i].parse_funcs[j][k].split(".");var tgt_obj=3===tgt.length?site2[tgt[0]].parse_funcs[tgt[1]][tgt[2]]:2===tgt.length&&site2[i].parse_funcs[tgt[0]]&&site2[i].parse_funcs[tgt[0]][tgt[1]]?site2[i].parse_funcs[tgt[0]][tgt[1]]:2===tgt.length&&site2[tgt[0]]&&site2[tgt[0]].parse_funcs[tgt[1]]&&site2[tgt[0]].parse_funcs[tgt[1]][k]?site2[tgt[0]].parse_funcs[tgt[1]][k]:1===tgt.length?site2[i].parse_funcs[tgt[0]]&&site2[i].parse_funcs[tgt[0]][k]:null;tgt_obj&&(site2[i].parse_funcs[j][k]=tgt_obj)}if("DEFAULT"!==i||"common"!==j){var proto=site2[i].parse_funcs[j].hasOwnProperty("proto")?site2[i].parse_funcs[j].proto:site2[i].hasOwnProperty("proto")&&"DEFAULT"!==i?site2[i].proto+"."+j:site2.DEFAULT.parse_funcs[j]&&"DEFAULT"!==i?"DEFAULT."+j:"DEFAULT.common";proto="_template"===j.substr(-9,9)&&"DEFAULT.common"===proto?site2.DEFAULT.wrap_to_parse.get_getters():proto.indexOf(".")==-1?site2[i].parse_funcs[proto]:site2[proto.substr(0,proto.indexOf("."))].parse_funcs[proto.substr(proto.indexOf(".")+1)],site2[i].parse_funcs[j].__proto__=proto,delete site2[i].parse_funcs[j].proto}}else{var tgt=site2[i].parse_funcs[j];site2[i].parse_funcs[j]=site2[i].parse_funcs[tgt]}"DEFAULT"!==i&&(proto=site2[i].hasOwnProperty("proto")?site2[i].proto:"DEFAULT",site2[i].parse_funcs&&(site2[i].parse_funcs.__proto__=site2[proto].parse_funcs),site2[i].patch&&(site2[i].patch.__proto__=site2[proto].patch),site2[i].__proto__=site2[proto],delete site2[i].proto)}site2.ALL={};var site3={};for(var i in site2)"DEFAULT"!==i&&"common"!==i&&"meguca1"!==i&&"meguca2"!==i&&(site3[i]={boards:null,tags:{cs:[],ci:[]},own_posts:{}},site2[i].hasOwnProperty("check_func")&&(site2[i].check_func(),delete site2[i].check_func),site.nicknames.push(i),site2.ALL[site2[i].domain_url]=i);if(site.embed_to.top||(site.embed_to.top=site.root_body&&site.root_body.firstChild),site.embed_to.bottom||(site.embed_to.bottom=site.root_body&&site.root_body.lastChild),pref_func.site2_json(!1,!0,!1),window.top!=window.self){if(site.nicknames.indexOf(window.name)==-1&&window.name!==site.embed_frame)return;for(var i in site2)site.nicknames.indexOf(i)!=-1&&i!=site.nickname&&delete site2[i]}if(window.opener&&site.nicknames.indexOf(window.name)!=-1){for(var i in site.features)site.features[i]=!1;for(var i in pref.features)pref.features[i]=!1;brwsr.sw_cache=null,pref.cloudflare.auto_reload=!1}var pipe_name=pref.script_prefix+".graph."+site.board+"__pipe__",info_raw=site.nickname+site.board;window.SharedWorker||(pref.info_server=!1,pref.info_client=!1),pref_func.obj_init(),pref3.stats.use=pref.stats.use,pref3.stats.estimate_posts=pref.stats.estimate_posts;var notifier=function(){var e=pref.features.notify.sound?function(){function e(){var e;if(pref.notify.sound.notify){e=[];var t=function(t){function a(t,a,n){if(1==n)for(var r=0;r<a;r++)e.push("");for(var r=0;r<a;r++)1==n?e[e.length-1-r]=(t%256).toString(16):e.push((t%256).toString(16)),t=Math.floor(t/256)}var n=Math.floor(44100*t);return a(1380533830,4,1),a(n+46,4,0),a(1463899717,4,1),a(1718449184,4,1),a(18,4,0),a(1,2,0),a(1,2,0),a(44100,4,0),a(44100,4,0),a(1,2,0),a(8,2,0),a(0,2,0),a(1684108385,4,1),a(n,4,0),n}(pref.notify.sound.beep_length_f);!function(t,a,n){n*=127;for(var r=0;r<a;r++){var o=Math.floor(Math.sin(6.283185308*t*r/44100)*n+128)%256;e.push(o.toString(16))}}(pref.notify.sound.beep_freq,t,pref.notify.sound.beep_volume_f);for(var a=0;a<e.length;a++)1==e[a].length&&(e[a]="0"+e[a]);n=new Audio("data:audio/wav,%"+e.join("%"))}else n=null}function t(){e(),pref.notify.sound.notify&&"beep"===pref.notify.sound.src&&n.play()}function a(){if(n&&n.pause(),"notify.sound.file"===this.name&&(pref.notify.sound.src="file"),"beep"===pref.notify.sound.src)e();else{var t=pref3.notify.sound.file;t&&(n=new Audio(URL.createObjectURL(t.files[0])))}pref_func.settings.apply_pn13_1(),pref.notify.sound.notify&&n.play()}var n;return e(),pref_func.settings.onchange_funcs["notify.sound.beep_length_f"]=t,pref_func.settings.onchange_funcs["notify.sound.beep_volume_f"]=t,pref_func.settings.onchange_funcs["notify.sound.beep_freq"]=t,pref_func.settings.onchange_funcs["notify.sound.beep_freq"]=t,pref_func.settings.onchange_funcs["notify.sound.pause"]=function(){n.pause()},pref_func.settings.onchange_funcs["notify.sound.notify"]=e,pref_func.settings.onchange_funcs["notify.sound.file"]=a,pref_func.settings.onchange_funcs["notify.sound.src"]=a,{play:function(){n.play()}}}():{play:function(){}},t=pref.features.notify.favicon?function(){function e(e){if(n!==e){var t=site2[site.nickname].favicon[e];"/"!==t[0]&&(t="data:image/"+t),o.setAttribute("href",t),n=e}}function t(){var t=new liveTag.CountNR;if(pref.liveTag.watch_all)for(var n in liveTag.mems)for(var r in liveTag.mems[n]){if(liveTag.mems[n][r].nr<0){var o=new liveTag.CountNR;for(var s in liveTag.mems[n][r])o.count(liveTag.mems[n][r][s][2]);liveTag.mems[n][r].nrtm=o.nrtm,liveTag.mems[n][r].nr=o.nr}t.nrtm+=liveTag.mems[n][r].nrtm,t.nr+=liveTag.mems[n][r].nr}else{var i=cataLog.threads;if(i)for(var l in i)t.count(i[l][19])}if(pref.notify.favicon){e(0!=t.nrtm?"reply_to_me":0!=t.nr?"reply":"none")}pref.notify.title.notify&&a(0==t.nr&&pref.notify.title.hide_zero?"":(pref.catalog_footer_show_nof_rep_to_me?t.nrtm+"/"+t.nr:"("+t.nr+")")+" - ")}function a(e){r!==e&&(s.innerHTML=e+i,r=e)}var n,r,o=site2[site.nickname].favicon.get_favicon(),s=site2[site.nickname].favicon.get_title(),i=s.innerHTML;return{set:new DelayBuffer(t,200).get_binded_delayed_do()}}():{set:function(){}},a=Notification&&pref.features.notify.desktop?function(){function e(){return"granted"!==Notification.permission&&Notification.requestPermission(function(e){Notification.permission!==e&&(Notification.permission=e)}),"granted"===Notification.permission}function t(t,n,r){i.length+l.length<pref.notify.desktop.limit&&("granted"===Notification.permission||e())&&a(t,n,r)}function a(e,t,a){var r=a>=0?t[a]:t;r={icon:r.op_img_url,body:r.com||"",__proto__:r},r.reply_of_mine&&pref.catalog_footer_ignore_my_own_posts||(r.title=(r.new_thread?"New Thread ":r.reply_to_me&&pref.notify.desktop.reply_to_me?"(You) in ":"")+(e.sub||e.key),r.tag=pref.script_prefix+"/"+e.key+", "+(t.length-a-1),c.innerHTML=r.body,r.body=c[brwsr.innerText].trim(),0===pref.notify.desktop.delay?n(r):(l[l.length]=r,p()))}function n(e){e||(e=l.shift());var t=new Notification(e.title,e);t.onclick=o
;var a=0!=pref.notify.desktop.lifetime?setTimeout(r,1e3*pref.notify.desktop.lifetime):null;i[i.length]=[t,a],l.length>0&&p()}function r(){i.shift()[0].close()}function o(){window.focus();for(var e=i.length-1;e>=0;e--)if(i[e][0]===this||0==e){i[e][1]&&clearTimeout(i[e][1]),i.splice(e,1);break}}function s(){for(;i.length>0;)i[0][1]&&clearTimeout(i[0][1]),r()}e();var i=[],l=[],c=document.createElement("div"),p=new DelayBuffer(n,200).get_binded_delayed_do();return window.addEventListener("beforeunload",s,!1),{show:t}}():{show:function(){}};return{sound:e,favicon:t,desktop:a,changed:function(e,n){(pref.notify.favicon||pref.notify.title.notify)&&t.set();for(var r=!1,o=pref.notify.desktop.show_last?0:n.length-1,s=n.length-1;s>=0;s--)(pref.notify.sound.reply||pref.notify.sound.reply_to_me&&n[s].reply_to_me)&&(r=!0),s<=o&&pref.notify.desktop.notify&&(pref.notify.desktop.reply||pref.notify.desktop.reply_to_me&&n[s].reply_to_me)&&a.show(e,n,s,!0);pref.notify.sound.notify&&r&&notifier.sound.play()},appeared:function(e,n){var r=cataLog.threads;(pref.notify.favicon||pref.notify.title.notify)&&t.set(r);var o=liveTag.mems[e.domain][e.board][e.no][2];pref.notify.desktop.notify&&(pref.notify.desktop.appear&&(0===o[0]||!pref.notify.desktop.reply&&!pref.notify.desktop.reply_to_me)||pref.notify.desktop.new_thread&&n)&&a.show(e,{new_thread:n,__proto__:e},-1),pref.notify.sound.notify&&(pref.notify.sound.appear||pref.notify.sound.new_thread&&new_therad)&&notifier.sound.play()}}}(),ports={},messages_to_send={},init_func={},receive_func={},send_message_emu=[];if(window.addEventListener("beforeunload",close_all,!1),window.opener&&(make_port_child(window.opener),site2[window.name]&&site2[window.name].prep_own_posts_event&&(window.addEventListener("storage",site2[window.name].prep_own_posts_event,!1),site2[window.name].prep_own_posts(),site2[window.name].prep_own_posts_event())),pref.cloudflare.auto_reload){var cf_error=document.getElementsByClassName("cf-error-code");cf_error.length>0&&parseInt(cf_error[0].textContent,10)>=500&&setTimeout(function(){location.reload()},6e4*pref.cloudflare.auto_reload_time)}var httpd=function(){function e(){U.id||t()}function t(e,o){if(!z)for(var i=8;i>=0;i--)if(O[i]&&(L<pref.scan.crawler||8==i)){for(;O[i][0]&&0===O[i][0].tgts.length;)O[i].shift();for(var l=O[i][0],c=0;l&&l.ERR_5xx&&o!==l;)l=O[i][++c];if(!l)continue;var p;l.INDICATOR||(l.INDICATOR=N.shift("limegreen",l.initiator[0],l.initiator,i),l.INDICATOR.report({start:Date.now(),prog:l}),l.IDX=0,l.FINISHED=0,l.SUC=0,l.max||(l.max=l.tgts.length));var p=l.get_tgt_func?l.get_tgt_func(l):{REQ:l,__proto__:l.tgts[l.IDX++]};return l.IDX>=l.max&&n(l,i),L++,void(p?(l.INDICATOR.report({tgt:p.tgt||a(p.url)}),p.domain===site.nickname&&!p.domain_xhr||"indirect"!==pref.network.cross_domain?s(e,p):(e&&(B[B.length]=e),r(p)),pref.scan.crawler_adaptive?U.restart(pref.scan.crawler_idle_time_to_spawn):L<pref.scan.crawler&&t()):(l.IDX<l.max&&(l.refresh||l.found_threads<l.max_threads)||(n(l,i),l.FINISHED+=l.max-l.IDX,l.IDX=l.max),setTimeout(function(){d({type:"SKIPPED_TO_END"},e,{REQ:l},!0,{date:Date.now(),status:200})},0)))}U.id&&U.stop(),e&&(B[B.length]=e)}function a(e){return e.substr(e.lastIndexOf("/")+1)}function n(e,t){O&&O[t].length>1?O[t].shift():O[t]=null,D[D.length]=e}function r(e){var t=e.domain_xhr||e.domain;T[t]||(cnst.make_iframe(t),T[t]=window.open(site2[t]&&site2[t].home||e.url,t),send_message(t,["HTTPD",["SUB_FRAME_INIT"]],T[t])),C[t]=null,S[I]=e,e.archive||(e.responseType="text"),send_message(t,["HTTPD",["SUB_GET",[{ID:I++,url:e.url,responseType:e.responseType,domain:e.domain,board:e.board,no:e.no,key:e.key,archive:e.archive,to_file:e.to_file,to_idb:e.to_idb,kind:e.kind,timestamp:e.timestamp,domain_xhr:e.domain_xhr}]]])}function o(e){s(void 0,e[0])}function s(e,t){e||(B.length>0?e=B.pop():"GM"===pref.network.cross_domain?e=new H:(e=new XMLHttpRequest,e.onload=_,e.onerror=_,e.onabort=_)),E.set(e,t),e.open("GET",t.url),e.responseType=t.responseType,e.send(),i(e,Date.now(),t)}function i(e,t,a){a.TIMEOUT=(a.TIMEOUT?a.TIMEOUT:t)+1e3*pref.network.timeout,R[R.length]=e,1===R.length&&M.restart(1e3*pref.network.timeout)}function l(e,t){var a=R.indexOf(e);if(a<0)return!0;if(R.splice(a,1),0===a)if(R.length>0){var n=E.get(R[0]).TIMEOUT-t;n>0?M.restart(n):c()}else M.stop()}function c(){var e=R[0];pref.debug_mode[25]&&console.log("xhr_timeout: "+e.readyState+", "+e.responseURL),e.onreadystatechange?_({target:e,type:"TIMEOUT"}):(e.onreadystatechange=p,e.onprogress=p,p({target:e}))}function p(e){var t=e.target,a=E.get(t);pref.debug_mode[25]&&console.log("xhr_onreadystatechange: "+a.url+("progress"===e.type?": "+e.loaded+"/"+e.total:"")),"progress"===e.type&&(e.target.onreadystatechange=null);var n=Date.now();l(t,n),i(t,n,a)}function _(e){var t=e.target,a=Date.now();if(!l(t,a)){t.onreadystatechange=null,t.onprogress=null;var n=E.get(t),r=200===t.status||304===t.status;d(e,t,n,r,"text"===t.responseType?{date:a,status:t.status,responseText:r?t.responseText:null}:{date:a,status:t.status,response:r?t.response:null})}}function d(n,r,o,s,i){if(j){L--;var l=++o.REQ.FINISHED===o.REQ.IDX&&o.REQ.IDX>=o.REQ.max;t(r,i.status<500?o:null),l&&f(o.REQ),s?(o.REQ.SUC++,h(o,i)):(i.status>=500&&!o.REQ.ERR_5xx&&(o.REQ.ERR_5xx=setTimeout(function(t){return function(){delete t.ERR_5xx,e()}}(o.REQ),3e4)),o.REQ.INDICATOR.report({err_str:(o.tgt||a(o.url))+"("+i.status+("load"!==n.type?":"+n.type:"")+")"}),o.REQ.callback_1_fail&&o.REQ.callback_1_fail(o,i,o.REQ)),l&&y(o.REQ,i.date),o.REQ=null}else send_message("parent",["HTTPD",["SUB_ACK",[o.ID,{type:o.archive?"ARCHIVE":n.type},s,o.archive?{date:i.date,status:i.status,responseText:"",response:{}}:i]]]),B[B.length]=r,s&&o.archive&&g(o,i)}function u(e){var t=S[e[0]];delete S[e[0]],d(e[1],void 0,t,e[2],e[3])}function f(e){D.splice(D.indexOf(e),1),e.archive&&(e.TAR_FLUSH=C),m()}function m(){if(0===L){if(E.clear(),j)for(var e in C)send_message(e,["HTTPD",["SUB_FREE"]]);I=0,C={}}else for(var t=0;t<B.length;t++)E.delete(B[t]);B=[]}function h(e,t){"text"===e.responseType&&("html"===e.data_type?t.response=A.parseFromString(t.responseText,"text/html"):"json"===e.data_type&&(t.response=JSON.parse(t.responseText))),e.REQ.callback_1(e,t,e.REQ)}function g(e,t){if("string"==typeof e.archive)return void archiver.download_url4(t.response,e.archive);e.from&&j&&delete archiver.list_all_obj_downloading[e.from];var a="indirect"!==pref.network.cross_domain;if((e.domain_xhr||e.domain)===site.nickname||a){var n=e.kind+"_"+e.url.replace(/.*\//g,"");e.to_file&&archiver.download_url3(t.response,e,n,e.timestamp),e.to_idb&&(pref.test_mode[65]&&j||IDB.req(e.domain,e.board,e.no,n,t.response,"put"))}if(j&&e.REQ.TAR_FLUSH){archiver.tar.flush(0===L?void 0:e.timestamp);for(var r in e.REQ.TAR_FLUSH)send_message(r,["HTTPD",["SUB_TAR_FLUSH",[0===L?void 0:e.timestamp]]])}}function b(e,t){e.from&&delete archiver.list_all_obj_downloading[e.from]}function v(e){if(O[0]&&O[0][0]&&O[0][0].timestamp===e)return!1;for(var t=0;t<D.length;t++)if(D[t].timestamp===e)return!1;return archiver.tar.flush(0===L?void 0:e),!0}function y(e,t){e.callback&&e.callback(e),e.INDICATOR.report({end:t})}function k(e){archiver.tar.flush(e[0])}function w(){j=!1}function x(){z>0?--z>0&&F.delayed_do():(F.cancel(),e())}var N,T={},j=!0,A=new DOMParser,E=new Map,B=[],L=0,C={},I=0,S={},O=[],D=[],z=0,U=new Watchdog(t,pref.scan.crawler_idle_time_to_spawn),R=[],M=new Watchdog(c,3e4),H=function(){this.onload=this.onload.bind(this),this.onerror=this.onerror.bind(this),this.onabort=this.onabort.bind(this)};H.prototype={open:function(e,t){this.method=e,this.url=t},send:function(){this.response=null,GM_xmlhttpRequest(this)},onload:function(e){this.response=e.response,this.response||(this.response="document"===this.responseType?(new DOMParser).parseFromString(e.responseText,"text/xml"):"json"===this.responseType?JSON.parse(e.responseText):e.responseText),this.onXXX("load",e,_)},onerror:function(e){this.onXXX("error",e,_)},onabort:function(e){this.onXXX("abort",e,_)},onXXX:function(e,t,a){this.type=e,this.result=t,a(this)},onXXX_factory:function(e,t){return function(a){this.onXXX(e,a,t)}.bind(this)},set onreadystatechange(e){this._onreadystatechange=e?this.onXXX_factory("readystatechange",e):e},get onreadystatechange(){return this._onreadystatechange||this.dummy_func},set onprogress(e){this._onprogress=e?this.onXXX_factory("progress",e):e},get onprogress(){return this._onprogress||this.dummy_func},dummy_func:function(){},get status(){return this.result&&this.result.status||1404},get responseText(){return this.result.responseText},get target(){return this},result:null};var F=new DelayBuffer(x,1e4),q={SUB_GET:o,SUB_ACK:u,SUB_FREE:m,SUB_TAR_FLUSH:k,SUB_FRAME_INIT:w};return{req:function(e,a){O[a]?O[a].push(e):O[a]=[e],0!==e.tgts.length&&t()},req_add:function(t,a){O[a]&&0!==O[a].length?O[a][O[a].length-1].tgts=O[a][O[a].length-1].tgts.concat(t.tgts):O[a]=[t],e()},check_timestamp_and_flush:v,onload_archive:g,onload_archive_fail:b,sub_funcs:function(e){q[e[0]](e[1])},pause_req:function(){z++,F.delayed_do()},pause_cancel:x,set_health_indicator:function(e){N=e},get isLocal(){return j}}}(),http_req={get:function(e,t,a,n,r,o,s,i){var l=t.indexOf(",")==-1?common_func.name2dbt(t):t.split(",");""===a?a=site2[l[0]].make_url4(l):"string"==typeof a&&(a=[a,"raw"]),t=l.join(","),httpd.req({initiator:t,tgts:[{url:a[0],responseType:"html"===a[1]?"document":"raw"===a[1]?"text":a[1],tgt:t,data_type:a[1],domain:l[0]}],callback_1:function(e,a){n(t,a,s)},INDICATOR:{shift:function(){},report:function(){}},IDX:0,FINISHED:0,SUC:0,max:1},6)}},cnst=function(){function e(e,t){var a=parseFloat(e.style.opacity);isNaN(a)&&(a=1),t?e.style.opacity=a+.1>=1?1:a+.1:t||(e.style.opacity=a-.1<=.1?.1:a-.1)}function t(e,t,a){"none"==t.style.display?(e.style.width="",t.style.display="",a.rolldown&&a.rolldown.call(a.this_obj)):(e.style.width=e.offsetWidth+"px",t.style.display="none",a.rollup&&a.rollup.call(a.this_obj))}function a(e,t,a,n){var r=n.maximize_state,o=p[a],s=p[r[0]];if(common_func.overwrite_prop(t.childNodes[1].childNodes[r[0]].style,{display:"inline"}),2==r[0]?r=[a,e.style.left,e.style.top,e.childNodes[1].style.width,e.childNodes[1].style.height]:r[0]=a,3==a){var i=site.header_height();common_func.overwrite_prop(e.style,{left:"0px",top:i+"px",position:"fixed",resize:"none"}),common_func.overwrite_prop(e.childNodes[1].style,{width:document.documentElement.clientWidth+"px",height:document.documentElement.clientHeight-t.offsetHeight-i+"px",resize:"none"})}else if(2==a)common_func.overwrite_prop(e.style,{left:r[1],top:r[2],position:"fixed",resize:"both"}),common_func.overwrite_prop(e.childNodes[1].style,n.maximize_float_style_pnch1||{width:r[3],height:r[4],resize:"both"});else{var l=site.embed_to[0==a?"top":"bottom"];l&&(common_func.overwrite_prop(e.style,n.maximize_embed_style_pn||{left:"auto",top:"auto",position:"static",resize:"none"}),common_func.overwrite_prop(e.childNodes[1].style,n.maximize_embed_style_pnch1||{width:"auto",height:"auto",resize:"none"}),l.parentNode.insertBefore(e,l))}common_func.overwrite_prop(t.childNodes[1].childNodes[a].style,{display:"none"}),n.maximize_state=r,n.maximize_state_str=o,n.maximize&&n.maximize.call(n.this_obj,o,s)}function n(e){i=e.screenX,l=e.screenY,e.dataTransfer.setData("text/plain",""),e.dataTransfer.effectAllowed="move",e.dataTransfer.dropEffect="move",e.stopPropagation(),e.currentTarget.style||(e.style={}),e.currentTarget.style.opacity=.4,c=this,e.currentTarget.addEventListener("dragend",o,!1),document.getElementsByTagName("body")[0].addEventListener("dragover",r,!1)}function r(e){e.preventDefault(),e.dataTransfer.dropEffect="move"}function o(e){document.getElementsByTagName("body")[0].removeEventListener("dragover",r,!1),e.currentTarget.removeEventListener("dragend",o,!1),""!=e.currentTarget.style.left?e.currentTarget.style.left=parseInt(e.currentTarget.style.left.replace(/px/,""))+e.screenX-i+"px":e.currentTarget.style.right=parseInt(e.currentTarget.style.right.replace(/px/,""))-e.screenX+i+"px",""!=e.currentTarget.style.bottom?e.currentTarget.style.bottom=parseInt(e.currentTarget.style.bottom.replace(/px/,""))-e.screenY+l+"px":e.currentTarget.style.top=parseInt(e.currentTarget.style.top.replace(/px/,""))+e.screenY-l+"px",c.dragend&&c.dragend.call(c.this_obj,e),c=null,e.currentTarget.style.opacity=1}function s(e){var t=brwsr.ff?40*-e.detail:e.wheelDelta;""!=e.currentTarget.style.bottom?e.currentTarget.style.bottom=parseInt(e.currentTarget.style.bottom.replace(/px/,""))-t+"px":e.currentTarget.style.top=parseInt(e.currentTarget.style.top.replace(/px/,""))+t+"px",e.preventDefault()}var i,l,c,p=["top","bottom","max","float"],_={left:0,bottom:0,last_pn:null};return{init3:function(e){return this.init(e.func_str,null,null,null,null,e.pn_st,e)},init2:function(e){return this.init(e.func_str,e.rolldown_func,e.rollup_func,e.exit_func,e.maximize_func,e.pn_st)},init:function(r,o,i,l,c,p,d){var u=void 0!==d;void 0===d&&(d={rolldown:o,rollup:i,exit:l,maximize:c});var f=document.createElement("span");if(p)return f.textContent=" "+r.replace(/.*:button:/,"").replace(/:.*/,""),f.setAttribute("style","cursor:pointer"),p.appendChild(document.createTextNode(" ")),p.appendChild(f),f;f.style||(f.style={}),f.style.position="fixed",f.draggable=!0,f.style.padding="0px",f.style.zIndex=1;var m=r.split(":"),h=0;"pop"!=m[0]||(brwsr.ff?f.addEventListener("DOMMouseScroll",s,!1):f.addEventListener("mousewheel",s,!1),f.name="catalog_pop",h=1),f.setAttribute("class",pref.script_prefix+"_window");for(var g=null,b=f,m=r.split(":");h<m.length;){var v=m[h++];if("tb"==v){f.setAttribute("class",pref.script_prefix+"_titleBar"),f.innerHTML='<div><div style="float: left"><button type="button">-</button><button type="button"><</button><button type="button">></button><span>&emsp;</span></div><div style="float: right"><button style="display:inline">^</button><button style="display:inline">_</button><button style="display:none">o</button><button style="display:inline">[]</button><button>X</button></div><div></div></div><div class="'+pref.script_prefix+'_window" style="margin: 0px 3px 3px 3px;clear:both"></div>';var y=f.childNodes[0];y.childNodes[2].style.height=y.childNodes[0].offsetHeight+"px",y.childNodes[0].style.cursor="move",y.childNodes[2].style.cursor="move",g=function(){t(f,f.childNodes[1],d)},y.childNodes[0].childNodes[0].onclick=g,y.childNodes[0].childNodes[1].onclick=function(){e(f,!1)},y.childNodes[0].childNodes[2].onclick=function(){e(f,!0)},y.childNodes[0].childNodes[3].ondblclick=g,y.childNodes[2].ondblclick=g,d.maximize_state=[2],d.maximize_state_str="float",y.childNodes[1].childNodes[0].onclick=function(){a(f,y,0,d)},y.childNodes[1].childNodes[1].onclick=function(){a(f,y,1,d)},y.childNodes[1].childNodes[2].onclick=function(){a(f,y,2,d)},y.childNodes[1].childNodes[3].onclick=function(){a(f,y,3,d)},y.childNodes[1].childNodes[4].onclick=d.this_obj?d.exit.bind(d.this_obj):d.exit,f.draggable=!1,y.childNodes[0].draggable=!0,y.childNodes[2].draggable=!0,b=f.childNodes[1]}else"txt"==v||brwsr.ff&&"button"==v?(b.appendChild(document.createTextNode(m[h++])),b.style.cursor="pointer",b.style.padding="2px 5px 2px 5px"):"button"==v?(b.innerHTML='<input type="button" value="'+m[h++]+'">',b.style.padding="0",b.style.border="0",b.style.background="none"):"Show2"==v?site.root_body!==site.root_body2&&site.root_body2?(f.style.position="static",site.root_body2.appendChild(f)):site.root_body.appendChild(f):"Show"==v?site.script_body.appendChild(f):"tile"==v||"tile2"==v?"set"==m[h++]?"left"==m[h]?(_[m[h]]=parseInt(f.style[m[h]].replace(/px/,""),10)+f.offsetWidth,h++):(_[m[h]]=parseInt(f.style[m[h]].replace(/px/,""),10)+f.offsetHeight,h++):"tile"===v?(f.style[m[h]]=_[m[h]]+"px",h++):(f.style[m[h]]=_[m[h]]+parseInt(m[h+1],10)+"px",h+=2):b.style[v]=m[h++]}return d.event_funcs={},d.event_funcs.dragstart=n.bind(d),f.addEventListener("dragstart",d.event_funcs.dragstart,!1),_.last_pn=f,d.pn=f,d.rollup_func_tb=g,d.tb=y,u?d:g?[f,g]:f},tile_set_bottom:function(){_.last_pn&&(_.bottom=_.last_pn.offsetHeight)},tile_set_left:function(){_.last_pn&&(_.left=_.last_pn.offsetWidth)},bottom_top:function(e){e.style.bottom&&(e.style.top=window.innerHeight-parseInt(e.style.bottom.replace(/px/,""),10)-e.offsetHeight+"px",e.style.bottom=""),e.style.right&&(e.style.left=window.innerWidth-parseInt(e.style.right.replace(/px/,""),10)-e.offsetWidth+"px",e.style.right="")},div_dragend:o,void_func:function(){},drag_sx:function(){return i},drag_sy:function(){return l},div_destroy:function(e,t,a){return pref_func.tooltips.remove_hier(e),pref_func.tooltips.remove_root(e),t&&e.parentNode.removeChild(e),e.removeEventListener("dragstart",a?a.event_funcs.dragstart:n,!1),"catalog_pop"==e.name&&(brwsr.ff?e.removeEventListener("DOMMouseScroll",s,!1):e.removeEventListener("mousewheel",s,!1)),null},add_to_tb:function(e,t){var a=document.createElement("div");return a.style.float="right",a.style.resize="none",a.style.overflow="visible",a.innerHTML=t,e.childNodes[0].insertBefore(a,e.childNodes[0].childNodes[e.childNodes[0].childNodes.length-1]),brwsr.ff&&a.setAttribute("style","float: right"),a},show_hide:function(e,t,a){"none"==e.style.display?(e.style.display="",t&&(t.style.height=parseInt(t.style.height.replace(/px/,""),10)-e.offsetHeight+"px"),a&&(a.style.top=parseInt(a.style.top.replace(/px/,""),10)+e.offsetHeight+"px")):(t&&(t.style.height=parseInt(t.style.height.replace(/px/,""),10)+e.offsetHeight+"px"),a&&(a.style.top=parseInt(a.style.top.replace(/px/,""),10)-e.offsetHeight+"px"),e.style.display="none")},name2domainboardthread:common_func.name2domainboardthread,get_time:function(){var e=new Date,t=e.getHours(),a=e.getMinutes(),n=e.getSeconds();return t<10&&(t="0"+t),a<10&&(a="0"+a),n<10&&(n="0"+n),t+":"+a+":"+n},make_destroy:function(e,t,a,n){e[t]?e[t]=n():e[t]=a()},make_popup:function(e,t,a,n){e[t]=cnst.init("left:0px:tile:get:bottom:Show:tb",cnst.void_func,cnst.void_func,function(){e[t]=cnst.div_destroy(e[t],!0)},cnst.void_func)[0],e[t].childNodes[1].innerHTML=a,pref_func.add_onchange(e[t].childNodes[1],n)},make_iframe:function(e){if(!(site2[e]&&site2[e].X_FRAME_OPTIONS&&pref.network.overXFO||site2[site.nickname].CONTENT_SECURITY_POLICY_FRAME&&pref.network.overCSPF)){var t=document.createElement("iframe");return t.name=e,t.setAttribute("style","display:none"),site.script_body.appendChild(t),t}},subscribe:function(e,t){e.push(t)},unsubscribe:function(e,t){var a=e.indexOf(t);a!=-1&&e.splice(a,1)},foreach:function(e,t){for(var a=0;a<e.length;a++)t(e[a])},auto_shrink_board_selector:function(){function e(){this.removeAttribute("style");for(var e=0;e<this.length;e++)this.options[e].text=pref.catalog_board_list_obj[e][0].key,n(this.options[e],e)}function t(){for(var e=0;e<this.length;e++)e!=this.selectedIndex&&(this.options[e].text="");n(this,this.selectedIndex)}function a(e,t){void 0===t&&(t=e.selectedIndex),e.length=0;for(var a=0;a<pref.catalog_board_list_obj.length;a++)e.length++,e.options[e.length-1].text=pref.catalog_board_list_obj[a][0].key;e.selectedIndex=t>=e.length?0:t,e.onblur()}function n(e,t){pref3.stats.use&&(pref.stats.auto_acquisition||pref.stats.auto_acquisition_all)&&stats.query_auto_acquisition(t)?e.setAttribute("style","background:#b5fbda"):e.removeAttribute("style")}var r=[];return{setup:function(n,o){n.onfocus=e,n.onblur=t,a(n,o),cnst.subscribe(r,n)},str_changed:function(){cnst.foreach(r,a)},destroy:function(e){cnst.unsubscribe(r,e)},color:function(){cnst.foreach(r,function(e){n(e,e.selectedIndex)})}}}(),auto_shrink_selector:function(){function e(){for(var e=a[this.getAttribute("name")],t=0;t<this.length;t++)""===this.options[t].text&&(this.options[t].text=e[t])}function t(){for(var e=[],t=0;t<this.length;t++)e[t]=this.options[t].text,t!=this.selectedIndex&&(this.options[t].text="");a[this.getAttribute("name")]=e}var a=Object.create(null);return function(a){a.onfocus=e,a.onblur=t,a.onblur()}}(),config_expander:function(){function e(){var e=pref[cataLog.embed_mode].t2h_num_of_posts;return["Same as the page",pref[cataLog.embed_mode].t2h_L+" posts",pref[cataLog.embed_mode].t2h_M+" posts",e+" posts",e+" + all unread posts","All unread posts","All"]}function t(){for(var t=e(),a=0;a<this.length;a++)""===this.options[a].text&&(this.options[a].text=t[a])}function a(){for(var e=0;e<this.length;e++)e!=this.selectedIndex&&(this.options[e].text="")}return function(n,r){var o=document.createElement("select");return o.className=pref.script_prefix+"_expander",o.setAttribute("data-key",n),o.length=7,void 0===r&&(r=0),o.selectedIndex=r,o.options[r].text=0===r?"Expand...":e()[r],o.onfocus=t,o.onblur=a,o}}(),icons:{filter:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcAQAAAABaduI5AAAAAnRSTlMAAQGU/a4AAABUSURBVAjXY/j///8HBjAx////CQz8//8zMLD//8fAwPz/DwND4/8fAgwH/n8wYHhQ/6CA4YP9gQ8MP+QbPzD84Wf+wPCPnx2ol5+fLKJfHmovnAAAn79HiYOE2q8AAAAldEVYdGRhdGU6Y3JlYXRlADIwMTUtMTAtMjlUMDI6MTM6MzkrMDk6MDBxKtFiAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE1LTEwLTI5VDAyOjEzOjM5KzA5OjAwAHdp3gAAAABJRU5ErkJggg==",settings:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcAQAAAABaduI5AAAAAnRSTlMAAQGU/a4AAABWSURBVAjXdY6xDcAgDAQvGzAKG2QllykiwWgexWxgKQ2dI4yULs1X9/dPWHMyHrudYZegvVQ6FBQqdqrgzRwLF0ZM4YjJfySS8K4tQaq2dOlzKCe/By9fz0MDWLKIZgAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAxNS0xMC0yOVQwMjowMzowNiswOTowMMhjeagAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMTUtMTAtMjlUMDI6MDM6MDYrMDk6MDC5PsEUAAAAAElFTkSuQmCC",refresh:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcAQAAAABaduI5AAAAAnRSTlMAAQGU/a4AAABmSURBVAjXbY6xDYAwDASfijLegBUYLRuAlCIljITEAowQNnCZIspjQ0tzkvX6e4NKBREudIw7KgaBTqugLEVwUwWnI9HOzMNh6UarhR+8QWaXD4nNBW02VY0ujdAA9SH1yXfcYG88J0BH+yT9vZAAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTUtMTAtMjhUMjM6NDg6MDYrMDk6MDASyn1kAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE1LTEwLTI4VDIzOjQ4OjA2KzA5OjAwY5fF2AAAAABJRU5ErkJggg=="},toggleButton:function(e){e.style&&e.style.border?e.style.border="":e.style.border="inset 2px"},createElement:function(e){var t=document.createElement("div");return t.innerHTML=e,1===t.childNodes.length?t.childNodes[0]:t.querySelectorAll("*")}}}(),timer_obj,chart_obj,setting_obj,post_form_obj,wafd=null,catalog_obj,cnst_obj=function(){if(site.script_body=document.createElement("div"),site.script_body.className=pref.script_prefix,site.script_body.innerHTML='<div style="display:none"></div>',site.root_body.appendChild(site.script_body),site.features.postform&&pref.features.postform&&null==site.postform&&!site2[site.nickname].postform.activation){var e=document.createElement("div");e.innerHTML='<textarea style="height:5em;display:none" cols="20" name="'+pref.script_prefix+'_draft"></textarea><button name="'+pref.script_prefix+'_send" style="display:none">send</button>',site.script_body.appendChild(e),site.components.postform_comment=e.childNodes[0],site.postform=site.components.postform_comment,site.components.postform_submit=e.childNodes[1]}if(site.settings){site.settings.innerHTML="<span>[CC</span><span></span>]",site.settings.setAttribute("style","float:right;");var t=site.settings.childNodes[1];site.settings.childNodes[0].setAttribute("style","cursor:pointer"),site.settings.childNodes[0].onclick=function(){cnst.show_hide(t)},site.settings.childNodes[1].setAttribute("style","display:none")}if(site.features.setting&&pref.features.setting){cnst.init2({func_str:"left:0px:bottom:0px:button:settings:Show2:tile:set:left",pn_st:t}).addEventListener("click",pref_func.settings.show_hide,!1)}if(site.features.catalog&&pref.features.catalog){if(!pref.catalog.embed_page||"page"!==site.whereami)var a=pref.catalog.embed&&"catalog"===site.whereami?"Frame":"Catalog",n=cnst.init2({func_str:"tile:get:left:tile:get:bottom:button:"+a+":Show2:tile:set:left",pn_st:t});catalog_obj=make_catalog_obj(n)}if(cnst.tile_set_left(),site.features.graph&&pref.features.graph&&pref3.stats.use){var r=cnst.init2({func_str:"tile:get:left:tile:get:bottom:button:Graph:Show2:tile:set:left",pn_st:t});chart_obj=make_chart_obj(r)}else chart_obj=make_chart_obj(null);if(site.features.setting2&&pref.features.setting2){var o=cnst.init2({func_str:"tile:get:left:tile:get:bottom:button:settings2:Show2:tile:set:left",pn_st:t});setting_obj=make_setting_obj(o)}if(site.features.postform&&pref.features.postform&&(null!=site.postform||site2[site.nickname].postform.activation)){wafd=make_wafd();var s=cnst.init2({func_str:"tile:get:left:tile:get:bottom:button:"+(e?"Draft":"PostForm")+":Show2:tile:set:left",pn_st:t});post_form_obj=make_post_form_obj(s)}if(site.features.debug&&pref.features.debug){make_debug_obj(cnst.init2({func_str:"tile:get:left:tile:get:bottom:button:debug:Show2:tile:set:left",pn_st:t}))}if(site.features.page&&pref.features.page){var i=cnst.init2({func_str:"tile:get:left:tile:get:bottom:txt:init:Show2",pn_st:t});timer_obj=make_timer_obj(i)}cnst.tile_set_bottom(),site.features.catalog&&pref.features.catalog&&pref.catalog.board.board_tags_same&&pref_func.settings.onchange_funcs["tag.same_tag_refresh"]()}(),uip_tracker=null;setTimeout(uip_tracker_init,1);var liveTag={pn:null,pn_board:null,active:{pk:0,in:0,ex:0},tags_ci:null,tags:Object.create(Object.create(null)),mems:Object.create(null,{getFromName:{value:function(e){var t=common_func.fullname2dbt(e);return t[2]?this[t[0]][t[1]][t[2]]:this[t[0]][t[1]]}},init:{value:function(){function e(e){this[e.domain]=Object.create(Object.create(this.acc,{domain:{value:e.domain}}),{p:{value:Object.create(null)}}),site2[e.domain].lth_init&&site2[e.domain].lth_init(e)}function t(e){var t="#"+e.board.substr(1,e.board.length-2);liveTag.tags[t]&&liveTag.tags[t].ref_tag===t&&(t=liveTag.tags[t].ref_tag),this[e.domain][e.board]=Object.create(Object.create(Object.getPrototypeOf(this[e.domain]),{board:{value:e.board},btag:{value:t,writable:!0}}),{nr:{value:0,writable:!0},nrtm:{value:0,writable:!0},u:{value:0,writable:!0},o:{value:null,writable:!0},p:{value:{},configurable:!0,writable:!0},pgs:{value:null,writable:!0},d:{value:0,writable:!0}}),pref.liveTag.inherit_board_name&&(liveTag.update_tags_in_th_sub([],{},[t],{},1,null,0,this[e.domain][e.board]),liveTag.update_pn_buf.delayed_do())}function a(e){var t=this[e.domain][e.board];t[e.no]=Object.create(Object.getPrototypeOf(t),{1:{value:void 0,writable:!0},2:{value:[8585216,0,0]},u:{value:0,writable:!0},no:{value:e.no,writable:!0}})}return function(n){return void 0===this[n.domain]&&e.call(this,n),n.board?(void 0===this[n.domain][n.board]&&t.call(this,n),n.no?(void 0===this[n.domain][n.board][n.no]&&a.call(this,n),this[n.domain][n.board][n.no]):this[n.domain][n.board]):this[n.domain]}}()},acc:{value:Object.create(null,{0:{get:function(){var e=this.btags;return this.tl&&(e=e?e.concat(this.tl):this.tl),e||[]},set:function(e){var t=this.btags;if(t){if(pref.liveTag.ci)for(var a=0;a<t.length;a++)t[a]=t[a].toLowerCase();for(var a=0;a<e.length;a++)t.indexOf(pref.liveTag.ci?e[a].toLowerCase():e[a])!=-1&&e.splice(a--,1)}e.length>0?this.tl=e:void 0!==this.tl&&delete this.tl}},t:{get:function(){return this[1]}},key:{get:function(){return this.domain+this.board+(this.no?this.no:"")}},tag:{get:function(){return(this[0]||[]).concat(this[1]||[])}},tags:{get:function(){return(this[0]||[]).concat(this[1]||[])}},btags:{get:function(){var e=pref.liveTag.inherit_board_name&&pref.liveTag.lock_board_name?[this.btag]:null;return pref.liveTag.inherit_board_tags&&pref.liveTag.lock_board_tags&&this.btag2&&(e=e?e.concat(this.btag2):this.btag2),e}},watched:{get:function(){return 786432&this[2][0]}},time_checked:{get:function(){return this[2][2]}},archived:{get:function(){return(7340032&this[2][0])>>20},set:function(e){this[2][0]=4287627263&this[2][0]|(7&e)<<20}},posts_saved:{get:function(){return(33554432&this[2][0])>>25},set:function(e){this[2][0]=4261412863&this[2][0]|(1&e)<<25}},force_ar:{get:function(){return(5242880&this[2][0])>>20}},rescan_dp:{get:function(){return(16777216&this[2][0])>>24},set:function(e){this[2][0]=4278190079&this[2][0]|(1&e)<<24}},nrtm:{get:function(){return this[2][1]>>16}},nr:{get:function(){return 65535&this[2][1]}},nof_posts:{get:function(){return 65535&this[2][0]},set:function(e){this[2][0]=(4294901760&this[2][0])+e}},LS_synced:{get:function(){return 1&this.d},set:function(e){this.d=4294967294&this.d|1&e}},IDB_synced:{get:function(){return(2&this.d)>>1},set:function(e){this.d=4294967293&this.d|(1&e)<<1}}})}}),postprocess_board_add_btag:function(e,t){for(var a=0;a<e.length;a++)e[a]="#"+e[a].replace(/[&<>'"#]/g,""),e[a].length>pref.liveTag.maxstr&&e.splice(a--,1);var n=t.btag2&&t.btag2.length===e.length;if(n)for(var a=0;a<e.length;a++)if(e[a]!==t.btag2[a]){n=!1;break}if(!n){for(var a=0;a<e.length;a++)liveTag.tags[e[a]]&&liveTag.tags[e[a]].ref_tag===e[a]&&(e[a]=liveTag.tags[e[a]].ref_tag);Object.defineProperty(Object.getPrototypeOf(t),"btag2",{value:e,writable:!0}),pref.liveTag.inherit_board_tags&&liveTag.inherit_board_tags_changed_1(e,t)}},retag:function(e,t){t&&(t.list_nup.add_scan(e),e[2][0]|=131072);var a={com:e.tags.join(" "),parse_funcs:{type_com:"txt"},__proto__:e};liveTag.prep_tags(a,e.tag),cataLog.threads[e.key]&&cataLog.insert_footer3(e.key,null,null,e)},retag_db:DelayBuffer.prototype.delayed_do.bind(new DelayBuffer(function(){cataLog.catalog_filter_changed&&cataLog.catalog_filter_changed()},10)),inherit_board_name_changed:function(){for(var e in this.mems)for(var t in this.mems[e])this.inherit_board_tags_changed_1([this.mems[e][t].btag],this.mems[e][t],!pref.liveTag.inherit_board_name)},inherit_board_tags_changed:function(){for(var e in this.mems)for(var t in this.mems[e])this.mems[e][t].btag2&&this.inherit_board_tags_changed_1(this.mems[e][t].btag2,this.mems[e][t],!pref.liveTag.inherit_board_tags)},inherit_board_tags_changed_1:function(e,t,a){for(var n=0;n<e.length;n++)this.retag_in_th_sub(e[n],t,a);for(var r in t){t.domain,t.board,t[r].no;this.retag(t[r],a&&t[r].tag.length>=pref.liveTag.max)}this.retag_db(),this.update_pn_buf.delayed_do()},ex_list_changed:function(){if(pref.liveTag.ex_list)for(var e in this.mems)for(var t in this.mems[e])for(var a in this.mems[e][t]){var n=this.mems[e][t][a],r=n.tag.length;this.exclude_tags(e+t+a,n,!0)&&this.retag(n,r>=pref.liveTag.max)}},exclude_tags:function(e,t,a){var n=pref_func.merge_obj5a(e,pref.liveTag.ex_list_obj5,null);if(n)for(var r=!1,o=0;o<n.length;o++)for(var s=0;s<2;s++)if(t[s])for(var i=t[s].length-1;i>=0;i--)n[o].test(t[s][i])&&(a&&this.delete_tags(t[s][i],e),t[s].splice(i,1),r=!0);return r},key_dirty:Object.create(null),tags_array_old:[],tags_proto:{pk:!1,in:!1,ex:!1,pn:null,mems_keys_obj:function(){var e={};for(var t of this.mems.keys())if(void 0===t.no)for(var a in t)e[t[a].key]=this.mems.get(t);else e[t.key]=this.mems.get(t);return e},mems_keys:function*(){for(var e of this.mems.keys())if(void 0===e.no)for(var t in e)yield e[t];else yield e},mems_keys_length:function(){var e=0;for(var t of this.mems.keys())if(void 0===t.no)for(var a in t)++e;else++e;return e},mems_keys_length_and_set_top:function(){var e=0,t={};for(var a of this.mems.keys()){var n=this.mems.get(a);if(void 0===t[n]&&(t[n]=0),void 0===a.no)for(var r in a)++t[n],++e;else++t[n],++e}for(var r in t)(t[r]>t[this.key]||t[r]==t[this.key]&&r<this.key)&&(this.key=r);return this.key===this.ref_tag&&(this.key=this.ref_tag),e},mems_boards:function(){var e={};for(var t of this.mems.keys())e[t.key.substr(0,t.key.lastIndexOf("/")+1)]=null;return e}},scan_regex:/#[^#, \.:;\n\|"<>&]+(?=[#, \.:;\n\|"<>&]|$)/g,update_tags_in_th_sub:function(e,t,a,n,r,o,s,i,l){for(var c=e.length,p=0;c<r&&p<a.length;){var _=a[p++],d=pref.liveTag.ci?_.toLowerCase():_;if(d===_&&(d=_),void 0===n[d]&&void 0===t[d]){if(t[d]=_,void 0===this.tags[_])if(void 0===this.tags_ci[d]){var u=new Map;this.tags_ci[d]={key:_,mems:u,ref_tag:_,num:0,ur:s,__proto__:this.tags_proto},_!==d&&(this.tags[_]=this.tags_ci[d]),null!==this.key_dirty[d]&&(this.tags_array_old[this.tags_array_old.length]=this.tags_ci[d])}else this.tags[_]=this.tags_ci[d];var f=this.tags[_].mems;if(_===this.tags[_].ref_tag)_=this.tags[_].ref_tag;else for(var m in f)if(_===f.get(m)){_=f.get(m);break}if(f.has(i))l||(this.key_dirty[d]=null);else{var h=null===o?i:i[o.no],g=f.get(h)
;void 0!==g&&g===_||(this.key_dirty[d]=null),f.set(h,_)}e[c++]=_}null===o?(void 0!==this.tags_reserved[d]||this.tags_ci[d].pk)&&this.tags_reserved_found_scan(d,!0,this.tags_reserved[d],this.tags_ci[d].pk,i):void 0!==this.tags_reserved[d]&&this.tags_reserved_found(d,!0,this.tags_reserved[d])}return p},retag_in_th_sub:function(e,t,a){if(a)this.tags[e]&&this.delete_tags(e,t.key,!0);else{this.update_tags_in_th_sub([],{},[e],{},1,null,0,t);var n=this.tags[e].mems;for(var r in t)n.has(r)&&n.delete(r)}},update_tags_in_th:function(e,t,a,n,r,o,s){var i=this.generate_ur(o[1]),l=[],c={};if(this.update_tags_in_th_sub(l,c,e,a,n,r,i,s),t)for(var p=this.update_tags_in_th_sub(l,c,t,a,n,r,i,s);p<t.length;){var _=t[p++],d=pref.liveTag.ci?_.toLowerCase():_;void 0===a[d]&&(c[d]!==_&&(this.key_dirty[d]=null),void 0===c[d]&&this.delete_tags(_,r.key))}for(var p in a)this.check_update_tags_color(a[p],i);for(var p=0;p<l.length;p++)this.check_update_tags_color(l[p],i);return e=null,this.keys_fix=c,l},remove_tags_in_th:function(e){var t=this.mems[e[0]][e[1]][e[2]];if(t){for(var a=e[0]+e[1]+e[2],n=0;n<2;n++)if(t[n])for(var r=t[n].length-1;r>=0;r--)this.delete_tags(t[n][r],a);var o=this.mems[e[0]][e[1]][e[2]].btags;if(o)for(var r=0;r<o.length;r++)this.key_dirty[pref.liveTag.ci?o[r].toLowerCase():o[r]]=null;pref3.stats.use&&stats.thread_removed(e),delete this.mems[e[0]][e[1]][e[2]],this.update_pn_buf.delayed_do()}},delete_tags:function(e,t,a){var n=pref.liveTag.ci?e.toLowerCase():e;if(this.key_dirty[n]=null,this.tags[e]&&(this.tags[e].mems.delete(this.mems.getFromName(t)),pref.liveTag.style&&this.update_ur_1(e),0==this.tags[e].mems.size)){null!==this.tags[e].pn&&this.tags[e].pn.parentNode===this.pn&&this.pn.removeChild(this.tags[e].pn);for(var r in this.active)this.tags[e][r]&&this.active[r]--;if(delete this.tags[e],a)this.delete_tags_buffered_list||(this.delete_tags_buffered_list=new Set),this.delete_tags_buffered_list.add(this.tags_ci[n]);else{for(var o=Object.keys(this.tags),s=this.tags_ci[n],r=0;r<o.length;r++)this.tags[o[r]]===s&&delete this.tags[o[r]];this.tags_ci[n].pn&&this.pn.removeChild(this.tags_ci[n].pn),delete this.tags_ci[n]}pref.debug_mode[3]&&console.log("Remove: "+e)}},delete_tags_buffered_list:null,delete_tags_buffered:function(){for(var e=Object.keys(this.tags),t=0;t<e.length;t++)this.delete_tags_buffered_list.has(this.tags[e[t]])&&delete this.tags[e[t]];for(var t in this.tags_ci)this.delete_tags_buffered_list.has(this.tags_ci[t])&&(this.tags_ci[t].pn&&this.pn.removeChild(this.tags_ci[t].pn),delete this.tags_ci[t]);this.delete_tags_buffered_list=null},check_update_tags_color:function(e,t){var a=this.tags[e].ur;this.tags[e].ur|=t,~a&t&&this.update_tag_node(e)},rm_404:function(e,t,a){if(this.mems[e]&&this.mems[e][t]){var n=this.mems[e][t];for(var r in n)void 0===a[r]&&this.rm_404_1(e,t,r)}},rm_404_1:function(e,t,a,n){n||(pref.test_mode[65]||pref.archive.IDB.auto_clean&&IDB.req(e,t,a,"pruned_time",Date.now(),"check_clean"),pref.test_mode[67]||archiver.clean_list(e,t,a),!pref.test_mode[65]&&pref.archive.IDB.auto_restore&&cataLog.threads[e+t+a]&&cataLog.restore_th_from_IDB(e,t,a)),cataLog.remove_thread(e+t+a),this.remove_tags_in_th([e,t,a]),pref[cataLog.embed_mode].deleted_posts.auto_clean&&site2[e].clean_up_deleted_posts_1(t+a)},tooltip:function(e,t){var a,n=e.target;if("checkbox"===n.type){var r=n.name.substr(-2,2);a=n.getAttribute("name").slice(0,-3),t+=("pk"===r?"Pick up":"in"===r?"Show":"Hide")+" threads which have "+a+"."}else{a=n.getAttribute("name"),t+=a+": "+liveTag.make_info(a)+"<br>";var o=new RegExp("^"+site.nickname);for(var s of liveTag.tags[a].mems.keys())t+=s.key.replace(o,"")+", "}pref_func.tooltips.show_1.call(n,e,t,null,"checkbox"!==n.type)},boardlist_click_entry:function(e){if(!e.ctrlKey){e.preventDefault();var t=this.textContent;liveTag.cbx_changed(t,pref.liveTag.click_func_bl,null,this)}},generate_ur:function(e){return e>>16!=0?3:0!=(65535&e)?1:0},CountNR:function(){var e=function(){this.nrtm=0,this.nr=0,this.nth=0};return e.prototype={count:function(e){if(786432&e[0]){var t=65535&e[1];t&&(this.nrtm+=e[1]>>16,this.nr+=t,this.nth++)}}},e}(),update_ur:function(e,t,a){var n=common_func.fullname2dbt(e),r=this.mems[n[0]][n[1]][n[2]];this.mems[n[0]][n[1]].nr=-1;for(var o=0;o<2;o++)if(r[o])for(var s=0;s<r[o].length;s++)a?this.update_ur_1(r[o][s]):this.tags[r[o][s]]&&this.check_update_tags_color(r[o][s],t)},update_ur_1:function(e){var t=this.tags[e].ur,a=0;if(pref.test_mode[24])for(var n of this.tags[e].mems_keys())a|=liveTag.generate_ur(n[2][1]);else{var r=this.tags[e].mems_keys_obj();for(var n in r){var o=this.mems.getFromName(n);o&&(a|=liveTag.generate_ur(o[2][1]))}}t!=a&&(this.tags[e].ur=a,this.update_tag_node(e))},count_ur:function(e){var t=0,a={},n=new this.CountNR;if(pref.test_mode[24])for(var r of this.tags[e].mems_keys())n.count(r[2]),a[r.domain+r.board]=null,t++;else{var o=this.tags[e].mems_keys_obj();for(var r in o){var s=common_func.fullname2dbt(r),i=this.mems[s[0]][s[1]][s[2]][2];i&&n.count(i),a[s[0]+s[1]]=null}t=this.tags[e].mems_keys_length()}var l=Object.keys(this.tags[e].mems_boards()).length;return[n.nrtm,n.nr,n.nth,t,Object.keys(a).length,l]},make_info:function(e){var t=liveTag.count_ur(e);return"U: "+t[0]+"/"+t[1]+"/"+t[2]+" / T: "+t[3]+" / B: "+t[4]+"/"+t[5]},tag_onmouseover:function(e){pref.liveTag.show_info_onmouseover&&pref_func.tooltips.show_1.call(this,e,liveTag.make_info(this.textContent),null,!0)},cbx_changed:function(e,t,a,n){if("pkin"===t)this.tags[e].pk!==!this.tags[e].in&&(this.tags[e].pk=!this.tags[e].in,null!==this.tags[e].pn&&(this.tags[e].pn.childNodes[0].checked=this.tags[e].pk),this.cbx_onchange(e,"pk",a)),this.tags[e].in!==this.tags[e].pk&&(this.tags[e].in=this.tags[e].pk,null!==this.tags[e].pn&&(this.tags[e].pn.childNodes[1].checked=this.tags[e].in),this.cbx_onchange(e,"in"));else{var r=this.tags[e].in;"in"!==t&&("inex"!==t||this.tags[e].in===!1&&this.tags[e].ex===!0)||(this.tags[e].in=!this.tags[e].in,null!==this.tags[e].pn&&(this.tags[e].pn.childNodes[1].checked=this.tags[e].in),this.cbx_onchange(e,"in")),"ex"!==t&&("inex"!==t||r===!1&&this.tags[e].ex===!1)||(this.tags[e].ex=!this.tags[e].ex,null!==this.tags[e].pn&&(this.tags[e].pn.childNodes[2].checked=this.tags[e].ex),this.cbx_onchange(e,"ex"))}this.update_tag_node(e,n)},filter_onchange:function(e,t){e.rexps=common_func.kwd_prep_regexp(e),t||this.update_pn(e===pref.catalog.filter.tag_search)},tags_reserved:Object.create(null),tags_reserved_found_scan:function(e,t,a,n,r){(a||n)&&(scan.list_nup.add_board(r,0),scan.scan("b",r.domain)),void 0!==a&&this.tags_reserved_found(e,t,a)},tags_reserved_found:function(e,t,a){this.tags_ci[e][a?"pk":"in"]!=t&&this.cbx_changed(e,a?"pkin":"in",!0),delete this.tags_reserved[e]},tags_reserved_init:function(e,t){this.tags_reserved=Object.create(null);for(var a={},n=0;n<e.length;n++){var r="#"===e[n][1],o=pref.liveTag.ci?e[n].toLowerCase():e[n];if(r&&(o=o.substr(1)),this.tags_ci[o]){if(this.tags_reserved_found(o,t,r),t&&r){var s=liveTag.tags_ci[o].mems_boards();for(var i in s)a[i]=null}}else t&&(this.tags_reserved[o]=r)}return a},update_pn_last_filter_active:!1,sort_func:function(e,t){return t.num-e.num||t.mems.size-e.mems.size||(t.key>e.key?-1:1)},update_pn_disp_func:function(e,t){if(null===e)return 0;for(var a=0;a<e.length;a++)if(e[a].test(t))return 1;return 0},update_pn_buf:null,update_pn:function(e){if(0!==this.pn){if(null===this.pn){if(this.pn=document.getElementsByName("catalog.filter.tag_list")[0],!this.pn)return void(this.pn=0);this.pn.style.height="16px",this.pn.style.width="150px",this.pn.onchange=this.cbx_onchange_entry,this.filter_onchange(pref.catalog.filter.tag_search,!0)}var t=this.tags_array_old,a=0,n=0;for(var r in this.key_dirty)this.tags_ci[r]?this.tags_ci[r].num=pref.liveTag.ci?this.tags_ci[r].mems_keys_length_and_set_top():this.tags_ci[r].mems_keys_length():n++,a++;(a||pref.test_mode[73])&&t.sort(this.sort_func);var o=0!=pref.catalog.filter.tag_search.rexps.length||this.update_pn_last_filter_active;if(o||n){for(var s=0!==pref.catalog.filter.tag_search.rexps.length&&this.pn.firstChild?null:document.createDocumentFragment(),i=0,l=0;l<t.length;l++){var c=t[l].key,p=pref.liveTag.ci?c.toLowerCase():c,_=p in this.key_dirty,d=this.tags_ci[p];if(d){var u=d.pn;if(e||_){var f=this.update_pn_disp_func(pref.catalog.filter.tag_search.rexps,p);null!==u?0===f?(this.pn.removeChild(u),d.pn=null):(_&&(d.pn.childNodes[3].textContent=d.num+": "+c),this.pn.childNodes[i]!==u&&this.pn.insertBefore(u,this.pn.childNodes[i]||null),i++):1==f&&(u=document.createElement("span"),u.innerHTML='<input type="checkbox" name="'+p+'.pk" '+(d.pk?"checked":"")+'><input type="checkbox" name="'+p+'.in" '+(d.in?"checked":"")+'><input type="checkbox" name="'+p+'.ex" '+(d.ex?"checked":"")+'><span name="'+c+'">'+d.num+": "+c+"</span><br>",s?s.appendChild(u):this.pn.insertBefore(u,this.pn.childNodes[i++]||null),d.pn=u)}else u&&i++}else t.splice(l--,1);if(_&&--a<=0&&!o)break}s&&!pref.test_mode[74]&&this.pn.appendChild(s)}this.tags_array_old=t,this.key_dirty=Object.create(null),pref.virtualBoard.show&&!e&&this.update_boardlist(),this.update_pn_last_filter_active=0!=pref.catalog.filter.tag_search.rexps.length}},cbx_onchange_entry:function(e){var t=e.target,a=t.name.slice(0,-3),n=t.name.substr(-2,2);liveTag.tags[a][n]=t.checked,liveTag.cbx_onchange(a,n),liveTag.update_tag_node(a)},cbx_onchange:function(e,t,a){var n=this.tags[e][t];if(this.active[t]+=n?1:-1,"pk"===t&&(n&&!this.tags[e].in&&(this.tags[e].in=!0,this.active.in+=1,null!==this.tags[e].pn&&(this.tags[e].pn.childNodes[1].checked=!0)),n)){var r=this.tags[e].mems_boards();!a&&0!=Object.keys(r).length&&catalog_obj&&null!=catalog_obj.catalog_func()&&scan.scan_ui("refresh_tag",{tgts:r,options:{callback:function(){scan.scan("t")},priority:6}})}"in"!==t&&"pk"!==t||(this.active.in===(n?1:0)&&(pref.catalog.filter.tag=n,pref_func.mirror_targets.pn12_0_4&&pref_func.apply_prep(pref_func.mirror_targets.pn12_0_4.getElementsByTagName("input")["catalog.filter.tag"],!1)),catalog_obj&&null!=catalog_obj.catalog_func()&&catalog_obj.catalog_func().catalog_filter_changed())},search_by_tags:function(e){var t=!this.active.in;if(this.active.in)for(var a=0;a<2;a++)if(e[a])for(var n=0;n<e[a].length;n++)if(e[a][n]in this.tags&&this.tags[e[a][n]].in){t=!0;break}if(t&&this.active.ex)for(var a=0;a<2;a++)if(e[a])for(var n=0;n<e.length;n++)if(e[a][n]in this.tags&&this.tags[e[a][n]].ex){t=!1;break}return t},keys_fix:null,prep_tags:function(e,t){var a=this.mems.init(e),n=a;if(65536&n[2][0]||t){var r=n[2];65536&r[0]&&(!pref.test_mode[64]&&pref[cataLog.embed_mode].deleted_posts.merge&&archiver.prep_deleted_posts(e,a),pref.test_mode[67]||archiver.check_op(e,a),pref.liveTag.watch_all&&e.time_created&&cataLog.set_watch_time_thread(e.key,cataLog.embed_mode,e.time_created,e.time_posted,e,r),r[0]=4294836224&r[0]);var o,s=[[],[]];pref.liveTag.inherit_board_name&&(o=pref.liveTag.lock_board_name?0:1,s[o][0]="#"+e.board.replace(/\//g,"")),pref.liveTag.inherit_board_tags&&n.btag2&&(o=pref.liveTag.lock_board_tags?0:1,s[o]=s[o].concat(n.btag2));var i=site2[e.domain].check_reply.check_t1_op(e);if(0!=i.length&&(o=pref.liveTag.lock_tags_in_op?0:1,s[o]=s[o].concat(i)),this.exclude_tags(e.key,s),t)for(var l=0;l<2;l++)t[l]&&(s[l]=s[l].concat(t[l]));e.parse_funcs.has_editing&&e.posts[0].editing&&0!=s[0].length&&(s[0]=this.extract_tags_trim_editing(e,n,s[0])),0!=s[0].length&&(n[0]=this.update_tags_in_th(s[0],null,{},s[0].length<pref.liveTag.max?s[0].length:pref.liveTag.max,e,r,this.mems[e.domain][e.board])),0!=s[1].length?this.extract_tags(e,s[1],this.keys_fix):(null!==n[1]&&(n[1]=null),this.update_pn_buf.delayed_do())}return n},update_tags_in_editing_posts:function(e,t){for(var a=!1,n=t.ed_t.length-1;n>=0;n--)if("#"!==t.ed_t[n][0]){var r=e.posts_obj?e.posts_obj[t.ed_t[n]]:e.parse_funcs.posts_obj(e,t.ed_t[n]);if(r&&!r.editing){site2[e.domain].wrap_to_parse.posts({posts:[r],__proto__:e});var o=site2[e.domain].check_reply.check_t1_op(r);0!=o.length&&(a=!0),t.ed_t=t.ed_t.slice(0,n).concat(o).concat(t.ed_t.slice(n+1))}}return pref.debug_mode[24]&&console.log(e.key+": retag_req: "+o+", "+a+", "+t.ed_t),a?this.extract_tags(e,t.ed_t,null,null,!0):o?this.extract_tags_trim_editing(e,t,t.ed_t,!0)&&void 0:void 0},extract_tags_trim_editing:function(e,t,a,n){for(var r=null,o=a.length-1;o>=0;o--)"#"!==a[o][0]&&(r||(r=a.slice(0,o+1)),a.splice(o,1));return(r||n)&&(t.ed_t=n||!t.ed_t?r:r.concat(t.ed_t)),pref.debug_mode[24]&&console.log(e.key+": lth.ed_t: "+t.ed_t),a},extract_tags:function(e,t,a,n,r){var o=this.mems[e.domain][e.board][e.no];if(e.parse_funcs.has_editing&&(t=this.extract_tags_trim_editing(e,o,t,r)),!a){this.keys_fix={};var s=o[0];if(null!==s&&0!=s.length)if(pref.liveTag.ci)for(var i=0;i<s.length;i++)this.keys_fix[s[i].toLowerCase()]=s[i];else for(var i=0;i<s.length;i++)this.keys_fix[s[i]]=s[i]}var l=this.update_tags_in_th(t,o[1],this.keys_fix,pref.liveTag.max-o[0].length,e,o[2],this.mems[e.domain][e.board],n);return(0!=l.length||o[1]&&0!==o[1].length)&&(o[1]=l),this.update_pn_buf.delayed_do(),this.keys_fix=null,o},tags_boardlist:null,update_boardlist:function(e){if(site.components.boardlist){null===this.tags_boardlist&&(this.tags_boardlist=[],pref_func.settings.onchange_funcs["virtualBoard.search.show"](null,!0),this.filter_onchange(pref.virtualBoard.search,!0));for(var t=0,a=e,n=0,r=0,o="both"===pref.virtualBoard.p_board&&pref.virtualBoard.p_remove,s=pref.virtualBoard.search.show&&0!=pref.virtualBoard.search.rexps.length;r<pref.virtualBoard.max&&t<this.tags_array_old.length;){var i=this.tags_array_old[t].key;o&&"/"+i.substr(1)+"/"in this.mems[site.nickname]?n++:s&&!this.update_pn_disp_func(pref.virtualBoard.search.rexps,pref.liveTag.ci?i.toLowerCase():i)||(this.tags_boardlist[r]!==i&&(this.tags_boardlist[r]=i,a=!0),r++),t++}r!=this.tags_boardlist.length&&(this.tags_boardlist.splice(r,this.tags_boardlist.length-r),a=!0),a&&site2[site.nickname].show_boardlist(this.tags_boardlist.slice(),this.boardlist_click_entry)}},update_boardlist_1:function(){var e=[],t=new DelayBuffer(function(){for(var t=Object.create(null),a=0;a<e.length;a++)t[liveTag.tags_ci[pref.liveTag.ci?e[a].toLowerCase():e[a]].key]=null;site2[site.nickname].show_boardlist_physical_board(Object.keys(t),liveTag.boardlist_click_entry),e=[]},500).get_binded_delayed_do();return function(a){site.components.boardlist&&(e[e.length]=a,t())}}(),update_tag_node:function(e,t){if(null!==cataLog.threads){var a=liveTag.tags[e].mems_keys_obj();for(var n in a)cataLog.threads[n]&&cataLog.threads[n][24]&&cataLog.threads[n][24][3]&&this.update_tag_node_1(cataLog.threads[n][24][3].getElementsByClassName(pref.script_prefix+"_tag"),a[n])}e=this.tags_ci[pref.liveTag.ci?e.toLowerCase():e].key,t?this.color_tag_node(t,e):this.tags_boardlist&&this.tags_boardlist.indexOf(e)!=-1&&this.update_tag_node_1(site.components.boardlist.getElementsByClassName(pref.script_prefix+"_tag"),e)},update_tag_node_1:function(e,t){for(var a=t.toLowerCase(),n=0;n<e.length;n++){var r=e[n].textContent;if(r===t||pref.liveTag.ci&&r.toLowerCase()===a){this.color_tag_node(e[n],t);break}}},color_tag_node:function(e,t){var a=this.tags[t].in?pref.liveTag.style_in_str:!pref.liveTag.style||this.tags[t].ur<=0?null:this.tags[t].ur>=2?pref.liveTag.style_urtm_str:pref.liveTag.style_ur_str;a?e.setAttribute("style",a):e.removeAttribute("style")},update_tag_string:function(e,t,a,n){var r=document.createElement("span");if(r.setAttribute("name",pref.script_prefix+"_tag_parent"),e)for(var o=0;o<e.length;o++){0!=o&&t&&r.appendChild(document.createTextNode(t));var s=e[o],i=document.createElement(n?n:"span");i.setAttribute("class",pref.script_prefix+"_tag"),i.textContent=s,this.color_tag_node(i,s),i.onclick=a,i.onmouseover=this.tag_onmouseover,r.appendChild(i)}return r},tag_node_onclick:function(){var e=this.textContent;liveTag.cbx_changed(e,pref.liveTag.click_func)}};liveTag.update_pn_buf=new DelayBuffer(liveTag.update_pn.bind(liveTag),pref.liveTag.disp_delay),liveTag.tags_ci=Object.getPrototypeOf(liveTag.tags),thread_reader_init();var IDB=function(){function e(e){console.log("IDB: ERROR: ",e),X.report({err_str:"IDB_ERROR:"+e.target.error.name});for(var t of S.keys())console.log(S.get(t));console.log("last_closed: ",I)}function t(e){pref.debug_mode[21]&&console.log("IDB: BLOCKED: "+e.oldVersion+" -> "+e.newVersion)}function a(e){console.log("IDBT: ABORT: "+e.target.error.name,e),X.report({err_str:"IDBT_ABORT:"+e.target.error.name});var t=e.target,a=t.db;navigator.webkitTemporaryStorage&&navigator.webkitTemporaryStorage.queryUsageAndQuota(console.log.bind(console)),x(a,t,"IDBT_abort:"+t.error.name)}function n(e){console.log("IDBT: ERROR: "+e.target.error.name,e),X.report({err_str:"IDBT_ERROR:"+e.target.error.name});var t=e.target.transaction;x(e.target.db||e.target.transaction&&e.target.transaction.db,t,"IDBT_onerror:"+t.error.name)}function r(e){e.target.onsuccess=null,o(e,!0)}function o(e,t){var a=e.target.result;D[a.name]=a.version,delete z[a.name+(t?"vc":"rw")];var n=t&&U[a.name]||R[a.name];if(pref.debug_mode[20]){var r=n&&n.debug_query()||null;console.log("IDB: opened: "+(S.size+1)+" "+a.name.replace(/^[^\/]*/,"")+" v"+a.version+", "+(r&&r.length)+" req(s), "+e.type+", "+(r&&r.coms))}var o={type:e.type,tr_count:1,reqs:n,pass:0,wdg:null,crawler:1,oss:{},tr_info:new Map,req_kinds:{},coms:r&&r.coms,done:0,done_put:0};if(S.set(a,o),n){for(var l=0;l<a.objectStoreNames.length;l++)o.oss[a.objectStoreNames[l]]=null;if(t){var _=e.target.transaction;if(T(a),u(_,function(){w({target:{db:a}})}),1==a.version)return delete z[a.name+"rw"],pref4.archive.IDB_board_sel_options=null,a.createObjectStore("Meta"),i(a,t);for(var d=0;;){P();var f=n.shift();if(o.pass++,!f)break;pref.debug_mode[20]&&o.done++,pref.debug_mode[22]&&"put"!==f.kind&&console.log("req_upgrade: "+f.no+", "+f.kind+", "+f.key+", "+n.debug_query().length),o.req_kinds[f.kind]=null;var m=null===o.oss[f.no];"put"===f.kind?m?(B(R,a.name,f),pref.debug_mode[22]&&d++):(p(a,f,w),o.oss[f.no]=null,pref.debug_mode[22]&&console.log("req_upgrade: "+f.no+", "+f.kind+", "+f.key+", "+n.debug_query().length)):"delete_th"===f.kind&&m&&c(a,f,_)}pref.debug_mode[22]&&d&&console.log("req_upgrade: downgraded: "+d),i(a,t)}else{var h=function e(){s(a,n,t,e)};o.complete_func=h,s(a,n,t,h)}}else i(a,t)}function s(e,t,a,n){var r=S.get(e);if(r){P();var o=void 0!==z[e.name+"vc"]?null:t.shift();if(r.pass++,o){pref.debug_mode[20]&&r.done++,pref.debug_mode[22]&&"put_m"!==o.kind&&console.log(e.name.replace(/^[^\/]*/,"")+o.no+", "+o.kind+", "+o.key+", "+t.debug_query().length);var l=null===r.oss[o.no];if("get_all_m"===o.kind){for(var c=[],p={},u=0;u<o.reqs.length;u++)null===r.oss[o.reqs[u].no]&&(c[c.length]=o.reqs[u],p[o.reqs[u].no]=null);0!==c.length?v(e,{nos:Object.keys(p),reqs:c},n):n()}else if("list_os"===o.kind)o.obj(site.nickname,e.name.substr(pref.script_prefix.length+1),Array.prototype.slice.call(e.objectStoreNames).filter(function(e){return"Meta"!==e})),n();else if("put_m"===o.kind){for(var c=[],p={},u=0;u<o.reqs.length;u++)null!==r.oss[o.reqs[u].no]?B(U,e.name,o.reqs[u]):(c[c.length]=o.reqs[u],p[o.reqs[u].no]=null);pref.debug_mode[22]&&console.log(e.name.replace(/^[^\/]*/,"")+(c[0]&&c[0].no||"skipped")+"("+Object.keys(p).length+"), "+o.kind+"("+c.length+"), "+o.key+", "+t.debug_query().length),c.length>1?(o.reqs=c,o.nos=Object.keys(p),_(e,o,n)):1==c.length?_(e,c[0],n):n()}else if("put"===o.kind)l?_(e,o,n):(B(U,e.name,o),n());else if("delete"===o.kind)l?d(e,o,n):n();else if("clean_up"===o.kind||"clean_m"===o.kind){O[e.name]||(O[e.name]={list:[],write:null});var f=O[e.name].list,h=f.length;if("clean_up"===o.kind){for(var p={Meta:null,__proto__:o.obj},u=0;u<f.length;u++)p[f[u].no]=null;for(var b=Date.now(),y=e.objectStoreNames,u=0;u<y.length;u++)null!==p[y[u]]&&(f[f.length]={no:y[u],pruned_time:b})}else for(var u=0;u<o.reqs.length;u++)null===r.oss[o.reqs[u].no]&&(f[f.length]={no:o.reqs[u].no,pruned_time:o.reqs[u].obj});null===O[e.name].write?(O[e.name].write=!1,m(e,o,n)):g(e,null,n,f.length!==h)}else n();r.crawler<pref.archive.IDB.nof_tr&&!t.isEmpty&&(r.crawler++,s(e,t,a,n))}else 0==--r.crawler&&i(e,a)}}function i(e,t){w({target:{db:e}});var a=t&&U[e.name]&&U||R;a[e.name]&&a[e.name].isEmpty&&delete a[e.name],M[e.name]&&l(e.name),t?R[e.name]&&!R[e.name].isEmpty&&A(e.name):U[e.name]&&!U[e.name].isEmpty&&A(e.name,!0),0===Object.keys(R).length&&0===Object.keys(U).length&&0===Object.keys(M).length&&K.stop()}function l(e){R[e]?R[e].push_all(M[e]):R[e]=M[e],delete M[e]}function c(e,t,a){e.deleteObjectStore(t.no),pref.debug_mode[23]&&console.log("IDB: delete_th: "+e.name+t.no+", "+e.objectStoreNames.length)}function p(e,t,a){T(e);var n=e.createObjectStore(t.no).transaction;u(n,function(n){return function(r){pref.test_mode[66]?(B(R,e.name,t),a({target:{db:e}})):_(e,t,a),n&&n(r)}}(n.oncomplete))}function _(t,a,n){var r=a.reqs||[a];try{for(var o=u(t.transaction(a.nos||a.no,"readwrite",a),n,a,t),s=0;s<r.length;s++){var i=r[s];if(pref.test_mode[82]&&i.obj instanceof Blob)if(pref.test_mode[83])i.obj=null;else if(pref.test_mode[84]){for(var l="";2*l.length<i.obj.size;)l+=Math.random();i.obj=l}else{for(var c=[],p=0;2*p<i.obj.size;p++)c[p]=Math.floor(65536*Math.random());i.obj=String.fromCharCode.apply(null,c)}pref.debug_mode[23]&&console.log("put_"+(a.nos?"m: ":"1: ")+t.name.replace(/^[^\/]*/,"")+i.no+", "+i.key+("posts"===i.key?":"+i.obj.length:"")+(a.nos?" "+(s+1)+"/"+a.nos.length+"/"+a.reqs.length:""));o.objectStore(i.no).put("posts"!==i.key?i.obj:JSON.stringify(i.obj,archiver.store_json_func),"posts"!==i.key?i.key:i.key+"_"+i.obj[0].no).onerror=e}pref.debug_mode[20]&&(S.get(t).done_put+=r.length)}catch(e){console.log("IDB: fail to put: "+e.name+": "+JSON.stringify(i,["no","key","kind"]),e,S.get(t)),"InvalidStateError"===e.name&&(B(M,t.name,i),pref.debug_mode[20]&&console.log("IDB: re-scheduled:")),n({target:{db:t}})}}function d(e,t,a){u(e.transaction(t.no,"readwrite"),a).objectStore(t.no).delete(t.key)}function u(e,t,r,o){return e.oncomplete=r?f:t,e.onabort=a,e.onerror=n,r&&S.get(o).tr_info.set(e,{req:r,func:t}),e}function f(e){var t=S.get(e.target.db);if(t){var a=t.tr_info.get(e.target).func;t.tr_info.delete(e.target),a&&a(e)}}function m(e,t,a){e.objectStoreNames.contains("Meta")?u(e.transaction("Meta","readwrite"),a).objectStore("Meta").get("pruned_time").onsuccess=h:(O[e.name].write=!0,g(e,t,a,!0))}function h(e,t){var a=e.target.transaction.db,n=e.target.result;if(n){var r=S.get(a),o=r&&r.oss||{};n=n.filter(function(e){return null===o[e.no]});for(var s={},i=0;i<n.length;i++)s[n[i].no]=null;O[a.name].list=n.concat(O[a.name].list.filter(function(e,t,a){return null!==s[e.no]}))}O[a.name].write=!0,g(a,null,null,!0)}function g(e,t,a,n){for(var r=O[e.name].list,o=Date.now()-36e5*pref.archive.IDB.prune,s=0;s<r.length&&r[s].pruned_time<o;)pref.archive.IDB.auto_restore_remove&&liveTag.rm_404_1(site.nickname,e.name.replace(/^[^\/]*/,""),r[s].no,!0),pref.archive.IDB.prune_flush?B(R,e.name,{no:r[s++].no,key:null,obj:b,kind:"get_all"},!0):B(U,e.name,{no:r[s++].no,key:null,obj:null,kind:"delete_th"},!0);s>0&&r.splice(0,s),O[e.name].write&&(n||0!==s)&&B(R,e.name,{no:"Meta",key:"pruned_time",obj:r,kind:"put"}),a&&a()}function b(e,t,a,n){var r="CatChan_archive_pruned_"+e+"-"+t.slice(1,-1)+"-"+a+".tar",o="pruned_"+e+t+a+Date.now();archiver.event_funcs.export_thread(e,t,a,n,o,r),j(e,t,a,null,null,"delete_th")}function v(e,t,a){for(var n=u(e.transaction(t.nos,"readonly"),a),r=0;r<t.reqs.length;r++){var o=t.reqs[r];pref.debug_mode[23]&&console.log("get_all: "+e.name.replace(/^[^\/]*/,"")+o.no+", "+o.key);var s=n.objectStore(o.no).openCursor("posts"===o.key?IDBKeyRange.bound("posts","postt",!1,!0):void 0);s.onsuccess=k,o.result={},C.set(s,o)}}function y(e){var t=e.target.transaction.db,a=S.get(t);return a&&a.pass++,t}function k(e){var t=(y(e),e.target),a=C.get(t),n=e.target.result;if(n)a.result[n.key]=n.key.indexOf&&0===n.key.indexOf("posts")?JSON.parse(n.value):n.value instanceof ArrayBuffer?common_func.arraybuffer2blob(n.key,n.value):n.value,n.continue();else{C.delete(t);var r=e.target.transaction.db.name.replace(pref.script_prefix+".",""),o=e.target.source.name;if(setTimeout(function(e,t,a){return function(){e.obj(site.nickname,t,a,e.result)}}(a,r,o),0),pref.debug_mode[29]){var s=0;for(var i in a.result)s+=0===i.indexOf("posts")?2*JSON.stringify(a.result[i]).length:a.result[i]&&a.result[i].size;console.log("IDB: "+r+o+": "+Object.keys(a.result).length+" files, "+s.toLocaleString()+" bytes.")}}}function w(e){var t=e.target.source&&e.target.source.transaction.db||e.target.db||e.target.result,a=S.get(t);a&&(1!==a.tr_count?a.tr_count-=1:N(t,a))}function x(e,t,a){var n=S.get(e);if(n&&"readonly"!==t.mode){var r=n.tr_info.get(t).req;B("delete_th"===r.kind?U:M,e.name,r),console.log(a+": close and re-req, "+r.kind)}}function N(e,t,a){if(t||(t=S.get(e)),a&&t)for(var n of t.tr_info.keys())x(e,n,a);S.delete(e);var r=!a&&void 0!==t.req_kinds.delete_th&&1===Object.keys(t.req_kinds).length||1==e.version;pref.debug_mode[26]&&r&&console.log("Hit the case of test_mode[78]"),!r||pref.test_mode[78]?e.close():setTimeout(function(){e.close()},0),pref.debug_mode[20]&&console.log("IDB: closed: "+S.size+" "+e.name.replace(/^[^\/]*/,"")+" v"+e.version+", "+(t?t.type+", done:"+t.done+", done_put:"+t.done_put+", "+t.coms:"")),t&&(t.db=e),I=t,P()}function T(e){S.get(e).tr_count+=1}function j(e,t,a,n,r,o){if(e===site.nickname){var s=pref.script_prefix+"."+t,i={no:a,key:n,obj:r,kind:o};B("delete_th"===o?U:R,s,i,!0)}else"function"==typeof r&&(H[e+t+a]=r,r="sub_callback"),pref.test_mode[86]&&r instanceof ArrayBuffer?send_message(e,["IDB",["ACC",[e,t,a,n,null,o]]],null,[r]):send_message(e,["IDB",["ACC",[e,t,a,n,r,o]]])}function A(a,n,s){var i=a+(n?"vc":"rw");if(void 0!==z[i]&&(!s||++z[i]<S.size))return void(pref.debug_mode[27]&&s&&console.log("IDB: WATCHDOG: "+i+", "+z[i]));z[i]=0;var l=window.indexedDB.open(a,n&&D[a]+1||void 0);l.onerror=e,l.onsuccess=o,l.onupgradeneeded=r,l.onblocked=t}function E(e,t,a,n,r,o){if(e===site.nickname){var s={no:a,key:n,obj:r,kind:o};B("delete_th"===o?U:R,t,s,!0)}}function B(e,t,a,n){if(W++,!X&&q?(X=q.shift("limegreen","w","IDB",0),X.report({start:Date.now(),prog_str:"Opening"})):P(),e[t]){var r=e===R&&e[t].isEmpty;if(e[t].push(a),r)for(var o of S.keys()){var s=S.get(o);if(s.crawler<pref.archive.IDB.nof_tr&&o.name===t&&"success"===s.type){s.crawler++,setTimeout(s.complete_func,100);break}}}else e[t]=new F(t,e!==U,a),n&&A(t,e===U);K.start(1e3*pref.archive.IDB.watchdog)}function L(){var e=0;for(var t of S.keys())e+=S.get(t).crawler;for(var a=[0,0,0,0,0,0,Object.keys(U).length,Object.keys(R).length,Object.keys(M).length,e,S.size,Object.keys(z).length],n=[U,R,M],r=0;r<3;r++)if(a[r+6])for(var o in n[r])a[r+3]+=n[r][o].length,a[r]+=n[r][o].length_whole;return{sums:a,total:a.reduce(function(e,t){return e+t}),str:a.join("/")+"/"+W}}var C=new Map,I=null,S=new Map,O={},D={},z={},U={},R={},M={},H={},F=function(e,t,a){this.ary=[],this.ary_ro=[],this.allow_multi=t,this.reqs[e]||(this.reqs[e]={}),this.reqs=this.reqs[e],this.cls={},a&&this.push(a),this.cl=null,this.cl_idx=0};F.prototype={shift:function(){for(var e=this.allow_multi?pref.archive.IDB.nof_cl_max:1,t=0;t<this.ary_ro.length&&t<e&&"get_all"===this.ary_ro[t].kind;)t++;if(0!=t)return{kind:"get_all_m",reqs:this.ary_ro.splice(0,t)};if(0!==this.ary_ro.length)return this.ary_ro.shift();if(0===this.ary.length&&!this.cl)return null;if(pref.test_mode[79]){for(;t<e;){var a=this.ary[t];if(!a)break;if(a.cl&&(this.ary=this.ary.slice(0,t+1).concat(a.cl,this.ary.slice(t+1)),a.cl=null),"put"!==a.kind)break;this.cls[a.no]=null,delete this.cls[a.no+a.key],t++}return t>1?{kind:"put_m",reqs:this.ary.splice(0,t)}:this.ary.shift()}var n=[];if(pref.test_mode[81])for(;n.length<e;){var a;if(null===this.cl){if(!(a=this.ary[t])||"put"!==a.kind)break;t++,a.cl&&(this.cls[a.no]=null,this.cl=a.cl,this.cl_idx=0,a.cl=null)}else a=this.cl[this.cl_idx++],this.cl_idx>=this.cl.length&&(this.cl=null);n[n.length]=a,delete this.reqs[a.no+a.key]}else{for(var r;n.length<e;){var a=this.ary[t];if(!a||"put"!==a.kind)break;if(void 0!==r&&(!a.no||r!==a.no))break;a.cl?(void 0===a.idx&&(this.ary[t]={kind:"put",cl:[a].concat(a.cl),idx:0,no:a.no},a.cl=null,a=this.ary[t],this.cls[a.no]=a),a.idx>=a.cl.length-1&&(this.cls[a.no]=null,t++),a=a.cl[a.idx++]):(this.cls[a.no]=null,t++),n[n.length]=a,delete this.reqs[a.no+a.key],n.length===pref.archive.IDB.nof_cl-1&&(r=a.no)}if(this.ary[t]&&this.ary[t].cl&&this.ary[t].idx<this.ary[t].cl.length){var o=this.ary.splice(t,1)[0];this.ary[this.ary.length]=o}}return t>0&&this.ary.splice(0,t),0===t&&this.ary[0]&&"check_clean"===this.ary[0].kind&&(this.cls.check_clean=null),n.length>1?{kind:"put_m",reqs:n}:n.length>0?n[0]:this.ary.shift()},push:function(e){if("get_all"===e.kind||"list_os"===e.kind)return void(this.ary_ro[this.ary_ro.length]=e);if("put"===e.kind)var t=e.no+e.key,a=this.reqs[t];if(a)a.obj="posts"===e.key?a.obj.concat(e.obj):e.obj;else if(t){"posts"!==e.key&&"pruned_time"!==e.key&&"posts_deleted"!==e.key||(this.reqs[t]=e);var n=this.cls[e.no];n?n.cl?n.cl[n.cl.length]=e:n.cl=[e]:(this.ary[this.ary.length]=e,this.cls[e.no]=e)}else if("check_clean"===e.kind){var t=null+e.key,a=this.cls[t];a?a.reqs[a.reqs.length]=e:(e={kind:"clean_m",reqs:[e],no:null},this.cls[t]=e,this.ary[this.ary.length]=e)}else this.ary[this.ary.length]=e},push_all:function(e){for(;!e.isEmpty;)this.push(e.shift())},get length(){return this.ary.length+this.ary_ro.length},get length_whole(){for(var e=0,t=0;t<this.ary.length;t++)e+=this.ary[t].cl?this.ary[t].cl.length-(this.ary[t].idx||0):1;return e+this.ary_ro.length},get isEmpty(){return 0===this.ary.length&&!this.cl&&0===this.ary_ro.length},reqs:{},debug_query:function(){for(var e=Array.prototype.concat.apply(this.ary_ro,this.ary.map(function(e){return e.cl?pref.test_mode[81]?[e].concat(e.cl):e.cl.slice(e.idx||0):e})),t=[],a=1,n=0;t.length<20&&n++<e.length;)e[n]&&e[n-1].kind===e[n].kind?a++:(t[t.length]=e[n-1].kind+(1!=a?"*"+a:""),a=1);return n<e.length&&(t[t.length-1]+="..."),{coms:t,length:this.ary_ro.length+"/"+this.ary.length+"/"+e.length}}};var q=null,X=null,W=0,P=function(){},P=DelayBuffer.prototype.delayed_do.bind(new DelayBuffer(function(){if(X){var e=L();X.report({prog_str:e.str}),0===e.total&&(X.report({end:Date.now()}),X=null,W=0)}},100)),K=new Watchdog(function(){function e(){t.str&&(X.report({err_str:"WDG: "+t.str}),t.str="")}var t=L();pref.debug_mode[27]&&console.log("IDB: "+t.str);var a={};for(var n of S.keys()){var r=S.get(n);pref.debug_mode[27]&&console.log(r),r.wdg!==r.pass?(r.wdg=r.pass,a[n.name]=null):(e(),N(n,r,"IDB: WDG"))}for(var o in U)null===a[o]||U[o].isEmpty||A(o,!0,!0);for(var o in R)null===a[o]||U[o]&&!U[o].isEmpty||R[o].isEmpty||A(o,void 0,!0);for(var o in M)null===a[o]||U[o]&&!U[o].isEmpty||R[o]&&!R[o].isEmpty||M[o].isEmpty||(l(o),A(o,void 0,!0));for(var s in z){var i=s.replace(/(rw|vc)$/,"");null===a[i]||U[i]||R[i]||(e(),A(i,s.search(/vc$/)!=-1,!0))}0!==t.total&&K.start(1e3*pref.archive.IDB.watchdog)},6e4);return{req:j,req_raw:E,clean_up:function(e,t,a){D[pref.script_prefix+"."+t]&&(j(e,t,null,null,a,"clean_up"),liveTag.mems[e][t].IDB_synced=1)},set_indicator:function(e){q||(q=e)},sub_funcs:function(e,t){if("ACC"===e[0])"sub_callback"===e[1][4]?e[1][4]=IDB.sub_ack:t.length>0&&(e[1][4]=t[0]),j.apply(this,e[1]);else if("ACK"===e[0]){var a=e[1].slice(0,3).join("");H[a]&&H[a].apply(this,e[1]),delete H[a]}},sub_ack:function(e,t,a,n){send_message("parent",["IDB",["ACK",[e,t,a,n]]])}}}(),archiver=function(){function e(e,a,n,o){window.URL&&(g||r(),t(new Blob([e],{type:a}),n,o,g))}function t(e,t,n,r){pref.archive.tar?m.add_blob(e,t,n,r):a(e,"CatChan_"+t.key.replace(/\//g,"_")+"_"+n)}function a(e,t){if(e instanceof ArrayBuffer&&(e=common_func.arraybuffer2blob(t,e)),brwsr.ff&&!httpd.isLocal)return void send_message("parent",["ARCHIVER",["DOWNLOAD",[e,t]]]);var a=window.URL.createObjectURL(e);n(a,t),window.URL.revokeObjectURL(a)}function n(e,t){if(!pref.test_mode[70]){var a=document.createElement("div")
;a.innerHTML="<a href="+e+' download="'+t+'">',brwsr.ff&&site.script_body.appendChild(a),a.childNodes[0].click(),brwsr.ff&&site.script_body.removeChild(a)}}function r(){var e=(new Date).toString().split(" ").slice(1,5);g=[e[2],b[e[0]],e[1],e[3].replace(/:/g,"")].join(""),httpd.req({tgts:[],timestamp:g,__proto__:h},0)}function o(e){httpd.req_add({tgts:e,timestamp:g,__proto__:h},0)}function s(e,t,a,n,o,s,i,l,c){for(var p=0;p<n.length;p++){var _="tn"===e?site2[t.domain].catalog_json2html3_thumbnail(n[p],t.board):site2[t.domain].catalog_json2html3_src(n[p],t.board);if(_){g||r();var d={domain:t.domain,board:t.board,no:t.no,key:t.key,kind:e,to_file:o||i,to_idb:s||l,timestamp:g,__proto__:h};if(site2[t.domain].archive_patch_domain&&site2[t.domain].archive_patch_domain(d),(".webm"===_.substr(-5,5)?i||l:o||s)&&(c[c.length]={url:_,__proto__:d}),n[p].extra_files)for(var u=0;u<n[p].extra_files.length;u++)_="tn"===e?site2[t.domain].catalog_json2html3_thumbnail(n[p].extra_files[u],t.board):site2[t.domain].catalog_json2html3_src(n[p].extra_files[u],t.board),(".webm"===_.substr(-5,5)?i||l:o||s)&&(c[c.length]={url:_,__proto__:d})}}}function l(){function e(e){return function(t,a){var n=e.call(this,t,a);return n&&t.localArchive?archiver.url2file(t.localArchive,n):n}}for(var t in site2)if(site2[t].hasOwnProperty("catalog_json2html3_thumbnail")&&(site2[t].catalog_json2html3_thumbnail=e(site2[t].catalog_json2html3_thumbnail)),site2[t].hasOwnProperty("catalog_json2html3_src")&&(site2[t].catalog_json2html3_src=e(site2[t].catalog_json2html3_src)),site2[t].hasOwnProperty("parse_funcs"))for(var a=["catalog_html","page_html","thread_html","post_html"],n=0;n<a.length;n++)site2[t].parse_funcs.hasOwnProperty(a[n])&&site2[t].parse_funcs[a[n]].hasOwnProperty("op_img_url")&&(site2[t].parse_funcs[a[n]].op_img_url=e(site2[t].parse_funcs[a[n]].op_img_url))}function c(e,t,a,n){if(window.URL){var r=n?t:"text/html"===e.type?(new DOMParser).parseFromString(t,"text/html"):JSON.parse(t),o="auto"===pref.archive.format?common_func.name2domainboardthread(e.name.replace(/\.[^\.]*$/,"").split("_")[0].split("-").slice(0,3).join("/"),!0):[pref_func.settings.html_funcs.get_domains()[pref.archive.domain],"/"+pref.archive.board.replace(/\//g,"")+"/"];if(pref.test_mode[80]&&(o[1]=o[1].slice(0,-1)+(n?"_IDB/":"_File/")),pref.archive.fix_inconsistency){r.posts[0].no!=o[2]&&(r.posts=[common_func.deep_copy(r.posts[0])].concat(r.posts),r.posts[0].no=o[2],console.log("Archiver: Fixed: added dummy OP: "+o.join("")));for(var s=0;s<r.posts.length;s++)r.posts[s].filename===!1&&(r.posts[s].filename="LOST_AT_ARCHIVE",console.log("Archiver: Fixed: filename was lost: "+o.join("")+"#"+r.posts[s].no))}y||(l(),y=!0);var i=cataLog.scan_boards_keyword_callback2(o[0]+","+o[1]+","+k+++",thread_"+("text/html"===e.type?"html":"json"),{date:Date.now(),status:200,response:r},["archive_restore",{localArchive:a,page:n?"IDB":"File",__proto__:cataLog.scan_boards_keyword_callback2_default_args}]);return cataLog.threads[i[0].key][16].archiveFile=n?"IDB":e,i[0]}}function p(e,t,a,n){"ARC"===e||"ARC1"===e?(t.archived|="ARC"===e?6:1,n||scan.list_nup.add_scan(t)):"UARC"===e&&(t.archived=0,archiver.clean_list(t.domain,t.board,t.no)),a&&pref.catalog.footer.archived&&cataLog.insert_footer3(t.key)}function _(e,t){return null===w[e]?void 0:t}function d(){pref.debug_mode[28]&&console.log("list_all_obj_downloading: ",j);for(var e in liveTag.mems){var t=site2[e].parse_funcs.post_json.time_unit;for(var a in liveTag.mems[e]){var n=T[e]&&T[e][a],r=n||{};for(var o in liveTag.mems[e][a]){var s=liveTag.mems[e][a][o],i=j[s.key]||s.time_checked/t;s.archived?j[s.key]?r[o]=j[s.key]:(!r[o]||r[o]<i)&&(r[o]=i):s.posts_saved&&(r[o]=-i)}n||0===Object.keys(r).length?n&&0===Object.keys(n).length&&delete T[e][a]:(T[e]||(T[e]={}),T[e][a]=r)}T[e]&&0===Object.keys(T[e])&&delete T[e]}}function u(e){e&&e.key!==N||(T=JSON.parse(e&&e.newValue||localStorage[N]||"{}"))}function f(){pref3.archive.working&&localStorage&&(d(),0===Object.keys(T).length?delete localStorage[N]:localStorage[N]=JSON.stringify(T),pref.debug_mode[28]&&console.log("list_all_obj: ",T))}var m=function(){function e(e,a,r){var o=new Uint8Array(512);r="tn_"===r.substr(0,3)?"thumbs/"+n(r.substr(3)):"img_"===r.substr(0,4)?"images/"+n(r.substr(4)):n(r),t(o,0,a.domain+"/"+n(a.board.slice(1,-1))+"/"+a.no+"/"+r,100),t(o,100,"100777",8),t(o,108,"0",8),t(o,116,"0",8),t(o,124,(e.byteLength||e.size||0).toString(8),12),t(o,136,Math.floor(Date.now()/1e3).toString(8),12),t(o,148,"        ",8),o[156]=48;var s=0;for(i=0;i<157;i++)s+=o[i];return t(o,148,s.toString(8),8),o}function t(e,t,a,n){for(var r=0;r<a.length&&r<n;)e[t++]=255&a.charCodeAt(r++);r<n&&(e[t++]=0)}function n(e){return encodeURIComponent(e).replace(/[!'()*]/g,function(e){return"%"+e.charCodeAt(0).toString(16)})}var r={},o=0;return{add_blob:function(t,a,n,o,s){r[o]||(r[o]={files:[],size:0});var i=r[o],l=t.byteLength||t.size;i.files[i.files.length]=e(t,a,n),i.size+=1,i.files[i.files.length]=t,l%512!=0&&(i.files[i.files.length]=new Uint8Array(512-l%512)),i.size+=Math.floor((l+511)/512),!s&&(i.size>2*pref.archive.tarsize*1024||pref.test_mode[71])&&this.flush(o)},flush:function(e,t){if(e)r[e]&&(r[e].files[r[e].files.length]=new Uint8Array(1024),a(new Blob(r[e].files,{type:"application/x-tar"}),t||"CatChan_archive_updates_"+site.nickname+"_"+e+"_"+o+++".tar"),delete r[e]);else for(var n in r)this.flush(n)}}}(),h={initiator:"archive",get responseType(){return pref.test_mode[85]?"blob":"arraybuffer"},archive:!0,callback_1:httpd.onload_archive,callback_1_fail:httpd.onload_archive_fail,get max(){return this.tgts.length},get tgt(){return this.key+this.url.substr(this.url.lastIndexOf("/"))}},g=null,b={Jan:"01",Feb:"02",Mar:"03",Apr:"04",May:"05",Jun:"06",Jul:"07",Aug:"08",Sep:"09",Oct:"10",Nov:"11",Dec:"12"},v=DelayBuffer.prototype.delayed_do.bind(new DelayBuffer(function(){httpd.check_timestamp_and_flush(g)},5e3)),y=(new Map,!1),k=0,w={pn:null,time_bumped:null,time_created:null,time_posted:null,flag:null,footer:null,time_tu:null,nof_posts:null,nof_files:null,tags:null,page:null,parse_funcs:null,quotes:null,backlinks:null,reply_to_me:null,reply_of_mine:null,op_img_url:null},x=function(){var e={html:function(){var e=document.createElement("div"),t={A:null,SPAN:null,DIV:null,BLOCKQUOTE:null,BR:null,WBR:null,U:null,S:null,STRIKE:null,B:null,I:null,BIG:null,SMALL:null,TT:null,SUB:null,SUP:null,EM:null,STRONG:null};return function(a,n,r){e.innerHTML=n;for(var o=e.getElementsByTagName("*"),s=0;s<o.length;s++)if(null!==t[o[s].tagName])return void(r[a]="")}}(),string:function(e,t,a){t.search(/[<>"'&]/)!=-1&&(a[e]="")}};return function(t){if(t)for(var a=0;a<t.length;a++){var n=t[a];for(var r in n)"string"==typeof n[r]&&("com"===r?e.html(r,n[r],n):e.string(r,n[r],n))}return t}}(),N=pref.script_prefix+".archived",T={};localStorage&&u(),pref.debug_mode[28]&&console.log("list_all_obj: ",T);var j={};return window.addEventListener("storage",u,!1),window.addEventListener("beforeunload",f,!1),{clean_list_all:function(e,t,a){if(T[e]&&T[e][t]){var n=T[e][t];for(var r in n)void 0===a[r]&&this.clean_list(e,t,r)}},clean_list:function(e,t,a){T[e]&&T[e][t]&&delete T[e][t][a]},check_op:function(e,t){var a=pref.archive.kwd;(pref.archive.store_auto&&a.str&&(a.sub||a.name||a.com)&&cataLog.threads&&cataLog.catalog_filter_query_keyword.kwd(pref.archive.kwd,e.posts,e.domain,e)||this.check_archived_time(e.key,e.domain,e.board,e.no,e.parse_funcs.time_unit)!==!1)&&p("ARC",t,!1,!0)},check_archived_time:function(e,t,a,n,r){if(pref.archive.list){var o=pref3.archive.list_obj2[e];if(o&&o.time)return o.time}var s=T[t]&&T[t][a]&&T[t][a][n];return pref.archive.list_inherit&&s?s:(pref.archive.list&&(o=pref_func.merge_obj5(e,pref3.archive.list_obj2,null)),!!o&&(o.time/r||s||0))},update_archived_time:function(e){if(pref3.archive.working=!0,pref3.archive.list_obj2[e]&&pref3.archive.list_obj2[e].time){var t=new RegExp("(^|,)"+e.replace(/\+/,"\\+")+"([\\^@!][^,\n]*)*(,|\n|$)","mg");pref.archive.list_str=pref.archive.list_str.value.replace(t,",")+","+e+"\n",pref.archive.list_str=str.replace(/,,+/g,",").replace(/^,/g,"").replace(/\n,/g,"\n").replace(/\n\n+/g,"\n").replace(/^\n/,""),pref3.archive.list_obj2[e].time=null}},store_entry:function(e,t){if(cataLog.threads){if("shown"===pref.archive.src)for(var a in cataLog.threads)null===cataLog.threads[a][9][0]&&(cataLog.threads[a][9]=cataLog.catalog_filter_query(a,!0));for(var a in cataLog.threads){var n=liveTag.mems.getFromName(a);("stored"===pref.archive.src||"watched"===pref.archive.src&&n.watched||"shown"===pref.archive.src&&cataLog.threads[a][9][0])&&p(e,n,!0)}}},start_1:p,restore_posts_from_IDB:function(t,a,n,r,o,s){var i=this.event_funcs.consolidate_IDB_result(s);if(i.posts.length>1){var l=a.lth;i.time_loaded=i.posts[i.posts.length-1].time;var c=this.check_deleted_posts(t,a,l,i,!0);if(l.archived&&c&&2&l.archived&&pref.archive.live.post){var p=a.key.replace(/\//g,"-");e(JSON.stringify(site2[a.domain].parse_funcs.thread_json.prep_to_archive(c)),"text/plain",l,p+"_deleted.json")}}},store_th_to_mem:function(e,t,a){if("no"!==pref[cataLog.embed_mode].deleted_posts.detect){var n=t.posts&&t.posts.length>1&&t.nof_posts>t.posts.length&&a.ta&&"passive"!==pref[cataLog.embed_mode].deleted_posts.detect?site2[t.domain].update_posts_replace_prep(t.posts,a.ta.posts,-1):t.parse_funcs.has_posts?t.posts:a.ta&&a.ta.posts||t.posts;if(!pref.test_mode[65]&&(a.archived&&pref.archive.live.post_idb||"full_IDB"===pref[cataLog.embed_mode].deleted_posts.detect)){a.ta||"full_IDB"!==pref[cataLog.embed_mode].deleted_posts.detect||IDB.req(t.domain,t.board,t.no,"posts",this.restore_posts_from_IDB.bind(this,e,{posts:t.posts,__proto__:t}),"get_all");var r;a.ta?r=a.ta.posts[a.ta.posts.length-1].time:(r=T[t.domain]&&T[t.domain][t.board]&&T[t.domain][t.board][t.no])<0&&(r=-r);var o;if(r&&(!a.ta||a.ta.posts.length===a.ta.nof_posts||t.posts.length<t.nof_posts)){for(var s=t.posts.length;s>0&&t.posts[s-1].time>r;)s--;o=t.posts.slice(s)}else o=t.posts;o.length>0&&("html"===t.type_data&&cataLog.format_html.prepare_html_extract_params(t),IDB.req(t.domain,t.board,t.no,"posts",o,"put"),a.posts_saved=1),pref.debug_mode[28]&&o.length>0&&console.log("posts_saved: "+t.key+", "+r+", "+o[o.length-1].time+" "+new Date(o[o.length-1].time*t.parse_funcs.time_unit).toLocaleString()+", LS:"+(T[t.domain]&&T[t.domain][t.board]&&T[t.domain][t.board][t.no]))}!pref.test_mode[65]&&pref.archive.oneshot.post_idb&&1&a.archived&&IDB.req(t.domain,t.board,t.no,"posts",n,"put"),a.ta={posts:n,nof_posts:t.nof_posts,time_loaded:t.time_loaded}}else a.ta&&delete a.ta},check_deleted_posts:function(e,t,a,n,r){if((a.archived||"no"!==pref[cataLog.embed_mode].deleted_posts.detect)&&n&&n.posts.length>1){var o=t.posts,s=n.posts,i=t.nof_posts===t.posts.length||"thread"===t.type_source,l=1,c=1;i?a.rescan_dp=0:(l=n.nof_posts-s.length+1-(t.nof_posts-o.length),c=1,l<1&&(c+=1-l,l=1));for(var p,d=0,u=0,f=a.pd||[],m=r?[]:null;c<s.length;){if(l<o.length){for(;d<f.length&&o[l].no>f[d].no;)d++;if(d<f.length&&o[l].no==f[d].no){t.native_prep?d++:p=f.splice(d,1);continue}if(o[l].no===s[c].no){l++,c++,i=!0;continue}if(o[l].no<s[c].no){i&&r&&(m[m.length]=o[l]),l++;continue}}for(;u<f.length&&s[c].no>f[u].no;)u++;if(u<f.length&&s[c].no===f[u].no)c++;else if(i){if(p=s[c++],!p.deleted_after){p.deleted_after=n.time_loaded,p.deleted_before=e&&e.date||null;var h={posts:[n.posts[0]].concat(p),__proto__:t};site2[t.domain].wrap_to_parse.posts(h)}f.splice(u++,0,p)}else 0===pref[cataLog.embed_mode].deleted_posts.detect.indexOf("full")&&(a.rescan_dp=1,scan.list_nup.add_scan(a)),c++}if(a.pd=f.length>0?f:null,p){if("no"!==pref[cataLog.embed_mode].deleted_posts.store&&t.domain===site.nickname){var g="LS"===pref[cataLog.embed_mode].deleted_posts.store?localStorage:sessionStorage;if(g){var b=site2[t.domain].ls_key_deletedPosts+t.board+t.no;f.length>0?g[b]=JSON.stringify(f,_):delete g[b]}}!pref.test_mode[65]&&(a.archived&&pref.archive.live.post_idb||"full_IDB"===pref[cataLog.embed_mode].deleted_posts.detect)&&IDB.req(t.domain,t.board,t.no,"posts_deleted",JSON.stringify(f,_),f.length>0?"put":"delete")}if(m&&m.length>0&&(t.domain!==site.nickname&&(m=JSON.parse(JSON.stringify(m,_))),IDB.req(t.domain,t.board,t.no,"posts",m,"put")),pref.debug_mode[19]&&p&&a.pd)for(var l=0;l<a.pd.length-1;l++)a.pd[l].no>=a.pd[l+1].no&&console.log("BUG: inorder of posts_deleted: "+t.key+", "+l+", "+a.pd[l].no+", "+a.pd[l+1].no)}return p?f:null},store_json_func:_,store:function(t,a,n,r,i){var l=this.check_deleted_posts(t,a,n,n.ta);if(this.store_th_to_mem(t,a,n),n.archived){var c=a.parse_funcs.time_unit,p=this.check_archived_time(a.key,a.domain,a.board,a.no,c)||0;if(i/=c,p<i&&(p=i),!(1&n.archived)&&4&n.archived&&(a.posts[a.posts.length-1].time*a.parse_funcs.time_unit<=p||a.time_posted<=p))return;a.parse_funcs.posts_full&&a.parse_funcs.posts_full(a);var d=2&n.archived,u=1&n.archived,f=d&&pref.archive.live.post||u&&pref.archive.oneshot.post,m=a.key.replace(/\//g,"-");l&&f&&e(JSON.stringify(site2[a.domain].parse_funcs.thread_json.prep_to_archive(l)),"text/plain",n,m+"_deleted.json");var h="html"===a.type_data?"text/html":"text/plain",g="thread"===a.type_source||a.posts.length===a.nof_posts?a.posts:n.ta&&n.ta.posts.length===a.nof_posts?n.ta.posts:null;if(f){var b=(a.posts[0].sub||"").replace(/\..*/,""),y=m+(pref.archive.sub_in_filename&&b?"_"+b:"")+("html"===a.type_data?".html":".json");if(!g)return void this.store_rescan(n);e("thread"===a.type_source?t.responseText:JSON.stringify(site2[a.domain].parse_funcs.thread_json.prep_to_archive(g),_),h,n,y)}if(r||5&n.archived){var k=d&&pref.archive.live.tn||u&&pref.archive.oneshot.tn,w=d&&pref.archive.live.tn_idb||u&&pref.archive.oneshot.tn_idb,x=d&&pref.archive.live.img||u&&pref.archive.oneshot.img,N=d&&pref.archive.live.img_idb||u&&pref.archive.oneshot.img_idb,T=d&&pref.archive.live.webm||u&&pref.archive.oneshot.webm,A=d&&pref.archive.live.webm_idb||u&&pref.archive.oneshot.webm_idb;if(k||w||x||N||T||A){if(5&n.archived){if(!g&&(u||(!a.posts[1]||a.posts[1].time>p)&&(!n.ta.posts[1]||n.ta.posts[1].time>p)))return void this.store_rescan(n);if(u)r=g;else{for(var E=a.posts[1]&&a.posts[1].time<=p?a.posts:n.ta.posts,B=E.length;B>0&&E[B-1].time>p;)B--;r=E.slice(B)}}if(0!=r.length){pref.debug_mode[28]&&console.log("archive: "+a.key+", "+r.length+"/"+a.nof_posts);var L=[];(k||w)&&s("tn",a,n,r,k,w,T,A,L),(x||N||T||A)&&s("img",a,n,r,x,N,T,A,L),0!=L.length&&(L[L.length-1].from=a.key,j[a.key]=p,o(L))}}}!f||!l&&!g||L&&0!==L.length&&a.domain===site.nickname||!pref.archive.tar||v(),n.archived&=2,this.update_archived_time(a.key)}},store_rescan:function(e){scan.list_nup.add_scan(e),e.archived|=4},restore_entry:function(e,t,a,n){for(var r={},o=0;o<t.length;o++)void 0===r[t[o].name]?r[t[o].name]={file:t[o]}:Array.isArray(r[t[o].name])?r[t[o].name].push({file:t[o]}):r[t[o].name]=[r[t[o].name],{file:t[o]}];var s={};if(!pref.test_mode[64]&&pref[cataLog.embed_mode].deleted_posts.merge)for(var o=0;o<n.length;o++)s[n[o].name]=n[o];var i=0;pref.archive.clear_threads&&cataLog.threads&&cataLog.catalog_clear_threads(0);var l,p=new FileReader;p.onerror=function(e){console.log("ERROR at loading json file, "+e)},p.onload=function(t){if(l){var n=l.slice(0,-13).replace(/\-/g,"/");pref.test_mode[80]&&(n=n.replace(/\/\d+$/,"_File$&"));var o=liveTag.mems.getFromName(n);archiver.prep_deleted_posts(o.th,o,p.result)}else if(c(e[i-1],p.result,r),!pref.test_mode[64]&&pref[cataLog.embed_mode].deleted_posts.merge&&(l=e[i-1].name.replace(/(_|\.).*/,"")+"_deleted.json",s[l]))return void p.readAsText(s[l]);l=null,e.length>i?p.readAsText(e[i++]):pref.archive.clear_files&&a()},p.readAsText(e[i++])},url2file:function(e,t){var a=e[t.replace(/[^\/]*\//g,"")];return a?(Array.isArray(a)&&(a=t.search(/thumb/)!=-1?a[0]:a[a.length-1]),a.url||(a.url=window.URL.createObjectURL(a.file)),a.url+("video/webm"===a.file.type?'" data-ext=".webm':"")):t},prep_deleted_posts:function(e,t,a,n){var r=a?n||JSON.parse(a):"LS"===pref[cataLog.embed_mode].deleted_posts.store&&localStorage?x(JSON.parse(localStorage[site2[e.domain].ls_key_deletedPosts+e.board+e.no]||null)):"SS"===pref[cataLog.embed_mode].deleted_posts.store&&sessionStorage?JSON.parse(sessionStorage[site2[e.domain].ls_key_deletedPosts+e.board+e.no]||null):null;if(r){r=site2[e.domain].parse_funcs.thread_json.rip_from_archive(r);var o={posts:[e.posts[0]].concat(r),parse_funcs:site2[e.domain].parse_funcs.thread_json,type_parse:"thread_json",type_source:"thread",type_data:"json",__proto__:e};site2[e.domain].wrap_to_parse.posts(o,1),a&&t.th?(t.pd=t.pd?site2[e.domain].update_posts_merge_prep(o.posts,t.pd,-1,!0).slice(1):r,"page"!==cataLog.embed_mode&&"thread"!==cataLog.embed_mode||pref.test_mode[64]||!pref[cataLog.embed_mode].deleted_posts.merge||(e.posts=site2[e.domain].update_posts_merge_prep(e.posts,t.pd,-1,!0),cataLog.threads[e.key][16].th=e,cataLog.show_catalog(e.key)),cataLog.insert_footer3(e.key)):t.pd=r}},refresh_start:function(){f(),g=null},list_all_obj_downloading:j,download_url3:t,download_url4:a,tar:m,sub_funcs:function(e){if("SUB_INIT"===e[0])if(cataLog.catalog_clear_threads(0),pref[cataLog.embed_mode].t2h_sel="All",e[1].IDB)IDB.req(e[1].domain,e[1].board,e[1].no,null,archiver.event_funcs.restore3.bind(archiver.event_funcs),"get_all");else for(var t=e[1],n=parseInt(t.files_sel,10),r=window.opener.document.getElementsByClassName(pref.script_prefix)[0].querySelectorAll('span[name="FILES_ARCHIVE'+n+'"]')[0].querySelectorAll('input[type="file"]'),o=0;o<r.length;o++)for(var s=0;s<r[o].files.length;s++){var i=r[o].files[s];if(i.name===t.name&&i.size===t.size&&i.lastModified===t.lastModified)return void archiver.event_funcs.restore2(null,Array.prototype.slice.call(r[o+n].files),[i])}else"DOWNLOAD"===e[0]&&a(e[1][0],e[1][1])},restore:c,event_funcs:pref_func.settings.onchange_funcs.archive}}(),recovery=pref.features.recovery&&localStorage?function(){function e(){s=site2[site.nickname].ls_key_comment+site.board+site.no;var e=pref.script_prefix+".comment."+site.nickname+site.board+site.no;if(pref.recovery.comment){var t=localStorage[s]||localStorage[e]||"";t&&(site.components.postform_comment&&(site.components.postform_comment.value=t),site.components.postform_comment2&&(site.components.postform_comment2.value=t))}}function t(){i=this,c()}function a(){var e=i.value;(!l||l.length<=e.length)&&(l=e),i=null,p()}function n(){l?localStorage[s]=l:delete localStorage[s],l=null}function r(){i&&(l=i.value),null!==l&&n()}function o(e,a,n){if(!e&&pref.recovery.comment&&a){var r=t.bind(a);a.addEventListener("change",r,!1),a.addEventListener("keyup",r,!1),n.addEventListener("click",r,!1),e=[a,n,r]}else!e||pref.recovery.comment&&a||(e[0].removeEventListener("change",e[2],!1),e[0].removeEventListener("keyup",e[2],!1),e[1].removeEventListener("click",e[2],!1),e=null);return e}var s;e();var i=null,l=null,c=new DelayBuffer(a,1e3).get_binded_delayed_do(),p=new DelayBuffer(n,1e3*pref.recovery.interval).get_binded_delayed_do(),_=o(null,site.components.postform_comment,site.components.postform_submit),d=null;return window.addEventListener("beforeunload",r,!1),{setup:function(){_=o(_,site.components.postform_comment,site.components.postform_submit),d=o(d,site.components.postform_comment2,site.components.postform_submit2)},setup2:function(){d=o(d,site.components.postform_comment2,site.components.postform_submit2)},reentry:function(){r(),e()}}}():null,scan=function(){function e(e,t,a){return("b"===e?"scan":"scan_threads")+"_"+t+":"+(a||0)}function t(t,a){for(var r=e(t,a,0).replace(/0$/,""),o=8;o>=0;o--){var s=n.prototype.scanners[r+o];if(s||s===!1)return o}return-1}var a={add:function(e,t,a){"string"==typeof e&&(e=this.get_th(e)),t=(t||0)<<4,0===e.u?e.u=t|(a?7:3):e.u>0&&e.u<t&&(e.u=t|15&e.u)},add_scan:function(e){this.add(e),scan.scan_threads_delayed_do()},issued:function(e){return"string"==typeof e&&(e=this.get_th(e)),e&&(e.u=(1==(3&e.u)?4294967040:0)|(0===e.u?2:e.u-1)),e&&e.no&&e.archived},got_200:function(e){var t=this.get_th(e.key);0===t.u||4&t.u&&"thread"!==e.type_source||(t.u=0)},got_404:function(e){"string"==typeof e&&(e=this.get_th(e)),e&&(e.u=-1)},get_th:function(e){var t=common_func.fullname2dbt(e);return t[2].search(/(p|q)[0-9]+$/)!=-1?null:("t"===t[2][0]?t[2]=t[2].substr(1):t[2].search(/^[0-9]/)==-1&&(t[2]=""),liveTag.mems.init({domain:t[0],board:t[1],no:t[2]}))},priority_th:[0,16,32,48,64,80,96,112,128,144,160,176,192,208,224,240,256],get_list_thread:function(e,t){var a=this.priority_th[t||0],n=0;for(var r in liveTag.mems[e])for(var o in liveTag.mems[e][r])liveTag.mems[e][r][o].u>a&&n++;return 0===n?null:[n,function*(t){for(var a in liveTag.mems[e])for(var n in liveTag.mems[e][a])liveTag.mems[e][a][n].u>t&&(yield liveTag.mems[e][a][n])}(a)]},get_list_thread2:function(e,t){var a=this.priority_th[t||0],n=[];for(var r in liveTag.mems[e])for(var o in liveTag.mems[e][r])liveTag.mems[e][r][o].u>a&&(n[n.length]=liveTag.mems[e][r][o]);return n},get_list_board:function(e,t){var a=this.priority_th[t||0],n=0;for(var r in liveTag.mems[e])liveTag.mems[e][r].u>a&&n++;return 0===n?null:[n,function*(t){for(var a in liveTag.mems[e])liveTag.mems[e][a].u>t&&(yield liveTag.mems[e][a])}(a)]},get_list_board2:function(e,t){var a=this.priority_th[t||0],n=[];for(var r in liveTag.mems[e])liveTag.mems[e][r].u>a&&(n[n.length]=liveTag.mems[e][r]);return n},add_domain:function(e,t,a){if(liveTag.active.pk){if(a)for(var n in liveTag.mems[e]){liveTag.tags[liveTag.mems[e][n].btag].pk&&this.add_board(e+n,null,t);var r=liveTag.mems[e][n].btag2;if(r)for(var o=0;o<r.length;o++)liveTag.tags[r[o]].pk&&this.add_board(e+n,null,t)}else for(var o=0;o<pref.scan.max;o++)if(liveTag.tags_array_old[o])for(var s of liveTag.tags[liveTag.tags_array_old[o].key].mems.keys())s.no?this.add(s,null,t):this.add_board(s,null,t)}else if(a)for(var o=0;o<a.length;o++)this.add_board(e+a[o],null,t);else for(var n in liveTag.mems[e])null!==liveTag.mems[e][n].o&&liveTag.mems[e][n].o<pref.scan.max&&this.add_board(e+n,null,t)},add_board:function(e,t,a,n,r){"string"==typeof e&&(e=this.get_th(e));var o=(t||0)<<4|(r?8:0)|(a?4:0);(!n||e.read_max<e.max)&&(0===e.u?e.u=3|o:e.u>0&&e.u<t&&(e.u=o|15&e.u))},got_200_board:function(e){if("string"==typeof e&&(e=this.get_th(e)),4&e.u)for(var t in e)this.add(e[t],240&e.u,!0);e.max&&(e.read_max=e.max),e.u=0},scan_boards_enumerate:function(e,t,a){var n="thread"===pref.virtualBoard.scan_domains[e]||a.has(liveTag.mems[e]);for(var r in liveTag.mems[e])if((n||0!=Object.keys(liveTag.mems[e][r]).length)&&!a.has(liveTag.mems[e][r])&&null!==liveTag.mems[e][r].o&&liveTag.mems[e][r].o<pref.scan.max&&(!t||t(liveTag.mems[e][r])))return!0}},n=function(e,t,a,n){this.type=e,this.domain=t,this.key=n,this.priority=a||0,this.scanners[n]=this};n.prototype={scanners:Object.create(null),func_entry:function(){var e;pref.test_mode[51]?(e="b"===this.type?scan.list_nup.get_list_board(this.domain,this.priority):scan.list_nup.get_list_thread(this.domain,this.priority),e?this.func_scan(e,{tgts_iterator:e[1],max:e[0]}):this.exit()):(e="b"===this.type?scan.list_nup.get_list_board2(this.domain,this.priority):scan.list_nup.get_list_thread2(this.domain,this.priority),0!=e.length?this.func_scan(e,null):this.exit())},func_scan:function(e,t,a){this.wdg||(this.wdg=new Watchdog(this.abort.bind(this),3e4)),cataLog.scan_init(this.key,e,{callback:this.func_cont.bind(this),watchdog:this.wdg.restart.bind(this.wdg),priority:this.priority,__proto__:t},a)},func_cont:function(){this.req?(this.req=!1,this.func_entry()):this.exit()},exit:function(){this.wdg&&this.wdg.stop(),this.scanners[this.key]=null,"b"===this.type?this.aborted||scan.scan("t",this.domain,this.priority):"t"===this.type&&cataLog.catalog_refresh_end&&cataLog.catalog_refresh_end(),this.callback&&this.callback();var a=t(this.type,this.domain),r=e(this.type,this.domain,a);this.scanners[r]===!1&&new n(this.type,this.domain,a,r).func_entry()},abort:function(){pref.debug_mode[7]&&console.log("Scanner_abort: "+this.key),cataLog.scan_boards.scan_abort(this.key),void 0===this.aborted?(this.aborted=!0,this.wdg.restart()):this.exit()}};var r=function(e,t){this.key=e,this.arg=t,this.scanners[e]=this,this.callback=this.arg.options&&this.arg.options.callback};r.prototype={scanners:Object.create(null),priority:8,func_entry:function(){this.func_scan(this.arg.tgts,this.arg.options,!0)},func_cont:function(){this.queue&&this.queue.length>0?(this.arg=this.queue.shift(),this.func_entry()):this.exit()},__proto__:n.prototype};var o=new Set;return{scan_refresh:function(e,t,n,r){o.clear();for(var s=0;s<t.length;s++){var i=common_func.name2domainboardthread(t[s],!0);0===i[2].search(/^[cj]/)?o.add(liveTag.mems[i[0]][i[1]]):0===i[2].search(/^t*[0-9]+/)&&o.add(liveTag.mems[i[0]][i[1]]["t"===i[2][0]?i[2].substr(1):i[2]])}for(var s in r)o.add(liveTag.mems[s]);if(scan.scan("t",null,n),!pref.liveTag.use)for(var l in liveTag.tags)if(liveTag.tags[l].pk)for(var c of liveTag.tags[l].mems.keys())o.has(c)||(c.no?scan.list_nup.add(c,2):scan.list_nup.add_board(c,2));for(var p in liveTag.mems)pref.liveTag.use?site2[p].utilize_boards_json&&pref.pref2[p].utilize_boards_json?a.scan_boards_enumerate(p,null,o)?site2[p].get_boards_json("boards_"+p,function(e){return function(){scan.scan_refresh_1(e,!0)}}(p),!0,e):scan.scan("t",p):scan.scan_refresh_1(p,!1):scan.scan("b",p)},scan_refresh_1:function(e,t){a.scan_boards_enumerate(e,function(e){scan.list_nup.add_board(e,null,null,t)},o),scan.scan("b",e)},scan:function(a,r,o){if(r){var s=e(a,r,o),i=n.prototype.scanners[s];i?i.req=!0:t(a,r)>=o?n.prototype.scanners[s]=!1:"b"===a&&(i=n.prototype.scanners[e("t",r,o)])?i.callback=function(){scan.scan(a,r,o)}:new n(a,r,o,s).func_entry()}else for(var l in liveTag.mems)this.scan(a,l,o)},abort:function(){for(var e in n.prototype.scanners){var t=n.prototype.scanners[e];t&&(t.wdg&&t.wdg.stop(),t.abort())}},scan_ui:function(e,t){new r(e,t).func_entry()},scan_threads_delayed_do:DelayBuffer.prototype.delayed_do.bind(new DelayBuffer(function(){scan.scan("t")},200)),keyword_load:function(e,t){var a=!0;for(var n in pref.virtualBoard.scan_domains)"none"!==pref.virtualBoard.scan_domains[n]&&(this.keyword_load_1(n,e,null,t),a=!1);a&&this.keyword_load_1(site.nickname,e,null,t)},keyword_load_1:function(e,t,a,n){if(!site3[e].boards&&(!t&&"none"!==pref.virtualBoard.scan_domains[e]||t&&liveTag.active.pk||!a))return void site2[e].get_boards_json("kwd_load",function(){scan.keyword_load_1(e,t,a,n)},!1,n);("thread"===pref.virtualBoard.scan_domains[e]||t)&&(scan.list_nup.add_domain(e,t&&pref.catalog.filter.kwd.post,a),scan.scan("b",e))},list_nup:a}}(),stats=pref3.stats.use?function(){function e(e){var t=liveTag.mems[e[0]][e[1]][e[2]];if(t.ss)if(Array.isArray(t.ss))for(var n=0;n<t.ss.length;n++)t.ss[n].rm&&t.ss[n].rm.update_thread(t.s,0,!0);else t.ss.rm&&t.ss.rm.update_thread(t.s,0,!0);pref.stats.retain_404&&t.s&&(d[e[0]]||(d[e[0]]={}),d[e[0]][e[1]]||(d[e[0]][e[1]]={}),d[e[0]][e[1]][e[2]]=liveTag.mems[e[0]][e[1]][e[2]],(pref.test_mode[44]||d[e[0]][e[1]].sr||Object.keys(d[e[0]][e[1]]).length>64)&&a(d[e[0]][e[1]]))}function t(e){for(var t=0;t<h.length;t++){pref_func.merge_obj5(e.key,h[t].tgts_obj2,{hit:!1}).hit&&h[t].check_and_add_thread(e)}}function a(e){e.sr||(n(e,"sr"),n(e,"srt"));for(var t in e){if(e[t].s)for(var a=0;a<f.length;a++)l(e.sr[a],null,0,e[t].s.length,e[t].s,f[a],o,0),l(e.srt[a],null,0,1,e[t].s,f[a],o,0);delete e[t]}}function n(e,t){Object.defineProperty(e,t,{value:[],configurable:!0,writable:!1});for(var a=0;a<f.length;a++)e[t][a]=[null,a<3?[]:{length:pref.stats.len_capture+2,__proto__:Array.prototype},[],0],r(e[t][a],f[a]);"s"===t&&(e[t][f.length]=-Object.keys(e).length)}function r(e,t,a){var n=Math.floor((Date.now()/6e4+e[3])/t)*t,r=n-t*pref.stats.len_capture;if(!e[0])return void(e[0]=r);if(r!==e[0]||a){var o=(r-e[0])/t,s=0;return a>o&&pref.stats.tolerant&&(e[3]+(a-o)*t<pref.stats.tolerance?(e[3]=a*t,s=a-o):(e[3]=pref.stats.tolerance,s=Math.floor((pref.stats.tolerance-e[3])/t))),e[1].splice(0,o+s),Array.isArray(e[1])||(e[1].length=pref.stats.len_capture+2),e[0]=r+s*t,o+s}}function o(e,t){e[t]=(e[t]||0)+1}function s(e,t,a,n){var r=a.posts[n].no||a.no;(void 0===e[t]||e[t]<r)&&(e[t]=r)}function i(e,t,a,r){e.s||n(e,"s");for(var o=0;o<f.length;o++)l(e.s[o],t,a,r.length,r,f[o],s,t.posts.length);e.s[f.length]++}function l(e,t,a,n,o,s,i,l){for(var c,p=e[0],_=e[1],d=n-1;d>=a;d--){var u=Math.floor((o[d]-p)/s);if(!(--l>=0&&u===c)){var f=u-pref.stats.len_capture-1;if(f>0?(u-=r(e,s,f),u>pref.stats.len_capture+1&&(u=pref.stats.len_capture+1),p=e[0]):u<0&&(u=0),i(_,u,t,l),0===u)break;c=u}}for(var m=0;m<e[2].length;m++)e[2][m].update_posts_no(p,u)}function c(e){return pref.catalog_board_list_obj[e][0].key}function p(){if(pref.stats.auto_acquisition&&"thread"!==cataLog.embed_mode)for(var e=pref.catalog_board_list_obj.length-1;e>=0;e--)if(void 0!==w["@"+c(e)]){var t=cataLog.catalog_refresh_1("chart",!1,!1,!1,!1,e,!1,!0);"function"!=typeof t&&new g(null,t,c(e),!1).destroy()}}function _(e){if(pref.stats.auto_acquisition&&cataLog.catalog_refresh_1&&"thread"!==cataLog.embed_mode){for(void 0===e&&(e=pref.catalog_board_list_obj.length-1);e>=0&&(!pref.catalog_board_list_obj[e][0].cmds||pref.catalog_board_list_obj[e][0].cmds.indexOf("stats")===-1);)e--;if(e>=0){pref.stats.auto_acquisition&&stats.register_auto_acquisition(e);var t=cataLog.catalog_refresh_1("chart",!1,!1,!1,"stats_ac",e,!1,!0,function(){_(e-1)});"function"==typeof t&&t(function(){_(e)})}}}var d={},u={hour:function(e){return new Date(6e4*e).toString().split(" ")[4].replace(/:\d*$/,"")},day:function(e){return new Date(6e4*e).toString().replace(/\s\d{4}.*/,"")},sunday:function(e){var t=new Date(6e4*e).toString();return"Sun"==t.split(" ")[0]?t.replace(/\s\d{4}.*/,""):""},month:function(e){var t=new Date(6e4*e).toString();return"01"==t.split(" ")[2]?t.replace(/\s\d{4}.*/,""):""},quarter_year:function(e){var t=new Date(6e4*e).toString().split(" ");return t[2]<=7&&["Jan","Apr","Jul","Oct"].indexOf(t[1])!=-1?t.slice(1,4).join(" "):""}};u[1]=[60,u.hour,1],u[10]=[60,u.hour,1],u[60]=[1440,u.day,1],u[1440]=[1440,u.sunday,0],u[10080]=[1440,u.quarter_year,0];var f=[1,10,60,1440,10080],m=Math.floor(Date.now()/6e4),h=[],g=function(e,t,a){h.push(this),this.chart=e,this.tolerance=0,this.draw=DelayBuffer.prototype.delayed_do.bind(new DelayBuffer(this.refresh.bind(this),1e3*pref.stats.draw_delay)),this.wdg_tick=new Watchdog(this.prep_time.bind(this),6e4),this.fromNo=pref3.stats.estimate_posts?new y(this):null,this.tgts_changed(t,a,!0),this.time_unit_changed(pref.chart.inst.time_sel,!0),this.len_changed(this.chart&&this.chart.len>pref.stats.len_capture?this.chart.len:pref.stats.len_capture)};g.prototype={destroy:function(){this.chart=null,this.save_all_unsubscribe(!0),this.wdg_tick.stop(),h.splice(h.indexOf(this),1)},merge_1:function(e,t){if(t)for(var a=0;a<t.length;a++)e[a]<t[a]&&(e[a]=t[a]);return e},merge_1_hier:function(e,t,a){for(var n=this.time_unit/a.time_unit,r=Math.ceil((a.time_base-this.time_base)/this.time_unit),o=(n-a.time_base%this.time_unit/a.time_unit)%n;o<t.length;)this.merge_1_hier_1(e,t,r,o,n,a),o+=n,r++},merge_1_hier_1:function(e,t,a,n,r,o){for(var s=0,i=t.length>=n+r?r:t.length-n,l=0;l<i;l++)s+=t[n+l];pref.debug_mode[15]&&s>e[a]&&console.log("merge_1_hier_1: "+this.time_unit+": "+a+", "+e[a]+"->"+s+", "+new Date(6e4*(this.time_base+a*this.time_unit)).toLocaleString()+", "+new Date(6e4*(o.time_base+n*o.time_unit)).toLocaleString()+", "+r),s>e[a]&&(e[a]=s)},save_all_unsubscribe:function(e){if(this.tgts&&pref.stats.save&&void 0!==w["@"+this.key]){var t=Math.floor(Date.now()/6e4);if(w["@"+this.key]!==t){var a=this.chart;this.chart=null;for(var n=f.indexOf(this.time_unit),r=null,o=0;o<f.length;o++)this.time_unit_changed(o),this.save(r),r={data_p:this.data_p,data_t:this.data_t,time_unit:this.time_unit,time_base:this.time_base};e||this.time_unit_changed(n),this.chart=a,w["@"+this.key]=t}}this.tgts&&(this.prep("both",this.prep_thread_unsubscribe),this.fromNo&&this.fromNo.prep("live",this.fromNo.prep_board_unsubscribe))},Zcompress:function(e){return e.replace(/0,(0,)+/g,function(e){
return"z"+e.length/2+","})},Zdecompress:function(e){return e.replace(/z(\d+),/g,function(e,t){for(var a="",n=parseInt(t,10),r=0;r<n;r++)a+="0,";return a})},get_ls_key:function(){return pref.test_mode[38]?pref.script_prefix+".graph."+this.time_unit+"."+this.key+"_test38":pref.script_prefix+".graph."+this.time_unit+"."+this.key},save:function(e){if(this.data_p&&pref.stats.load&&pref.stats.save&&localStorage){this.merge_1(this.data_p,this.data_p_old),this.merge_1(this.data_t,this.data_t_old),e&&(this.merge_1_hier(this.data_p,e.data_p,e),this.merge_1_hier(this.data_t,e.data_t,e));for(var t=0;t<this.data_p.length&&0===this.data_p[t]&&0===this.data_t[t];)t++;var a=[this.time_base+t*this.time_unit,this.data_p.slice(0,this.len+1).slice(t),this.data_t.slice(0,this.len+1).slice(t)];if(!pref.test_mode[42]&&this.fromNo){var n=this.fromNo;if(n.valid=!0,n.prep("live",n.prep_board_check_valid),n.valid){if(n.data_p_old){var r=n.data_p_old.length-1;n.data_p[r]>n.data_p_old[r]&&(n.data_p_old[r]=n.data_p[r])}}else for(var o=0;o<n.data_p.length;o++)n.data_p[o]=0;n.data_p_old&&(n.data_p=n.data_p_old.concat(n.data_p.slice(n.data_p_old.length)));for(var o=n.data_p.length-2-this.tolerance;o<n.data_p.length;o++)n.data_p[o]=0;a[3]=n.data_p.slice(0,this.len+1).slice(t)}localStorage[this.get_ls_key()]=this.Zcompress(JSON.stringify(a)),pref.debug_mode[15]&&console.log("saved: "+this.get_ls_key())}},load:function(){if(pref.stats.load&&localStorage){var e=localStorage[this.get_ls_key()];if(e){e=JSON.parse(this.Zdecompress(e));var t=(this.time_base-e[0])/this.time_unit,a=Math.floor((m-this.time_last)/this.time_unit);if(0===a&&(a=void 0),t>=0?(this.data_p_old=e[1].slice(t,a),this.data_t_old=e[2].slice(t,a),this.fromNo&&e[3]&&(this.fromNo.data_p_old=e[3].slice(t,a))):(this.data_p_old=this.array_init([],0,0).slice(0,-t).concat(e[1].slice(0,a)),this.data_t_old=this.array_init([],0,0).slice(0,-t).concat(e[2].slice(0,a)),this.fromNo&&e[3]&&(this.fromNo.data_p_old=this.array_init([],0,0).slice(0,-t).concat(e[3].slice(0,a)))),this.fromNo&&this.fromNo.data_p_old)for(;0===this.fromNo.data_p_old[this.fromNo.data_p_old.length-1];)this.fromNo.data_p_old.pop()}else this.data_p_old=null,this.data_t_old=null}},tgts_changed:function(e,t,a){this.save_all_unsubscribe(),this.tgts=e,this.key=t,pref_func.str2obj2(this,"tgts_obj2",e.join(","),null,!0),this.prep("both",this.prep_thread_subscribe),a||this.init()},time_unit_changed:function(e,t){this.fromNo&&this.fromNo.prep("live",this.fromNo.prep_board_unsubscribe),this.time_sel=e,this.time_unit=f[e],t||this.init()},len_changed:function(e){this.len=e,this.init()},init:function(){this.time_last=null,this.data_p=[],this.data_t=[],this.data_l=[],this.rm=this.chart&&(this.chart.show.ep||this.chart.show.et)?new b(this):null,this.fromNo&&(this.fromNo.data_p=[],this.fromNo.data_p_old=[],this.fromNo.min_idx=0),this.refresh(!0)},array_init:function(e,t,a){for(var n=t;n<this.len+2;n++)void 0===e[n]&&(e[n]=a);return e},tz_offset:(new Date).getTimezoneOffset(),label_init:function(e){for(var t=u[this.time_unit],a=t[2]?Math.floor((Math.floor((this.time_base-this.tz_offset+(this.len+2)*this.time_unit)/t[0])*t[0]-(this.time_base-this.tz_offset))/this.time_unit):this.len+2;a>=e;)this.data_l[a]=t[1](this.time_base+a*this.time_unit),a-=t[2]?t[0]/this.time_unit:1},prep_time:function(e){var t=Math.floor((Date.now()/6e4+this.tolerance)/this.time_unit)*this.time_unit;if(this.time_last!==t){var a=(t-this.time_last)/this.time_unit;this.time_last=t,this.time_base=t-this.time_unit*this.len;var n=0;e||0===a||(a>this.len&&(a=this.len),this.data_p.splice(0,a),this.data_t.splice(0,a),this.data_l.splice(0,a),this.rm&&(this.rm.data_p.splice(0,a),this.rm.data_t.splice(0,a)),this.fromNo&&(this.fromNo.data_p.splice(0,a),this.fromNo.data_p_old&&(this.fromNo.data_p_old.splice(0,a),0===this.fromNo.data_p_old.length&&(this.fromNo.data_p_old=null)),this.fromNo.min_idx-=a),this.data_p_old&&(this.data_p_old.splice(0,a),0===this.data_p_old.length&&(this.data_p_old=null)),this.data_t_old&&(this.data_t_old.splice(0,a),0===this.data_t_old.length&&(this.data_t_old=null)),n=this.len-a,this.min_idx-=a,this.min_idx<0&&(this.min_idx=0)),this.array_init(this.data_p,n,0),this.array_init(this.data_t,n,0),this.array_init(this.data_l,n,""),this.rm&&(this.array_init(this.rm.data_p,n,0),this.array_init(this.rm.data_t,n,0)),this.fromNo&&this.array_init(this.fromNo.data_p,n,0),this.label_init(n),this.shift=e?0:this.shift+a}this.wdg_tick.restart(6e4*this.time_unit)},prep:function(e,t,a){for(var n=0;n<this.tgts.length;n++){var r=common_func.name2domainboardthread(this.tgts[n],!0);"live"!==e&&"both"!==e||this.prep_1(liveTag.mems,r,t,a),"dead"!==e&&"both"!==e||this.prep_1(d,r,t,a)}},prep_1:function(e,t,a,n){t[2]?e[t[0]]&&e[t[0]][t[1]]&&e[t[0]][t[1]][t[2]]&&null!==n&&(n?n:a).call(this,e[t[0]][t[1]][t[2]]):t[1]?e[t[0]]&&e[t[0]][t[1]]&&this.prep_board(e[t[0]][t[1]],a,n):e[t[0]]&&this.prep_domain(e[t[0]],a,n)},prep_domain:function(e,t){for(var a in e)this.prep_board(e[a],t,func_t)},prep_board:function(e,t){for(var a in e)t.call(this,e[a])},prep_thread_init:function(e){e.s&&this.update_thread(e.s,0)},check_and_add_thread:function(e){e.s&&!this.prep_thread_unsubscribe(e,!0)&&(this.update_thread(e.s,0,!0),this.prep_thread_subscribe(e))},prep_thread_subscribe:function(e){Array.isArray(e.ss)?e.ss.push(this):e.ss?e.ss=[e.ss,this]:e.ss=this},prep_thread_unsubscribe:function(e,t){if(Array.isArray(e.ss)){var a=e.ss.indexOf(this);if(t)return a!==-1;a!=-1&&(e.ss.splice(a,1),1===e.ss.length&&(e.ss=e.ss[0]))}else{if(e.ss!==this)return!1;if(t)return!0;delete e.ss}},refresh:function(e){pref.debug_mode[15]&&console.log("updated: "+this.data_p.slice(this.len-10).toString()+", "+this.min_idx),this.prep_time(e),e?(this.prep("live",this.prep_thread_init),this.rm_tmp=new b(this,this.data_p,this.data_t),this.rm_tmp.prep("dead",this.rm_tmp.prep_board_init,this.prep_thread_init),this.rm&&this.rm.prep("dead",this.rm.prep_board_init,this.prep_thread_init),this.fromNo&&this.fromNo.prep("live",this.fromNo.prep_board_init,!0),this.load(),this.chart&&this.chart.replace_data(this)):0===this.shift&&this.min_idx===this.data_p.length||(this.fromNo&&this.fromNo.prep("live",this.fromNo.prep_board_init,!1,!0),this.chart&&this.chart.update_data2(this)),this.min_idx=this.data_p.length},update_thread:function(e,t,a){e&&(0===t&&this.update_thread_1(this.data_t,e,0,0),this.update_thread_1(this.data_p,e,t,e.length-1),a&&this.draw())},update_thread_1:function(e,t,a,n){for(var r=n;r>=a;r--){var o=Math.floor((t[r]-this.time_base)/this.time_unit),s=o-this.len-1;if(s>0&&(pref.stats.tolerant&&(this.tolerance=s*this.time_unit+this.tolerance,this.tolerance>pref.stats.tolerance&&(this.tolerance=pref.stats.tolerance),this.prep_time(!1)),o=this.len+1),!(o>=0))break;e[o]++,o<this.min_idx&&(this.min_idx=o)}}};var b=function(e,t,a){this.data_p=t||[],this.data_t=a||[],Object.defineProperty(this,"min_idx",{set:function(e){this.__proto__.min_idx=e},get:function(){return this.__proto__.min_idx},configurable:!0,enumerable:!0});for(var n in v)this[n]=v[n];this.__proto__=e},v={prep_board:function(e,t,a){if(e.sr)t.call(this,e);else for(var n in e)a.call(this,e[n])},prep_board_init:function(e){this.prep_board_init_1(e.sr,this.data_p),this.prep_board_init_1(e.srt,this.data_t)},prep_board_init_1:function(e,t){for(var a=e[this.time_sel][1],n=(this.time_base-e[this.time_sel][0])/this.time_unit,r=n;r<a.length;)a[r]&&(t[r-n]+=a[r]),r++}},y=function(e){this.data_p=[],this.min_idx=0;for(var t in k)this[t]=k[t];this.__proto__=e},k={prep_board_subscribe:function(e){e.s||n(e,"s"),e.s[this.time_sel][2].push(this)},prep_board_unsubscribe:function(e){if(e.s&&this.time_sel){var t=e.s[this.time_sel][2].indexOf(this);t!=-1&&e.s[this.time_sel][2].splice(t,1)}},prep:function(e,t,a,n){if(a&&this.__proto__.prep.call(this.fromNo,"live",this.fromNo.prep_board_subscribe,null),n)for(var r=this.min_idx;r<this.data_p.length;r++)this.data_p[r]=0;this.new_vals={},this.__proto__.prep.call(this,"live",t,null);for(var r in this.new_vals)this[r]=this.new_vals[r];delete this.new_vals},prep_board:function(e,t){t.call(this,e)},prep_board_init:function(e,t){var a=e.s[this.time_sel][1],n=(this.time_base-e.s[this.time_sel][0])/this.time_unit,r=this.min_idx+n;r<2&&(r=2);for(var o,s=r-1;s>0&&!a[s];)s--;if(s>0)o=a[s];else{for(;r<a.length&&!a[r];)r++;o=a[r++]}for(;r<a.length;)a[r]&&(this.data_p[r-n]+=a[r]-o,o=a[r]),r++;(void 0===this.new_vals.min_idx||this.new_vals.min_idx>r-n)&&(this.new_vals.min_idx=r-n)},update_posts_no:function(e,t){var a=(e-this.time_base)/this.time_unit+t;a>=0&&a<this.min_idx&&(this.min_idx=a)},prep_board_check_valid:function(e,t){this.valid&=e.s[f.length]>=0}},w={};return window.addEventListener("beforeunload",p,!1),pref.stats.auto_acquisition_scan&&setTimeout(_,1e3*pref.stats.auto_acquisition_scan_delay),{aggregate:function(e){if(e.posts){var a=liveTag.mems[e.domain][e.board],n=a[e.no];n.s||(n.s=[]);var r=e.parse_funcs.time_unit,o=n.s.length,s=o,l=e.posts.length-(e.nof_posts-n.s.length);if(!(l<0)){for(;l<e.posts.length;)n.s[s++]=Math.floor(e.posts[l++].time*r/6e4);if(n.ss)if(Array.isArray(n.ss))for(var l=0;l<n.ss.length;l++)n.ss[l].update_thread(n.s,o,!0);else n.ss.update_thread(n.s,o,!0);else 0===o&&t(n);pref3.stats.estimate_posts&&i(a,e,o,n.s,e.posts.length)}}},thread_removed:e,Stats:g,register_auto_acquisition:function(e){w["@"+c(e)]=null,cnst.auto_shrink_board_selector.color()},query_auto_acquisition:function(e){return void 0!==w["@"+c(e)]}}}():null,listener=null;site.features.listener&&pref.features.listener&&(listener=make_listener());var pn_debug=0;brwsr.sw_cache=brwsr.sw_cache&&window.SharedWorker&&(pref.info_server||pref.info_client)?function(){function e(e){if(!e){var n=new Blob(['          var ports = [];          var store = {};          var connections = 0;          self.addEventListener("connect", function(e){            var port = e.ports[0];            var no = connections++;            var func = function(e){msg_parser(e,port,no)};            port.addEventListener("message", func, false);            port.start();            port.postMessage(JSON.stringify(["INFO","Connected: #" + no]));            ports.push({port:port, func:func, echo:true, subscribe:false});          }, false);          function msg_parser(e,port,no){            if (ports[no].echo) port.postMessage(e.data);            var fields = JSON.parse(e.data);            if (fields[0]=="ECHO") ports[no].echo = fields[1];            else if (fields[0]=="GET") port.postMessage(JSON.stringify(["ACK",fields[1],store[fields[1]]]));            else if (fields[0]=="CLOSE") {              port.removeEventListener("message", ports[no].func, false);              ports[no] = null;            }/*            else if (fields[0]=="SET") store[fields[1]]=fields[2];*/            else if (fields[0]=="SET") {              var old_val = store[fields[1]];              if (old_val!=fields[2]) {                var msg = JSON.stringify(["EVENT",fields[1]]);                for (var i=0;i<ports.length;i++)                  if (i==no) store[fields[1]]=fields[2];                  else if (ports[i] && ports[i].subscribe) ports[i].port.postMessage(msg);              }            } else if (fields[0]=="STAT") stat_post(port,"STAT_ACK",fields[1]);else if (fields[0]=="SUBSCRIBE") ports[no].subscribe = fields[1];}var gc = setInterval(gc_func, 600000);function gc_func(){var date = Date.now() - 3600000;for (var i in store) if (store[i].date < date) delete store[i];}function stat_post(port,str,dump){var live = 0;for (var i=0;i<ports.length;i++) if (ports[i]) live++;var msg = JSON.stringify([str,"Connected: "+live+"/"+connections+", Stored: "+Object.keys(store).length]);port.postMessage(msg);var count = 0;if (dump) for (var i in store) port.postMessage(JSON.stringify(["DUMP_ACK",(count++)+": "+i+", "+JSON.stringify(store[i])]));}        '],{type:"text/javascript"});e=URL.createObjectURL(n),localStorage[s]=e}try{return r=new unsafeWindow.SharedWorker(e),r.port.addEventListener("message",t,!1),r.port.addEventListener("message",a,!1),r.port.start(),!0}catch(e){return!1}}function t(e){console.log((new Date).toLocaleTimeString()+", Worker said : "+e.data.substr(0,120)),o||(r.port.postMessage(JSON.stringify(["STAT"])),pref.debug_mode[0]||r.port.postMessage(JSON.stringify(["ECHO",!1])),window.addEventListener("beforeunload",function(){r.port.postMessage(JSON.stringify(["CLOSE"])),r.port.close()},!1)),o=!0,pref.debug_mode[0]||r.port.removeEventListener("message",t,!1)}function a(e){if(p=JSON.parse(e.data),"ACK"==p[0]){var t=p[1];clearTimeout(c[t]),l[t]&&(l[t][0](t,p[2],l[t][1]),delete l[t])}else if("EVENT"==p[0]){if(pref.info_client&&p[1].search(info_raw)!=-1&&"p"==p[1].substr(info_raw.length,1)){var a=(p[1].substr(info_raw.length+1),timer_obj?timer_obj.timer():null);null!=a&&brwsr.sw_cache.trygetItem(p[1],a.page_check5)}pref.info_client&&catalog_obj&&null!=catalog_obj.catalog_func()&&pref.catalog_snoop_refresh&&catalog_obj.catalog_func().catalog_insert(p[1])}p=null}function n(e){l[e][0](e,null,l[e][1]),delete l[e]}if(!localStorage)return null;var r=null,o=!1,s=pref.script_prefix+".bs",i=localStorage[s];i?e(i)||e():e(),!brwsr.ff&&r&&setTimeout(function(){null===i||o||(r.port.removeEventListener("message",t,!1),r.port.close(),e()||(brwsr.sw_cache=null))},5e3);var l=[],c=[],p=null;return r?{setItem:function(e,t){r.port.postMessage(JSON.stringify(["SET",e,t]))},trygetItem:function(e,t,a){l[e]=[t,a],c[e]=setTimeout(function(){n(e)},2e3),r.port.postMessage(JSON.stringify(["GET",e]))},subscribe:function(e){r.port.postMessage(JSON.stringify(["SUBSCRIBE",e]))},addEventListener:function(){}}:null}():null,(pref.catalog.embed&&"catalog"===site.whereami||pref.catalog.embed_page&&"page"===site.whereami||pref.thread.embed&&"thread"===site.whereami)&&catalog_obj&&(site2[site.nickname].catalog_native_prep_wait_loop?site2[site.nickname].catalog_native_prep_wait_loop(site.whereami,catalog_obj.show_hide):pref.patch.delayed_invoke.use?setTimeout(catalog_obj.show_hide,1e3*pref.patch.delayed_invoke.sec):catalog_obj.show_hide()),options.func0_prep=function(e,t){function a(){if(null==i&&null==l){var t=e.childNodes[1].childNodes[1].selectedIndex,a=e.childNodes[1].childNodes[2].value,r=parseInt(a.substr(0,a.indexOf(":")),10),c=parseInt(a.substr(a.indexOf(":")+1),10),_=Date.now();0==t?(s=(new Date).setHours(r,c,0))<_&&(s+=864e5):s=_+1e3*(3600*r+60*c),n()}else null!=i&&(clearTimeout(i),i=null),null!=l&&(clearInterval(l),l=null),p.innerHTML="";o(!1)}function n(){var e=Date.now(),t=s-e;i=t%6e4>=1e3&&t>6e4?setTimeout(n,t%6e4):t<9e4?setTimeout(function(){l=r(30),i=null},t-3e4):setTimeout(n,(t+3e4)%6e4+3e4);var a="";t%6e4>=1e3&&t%6e4<=59499&&(a=Math.round(t%6e4/1e3)+"s"),t>=59500&&(a=Math.floor((t+500)%36e5/6e4)+"m"+a),t>=3599500&&(a=Math.floor((t+500)/36e5)+"h"+a),p.innerHTML=a}function r(e){function t(){if(e-=1,p.innerHTML=e+"s",0==e){var t=document.createEvent("MouseEvents");t.initUIEvent("click",!1,!0,window,1),site.components.postform_submit.dispatchEvent(t),a()}}return p.innerHTML=e+"s",o(!0),setInterval(t,1e3)}function o(t){var a=t?"#ffc0cb":null!=i?"#f5ecf9":_.checked?"#e5f4f9":c;e.parentNode.style.background=a;var n=t||null!=i?"Cancel":"Schedule";e.childNodes[1].childNodes[0].value=n}cnst.add_to_tb(t,'<input type="checkbox">show option').childNodes[0].onchange=function(){cnst.show_hide(e)},e.innerHTML='<div style="float:left"><input type="checkbox">autobumper</div><div style="float:right"><input type="button" value="Schedule"><select name="time_sel"><option>at</option><option>later</option></select><input type="time" name="time" value="08:41"></div><div style="float:right"></div>',e.childNodes[1].childNodes[0].addEventListener("click",a,!1);var s,i=null,l=null,c=e.parentNode.style.background,p=e.childNodes[2],_=e.childNodes[0].childNodes[0];_.onchange=function(){o(!1)};var d=null;options.func0_exe=function(e){var t=document.getElementsByClassName("postreply").length-document.getElementsByClassName("de-post-deleted").length;parseFloat(e)>=site.max_page-1&&_.checked&&null==d&&t<site.autosage&&(l=r(30),d=setTimeout(function(){d=null},36e5))}}}}();
//# sourceMappingURL=https://raw.github.com/Dogman8/CatChan/master/CatChan.user.js.map
