// ==UserScript==
// @name CatChan
// @version 2021.07.18.3
// @description Cross domain catalog for imageboards
// @include http*://*krautchan.net/*
// @include http*://boards.4chan.org/*
// @include http*://boards.4channel.org/*
// @include http*://i.4cdn.org/*
// @include http*://8kun.top/*
// @include http*://lainchan.org/*
// @include http*://lainchan.jp/*
// @include http*://*meguca.org/*
// @require https://cdnjs.cloudflare.com/ajax/libs/Chart.js/1.0.1-beta.4/Chart.min.js
// @updateURL https://raw.github.com/Dogman8/CatChan/master/CatChan.meta.js
// @grant unsafeWindow
// @grant GM_xmlhttpRequest
// ==/UserScript==
//
//    Copyright 2014 DogMan8
//
//    This program is free software: you can redistribute it and/or modify
//    it under the terms of the GNU Affero General Public License as published by
//    the Free Software Foundation, version 3 of the License.
//
//    This program is distributed in the hope that it will be useful,
//    but WITHOUT ANY WARRANTY; without even the implied warranty of
//    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
//    GNU Affero General Public License for more details.
//
//    You should have received a copy of the GNU Affero General Public License
//    along with this program.  If not, see <http://www.gnu.org/licenses/>.
//
!function(){function pref_default(e){for(var t={image_hover:!1,image_prefetch:!1,click:"none",click_area:"thumbnail",format:{show:{style:!0,contents:!0,layout:!0,posts:!1,fileinfo:!1,images_2nd:!0},hover:{style:!0,contents:!1,layout:!1,posts:!0,fileinfo:!0,images_2nd:!0},search:{style:!1,contents:!1,layout:!1,posts:!0,fileinfo:!0,images_2nd:!0},thumb:{resize:!1,size:"small",small:{w1:150,h1:150,w2:75,h2:75},large:{w1:250,h1:250,w2:125,h2:125},vsmall:{w1:80,h1:80,w2:40,h2:40},custom:{w1:80,h1:80,w2:40,h2:40}},c:{width:165,height:0,max:!1},ec:{width:240,height:350,max:!0}},footer:{use:!0,nrtm:!0,nr:!0,rp:!0,rp0:!1,im:!0,domain:!1,board:!0,no:!1,flag:!1,tag:!0,page:!0,design:"native",rOP:!0,iOP:!0,custom:pref0.footer.native,custom2:pref0.footer.custom2,custom3:pref0.footer.custom3,ctime:!1,btime:!1,ptime:!1,rctime:!1,rbtime:!1,rptime:!1,br:!0,prate:!1,archived:!0,nd:!1,nl:!1,nf:!1,nid:!1,ns:!1,triage:!1,menu:!0,triage_str:"KILL,x,,SPC, ,",menu_str:"SPC, ,,MENU,▶,",merged_tag:"no",nr0:!1,nr1:!1,nr1_style:"color:limegreen;font-weight:bold",nrtm0:!1,nrtm1:!1,nrtm1_style:"color:lime;font-weight:bold"},triage_hover:!0,draw_on_demand:!0,load_on_demand:!1,load_on_demand_timeout:10,t2h_sel:"page",t2h_L:100,t2h_M:50,get t2h_N(){return this.t2h_num_of_posts},t2h_num_of_posts:5,save_board_list_sel:!1,board_list_sel:0,mark_new_posts:!0,auto_update:!1,auto_update_period:10,auto_update_countdown:!0,storePosts:"auto",sourceOfSP:"auto",searchAs:!1,searchAsA:!1,searchAc:{loosen:!0,max:1e3,max_threads:1e4,max_threads_at_refresh:1e4},popup:!0,colorID:!0,backlink:!0,popup_truncated:!0,popup_zIndex:100,backlink_all:!1,backlink_all_cross:!1,popup_hlt:!0,bl_ec:!1,bl_rm:!0,popup_delay:50,popdown_delay:500,popdown:"delay",popup_mMove:!0,inline_post:"inline",link_show_op:!0,link_show_cross:!0,expand_thumbnail_inline:!0,localtime:!0,expand_thumbnail_inline_all_after:!1,hide_posts_without_images:!1,thumbnail:{inline:{ondemandStop:!0,stopHover:!0,ref_height:150,limit_width:!0,limit_height:!1,margin_width:40,margin_height:0,webm:!0,webm_mute:!1,webm_loop:!1},hover:{limit_width:!0,limit_height:!0,margin_width:40,margin_height:0,webm:!1,webm_mute:!0,webm_loop:!1,webm_ctrl:!0,popup_delay:50,popdown_delay:500,popdown:"delay",popup_mMove:!0,popup_zIndex:101,dragfloat:!0,df_dblC:!0,df_mW:!0,zoom_click:!1,zoom_over:!1,zoom_dblC:!0,zoom_mW:!0}},infoPv:{use:!1,popup_delay:200,popdown_delay:0,popdown:"delay",popup_mMove:!1,popup_zIndex:101},popupX:{popup_delay:500,popdown_delay:500,popdown:"delay",popup_mMove:!0,popup_zIndex:101,use:!1,ID:!0,flag:!0,name:!1,anon:!1,trip:!1,ID2:!1},open_spoiler_text:!1,open_spoiler_image:!1,merge:!1,merge_list:!1,merge_list_str:"",merge_list_obj6:null,merge_truncated:!1,merge_lv:!0,merge_lv_str:"",merge_lv_obj6:null,merge_auto_list:!1,merge_auto_list_lv:2,merge_auto_list_lv_add:!0,merge_op_auto:!1,merge_op_lv:0,merge_op_lv_add:!0,merge_op_auto_hop:0,merge_op_lv_inc:!0,merge_op_attr:!1,merge_op_list:!1,merge_btn:!0,merge_btn_mode:"list",merge_btn_lv:2,merge_btn_lv_add:!0,lazyDraw:{merge:!0,merge_step:16,step:16},scroll_lock:!1,use_expander_always:!1,popup2_sel:"auto",popup2_sel_tolerance:10,popup2_resize:!1,popup2_resize_bw:8,popup2_resize_cw:20,popup3:{ww:"no",wn:"no",nw:"no",nn:"no",popup_delay:300,popdown_delay:500,popdown:"delay",popup_mMove:!0,popup_zIndex:100,oX:10,oY:10},posts_search_op:"opaque",posts_search_op_opacity:40,deleted_posts:{detect:"acc",store:"LS",merge:!0,auto_clean:!0},detect_sage:!1,page_his:!1,promiscuous:!1,accept_others_refresh:!1,hide_unwatched:!1,refresh_src:"bg",refresh_src_th:3,postMenu:!0,appearance:{titleBar:{filter:!0,settings:!0,refresh:!0,boards_selector:!0},initial:{state:"float",width:400,height:400,left:0,top:0},orderOnTB:!1,expand:{kwd:!0,time:!0,tag:!1,list:!1,ctrl:!1}},imagesearch:{use:!0,google:!0,iqdb:!0,saucenao:!0,whatAnime:!0,desustorage:!0,exhentai:!0},safety:{hide:!1,remove:!1,max:1e4},triage_place:"topLeft",env:{disp_offset:0,disp_filler:"",popup_native:!0,expand_thumbnail_inline_native:!0,image_hover_native:!1,colorID_native:!0,backlink_native:!0,localtime_native:!0,auto_update_native:!1,event_dynamic:!1,popup_native_kill:!0,refresh_initial:!0,kwd_filter_delay:0,kwd_filter_delay_len:5}},n={script_prefix:"CatChan",features:{page:!0,graph:!0,setting:!0,setting2:!0,postform:!0,catalog:!0,listener:!0,uip_tracker:!0,thread_reader:!0,debug:!1,notify:{desktop:!0,sound:!0,favicon:!0},recovery:!0,domains:common_func.Array_toObj(site0.domains,!0)},max_capture:576,interval_found:10,write_to_ls:!0,aggregator:"true",server:!0,load_pref:!0,load_data:!0,check_page:!1,check_post:!1,check_thread:!1,import_format:"obj",max_graph:576,scale_thread:10,auto_start:!0,prevent_redirection:!1,graph_animation:!1,autoconf:"auto",info_server:!1,info_client:!1,wafd_tb:"tb",wafd_open_spoiler:!1,show_page_fraction:!0,catalog_max_page:5,catalog_max_page_auto:!0,catalog_max_page_select:"auto",catalog_snoop_refresh:!0,catalog_auto_rollup_when_moving:!0,catalog_size_frame0_width:30,catalog_size_frame1_width:69,catalog_2nd_images_show:!1,catalog_2nd_images_hover:!0,catalog_2nd_images_search:!0,catalog_posts_on_demand:!0,catalog_popup_size_fix:!0,catalog_open_last50:"exist_watch",catalog_board_list_str:"//sample of board group\n//board_name[,nickname+board_name[+thread No.]['*'+up to X page]]..., [#Tag|##Tag]..., [!stats]\nGlobal/int/,8chan/int/,KC/int/,4chan/int/\nGlobal/b/,8chan/b/,KC/b/,4chan/b/\nv+gg,8chan/v/,8chan/gamergatehq/,4chan/v/\nInter/pol/,8chan/pol/,4chan/pol/\nJapanShoppingMall,8chan/jpck/,8chan/japan2/\ntech,meguca/g/,lain/tech/,8chan/tech/,4chan/g/,KC/t/\n",catalog_board_list_obj:null,catalog_promiscuous:!1,get catalog_board_list_sel(){return cataLog&&cataLog.embed_mode&&this[cataLog.embed_mode]?this[cataLog.embed_mode].board_list_sel:0},set catalog_board_list_sel(e){cataLog&&cataLog.embed_mode&&this[cataLog.embed_mode]&&(this[cataLog.embed_mode].board_list_sel=e)},localtime_offset:-((new Date).getTimezoneOffset()/60),catalog_footer_ignore_my_own_posts:!0,catalog_footer_tag_letters:3,catalog_no_popup_at_expanded:!0,catalog_open_in_new_tab:!0,catalog_open_where:"named",catalog_open_where_click:!0,catalog_triage_hist:16,triage:{popdown:!0,popdown_delay:2e3,hide_toggle:!0,sync_ex:"bg",sync_attr:"bg",sync_watch:"bg",menu_str:pref0.triage.menu_str,postMenu_str:pref0.triage.postMenu_str},catalog_triage_str:"KILL,X,,TIME,v,,WATCH,W,,UNWATCH,UW,,UNDO,U,",catalog_auto_update_countdown:!0,catalog_expand_with_hr:!1,cli:{auto:!1,json_str:'//{"site2":{"KC":{"time_offset":2}}} // summer time for KC.\n//{"site2":{"4chan":{"protocol":"https:"}}} // use https to 4chan.\n//{"pref":{"patch":{"rm_404_blacklist":["8chan"]}}} // 8chan sends corrupted data.\n',eval_str:""},tooltips:{help:{show:!0,popup_delay:2e3,popdown_delay:1e3},info:{show:!0,popup_delay:300,popdown_delay:500},zIndex:100},filter:{kwd:{use:!1,str:"",re:!1,ci:!0,match:0,sentence:!1,ew:!1,op:!0,post:!1,inPost:!1,sub:!0,name:!0,trip:!1,com:!0,file:!1,meta:!1,flag:!1,id:!1,id2:!1,rexps:null},tag:!1,tag_ci:!1,time:!1,time_creation:!1,time_str:new Date(Date.now()-864e5).toLocaleString(),time_obj6:null,time_ago_str:"0:00",time_ago_str_sync_at_refresh:!1,desktopime_mark_str:"",time_watch:!1,time_watch_creation:!1,list_time_scroll:!0,list:!0,list_str:"",list_obj2:{},attr_list:!0,attr_list_str:"",attr_list_obj2:{},bookmark_list:!0,bookmark_list_str:"",bookmark_list_obj2:{},watch_list_str:"",watch_list_obj2:{},tag_search:{str:"",re:!1,show_nof_boards:!1,get ci(){return pref.liveTag.ci},sentence:!1,rexps:null},tag2bList:{label:"",by:"tag"},auto_list:{use:!1,str:"",obj7:null,kill:!1,watch:!0,show:!1,sticky:!1,style:!1,style_str:""},disLWKA:!0,disTWKA:!1,postFilter:{use:!1,hide:!1,boards:!1,boards_str:"",style:!0,style_str:"",str:"",obj7:null,obj7_old:null}},postFilter:{use:!1,str:"",obj7:null,obj7_old:null},catalog:{max_threads_at_refresh:500,bookmark_list_rm404:!0,auto_load_filter:!1,auto_save_filter:!1,auto_save_filter_at_refresh:!1,tag:{ignore:12,max:12},board:{recommendation:!0,all_boards:!1,board_tags:!1,ex_list:!1,ex_list_str:"",ex_list_obj2:null,board_tags_same:!1},style_general_list:!0,style_general_list_str:"",style_general_list_obj2:null,refresh:{except_bt:!0,at_switch:!0},design:"auto",catalog_json:!0,embed:!0,embed_page:!0,embed_frame:!0,embed_archive:!1,order:{reply_to_me:!0,reply:!0,watch:"dont_care",sticky:"first",ordering:0},auto_watch:!0,auto_watch_override:!1,auto_watch_override_str:"WATCH,,",mimic_base_site:!0,appearance:{titleBar:{__proto__:t.appearance.titleBar},expand:{__proto__:t.appearance.expand},__proto__:t.appearance},t2h_sel:"no",click:"open",popupX:{__proto__:t.popupX},footer:{__proto__:t.footer},env:Object.create(t.env),format:{thumb:{__proto__:t.format.thumb},__proto__:t.format},merge_lv:!1,infoPv:{use:!1,__proto__:t.infoPv},safety:{__proto__:t.safety},searchAs:!0,accept_others_refresh:!0,__proto__:t},page:{get embed(){return pref.catalog.embed_page},infinite:!1,format:{show:{style:!1,contents:!1,layout:!1,posts:!0,fileinfo:!0,images_2nd:!0},thumb:{__proto__:t.format.thumb},__proto__:t.format},image_hover:!0,load_on_demand:!0,popupX:{__proto__:t.popupX},env:{kwd_filter_delay:500,__proto__:t.env},appearance:{titleBar:{__proto__:t.appearance.titleBar},expand:{__proto__:t.appearance.expand},__proto__:t.appearance},safety:{__proto__:t.safety},__proto__:t},thread:{embed:!1,format:{show:{style:!1,contents:!1,layout:!1,posts:!0,fileinfo:!0,images_2nd:!0},thumb:{__proto__:t.format.thumb},__proto__:t.format},image_hover:!0,popupX:{__proto__:t.popupX},env:{auto_update_native:!0,refresh_initial:!1,kwd_filter_delay:500,__proto__:t.env},auto_update:!1,merge_btn_mode:"all",triage_hover:!1,appearance:{titleBar:{__proto__:t.appearance.titleBar},expand:{time:!1,__proto__:t.appearance.expand},__proto__:t.appearance},safety:{__proto__:t.safety},__proto__:t},float:{click:"open",footer:{triage:!0,__proto__:t.footer},format:{thumb:{resize:!0,__proto__:t.format.thumb},fc:{resize:!1,width:240,height:350,max:!0},__proto__:t.format},save_board_list_sel:!0,popup3:{__proto__:t.popup3},popupX:{__proto__:t.popupX},env:Object.create(t.env),order:{reply_to_me:!0,reply:!0,watch:"dont_care",sticky:"first",ordering:0},view:"headline",hide_unwatched:!1,refresh_src:"wl",catalog_size:0,catalog_teaser:0,disable_kwd_filter_at_initial:!0,auto_launch:!1,clone:!0,appearance:{titleBar:{__proto__:t.appearance.titleBar},expand:{__proto__:t.appearance.expand},__proto__:t.appearance},safety:{__proto__:t.safety},__proto__:t},headline:{triage_hover:!1,triage_place:"topLeft",max_letters:150,merge_truncated:!0,merge_lv:!1},common:{clear_at_manual_scan:!1,consolidated_filter:!1,consolidated_watch_list:!0,sync_watch_list:!0,sync_watch_list_delay:100,watch_list_rm404:"no",blur_404:!0},uip_tracker:{on:!1,posts:!0,deletion:!0,interval:10,adaptive:!0,highlight_str:"color:red",annotate:!0,auto_open:!1,auto_open_th:300,auto_open_kwd:"",deletion:{show:!0,link:!0,name:!0,name_str:"color:red",addName:!0,addName_str:"DELETED_",post:!1,post_str:"opacity:0.4"},sage:{detect:!0,name:!0,name_str:"color:blue",addName:!1,addName_str:"SAGE_",post:!1,post_str:"opacity:0.4",tolerance:1,patch_bug:!1,patch_bug2:!1,patch_bug2nth:8,patch_bug3:!0,annotate:!0,page:!1,patch_bug4:!0,patch_bug5:!1,annotate_page:!1}},thread_reader:{use:!0,sync:!0,triage:!0,triage_close:!0,check_num_of_children:!0,own_posts_tracker:!1,show_own_post_by:"anchor",show_reply_to_me_by:"anchor",clean_up_own_posts:!0,unmark_on_hover:!0},IDinfo:{use:!0,auto:!0,ID:{use:!0,nof:!0,op:!0,h:"",t:""},ID2:{use:!1,nof:!0,op:!0,h:"",t:""},flag:{use:!0,nof:!0,ID:!0,h:"(",t:")"},trip:{use:!1,nof:!0,name:!1,h:"(",t:")"},name:{use:!1,nof:!0,trip:!1,h:"(",t:")"}},settings:{indexing:0},tag:{gen:!1,gen_str:""},cloudflare:{auto_reload:!0,auto_reload_time:5},scan:{max:1e4,lifetime:20,crawler:50,max_threads:1e3,crawler_adaptive:!0,crawler_idle_time_to_spawn:100,max_archive:150},notify:{sound:{notify:!1,src:"beep",beep_freq:1e3,beep_length_f:.2,beep_volume_f:1,reply_to_me:!0,reply:!0,new_thread:!0,appear:!0,supp_init:!0},desktop:{notify:!0,reply_to_me:!0,reply:!0,new_thread:!0,appear:!0,lifetime:30,show_last:!1,supp_init:!0,limit:brwsr.ff?10:30,delay:brwsr.ff?500:0},favicon:!0,title:{notify:!0,hide_zero:!0}},liveTag:{use:!0,max:12,maxstr:25,from:"post",lock_tags_in_op:!0,ci:!0,inherit_board_name:!0,lock_board_name:!0,inherit_board_tags:!0,lock_board_tags:!0,info:!0,NC:!0,style:{ex:"color:blue",exurtm:"color:cyan;font-weight:bold",exur:"color:deepskyblue;font-weight:bold",in:"color:red",inurtm:"color:yellow;font-weight:bold",inur:"color:orange;font-weight:bold",use:!0,urtm:"color:lime;font-weight:bold",ur:"color:limegreen;font-weight:bold"},pickup_interval:10,rm_404:"imm",disp_delay:{fg:500,bg:5e3},click_func:"in",click_func_bl:"pkin",watch_all:!0,lazy_each:150,lazy_delay:100,ex_list:!0,ex_list_str:"8chan:#selection\n",ex_list_obj5:null,rm_list:!0,rm_list_str:"http*\n",rm_list_obj5:null},virtualBoard:{show:!0,max:20,scan:!1,scanDelay:5,p_board:"replace",p_remove:!1,v_remove:!0,scan_domains:common_func.Array_toObj(site0.domains,"none"),instant_scan:!0,search:{show:!0,str:"",re:!1,get ci(){return pref.liveTag.ci},sentence:!1,rexps:null}},tagSearch:{auto:!1,th_b:20,th_t:1},style:{sel:"fix",zIndex:1,fix:{titleBar_str:"background:#b5ccf9;border:1px solid blue;font-weight:normal",window_str:"background:#e5ecf9;color:#000000;font-weight:normal",popUp_str:"background:#e5f4f9;color:#000000;border:2px solid blue;font-weight:normal"},copy:{titleBar_str:"body",window_str:"body",popUp_str:"body"},post_editing:"background:#cec952 !important",post_new:"border:2px solid red",userCSS:{use:!1,str:""},tips:{merged1:!0,merged1_str:'merged1::before{float:left;content:">";}',merged2:!0,merged2_str:'merged2::before{float:left;content:">>";}',merged3:!0,merged3_str:'merged3::before{float:left;content:">>>";}'},addSS:{use:!1,str:""}},recovery:{comment:!0,interval:10,auto_clean:!0},healthIndicator:{show:!0,max:10,expand_running:!1,dont_retire_running:!0,cancel:!0},network:{cross_domain:"indirect",fetch_actively:!0,adaptive:!0,th100:5,th100_delay:500,th20:10,th20_delay:100,timeout:15,overXFO:!0,overCSPF:!0},stats:{use:!1,retain_404:!0,draw_delay:10,estimate_posts:!0,save:!0,load:!0,len_capture:1440,auto_acquisition:!0,auto_acquisition_scan:!0,auto_acquisition_scan_delay:120,auto_acquisition_all:!1,tolerant:!0,tolerance:90,patch_tm:!1},chart:{off_anime_blur:!0,window_width:400,window_height:400,instant_scan:!0,load_on_demand:!1,inst:{len:120,scale_thread:10,time_sel:1,board_sel:0,show_legend:!0,show:{np:!0,p:!1,ep:!1,nt:!1,t:!0,et:!1},clip_np:!1,clip_np_val:0,options:{bezierCurve:!1,animation:!1,pointDot:!0,pointDotRadius:4}}},archive:{load_img:!0,restore_auto:!0,clear_threads:!0,clear_files:!1,format:"auto",domain:0,board:"",src:"shown",store_auto:!1,dir_dled:null,open_local:!1,fix_inconsistency:!0,store_watched:!1,oneshot:{post:!0,tn:!0,img:!0,webm:!0,post_idb:!0,tn_idb:!0,img_idb:!0,webm_idb:!0},live:{post:!0,tn:!0,img:!1,webm:!1,post_idb:!0,tn_idb:!0,img_idb:!1,webm_idb:!1},deleted:{post:!0,tn:!0,img:!1,webm:!1,post_idb:!0,tn_idb:!0,img_idb:!1,webm_idb:!1},IDB:{auto_clean:!0,auto_clean_init:!0,prune:168,prune_flush:!1,nof_tr:10,nof_cl:20,nof_cl_max:80,auto_restore:!1,auto_restore_watch:!1,auto_restore_remove:!0,watchdog:120,redirect_404:!1,redirect_404_CSP:!1},kwd:{use:!0,str:"",re:!1,ci:!0,match:0,op:!0,post:!1,sub:!0,name:!0,trip:!1,com:!0,file:!1,meta:!1,sentence:!1,rexps:null},list:!0,list_str:"",list_obj6:null,list_inherit:!1,tar:!0,tarsize:100,sub_in_filename:!0,files_sel:0,IDB_board_sel:0,IDB_board_sel_gfunc_pre:pref4.archive.IDB_board_sel_gfunc_pre,IDB_thread_sel:0,IDB_thread_sel_gfunc_pre:pref4.archive.IDB_thread_sel_gfunc_pre,IDB_select_multiple:!0,editing_timeout:!0},threadStats:{use:!1,full:!0,retry:!1},debug_mode:{unread_count:"",parse_error:!1,site2func:"",site2func_expand:!0,pfunc:"",pfunc_expand:!0,pfunc_all:"",pfunc_all_expand:!0,pfunc_comp:"",pfunc_comp_expand_same:!0,pfunc_comp_expand_diff:!0,pfunc_comp_proto:"",domains:common_func.Array_toObj(site0.debug_domains,!0),types:common_func.Array_toObj(site0.debug_types,!0)},test_mode:{tips:!1,num:0,num_f:0,test_str:""},patch:{delayed_invoke:{use:!1,sec:10},rm_404_blacklist:[]},pref2:{KC:{summer_time:!1},meguca:{historyAPI:!0,utilize_boards_json:!0,utilize_boards_json_domain:!0},"8chan":{utilize_boards_json:!0},BBC:{summer_time:!0}},easy:{posts_ago:24,threads_ago:24,max_boards:50},easy2:{reset:!0,presets:0,time_post:24,time_op:24,basics:!0,auto_update:!1,auto_update_period:10,VB:{local:0,global:0},LTfrom:0,limits:0,virtualBoard:{show:!0,scan:!0,max:100},liveTag:{use:!1,from:"op"},catalog:{embed:!0,embed_page:!0,max_threads_at_refresh:500,auto_load_filter:!0,auto_save_filter:!0,auto_save_filter_at_refresh:!0,auto_update:!0,auto_update_period:10},filter:{time_watch:!1,time_watch_creation:!1},page:{auto_update:!0,auto_update_period:10},thread:{embed:!1,auto_update:!0,auto_update_period:10},notify:{desktop:{notify:!0}},stats:{use:!1},scan:{max:100,max_threads:1e3},network:{fetch_actively:!1},healthIndicator:{expand_running:!1}},INST:{},proto:t},r=0;r<40;r++)n.debug_mode[r]=!1;for(var r=0;r<200;r++)n.test_mode[r]=!1;return site0.pref_default2&&pref_func.pref_overwrite(n,site0.pref_default2),site0.pref_default&&pref_func.pref_overwrite(n,site0.pref_default),e?pref_func.delete_null(n):Object.defineProperty(n,"samples",{get:function(){return pref_func.settings.samples}}),common_func.Object_modifyDescriptor(n.style.userCSS,"sample",{writable:!1}),common_func.Object_modifyDescriptor(n.features.domains,site0.domain,{writable:!1}),Object.defineProperty(n.triage,"sampleLoader",{value:0,configurable:!0}),n}function make_port_parent(e,t){function n(e,t,n){if(pref.debug_mode[0]&&console.log(window.name+": Connecting from "+e.data),e.source==n&&new RegExp(site.nicknames.join("|")).test(e.data)||e.source==site.embed_frame_win&&"frame"===site.whereami&&e.data.indexOf("CLOSE")==-1){if(pref.debug_mode[0]&&console.log(window.name+": Connected successfully."),brwsr.ff?init_receive_port(t,n):init_receive_port(t,e.ports[0]),window.removeEventListener("message",init_func[t],!1),delete init_func[t],messages_to_send[t]){for(var r=0;r<messages_to_send[t].length&&!send_message(t,messages_to_send[t][r][0],null,messages_to_send[t][r][1]);r++);delete messages_to_send[t]}"_blank"==t&&send_message(t,["CLOSE"])}else pref.debug_mode[0]&&console.log(window.name+": FAIL.")}ports[e]&&send_message(e,["CLOSE"]),ports[e]="init",init_func[e]=function(r){n(r,e,t)},window.addEventListener("message",init_func[e],!1),pref.debug_mode[0]&&console.log(window.name+": Waiting for connection from "+e+" ...")}function make_port_child(e){if(pref.debug_mode[0]&&console.log(window.name+": Try to connect to parent..."),brwsr.ff)init_receive_port("parent",e),e.postMessage(window.name,"*");else{var t=new MessageChannel;init_receive_port("parent",t.port1),e.postMessage(window.name,"*",[t.port2])}}function init_receive_port(e,t){ports[e]=t,receive_func[e]=function(t){receive_message(t,e)},brwsr.ff?window.onmessage=receive_func[e]:(t.addEventListener("message",receive_func[e],!1),t.start())}function close_connection(e){brwsr.ff||ports[e].close(),ports[e].removeEventListener("message",receive_func[e],!1),delete receive_func[e],delete ports[e]}function send_message(e,t,n,r){if(Array.isArray(t)&&Array.isArray(t[0])&&(t=t[0],console.log("WARNING, PATCHED: send_mesage")),n&&make_port_parent(e,n),"init"===ports[e])messages_to_send[e]||(messages_to_send[e]=[]),messages_to_send[e].push([t,r]);else{if(!ports[e]&&(e="parent",!ports[e]))return;if(pref.debug_mode[0]&&console.log(window.name+": Sent to "+e+": "+JSON.stringify(t).substr(0,80)),brwsr.ff?ports[e].postMessage(t,"*",r):ports[e].postMessage(t,r),"CLOSE"==t[0])return close_connection(e),!0}}function receive_message_emu(e){for(;send_message_emu.length>0;)receive_message({data:send_message_emu.shift()},e||site.key)}function jump_to_time(e,t){pref.test_mode[167]&t<65536&&(t=e.posts[t-1]&&e.posts[t-1].time||t);var n=site2[e.domain].mark_newer_posts2(e.posts,t,pref.thread_reader.unmark_on_hover,!0),r=gGEH.marked_first_post&&e.posts[n]?gGEH.marked_first_post.time_tu<e.posts[n].time_tu?gGEH.marked_first_post:e.posts[n]:gGEH.marked_first_post||e.posts[n];if(r){var a=r.pn.offsetTop;if(!a&&pClg&&(pClg.show_catalog_delayed(),!(a=r.pn.offsetTop))){for(;n>0&&!e.posts[n].pn.parentNode;)n--;a=e.posts[n].pn.offsetTop+e.posts[n].pn.offsetHeight}scrollTo(0,a-site.header_height())}else scrollTo(0,document.body.clientHeight-window.innerHeight);gGEH.marked_first_post=r}function receive_message(e,t){pref.debug_mode[0]&&console.log(window.name+": Received from "+t+": "+e.data.toString().substr(0,80));var n=e.data,r=e.ports;if("404"===site.whereami&&"CLOSE"!==n[0])return void(received_messages_404?received_messages_404.push(e.data):received_messages_404=[e.data]);if("string"==typeof n&&(n=JSON.parse(n)),"HTTPD"==n[0])httpd.sub_funcs(n[1]);else if("IDB"==n[0]&&IDB)IDB.sub_funcs(n[1],r);else if("ARCHIVER"==n[0]&&archiver)archiver.sub_funcs(n[1],n[2]);else if("CLOSE"==n[0])close_connection(t);else if("MARK"==n[0]&&n[1]>0){if(jump_to_time(site.myself,n[1]),gGEH.time_jumped=n[1],pClg&&"thread"===pClg.mode)for(var t in pClg.threads)t!==site.key&&pClg.threads[t][1]&&jump_to_time(pClg.threads[t][16],n[1]);common_obj.thread_reader&&common_obj.thread_reader.mark_posts_from_parent(n[1])}else"OWN_POSTS"==n[0]?site2[n[1]].prep_own_posts_event_received?site2[n[1]].prep_own_posts_event_received(n[2]):site3[n[1]].own_posts=n[2]:"TRIAGE"==n[0]?catalog_obj&&null!=catalog_obj.catalog_func()&&catalog_obj.catalog_func().triage_exe_pipe(n[1]):"UIP"==n[0]?uip_tracker&&uip_tracker.annotate_from_catalog(n[1]):pref.test_mode[34]&&"ECHO"===n[0]&&setTimeout(function(){send_message(window.name?"parent":"meguca",["ECHO",n[1]])},5e3)}function close_all(){for(var e in ports)send_message(e,["CLOSE"])}function make_uip_tracker(){function e(){d=null,site2[site.nickname].uip_check(t,o)}function t(e,t){a(e,t,!0)}function n(e){0!=u.length?r():y+b>Date.now()+1e3*pref.uip_tracker.interval&&(clearTimeout(d),v=0,s())}function r(){for(var e=0;e<u.length;e++){var t=u[e],n=t[0],r=site2[site.nickname].uip_tgt_post(n);if(r){var a=document.createElement("span");if(a.innerHTML=" (<span>"+t[2]+"</span>)",t[4]&&a.childNodes[1].setAttribute("style",pref.uip_tracker.highlight_str),pref.uip_tracker.posts){var s=document.createElement("span");s.innerHTML="<span>"+t[1]+"</span>"+(t[5]&&pref.uip_tracker.deletion.show?"("+(pref.uip_tracker.deletion.link?t[5].map(function(e){return'<a href="#p'+e+'" class="quotelink">&gt;&gt;'+e+"</a>"}):t[5]).join()+")":"")+"/",t[3]&&s.childNodes[0].setAttribute("style",pref.uip_tracker.highlight_str),a.insertBefore(s,a.childNodes[1])}if(t[5]&&(pref.uip_tracker.deletion.name||pref.uip_tracker.deletion.addName||pref.uip_tracker.deletion.post))for(var i=0;i<t[5].length;i++)l({no:t[5][i]},pref.uip_tracker.deletion,!0);if(pref.uip_tracker.sage.page){var o=document.createElement("span");k[n]?(k[n].pn=o,k[n].his.length>0&&p(k[n])):k[n]={pn:o,his:[]},a.insertBefore(o,a.lastChild)}var c=site2[site.nickname].uip_post_num(r);c[c.length-1].appendChild(a),w||0!=e||(w=[a,t]),u.splice(e--,1)}}}function a(e,t,n){if(v++,200==t.status){var a=site2[site.nickname].parse_json_thread("response"in t?t.response:JSON.parse(t.responseText),n).posts,i=a.length,o=a[i-1].unique_ips||f[2],l=a[i-1].no;if(f[0]!=l||f[1]!=i||f[2]!=o){pref.debug_mode[31]&&console.log(new Date(t.date).toLocaleTimeString()+", "+l+", "+i+", "+o);for(var p={},c=0;c<a.length;c++)p[a[c].no]=null;pref.uip_tracker.auto_open&&0!=f[0]&&g(a,p,h);var d=a.length<f[1]||a[f[1]-1].no!=f[0];if(pref.uip_tracker.deletion.show||pref.uip_tracker.deletion.name||pref.uip_tracker.deletion.addName||pref.uip_tracker.deletion.post){var m=[];for(var c in h)void 0===p[c]&&(m[m.length]=c);pref.debug_mode[31]&&""!==m&&console.log("uip_deleted "+m)}f=[l,i,o,d,f[2]!=o,0!=m.length?m:null],u.push(f),v=0,h=p}r();var b=a[0]}404==t.status||b&&(b.archived||b.closed)?_():s()}function s(){pref.uip_tracker.on?(b=0!==b&&0!=v&&pref.uip_tracker.adaptive?v%8==0?b>=18e5?36e5:2*b:b:1e3*(pref.uip_tracker.interval>10?pref.uip_tracker.interval:10),d=setTimeout(e,b),y=Date.now()):_()}function i(e){if("page"!==e[0]){if("sage"===e[0])return void o({posts:e.map(function(e){return{no:e,email:"sage"}})});for(var t=w?w[1]:0!=u.length?u.splice(0,1)[0]:null,n=0;n<e.length;n+=3)u[u.length]=[e[n],e[n+1],e[n+2],!1,e[n+1]==e[n+2]||n>=3&&e[n+2]!=e[n-1],null];if(pref.uip_tracker.sage.page){for(var a={},n=0;n<u.length;n++)a[u[n][0]]=null;for(var n in k)void 0===a[n]&&u.splice(u.length-1,0,[n,"?","?",!1,!1,null])}if(t){var s=u[u.length-1];s[0]==t[0]&&s[1]==t[1]&&s[2]==t[2]||(u[u.length]=t.slice(0,3).concat(!1,s[2]!=t[2],null)),w&&w[0].parentNode.removeChild(w[0])}else f=u[u.length-1],w=!0;r()}else{var i=JSON.parse(e[1]);for(var n in i)k[n]={pn:null,his:i[n]}}}function o(e,t){t&&(T=t);for(var n in C)l(C[n])&&delete C[n];if(e&&e.posts){for(var n=e.posts.length-1;n>=1&&("sage"===e.posts[n].email&&void 0===x[e.posts[n].no]);n--)l(e.posts[n]);if(pref.uip_tracker.sage.patch_bug)for(var n=e.posts.length-1;n>=1;n--)if("sage"!==e.posts[n].email){if(null!==x[e.posts[n].no]&&!C[e.posts[n].no])break;pref.debug_mode[30]&&console.log("OVERDETECTION: "+e.posts[n].no),null===x[e.posts[n].no]&&l(e.posts[n],{name_str:"",addName_str:"OVERDETECTED_",post_str:"",__proto__:pref.uip_tracker.sage}),delete C[e.posts[n].no],delete x[e.posts[n].no]}if(pref.uip_tracker.sage.page&&void 0!==e.page){var r=e.posts[e.posts.length-1].no,a=c(e.page);k[r]?site2["4chan"].page_his_update(k[r].his,a)&&k[r].pn&&p(k[r]):k[r]={pn:null,his:[a]}}}}function l(e,t,n){var r=site2[site.nickname].uip_tgt_post(e.no);if(r){var a=site2[site.nickname].parse_funcs.post_html.pn_name({pn:r,__proto__:e});return t||(t=pref.uip_tracker.sage),t.name&&a.setAttribute("style",t.name_str),t.addName&&(a.textContent=t.addName_str+a.textContent),t.post&&r.setAttribute("style",t.post_str),n||(x[e.no]=null),!0}n||(C[e.no]=e)}function p(e){e.pn.textContent="/"+e.his.map(function(e){return Math.floor(e/T)+"."+e%T}).join("→")}function c(e){var t=e.split(".");return parseInt(t[0],10)*T+parseInt(t[1],10)}function _(){m.disconnect(),d&&clearTimeout(d),uip_tracker=null}var d,u=[],f=[0,1,1],h={};e();var m=new MutationObserver(n);m.observe(site.myself.pn,{childList:!0});var g=function(){function e(e,r){for(var a=r.response,i=0;i<a.length;i++)for(var o=0;o<a[i].threads.length;o++){var l=a[i].threads[o];n[l.no]={sub:l.sub,name:l.name,com:l.com},s<l.no&&(s=l.no)}t()}function t(){var e=new RegExp(pref.uip_tracker.auto_open_kwd||".*");for(var t in r){var i=n[t];i&&t>site.no&&void 0===a[t]?((i.sub&&i.sub.search(e)!=-1||i.name&&i.name.search(e)!=-1||i.com&&i.com.search(e)!=-1)&&(window.open(site2[site.nickname].make_url4([site.nickname,site.board,t,"thread_html"])[0],"_blank"),a[t]=t),delete r[t]):(s>t||r[t]--<=0)&&delete r[t]}}var n={},r={},a={},s=site.no;return function(n,a,s){for(var i=n.length-1;i>=1&&i>=pref.uip_tracker.auto_open_th&&void 0===s[n[i].no];)i--;if(i!=n.length-1){for(var o=document.createElement("span");++i<n.length;){o.innerHTML=n[i].com;for(var l=o.getElementsByTagName("a"),p=0;p<l.length;p++){var c=l[p].textContent.match(/>>([0-9]+)$/);c&&(c=c[1],void 0===a[c]&&void 0===s[c]&&(r[c]=3))}}t(),0!=Object.keys(r).length&&http_req.get("uip_auto",[site.nickname,site.board,site.no,"catalog_json"].join(),"",e)}}}(),v=0,b=0,y=0,w=null,k={},x={},C={},T=15;return{destroy:_,annotate_from_catalog:i}}function uip_tracker_init(){null===uip_tracker&&site.features.uip_tracker&&pref.features.uip_tracker&&"thread"===site.whereami&&pref.uip_tracker.on?uip_tracker=make_uip_tracker():uip_tracker&&!pref.uip_tracker.on&&uip_tracker.destroy()}function make_thread_reader(){function e(e){e.addEventListener("click",site2[site.nickname].check_reply.remake_own_posts,!1),d&&e.addEventListener("click",d.get_my_posts_no,!1)}function t(e){e.removeEventListener("click",site2[site.nickname].check_reply.remake_own_posts,!1),d&&e.removeEventListener("click",d.get_my_posts_no,!1)}function n(e){if(u=e,e/=site2[site.nickname].parse_funcs.thread_html.time_unit,_[0]&&_[0].time<e){for(var t=1;t<_.length&&_[t].time<=e;)t++;s({target:_[t-1].pn})}else{var n=site.nickname+(site2[site.nickname+"_live"]?"_live":""),r=site2[site.nickname].wrap_to_parse.get(document,site.nickname,site.board,"thread_html",{thread:site.no,parse_funcs:site2[n].parse_funcs.thread_html})[0],a=r.posts.length;if(_[0])for(;a>0&&r.posts[a-1].time>=_[0].time;)a--;for(var t=a;t>0&&r.posts[t-1].time>e;)t--;_=r.posts.slice(t,a).concat(_)}}function r(e,t){for(var n=0;n<e.length;n++)e[n].time_tu>=u&&(_[_.length]=e[n]);_.sort(function(e,t){return e.time_tu-t.time_tu}),c[p][19][1]=(4294901760&c[p][19][1])+_.length,d&&d.update_own_posts(e,t)}function a(e){if(0!=_.length){var t=brwsr.document_body.scrollTop;t<=f||(f=t,t+=window.innerHeight,s(e,t))}}function s(e,t){for(var n;0!=_.length&&!(t&&_[0].pn.offsetTop+_[0].pn.offsetHeight>t);){n=_.shift().time*site2[site.nickname].parse_funcs.post_json.time_unit}if(n){c[p][19][1]=_.length;for(var r=0;r<_.length;r++)_[r].reply_to_me&&(c[p][19][1]+=65536);pref.test_mode[167]&&(n=site.myself.posts.length-_.length),notifier.favicon.set(c),pref.thread_reader.sync&&window.opener?send_message("parent",["TRIAGE",[p,"TRACK",c[p][19][1],!1,n]]):pClg&&pClg.triage_multicast(p,"TRACK",c[p][19][1],!1,n)}}function i(e,t){pClg||catalog_obj.show_hide(null,"thread"),setTimeout(function(){pClg.triage_exe_broadcast(p,e,t,!0)},0)}function o(e,t){send_message("parent",["TRIAGE",[p,e,t,!0,site2.DEFAULT.check_reply.get_checked_time(c[p][19])]])}function l(n,r){return!n&&pref.thread_reader.own_posts_tracker&&r?(e(r),n=r):!n||pref.thread_reader.own_posts_tracker&&r||(t(n),n=null),n}var p=site.nickname+site.board+site.no,c={};c[p]=[],c[p][19]=liveTag.mems.init({domain:site.nickname,board:site.board,no:site.no}).wt;var _=[],d=function(){function e(){r=!0}function t(e,t){if(0==e.length)return void(r=!1);if(r){var n=pref.script_prefix+".own_posts."+site.board+site.no,a=JSON.parse(localStorage[n]||"[]"),s=[];if(t)for(var i=0,o=e.length-1;i<a.length;){for(;o>0&&a[i]>e[o].no;)o--;a[i]===e[o].no&&(s[s.length]=e[o]),i++}else s[0]=e[e.length-1],a[a.length]=s[0].no,localStorage[n]=JSON.stringify(a);for(var i=0;i<s.length;i++){var l=s[i].parse_funcs_html.pn_name(s[i]);"plain"===pref.thread_reader.show_own_post_by?l.parentNode.insertBefore(document.createTextNode(" (You)"),l.nextSibling):l.innerHTML=l.innerHTML+" (You)"}r=!1}for(var i=0;i<e.length;i++)site2[site.nickname].check_reply.add_you(e[i])}function n(){"post"===this.name&&e()}var r=!0;return{update_own_posts:t,get_my_posts_no:e,event_submit:n}};pref.thread_reader.own_posts_tracker?(d=d(),site.components.postform_submit||window.addEventListener("submit",d.event_submit,!1)):d=null;var u=site.myself.posts[site.myself.posts.length-1].time_tu;d&&d.update_own_posts(site.myself.posts,!0);var f=0;window.addEventListener("resize",function(){f=0},!1);var h=document.createElement("div"),m=site.embed_to.bottom();m.parentNode.insertBefore(h,m),h.appendChild(new Triage("WATCH,Watch,,UNWATCH,UnWatch,",{onclick:i}).pn),window.opener&&pref.thread_reader.triage&&h.appendChild(new Triage(pref.catalog_triage_str,{onclick:o}).pn),pref.notify.favicon&&window.addEventListener("scroll",a,!1);var g=l(null,site.components.postform_submit),v=l(null,site.components.postform_submit2);window.addEventListener("storage",site2[site.nickname].check_reply.remake_own_posts,!1),"4chan"===site.nickname&&function(){var e=new WeakMap;site2[site.nickname].catalog_get_native_area().addEventListener("click",function(t){var n=t.target;if("A"===n.tagName&&"embed"==n.dataset.cmd){var a=e.get(n);a?(a.parentNode?a.remove():e.get(a).remove(),e.delete(a),e.delete(n)):r.observe(n.parentNode,{childList:!0})}},!1);var t=function(e){cnst.tack_float_nSblgs(e,null,!0)},n=function(e){var t=cnst.tack_dock_nSblgs(e,!0)
;"X"===e.target.textContent?t.tack.previousSibling.previousSibling.dispatchEvent(new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window})):(t.pn.style.float=null,t.pn.style.display=null,t.pn.style.overflow=null,t.pn.classList.remove(pref.script_prefix+"_titleBar"))},r=new MutationObserver(function(a){var s=a[0].addedNodes[0],i=site2[site.nickname].make_tack();cnst.set_tack_float(i,t,n),e.set(s.previousElementSibling,i),e.set(i,s),s.parentNode.insertBefore(i,s),r.disconnect()})}();var b=null;return pref.IDinfo.use&&function(){function e(e,n){n.ID.use&&o&&t(_.ID,e,"pn_id","id",pref.IDinfo.ID,null,null,pref.IDinfo.ID.op&&i),n.ID2.use&&c&&t(_.ID2,e,"pn_id2","id2",pref.IDinfo.ID2,null,null,pref.IDinfo.ID2.op&&p),n.flag.use&&l&&t(_.flag,e,"flag","country",pref.IDinfo.flag,pref.IDinfo.flag.ID&&_.flagIDs,"id"),n.trip.use&&t(_.trip,e,"pn_trip","trip",pref.IDinfo.trip,pref.IDinfo.trip.name&&_.tripNames,"name"),n.name.use&&t(_.name,e,"pn_name","name",pref.IDinfo.name,pref.IDinfo.name.trip&&_.nameTrips,"trip");for(var r=0;r<e.length;r++)d.add(e[r].no)}function t(e,t,a,s,i,o,l,p){for(var c={},_=0;_<t.length;_++){var d=t[_],u=d[a];if(u){var f=d[s];n(e,f,u,c),o&&d[l]&&(void 0==o[f]&&(o[f]={}),o[f][d[l]]=null)}}r(e,c,pref_func.sanitize(i.h),pref_func.sanitize(i.t),i.nof,o,p)}function n(e,t,n,r){var a={pn:n,c:Object.keys(e).length+(e[t]?0:1)};e[t]?e[t].push(a):(a.m=!0,e[t]=[a]),void 0===r[t]&&(r[t]=e[t].length-1)}function r(e,t,n,r,a,s,i){for(var o in t)for(var l=s&&s[o]&&Object.keys(s[o]).length||0,p=i&&i===o?"OP:":"",c=e[o],_=0;_<c.length;_++){var d=n+p+(_+1)+"/"+c.length+(l?"/"+l:"")+(a?"/":r);if(_<t[o])c[_].pn.textContent=d;else{var u=document.createElement("span");u.innerHTML=d+(a?"<span"+(c[_].m?' style="color:red"':"")+">"+c[_].c+"</span>"+r:""),c[_].pn=c[_].pn.parentNode.insertBefore(u,c[_].pn.nextSibling).firstChild}}}function a(t,n){var r=n.split(".")[1],a={ID:{},ID2:{},flag:{},trip:{},name:{}};a[r].use=!0,s(_[r]),_[r]={},pref.IDinfo[r].use&&e(site.myself.posts,a)}function s(e){for(var t in e)for(var n=0;n<e[t].length;n++)e[t][n].pn.parentNode.remove()}var i=site.myself.parse_funcs.id(site.myself),o=!pref.IDinfo.auto||i,l=!pref.IDinfo.auto||site.myself.posts[0].flag,p=site.myself.parse_funcs.id2(site.myself),c=!pref.IDinfo.auto||p,_={ID:{},ID2:{},flag:{},name:{},trip:{},flagIDs:{},nameTrips:{},tripNames:{}},d=new Set;e(site.myself.posts,pref.IDinfo);var u=site2.DEFAULT.wrap_to_parse.prep_pfunc(site.nickname,site.board,"post_html"),f=new MutationObserver(function(t){for(var n=[],r=0;r<t.length;r++)if(t[r].addedNodes)for(var a=0;a<t[r].addedNodes.length;a++){var s={pn:t[r].addedNodes[a],__proto__:u};s.no&&!d.has(s.no)&&(n[n.length]=s)}n.length>0&&e(n,pref.IDinfo)});b={observe:function(){f.observe(site.myself.pn,{childList:!0})},disconnect:function(){f.disconnect()}},b.observe(),pref_func.settings.onchange_funcs["IDinfo.*.*w/"]=a}(),{destroy:function(){return Tooltips.remove_root(h),b&&b.disconnect(),window.removeEventListener("storage",site2[site.nickname].check_reply.remake_own_posts,!1),g&&t(g),v&&t(v),null},setup_submit2:function(){v=l(v,site.components.postform_submit2)},own_posts_tracker:d,updated:r,mark_posts_from_parent:n}}function thread_reader_init(){null===common_obj.thread_reader&&site.features.thread_reader&&pref.features.thread_reader&&"thread"===site.whereami&&pref.thread_reader.use?common_obj.thread_reader=make_thread_reader():!pref.thread_reader.use&&common_obj.thread_reader&&(common_obj.thread_reader=common_obj.thread_reader.destroy())}function make_catalog_obj(e){function t(e,t){null===p?(t&&n(t),p=r()):pref.test_mode[114]?p=p.destroy():p.make_watcher()}function n(e){a=pref.catalog.embed&&"catalog"===site.whereami||pref.catalog.embed_archive&&"archive"===site.whereami,s=pref.catalog.embed_page&&"page"===site.whereami,i=pref.catalog.embed_frame&&"frame"===site.whereami,o=a?"catalog":s?"page":!pref.thread.embed&&"thread"!==e||"thread"!==site.whereami?"float":"thread",l="float"!==o,cataLog.embed_mode=o}function r(){function e(e){cataLog.gClg=gClg=pClg=e,e.threads=Z,cataLog.get_ref_height=pClg.get_ref_height,G.prototype.AllThreads=pClg.threads;for(var t in Z)delete Z[t][1];for(;0!=e.idxs.length;)e.idxs.shift();e.onchange_funcs["*.board_list_sel"](null,!0,!0)}function n(e){cnst.tack_float_nSblgs(e,!0),e.currentTarget.previousSibling.style.display="none"}function r(e){cnst.tack_dock_e2tack(e).previousSibling.style.display=null,cnst.tack_dock_nSblgs(e)}function a(){var e={};if(pref.catalog.auto_save_filter)for(var t=0;t<gClg.Clgs.length;t++){var n=gClg.Clgs[t];if("thread"!==n.mode){var r=n.pref[n.mode].board_list_sel;void 0===e[r]&&(n.onchange_funcs.save(),e[r]=null)}}window.removeEventListener("beforeunload",a,!1)}function s(){$=l?site2[site.nickname].catalog_get_native_area():J,cataLog.parent=$,pClg.ppn=$,pClg.pppn=pClg.ppn.parentNode,pClg.ppn.classList.add(pref.script_prefix+"_"+pClg.view+"View")}function p(e,t){var n=e[0],r=liveTag.mems.getFromName(n);(gClg.AllThreads[n][8][4]||gClg.AllThreads[n][8][0])<e[4]?gClg.UnsyncedTriages[r.key]=e:gClg.UnsyncedTriages[r.key]&&(gClg.UnsyncedTriages[r.key]=null),gClg.triage_exe_broadcast(e[0],e[1],e[2],e[3],e[4],t)}function c(e,t,n,r){return site2[e.domain].update_posts_merge_prep(t,e.pd,n===!1?t.length-1:n===-1?-1:n,!0)}function _(e){""==Z[e][0].style.width?(pref.catalog_expand_with_hr&&"catalog"!==o&&g(e,"shrink"),Z[e][0].style.width=pref.float.format.fc.width+"px",Z[e][0].style.height=pref.float.format.fc.height+"px"):(Z[e][0].style.width="",Z[e][0].style.height="",pref.catalog_expand_with_hr&&"catalog"!==o&&g(e,"add"))}function d(e){e.preventDefault(),e.target.href&&u(e.target.href,gGEH.get_key_recursive(e.target))}function u(e,t,n){n||(n=pClg);var r=n.threads,a=common_func.fullname2dbt(t);if(r[t][16].archiveFile)e=site2[pref.archive.open_local?site.nickname:a[0]].make_url4([site.nickname,site.board,"0","page_html"])[0];else if(null===e&&(e=site2[a[0]].make_url4(common_func.name2dbt(t))[0],"no"!==pref.catalog_open_last50)){var s=document.createElement("div");s.innerHTML=site2[a[0]].short_link(t,r[t][8][2],null,"","");for(var i=s.getElementsByTagName("a"),l=0;l<i.length;l++)if("exist"===pref.catalog_open_last50||!(786432&r[t][19][0])||parseInt(i[l].textContent,10)>(65535&r[t][19][1])){e=i[l].getAttribute("href");break}}var p=site.embed_frame_win?site.embed_frame:"named"===pref.catalog_open_where?t+(r[t][16].archiveFile?"A":""):"_blank"===pref.catalog_open_where?t+"_"+Date.now():pref.catalog_open_where,c=pref.thread.merge_auto_list?n.merge_bases.query_merged_keys(t):[t],_=pref[o].mark_new_posts?c.map(function(e){return n.get_watch_time_of_a_thread(e,r[e][8][1],null,!0)}).reduce(function(e,t){return t>e?t:e}):0,d=["MARK",_];if(site2[site.nickname].historyAPI&&site2[a[0]].historyAPI&&pref.pref2.meguca.historyAPI){if(site2[site.nickname].historyAPI_blocking)return;send_message_emu.push(d)}else{if(send_message(p,d,window.open(e,p)),pref.uip_tracker.on){var u=liveTag.mems.getFromName(t);pref.uip_tracker.sage.annotate&&(pref.uip_tracker.sage.annotate_page&&u.pgh&&send_message(p,["UIP",["page",JSON.stringify(u.pgh)]]),u.sg&&u.sg.size&&send_message(p,["UIP",["sage"].concat(Array.from(u.sg))])),pref.uip_tracker.annotate&&u.sID&&u.sID.h&&send_message(p,["UIP",u.sID.h])}if(r[t][16].archiveFile){var f=r[t][16].archiveFile;send_message(p,["ARCHIVER",["SUB_INIT","IDB"===f?{IDB:!0,domain:a[0],board:pref.test_mode[80]?a[1].slice(0,-5)+"/":a[1],no:a[2]}:{name:f.name,size:f.size,lastModified:f.lastModified,files_sel:pref.archive.files_sel}]])}}if(pref.catalog.auto_watch)if(pref.catalog.auto_watch_override)for(var h=pref.catalog.auto_watch_override_str.split(",");h.length>0;)h[0]&&n.triage_event(t,h[0],h[2]||""),h.splice(0,3);else n.triage_event(t,"WATCH","")}function f(){return l?brwsr.document_body.scrollTop:$.scrollTop}function h(e,t,n,r){for(var a="drawn_idx:"+e+", drawn_y:"+t+", ref_count:"+n+" ",s=0;s<r.length;s++)Z[r[s]]&&!Z[r[s]][1]||(a+=r[s]+", ");return a+="::: "+JSON.stringify(r)}function m(e){var t=$.childNodes.length,n=pref.script_prefix+"_hs";return e<t&&$.childNodes[e].className===n&&e++,e}function g(e,t){if("catalog"!==o){var n=Z[e][0],r=pref.script_prefix+"_hs";if("add"===t&&""===n.style.width&&""===n.style.height&&(n.previousSibling&&n.previousSibling.className!==r&&n.parentNode.insertBefore(site2[site.nickname].horizontal_separator_in_index(),n),n.nextSibling&&n.nextSibling.className!==r&&n.parentNode.insertBefore(site2[site.nickname].horizontal_separator_in_index(),n.nextSibling)),"shrink"===t||"remove"===t&&""===n.style.width&&""===n.style.height||"add"===t&&(""!==n.style.width||""!==n.style.height)){var a=n.previousSibling&&n.previousSibling.className===r?n.previousSibling.previousSibling:null;!a||""===a.style.width&&""===a.style.height||n.parentNode.removeChild(n.previousSibling);var a=n.nextSibling&&n.nextSibling.className===r?n.nextSibling.nextSibling:null;!a||""===a.style.width&&""===a.style.height||n.parentNode.removeChild(n.nextSibling)}"remove"===t&&n.previousSibling&&n.previousSibling.className===r&&n.nextSibling&&n.nextSibling.className===r&&n.parentNode.removeChild(n.nextSibling)}}function v(e,t,n,r){var a=[],s={};"boards"===site.whereami&&0==e&&pref_func.str2obj("catalog_board_list_str");var i=pref.catalog_board_list_obj[e].slice(),o=i[0].domains_for_all_boards;if(o){for(var l=0;l<o.length;l++){var p=o[l];if(!site3[p].boards)return function(e){site2[p].get_boards_json("refresh_boards_json",e,!1,z)}}for(var l=0;l<o.length;l++)if(n&&site2[o[l]].utilize_boards_json&&pref.pref2[o[l]].utilize_boards_json&&pref.pref2[o[l]].utilize_boards_json_domain)s[o[l]]=null;else for(var c in liveTag.mems[o[l]])i[i.length]=liveTag.mems[o[l]][c]}var _=pClg.prep_reserved_tags(!0,e,r);for(var d in _){for(var c=1;c<i.length&&i[c].key!==d;c++);c==i.length&&(i[i.length]=liveTag.mems.getFromName(d))}t&&(a=t.replace(/\s*\/\/.*$/gm,",").replace(/\n/g,",").replace(/,,+/g,",").replace(/^,/,"").replace(/,$/,"").split(",")),""===a[0]&&(a=[]);for(var c=0;i.length>1;){for(var l=1;l<i.length;l++){var u=i[l].key.replace(/\s/g,""),f=cnst.name2domainboardthread(u,!0),h="auto"===pref.catalog_max_page_select&&liveTag.mems[f[0]]&&liveTag.mems[f[0]][f[1]]&&liveTag.mems[f[0]][f[1]].pgs||pref.catalog_max_page;f[2]?0==c?a.push(u):i.splice(l--,1):(!i[l].max_page||c<i[l].max_page)&&c<h?a.push(u+(pref.catalog.catalog_json?"q":"p")+c):i.splice(l--,1)}c++}return{tgts:a,tgt_domains:s}}function b(e,t,n){if(pref.catalog.board.ex_list)for(var r=e.length-1;r>=0;r--){var a=pref_func.merge_obj5(e[r],pref.catalog.board.ex_list_obj2,null);a&&e.splice(r,1)}if("catalog"===pref.catalog.design||"auto"===pref.catalog.design&&"catalog"===n||"chart"===n)for(var r=e.length-1;r>=0;r--){var s=cnst.name2domainboardthread(e[r],!0);"no"===site2[s[0]].trim_list&&"chart"!==n||e[r].search(/\/[pq][0-9]*/)==-1||(e[r].search(/\/[pq]0$/)==-1||t&&s[1]==site.board&&s[0]==site.nickname&&"force_init"!==site2[s[0]].trim_list&&!pref3.stats.use?e[r].search(/\/[pq]\d+$/)!=-1&&e.splice(r,1):e[r]=e[r].replace(/[pq]0$/,pref.catalog.catalog_json||"force_init"===site2[s[0]].trim_list?"j0":"c0"))}if("page"===n&&t){if(pref.liveTag.use){for(var i={},r=0;r<e.length;r++){var s=cnst.name2domainboardthread(e[r],!0);i[s[0]+s[1]+(pref.catalog.catalog_json?"j0":"c0")]=null}for(var r in i)e[e.length]=r}e[0]&&0===e[0].search(site.nickname+site.board+"[pq]0")&&e.splice(0,1),pref[n].load_on_demand&&(pClg.drawn_idx=0)}for(var r=e.length-1;r>=0;r--){var s=common_func.name2dbt(e[r]),o=site2[s[0]]&&site2[s[0]].make_url4(s,"page"!==pref.catalog.design&&(0!==pref.catalog.order.ordering||"none"!==pref.liveTag.from));o?o[2]&&o[2]!==e[r]&&(e.indexOf(o[2])!=-1?e.splice(r,1):e[r]=o[2]):e.splice(r,1)}return e}function y(e,t,n,r){return pClg.refresh(e,t,n,r)}function w(){if((pref.notify.favicon||pref.notify.title.notify)&&notifier.favicon.set(Z),pref.debug_mode[3]){var e=0;for(var t in liveTag.mems)for(var n in liveTag.mems[t])for(var r in liveTag.mems[t][n])e++;var a={};for(var s in liveTag.tags_ci)for(var i of liveTag.tags_ci[s].mems.keys())a[i.key]=null;console.log("refresh_end: tags_ci+tags: "+Object.keys(liveTag.tags_ci).length+"+"+Object.keys(liveTag.tags).length+", threads:"+e+", "+Object.keys(a).length)}pref[o].load_on_demand&&pe()}function k(e,t,n,r){var a=[];if(e){for(var s=site2[site.nickname].parse_funcs.post_html.nativeUpdate2pn,i={},o=0;o<e.length;o++)if(e[o].addedNodes)for(var l=0;l<e[o].addedNodes.length;l++){var p="thread"===site.whereami?site.key:gGEH.get_key_recursive(e[o].addedNodes[l],document),c={pn:s(e[o].addedNodes[l])};i[p]?i[p][i[p].length]=c:i[p]=[c]}for(var p in i)i[p].sort(function(e,t){return e.no-t.no})}var _={init:n,posts_updated:n?null:i},d="thread"===site.whereami?site.no:site.page,u={};u["thread"===site.whereami?"thread":"page"]=d;for(var f=site2[site.nickname].wrap_to_parse.get(document,site.nickname,site.board,site.whereami+"_html",u),o=0;o<f.length;o++)f[o].insert_thread_from_native=x(f[o],liveTag.mems.init(f[o]),_);if(ee.scan_boards_keyword_callback2(site.nickname+","+site.board+","+d+","+site.whereami+"_html",{date:Date.now(),status:200,response:document},["native_prep",{ext_posts:a,force_annotate:r,refresh:pClg,__proto__:cataLog.scan_boards_keyword_callback2_default_args}],f),"thread"===site.whereami&&Object.defineProperty(site,"myself",{value:f[0],writable:!0,enumerable:!0,configurable:!0}),n&&pClg.show_catalog(),pref.test_mode[155]&&(pref.test_mode[136]=!0),pref.debug_mode[38]){var h=Array.prototype.slice.call(document.querySelectorAll(".thread>.postContainer>.post")).map(function(e){return e.id.substr(1)}),m={};h.forEach(function(e){m[e]=(m[e]||0)+1}),Object.keys(m).length!==h.length&&console.log("ERROR: doubles: "+h.filter(function(e){return 1!=m[e]&&m[e]--}))}return f}function x(e,t,n){var r=n.posts_updated&&n.posts_updated[e.key];r&&site2[e.domain].wrap_to_parse.posts({posts:r,__proto__:e});var a="thread"===pClg.mode&&pClg.merge_bases.bases[e.key];if(a){for(var s={},i=0;i<a.lths.length;i++)if(t!==a.lths[i])for(var o=a.tgt_ths[i][16].posts,l=0;l<o.length;l++)s[o[l].key]=null;e.posts=e.posts.filter(function(e){return void 0===s[e.key]})}var p={init:n.init,posts_shown:t.pd?e.posts.slice():e.posts,posts_updated:r},c=pref[pClg.mode].deleted_posts.merge;if(t.pd&&c&&!n.init){var _=0;if(site.myself&&r&&site.myself.posts.length+r.length==e.posts.length)e.posts=site.myself.posts.concat(r);else{var d={};if(pref.test_mode[157])for(var i=0;i<r.length;i++)d[r[i].no]=null;for(var i=1,l=0;i<e.posts.length&&l<t.pd.length;)e.posts[i].no==t.pd[l].no?(pref.test_mode[157]&&t.pd[l].no in d?(_++,i++):e.posts.splice(i,1),l++):e.posts[i].no>t.pd[l].no?l++:i++}e.nof_posts-=t.pd.length-_,e.nof_files-=t.pd.map(function(e){return e.tn_imgs.length}).reduce(function(e,t){return e+t})}return p}function C(e){var t=e.split(",");(pref.catalog_promiscuous||t[0]+t[1]in boards)&&ee.scan_init("snoop",[e],{lifetime:3600,crawler_max:1,tgt_raw:!0})}function T(e,t){IDB.req(e,t,null,null,N,"list_os")}function N(e,t,n){for(var r=0;r<n.length;r++)!pref.test_mode[80]&&Z[e+t+n[r]]||I(e,t,n[r])}function I(e,t,n,r){IDB.req(e,t,n,null,function(e,t,n,a){archiver.event_funcs.restore3(e,t,n,a,r)},"get_all")}function E(e,t,n,r){if((!pref.test_mode[136]||"thread"!==o)&&pref.patch.rm_404_blacklist.indexOf(e)==-1){var a=liveTag.rm_404_list(e,t,r),s=j(e,t,r,a),i=liveTag.mems[e][t];i.LS_synced||(site2[e].clean_up_LS(e,t,s),i.LS_synced=1),pref.test_mode[65]||i.IDB_synced||!pref.archive.IDB.auto_clean_init||IDB.clean_up(e,t,s)}}function A(e,t,n){var r=(r=liveTag.mems[e])&&(r=r[t])&&r[n];r&&j(e,t,{},{no:r},n)}function j(e,t,n,r,a){for(var s=Object.create(n),i=0;i<gClg.Clgs.length;i++)B(e,t,n,s,gClg.Clgs[i],a);for(var o in r)!gClg.Remove_thread_refresh(e+t+o,r[o],null,o in s)||o in s||(s[o]=null);for(var o in r)liveTag.rm_404_1(e,t,o,o in s);if(void 0===a){var l;null!==(l=S(e,t,n,s,a,pref3.proto.merge_list_obj2,pref.proto.merge_list_str,null))&&(pref_func.settings.pnOrDummy("proto.merge_list_str").value=pref.proto.merge_list_str=l),null!==(l=S(e,t,n,s,a,pref3.proto.merge_lv_obj2,pref.proto.merge_lv_str,null))&&(pref_func.settings.pnOrDummy("proto.merge_lv_str").value=pref.proto.merge_lv_str=l)}for(var p=Object.keys(s),c=0;c<p.length;c++){var _=s[p[c]];if(_)for(var i=0;i<gClg.Clgs.length;i++)gClg.Clgs[i].threads[_]&&gClg.Clgs[i].view_attr_set(_,!0)}return s}function B(e,t,n,r,a,s,i){i||(i=pref);var o,l="no"===i.common.watch_list_rm404||"no"===i.liveTag.rm_404?"no":"unread"===i.common.watch_list_rm404||"unread"===i.liveTag.rm_404?"unread":i.liveTag.rm_404,p=a.pref.filter;null!==(o=S(e,t,n,r,s,p.watch_list_obj2,p.watch_list_str,l))&&(a.components.watch_list.value=p.watch_list_str=o,a===pClg&&i.common.consolidated_watch_list&&i.common.sync_watch_list&&gClg.Sync_watch_save([null,"PRUNED",o])),null!==(o=S(e,t,n,r,s,p.attr_list_obj2,p.attr_list_str,i.liveTag.rm_404))&&(a.components.attr_list.value=p.attr_list_str=o),null!==(o=S(e,t,n,r,s,p.list_obj2,p.list_str,i.liveTag.rm_404))&&(a.components.ex_list.value=p.list_str=o)}function S(e,t,n,r,a,s,i,o){var l=o?L:O,p=e+t,c=null,_=s[":REV"]&&s[":REV"][p];if(_)if(void 0===a)for(var d in _)d in n||(c=l(e,t,p+d,r,d,s,_,c,i,o));else void 0===n[a]&&a in _&&(c=l(e,t,p+a,r,a,s,_,c,i,o));return c&&pref_func.fmt4str2(c)}function L(e,t,n,r,a,s,i,o,l,p){var c=a in r,_=c||"imm"!==p?(_=liveTag.mems[e])&&(_=_[t])&&_[a]:null,d=c||"no"===p||"imm"!==p&&_&&_.watched&&("watched"===p||_.nr);if(d){r[a]=null;var u=_&&_.nrtm+"/"+_.nr||"?/?";if(s[n].cmd){if(void 0!==s[n].cmd.PRUNED)return o;s[n].cmd.PRUNED=u}else s[n].cmd={PRUNED:u};r[a]=n}else delete s[n],delete i[a];pref.debug_mode[2]&&console.log("rm_items_404_delete: "+n);var f=new RegExp("(^|,)"+n.replace(/\+/,"\\+")+"([\\^@;][^,\n]*)*(,|\n|$)","mg");return(o||l).replace(f,d?"$1"+n+"$2;PRUNED:"+u+"$3":",")}function O(e,t,n,r,a,s,i,o,l,p){return pref.debug_mode[2]&&console.log("rm_items_404_delete_merge: "+n),s._rm(n,i,a,o||l)}function D(e){var t=V.getElementsByTagName("textarea")["filter.bookmark_list_str"];t.value=R(e,t.value),pref_func.apply_prep(t,!0)}function R(e,t){var n=pref.catalog.bookmark_list_rm404?"":"//$&",r=e.split(",");return t.replace(new RegExp(r[0]+r[1]+r[2]+"(!page)*(,|\n|$)","g"),n)}function U(){var e=new G(!1,"float",!0);if(pref.float.clone){var t=G.prototype.Clgs.filter(function(t){return e.pref.float.board_list_sel===t.pref[t.mode].board_list_sel})[0];t!==e&&e.clone_threads(t)}e.GEH=new fe(e),site2[site.nickname].catalog_native_prep_watcher&&(site2[site.nickname].catalog_native_prep(e.components.pn12_0_4,e.components.pn12_0,e.health_indicator.pn2,e),e.native.viewChanged&&e.native.viewChanged()),e.show_catalog()}var M=function(){function e(e,t){return e.IDX?e.IDX+"/"+e.tgts.length:e.found_threads+"/"+e.scanned+", "+e.found_boards+(t?"/"+e.idx:"")+"/"+e.max}function t(e){pref.tooltips.info.show&&(f=this,Tooltips.req_show("info",e,n,!0))}function n(t){var n=t&&t.target||this,r=n.name||n.getAttribute("name"),s=_[r];if(s&&(s.prog&&(s.prog_str=e(s.prog,!0)+", "+s.tgt),!t&&pref.healthIndicator.expand_running&&s.start&&!s.end&&n.set(null," :"+s.prog_str),f&&f.getAttribute("name")===r)){var i=!s.end&&!pref.healthIndicator.cancel,o="Initiator: "+s.initiator+"&emsp;"+(i?'<button type="button" name="'+r+'">Cancel</button>':"")+"<br>"+(s.start?"Start: "+new Date(s.start).toLocaleTimeString()+"<br>":"")+(s.prog_str?"Progress: "+s.prog_str+"<br>":"")+"Priority: "+s.priority+"<br>"+(s.start&&!s.end&&s.prog?"Crawler: "+s.prog.crawler+"<br>":"")+(s.err_str?'<span style="color:red">Errors: '+s.err_str+"</span><br>":"")+(s.abort_str?'<span style="color:red">Abort: '+s.abort_str+"</span><br>":"")+(s.end?"End: "+new Date(s.end).toLocaleTimeString()+"<br>":""),l=i?{html:o,callback:a}:o;if(t)return l;Tooltips.show_2(null,l)}}function r(e){f=null,pref.tooltips.info.show&&Tooltips.hide2()}function a(e){e.getElementsByTagName("button")[0].onclick=i}function s(){pref.healthIndicator.cancel&&i.call(this)}function i(){var e=this.getAttribute("name"),t=_[e];t&&!t.end&&t.prog&&(t.prog.ABORT=!0)}function o(){for(var e=pref.healthIndicator.show?"":"none",t=0;t<p.length;t++)p[t].pn.childNodes[1].style.display=e}function l(){if(!pref.healthIndicator.expand_running)for(var e=0;e<p.length;e++)for(var t=0;t<p[e].elems.length;t++)p[e].elems[t].pn.textContent.length>1&&p[e].elems[t].set(null,"r")}var p=[],c=0,_={},d=function(e){this.pn=document.createElement("span"),this.pn_countdown=this.pn.appendChild(cnst.dom('<span style="color:limegreen"></span>')),this.pn_hi=this.pn.appendChild(document.createElement("span")),e&&(this.pn2=this.pn.cloneNode(!0),this.pn2_countdown=this.pn2.childNodes[0],this.pn2_hi=this.pn2.childNodes[1]),pref.healthIndicator.show||(this.pn_hi.style.display="none"),p.push(this),this.elems=[]};d.prototype={shift:function(e,t,n,r){for(var a=this.elems.length-pref.healthIndicator.max;a>=0;a--)this.elems[a].remove_from_parent()&&this.elems.splice(a,1);var s=new u(e,t,n,r);return this.pn_hi.insertBefore(s.pn,this.pn_hi.firstChild),this.elems.push(s),s},destroy:function(){this.pn.parentNode.removeChild(this.pn),p.splice(p.indexOf(this),1)},countdown:function(e){this.pn_countdown.textContent=e,this.pn2&&(this.pn2_countdown.textContent=e)}};var u=function(e,a,i,o){this.pn=document.createElement("span"),this.name="healthIndicator."+c++,this.pn.setAttribute("name",this.name),this.set(e,a),this.pn.onmouseover=t,this.pn.onmouseout=r,this.pn.onclick=s,_[this.name]={initiator:i,priority:o},this.show_tooltip_delayed=new DelayBuffer(n.bind(this),100).get_bound_func()},f=null;return u.prototype={set:function(e,t){t&&(this.pn.textContent=t),e&&this.pn.setAttribute("style","color:"+e)},remove_from_parent:function(){return!(pref.healthIndicator.dont_retire_running&&!_[this.name].end)&&(delete _[this.name],this.pn.parentNode.removeChild(this.pn),this.pn===f&&r(),!0)},remove:function(){if(this.remove_from_parent())for(var e=0;e<p.length;e++){var t=p[e].elems.indexOf(this);if(t!=-1)return void p[e].elems.splice(t,1)}},report:function(t){var n=_[this.name];if(n){if(t)for(var r in t){"err_str"===r?(n.err_str||this.set("orange"),n[r]=(n[r]?n[r]+", ":"")+t[r]):n[r]=t[r];var a=n.prog;if("end"===r){a&&(n.prog_str=e(n.prog),n.prog=null);var s=n.err_str&&"IDB"!==n.initiator?a&&a.SUC?"▲":"X":"●";this.set("X"===s?"red":null,s)}}(f||pref.healthIndicator.expand_running)&&this.show_tooltip_delayed()}}},{HealthIndicator:d,show:o,shrink_running:l}}();cataLog.healthIndicator=M;var z=new M.HealthIndicator(!0);httpd.set_health_indicator(z);var H={mode:o,mode_fmt:"float"==o?"float":"catalog",threads:Z,timestamp:"thread"===o?16:0,clean_idx:0,timestamp_set:function(){this.realtime&&(this.timestamp+=32,this.clean_idx=0)},update_all_force:function(e,t,n,r){if(t.indexOf("liveTag.style")==-1){if("proto.footer.merged_tag"===t){if(!pref[this.mode_fmt].footer.tag)return;r=!0}else if("float"===this.mode_fmt^t.indexOf("float")!=-1)return;var a=t.split(".")[2],s=this.pn_menu,i=this.pn_triage;if(n||this.compile(),("use"===a||"triage"===a||"menu"===a)&&(this.add_remove_menu(a,s,i),"triage"===a||"menu"===a))return;if("triage_str"===a||"menu_str"===a)return void this.replace_menu(a)}else r=!0;for(var o in this.threads)this.update_force(o,n,r,!0)},update_force:function(e,t,n,r){var a=this.threads[e],s=a[24];s&&a[1]&&this.insert_footer3(s,e,t,n,r)},update:function(e,t,n){var r=this.threads[e][24];r&&(r[4]|=(t?1:0)|(n?4:0)|8)},try_dirtifying_tag:function(e){var t=this.threads[e][24];if(15&t[4])return t[4]|=4,!0},test_dirty:function(e){var t=this.threads[e][24];return t&&15&t[4]&&t},draw:function(e,t){var n=e[24];n[4]!==this.timestamp&&this.insert_footer3(n,t)},draw_merge:function(e,t,n){var r=e[24];n||this.insert_footer3(r,t,null,!0),r[6]=n,n&&this.insert_footer3(r,t,null,!0)},factory:function(e,t,n){var r={threads:t,timestamp:0,mode:e,mode_fmt:"float"==e?"float":"catalog",clean_idx:0,clg:n,realtime:0,pn_menu:null,pn_triage:null,__proto__:this};return r.compile(),r},pn:document.createElement("div"),prep_flag_dom:function(e){if(e.flag&&e.flag instanceof Element)return document.importNode(e.flag);if(site2[site.nickname].post_flag2html)return this.pn.innerHTML=site2[site.nickname].post_flag2html(e),this.pn.childNodes[0]},ts_refresh:null,refresh_start:null,formatted_arr:null,get_str:null,prep_footer3:function(e,t){var n=e.footer;n.classList.add(pref.script_prefix+"_footer");var r="catalog_html"===e.type_parse&&e.parse_funcs_html.footer_prep(e,n)||null;return this.add_menu(n),[n,r,null,null,6|(e.country?1:0),e.footer2?[e.footer2,null,null,null]:null]},add_remove_menu:function(e,t,n){var r=!t&&this.pn_menu?this.add_menu_1.bind(this):t&&!this.pn_menu?this.remove_menu_1.bind(this):null,a=!n&&this.pn_triage?this.add_triage_1.bind(this):n&&!this.pn_triage?this.remove_triage_1.bind(this):null;this.add_remove_menu_iterate(r,a)},add_remove_menu_iterate:function(e,t){for(var n in this.threads){var r=this.threads[n][24];r&&this.add_remove_menu_1(r,e,t)}var a=this.clg.pref[this.clg.mode];if(a.merge||a.merge_list){var s=this.clg.merge_bases,i=s.bases_unique().values();for(var n of i){var r=s.bases[n].footer;r&&this.add_remove_menu_1(r,e,t)}}},add_remove_menu_1:function(e,t,n){t&&t(e[0]),n&&n(e[0])},add_menu:function(e){return this.pn_menu&&this.add_menu_1(e),this.pn_triage&&this.add_triage_1(e),e},replace_menu:function(e){var t="menu_str"===e&&this.pn_menu?function(e){this.remove_menu_1(e),this.add_menu_1(e)}.bind(this):null,n="triage_str"===e&&this.pn_triage?function(e){this.remove_triage_1(e),this.add_triage_1(e)}.bind(this):null;this.add_remove_menu_iterate(t,n)},pn_menu:null,add_menu_1:function(e){e.appendChild(this.pn_menu.cloneNode(!0))},remove_menu_1:function(e){e.removeChild(e.lastChild)},pn_triage:null,add_triage_1:function(e){e.insertBefore(this.pn_triage.cloneNode(!0),e.firstChild)},remove_triage_1:function(e){e.removeChild(e.firstChild)},color_tag_node:function(e,t){var n=this.threads[e]&&this.threads[e][24];if(n&&!this.try_dirtifying_tag(e)){var r=this.query_tag_node(n,t);if(r&&(this.liveTag.color_tag_node(r,t),n[6]&&n[6].footer)){var a=this.query_tag_node(n[6].footer,t);a&&this.liveTag.color_tag_node(a,t)}}},query_tag_node:function(e,t){for(var n=e[3]&&e[3].firstChild;n;){if(n.textContent===t)return n;n=n.nextElementSibling}},remove_nullify:function(e,t){e[0].removeChild(e[t]),e[t]=null},insert_footer3:function(e,t,n,r,a){var s=this.threads[t],i=liveTag.mems.getFromName(t);n=n||1&e[4],r=r||4&e[4],this.draw_exe_1(e,t,n,r,s,i),e[5]&&this.draw_exe_1(e[5],t,n,r,s,i),e[6]&&e[6].footer&&(a&&e[6].lths[0]!==i||this.draw_exe_1(e[6].footer,t,null,r,e[6],e[6])),e[4]=this.timestamp},draw_exe_1:function(e,t,n,r,a,s){var i=pref[this.mode_fmt].footer,o=i.use&&this.get_str(a,s);if(o)if(e[1])(8&e[4]||1!=this.realtime||e[1].innerHTML!==o)&&(e[1].innerHTML=o);else{var l=document.createElement("span");l.innerHTML=o,e[1]=e[0].insertBefore(l,i.triage?e[0].childNodes[1]:e[0].firstChild)}else e[1]&&this.remove_nullify(e,1);if(i.tag&&i.use){if(r||!e[3]){var p=this.liveTag.create_tag_nodes(s.tags,", ",this.tag_node_onclick);e[3]=e[3]?(e[0].replaceChild(p,e[3]),p):e[0].insertBefore(p,e[2]||i.menu?e[0].lastChild:null)}}else e[3]&&this.remove_nullify(e,3);if(i.flag&&pref[this.mode].t2h_num_of_posts>=0&&i.use){if(!n&&e[2]||(n=a[16].recent_posts()),e[2]||(e[2]=e[0].insertBefore(document.createElement("span"),i.menu?e[0].lastChild:null)),n&&n.length>0){for(var c=e[2].childNodes.length-1;c>=0;c--)e[2].removeChild(e[2].firstChild);for(var c=0;c<n.length;c++)if(n[c]){var _=H.prep_flag_dom(n[c]);_&&(n[c].deleted_after&&_.classList.add("CatChan_deleted"),e[2].appendChild(_))}}}else e[2]&&this.remove_nullify(e,2);if(pref.debug_mode[32]&&e[2]){for(var d=a[16].recent_posts(),p=document.createElement("span"),c=0;c<d.length;c++)if(d[c]){var _=H.prep_flag_dom(d[c]);_&&(d[c].deleted_after&&_.classList.add("CatChan_deleted"),p.appendChild(_))}var u=[e[2],p].map(function(e){return Array.prototype.map.call(e.getElementsByClassName("flag"),function(e){return e.getAttribute("class").match(/flag\-(..)/)[1]}).toString()});u[0]!=u[1]&&console.log("Error: Flags: "+s.key+": \n"+u[0]+"\n"+u[1])}},format_relative_time:function(e){var t=e<0?"-":"+",n=Math.floor(Math.abs(e)/1e3),r=n%60,a=n>=60?Math.floor(n%3600/60):0,s=n>=3600?Math.floor(n%86400/3600):0,i=n>=86400?Math.floor(n/86400)+"d":"";return t+i+(i&&s<10?"0":"")+(n>=3600?s+":":"")+(n>=3600&&a<10?"0":"")+(n>=60?a+":":"")+(n>=60&&r<10?"0":"")+r}};H.get_str=function(e){function t(e){return H.format_relative_time(e-i)}function n(e){return i-e>=864e5?new Date(e).toLocaleString():new Date(e).toLocaleTimeString()}function r(e,t){return function(){var n=e();return n>0?'<span style="'+t+'">'+n+"</span>":n}}function a(){i=Date.now()}var s,i=Date.now(),o=null,l=null,p=null,c={pg:function(e){return e.page?function(){return o[14]||"?"}:null},nm:function(e){return e.nrtm?(s=e.nrtm0?function(){return l.watched&&l.nrtm||""}:function(){return l.watched?l.nrtm:""},e.nrtm1?r(s,pref_func.sanitize(e.nrtm1_style)):s):null},nr:function(e){return e.nr?(s=e.nr0?function(){return l.watched_p&&l.nr||""}:function(){return l.watched_p?l.nr:""},e.nr1?r(s,pref_func.sanitize(e.nr1_style)):s):null},rp:function(e){return e.rp?e.rOP?e.rp0?function(){return p[2]>1?p[2]:""}:function(){return p[2]}:e.rp0?function(){return p[2]-1||""}:function(){return p[2]-1}:null},im:function(e){return e.im?e.iOP?function(){return p[3]}:function(){return p[3]>1?p[3]-1:""}:null},RP:function(e){return e.rp?e.rOP?function(){return"<b>"+p[2]+"</b>"}:function(){return"<b>"+(p[2]-1)+"</b>"}:null},IM:function(e){return e.im?e.iOP?function(){return"<b>"+p[3]+"</b>"}:function(){return p[3]>1?"<b>"+(p[3]-1)+"</b>":""}:null},lp:function(e){return e.nl?function(){return l.ta&&l.ta.posts?l.ta.posts.length:""}:null},dp:function(e){return e.nd?function(){return l.pd?l.pd.length:""}:null},ar:function(e){return e.archived?function(){var e=l.archived;return e>=8?"a":e?"A":""}:null},nf:function(e){return e.nf?function(){return l.sID&&l.sID.nc||""}:null},ni:function(e){return e.nid?function(){return l.sID&&(l.sID.nid||l.sID.np)||""}:null},ct:function(e){return e.ctime?function(){return n(p[1])}:null},cT:function(e){return e.rctime?function(){return t(p[1])}:null},bt:function(e){return e.btime?function(){return p[0]?n(p[0]):""}:null},bT:function(e){return e.rbtime?function(){return p[0]?t(p[0]):""}:null},pt:function(e){return e.ptime?function(){return p[4]?n(p[4]):""}:null},pT:function(e){return e.rptime?function(){return p[4]?t(p[4]):""}:null},pr:function(e){return e.prate?function(){return Math.floor(p[2]/((i-p[1])/864e5))}:null},dn:function(e){return e.domain?function(){return l.domain}:null},bd:function(e){return e.board?function(){return l.board}:null},no:function(e){return e.no?function(){return l.no}:null},sp:function(e){return e.ns?function(){return l.sg?l.sg.size:""}:null}},_={IB:function(e){return function(){return l.th&&l.th.bumplimit?"<i>":""}},Ib:function(e){return function(){return l.th&&l.th.bumplimit?"</i>":""}},II:function(e){return function(){return l.th&&l.th.imagelimit?"<i>":""}},Ii:function(e){return function(){return l.th&&l.th.imagelimit?"</i>":""}},"<iB":function(e){return function(){return l.th&&l.th.bumplimit?"<i":""}},"</iB":function(e){return function(){return l.th&&l.th.bumplimit?"</i":""}},"<iI":function(e){return function(){return l.th&&l.th.imagelimit?"<i":""}},"</iI":function(e){return function(){return l.th&&l.th.imagelimit?"</i":""}},__proto__:c},d={native:pref0.footer.native,condensed:"(ar )(nm/)(nr/)(lp/)(rp)(*sp)(+dp)(/im)(/pg) (ni/nf )(ct )(cT )(bt )(bT )(pt )(pT )(pr )(dn)(bd)(no) ",meguca:"(ar )(dn)(bd)(no) (nm/)(nr/)(lp/)(rp)(*sp)(+dp)(/im)(/pg) (ni/nf )(ct )(cT )(bt )(bT )(pt )(pT )(pr ) "};return e.compile=function(){function e(e,t,n){var r=t();return""!==r?e+r+n:""}function t(e){for(var t="",n=1;n<e.length-1;n+=2){var r=e[n]();""!==r&&(t+=r+e[n+1])}return""!==t?e[0]+t:""}function n(e){return function(){return e}}function r(e,n,r,a){var s,i=a.length>2?t(a):a[0];return i?(s=e())?s+n+i+r:i:""}function a(n,a){a=(a.search(/[BI]$/)!==-1?a.slice(0,-1):a)+">";var s
;return"string"!=typeof n[0]?(s=n[1].indexOf(">"),r.bind(null,n[0],n[1].slice(0,s+1),a,[n[1].slice(s+1)].concat(n.slice(2)))):n.length>=5?(n[n.length-1]=n[n.length-1]+a,t.bind(null,[n[0]+n[1]].concat(n.slice(2)))):e.bind(null,n[0]+n[1],n[2],n[3]+a)}function s(t,r,i,o,l){for(;i<o;){if(_[r[i]]){var p=_[r[i]](t);if(p){if(1==l.length&&"string"==typeof l[l.length-1]){var c=l[l.length-1].lastIndexOf(">")+1,d=c>0?l[l.length-1].slice(c):"";d&&(l[l.length-1]=l[l.length-1].slice(0,c),p=e.bind(null,d,p,""))}l.push(p,r[i+1]);var u="<"===r[i][0]&&"</"+r[i].slice(1);if(u){var f=r.indexOf(u,i+1);if(f>=0){var h=f-4>=i?l.splice(-2).concat(s(t,r,i+2,f,[])):l.splice(-2);(h.length>=4||!(2===h.length&&f-4>=i))&&l.push(a(h,u),""),i=f}}}}else"string"!=typeof l[l.length-1]||1!=l.length&&"<"===r[i][0]?l.push(n(r[i]+r[i+1]),""):l[l.length-1]+=r[i]+r[i+1];i+=2}return l}for(var i=pref[this.mode_fmt].footer,o=pref.test_mode[138]?pref_func.sanitize(d[i.design]||i[i.design]||""):d[i.design]||i[i.design]||"",l=o.split(/(\([^)]*?\))/).filter(function(e){return e}).map(function(e){return"("===e[0]?e.slice(1,-1):e}),p={},u=0,f={enumerable:!0,configurable:!0},h=0;h<l.length;h++){var m=l[h].split(/(ar|n[mrfio]|pg|rp|im|[lds]p|[cbp][tT]|pr|dn|bd|RP|IM|I[BbIi]|<\/?span|<\/?[bius][BI]*)/);if(m.length>=3){if(!pref.test_mode[138]&&l[h].indexOf("<")!==-1){for(var g=1;g<m.length;g+=2)if("<"===m[g][0]&&m[g].indexOf(">")===-1)for(;m[g+1].indexOf(">")===-1;)m[g+1]+=m.splice(g+2,2).join("");for(var g=m.length-2;g>=-1;g-=2){if(g>=1&&"<"===m[g][0]){if(0===(m[g]+m[g+1]).search(/^<\/?(span|[bius][BI]*)(?: +style="[^&"<>\']*")?>/))continue;m[g]=pref_func.sanitize(m[g])}m[g+1]=pref_func.sanitize(m[g+1])}}var v=m.filter(function(e,t){return t%2==1&&c[e]}).length,b=m.filter(function(e,t){return t%2==1&&c[e]&&c[e](i)}).length;if(v>0&&0==b)continue;m=s(i,m,1,m.length,[m[0]]),m[1]&&Object.defineProperty(p,u++,{get:m.length>=5?t.bind(null,m):m[0]||m[2]?e.bind(null,m[0],m[1],m[2]):m[1],__proto__:f})}else l[h]&&Object.defineProperty(p,u++,{value:l[h],__proto__:f})}return p.length=u,this.formatted_arr=p,this.realtime=i.prate||i.rptime||i.rbtime||i.rctime?2:i.ptime||i.btime||i.ctime?1:0,this.timestamp=(this.realtime?32:0)+("thread"===this.mode||pref.test_mode[131]?16:0),this.pn_menu=i.use&&i.menu?new Triage(i.menu_str,{embed:!0,child_class:"embeddedTriage"}).pn:null,this.pn_triage=i.use&&i.triage?new Triage(i.triage_str,{embed:!0,child_class:"embeddedTriage"}).pn:null,p},e.refresh_start=a,Object.defineProperty(e,"ts_refresh",{get:function(){return i},enumerable:!0,configurable:!0}),function(e,t){return o=e,l=t,p=o[8],Array.prototype.join.call(this.formatted_arr,"")}}(H),H.compile(),cataLog.Footer=H;var F=function(e,t){this.timer=null,this.time_remains=0,this.clg=e,this.indicator=t,this.timer_tgt=this.timer_tgt.bind(this),this.countdown=this.countdown.bind(this)};F.prototype={timer_tgt:function(e){this.timer=null,this.clg.refresh(!0,null,!e),this.restart()},stop_if_running:function(){this.timer&&(clearTimeout(this.timer),this.timer=null),pref.catalog_auto_update_countdown&&this.indicator.countdown("")},countdown:function(){var e=this.time_remains>=660?60:1;this.indicator.countdown(e>1?Math.floor(this.time_remains/60)+"m":this.time_remains),this.time_remains-=e,this.time_remains<0?this.timer_tgt():this.timer=setTimeout(this.countdown,1e3*e)},set:function(){this.stop_if_running(),this.restart()},restart:function(){var e=this.clg.pref[this.clg.mode];if(e.auto_update){var t=e.auto_update_period>=1?e.auto_update_period:e.auto_update_period===-2?1/6:e.auto_update_period===-1?.25:.5;pref.catalog_auto_update_countdown?(this.time_remains=60*t,this.countdown()):this.timer=setTimeout(this.timer_tgt,6e4*t)}},manual_refresh:function(){this.timer&&clearTimeout(this.timer),this.timer_tgt(!0)}};var P={"filter.kwd.str":function(e){var t=this["."],n=t.pref.filter.kwd;n.use==!n.str&&(n.use=!n.use,t.components.kwd_use.checked=n.use);var r=t.components.kwd_mirror.indexOf(e.target);r!=-1&&(t.components.kwd_mirror[r?0:1].value=n.str),t.filter_kwd_prep(e)},"filter.list_str":function(){var e=this["."];e.filter_changed(),e.pref[e.mode].mark_new_posts&&e.view_time_filter_changed()},"filter.attr_list_str":function(){this["."].pref.filter.attr_list&&this["."].view_attr_changed()},"filter.tag_search.str":liveTag.popup_filter.oninput_funcs["filter.tag_search.str"],__proto__:pref_func.settings.oninput_funcs.__proto__},q={refresh:function(){this["."].auto_update.manual_refresh(!0)},"*.board_list_sel":function(e,t,n){var r=this["."];if(t||(e.target.blur(),pref.catalog.auto_save_filter&&this.save(e,r.INST.board_list_sel_old),pref.catalog.refresh.at_switch&&r.clear_threads(0),r.prep_reserved_tags(!1,r.INST.board_list_sel_old)),(pref.catalog.auto_load_filter||t)&&this.load(e,t),(!t||n)&&(r.refresh(pref.catalog.refresh.at_switch,null,!1,!0),pref.archive.IDB.auto_restore)){r.format_refresh_tgts();for(var a in this.refresh_tgts)gClg.IDB_req[a]=null}r.INST.board_list_sel_old=r.pref[r.mode].board_list_sel},"catalog.order.*":"float.order.*","float.order.*":function(){this["."].idx_re_sort()},"*.hide_unwatched":"float.order.*","*.auto_update":function(){this["."].auto_update.set()},"*.auto_update_period":"*.auto_update","Drop now":function(){this["."].show_catalog(-1)},clear_threads:function(){this["."].clear_threads(0),this["."].show_catalog()},clear_filters:function(e){this.load(e,null,!0)},load:function(e,t,n){if(localStorage||n){var r=this["."],a=r.pref.filter,s=pref_default().filter;if(delete s.tag,pref.common.consolidated_watch_list&&delete s.watch_list_str,pref_func.pref_overwrite(a,s),n&&(a.tag=!1,!r.liveTag.NC))for(var i=0;i<gClg.Clgs.length;i++)gClg.Clgs[i].liveTag.NC||(gClg.Clgs[i].components.tag_use.checked=!1)}if(localStorage&&!n)try{var o=JSON.parse(localStorage.getItem(this.load_save_key(r.pref[r.mode].board_list_sel))||localStorage.getItem(this.load_save_key(r.pref[r.mode].board_list_sel).replace(/\./,".catalog.")))||{};delete o.tag,pref.common.consolidated_watch_list&&(t&&(a.watch_list_str=localStorage.getItem(pref.script_prefix+".WatchList")||""),o.watch_list_str&&(a.watch_list_str=o.watch_list_str+"\n"+a.watch_list_str),delete o.watch_list_str),pref_func.pref_overwrite(a,o,!0)}catch(e){console.log(e)}t&&pref[r.mode].disable_kwd_filter_at_initial&&(r.pref.filter.kwd.use=!1),pref.filter.time_quick_sel=0,pref_func.apply_prep(r.components.pn_filter,!1,null,null,!0,r.pref,t),r.filter_kwd_prep_init(null,t),r.liveTag.filter_onchange(a.tag_search,!0,!0),t||r.view_attr_changed()},save:function(e,t){if(localStorage){var n=this["."];"number"!=typeof t&&(t=n.pref[n.mode].board_list_sel);var r=n.pref.filter,a=JSON.stringify(pref_func.obj_elim_the_same(pref_default(!0).filter,r),function(e,t){return"time_str"===e&&!r.time&&!r.time_watch&&!r.time_watch_creation&&!r.time_creation||"watch_list_str"===e&&pref.common.consolidated_watch_list?void 0:t}),s=this.load_save_key(t);s&&("{}"===a?delete localStorage[s]:localStorage.setItem(s,a),0===s.indexOf("CatChan.filter.")&&delete localStorage[s.replace(/\./,".catalog.")]),pref.common.consolidated_watch_list&&this.save_watch_list()}},save_watch_list:function(){if(localStorage){var e=this["."],t=e.pref.filter,n=pref.script_prefix+".WatchList";""===t.watch_list_str?delete localStorage[n]:localStorage.setItem(n,t.watch_list_str)}},load_save_key:function(e){var t=pref.catalog_board_list_obj[e];return t?pref.script_prefix+(pref.common.consolidated_filter?".Filter":".filter."+t[0].key):null},"filter.kwd.*":function(e){this["."].filter_kwd_active(e)},"filter.kwd.re":function(){this["."].filter_kwd_prep()},"filter.kwd.match":"filter.kwd.re","filter.kwd.ci":"filter.kwd.re","filter.kwd.sentence":"filter.kwd.re","filter.kwd.ew":"filter.kwd.re","filter.tag":function(){var e=this["."];if(!e.liveTag.NC)for(var t=gClg.Clgs,n=e.components.tag_use.checked,r=0;r<t.length;r++)e===t[r]||t[r].liveTag.NC||(t[r].components.tag_use.checked=n);e.liveTag.filter_changed_broadcast()},"filter.time":P["filter.list_str"],"filter.time_creation":"filter.time","filter.time_str":"filter.time","filter.list":"filter.time","filter.watch_list_str":function(e,t){pref.common.consolidated_watch_list&&!t?(gClg.Sync_watch_load({newValue:this["."].pref.filter.watch_list_str},!0),this.save_watch_list()):this["filter.list_str"]()},"filter.attr_list":function(){this["."].view_attr_changed()},scanBoardIf:function(e){this.scanBoard(e,!1,!0)},scanSiteIf:function(e){this.scanSite(e,!1,!0)},scanBoard:function(e,t,n){!t&&pref.common.clear_at_manual_scan&&this.clear_threads(),scan.keyword_load_1(site.nickname,!n||2,[site.board],z)},scanSite:function(e,t,n){!t&&pref.common.clear_at_manual_scan&&this.clear_threads(),scan.keyword_load(!n||2,z)},"filter.time_quick_sel":function(e){var t=this["."].components.time_str;t.value=new Date(Date.now()-36e5*e.target.value).toLocaleString(),pref_func.apply_prep(t,this["."].pref,!0),e.target.selectedIndex=0},"filter.tag_search.re":"filter.tag_search.str","filter.tag_search.show_nof_boards":liveTag.popup_filter.onchange_funcs["filter.tag_search.show_nof_boards"],"tagB.*":liveTag.cbx_all_onchange,tag2bList:liveTag.add_tags_to_boardlist,add_to_auto:function(e){var t=this["."];if(""!==t.pref.filter.kwd.str){var n=t.pref.filter.auto_list,r=[n.kill?"KILL":null,n.watch?"WATCH":null,n.show?"SHOW":null,n.sticky?"STICKY":null,n.style?"ATTR:"+n.style_str:null].filter(function(e){return e}).join(),a=pref_func.str2obj7.o2s({cmds:r,__proto__:t.pref.filter.kwd});t.pref.filter.auto_list.str+=a+"\n",pref_func.apply_prep(t.components.auto_list,!1,null,null,!0,t.pref)}},"filter.*.style":function(e){this["filter.*.style_str"]({target:e.target.parentNode.nextSibling})},"filter.*.style_str":function(e){var t=e.target.value;"."!==t[0]&&e.target.nextSibling.setAttribute("style",t||"")},"filter.postFilter.add":function(e){var t=this["."],n=t.pref.filter.postFilter;if(""!==t.pref.filter.kwd.str&&(n.hide||n.style)){var r=n.boards_str.replace(/\s/g,"").split(","),a=pref_func.str2obj7.o2s({hide:n.hide,boards:n.boards&&r.length>0?r:null,style:n.style&&n.style_str,__proto__:t.pref.filter.kwd},!0);t.pref.filter.postFilter.str+=a+"\n",pref_func.apply_prep(t.components.postFilter,!1,null,null,!0),n.use&&this["filter.postFilter.REDRAW"](null,pref_func.str2obj7.s2o({},a,"filter.postFilter.str"))}},"filter.postFilter.str w/":function(e,t){var n=this["."];(pref.postFilter.use^"postFilter.use"===t||n.pref.filter.postFilter.use^"filter.postFilter.use"===t)&&this["filter.postFilter.REDRAW"](n.pref.filter.postFilter.obj7_old||n.pref.filter.postFilter.obj7||{},null,pref.postFilter.obj7_old||pref.postFilter.obj7),n.pref.filter.postFilter.obj7_old=null,(pref.postFilter.use||n.pref.filter.postFilter.use)&&this["filter.postFilter.REDRAW"]()},"filter.postFilter.use w/":"filter.postFilter.str w/","filter.postFilter.REDRAW":function(e,t,n){var r=this["."];for(var a in r.threads)ae.postFilter(r,r.threads[a][16],r.threads[a][16].posts,e,t,n)},"filter.disLWKA":function(){this["."].pref.filter.kwd.active&&this["."].filter_changed()},"filter.disTWKA":"filter.disLWKA","INST.view":function(e){var t=this["."];t.func_hide_all(t.threads);for(var n in t.threads)t.remake_html_prep(t.threads[n]);t.ppn.classList.remove(pref.script_prefix+"_"+t.view+"View"),t.view=t.pref.INST.view,t.ppn.classList.add(pref.script_prefix+"_"+t.view+"View"),t.native.viewChanged&&t.native.viewChanged(),t.show_catalog(0)},"liveTag.NC":function(){var e=this["."],t=e.liveTag;t!==liveTag&&(t.subscribed&&t.unsubscribe(!0),e.Setup_liveTag(e.pref.liveTag.NC,!0),e.footer.update_all_force(null,"float",null,!0),e.filter_changed())},clear_pruneds:function(e){this["."].rm_items_404_clearPRUNEDs()},sticky_filter_settings:function(e){var t="[◥]"===e.target.textContent;e.target.textContent=t?"[◣]":"[◥]";var n=e.target.parentNode.parentNode;n.parentNode.style.overflow=t?"hidden":"auto",n.nextSibling.style.overflow=t?"auto":"",n.nextSibling.style.height=t?"inherit":""},"SHOW3.*w/":function(e,t){var n=this["."],r=t.split(".")[1];n.pref[n.mode].appearance.expand[r]=!0,this.SHOW3(e)},"HIDE3.*w/":function(e,t){var n=this["."],r=t.split(".")[1];n.pref[n.mode].appearance.expand[r]=!1,this.HIDE3(e)},__proto__:P};if(pref_func.add_onchange_format(P),pref_func.add_onchange_format(q),common_func.Object_defProps(q,site2.DEFAULT.update_posts_merge_bases.onchange_funcs),cataLog.embed_mode=o,brwsr.sw_cache&&pref.info_client&&brwsr.sw_cache.subscribe(!0),!pref.test_mode[114]){styleSheet.register_cc("headline","white-space:nowrap;text-overflow:ellipsis;overflow:hidden;width:100%");var W=site2[site.nickname].parse_funcs.headline_html.css;W&&styleSheet.register_cc("headline "+W)}var G=function(a,s,i){this.mode=s,this.view="float"===s?pref.float.view:s,this.show_catalog_cont=new DelayBuffer(this.show_catalog_delayed.bind(this),200).get_bound_func(),this.show_catalog_resize=this.show_catalog_resize.bind(this),this.show_catalog_scroll=this.show_catalog_scroll.bind(this),this.show_catalog_buf=this.Show_catalog_buf(this);var o=G.prototype.Clgs,l=0==o.length||1==o.length&&"float"!==o[0].mode;0==o.length?Object.defineProperty(this,"pref",{get:function(){return pref},enumerable:!0,configurable:!0}):this.pref={filter:common_func.deep_copy2({},pref.filter),liveTag:{NC:pref.liveTag.NC}},l?(Object.defineProperty(this,"order",{get:"float"===this.mode?function(){return pref.float.order}:function(){return pref.catalog.order},enumerable:!0,configurable:!0}),0!=o.length&&Object.defineProperty(this.pref,this.mode,{get:"float"===this.mode?function(){return pref.float}:function(){return pref.catalog},configurable:!0,enumerable:!0})):(this.pref.float=pref_func.pref_overwrite(pref_default().float,pref.float,!0),this.order=this.pref.float.order),this.pref[this.mode].board_list_sel=pref[this.mode].save_board_list_sel?pref[this.mode].board_list_sel:pref.catalog_board_list_sel,this.name="FC"+G.prototype.Clgs_count,this.pref.INST=l?{view:this.view,get safety(){return pref[s].safety}}:{view:this.view,safety:common_func.deep_copy2(pref[this.mode].safety)};var p=pref.catalog.appearance.initial,c=cnst.init3({func_str:a?"etb:embed":"left:"+p.left+"px:top:"+p.top+"px:tb"+(p.width?":width:"+p.width+"px":"")+(p.height?":height:"+p.height+"px":"")+":overflow:auto:Show:bottom_top:tb_press:"+p.state,onrolldown:this.onrolldown,onrollup:this.onrollup,exit:pref.test_mode[114]?t:this.destroy.bind(this),maximize:this.show_catalog_resize,get auto_roll(){return pref.catalog_auto_rollup_when_moving},autoHeight:function(e){var t=e.target.dataset.height||"auto",n=e.target.parentNode.parentNode.nextSibling.style;e.target.dataset.height=n.height,n.height=t,"auto"===t?this.this_obj.permit_draw_on_demand=!1:delete this.this_obj.permit_draw_on_demand,this.this_obj.show_catalog(0)},settings_after:function(){if("float"===this.this_obj.mode){var e=this.this_obj.components;e.sticky_filter_settings.style.display="none"===e.filter.style.display&&"none"===e.settings.style.display?"none":null}},this_obj:this,__proto__:cnst.tb_funcs}).pn;c.classList.add(pref.script_prefix+"_FC"),c.id=pref.script_prefix+"_"+this.name;var _=c.childNodes[0],d=c.childNodes[1].appendChild(document.createElement("div"));"float"===this.mode&&_.childNodes[1].insertBefore(cnst.dom('<button type="button" name="autoHeight">◊</button>'),_.childNodes[1].firstChild);var u=this.pref[this.mode].appearance.titleBar,f=cnst.add_to_tb(c,'<button type="button" name="filter"'+(u.filter?"":' style="display:none"')+">"+(site2[site.nickname].CONTENT_SECURITY_POLICY_DATAURI?"F":cnst.icons.img(cnst.icons.filter))+'</button><button type="button" name="settings"'+(u.settings?"":' style="display:none"')+">"+(site2[site.nickname].CONTENT_SECURITY_POLICY_DATAURI?"S":cnst.icons.img(cnst.icons.settings))+'</button><button type="button" name="refresh"'+(u.refresh?"":' style="display:none"')+">"+(site2[site.nickname].CONTENT_SECURITY_POLICY_DATAURI?"R":cnst.icons.img(cnst.icons.refresh))+'</button><span name="boards_selector"'+(u.boards_selector?"":' style="display:none"')+'><select name="'+this.mode+'.board_list_sel"></select></span>'),h=f.getElementsByTagName("select")[this.mode+".board_list_sel"];if(this.pref[this.mode].board_list_sel=cnst.auto_shrink_board_selector.setup(h,this.pref[this.mode].board_list_sel),this.health_indicator=i?new M.HealthIndicator:z,_.childNodes[3].appendChild(this.health_indicator.pn),!i){_.childNodes[3].appendChild(cnst.dom("<span> </span>"));var m=new M.HealthIndicator;IDB.set_indicator(m),_.childNodes[3].appendChild(m.pn)}var g=cnst.dom('<div style="margin:0px 3px;clear:both'+("float"===s?';position:relative" class="'+pref.script_prefix+"_window":"")+'"></div>'),v=("float"===s?"float":"catalog")+".order.",b=this.pref[this.mode].appearance.expand,y=pref_func.settings.html_funcs;g.innerHTML=pref_func.format_html_str('<div style="float:right;display:none"><div style="float:right">'+y.updates(this.mode,y.rollup('1,<IC"INST.safety.hide">Auto drop threads temporarily for light feeling <BTN"Drop now"><br>1,<IC"INST.safety.remove">Auto remove threads latter than <ITBN5"INST.safety.max">th<br><BTN"clear_threads,Clear all threads">',"",!0))+y.design_of_fc("INST",1)+'<br name="PLACEHOLDER_NATIVE_SIZE">'+("float"===this.mode?'<IC"liveTag.NC">Separated virtual board<br>':"")+'<IC"'+this.mode+'.merge">Merge all threads<br><IC"'+this.mode+'.merge_list">Merge threads by list<br></div><div style="float:right"><SE"'+v+'ordering,Bump order,Creation date,Reply count,Image count,Last reply,Fast,/Bump order,/Creation date,/Reply count,/Image count,/Last reply,Slow"><br><div>'+y.rollup_radio(v+"sticky"," :Sticky",1,"",["first:at first","last:at last","dont_care:don't care"])+'<br><IC"'+v+'reply_to_me">New reply to me at first<br><IC"'+v+'reply">New reply at first<br>'+y.rollup_radio(v+"watch"," :Watch listed",1,"",["first:at first","last:at last","dont_care:don't care"])+'<br><IC"'+this.mode+'.hide_unwatched">Watched only<br></div></div></div><div align="left" style="float:left;display:none"><div data-show3="kwd"'+(b.kwd?"":' style="display:none"')+'><a name="HIDE3.kwd" style="cursor:pointer">[-]</a><span class="PLACEHOLDER" style="float:right"></span><ICN"filter.kwd.use">Keyword :<input type="text" name="filter.kwd.str" size="25"> <ICN"filter.kwd.ci">CI '+y.make_sel("filter.kwd.match",["match all","match any","unmatch all","unmatch any"])+' <ICN"filter.kwd.sentence">Sentence <ICN"filter.kwd.ew">exact <ICN"filter.kwd.re">RE<br>1,(<ICN"filter.kwd.sub">Subject <ICN"filter.kwd.name">Name <ICN"filter.kwd.com">Comment <span style="display:none"><span name="HIDE4" style="cursor:pointer">◀</span><ICN"filter.kwd.trip">Tripcode <ICN"filter.kwd.id">ID <ICN"filter.kwd.id2">ID2 <ICN"filter.kwd.flag">Flag<ICN"filter.kwd.file">Filename <ICN"filter.kwd.meta">No. </span><span name="SHOW4" style="cursor:pointer">▶</span>) (<ICN"filter.kwd.op">OP <ICN"filter.kwd.post">Posts)<BTN"scanBoard,>"><BTN"scanSite,>>">'+y.rollup('2,<IC"filter.disLWKA">Disable list filter when keyword filter is active<br>2,<IC"filter.disTWKA">Disable tag filter when keyword filter is active<br>1,<IC"filter.auto_list.use">Auto thread filter<br>2,<ICN"filter.auto_list.kill">Hide <ICN"filter.auto_list.watch">Watch <ICN"filter.auto_list.show">Show <ICN"filter.auto_list.sticky">Sticky <ICN"filter.auto_list.style">Style:<ITBL25"filter.auto_list.style_str"><span> &emsp;</span><BTN"add_to_auto,+"><br>2,<TA"filter.auto_list.str,40,1"><br>'+(pref.test_mode[158]?'1,<IC"filter.postFilter.use">Post filter<br>2,<ICN"filter.postFilter.hide">Hide <ICN"filter.postFilter.boards">Boards:<ITBL10"filter.postFilter.boards_str"><ICN"filter.postFilter.style">Style:<ITBL25"filter.postFilter.style_str" placeholder="border-left:10px solid orange"><span> &emsp;</span><BTN"filter.postFilter.add,+"><br>2,<TA"filter.postFilter.str,40,1">':""),'<ICN"filter.kwd.inPost">inPost')+'</div><div style="clear:both'+(b.time?"":";display:none")+'" data-show3="time"><a name="HIDE3.time" style="cursor:pointer">[-]</a>Time: Posted/Created <ICN"filter.time"><ICN"filter.time_creation">Hide <ICN"filter.time_watch"><ICN"filter.time_watch_creation">Watch <ITBL25"filter.time_str"><SE"filter.time_quick_sel,dummy:quick select...,0:now,1:1 hour ago,2:2 hours ago,4:4 hours ago,12:12 hours ago,24:1 day ago,72:3 days ago,168:1 week ago"><br></div><div style="clear:both'+(b.tag?"":";display:none")+'" data-show3="tag"><a name="HIDE3.tag" style="cursor:pointer;float:left">[-]</a><span class="PLACEHOLDER" style="float:right"></span>'+liveTag.popup_filter.html+'</div><div style="clear:both'+(b.list?"":";display:none")+'" data-show3="list"><a name="HIDE3.list" style="cursor:pointer;float:left">[-]</a><span class="PLACEHOLDER" style="float:right"></span><div style="float:left"><input type="checkbox" name="filter.list"> Exclusive list:<br>&emsp;<textarea style="height:1em" cols="20" name="filter.list_str"></textarea></div><div style="float:left"><input type="checkbox" name="filter.attr_list"> Attribute list:<br>&emsp;<textarea style="height:1em" cols="20" name="filter.attr_list_str"></textarea></div><div style="float:left">Watch time list:<br>&emsp;<textarea style="height:1em" cols="20" name="filter.watch_list_str"></textarea></div><div style="float:left"><input type="checkbox" name="filter.bookmark_list"> Bookmark list:<br>&emsp;<textarea style="height:1em" cols="10" name="filter.bookmark_list_str"></textarea></div><div style="clear:both"></div></div><div style="clear:both'+(b.ctrl?"":";display:none")+'" data-show3="ctrl"><a name="HIDE3.ctrl" style="cursor:pointer;float:left">[-]</a><div style="float:left;width:16px"><br></div><div style="float:left"><BTN"clear_filters,clear filters"><br><BTN"load,load"><IC"catalog.auto_load_filter">Auto load filters at changing board group<br><div><div style="float:left"><BTN"save,save"></div><div style="float:left"><IC"catalog.auto_save_filter">Auto save filters at opening or changing board group<br><IC"catalog.auto_save_filter_at_refresh">Auto save filters at refresh</div></div><BTN"clear_pruneds,clear all pruned entries in all lists"><br></div></div><div style="cursor:pointer;clear:both"><a name="SHOW3.kwd"  data-show3="kwd"'+(b.kwd?' style="display:none"':"")+'>[+ Keyword filter]</a><a name="SHOW3.time" data-show3="time"'+(b.time?' style="display:none"':"")+'>[+ Time filter]</a><a name="SHOW3.tag"  data-show3="tag"'+(b.tag?' style="display:none"':"")+'>[+ Tag search]</a><a name="SHOW3.list" data-show3="list"'+(b.list?' style="display:none"':"")+'>[+ List filters]</a><a name="SHOW3.ctrl" data-show3="ctrl"'+(b.ctrl?' style="display:none"':"")+">[+ Control]</a></div></div>"+("float"===this.mode?'<a name="sticky_filter_settings" style="position:absolute;right:0;top:0;display:none">[◥]</a>':"")+'<div style="clear:both"></div>');var w=document.createElement("form");w.name=pref.script_prefix+"_"+this.name,w.appendChild(g),c.childNodes[1].insertBefore(w,d);for(var k=g.getElementsByClassName("PLACEHOLDER"),x=0;x<k.length;x++)cnst.set_tack_float(k[x].appendChild(site2[site.nickname].make_tack()).parentNode,n,r);this.pn12=c,this.pn12_0=_,this.pn12_1=d,this.pn12_0_2=f,this.pn12_0_4=g,this.board_sel=h,this.threads={},this.idxs=[],this.idxs_req=new Map,this.drawn_idx=0,this.threads_odl={},this.ppn=d,this.ppn.classList.add(pref.script_prefix+"_"+this.view+"View"),this.pppn=this.ppn.parentNode,this.pppn_window="float"===this.mode?this.pppn:window,gGEH.pns_resize.set(this.pn12,this.show_catalog_resize);var C=g.getElementsByTagName("*");this.components={ordering:C[("float"===this.mode?"float":"catalog")+".order.ordering"],pn12_0:_,pn12_0_4:g,pn_hi:null,kwd_use:C["filter.kwd.use"],kwd_mirror:[],time_str:C["filter.time_str"],tag_use:C["filter.tag"],attr_list:C["filter.attr_list_str"],watch_list:C["filter.watch_list_str"],ex_list:C["filter.list_str"],pn_filter:g.childNodes[1],auto_list:C["filter.auto_list.str"],postFilter:C["filter.postFilter.str"],merge:C[this.mode+".merge"],merge_list:C[this.mode+".merge_list"],native_size:C.PLACEHOLDER_NATIVE_SIZE,filter:g.childNodes[1],settings:g.childNodes[0],sticky_filter_settings:g.childNodes[2],titleBar:_},this.native={},this.triage_history=[],this.INST={},this.auto_update=new F(this,this.health_indicator),this.refresh_tgts={},this.image_resize1_onload_bound=this.image_resize1_onload.bind(this),this.image_resize2_onload_bound=this.image_resize2_onload.bind(this),this.footer=0!=o.length?H.factory(this.mode,this.threads,this):(H.clg=this,H),Tooltips.add_root(g),pref_func.apply_prep(g.childNodes[0],!1,null,null,!0,this.pref),cnst.auto_shrink_selector(this.components.ordering),this.onchange_funcs={".":this,__proto__:q},pref_func.add_onchange(f,this.onchange_funcs,P);var T=pref_func.add_onchange(g,this.onchange_funcs,P);"float"===this.mode&&pref.catalog.appearance.orderOnTB&&(this.components.ordering.parentNode.removeChild(this.components.ordering.nextSibling),this.pn12_0.childNodes[2].appendChild(this.components.ordering)),0==o.length&&(cataLog.event_func=T),this.scrollTop=0,this.innerHeight=null,this.pppn_window.addEventListener("scroll",this.show_catalog_scroll,!1),"float"===this.mode&&this.ppn.addEventListener("scroll",this.show_catalog_scroll,!1),this.Setup_liveTag(pref.liveTag.NC),this.merge_bases=0===o.length?site2.DEFAULT.update_posts_merge_bases:site2.DEFAULT.update_posts_merge_bases.factory(),this.merge_bases.view=this.view,this.delayed_filter_changed=new Watchdog(this.filter_changed.bind(this),1e3).get_bound_func(),this.Clgs.push(this),this.serialNo=G.prototype.Clgs_count++,site2[site.nickname].catalog_float_prep&&site2[site.nickname].catalog_float_prep(this),2==o.length&&this.hook_set({
//    set drawn_idx(v){this.Clgs.forEach(function(c){c.drawn_idx = v;});}, // temporal
footer:{update_force:function(e,t,n){for(var r=G.prototype.Clgs,a=0;a<r.length;a++)r[a].threads[e]&&r[a].footer.update_force(e,t&&r[a].pref[r[a].footer.mode_fmt].footer.flags,n)},color_tag_node:function(e,t,n){for(var r=G.prototype.Clgs,a=0;a<r.length;a++)!n&&r[a].NC||r[a].threads[e]&&r[a].footer.color_tag_node(e,t)},update_all_force:function(e,t,n){for(var r=G.prototype.Clgs,a=0;a<r.length;a++)r[a].footer.update_all_force(e,t,n)},__proto__:H},show_catalog:function(e){for(var t=G.prototype.Clgs,n=0;n<t.length;n++){var r=t[n];if(e)if("string"==typeof e)r.threads[e]&&r.show_catalog(e);else{var a={},s=!1;for(var i in e)r.threads[i]&&(a[i]=null,s=!0);s&&r.show_catalog(a)}else r.show_catalog()}},filter_changed:function(){for(var e=G.prototype.Clgs,t=0;t<e.length;t++)e[t].filter_changed()},__proto__:G.prototype}),1===o.length&&(cataLog.auto_update=this.auto_update),"archive"!==site.whereami&&this.auto_update.set(),pref.test_mode[160]&&1===o.length&&site2[site.nickname].catalog_native_prep(this.pn12_0_4,this.pn12_0,this.health_indicator.pn2,this),o.length>=2&&this.onchange_funcs["*.board_list_sel"](null,!0,pref[this.mode].env.refresh_initial),1!==G.prototype.Clgs_count&&1===o.length&&e(this),this.show_catalog_scroll_lock=this.show_catalog_scroll_lock_factory(this)};G.prototype={onrolldown:function(){var e=this.rolledup;this.rolledup=0,e>1&&this.show_catalog(0)},onrollup:function(){this.rolledup++},Clgs:[],AllThreads:null,UnsyncedTriages:{},destroy:function(e){var t=e.currentTarget.parentNode;cnst.div_destroy(e.currentTarget.parentNode,!0);var n=G.prototype.Clgs.map(function(e){return e.pn12}).indexOf(t),r=G.prototype.Clgs.splice(n,1)[0];pref.catalog.auto_save_filter&&r.onchange_funcs.save();for(var a in r.threads)r.remove_thread(a);r.auto_update.stop_if_running(),r.footer.liveTag=null,r.footer=null,r.liveTag=null,r.auto_update=null,r.pppn_window.removeEventListener("scroll",r.show_catalog_scroll,!1),r.pppn_window.removeEventListener("resize",r.show_catalog_resize,!1),"float"===r.mode&&r.ppn.removeEventListener("scroll",r.show_catalog_scroll,!1),r.GEH.destroy(),1==G.prototype.Clgs.length&&G.prototype.hook_set(G.prototype.Clgs[0])},hook_set:function(e){gClg=e,cataLog.Footer=e.footer,pe=e.show_catalog.bind(e),cataLog.show_catalog=pe,cataLog.gClg=gClg,1==G.prototype.Clgs.length&&(pClg=e),G.prototype.AllThreads=1==G.prototype.Clgs.length?pClg.threads:common_func.shallow_copy_1(pClg.threads)},Clgs_count:0,BroadcastEventByMode:function(e,t,n){for(var r="proto"===e?this.Clgs:this.Clgs.filter(function(t){return t.mode===e}),a=0;a<r.length;a++)t.apply({".":r[a],__proto__:this.onchange_funcs},n)},onchange_funcs:q,Setup_liveTag:function(e,t){this.liveTag=0===this.Clgs.length?(liveTag.clg=this,liveTag.footer=this.footer,liveTag):liveTag.factory(this,this.footer,e),this.liveTag.setup_pn(this.components.pn_filter,this.pref.filter.tag_search),this.footer.liveTag=this.liveTag,this.pref!==pref&&(e?t&&(delete this.pref.filter.tag,this.pref.filter.tag=!1):Object.defineProperty(this.pref.filter,"tag",{get:function(){return pref.filter.tag},set:function(e){pref.filter.tag=e},configurable:!0,enumerable:!0}),this.components.tag_use.checked=this.pref.filter.tag)},Maintain_AllThreads:function(e){if(1!=this.Clgs.length){var t=this.Clgs.filter(function(t){return t.threads[e]});if(0===t.length)delete gClg.AllThreads[e];else{var n=t[0].threads[e];if(t.length>=2){for(var r=t.map(function(t){return t.threads[e][16].t2h_sel||pref[o].t2h_sel}),a=1;a<t.length&&r[0]==r[a];)a++;var s=a!=t.length}gClg.AllThreads[e]=s?{16:{t2h_sel:"ALL",__proto__:n[16]},__proto__:n}:n}}},Sync_watch_load:function(e,t,n){if(pref.common.consolidated_watch_list&&pref.common.sync_watch_list)if(pref.debug_mode[1]&&console.log("LocalStorage: "+e.key+": "+(e.newValue&&e.newValue.length>120?e.newValue.slice(0,100)+"...":e.newValue)),e.key===pref.script_prefix+".WatchList"||t||n)for(var r=0;r<gClg.Clgs.length;r++){var a=gClg.Clgs[r];if(a.pref.filter.watch_list_str!==e.newValue){if(pref.debug_mode[37]){var s=a.pref.filter.watch_list_str.split("\n").reduce(function(e,t){return e[t]=null,e},{}),i=e.newValue.split("\n").reduce(function(e,t){return t in s?delete s[t]:e[t]=null,e},{});console.log("changed: "+Object.keys(s)+" -> "+Object.keys(i))}a.pref.filter.watch_list_str=e.newValue||"",pref_func.apply_prep(a.components.watch_list,!1,null,null,!0,a.pref),n||a.onchange_funcs["filter.watch_list_str"](null,!0)}}else if(e.key===pref.script_prefix+".WatchListCmd"){var o=JSON.parse(e.newValue);if(!o)return;if("PRUNED"===o[1])return void gClg.Sync_watch_load({newValue:o[2]},null,!0);if("string"==typeof o[1])gClg.Sync_watch_load_cmd_1(o);else for(var r=0;r<o.length;r++)gClg.Sync_watch_load_cmd_1(o[r])}},Sync_watch_load_cmd_1:function(e){if("UNWATCH"!==e[1]||gClg.AllThreads[e[0]]){var t=common_func.fullname2dbt(e[0]);liveTag.mems[t[0]]&&liveTag.mems[t[0]][t[1]]&&liveTag.mems[t[0]][t[1]][t[2]]&&gClg.AllThreads[e[0]]?p(e,!0):(e[5]=!0,gClg.triage_exe_broadcast.apply(gClg,e))}},Sync_watch_save:function(e,t){if(t)return void this.Sync_watch_save_merged.push(e);var n=0!=this.Sync_watch_save_merged.length&&this.Sync_watch_save_merged.concat([e])||e.concat(Date.now());localStorage&&localStorage.setItem(pref.script_prefix+".WatchListCmd",JSON.stringify(n)),this.Sync_watch_save_merged=[]},Sync_watch_save_merged:[],jump_to_post:function(e){var t=e[0]+e[1]+e[2],n=this.threads[t]&&this.threads[t][1]&&this.threads[t][16].posts;if(n){for(var r=n.length-1;r>=0&&n[r].no!=e[3];r--);return r>=0&&window.scrollTo(0,n[r].pn.offsetTop),n[r].pn}},image_resize:function(e,t){var n=(n=this.pref[this.mode].format.thumb,n[n.size]);this.image_resize_1(e,t?n.w1:n.w2,t?n.h1:n.h2)},image_resize_1:function(e,t,n){var r=e.naturalWidth,a=e.naturalHeight,s=r/t,i=a/n,o=s>i?s:i;e.setAttribute("width",r/o),e.setAttribute("height",a/o)},image_resize_onload_add:function(e){for(var t=0;t<e.length;t++)this.image_resize_img(e[t],0==t)},image_resize_img:function(e,t){e.complete?(this.image_resize(e,t),e.onload&&(e.onload=null)):e.onload=t?this.image_resize1_onload_bound:this.image_resize2_onload_bound},image_resize_all:function(e){this.pref[this.mode].format.thumb.size=e;for(var t in this.threads)this.threads[t][0]&&this.image_resize_th(this.threads[t][0])},image_resize_th:function(e){var t=site2[site.nickname].parse_funcs[this.view+"_html"].tn_imgs({pn:e});this.image_resize_onload_add(t)},image_resize1_onload:function(e){e.currentTarget.onload=null,this.image_resize(e.target,!0)},image_resize2_onload:function(e){e.currentTarget.onload=null,this.image_resize(e.target,!1)},kwd_clear:function(){var e=pClg.components.kwd_mirror[1];e.value="",e.oninput({target:e,currentTarget:e})},kwd_init:function(e,t,n){var r;return 0==this.components.kwd_mirror.length?(r=e.cloneNode(!1),r.name="filter.kwd.str",r.oninput=cataLog.event_func,this.components.kwd_mirror=[t.getElementsByTagName("input")["filter.kwd.str"],r]):r=this.components.kwd_mirror[1],e.setAttribute("style","display:none"),e.parentNode.insertBefore(r,e.nextSibling),(n||"meguca"===site.nickname)&&this.kwd_clear(),r},filter_kwd_prep_init:function(e,t){var n=this.pref.filter.kwd;n.str_old="",n.fail_list={},n.suc_list={},this.filter_kwd_prep(e,t)},filter_kwd_prep:function(e,t){var n=this.pref.filter.kwd;n.rexps=common_func.kwd_prep_regexp(n),this.filter_kwd_active(e,t)},filter_kwd_count:0,filter_kwd_active:function(e,t){var n=this.pref.filter.kwd,r=n.posts_active,a=n.use&&n.rexps&&(n.sub||n.name||n.com||n.file||n.meta||n.trip||n.id||n.id2||n.flag);if(n.active=a&&(n.op||n.post),n.posts_active=a&&n.post,n.posts_active&&!r&&(e&&"filter.kwd.post"===e.target.name||!pref4.search_posts_active_once)&&(pref[this.mode].searchAs&&this.onchange_funcs.scanBoard(e,!0,!0),pref[this.mode].searchAsA&&this.onchange_funcs.scanSite(e,!0,!0),pref4.search_posts_active_once|=n.posts_active),t||n.posts_active||!r||ae.posts_search_inactivated(),n.timestamp=this.filter_kwd_count++,!pref.test_mode[59]){if(!e||"filter.kwd.str"!==e.target.name||0!==n.match||n.ew||n.re&&!/^[\w\s]*$/.test(n.str+n.str_old))n.fail_list={},n.suc_list={};else{for(var s in n.fail_list)0!==n.str.indexOf(n.fail_list[s])?delete n.fail_list[s]:n.fail_list[s]===n.str&&(n.timestamp=s);for(var s in n.suc_list)0!==n.suc_list[s].indexOf(n.str)?delete n.suc_list[s]:n.suc_list[s]===n.str&&(n.timestamp=s)}n.str&&(n.fail_list[n.timestamp]=n.str,n.suc_list[n.timestamp]=n.str)}var i=n.posts_active&&n.str.length<pref[this.view].env.kwd_filter_delay_len&&pref[this.view].env.kwd_filter_delay;t||(i?this.delayed_filter_changed(i):this.filter_changed())},filter_changed:function(){var e=this.pref.filter,t=!(e.kwd.use||e.tag||e.time||e.list)||null;for(var n in this.threads)this.threads[n][9][0]=t;pe&&this.show_catalog(0)},FilterChanged:function(){for(var e=0;e<this.Clgs.length;e++)this.Clgs[e].filter_changed()},format_refresh_tgts:function(){if(Array.isArray(this.refresh_tgts)){for(var e={},t=0;t<this.refresh_tgts.length;t++)e[this.refresh_tgts[t].replace(/\/[cjpqt][0-9]+$/,"/")]=null;this.refresh_tgts=e}},IDB_req:{},remake_html_prep:function(e,t){if(t)gGEH.pns_all_keys.set(e[0],t);else{var n=e[16].lth;e[0]=!1,e[16].th=n.ta?{pn:null,__proto__:n.ta.posts[0],posts:n.ta.posts}:{pn:null,__proto__:e[16].lth.th},e[16].posts=null}e[16].icon_sticky&&delete e[16].icon_sticky,e[16].icon_show_always&&delete e[16].icon_show_always,e[16].pn_summary&&delete e[16].pn_summary},remove_thread:function(e,t,n){var r=this.threads[e];if(":DL:"!==e.substr(0,4)){if(!r)return;var a=liveTag.mems.getFromName(e);t||a.q&&site2[a.domain].popups_release_all_not_exist(a),r[1]&&r[0]&&r[0].parentNode===this.ppn&&this.func_hide(e)&&(r[1]=!1),this.merge_bases.remove_th(e,r,this)}return t?(r[0]=!1,r[1]=!1,r[16].th=r[7],r[16].posts=null,void(r[24]&&(r[24][0]=null))):(delete this.threads[e],pref.debug_mode[2]&&console.log("removed: "+e),this.idx_remove(e),pref.test_mode[95]&&"dist"===site.nickname&&site2[site.nickname].testPoster(e),!n&&r&&gClg.Maintain_AllThreads(e),r)},get_latest_time_of_a_thread:function(e){var t=this.threads[e][8];return t[0]>t[4]?t[0]:t[4]||t[0]},clear_threads:function(e,t){if(t&&this.INST.threads_candidates_of_deletion){for(var n in this.INST.threads_candidates_of_deletion)this.threads[n]&&this.INST.threads_candidates_of_deletion[n]===this.get_latest_time_of_a_thread(n)&&this.remove_thread(n);this.INST.threads_candidates_of_deletion=null}for(var r=0;r<this.idxs.length&&r<e;)":DL:"===this.idxs[r++].substr(0,4)&&e++;var a={};this.idxs.slice(e).forEach(function(e){":DL:"!==e.substr(0,4)&&t?a[e]=this.get_latest_time_of_a_thread(e):this.remove_thread(e)},this),Object.keys(a).length>0&&(this.INST.threads_candidates_of_deletion=a)},show_catalog_scroll_lock_factory:function(e){function t(){s.cancel(),a=null}function n(){var t=a[0].offsetTop||0,n=t-a[1]+a[2];n<0&&(n=0),t&&e.get_now_height()!==n&&(window.scrollTo(0,n),o())}function r(t){if(null===a||t){if(t||(t=i.id?l:e.GEH.get_last_viewed()||l),!t)return;a=[t,t.offsetTop,e.get_now_height()],l=t}i.restart(),o()}var a=null,s=new Watchdog(n,5),i=new Watchdog(t,100),o=Watchdog.prototype.restart.bind(s),l=null;return{modified:function(t){t.pn&&a&&a[0]===t.pn?(n(),a=null,r(site2[site.nickname].general_event_handler[site.whereami].get_mark_from_height(t.pn.offsetTop)),e.GEH.clear_last_viewed()):r()},set:r}},get_now_height:function(){return"float"!==this.mode?brwsr.document_body.scrollTop:this.ppn.scrollTop},get_ref_height:function(e){return null===this.innerHeight&&(this.scrollTop="float"===this.mode?this.pppn.scrollTop+this.pppn.offsetTop:brwsr.document_body.scrollTop,this.innerHeight="float"===this.mode?parseInt(this.pppn.style.height,10)||null:window.innerHeight),null===this.innerHeight?NaN:this.scrollTop+this.innerHeight*e},show_catalog_delayed:function(){this.drawn_idx!==!0?this.show_catalog():this.func_lazy_draw&&this.func_lazy_draw(),this===pClg&&cataLog.DIH.expand_thumbnail_on_demand_kick()},show_catalog_scroll:function(e){var t=e.currentTarget.scrollTop||window.scrollY,n=this.scrollTop;this.scrollTop=t,n<t&&this.show_catalog_cont()},show_catalog_resize:function(e){this.innerHeight=null,this.show_catalog_cont()},Show_catalog_buf:function(){var e=function(e){this.clg=e,this.db=new DelayBuffer(this.do.bind(this),10),this.reset()};return e.prototype={do:function(){this.clg.show_catalog(this.tgts,this.arg1,this.arg2),this.reset()},reset:function(){this.tgts={},this.arg1=!1,this.arg2=!1},queue:function(e,t,n){if("string"==typeof e)this.tgts[e]=null;else for(var r in e)this.tgts[r]=null;this.arg1=this.arg1||t,this.arg2=this.arg2||n,this.db.delayed_do()}},function(t){return e.prototype.queue.bind(new e(t))}}()},pClg=new G(l,o);var K=pClg.pn12,Y=pClg.pn12_0,J=pClg.pn12_1,X=pClg.pn12_0_2,V=pClg.pn12_0_4,Q=pClg.board_sel,Z=pClg.threads;H.threads=pClg.threads,cataLog.threads=Z,Object.defineProperty(pClg,"ppn",{get:function(){return $},set:function(e){$=e}}),gClg=pClg,cataLog.gClg=gClg,cataLog.get_ref_height=pClg.get_ref_height,G.prototype.AllThreads=pClg.threads,cataLog.components=pClg.components,"thread"===o&&pref_func.pref_overwrite(pref.filter,pref_default().filter),window.addEventListener("beforeunload",a,!1),window.addEventListener("storage",site2[site.nickname].prep_own_posts_event,!1),site2[site.nickname].check_reply.make_own_posts(),pref.virtualBoard.scan&&"thread"!==o&&setTimeout(function(){scan.keyword_load(!1,z)},1e3*pref.virtualBoard.scanDelay);var $;s(),cataLog.triage_parent_set=s,pClg.onchange_funcs["*.board_list_sel"](null,!0);var ee=function(){function e(e){return!i.args[e]||(i.args[e].max!=i.args[e].idx?(i.args[e].max=i.args[e].idx,i.args[e].INDICATOR&&i.args[e].INDICATOR.report({abort_str:"canceled"})):(i.args[e].INDICATOR&&i.args[e].INDICATOR.report({abort_str:"aborted",end:Date.now()}),delete i.args[e]),!1)}function t(t,r,a,s){if(pref.debug_mode[5]&&console.log("scan_init: "+t),s||e(t,!1)){if(Array.isArray(r)||(r=Object.keys(r)),0==r.length)return void(a.callback&&a.callback(a.callback_args));n(t,r,a)}}function n(e,t,n){i.pool||(i.pool={div:document.createElement("div"),parser:new DOMParser,doc:null,ths:null,dbt:null,tgts:null,tags:{cs:{},ci:{}},name:null,sticky:null,type:null,wrapper_obj:null}),i.args[e]={key:e,idx:0,max:t.length,max_threads:pref4.scan.max_threads,found_threads:0,found_boards:0,scanned:0,crawler:0,obj:t,lifetime:0,cache_write:!1,callback:null,callback_args:null,pool:i.pool,refresh:null,indicator:null,tgt_raw:!1,watchdog:null,from_auto:null,load_on_demand:null,senders_returned:[],priority:0,tgts_iterator:null,__proto__:i.args_proto};for(var a in n)i.args[e][a]=n[a];var s=i.args[e];if(s.load_on_demand&&!s.tgts_iterator){for(var a=0;a<s.obj.length;a++){var o=r(s,a);0===common_func.name2domainboardthread(o,!0)[2].search(/[cjpq][1-9]/)&&(pClg.idx_insert_odl(o),s.obj.splice(a--,1))}if(0===s.obj.length){if(s.indicator&&s.indicator.remove(),s.callback)var l=s.callback,n=s.callback_args;return delete i.args[s.key],l?l(n):void 0}pClg.load_on_demand_try_get_mutex()&&(s.callback=s.callback?function(e){return function(){pClg.load_on_demand_release(),e()}}(s.callback):pClg.load_on_demand_release.bind(pClg)),s.max=s.obj.length,pClg.drawn_idx=0}httpd.req(s.initialize(),s.priority<7?s.priority+1:1)}function r(e,t){var n=e.tgts_iterator?e.tgts_iterator.next().value:e.obj[t];if(n&&"string"!=typeof n){var r=128&n.u;n=n.key}var a;return n&&(a=cnst.name2domainboardthread(n,!0)),n?e.tgt_raw?n:""===a[2]?n+(pref.catalog.catalog_json|r?"j0":"c0"):pref.catalog.catalog_json&&a[2][0].search(/[0-9]/)!=-1?a[0]+a[1]+"t"+a[2]:n:n}function a(e,t,n,r){var a=n[1],i=e.split(","),c=i[3].slice(0,i[3].indexOf("_"));if((200==t.status||304==t.status)&&t.response&&a.found_threads<a.max_threads)if("meguca1"===i[0]&&"catalog_json"===i[3]){for(var _=0;_<t.response.length;_++)liveTag.mems.init({domain:i[0],board:i[1],no:t.response[_]}),l[i[1]+t.response[_]]={page:parseInt(_/10)+"."+_%10,refresh:a.refresh||l[i[1]+t.response[_]]&&l[i[1]+t.response[_]].refresh},scan.list_nup.add(i[0]+i[1]+t.response[_],a.priority);scan.list_nup.got_200_board(i[0],i[1])}else{var d=pref.test_mode[182]&&"catalog"===c?null:"thread"===c?{thread:i[2]}:{page:i[2]};a.localArchive&&(d||(d={}),d.localArchive=a.localArchive,d.archiveFile=a.archiveFile,d.page=a.page);var u=r||site2[i[0]].wrap_to_parse.get(t.response,i[0],i[1],i[3],d);if(a.localArchive){for(var _=0;_<u.length;_++)u[_].key=u[_].key.substr(0,u[_].key.lastIndexOf("/")+1)+u[_].posts[0].no;1===u.length&&(i[2]=u[0].posts[0].no)}if(a.force_annotate)for(var _=0;_<u.length;_++)Z[u[_].key]&&u[_].pn&&Z[u[_].key][0]!==u[_].pn&&(Z[u[_].key][0]=u[_].pn,Z[u[_].key][1]=!0,pClg.insert_thread_format_th_pn(Z[u[_].key],!0,!0,!0,u[_]),Z[u[_].key][16].posts=u[_].posts);a.scanned+=u.length;var f=site2[i[0]].differentAPI&&gClg.Clgs.filter(function(e){e.pref.filter.kwd.posts_active}).length>0,h=a.refresh;if("meguca1"===i[0]&&"thread_json"===i[3]){var m=l[i[1]+i[2]];void 0!==m&&(h=m.refresh,u[0].page=m.page,delete l[i[1]+i[2]])}var g="post"===pref.liveTag.from||pref.stats.use&&!pref.test_mode[167]||0===pref[o].deleted_posts.detect.indexOf("full")||"ALL_agg"===pref[o].storePosts||site2[i[0]].parse_funcs[i[3]].has_editing&&("page"===o||"thread"===o)||pref[o].backlink_all,v="ALL_agg"===pref[o].storePosts||"auto"===pref[o].storePosts&&pref4.search_posts_active_once?"ALL":pref[o].deleted_posts.detect;if("no"===v&&"page"===o&&(v=pref[o].t2h_num_of_posts),pref[o].detect_sage&&"4chan"===i[0]&&"catalog_json"===i[3]&&site2["4chan"].sage_detect_all(u),"catalog_json"===i[3]||"catalog_html"===i[3])for(var b=Object.create(null),_=0;_<u.length;_++)b[u[_].no]=null;for(var y="mergeUI"===a.key||"mergeAuto"===a.key,w=a.from_auto&&(pref.notify.desktop.notify&&pref.notify.desktop.new_thread||pref.notify.sound.notify&&pref.notify.sound.new_thread),k="thread"!==c,x=[],C=0;C<gClg.Clgs.length;C++){var N=gClg.Clgs[C];N.format_refresh_tgts(),x[C]={refresh:h===N||h&&h.pref[h.mode].board_list_sel===N.pref[N.mode].board_list_sel&&N.pref[N.mode].accept_others_refresh||N.pref[N.mode].promiscuous,ALL_agg:"ALL_agg"===pref[o].storePosts,pf_fKwd:N.pref.filter.kwd.active&&N.pref.filter.kwd,pf_fTag:N.pref.filter.tag&&N.liveTag.active.in,pf_foPg:k&&N.pref[N.footer.mode_fmt].footer.page}}for(var _=0;_<u.length;_++){var I=u[_];if(I.no){var j,B=liveTag.prep_tags(I),S=B.wt,L=gClg.AllThreads[I.key],O=!(g||2883584&S[0])&&null;if(B.ed_t&&I.parse_funcs.has_posts){var R=[];j=liveTag.update_tags_in_editing_posts(I,B,R)||j,0===R.length&&(R=null)}B.q&&B.q.waiting&&I.parse_funcs.has_posts&&site2[I.domain].popups_fetched(I,B);var U=null,M=B.archived||"no"!==v,z=s(v,L),H=B.ta&&B.ta.posts[0].missing_info,F=I.parse_funcs.has_posts?I.posts[I.posts.length-1].no:B.lastNo||I.no,P=B.nof_posts!=I.nof_posts||B.lastNo!==F,q=P||z===-1||H&&H>(0|I.missing_info);if(null!==O&&(P||393216&S[0]))"thread"===I.type_source||I.parse_funcs.has_posts&&I.posts.length>I.nof_posts-B.nof_posts&&(B.ta||0!==pref[o].deleted_posts.detect.indexOf("full"))||1===I.nof_posts&&I.posts[0].time>=0&&!I.parse_funcs.dont_have_com?(U=site2[I.domain].check_reply.check(I,B,S,L,a.ext_posts||[]),B.lastNo=F,0!==U.posts.length&&(O=!0),pref[o].backlink_all&&site2[I.domain].popups_add_1_cross(I,U.posts,pref[o].backlink_all_cross),j=U.tags||j,scan.list_nup.got_200(I,B),pref.threadStats.use&&site2[I.domain].stats_ID&&(h||L)&&site2[I.domain].stats_ID(I,U.posts,B)&&scan.list_nup.add(I.key,0),M&&archiver.store(t,I,B,U.posts,U.time_check_old,z,R,a.localArchive)):(scan.list_nup.add(I.key,a.priority),(R||q)&&M&&archiver.store(t,I,B,void 0,void 0,z,R,!0));else{a.localArchive||scan.list_nup.got_200(I,B),pref.threadStats.use&&site2[I.domain].stats_ID&&(h||L)&&(site2[I.domain].stats_ID(I,null,B),pref.threadStats.retry&&pref.threadStats.full&&I.nof_posts<B.nof_posts&&"thread"===I.type_source&&scan.list_nup.add(I.key,0)),(B.rescan_dp||B.force_ar||R||q&&I.parse_funcs.has_posts)&&M&&archiver.store(t,I,B,void 0,void 0,z,R,a.localArchive);var W=I.nof_posts-B.nof_posts;W&&(site2[I.domain].check_reply.check(I,B,S,L,a.ext_posts||[],W),pref3.stats.use&&stats&&stats.aggregate_passive(I,W,t.date),O=!0),B.lastNo=F}if(I.parse_funcs.has_editing){if(U&&"post"!==pref.liveTag.from){for(var G=void 0,C=0;C<U.posts.length;C++)U.posts[C].editing&&U.posts[C].no!=I.no&&(G?G[G.length]=U.posts[C]:G=[U.posts[C]]);G&&(B.ed_t=B.ed_t?G.concat(B.ed_t):G,pref.debug_mode[24]&&console.log(I.key+": lth.ed_t: "+B.ed_t.map(function(e){return"string"==typeof e?e:e.no+"("+e.time+")"})))}"catalog"===I.type_source&&(B.ed_p||B.ed_t)&&(B.archived||"no"!==pref[o].t2h_sel&&L)&&B.ed_u<I.replyTime&&scan.list_nup.add(I.key,a.priority)}B.th&&(L?B.th.missing_info&&B.th.missing_info>(0|I.missing_info)&&(B.th=I):delete B.th),f&&site2[I.domain].wrap_to_parse.posts(I);for(var C=0;C<gClg.Clgs.length;C++){var N=gClg.Clgs[C],K=N.insert_thread_1(I,B,O,j,x[C],t,b,y);if(!L&&K){var Y=s(v,K);z!==Y&&archiver.store_th_to_mem(t,I,B,Y,null),w&&N.filter_test(I.key,K)&&notifier.appeared(I,!0),gClg.AllThreads[I.key]=K,L=K}}O&&gClg.UnsyncedTriages[I.key]&&p(gClg.UnsyncedTriages[I.key])}}if(a.found_threads+=u.length,"catalog_json"!==i[3]&&"catalog_html"!==i[3]||(scan.list_nup.got_200_board(i[0],i[1]),E(i[0],i[1],u,b),pref.test_mode[167]&&pref3.stats.use&&stats&&Object.defineProperty(liveTag.mems[i[0]][i[1]],"st",{value:t.date,writable:!0,configurable:!0})),pref.catalog_max_page_auto&&("page_html"===i[3]||"catalog_json"===i[3]&&site2[i[0]].parse_funcs[i[3]].get_max_page)){var J=site2[i[0]].parse_funcs[i[3]].get_max_page(t.response);J&&(liveTag.mems[i[0]][i[1]].pgs=J)}if(pref[o].load_on_demand){var X=u[u.length-1];!X||"page"!==X.type_source||site2[X.domain].all_boards&&site2[X.domain].all_boards.indexOf(site.board)==-1||pClg.idx_raise_odl(X)}a.found_boards++;for(var _=0;_<gClg.Clgs.length;_++)gClg.Clgs[_].dirty&&gClg.Clgs[_].show_catalog();if("mergeAuto"===a.key&&gGEH.time_jumped)for(var _=0;_<u.length;_++)jump_to_time(u[_],gGEH.time_jumped)}else{if(404==t.status&&("thread_json"===i[3]||"thread_html"===i[3])){var B=liveTag.mems.getFromName(i[0]+i[1]+i[2]);if(pref.test_mode[146]&&B.q&&B.q.waiting){var V={domain_html:site.nickname,time:0,com:"PRUNED",type_source:"thread",__proto__:B};site2[i[0]].popups_fetched({posts:[V],__proto__:V},B)}A(i[0],i[1],i[2]),scan.list_nup.got_404(i[0]+i[1]+i[2])}if(a.found_threads<a.max_threads&&404==t.status&&D(e),null===t.response&&200==t.status&&(pref.debug_mode[16]&&console.log("ERROR!!! Inconsistency in server. Server returned null with status 200 for "+site2[i[0]].make_url4(i)[0]+" , "+e),t.status=-200),404==t.status&&pref.catalog_max_page_auto&&("page_json"===i[3]||"page_html"===i[3])){var J=parseInt(i[2].replace(/^[pq]/,""),10);(!liveTag.mems[i[0]][i[1]].pgs||J<liveTag.mems[i[0]][i[1]].pgs)&&(liveTag.mems[i[0]][i[1]].pgs=J)}}return a.refresh&&!pref.test_mode[65]&&pref.archive.IDB.auto_restore&&i[0]+i[1]in gClg.IDB_req&&("catalog_json"==i[3]||"catalog_html"===i[3]||"page_json"==i[3]||"page_html"===i[3])&&!window.opener&&(T(i[0],i[1]),delete gClg.IDB_req[i[0]+i[1]]),u}function s(e,t){var n=t&&t[16].get_t2h_num_of_posts()||"no";return"ALL"===e||("acc"===e||"ALL"===pref[o].storePosts)&&t?-1:"no"===e||"passive"===e&&"no"!==n?n:e}var i={args:{},pool:null};i.args_proto={callback_1:function(e,t,n){a(e.key2||"",t,[null,n])},get_tgt_func:function(e){if(!(e.IDX<e.max&&(e.refresh||e.found_threads<e.max_threads)))return e.ABORT=!0,void(e.UPPERLIMIT=!0);do{var t=r(e,e.IDX++)}while(e.IDX<e.max&&(!t||pref.catalog.board.ex_list&&pref_func.merge_obj5(t,pref.catalog.board.ex_list_obj2,null)));if(e.IDX<=e.max){var n=scan.list_nup.issued(t),a=common_func.name2dbt(t),s=site2[a[0]].make_url4(a),i=a.join(",");return{REQ:e,url:s[0],responseType:pref.test_mode[165]||n?"text":"html"===s[1]?"document":s[1],tgt:t,key2:i,data_type:s[1],domain:a[0]}}},callback:function(e){e.ABORT&&e.INDICATOR.report({err_str:"Aborted."+(e.UPPERLIMIT?"(Reached upper limit)":"")}),delete i.args[e.key],0==Object.keys(i.args).length&&(i.pool=null),e.callback2&&e.callback2(e.callback_args)},initialize:function(){return Object.defineProperty(this,"idx",{get:function(){return this.IDX},configurable:!0}),Object.defineProperty(this,"tgts",{get:function(){return this.obj},configurable:!0}),Object.defineProperty(this,"initiator",{get:function(){return this.key},configurable:!0}),this.hasOwnProperty("callback")&&(this.callback2=this.callback,delete this.callback),this}},i.args_proto.callback_1_fail=i.args_proto.callback_1,cataLog.scan_boards_keyword_callback2_default_args={refresh:pClg,found_threads:0,get max_threads(){return pref4.scan.max_threads},found_board:0,scanned:0};var l={};return cataLog.scan_boards_keyword_callback2=a,G.prototype.insert_thread_1=function(e,t,n,r,a,s,i,o){var l=e.key,p=this.threads[l],c=void 0===p,_=a.refresh||null===this.refresh_tgts[e.domain+e.board]||"thread"!==this.view&&(a.ALL_agg&&"thread"===e.type_source||a.pf_fKwd&&_e.kwd(a.pf_fKwd,e.posts,e.domain)||a.pf_fTag&&liveTag.search_by_tags(t));if(p){if(null===n){var d=p[8];n=!((d[0]>d[4]?d[0]:d[4]||d[0])>=(e.time_bumped>e.time_posted?e.time_bumped:e.time_posted||e.time_bumped)&&d[2]==e.nof_posts&&d[3]==e.nof_files)}if(!n){var u=p[16];n|=u.expand_posts||u.missing_info&&u.missing_info>(0|e.missing_info)||t.ed_u<e.replyTime}}if((p&&n||!p&&_)&&(p=this.insert_thread(e,s.date,o,i),this.idx_reorder(l,c)),p){var f=e.page&&p[14]!=e.page;f&&(p[14]=e.page),(n||c||a.pf_foPg&&f)&&(this.footer.update(l,n&&e.country,r||c),this.dirty|=1)}return p},cataLog.scan_init=t,{scan_init:t,scan_abort:function(e){t(e,{},{})},scan_boards_keyword_callback2:a,args_proto:i.args_proto}}();cataLog.scan_boards=ee;var te=(l?site2[site.nickname].catalog_get_native_scroll_area?site2[site.nickname].catalog_get_native_scroll_area():window:$.parentNode,null);G.prototype.set_merge_base=function(e,t,n){var r=te&&te.pn;t&&t.split(";").forEach(function(e){var t=e.split(":");n.style[t[0]]=t[1],r&&(r.style[t[0]]="")}),te={name:e,attr:t,pn:n!==r?n:null}},G.prototype.triage_event=function(e,t,n,r,a,s){t.indexOf("s")!=-1&&(t=t.replace(/s/,""),"string"!=typeof e&&(e=e.keys[0]));var i="string"==typeof e?e:e.keys[0];if("SPC"!==t){if("GO"===t)return void this.click_thread(i,"force");if("MERGET"===t||"REMOVET"===t||"UNMERGET"===t){var o=s.parentNode.previousSibling.getAttribute("href"),l=site2[site.nickname].popups_href2dbtp(o).slice(0,3).join("");if(s.parentNode.innerHTML=ne.htmls[t],"MERGET"===t)this.merge_bases.add_to_list_fromUI(site.key,l,this),t="WATCH";else{if("REMOVET"===t)return void this.remove_thread(l);t=t.slice(0,-1)}}if("MERGEN"!==t){if("MERGEB"===t)return void this.set_merge_base(i,n,a);if(t.indexOf("MERGE")!=-1){var p=pref4.mergeHist.proto;if("UNDOMERGE"===t){if(0==p.length)return;var c=p.pop();return pref.proto.merge_lv_str=c[1],pref_func.apply_prep_1n("proto.merge_lv_str",!1,!0,null,!0),pref.proto.merge_list_str=c[0],void pref_func.apply_prep_1n("proto.merge_list_str",!1,!0,null,!0)}p.length>=pref4.mergeHist.max&&p.shift(),p.push([pref.proto.merge_list_str,pref.proto.merge_lv_str])}if("MERGEE"===t){var _=ne.emb_get_key(s);return void this.merge_bases.add_to_list_fromUI(_,e,this)}var d="MERGE"!==t&&"UNMERGE"!==t&&"MERGEOP"!==t;if(this.triage_multicast(e,t,n,d,r,a),"MERGE"===t&&te&&te.pn){var u=this.threads[te.name]&&this.threads[te.name][0];te.pn!==u&&this.set_merge_base(te.name,te.attr,u)}}else{var f=liveTag.mems.getFromName(i).th;if(f.parse_funcs.near_threads){var h=f.parse_funcs.near_threads(f,this.idxs).map(function(e){return"MERGEC,"+e.sub.replace(/,/g,"")+","+e.tgt+",MERGECR,◀,"+e.tgt}).join("\n")||"SPC,NONE,";ne.add_submenu(s.parentNode,h)}}}},G.prototype.triage_multicast=function(e,t,n,r,a,s){var i="string"==typeof e?[e]:e.keys,o=!pref.test_mode[189]||t.indexOf("ARC")!==-1||t.indexOf("MERGE")!==-1||["KILL","TIME","WATCH","UNWATCH","TRACK","KILL_N","TIME_N"].indexOf(t.replace(/m/,""))!=-1;if("UNDO"!==t&&o)for(var l=i.length-1;l>=1;l--)this.triage_exe_broadcast(i[l],t,n,r?"multi":r,null,null,null,!0,s);this.triage_exe_broadcast(o?i[0]:i,t,n,r,a,void 0,void 0,void 0,s)},G.prototype.Get_posted_time=function(e){return e&&(pref.test_mode[167]?e[8][2]:e[8][4]||e[8][0])},G.prototype.triage_exe_broadcast=function(e,t,n,r,a,s,i,o,l){if("MERGEC"===t||"MERGECR"===t||"MERGECU"===t){var p="MERGECR"===t;return this.merge_bases.add_to_list_1(p?e:n,p?n:e,this,null,"MERGECU"!==t||"no_insert"),void ne.off()}if("MERGE"===t){if(this.merge_bases.add_to_list_1(te.name,e,this,null,!0),ne.off(),!n)return;t="ATTR"}if("UNMERGE"===t)return this.merge_bases.add_to_list_1(null,e,this),void ne.off();if("UNMERGELV"===t)return this.merge_bases.add_to_lv_list(e,null,this,!0),void ne.off();if("MERGEOP"===t)return this.merge_cross_links_in_op_manually(e),void ne.off();if(["ARC","ARC1","UNARC"].indexOf(t)!=-1)return void(pref.test_mode[67]||archiver.start_1(t,liveTag.mems.getFromName(e),!0));!a&&"WATCH"===t&&pref.common.consolidated_watch_list&&(a=this.Get_posted_time(this.threads[e])||this.Get_posted_time(gClg.AllThreads[e]));for(var c=!1,_=0;_<gClg.Clgs.length;_++){var d=gClg.Clgs[_],u=1!=gClg.Clgs.length&&this!==d&&(this===gClg||(this.pref[this.mode].board_list_sel!=d.pref[d.mode].board_list_sel||0)),f=d.triage_exe(e,t,n,r,a,u,s);i||"TRACK"===t&&"thread"===this.mode||d.triage_exe_view(f.name,f,"UNDO"!==t&&u===!1?l:void 0,t.indexOf("m")!=-1),c|=f.watch}if(Tooltips.hide(),s||c&&pref.common.consolidated_watch_list&&pref.common.sync_watch_list&&gClg.Sync_watch_save([e,t,n,r,a],o),"WATCH"===t&&pref.archive.store_watched&&this.threads&&this.threads[e]){var h=liveTag.mems.getFromName(e);h.archived||archiver.start_1("ARC",h,!0)}},G.prototype.triage_exe_view=function(e,t,n,r){var a=this.pref[this.mode];Array.isArray(e)||(e=[e]);for(var s=0;s<e.length;s++){var i=e[s],o=Array.isArray(t)?t[s]:t,l=this.threads[i];if(o.watch&&!l&&"bg"!==a.refresh_src&&this.clone_thread_1(i),l){if(o.attr&&(r&&"headline"===this.view&&this.merge_bases.bases[i]&&this.view_attr_set(i,!0,!0,l[3]),this.view_attr_set(i,null,null,n)),o.ex&&this.filter_dirtify(l),o.watch){var p;a.hide_unwatched&&!l[16].lth.watched_p?(this.func_hide_all((p={},p[i]=l,p)),this.idx_remove(i)):this.idx_reorder(i),"page"!==this.view&&"thread"!==this.view||l[16].check_and_expand(l[16].posts,!0),a.mark_new_posts&&this.view_time_filter_changed(i)}(o.ex||o.watch)&&this.show_catalog_buf(i,!0,!0)}}},G.prototype.triage_exe=function(e,t,n,r,a,s,i){var o=this.triage_history,l=this.components.attr_list,p=this.components.watch_list,c=this.components.ex_list,_={ex:!1,attr:!1,watch:!1,name:e};if("UNDO"!==t){if(r){var d=o.length>0&&o[o.length-1];d&&"multi"===d[0][3]?(d[4].push(e),"multi"!==r&&(d[0][3]=r)):(o.length>=pref.catalog_triage_hist&&o.shift(),o.push([Array.prototype.slice.call(arguments),c.value,l.value,p.value,"multi"===r?[e]:null]))}var u="KILL_N"===t||"TIME_N"===t;if(t=t.replace(/m/,"").replace(/_N$/,""),Array.isArray(e)){for(var f={value:l.value},h={value:p.value},m={value:c.value},g=0;g<e.length;g++){var v=_[g]=this.triage_exe_1(e[g],t,n,a,s,i,f,h,m,this.threads[e[g]],u);_.ex|=v.ex,_.attr|=v.attr,_.watch|=v.watch}l.value=f.value,p.value=h.value,c.value=m.value}else _=this.triage_exe_1(e,t,n,a,s,i,l,p,c,this.threads[e],u)}else{if(0==o.length)return _;var b=o.pop();_={ex:c.value!==b[1],attr:l.value!==b[2],watch:p.value!==b[3],name:b[0][0],names:b[4]},p.value=b[3],l.value=b[2],c.value=b[1]}return!_.watch||pref.test_mode[190]&&"UNDO"!==t||pref_func.apply_prep(p,this.pref),!_.ex||pref.test_mode[190]&&"UNDO"!==t||pref_func.apply_prep(c,this.pref),!_.attr||pref.test_mode[190]&&"UNDO"!==t||pref_func.apply_prep(l,this.pref),"UNDO"!==t||!_.watch&&"KILL"!==b[0][1]||this.triage_rewind_watch(_),_},G.prototype.triage_exe_1=function(e,t,n,r,a,s,i,o,l,p,c){var _={ex:!1,attr:!1,watch:!1,name:e},d=new RegExp("(^|,)"+e.replace(/\+/,"\\+")+"([\\^@;][^,\n]*)*(,|\n|$)","mg");if(["KILL","TIME","WATCH","UNWATCH","TRACK"].indexOf(t)!=-1){r||(r=this.Get_posted_time(gClg.AllThreads[e])||this.Get_posted_time(p)||0);var u=r%1e3,f="@"+new Date(r).toLocaleString()+(u?"."+("00"+u).slice(-3):""),h=this.pref.filter.watch_list_str,m=h.replace(d,","),g=h.length!==m.length
;if(a===!1||g||pref.common.consolidated_watch_list||"all"===pref.triage.sync_watch||0===a&&"bg"===pref.triage.sync_watch){var v="";"WATCH"===t||"TRACK"===t||"TIME"===t?(v=e+f,p&&this.mark_read_thread(e,r,"TRACK"===t&&n)):("UNWATCH"!==t||g||(v=e+"@0"),p&&this.mark_read_thread(e,null)),(v||g)&&(o.value=this.pref.filter.watch_list_str=pref_func.fmt4str2(v?m+","+v+"\n":m),_.watch=!0,pref.test_mode[190]&&this.pref.filter.watch_list_obj2._revise(e,v))}}if(!s&&["KILL","TIME","NONE","UNWATCH"].indexOf(t)!=-1&&(a===!1||l.value.search(d)!=-1||"all"===pref.triage.sync_ex||0===a&&"bg"===pref.triage.sync_ex)){var b=this.pref.filter.list_str,y=b.replace(d,","),w=["KILL","TIME"].indexOf(t)!=-1&&p?e+("TIME"===t?f:""):"";(w||b.length!==y.length)&&(l.value=this.pref.filter.list_str=pref_func.fmt4str2(w?y+","+w+"\n":y),_.ex=!0,pref.test_mode[190]&&this.pref.filter.list_obj2._revise(e,w))}if(!s&&!c&&["KILL","TIME","NONE","ATTR","SHOW","UNSHOW","STICKY","UNSTICKY"].indexOf(t)!=-1&&(a===!1||"all"===pref.triage.sync_attr||0===a&&"bg"===pref.triage.sync_attr)){var k=this.pref.filter.attr_list_str;if(p){var x=k.match(d),C=(x?x.join():"")+("ATTR"===t&&n?(x?",":"")+e+";"+n:"")||e,T=pref_func.str2obj2(C,{},!0)[e],N=T.style||{},I=T.cmd||{};"SHOW"===t?I.SHOW=!0:"UNSHOW"===t||"KILL"===t?delete I.SHOW:"STICKY"===t?p[16].systemSticky?delete I.STICKY:I.STICKY=!0:"UNSTICKY"===t&&(p[16].systemSticky?I.STICKY=!1:delete I.STICKY);var E=["KILL","TIME","NONE"].indexOf(t)!=-1?n:Object.keys(N).map(function(e){return e+":"+N[e]}).join(";"),A=Object.keys(I).map(function(e){return e+(I[e]===!0?"":":"+I[e])}).join(";"),j=E||A?e+(E?";"+E:"")+(A?";"+A:""):""}var B=x||!p?k.replace(d,","):k;(x||j||k.length!==B.length)&&(i.value=this.pref.filter.attr_list_str=pref_func.fmt4str2(j?B+","+j+"\n":B),_.attr=!0,pref.test_mode[190]&&this.pref.filter.attr_list_obj2._revise(e,j))}return _},G.prototype.triage_rewind_watch=function(e){for(var t=(e.names||[e.name]).filter(function(e){return this.threads[e]},this),n=t.length-1;n>=0;n--){var r=t[n],a=this.get_watch_time_of_a_thread(r,this.threads[r][8][1],null,!0),s=liveTag.mems.getFromName(r);a?site2.DEFAULT.check_reply.set_watch_time(s.wt,a,r):site2.DEFAULT.check_reply.set_unwatch(s.wt),liveTag.dirtify_ur(s)}0!=t.length&&ee.scan_init("triage_undo",t,{refresh:this,priority:8,callback:this.triage_undo_callback.bind(this,t)})},G.prototype.triage_undo_callback=function(e){for(var t=0;t<e.length;t++)this.idx_reorder(e[t]),this.footer.update_force(e[t]);this.show_catalog(0)};var ne=function(){function e(e,t,n){for(var r=t.format_tgt,a="string"==typeof e?null:e,s=a?null:liveTag.mems.getFromName(e),i=a?null:n.threads[e],o=0;o<r.length;o++)r[o][0].style.display=(a?u.merge(a.tgt_ths,a.lths,r[o][1]):u[r[o][1]](i,s))?"none":""}function t(e,t){var n=new Triage(e,t);return n.pn.onmouseover=g.triage_in,n.pn.onmouseout=g.triage_out,pref.triage.hide_toggle||(n.format_tgt=null),n}function n(e){if("float"===f.mode){g.off(),Tooltips.hide(),e.preventDefault();var t=document.createEvent("MouseEvents");t.initMouseEvent(e.type,e.canBubble,e.cancelable,e.view,e.detail,e.screenX,e.screenY,e.clientX,e.clientY,e.ctrlKey,e.altKey,e.shiftKey,e.metaKey,e.button,e.relatedTarget),f.ppn.dispatchEvent(t)}}function r(e,t,n){a(f,h,e,t,n),"MERGEN"!==e&&g.off()}function a(e,t,n,r,a,s,i){if("MENU"===n||"PMENU"===n)t&&(g.make_menu(a,t,e,s,"PMENU"===n),site2.DEFAULT.popups_posts.pop_down_temporarily(i));else if("P"===n[0]){var o=site2[site.nickname].general_event_handler[site.whereami].menu2keyTime(g.pn_menuOpen);"PWATCH"===n?e.triage_event(o[0],"WATCH","",o[2]):hiddenPosts.cmd(e,o[0],o[1],g.pn_menuOpen,n)}else e.triage_event(t,n,r,void 0,s||g.triaged_pn,a)}function s(){var e={onclick:r,onmousewheel:n,style:"pointer-events:none;position:absolute"};o=t(pref.catalog_triage_str,e),l=t(pref.triage.menu_str,{menu:!0,child_style:"width:100%;",class:"menu",__proto__:e}),p=t(pref.triage.postMenu_str,{menu:!0,child_style:"width:100%;",class:"postMenu",__proto__:e})}function i(e,t){return'<a class="'+pref.script_prefix+'_embeddedTriage" data-cmd="'+e+'">'+t+"</a>"}var o=null,l=null,p=null,c=null,_=null,d=null,u={WATCH:function(e){return 67895296&e[19][0]&&0===e[19][1]},UNWATCH:function(e){return!(67895296&e[19][0])},SHOW:function(e){return e[16].show_always},UNSHOW:function(e){return!e[16].show_always},STICKY:function(e){return e[20]},UNSTICKY:function(e){return!e[20]},ARC:function(e,t){return t.archived},ARC1:function(e,t){return t.archived},UNARC:function(e,t){return!t.archived},merge:function(e,t,n){for(var r=0;r<t.length;r++)if(!this[n](e[r],t[r]))return!1;return!0}},f=null,h=null,m=pClg.ppn,g=function(){function t(e,t,n,r){var a=e.pn.style,s=n.offsetLeft-t.ppn.scrollLeft+(r?r.getBoundingClientRect().left-n.getBoundingClientRect().left-10:0);r||"Left"===pref[t.view].triage_place.slice(-4)?(a.left=s+"px",a.right=null):(a.right=t.ppn.offsetWidth-s-n.offsetWidth+"px",a.left=null);var i="float"===t.mode,o=n.offsetTop-(i?t.pppn.scrollTop+t.ppn.scrollTop:0)+(r?r.getBoundingClientRect().top-n.getBoundingClientRect().top+r.offsetHeight:0);r||"t"===pref[t.view].triage_place[0]?(a.top=o+"px",a.bottom=null):(a.bottom=(i?t.pppn.offsetHeight+t.ppn.offsetTop:window.innerHeight)-o-n.offsetHeight+"px",a.top=null)}function n(e,t,n,r){if(pref[r.view].triage_hover){if(g===n)return;pref.triage.popdown&&v.restart(pref.triage.popdown_delay),u(o,t,n,r)}else g!==n&&s()}function r(){m.appendChild(o),m.appendChild(l),b=!1}function a(e,t){c!==e&&s(),c=e,h||(b?m.appendChild(e.pn):e.pn.style.display=""),h=t}function s(){Tooltips.hide_if(c),h&&(_&&(_.remove(),_=null),b?c.pn.parentNode.removeChild(c.pn):c.pn.style.display="none",h=null,c=null,y&&y.classList.remove("menuOpen"),y=null)}function i(e){g=null,f=null,s()}function d(e,t,n,r,a){var i=a?p:l;if(g!==r||c!==i||t!==h||(s(),a&&y!==e)){v.stop(),u(i,t,r,n,e);var o=document.documentElement.clientWidth,_=parseInt(i.pn.style.left,10);i.pn.getBoundingClientRect().left+i.pn.offsetWidth>=o&&(i.pn.style.left=_-(i.pn.offsetWidth-e.offsetWidth-20)+"px");var d=document.documentElement.clientHeight,f=parseInt(i.pn.style.top,10);i.pn.getBoundingClientRect().top+i.pn.offsetHeight>=d&&(i.pn.style.top=f-i.pn.offsetHeight-e.offsetHeight+"px"),y=e,e.classList.add("menuOpen")}}function u(n,r,s,i,o){f=i,m=pref.test_mode[141]?i.pppn:i.ppn,t(n,i,s,o),g=s,n.format_tgt&&e(r,n,i),a(n,r)}var g=null,v=new Watchdog(s,100),b=!0,y=null;return{change_mode:r,thread_in:n,off:s,triage_in:function(e){v.stop(),e.stopPropagation(),gGEH.triage_in2(e),gGEH.triage_in&&gGEH.triage_in(e)},triage_out:function(){c!==l&&pref.triage.popdown&&v.restart(pref.triage.popdown_delay)},thread_out2:i,make_menu:d,get triaged_pn(){return g},get pn_menuOpen(){return y}}}();s();var v={REMOVET:"["+i("MERGET","Merge")+"]",MERGET:"["+i("REMOVET","Remove")+"]["+i("UNMERGET","Unmerge")+"]",UNMERGET:"["+i("MERGET","Merge")+"]["+i("REMOVET","Remove")+"]"};return{change_mode:g.change_mode,thread_in:g.thread_in,off:g.off,triage_in:g.triage_in,triage_out:g.triage_out,thread_out2:g.thread_out2,destroy:function(){this.off(),o.destroy(),l.destroy(),p.destroy()},remake:function(){this.destroy(),s()},embedded_onclick:function(e,t){var n=gGEH.get_key_recursive(e.target,e.currentTarget,!0),r=Triage.prototype.et2tr(e.target),s=cataLog.GEH.prototype.geh.recSearch_thread(e.target,e.currentTarget,"headline"===t.view?pref.script_prefix+"_headline":void 0);a(t,n,r.cmd,r.attr,e.target,s,e)},htmls:v,doms:{emMerge:cnst.dom("<span>"+v.REMOVET+"</span>"),postMenu:cnst.dom(i("PMENU","▶"))},emb_get_key:function(e){for(var t;!e.getAttribute||!(t=e.getAttribute("href"));)e=e.previousSibling;var n=site2.DEFAULT.popups_posts.href2domain(t);return site2[n].popups_href2dbtp(t).slice(0,3).join("")},add_submenu(e,a){var s=t(a,{onclick:r,onmousewheel:n,style:"pointer-events:auto;position:absolute;top:0px;left:"+(e.offsetWidth-5)+"px;width:700px"}).pn;e.appendChild(s),d=s,_||(_=s)}}}();Triage.prototype.doms=ne.doms;cataLog.triage=ne;var re={get no(){return this.dbt[2]},get board(){return this.dbt[1]},get domain(){return this.dbt[0]},get key(){return this.dbt.join("")},get nof_posts(){return liveTag.mems.getFromName(this.key).nof_posts},get nof_files(){return this.threads[this.key][8][3]},get tags(){return liveTag.mems.getFromName(this.key)},recent_posts:function(e,t){void 0!==e&&null!==e||(e=this.get_t2h_num_of_posts());var n=t;return e!==!1&&this.lth.ta&&(n=site2[this.lth.domain].update_posts_replace_prep(null,this.lth.ta.posts,e)),n||(n=[this.op]),!pref.test_mode[64]&&pref[o].deleted_posts.merge&&this.lth.pd?c(this.lth,n,e,pref[o].t2h_sel):n},get_t2h_num_of_posts:function(){var e=this.t2h_sel||pref[o].t2h_sel;return"page"===e?this.t2h_page||pref[o].t2h_num_of_posts:"L"===e?pref[o].t2h_L:"M"===e?pref[o].t2h_M:"N"===e?pref[o].t2h_num_of_posts:"N_unread"===e?pref[o].t2h_num_of_posts+this.lth.nr:"unread"===e?this.lth.watched?this.lth.nr:this.t2h_page||pref[o].t2h_num_of_posts:"no"===e?0:-1},expand_num:function(){var e=this.get_t2h_num_of_posts()+1,t=this.lth.nof_posts||this.lth.th.nof_posts;return 0==e||e>t?t:e},expand_event:function(e,t){this.t2h_sel=ae.get_t2h_from_index(e),t||this.check_and_expand(this.recent_posts(),!0)&&scan.scan_ui("expand_page",{tgts:[this.key],options:{refresh:this.clg}})},check_and_expand:function(e,t){var n=e.length<this.expand_num();if(n)this.expand_posts=!0,scan.list_nup.add(this.key,1);else if(t){var r={posts:e,__proto__:this.threads[this.key][7]};this.clg.insert_thread_prepare_html_lazy(this.threads[this.key],!1,!1,null,r),cataLog.show_catalog(this.key,!0)}return gClg.Maintain_AllThreads(this.key),n}};G.prototype.insert_thread_dummy=function(e,t,n){var r=site2.DEFAULT.wrap_to_parse.get_getters(),a=[{domain:e,board:t,no:n,key:e+t+n,sub:"",com:"DUMMY, waiting for archive...",body:"",name:"",id:void 0,trip:void 0,country:void 0,flag:null,op_img_url:void 0,time_bumped:1,time_posted:1,time_created:1,nof_posts:1,nof_files:0,parse_funcs:{type_com:"html"},sticky:!1,__proto__:r}],s={posts:a,__proto__:a[0]};liveTag.prep_tags(s),this.insert_thread(s,0),this.threads[e+t+n][16].missing_info=1e4},G.prototype.insert_thread=function(e,t,n,r){var a=e.key,s=e.insert_thread_from_native,i=!1,l=this.threads[a],p=[e.time_bumped,e.time_created,e.nof_posts,e.nof_files,e.time_posted];if(l&&l[16].missing_info&&l[16].missing_info>(0|e.missing_info)-(site2[e.domain].revise_thread?1:0)){!e.page&&l[7]&&(e.page=l[7].page),this.remove_thread(a,!0),l=void 0;var c=!0}var _=e.lth;if(void 0==l){if(pref.test_mode[19]&&e.parse_funcs_html.th_init&&e.parse_funcs_html.th_init(e),i=!0,l=[!!s&&e.pn,s&&"archive"!==site.whereami,null,null,null,[],null,null,p,[null,0,null,0],null,null,null,t,e.page,0,{dbt:common_func.name2domainboardthread(a,!0),parse_funcs:e.parse_funcs,systemSticky:e.sticky,type_html:e.type_html,domain_html:e.domain_html,parse_funcs_html:e.parse_funcs_html,icon_sticky:null,icon_show_always:null,show_always:null,th:e,lth:_,op:e.posts&&e.posts[0],threads:this.threads,clg:this,__proto__:re},null,e.type_html,null,e.sticky,!1,null,null,null],e.missing_info&&(l[16].missing_info=e.missing_info),c){for(var d=0;d<l.length;d++)this.threads[a][d]=l[d];l=this.threads[a]}else this.threads[a]=l;l[19]=_.wt,"catalog"===o&&e.domain===site.nickname||!("KC"===e.domain&&"catalog"===e.type_source||e.posts[0].editing)?"archive"===e.type_source&&(l[16].missing_info=1e4,scan.list_nup.add_scan(e.key)):(l[16].missing_info=1e4,"catalog"===e.type_source&&scan.list_nup.add(e.key)),e.archiveFile&&(l[16].archiveFile=e.archiveFile),"thread"===this.mode&&(l[16].t2h_sel=n?pref[o].t2h_sel:"all")}pref.test_mode[170]||e.parse_funcs.posts_full&&e.parse_funcs.posts_full(e),_.th=e,p[0]||(p[0]=l[8][0]),p[4]||(p[4]=l[8][4]<p[0]?p[0]:l[8][4]?l[8][4]:site2[e.domain].check_reply.get_checked_time(l[19])),l[8]=p,s&&(l[16].posts=s.posts_shown),("page"===e.type_source||"4chan"===e.domain&&"catalog_json"===e.type_parse)&&(l[16].t2h_page=e.posts.length-1),l[16].expand_posts&&(l[16].expand_num<=e.nof_posts||"thread"===e.type_source)&&(l[16].expand_posts=!1),"page"!==this.view&&"thread"!==this.view||!i||l[16].check_and_expand(e.posts),!e.page&&l[16].th&&(e.page=l[16].th.page),i||!e.parse_funcs.has_posts||"page"!==this.view&&"thread"!==this.view||(l[16].th=e),(pref.test_mode[49]||"no"===pref[o].t2h_sel)&&!site2[site.nickname].historyAPI||l[7]&&!e.parse_funcs.has_posts||(l[7]=e),this.filter_dirtify(l,!0);var u=this.pref.filter;if((s||l[16].expand_posts&&l[1]&&!u.kwd.posts_active||pref.test_mode[36])&&this.insert_thread_prepare_html_lazy(l,i,s,null,e),i){if(u.auto_list.use&&!u.list_obj2[e.key]&&!u.watch_list_obj2[e.key]&&!u.attr_list_obj2[e.key]){var f=pref_func.merge_obj5a(e,u.auto_list.obj7,null);f&&this.apply_auto_list_filter(e,f)}var h=this.pref[this.mode];if((h.merge_list||h.merge_list_delayed)&&h.merge_op_auto&&("catalog"===this.view||"headline"===this.view)&&!pref3.proto.merge_list_obj2[a]&&!pref3.proto.merge_lv_obj2[a]&&e._links)for(var d=e._links.length-1;d>=0;d--){var m=e._links[d],g=m.slice(0,3).join("");if(r&&m[0]===e.domain&&m[1]===e.board&&!(m[2]in r)){if(!pref.test_mode[147]||!h.merge_op_auto_hop)continue;var v=_.mh||0;if(v>=h.merge_op_auto_hop)continue;scan.list_nup.add_scan(g);var b=liveTag.mems.getFromName(g);(!b.mh||b.mh>v+1)&&(b.mh=v+1),r[m[2]]=null}if(h.merge_op_lv_add&&this.merge_bases.add_to_lv_list(e.key,h.merge_btn_lv,this),this.merge_bases.add_to_list_1(g,e.key,this,!0,!0),h.merge_op_attr||h.merge_op_list){var y=h.merge_op_attr?this.view_attr_get_str(g):null,w=h.merge_op_list?u.list_obj2[g]:null;(y||w)&&this.triage_exe_broadcast(e.key,w?w.time?"TIME":"KILL":"NONE",y||"",!1,w&&w.time||null,!1,!0)}break}this.view_attr_set(e.key,null,!0)}return"meguca"===e.domain&&(_.ed_t?_.ed_u=e.replyTime:_.ed_u&&(_.ed_u=void 0)),l},G.prototype.apply_auto_list_filter=function(e,t){for(var n=0;n<t.length;n++)if(t[n].use!==!1&&_e.kwd({use:!0,__proto__:t[n]},e.posts,e.domain))for(var r=t[n].cmds.split(","),a=0;a<r.length;a++){var s=r[a].indexOf(":");this.triage_exe_broadcast(e.key,s===-1?r[a]:r[a].slice(0,s),s===-1?"":r[a].slice(s+1),!1,null,!1,!0)}},cataLog.set_watch_time_thread=function(e,t,n,r,a,s){var i=pClg.get_watch_time_of_a_thread(e,n,r,!0);0===i&&"thread"===t&&pref.catalog.auto_watch&&e===site.key&&(i=r||n),i>0?site2.DEFAULT.check_reply.set_watch_time(s,i,e):site2.DEFAULT.check_reply.set_unwatch(s)},G.prototype.insert_thread_prepare_html_lazy=function(e,t,n,r,a){var a=e[16].th||a;r&&pref.filter.kwd.posts_active||("page"===this.view||"thread"===this.view&&(a.lth.pd||"ALL"!==e[16].t2h_sel&&"all"!==e[16].t2h_sel||"thread"!==a.type_source))&&(a.posts=e[16].recent_posts(void 0,a.posts)),ae.prepare_html_prep_posts(a),(t||"page"===o||"thread"===o)&&ae.prepare_html(e,a,t,this.view,this.mode),t&&this.insert_thread_format_th_pn(e,t,a),e[0]&&this.insert_thread_format_html(a,a.key,t,n),e[16].th=null},G.prototype.insert_thread_format_th_pn=function(e,t,n){if(t){var r=e[0];gGEH.pns_all_keys.set(r,n.key),(this.pref[this.mode].format.thumb.resize||n.domain!==site.nickname)&&this.image_resize_onload_add(n.parse_funcs_html.tn_imgs(n)),e[24]=this.footer.prep_footer3(n,e[24]),this.view_attr_set(n.key,null,!0)}},G.prototype.insert_thread_format_html=function(e,t,n,r){site2.DEFAULT.check_reply.set_own_posts(e);var a=n||r&&"meguca"===site.nickname;if(a&&("page"===e.type_html||"thread"===e.type_html)){var s=e.parse_funcs_html.get_thread_links(e.pn?e:{pn:this.threads[t][0],__proto__:e});if(s)for(var i=0;i<s.length;i++)s[i].onclick=d}var l=this.threads[t],p=this.merge_bases,c=p.bases[e.key]||n&&(l[1]||!p.initialized)&&p.query(e.key,l,e,!0,this);if("page"===this.view||"thread"==this.view){var _=this.update_posts_in_page(e,t,a,r,l,c);pref[o].popup&&(this.pref.filter.kwd.posts_active&&!pref.test_mode[125]||pref[this.mode].backlink_all||site2[e.domain].popups_release_all_not_exist(e.lth,l[16].posts),pref[this.mode].merge_op_auto&&_[0]===l[16].posts[0]&&this.merge_cross_links_in_op(e.lth,l[16].posts[0]))}"page"!==this.view&&"thread"!==this.view||(pref.test_mode[158]&&(pref.postFilter.use||pref.filter.postFilter.use)&&ae.postFilter(this,e,_),pref.test_mode[162]&&hiddenPosts.hide_if_hit(e,_),pref[this.mode].hide_posts_without_images&&ae.hide_posts_without_images(this,_),this.view_update_draw(t,this.threads[t][16].posts)),pref.test_mode[155]&&"json"===e.type_data&&(pref.test_mode[136]=!1)},G.prototype.merge_cross_links_in_op=function(e,t){var n=e.mh||0;if(!(n>=pref[this.mode].merge_op_auto_hop)){var r=e.q[t.no].quotes,a=r&&r.filter(function(t){return t[0]!==e.q}).map(function(e){return e[0].key}).filter(function(e){return!this.threads[e]},this);a&&0!=a.length&&(scan.scan_ui("mergeAuto",{tgts:a,options:{refresh:this}}),this.merge_tgts(a,n))}},G.prototype.merge_tgts=function(e,t){pref[this.mode].merge_op_lv_add&&this.merge_bases.add_to_lv_list(e,pref[this.mode].merge_op_lv+(pref[this.mode].merge_op_lv_inc?t:0),this);for(var n=0;n<e.length;n++){var r=common_func.fullname2dbt(e[n]),a=liveTag.mems.init({domain:r[0],board:r[1],no:r[2]});(!a.mh||a.mh>t+1)&&(a.mh=t+1)}},G.prototype.merge_cross_links_in_op_manually=function(e){var t=liveTag.mems.getFromName(e);site2[t.domain].popups_prep(t),ae.prepare_html_post(t.th,t.th.posts[0]);var n=t.q[t.th.posts[0].no].quotes,r=n&&n.filter(function(e){return e[0]!==t.q}).map(function(e){return e[0].key}).filter(function(e){return this.threads[e]},this);if(r&&0!=r.length){this.merge_tgts(r,t.mh||0);for(var a=0;a<r.length;a++)this.merge_bases.add_to_list_1(e,r[a],this,null,!0)}};var ae={prepare_html_prep_posts:function(e,t){site2[e.domain].wrap_to_parse.posts(e),"html"!==e.type_data||!t&&e.domain===site.nickname||this.prepare_html_extract_params(e)},prepare_html_extract_params:function(e){if(!e.extracted&&e.pn){if(e.parse_funcs){if(e.parse_funcs.filename){for(var t=0;t<e.posts.length;t++)e.posts[t].pn&&(e.posts[t].filename=e.parse_funcs.filename(e.posts[t]));e.filename=e.parse_funcs.filename(e)}e.parse_funcs.prep_mimic&&e.parse_funcs.prep_mimic(e)}if(e.posts)for(var t=0;t<e.posts.length;t++)e.posts[t].parse_funcs.prep_mimic&&e.posts[t].pn&&e.posts[t].parse_funcs.prep_mimic(e.posts[t]);e.extracted=!0}},prepare_html:function(e,t,n,r,a){var s=t.domain!==site.nickname&&"html"===t.type_data,i="thread"===r?"page":r,o=!t.pn||(t.domain!==site.nickname||i!==("thread"===t.type_mimic?"page":t.type_mimic))&&pref.catalog.mimic_base_site||"float"===a;if(pref.test_mode[92]&&(i="catalog"),o){if(n){var l="headline"===i?site2[site.nickname].headline_json2html(t):"page"===i?site2[site.nickname].page_json2html3(t,!s,e[16],pref[r].use_expander_always||"thread"===a&&"all"!==e[16].t2h_sel):site2[site.nickname].catalog_json2html3(t,t.board,t.op_img_url);Object.defineProperty(t,"pn",{value:l,writable:!0,enumerable:!0,configurable:!0})}t.type_html=i,t.domain_html=site.nickname,t.parse_funcs_html=site2[site.nickname].parse_funcs[t.type_html+"_html"]}else"html"===t.type_data&&site2.common.remove_by_tagname(t.pn,"script");n&&(pref[a].popup&&"page"===i&&site2[t.domain].popups_prep(t),e[0]===!1&&(e[0]=t.pn,e[16].type_html=t.type_html,e[16].domain_html=t.domain_html,e[16].parse_funcs_html=t.parse_funcs_html),Object.defineProperty(t,"footer",{value:t.parse_funcs_html.footer(t),writable:!0,enumerable:!0,configurable:!0}),t.parse_funcs_html.footer2&&Object.defineProperty(t,"footer2",{value:t.parse_funcs_html.footer2(t),writable:!0,enumerable:!0,configurable:!0}),this.prep_anchor_links(t.pn,t))},prep_anchor_links:function(e,t){pref.test_mode[109]&&"html"!==t.type_data||t.no==site.no&&t.board==site.board&&t.domain==site.nickname||site2[t.domain].toplevel_anchor(e,t),site.nickname!==t.domain&&site2[t.domain].absolute_link(e,t)},prepare_html_post:function(e,t,n,r,a,s,i,l){if(pref.test_mode[161]&&!l&&t.pn){if("json"===t.type_data||t.extracted||e.domain===site.nickname)return;t.extracted=!0}t.pn||(t.pn=site2[e.domain_html].parse_funcs.post_json.pn(t),n||(n=e.lth.q)),a||this.prep_anchor_links(t.pn,e),site2[e.domain_html].format_pn(t.pn,n?n[t.no]:null,r,t,e),t.editing&&t.pn.classList.add(pref.script_prefix+"_post_editing"),pref[o].popup&&site2[e.domain].popups_add_1(e,t,s,n||e.lth.q,i,(r?r:pref[cataLog.embed_mode]).backlink),!t.pn_menu&&pref[o].postMenu&&(t.pn_menu=this.add_postMenu(e,t))},add_postMenu(e,t){var n=ne.doms.postMenu.cloneNode(!0),r=site2[e.domain_html].add_backlinks_bks_query(t.pn);return r?r.parentNode.insertBefore(n,r):site2[e.domain_html].add_backlinks_bks_append(t.pn,n),n},get_t2h_from_index:function(e){return["page","L","M","N","N_unread","unread","all"][e]},get_t2h_index:function(e){var t=e[16].t2h_sel||pref[o].t2h_sel;return"page"===t?0:"L"===t?1:"M"===t?2:"N"===t?3:"N_unread"===t?4:"unread"===t?5:6},prep_blacklist_click_tn:function(e,t,n,r){if(n&&r.env.expand_thumbnail_inline_native&&(!r.env.event_dynamic||e.domain!==site.nickname))for(var a=0;a<t.length;a++){var s=e.parse_funcs_html.tn_imgs(t[a]);if(s)for(var i=0;i<s.length;i++)fe.prototype.blacklist_click.add(s[i])}}};G.prototype.update_posts_in_page=function(e,t,n,r,a,s){for(var i=pref[o],l=r?{colorID:i.colorID&&!i.env.colorID_native,backlink:i.backlink&&!i.env.backlink_native,localtime:i.localtime&&!i.env.localtime_native}:i,p=n&&e.key===site.key,c=r&&pref[this.mode].env.popup_native&&!pref[this.mode].env.event_dynamic,_=r?r.init?r.posts_shown.slice():r.posts_updated:n?e.posts.slice():[],d=0;d<_.length;d++)ae.prepare_html_post(e,_[d],e.lth.q,l,p,c,!0,!0);return r&&ae.prep_blacklist_click_tn(e,_,r,pref[this.mode]),s||a[16].posts&&a[16].posts!==e.posts?(s&&!a[16].posts&&(a[16].posts=e.posts.slice()),site2[e.domain_html].update_posts_replace(e,a[16],a[0],s,a[1],_,this,c)):(a[16].posts=e.posts.slice(),pref.test_mode[140]||n&&r&&pref[this.view].use_expander_always&&site2[e.domain_html].page_json2html3_add_omitted_info(e,a[16],!0,!0)),pref.test_mode[140]&&n&&r&&("page"===this.view||"thread"===this.view)&&pref[o].use_expander_always&&site2[e.domain_html].page_json2html3_replace_expander(e.posts,ae.get_t2h_index(a),t),common_obj.thread_reader&&common_obj.thread_reader.updated(_,r&&r.init),_},common_func.Object_defProps(ae,{replace_posts_by_search:function(e,t){var n=e[7];if(t.filter.kwd.posts_active){if(e[10]!=t.filter.kwd.timestamp||e[16].th){e[10]=t.filter.kwd.timestamp;var r=_e.kwd_make_result(e[16].recent_posts("auto"===t[o].sourceOfSP?-1:null),n.domain);if(r){var a=!e[16].posts||e[16].posts.length!==r.length;if(!a)for(var s=r.length;--s>=0;)if(e[16].posts[s].no!==r[s].no){a=!0;break}e[16].posts&&e[16].posts[0]&&e[16].posts[0].pn&&e[16].posts[0].pn.classList.contains("CatChan_search_miss")==r[0].search_result&&site2[n.domain_html].update_posts0_class(e[16].posts[0].pn,r[0].search_result),a?(ae.prepare_html_prep_posts(n),e[16].th={posts:r,__proto__:n}):e[16].th&&(e[16].th=null)}else e[9][0]=!1,e[16].th=null}}else(e[10]||e[16].th)&&(e[16].th||(e[16].th={posts:e[16].recent_posts(),__proto__:n}),e[10]=!1);return e[16].th&&e[7]&&e[16].posts===e[7].posts&&(e[7].posts=e[7].posts.slice()),!t.filter.kwd.posts_active||e[9][0]},posts_search_inactivated:function(){for(var e in Z){var t=Z[e][7],n=Z[e][16];n.posts&&n.posts[0]&&n.posts[0].pn&&n.posts[0].pn.classList.contains("CatChan_search_miss")&&site2[t.domain_html].update_posts0_class(n.posts[0].pn,!0)}pClg.drawn_idx=0},hide_posts_without_images:function(e,t){for(var n=e.pref[e.mode].hide_posts_without_images,r=0;r<t.length;r++)0===t[r].nofFiles&&(n?t[r].pn.classList.add(pref.script_prefix+"_hiddenWOF"):t[r].pn.classList.remove(pref.script_prefix+"_hiddenWOF"))},postFilter:function(e,t,n,r,a,s){var i=pref.postFilter.use||s?pref_func.merge_obj5a(t,s||pref.postFilter.obj7,null):null,o=e.pref.filter.postFilter.use||r?pref_func.merge_obj5a(t,r||a||e.pref.filter.postFilter.obj7,i):i;if(o)for(var l=0;l<n.length;l++)for(var p=0;p<o.length;p++){var c=o[p];if(c.use!==!1&&(!c.boards||c.boards.indexOf(t.board.slice(1,-1))!=-1)&&_e.kwd_1({use:!0,__proto__:c},n[l],t.domain)){var _=n[l].pn;if(!_)continue;r?(c.hide&&_.classList.remove(pref.script_prefix+"_hiddenAuto"),c.style&&("."===c.style[0]?_.classList.remove(c.style.slice(1)):_.removeAttribute("style",c.style))):(c.hide&&_.classList.add(pref.script_prefix+"_hiddenAuto"),c.style&&("."===c.style[0]?_.classList.add(c.style.slice(1)):_.setAttribute("style",c.style)))}}}}),cataLog.format_html=ae,common_func.Object_defProps(G.prototype,{view_update_draw_merged:function(e){if(this.pref[this.mode].mark_new_posts){var t=this.merge_bases.bases[e.key],n=t?t.lths.map(function(e){return e.watched&&this.get_mark_time(e.key)},this).reduce(function(e,t){return t>e?t:e}):786432&this.threads[e.key][19][0]&&this.get_mark_time(e.key);n>0&&site2[e.domain].mark_newer_posts2(e.posts,n,"thread"===this.mode&&pref.thread_reader.unmark_on_hover,!0)}},view_update_draw:function(e,t){if(this.pref[this.mode].mark_new_posts&&786432&this.threads[e][19][0]){var n=this.get_mark_time(e);0===n&&"thread"===this.view&&(n=site2.DEFAULT.check_reply.get_checked_time(this.threads[e][19])),n>0&&site2[this.threads[e][16].domain].mark_newer_posts2(t,n,"thread"===this.mode&&pref.thread_reader.unmark_on_hover,!0)}},view_update:function(e){if(this.threads[e][16].posts){var t=this.pref[this.mode].mark_new_posts&&786432&this.threads[e][19][0]?this.get_mark_time(e):0;0===t&&(t=1/0),site2[this.threads[e][16].domain].mark_newer_posts2(this.threads[e][16].posts,t,"thread"===this.mode&&pref.thread_reader.unmark_on_hover,!1)}},view_time_filter_changed:function(e){if("page"===this.view||"thread"===this.view)if(e)this.view_update(e);else for(e in this.threads)this.view_update(e)}}),G.prototype.get_watch_time_of_a_thread=function(e,t,n,r){var a=this.pref.filter,s=this.get_mark_time(e,r);return r&&s<0?-s:n&&s>n?0:!a.time_watch&&a.time_watch_creation&&s>t?0:s},common_func.Object_defProps(G.prototype,function(){function e(e){var t=parseInt(e.substr(e.lastIndexOf("/")+2),10);return 0===t?{8:[void 0,void 0,void 0,void 0,void 0],__proto__:I}:{8:[-t,-t,-t,-t,-t],__proto__:I}}function t(t){return":"===t[0]?m[t]||e(t):g[t]}function n(e,n,r){for(var a=v;a<b&&n(t(r[a]));)a++;n(e)?b=a:v=a}function r(e,r){var a=r.idxs;g=r.threads,m=r.threads_odl,v=0,b=a.length;var s=r.order,i=t(e);"dont_care"!==s.sticky&&n(i,"last"===s.sticky?E.sticky_last:E.sticky_first,a),s.reply_to_me&&n(i,E.reply_to_me,a),s.reply&&n(i,E.reply,a),"dont_care"!==s.watch&&n(i,"last"===s.watch?E.watch_last:E.watch_first,a),w=A[s.ordering%6],k=w(i[8]);for(var o=s.ordering>=5&&s.ordering<11?A.c0:A.c1,l=v;l<b&&o(t(a[l])[8]);)l++;if(l==a.length?a[a.length]=e:a.splice(l,0,e),pref.test_mode[148]){var p=r.merge_bases.bases[e];p&&(p.reorder_req|=5)}return l}function a(e,t,n,r,i,p){if((pref.test_mode[169]||pref.test_mode[172])&&!p){var c=n?[]:t.idxs,_=e.slice(),d=i&&Object.keys(i).reduce(h,{}),v=a(e,t,n,r,i,!0);return f(v,t.idxs_single,t,t.loose_check,c,_,n,r,d),v}if(!r&&!pref.test_mode[169]&&pref.test_mode[148])for(var b=t.merge_bases.bases,y=0;y<e.length;y++){var k=b[e[y]];k&&(k.reorder_req|=5)}g=t.threads,m=t.threads_odl;var x=t.order;T=E.funcs_lvl(x),w=A[x.ordering%6];var C=x.ordering>=5&&x.ordering<11?A.c0:A.c1,N=x.ordering>=5&&x.ordering<11?A.c0b:A.c1b,I=!pref.test_mode[171]||x.ordering>=6?C:N;if(!(1!==e.length||pref.test_mode[175]||i&&0!==Object.keys(i).length))return s(t.idxs,e[0],I,x.ordering<6);if(pref.test_mode[173])return n||r?u(e,null,t):u(t.idxs,e,t,i);if(n)return pref.test_mode[176]?l(e,N):u(e,null,t);if(1===e.length)return o(t.idxs,e,I,i||!0);if(!pref.test_mode[174])return o(t.idxs,u(e,null,t),I,i||!0);for(var j=[];e.length>0;)j[j.length]=l(e.splice(0,8),N);for(;j.length>1;){for(var B=0;j.length>B+1;)o(j[B],j.splice(B+1,1)[0],C),B++;j.length>B&&o(j[B-1],j.splice(B,1)[0],C)}return o(t.idxs,j[0],I,i||!0)}function s(e,n,r,a){var s=-1,i=T[7]||function(){return 0},o=t(n),l=0|i(o);k=w(o[8]);for(var p=a?0:e.length-1,c=a?e.length:-1,_=a?1:-1;p!=c;){var d=e[p];if(s!=-1||d!==n){var u=t(d),f=0|i(u);if(a^!(l==f&&!r(u[8])||l>f))break;p+=_}else s=p,p+=_}if(s===-1)(s=a?e.indexOf(n,p+1):e.lastIndexOf(n,p-1))===-1&&(s=e.length,a||p++);else if(p-=_,s===p)return e;if(p<s)for(var h=s;h>p;h--)e[h]=e[h-1];else for(var h=s;h<p;h++)e[h]=e[h+1];return e[p]=n,x=p<s?p:s,e}function i(e,t,n){if(0==e.length||!n&&0==t.length)return-1;if(!n&&1==t.length){var r=e.indexOf(t[0]);return r!=-1&&e.splice(r,1),r}n&&n!==!0||(n=t.reduce(h,{}));for(var a=-1;++a<e.length&&!(e[a]in n););if(a==e.length)return-1;r=a;for(var s=a;++a<e.length;)e[a]in n||(e[s++]=e[a]);return e.length=s,r}function o(e,n,r,a){if(0==e.length)return n;var s=a?i(e,n,a):-1;N=T[7],0!=e.length&&(N(t(e[0]))||N(t(n[0])))||(N=0);var o=1;if(pref.test_mode[180]){e=Array(n.length).concat(e),C=0;for(var l=p(e,n[0],n.length,r),_=C-1;o<n.length;)l=p(e,n[o++],l,r)}else{for(var l=c(e,n[0],0,r),_=l;++l<e.length&&o<n.length;)l=c(e,n[o++],l,r);for(;o<n.length;)e[l++]=n[o++]}return x=s>0&&s<_?s:_,e}function l(e,t){for(var n=[e[e.length-1]],r=e.length-2;r>=0;r--)N=T[7],c(n,e[r],0,t);return n}function p(e,n,r,a){var s=t(n),i=N&&0|N(s);for(k=w(s[8]);r<e.length;){var o=e[r],l=t(o),p=N&&0|N(l);if(i!=p){if(!(i<p))return N=T[i],e[C++]=n,r;for(e[C++]=o;++r<e.length&&i<(0|N(t(e[r])));)e[C++]=e[r];N=T[i]}else{if(!a(l[8]))return e[C++]=n,r;e[C++]=o,r++}}return e[C++]=n,r}function c(e,n,r,a){var s=t(n),i=N&&0|N(s);for(k=w(s[8]);r<e.length;){var o=t(e[r]),l=N&&0|N(o);if(i!=l){if(!(i<l))return N=T[i],e.splice(r,0,n),r;for(;++r<e.length&&i<(0|N(t(e[r]))););N=T[i]}else{if(!a(o[8]))return e.splice(r,0,n),r;r++}}return e[r]=n,r}function _(e,t){return t[0]-e[0]||e[1]-t[1]||e[2]-t[2]}function d(e,t){return t[0]-e[0]||t[1]-e[1]||e[2]-t[2]}function u(e,n,r,a){var s=T[7]||function(){return 0},i=r.order.ordering>=5&&r.order.ordering<11?_:d,o=function(e,n){return[0|s(t(e)),w(t(e)[8]),n,e]};if(a&&(e=e.filter(function(e){return!(e in a)})),n){var l=!pref.test_mode[171]||r.order.ordering%4>=2?e.length:-n.length;a=n.reduce(function(e,t,n){return e[t]=n+l,e},{})}var p=e.map(n?function(e,t){var n=a[e];return o(e,n?(a[e]=t,n):t)}:o);return(n?l<0?n.reduce(function(e,t){var n=a[t];return n<0&&(e[e.length]=o(t,n)),e},[]).concat(p):n.reduce(function(e,t){var n=a[t];return n>=l&&(e[e.length]=o(t,n)),e},p):p).sort(i).map(function(e){return e[3]})}function f(e,t,n,r,s,i,o,l,p){var c=u(s.slice(),i,n,p);t&&e.length!==t.length&&console.log("ERROR: check_bulk: length: bulk:"+e.length+", single:"+t.length),e.length!==c.length&&console.log("ERROR: check_bulk: length: bulk:"+e.length+", ref:"+c.length);for(var _=0,d=0;d<e.length;d++)(!t||e[d]===t[d]||r&&w(n.threads[e[d]][8])==w(n.threads[t[d]][8]))&&e[d]===c[d]||_++<10&&(console.log("ERROR: idx_reorder_exe: "+d+", bulk:"+e[d]+": "+w(n.threads[e[d]][8])+(t&&e[d]!==t[d]?", single:"+t[d]+": "+w(n.threads[t[d]][8]):"")+", ref:"+c[d]+": "+w(n.threads[c[d]][8])),e.length);_>10&&console.log("Bailed out, too many errors. "+_+"/"+e.length),_>0&&a(i,{idx:s,__proto__:n},o,l,p,!0)}function h(e,t){return e[t]=null,e}var m,g,v,b,y,w,k,x,C,T,N,I={8:[0,0,0,0,0],19:[0,0,0]},E={reply_to_me:function(e){return 67895296&e[19][0]&&e[19][1]>>16!=0&&3},reply:function(e){return 67895296&e[19][0]&&0!=e[19][1]&&2},watch_first:function(e){return 67895296&e[19][0]&&1},watch_last:function(e){return!(67895296&e[19][0])&&1},sticky_first:function(e){return e[20]&&4},sticky_last:function(e){return!e[20]&&4},both_cascade:function(e,t,n){return e&&n?function(t){return(0|e(t))+(0|n(t))}:t||n||0},cascade:function(e,t){return e&&t?function(n){return e(n)||t(n)}:e||t||0},funcs_lvl:function(e){for(var t=[0,this["watch_"+e.watch]||0,e.reply&&this.reply,e.reply_to_me&&this.reply_to_me,this["sticky_"+e.sticky]],n=t[4],r=2;r<4;r++)t[r]=this.cascade(t[r],t[r-1]);for(var r=5;r<8;r++)t[r]=this.both_cascade(n,t[4],t[r%4]);return t}},A={0:function(e){return e[0]||e[4]},4:function(e){return e[4]||e[0]},get 5(){return y=H.ts_refresh,this.f5},f5:function(e){return(y-e[1])/e[2]},1:function(e){return e[1]},2:function(e){return e[2]},3:function(e){return e[3]},c0:function(e){return k>=w(e)},c1:function(e){return k<=w(e)},c0b:function(e){return k>w(e)},c1b:function(e){return k<w(e)}};return{idx_raise_odl:function(e){var t=this.idxs.indexOf(e.key)
;if(t!=-1)for(var n=":DL:"+e.domain+e.board;++t<this.idxs.length;)if(0===this.idxs[t].indexOf(n)){this.threads_odl[this.idxs[t]]={8:[e.time_posted||e.time_bumped,e.time_created,e.nof_posts,e.nof_files,e.time_bumped||e.time_posted],__proto__:I},r(this.idxs.splice(t,1)[0],this);break}},idx_delete_odl:function(e){for(var t=0;t<e.length;t++)delete this.threads_odl[":DL:"+e[t]]},idx_insert_odl:function(e){delete this.threads_odl[":DL:"+e],this.idx_reorder(":DL:"+e)},idx_re_sort:function(e,t){var n=this.idxs.filter(function(e){return":"===e[0]});if(pref.test_mode[169])var r=this.idxs.slice();var s=this.idxs;this.idxs=[];var o={},l=this.pref[this.mode].hide_unwatched;if(pref.test_mode[168]||pref.test_mode[169])if(t)for(var p=s.length-1;p>=0;p--)":"!==s[p][0]&&this.idx_re_sort_sub(l,s[p],o);else for(var p in this.threads)this.idx_re_sort_sub(l,p,o);if(!pref.test_mode[168]){if(pref.test_mode[169]&&(s=r),t?i(s,n):s=Object.keys(this.threads),l){var o=s.filter(function(e){return!this.threads[e][16].lth.watched_p},this);i(s,o)}s.length>0&&(this.idxs=a(s,pref.test_mode[169]?{idxs:r,idxs_single:this.idxs,loose_check:!0,__proto__:this}:this,t||pref.test_mode[173]||!pref.test_mode[176],null,!0))}l&&this.func_hide_all(o),this.idxs=this.idxs.concat(n),this.show_catalog(e||0)},idx_re_sort_sub:function(e,t,n){!e||this.threads[t][16].lth.watched_p?r(t,this):n[t]=this.threads[t]},idx_rm_reorder_exe:function(){if(!pref.test_mode[168]&&0!==this.idxs_req.size){if(pref.test_mode[173])var e=this.idxs;var t=[],n={},r=Object.create(n),s=Object.create(pref.test_mode[173]?null:r),o=this.idxs_req;for(var l of o.keys()){var p=o.get(l);p>0?(t[t.length]=l,p>1?n[l]=null:r[l]=null):s[l]=null}if(pref.debug_mode[39]){for(var c=[],l=0;l<this.idxs.length;l++){var _=this.idxs[l];_ in this.threads||_ in s&&!(_ in r)||c.push(_)}c.length>0&&(console.log("ERROR: idx_rm_reorder_exe: ",c),console.trace(),console.log(s,r,t,this.idxs_req))}if(this.idxs_req.clear(),0===t.length)var d=i(pref.test_mode[169]?this.idxs_bulk:this.idxs,null,s);else var u=a(t,pref.test_mode[169]?{idxs:this.idxs_bulk,idxs_single:this.idxs,__proto__:this}:this,!1,!1,s);if(pref.test_mode[169]&&(this.idxs_bulk=null),0===t.length)return[d,null];if(pref.test_mode[169]||(this.idxs=u),!pref.test_mode[173])return[x,r,n];for(var f=this.drawn_idx===!0?e.length:this.drawn_idx,h="page"===this.view||"thread"===this.view,l=0;l<f&&!(e[l]!==u[l]||h&&u[l]in s);l++);return[l,r,n]}},idx_reorder:function(e,t,n){if(!this.pref[this.mode].hide_unwatched||this.threads[e][16].lth.watched_p){if(!pref.test_mode[168]){pref.test_mode[169]&&!this.idxs_bulk&&(this.idxs_bulk=this.idxs.slice());var s=this.idxs_req.get(e);if(void 0!==s&&this.idxs_req.delete(e),this.idxs_req.set(e,s|(t?3:1)),this.dirty|=2,!pref.test_mode[169])return this.idxs.length}if(pref.test_mode[168]||pref.test_mode[169]){if(pref.test_mode[169]&&!n)var i=this.idxs.slice();var o=this.idxs.indexOf(e);o!=-1&&this.idxs.splice(o,1);var l=r(e,this);l===o&&"page"!==this.view&&"thread"!==this.view||!(this.drawn_idx===!0||l<this.drawn_idx||o!=-1&&o<this.drawn_idx)||(this.drawn_idx=0)}if(!pref.test_mode[168]&&!n&&pref.test_mode[169]){var p={idxs:i,idxs_single:this.idxs,__proto__:this};a([e],p),void 0!==x&&x!==l&&x!==o&&p.idxs.indexOf(e)!==l&&console.log("ERROR: idx_reorder: bulk:"+x+", single:"+l+", "+o)}return l}},idx_remove:function(e){if(pref.test_mode[169]&&!this.idxs_bulk&&(this.idxs_bulk=this.idxs.slice()),pref.test_mode[168]||pref.test_mode[169]||pref.test_mode[181]){var t=this.idxs.indexOf(e);if(t>=0&&this.idxs.splice(t,1),pref.test_mode[168]||pref.test_mode[181])return}this.idxs_req.has(e)&&this.idxs_req.delete(e),this.idxs_req.set(e,0),this.dirty|=4},idx_refresh:function(e){var t=this.pref.INST.safety.hide?-1:0;this.order.ordering%6==5?this.idx_re_sort(t,!0):e===this&&t&&this.show_catalog(t)},idx_idxMergeAll:7,idx_insert_bulk:a}}());var se=function(){function e(e,r,s,i){var l=y(e,r,"hover",null,i);if(l){l.style.position="fixed",l.style.top="0px",l.style.right="0px",s?l.style.display="none":l.style.zIndex=pref[o].thumbnail.hover.popup_zIndex,l.style.pointerEvents="none";var p={pn:l,tn:e,loaded:!1};l.draggable=!0,l.ondragstart=m,l.onclick=h,l.onmousemove=t;var c=pref[o].thumbnail.hover;return c.zoom_dblC&&(l.ondblclick=a),c.zoom_mW&&(l["on"+brwsr.mousewheel]=cnst.div_scroll),l.onload=n.bind(p),l.onerror=httpd.pause_cancel,httpd.pause_req(),site.script_body.appendChild(l),p}}function t(e){0===e.movementX&&0===e.movementY||(A=!0)}function n(e){httpd.pause_cancel(),I&&e.target===I.pn?s():this.loaded=!0}function r(t,n){if(!(pref.test_mode[163]&&pref[o].thumbnail.inline.stopHover&&"4chan"===site.nickname&&t.target.classList.contains("expanded-thumb"))){var r=t.target;if(pref[o].image_hover){if(I&&I.tn===r&&pref[o].thumbnail.hover.zoom_over)return;var a=I;if(E&&E.tn===r)I=E,I.pn.style.display="",I.pn.style.zIndex=pref[o].thumbnail.hover.popup_zIndex,I.loaded&&s();else{if(!(I=e(r,n,null,t)))return;E&&E.pn.remove()}t.preventDefault(),a&&a.pn.remove(),A=!1}if(pref[o].image_prefetch){var i=site2[site.nickname].get_next_image(r);E=i?e(i,null,!0):null}else E=null}}function a(e){"dblclick"!==e.type&&e&&I&&(e.target===I.pn||e.target===I.tn)||(I&&I.pn.remove(),I=null)}function s(){var e=(pref[o].thumbnail.hover,I.pn);if(i(e)){e.style.cursor="zoom-in",pref[o].thumbnail.hover.zoom_over&&(e.style.pointerEvents=null);var t=I.tn;t.style.cursor="zoom-in",t.addEventListener("mouseout",p,!1),t.addEventListener("click",l,!1)}}function i(e){var t=pref[o].thumbnail.hover,n=e.style;return t.limit_width&&e.naturalWidth>parseInt(n.maxWidth,10)||t.limit_height&&e.naturalHeight>parseInt(n.maxHeight,10)}function l(e){pref[o].thumbnail.hover.zoom_click&&(h({target:I.pn,clientX:document.documentElement.clientWidth,clientY:0}),I.pn.style.pointerEvents=null,e.preventDefault(),e.stopPropagation())}function p(e){var t=e.currentTarget;t.removeEventListener("mouseout",p,!1),t.removeEventListener("click",l,!1),t.style.cursor=null}function c(e){return document.documentElement.clientWidth-pref[o].thumbnail[e].margin_width}function _(e){return document.documentElement.clientHeight-pref[o].thumbnail[e].margin_height}function d(e){var t=e.naturalWidth/(parseInt(e.style.maxWidth,10)||c("hover")),n=e.naturalHeight/(parseInt(e.style.maxHeight,10)||_("hover"));return t>n?t:n}function u(e,t,n,r){if(!t.top){t=e.target.parentNode.parentNode.style;var a=e.target.offsetTop,s=e.target.offsetLeft}t.top=(r?0:parseInt(t.top,10)*n+((a||0)-e.clientY)*(n-1))+"px",t.right=(r?0:parseInt(t.right,10)*n-(document.documentElement.clientWidth-(s||0)-e.clientX)*(n-1))+"px"}function h(e){var t=e.target,n=t.style;if("zoom-in"===n.cursor||"zoom-out"===n.cursor){var r="zoom-in"===n.cursor;u(e,n,r?d(t):1/d(t),!(!I||I.pn!==t)&&!A),n.maxWidth=r?"none":c("hover")+"px",n.maxHeight=r?"none":_("hover")+"px",n.cursor=r?"zoom-out":"zoom-in"}}function m(e){gGEH.drag.started(e,null,"move",!0)}function g(e,t,n){if(I&&pref[o].thumbnail.hover.dragfloat&&e.target===I.tn){var r=cnst.init3({func_str:"right:"+-t+"px:top:"+n+"px:ftb:overflow:hidden:Show"}),a=r.cn.appendChild(v());"VIDEO"===a.tagName&&a.play();var s=pref[cataLog.embed_mode].thumbnail.hover;s.df_dblC&&(r.cn.ondblclick=cnst.tb_funcs.evfunc_factory(r,"exit")),s.df_mW&&(r.pn["on"+brwsr.mousewheel]=cnst.div_scroll)}}function v(){var e=I.pn,t=e.style;return t.position=null,t.pointerEvents=null,t.zIndex=null,t.top=null,t.right=null,e.onmouseover=null,e.ondblclick=null,e["on"+brwsr.mousewheel]=null,e.ondragstart=null,e.onmousemove=null,I=null,e}function b(e,t,n){var r=gGEH.get_key_recursive(e);if(n||!pref[o].env.event_dynamic||void 0===t||("inline"===t?!pref[o].env.expand_thumbnail_inline_native:!pref[o].env.image_hover_native)){if(!r&&pref.test_mode[106]&&pref.test_mode[107])return e.src;var a=pref.catalog.mimic_base_site?site.nickname:Z[r][16].domain_html,s=site2[a].general_event_handler[site.whereami].image_hover_check_mode(e);if("catalog"!==s)return site2[a].parse_funcs.post_html.img2src(e)||e.src;if("4chan"===site.nickname){var i=site2.DEFAULT.popups_posts.href2domain(e.src);return i&&site2[i].parse_funcs[s+"_html"].img2src(e)||e.src}if(r){var l=liveTag.mems.getFromName(r);return site2[l.domain].parse_funcs[l.th.type_parse].get_op_src(l.th,e)}}}function y(e,t,n,r,a){var s,i=pref[o].thumbnail[n];if(t||(t=b(e,n,r)),t){var l=0===t.search(/^blob/)?site2.DEFAULT.parse_funcs.post_html.img2ext(e):"";if(t.indexOf("data-ext")!=-1&&(l=t.slice(t.indexOf("data-ext")+10).replace(/".*/,""),t=t.replace(/".*/,"")),".webm"===t.substr(-5,5)||".webm"===l||".webm"===e.getAttribute("data-ext")){if(!(i.webm||i.webm_ctrl&&a.ctrlKey))return null;I&&I.pn.src===t?s=v():(s=document.createElement("video"),s.controls=!0,s.autoplay=!r),s.loop=i.webm_loop,s.muted=i.webm_mute}else s=e.cloneNode();return s.src=t,s.style.width="auto",s.style.height="auto",i.limit_width&&(s.style.maxWidth=c(n)+"px"),i.limit_height&&(s.style.maxHeight=_(n)+"px"),s}}function w(e,t){if(pref[o].expand_thumbnail_inline&&j.indexOf(this)==-1){var n=y(this,null,"inline",t);if(!n)return void C(this);"VIDEO"!==n.tagName&&(n.style.display="none",n.addEventListener("load",x,!1),this.style.opacity=.5),this.parentNode.insertBefore(n,this.nextSibling),j.push(n),e&&e.preventDefault(),"VIDEO"===n.tagName&&(x.call(n),t||n.play())}}function k(e){e.stopPropagation()}function x(){this.previousSibling.style.display="none",this.style.display="",this.previousSibling.style.opacity="",this.removeEventListener("load",x,!1),this.onclick=N,pref[o].thumbnail.inline.stopHover&&(this.onmouseover=k),site2[site.nickname].format_expanded_thumbnail&&site2[site.nickname].format_expanded_thumbnail(this);var e=j.indexOf(this);e>=0&&j.splice(e,1),site.patch.expand_thumbnail_inline_load&&site.patch.expand_thumbnail_inline_load.call(this),C(this)}function C(e){if(pref[o].expand_thumbnail_inline&&pref[o].expand_thumbnail_inline_all_after){var t=site2[site.nickname].get_next_image(e,f());t&&"none"!==t.style.display&&T(t)}}function T(e){var t,n=pClg.get_ref_height(pref[o].thumbnail.inline.ref_height/100);if(Array.isArray(e)){for(var r,a=f(),s=0;s<e.length;s++){var i=e[s].offsetTop;(i>=a&&i<t||0===s)&&(r=e[s],t=i)}e=r}else t=e.offsetTop;t<n?(B=null,w.call(e,null,!0)):B=e}function N(e){if(this.previousSibling.style.display="",e.preventDefault(),e.stopPropagation(),pref[o].thumbnail.inline.ondemandStop&&(B=null),this.getAttribute("data-originalWidth")){this.parentNode.parentNode.style.width=this.getAttribute("data-originalWidth")}this.parentNode.removeChild(this)}var I=null,E=null,A=!1,j=[],B=null;return{image_hover_add:r,image_hover_remove:a,image_hover_reentry:function(e){I&&I.pn.src===e.src&&(I.pn.src=b(e))},image_hover_snatch:g,expand_thumbnail_inline:w,expand_thumbnail_on_demand_kick:function(){B&&T(B)},fetch_and_reentry:function(e,t){scan.scan_ui("image_hover",{tgts:e,options:{callback:function(){cataLog.DIH.image_hover_reentry(t)},priority:6}})},expand_thumbnail_clicked_but_ineffective:function(e){pref[o].expand_thumbnail_inline_all_after&&("4chan"===site.nickname&&e.classList.contains("expanded-thumb")?pref[o].thumbnail.inline.ondemandStop&&(B=null):C(e))}}}();cataLog.DIH=se,cataLog.image_hover_reentry=se.image_hover_reentry,cataLog.InfoPv=function(){function e(e,t,n){var r=parseInt(e,10);return n&&"00"===e?"":(n?" and ":"")+r+" "+t+(1!=r?"s":"")}function t(t){var n=H.format_relative_time(t).split(/:|d/),r=n[0].slice(1);return"+"==n[0][0]?"Just now":(n[0]=n.slice(1),1===n.length?e(r,"second"):2===n.length?e(r,"munute"):3===n.length?e(r,"hour")+e(n[1],"minute",!0):e(r,"day")+e(n[1],"hour",!0))}var n=document.createElement("div");n.setAttribute("class",pref.script_prefix+"_infoPv"),n.style.position="absolute";var r=!1;return{show:function(e){var a=gGEH.get_key_recursive(e.target),s=e.target.getBoundingClientRect(),i=document.documentElement.clientWidth,o=e.clientX-.5*i<0;n.style.left=o?s.right+5+"px":null,n.style.right=o?null:i-s.left+5+"px",n.style.top=s.top+window.scrollY+(pref.test_mode[143]?100:0)+"px";var l=liveTag.mems.getFromName(a).th,p=l.posts.length>=2||l.last_no,c=l.posts.length>=2&&l.posts[l.posts.length-1].name||l.last_name,_=Date.now();n.innerHTML=(l.sub?'<span class="post-subject">'+l.sub+"</span>":"Posted")+' by <span class="post-author">'+l.name+'</span> <span class="post-ago">'+t(l.time_created-_)+' ago</span><span class="post-page">Page '+gClg.AllThreads[a][14]+"</span>"+(p?'<div class="post-last">Last reply by <span class="post-author">'+c+'</span> <span class="post-ago">'+t(l.time_posted-_)+" ago</span></div>":""),r||site.script_body.appendChild(n),r=!0},hide:function(){r&&(site.script_body.removeChild(n),r=!1)}}}(),G.prototype.click_thread=function(e,t){t?u("force"===t?null:t,e,this):"open"===pref[this.mode].click?u(null,e,this):"catalog"!==Z[e][18]&&"expand"===pref[o].click&&_(e)},G.prototype.get_mark_time=function(e,t){var n=this.pref.filter,r=pref_func.merge_obj5(e,n.watch_list_obj2,null);return r&&"time"in r?t?-r.time:r.time:(r=pref_func.merge_obj5(e,n.list_obj2,null),r?r.time||0:(n.time_watch||n.time_watch_creation)&&""!==n.time_str?Date.parse(n.time_str):0)},G.prototype.mark_read_thread=function(e,t,n){var r=liveTag.mems.getFromName(e);null!==t?site2.DEFAULT.check_reply.set_watched_to_last(r.wt,t,e,n):site2.DEFAULT.check_reply.set_unwatch(r.wt),liveTag.dirtify_ur(r),pref.liveTag.style.use&&liveTag.update_ur(r,0,!0),this.footer.update_force(e,this.pref[this.mode].footer.flag),pref.notify.favicon&&notifier.favicon.set(Z)};var ie,oe={rolledup:0,show_catalog:function(e,t,n){var r=this.drawn_idx,a=0;if(this.dirty){if(6&this.dirty){var s=this.idx_rm_reorder_exe();s[0]<this.drawn_idx&&this.func_track_reset();var i=s[1],l=16&this.dirty?null:s[2]&&Object.keys(s[2])}1&this.dirty&&(this.footer.clean_idx=0),this.dirty&=-16}if(this.rolledup)return void(this.rolledup=2);if(0===e||e===-1){var p=e===-1;this.drawn_idx=0,e=void 0}if(pref.debug_mode[11])var c=h(this.drawn_idx,this.drawn_y,this.ref_count,this.idxs);pref.test_mode[23]&&(this.drawn_idx=0);var _=pref[o].draw_on_demand&&this.permit_draw_on_demand;if(_){var d=this.get_ref_height(pref[cataLog.embed_mode].merge?4:this.disp_th20?.2:this.disp_th100?1:1.5);if(0!==this.drawn_idx&&this.drawn_y>=d)if(this.ppn.offsetTop+this.ppn.offsetHeight<this.drawn_y)this.drawn_y=-1;else if(void 0===e&&void 0===l)return!0}var u=_&&pref.network.adaptive,f=0;pref[o].scroll_lock&&this.show_catalog_scroll_lock.set(),this.observer_myself&&this.observer_myself.disconnect();var g;if("string"==typeof e)g=i||{},g[e]=null;else if(g=i||e,e&&i)for(var v in e)g[v]=e[v];var b=g?Object.keys(g).length:-1,y="float"===o&&pref.catalog_expand_with_hr||pref[o].env.disp_filler;if(void 0!==g)for(var v=0;v<this.drawn_idx;v++)if(this.idxs[v]in g){this.drawn_idx=v,this.drawn_y=-1;break}this.ref_count_init=pref[o].env.disp_offset,y&&(this.ref_count_init=m(this.ref_count_init));var w=this.func_lazy_draw,k=!(!w||!this.pref[this.mode].merge_list||this.pref[this.mode].merge)&&null,x=null===k&&(!pref.test_mode[183]||16&this.dirty||n),C=void 0===g||!_||!pref.test_mode[132]&&(!pref.test_mode[151]||1!==b);(void 0!==g&&C||0===this.drawn_idx||this.drawn_idx===!0)&&(this.func_track_reset(),w&&(C=!0));for(var T=0,N="",I=this.drawn_idx,E="catalog"===this.view?pref.proto.lazyDraw.step:pref.proto.lazyDraw.merge_step,A=Math.floor(d*this.lazy_avgSizeInv)+E,j=this.footer.clean_idx,v=-1;++v<this.idxs.length;){var B=this.idxs[v],S=this.threads[B];if(":DL:"===B.substr(0,4)){if(""===N){N=B,this.load_on_demand_try_load([N.substr(4)])&&this.idxs.splice(v,1);break}}else{if(_&&this.drawn_y>=d&&(!t||b<=0)){if(k===!1||!x){if(!p)break;S[1]&&this.func_hide(B,y)&&(S[1]=!1);continue}if(null===k){if(pref.test_mode[183]&&l&&l.length>=0)if(v+l.length>=this.idxs.length)l=null;else var L=v,O=l.length;k=v+1,u=!1}if(pref.test_mode[183]&&O>=0&&(v=L,B=--O>=0?l[O]:this.idxs[v],S=this.threads[B]),a++,!this.merge_bases.isShownForTails(B)){p&&S[1]&&this.func_hide(B,y)&&(S[1]=!1);continue}}if(v>=I)if(C||0===b||B in g||k){var D=this.filter_test(B,S);if(!D||"page"!==this.view&&"thread"!==this.view||pref.test_mode[52]||(D=ae.replace_posts_by_search(S,this.pref)),D){if(S[0]&&!S[16].th||(this.insert_thread_prepare_html_lazy(S,!S[0],!1,!0,null),u&&(!t||b<=0)&&(++f==pref.network.th100?(d=this.get_ref_height(1),this.disp_th100||(this.disp_th100=setTimeout(function(){this.disp_th100=null,this.show_catalog()}.bind(this),pref.network.th100_delay))):f===pref.network.th20&&(d=this.get_ref_height(.2),this.disp_th20||(clearTimeout(this.disp_th100),this.disp_th100=null,this.disp_th20=setTimeout(function(){this.disp_th20=null,this.show_catalog()}.bind(this),pref.network.th20_delay)),u=!1))),this.footer.draw(S,B),k&&!this.func_check_overrated(B)){this.func_search_ref_idx(B,null,!0),S[1]||(S[1]=!0);continue}var R;if(void 0!==g||w){g&&pref.test_mode[132]&&w&&this.func_check_reorder(B,v);for(var U=(w?this.func_search_ref_idx(B,v):v)-1;U>=0&&(":DL:"===this.idxs[U].substr(0,4)||!this.threads[this.idxs[U]][1]||w&&this.func_search_ref(this.idxs[U]));)U--;U>=0?(R=this.threads[this.idxs[U]][0].nextSibling,y&&R&&(R=R.nextSibling)):R=this.ppn.childNodes[this.ref_count_init]}else R=this.ppn.childNodes[this.ref_count];if(R===S[0]&&S[1]||this.func_show(B,R,y)&&(S[1]=!0),S[1]){var M=_&&C&&this.drawn_y<d&&T>=A;x|=this.func_track_shown(B,M,v),M&&(A+=E,C&&pref.test_mode[150]&&(this.lazy_avgSizeInv=this.drawn_y>0?T/this.drawn_y:0,A=Math.max(A,Math.floor(d*this.lazy_avgSizeInv)+E)))}}else S[1]&&this.func_hide(B,y)&&(S[1]=!1);g&&B in g&&b--}else v>=j&&S[1]&&this.footer.draw(S,B);else v>=j&&S[1]&&this.footer.draw(S,B);S[1]&&(w&&this.func_search_ref(B)||(T+="catalog"===this.view||"headline"===this.view?1:S[16].posts.length))}}if(k&&(v=k-1),(C||0==b&&r<v)&&(this.drawn_idx=!_||v==this.idxs.length||(v<I?I:v)),this.footer.clean_idx=v,w&&this.func_lazy_draw(),this.observer_myself&&this.observer_myself.observe(),this.dirty=0,pref.test_mode[184]&&console.log("show_catalog: "+a+"/"+(l&&l.length)+" at "+L+"/"+this.idxs.length),pref.debug_mode[11]&&"thread"!==o&&!pref[o].merge){for(var z=-1,H=0,F=0;F<v;F++)if("O"!==this.idxs[F][0]&&this.threads[this.idxs[F]][1]){var P,q,W=common_func.fullname2dbt(this.idxs[F]);if("page"===o&&"4chan"===site.nickname?(P=this.ppn.getElementsByClassName("CatChan_thread")[H++],q=site.board+P.id.substr(1)):"page"===o&&"8chan"===site.nickname?(P=this.ppn.getElementsByClassName("CatChan_thread")[H++],q="/"+P.getAttribute("data-board")+"/"+P.id.substr(7)):(P=this.ppn.childNodes[pref[o].env.disp_offset+H++],q="page"===o?"/"+P.getAttribute("data-board")+"/"+P.id.substr(7):P.getElementsByTagName("a")[0].getAttribute("href").replace("res/","").replace(".html","").replace(/.*lainchan.org/,"").replace(/.*8kun.top/,"").replace("thread/","").replace(/.*4chan.org/,"").replace(/.*meguca.org/,"").replace(/.*krautchan.net/,"").replace(/thread\-/,""),"4chan"===W[0]&&"catalog"===o&&(q=q.substr(0,q.lastIndexOf("/")))),W[1]+W[2]!==q){for(var G="",U=F+1;U<F+5;U++)G+=this.idxs[U]+", ";console.log("ERROR: "+F+", "+q+", "+this.idxs[F]+": "+v+", "+G),z=v}}var K=h(this.drawn_idx,this.drawn_y,this.ref_count,this.idxs);if(z!=-1){console.log("PREV: "+ie),console.log("IN:   "+c);for(var v=0;v<z+5;v++)this.ppn.childNodes[v]&&console.log(this.ppn.childNodes[v]);console.log("OUT:  "+K)}ie=K}if(pref.debug_mode[36]&&(debugWindow&&!this.debug&&(this.debug=debugWindow.connect()),this.debug)){for(var v=-1,Y=-1,J=null,X=null;++v<this.idxs.length;)if(this.threads[this.idxs[v]]){if(J=this.footer.test_dirty(this.idxs[v]))break;X=this.threads[this.idxs[v]][24]||X,Y=v}this.debug.innerHTML=this.name+":<br>drawn_idx: "+this.drawn_idx+"<br>drawn_y: "+this.drawn_y+"<br>last_clean_footer: "+this.idxs[Y]+", offsetTop: "+(X&&X[0].parentNode.offsetTop)+"<br>first_dirty_footer: "+this.idxs[v]+", offsetTop: "+(J&&J[0].parentNode.offsetTop)}},func_show:function(e,t){return this.ppn.insertBefore(this.threads[e][0],t&&t.parentNode===this.ppn?t:null),!0},func_hide:function(e){return this.ppn.removeChild(this.threads[e][0]),!0},func_hide_all:function(e){var t="float"===this.mode&&pref.catalog_expand_with_hr||pref[this.mode].env.disp_filler;if(Array.isArray(e))for(var n=0;n<e.length;n++){var r=this.threads[e[n]];r[1]&&this.func_hide(e[n],t)&&(r[1]=!1)}else for(var a in e){var r=e[a];r[1]&&this.func_hide(a,t)&&(r[1]=!1)}},func_track_shown:function(e,t){t&&(this.drawn_y=this.threads[e][0].offsetTop),this.ref_count+=this.ref_step},func_track_reset:function(){this.ref_count=this.ref_count_init,this.drawn_y=-1,this.drawn_idx=0},permit_draw_on_demand:!0,ref_step:1,drawn_y:-1,ref_count:0,ref_count_init:0,dirty:17,lazy_avgSizeInv:0};common_func.Object_defProps(G.prototype,oe);var le=oe;"page"===o&&site2[site.nickname].all_boards&&site2[site.nickname].all_boards.indexOf(site.board)!=-1?le={func_show:function(e){var t=this.threads[e][0];return!(!t.previousSibling||"H2"!==t.previousSibling.tagName)&&(t.previousSibling.style.display="",t.style.display="",!0)},func_hide:function(e){var t=this.threads[e][0];return!(!t.previousSibling||"H2"!==t.previousSibling.tagName)&&(t.previousSibling.style.display="none",t.style.display="none",!0)},permit_draw_on_demand:!1,__proto__:oe}:pref[o].env.disp_filler?le=function(e){return{func_show:function(e,t){var n=this.threads[e][1]&&this.threads[e][0].nextSibling||this.filler.cloneNode(!1);return this.ppn.insertBefore(this.threads[e][0],t),this.ppn.insertBefore(n,t),!0},func_hide:function(e){return this.ppn.removeChild(this.threads[e][0].nextSibling),this.ppn.removeChild(this.threads[e][0]),!0},ref_step:2,filler:e,__proto__:oe}}("<"===pref[o].env.disp_filler[0]?document.createElement("hr"):document.createTextNode(pref[o].env.disp_filler)):"float"===o&&pref.catalog_expand_with_hr&&(le={func_show:function(e,t){return this.threads[e][1]&&g(e,"remove"),this.ppn.insertBefore(this.threads[e][0],t&&t.parentNode===this.ppn?t:null),g(e,"add"),!0},func_hide:function(e){return g(e,"remove"),this.ppn.removeChild(this.threads[e][0]),!0},func_track_shown:function(e,t){this.__proto__.func_track_shown.call(this,e,t),this.ref_count=m(this.ref_count)},__proto__:oe}),common_func.Object_defProps(pClg,le);var pe=pClg.show_catalog.bind(pClg);cataLog.show_catalog=pe,cataLog.catalog_obj2=pClg,G.prototype.load_on_demand_timer=null,G.prototype.load_on_demand_release=function(){null!==this.load_on_demand_timer&&clearTimeout(this.load_on_demand_timer),this.load_on_demand_timer=null},G.prototype.load_on_demand_try_load=function(e){return!!this.load_on_demand_try_get_mutex()&&(this.idx_delete_odl(e),ee.scan_init("on_demand_load",e,{refresh:this,crawler_max:1,callback:this.load_on_demand_release_draw.bind(this)}),!0)},G.prototype.load_on_demand_release_draw=function(){this.load_on_demand_release(),this.show_catalog()},G.prototype.load_on_demand_try_get_mutex=function(){return null===this.load_on_demand_timer&&(this.load_on_demand_timer=setTimeout(this.load_on_demand_release.bind(this),1e3*pref.proto.load_on_demand_timeout),!0)},G.prototype.view_attr_changed=function(){for(var e in this.threads)this.view_attr_set(e)};var ce=new WeakMap;G.prototype.view_attr_set=function(e,t,n,r,a){var s=this.threads[e],i=this.pref.filter,o=r||s[0],l=null;if(i.attr_list){var p;pref.common.blur_404&&(p=i.watch_list_obj2[e])&&(p=p.cmd)&&p.PRUNED&&"thread"!==this.mode&&!this.noBlur&&(l={style:{opacity:.4}}),pref.catalog.style_general_list&&(l=pref_func.merge_obj5(e,pref.catalog.style_general_list_obj2,l)),i.attr_list&&(l=pref_func.merge_obj5(e,i.attr_list_obj2,l))}if(o){var c=ce.get(o);if(!a&&l&&l.style){c||(c={});for(var _ in l.style)_ in c||(c[_]=o.style[_]),o.style[_]=l.style[_];ce.set(o,c)}if(c)for(var _ in c)l&&l.style&&_ in l.style||(void 0===c[_]?delete o.style[_]:o.style[_]=c[_],delete c[_])}if(!t&&(l&&l.cmd||s[20]||s[16].show_always||s[16].icon_sticky||s[16].icon_show_always||s[16].systemSticky)){var d=!!(l&&l.cmd&&void 0!==l.cmd.STICKY?l.cmd.STICKY:s[16].systemSticky);d^s[20]&&(s[20]=d,this.idx_reorder(e),n||this.show_catalog_buf(e,null,!0)),(s[24]&&d!=!!s[16].icon_sticky||s[16].systemSticky)&&(s[16].icon_sticky=site2[site.nickname].set_icon(s[0],this.view,"sticky",s[16],d));var u=!!(l&&l.cmd&&l.cmd.SHOW);u^s[16].show_always&&(s[16].show_always=u,this.filter_dirtify(s),n||this.show_catalog_buf(e,!0)),s[24]&&u!=!!s[16].icon_show_always&&(s[16].icon_show_always=site2[site.nickname].set_icon(s[0],this.view,"show_always",s[16],u))}},G.prototype.view_attr_get_str=function(e){var t=this.pref.filter.attr_list_obj2[e];if(!t)return null;var n="";if(t&&t.style)for(var r in t.style)n+=r+":"+t.style[r]+";";var a=this.threads[e],s=!!(t&&t.cmd&&void 0!==t.cmd.STICKY?t.cmd.STICKY:a&&a[16].systemSticky);s&&(n+="STICKY;");t&&t.cmd&&t.cmd.SHOW;return s&&(n+="SHOW;"),n?n:null};var _e=function(){function e(e,t,r,a,s){for(var i=0;i<e.rexps.length;i++)if(s==(a^n(e,e.rexps[i],t,r)))return s;return!s}function t(e,t,r,a,s){if(e.op&&s^n(e,t,r[0],a))return!0;if(e.post)for(var i=1;i<r.length;i++)if(s^n(e,t,r[i],a))return!0;return!1}function n(e,t,n,r){if(e.sub&&n.sub&&t.test(n.sub))return!0;if(e.name&&n.name&&t.test(n.name))return!0;if(e.com)if(n.parse_funcs&&"txt"===n.parse_funcs.type_com){if(t.test(n.body||n.com))return!0}else{var a=site2[r].post_com2txt(n);if(a&&t.test(a))return!0}if(e.trip&&n.trip&&t.test(n.trip))return!0;if(e.id&&n.id&&t.test(n.id))return!0;if(e.file){if(n.filename&&t.test(n.filename))return!0;if(n.extra_files)for(var s=n.extra_files.length-1;s>=0;s--)if(n.extra_files[s].filename&&t.test(n.extra_files[s].filename))return!0}return!!(e.meta&&n.no&&t.test(n.no))||(!!(e.flag&&n.country&&t.test(n.country))||!!(e.id2&&n.id2&&t.test(n.id2)))}return{kwd:function(n,r,a){if(!n.use||!n.rexps)return!0;var s=n.match%2==1,i=n.match>=2;if(n.inPost){if(n.op&&e(n,r[0],a,i,s))return!0;if(n.post)for(var o=1;o<r.length;o++)if(e(n,r[o],a,i,s))return!0;return!1}for(var l=0;l<n.rexps.length;l++)if(s===t(n,n.rexps[l],r,a,i))return s;return!s},kwd_1:function(e,t,r){for(var a=e.inPost?e.match%2==1|0:1,s=e.match>=2|0,i=0;i<e.rexps.length;i++)if(a===(s^n(e,e.rexps[i],t,r)))return a;return!a},kwd_make_result:function(e,t,n){n||(n=pref.filter.kwd);var r=[Object.create(e[0])];r[0].search_result=this.kwd_1(n,e[0],t);for(var a=1;a<e.length;a++)this.kwd_1(n,e[a],t)&&(r[r.length]=e[a]);return 1!=r.length||r[0].search_result?r:null}}}();cataLog.catalog_filter_query_keyword=_e,G.prototype.filter_dirtify=function(e,t){e[9][0]=null,t&&(e[9][2]=null)},G.prototype.filter_test=function(e,t){var n=t[9][0];return null!==n?n:this.filter_query(e,t)},G.prototype.filter_query=function(e,t){return t[9][0]=this.filter_query_1(e,t)},G.prototype.filter_query_1=function(e,t){var n=this.pref.filter;if(t[16].show_always&&!n.kwd.active)return!0;if(n.tag&&(!n.kwd.active||!n.disTWKA)&&!this.liveTag.search_by_tags(t[16].lth))return!1;if(n.time&&(t[8][4]||t[8][0])<=n.time_obj6)return!1;if(n.time_creation&&t[8][1]<=n.time_obj6)return!1;if(n.list&&(!n.kwd.active||!n.disLWKA)){var r=pref_func.merge_obj5(e,this.pref.filter.list_obj2,null);if(!(null===r||void 0!==r.time&&r.time<(t[8][4]||t[8][0])))return!1}if(n.kwd.active){var a=t[16].recent_posts(n.kwd.post?"auto"===pref[o].sourceOfSP?-1:null:0);if(pref.test_mode[59]){if(!_e.kwd(n.kwd,a,common_func.fullname2dbt(e)[0]))return!1}else if(n.kwd.fail_list[t[9][3]]&&t[9][2]===!1||n.kwd.suc_list[t[9][3]]&&t[9][2]===!0?pref.debug_mode[18]&&t[9][2]!==_e.kwd(n.kwd,a,common_func.fullname2dbt(e)[0])&&console.log("BUG, test59, "+e):(t[9][3]=n.kwd.timestamp,t[9][2]=_e.kwd(n.kwd,a,common_func.fullname2dbt(e)[0])),!t[9][2])return!1}return!0},G.prototype.pop_up_set_contents=function(e,t,n,r){var a="sr"===t||"srpv"===t,s=r||pref.filter.kwd.posts_active,i=this.merge_bases.bases[n]||this.threads[n],l=i[16].recent_posts(a&&s&&"auto"===pref[o].sourceOfSP?-1:null),p={posts:l,__proto__:l[0]};if(!pref.test_mode[49]&&s&&p){ae.prepare_html_prep_posts(p);var c=a?_e.kwd_make_result(p.posts,p.domain,r):null}if(("sr"!==t||c)&&("page"!==this.view&&"thread"!==this.view||"pv"!==t&&("srpv"!==t||c))){var _=p.lth;p="dp"===t?{posts:[{search_result:!1,__proto__:p.posts[0]}].concat(_&&_.pd||[]),__proto__:p}:"pv"!==t&&c&&{posts:c,__proto__:p}||(p.posts=p.posts.slice(),p),"dp"!==t&&"pv"!==t&&c||ae.prepare_html_prep_posts(p),site2[p.domain].popups_prep(_);for(var d=0;d<p.posts.length;d++)p.posts[d]=Object.create(p.posts[d]);var u=site2[site.nickname].page_json2html3(p,r,{},null,r);site2.DEFAULT.check_reply.set_own_posts(p);for(var d=0;d<p.posts.length;d++)cataLog.format_html.prepare_html_post(p,p.posts[d],_.q);pref[o].mark_new_posts&&this.view_update_draw_merged(p),r&&!p.posts[0].search_result&&Array.prototype.forEach.call(u.getElementsByClassName("CatChan_search_miss"),function(e){e.style.display="none"}),gGEH.pns_all_keys.set(e,p.key),e.appendChild(u);var f={threads:{},pref:pref,noBlur:!0};return f.threads[n]={0:e.childNodes[0]},G.prototype.view_attr_set.call(f,n,!0),e}};G.prototype.prep_reserved_tags=function(e,t,n){var r=pref.catalog_board_list_obj[t]&&pref.catalog_board_list_obj[t][0].tags||null;return r&&n&&(r=r.filter(function(e){return"#"===e[0]&&"#"===e[1]})),r?this.liveTag.tags_reserved_init(r,e):null},G.prototype.make_refresh_list_from_watch_list=function(){var e=[],t=this.pref.filter.watch_list_obj2,n=t[":REV"];for(var r in n){var a=[];for(var s in n[r])if(t[r+s].time>0)if(t[r+s].cmd&&t[r+s].cmd.PRUNED&&void 0===this.threads[r+s]){var i=r.indexOf("/"),o=r.slice(0,i),l=r.slice(i);this.insert_thread_dummy(o,l,s),pref.archive.IDB.auto_restore_watch&&I(o,l,s,this)}else a[a.length]=r+s;a.length>=pref[this.mode].refresh_src_th?e[e.length]=r:e=e.concat(a)}return{tgts:e}},G.prototype.refresh=function(e,t,n,r){pref4.refresh.count++,H.refresh_start();for(var a=0;a<gClg.Clgs.length;a++)gClg.Clgs[a].footer.timestamp_set();for(var a=0;a<gClg.Clgs.length;a++)gClg.Clgs[a].idx_refresh(this);pref.test_mode[67]||t||archiver.refresh_start(),r||t||!pref.catalog.auto_save_filter_at_refresh||this.onchange_funcs.save();var s=this.refresh_1(o,e&&this,t,n,"refresh_"+this.serialNo,this.pref[this.mode].board_list_sel,this.pref.filter.bookmark_list_str,!1,void 0,r);"function"==typeof s?s(function(){y(e,t,n)}):this.refresh_tgts=s},G.prototype.refresh_1=function(e,t,n,r,a,s,i,o,l,p){var c="object"!=typeof t||"bg"===t.pref[t.mode].refresh_src.slice(0,2)?v(s,i,t,!n&&!p):null,_="object"==typeof t&&"wl"===t.pref[t.mode].refresh_src.slice(-2)?this.make_refresh_list_from_watch_list():null,d=c&&_?(c.tgts=c.tgts.concat(_.tgts),c):c||_;if("function"==typeof d)return d;var u=d.tgts;if(o)for(var f={},h=0;h<u.length;h++){var m=common_func.name2domainboardthread(u[h],!0);m[2][0].search(/^[pqcj]/)!=-1?f[m[0]+m[1]]=null:f[m[0]+m[1]+m[2].replace(/^t/,"")]=null}a&&pref3.stats.use&&pref.stats.auto_acquisition_all&&stats.register_auto_acquisition(s),u=b(u,n,e);var g=t?r?2:4:0,y=t&&t.health_indicator||z;return 0===u.length?(t&&scan.scan_refresh(y,u,g,d.tgt_domains),u):(t&&this.pref.INST.safety.remove&&!n&&this.clear_threads(pref4.scan.max_threads_at_refresh(this),!0),a&&ee.scan_init(a,u,{refresh:t,indicator:y,callback:function(){scan.scan_refresh(y,u,g,d.tgt_domains),l&&l()},from_auto:r,load_on_demand:pref[e].load_on_demand,priority:g}),o?Object.keys(f):u)},cataLog.catalog_refresh_end=w,i&&site2[site.nickname].catalog_frame_prep(K);var de=function(){Y.appendChild(V),pref.test_mode[160]||site2[site.nickname].catalog_native_prep(V,Y,pClg.health_indicator.pn2,pClg);var e=k(null,null,!0);if(pClg.pref.filter.kwd.post&&(pref4.search_posts_active_once=!1,pClg.pref.filter.kwd.posts_active=!1,pClg.filter_kwd_active({target:{name:"filter.kwd.post"}})),"page"===o&&site2[site.nickname].all_boards&&site2[site.nickname].all_boards.indexOf(site.board)!=-1||"thread"===o&&pref.thread.env.auto_update_native){var t=new MutationObserver(k),n="page"===o?e[0].pn.parentNode:e[0].pn;pClg.observer_myself={observe:function(){t.observe(n,{childList:!0})},disconnect:function(){t.disconnect()}},pClg.observer_myself.observe(),pref.test_mode[137]&&ne.change_mode()}if(!pref.filter.kwd.active||"page"!==o&&"catalog"!==o||pe(),
0!==pref.catalog_board_list_sel&&(!pref.catalog.board.all_boards||pref.catalog_board_list_sel!==pref.catalog_board_list_obj.length-1)){var r=pClg.refresh_1(o,!1,!1,!1,!1,pref.catalog_board_list_sel,!1,!1,null,!0),a=site.nickname+site.board+("catalog"===o?"c0":"page"===o?"p0":site.no),s=site.nickname+site.board+("catalog"===o?"j0":"page"===o?"q0":"t"+site.no);Array.isArray(r)&&pref.catalog.refresh.at_switch&&r.indexOf(a)===-1&&r.indexOf(s)===-1&&pClg.clear_threads(0)}pref[o].merge_auto_list&&site2.DEFAULT.update_posts_merge_bases.auto_merge_list(site.key,pClg)};if(l){var ue=site2[site.nickname].parse_funcs[site.whereami+"_html"];ue.ths_hook?ue.ths_hook(de):setTimeout(de,0)}cataLog.insert_myself=k,window.opener&&window.name&&"A"===window.name.slice(-1)||"archive"===site.whereami||setTimeout(function(){(0!=pref.catalog_board_list_sel||pref[o].env.refresh_initial)&&y("boards"!==site.whereami,l,!1)},1),cataLog.restore_th_from_IDB=I,G.prototype.Remove_thread_refresh=function(e,t,n,r){if(gClg.AllThreads[e]){for(var a=pref.liveTag.rm_404,s=r||"no"===a||"imm"!==a&&t&&t.watched&&("watched"===a||t.nr),i=0;i<gClg.Clgs.length;i++){var o=gClg.Clgs[i].threads[e];if(o){var l="IDB"===o[14]||"FILE"===o[14];s||!n&&l?l||"x"!==o[14]&&(o[14]="x",gClg.Clgs[i].footer.update_force(e)):gClg.Clgs[i].remove_thread(e,!1,!0)}}s||delete gClg.AllThreads[e]}return s},G.prototype.rm_items_404_clearPRUNEDs=function(){for(var e=Object.create(null),t=Object.create(e),n={common:{watch_list_rm404:"imm"},liveTag:{rm_404:"imm"}},r=this.pref.filter,a=[r.watch_list_obj2,r.attr_list_obj2,r.list_obj2],s=0;s<a.length;s++){var i=a[s];for(var o in i)if(i[o].cmd&&i[o].cmd.PRUNED){var l=common_func.fullname2dbt(o);B(l[0],l[1],e,t,this,l[2],n)}}pref.common.consolidated_watch_list&&pref.common.sync_watch_list&&gClg.Sync_watch_save([null,"PRUNED",r.watch_list_str])};pref_func.mirror_targets.pn12_0_2=X,pref_func.mirror_targets.pn12_0_4=V;var fe=function(e){this.ppn=e.ppn,this.subscribers=[],this.valid=null,this.last_viewed=null,this.last_Y=0,this.init2(e)};fe.prototype={setup:function(e){!pref[o].scroll_lock||this.valid||e?this.valid&&(this.ppn.removeEventListener("mouseover",this.valid,!0),this.valid=null):(this.valid=this.mouseover_lock.bind(this),this.ppn.addEventListener("mouseover",this.valid,!0))},mouseover_lock:function(e){this.last_viewed=e.target,this.last_Y=e.clientY},change:function(){var e=pref.script_prefix+"_expander";return function(t){if(t.target.className===e){var n=this["."],r=t.target.getAttribute("data-key");n.threads[r][16].expand_event(t.target.selectedIndex,n.threads[r][10]),t.target.blur()}}}(),blacklist_click:new WeakSet,geh:site2[site.nickname].general_event_handler[site.whereami],click_bl:function(e){e.target;e.target.className===pref.script_prefix+"_tag"&&liveTag.boardlist_click_entry(e)},click:function(e){function t(e,t,r){var r=t.target,a=document.createElement("span");if(a.innerHTML=' [<a data-cmd="'+pref.script_prefix+'_remove_next">Remove</a>] ',!r.nextSibling||r.nextSibling.innerHTML!==a.innerHTML){t.target.parentNode.insertBefore(a,r.nextSibling);var s=document.createElement("div");s.innerHTML='<iframe src="'+e+'" width="640" height="360" frameborder="0" allowfullscreen=""></iframe>',s.classList.add("media-embed"),r.parentNode.insertBefore(s,a.nextSibling)}n(t)}function n(e){e.stopPropagation(),e.preventDefault()}var r=e.target,a=this["."]||pClg;if(e.target.className===pref.script_prefix+"_tag")a.liveTag.tag_node_onclick(e);else if(e.target.className===pref.script_prefix+"_button"){if("triage"===e.target.dataset.type)ne.embedded_onclick(e,a);else{var s=e.target.getAttribute("name"),i=gGEH.get_key_recursive(e.target,e.currentTarget),l=this["."].onchange_funcs;l[s]&&l[s].call(l,e,s,i)}e.stopPropagation()}else{if(e.target.classList.contains(pref.script_prefix+"_embeddedTriage"))return ne.embedded_onclick(e,a),n(e);if(!pref.test_mode[104]){var p=fe.prototype.geh.isThumbnail(e);if("catalog"===a.view&&(p||"entire"===pref[a.view].click_area)||"headline"===a.view&&r.className!==pref.script_prefix+"_tag"){if(e.preventDefault(),"headline"===a.view&&!window.getSelection().isCollapsed)return;var i=gGEH.get_key_recursive(e.target,e.currentTarget);i&&a.click_thread(i,null)}else if(p){var c=site2.DEFAULT.popups_posts.href2domain(r.getAttribute("src"));fe.prototype.blacklist_click.has(r)||pref[o].env.expand_thumbnail_inline_native&&pref[o].env.event_dynamic&&c===site.nickname?pref.test_mode[163]&&se.expand_thumbnail_clicked_but_ineffective(e.target):se.expand_thumbnail_inline.call(e.target,e)}ne.off()}}if("A"===r.tagName){if(pref.test_mode[147]&&"catalog"===a.view){var i=gGEH.get_key_recursive(e.target,e.currentTarget),_=e.target.getAttribute("href"),c=site2.DEFAULT.popups_posts.href2domain(_),d=site2[c].popups_href2dbtp(_),u=d.slice(0,3).join("");return i&&u&&d[2]&&i!==u&&a.triage_event(i,"MERGEC",u),a.threads[u]||scan.scan_ui("mergeClicked",{tgts:[u],options:{refresh:a}}),n(e)}if("no"!==pref[a.mode].inline_post&&site2.DEFAULT.popups_link_regex.test(r.textContent))return site2.DEFAULT.popups_posts.inline_post(e,a),n(e);if(pref.test_mode[93]){var f=r.getAttribute("download");if(f){var _=r.getAttribute("href"),h=_.search(/^(https*:)*\/\//)!=-1&&_.replace(/^(https*:)*\/\//,"").match(/^([^\/]*)\//)[1];if(site2.ALL[h]&&(h=site2[site2.ALL[h]].nickname),h!=site2[site.nickname].domain_url)return httpd.req({tgts:[{url:_,domain:h,archive:f,responseType:"blob"}],max:1,initiator:"download",callback_1:function(){}},6),n(e)}}if(pref.test_mode[87])if(r.href.indexOf("//www.youtube.com")!==-1)t(r.href.replace(/watch\?v=/,"embed/"),e);else if(r.href.indexOf("//youtu.be")!==-1)t(r.href.replace(/youtu.be/,"youtube.com/embed"),e);else{var m=r.getAttribute("data-cmd");m&&0===m.indexOf(pref.script_prefix)&&"remove_next"===(m=m.substr(pref.script_prefix.length+1))&&function(e){e.target.parentNode.parentNode.removeChild(e.target.parentNode.nextSibling),e.target.parentNode.parentNode.removeChild(e.target.parentNode)}(e)}}},get_last_viewed:function(){return this.last_viewed?site2[site.nickname].general_event_handler[site.whereami].get_mark(this.last_viewed,f()+this.last_Y):null},clear_last_viewed:function(){this.last_viewed=null},init:function(){site2[site.nickname].parse_funcs[site.whereami+"_html"].dynamic_image_hover,site2[site.nickname].general_event_handler[site.whereami];pref.test_mode[104]||site.popup_body.addEventListener("click",this.click,!1),this.setup()},init2:function(e){var t={".":e,__proto__:this};(pref.test_mode[87]||pref.test_mode[93]||!pref.test_mode[104])&&common_func.dom_addEventListener(this.subscribers,this.ppn,"click",this.click.bind(t)),common_func.dom_addEventListener(this.subscribers,this.ppn,"change",this.change.bind(t)),site2.DEFAULT.popups_posts.init2(pref.test_mode[141]?e.pppn:e.ppn,t),common_func.dom_addEventListener(this.subscribers,site.root_body,"dragstart",this.dragstart.bind(t)),pref.test_mode[188]&&common_func.dom_addEventListener(this.subscribers,this.ppn,"mousedown",this.dnd_merge_mousedown.bind(t))},destroy:function(){this.setup(!0),common_func.dom_removeEventListener(this.subscribers)},mouseover:function(e,t){var n=e.target;site2.DEFAULT.popups_posts.over(e,t),pref.liveTag.info&&pref.tooltips.info.show&&(n.className===pref.script_prefix+"_tag"?Tooltips.req_show("info",e,liveTag.tag_onmouseover):Tooltips.hide_if(e.currentTarget))},mouseleave_bl:function(e){pref.liveTag.info&&Tooltips.hide_if(e.currentTarget)},dragstart:function(){function e(e){a=gGEH.get_key_rec(e),s&&r!==a&&(se.image_hover_remove(e),s=null)}function t(t,i,o){document.body.removeEventListener("dragenter",e,!1),s?se.image_hover_snatch(t,i,o):r&&pref.test_mode[188]&&a!==r&&n.triage_event(r,"MERGECU",a||null)}var n=null,r=null,a=null,s=null;return function(a){if(fe.prototype.geh.isThumbnail(a)){n=this["."];var i=n.pref[n.mode];"catalog"===n.view&&i.merge_list&&!i.merge?(r=gGEH.get_key_rec(a),s=r,document.body.addEventListener("dragenter",e,!1),gGEH.drag.started(a,t,"copy")):gGEH.drag.started(a,se.image_hover_snatch,"copy"),site2.DEFAULT.popups_posts.pop_down_temporarily(a)}}}(),dnd_merge_mousedown:function(){function e(e){var t=e.screenX-o,r=e.screenY-l;if(!(Math.abs(r)<Math.abs(t))){var a=s.cloneNode(!0);a.style.width=s.offsetWidth,a.style.height=s.offsetHeight,a.style.position="fixed",a.style.opacity=.4,a.style.pointerEvents="none";var d=s.getBoundingClientRect();c=d.left,_=d.top,p=a,n(e),i.ppn.appendChild(a),i.ppn.addEventListener("mousemove",n,!1)}}function t(e){p&&(i.ppn.removeChild(p),i.ppn.removeEventListener("mousemove",n,!1),p=null,window.getSelection().removeAllRanges())}function n(e){window.getSelection().removeAllRanges();var t=e.screenX-o,n=e.screenY-l;p&&(p.style.left=c+t+"px",p.style.top=_+d+n+"px")}function r(n){return i.ppn.removeEventListener("mouseup",a,!1),i.ppn.removeEventListener("mouseleave",r,!1),s.removeEventListener("mouseleave",e,!1),s.removeEventListener("mouseenter",t,!1),site2.DEFAULT.popups_posts.pop_up_unlock(),p&&(t(n),!0)}function a(e){if(r(e)){var t=gGEH.get_key_recursive(s,i.ppn,!0),n=gGEH.get_key_rec(e);t&&n!==t&&i.triage_event(t,"MERGECU",n||null)}}var s=null,i=null,o=0,l=0,p=null,c=0,_=0,d=0;return function(n){i=this["."];var p=i.pref[i.mode];"headline"===i.view&&p.merge_list&&!p.merge&&(s=this.geh.recSearch_thread(n.target,i.ppn,"headline"===i.view?pref.script_prefix+"_headline":void 0))&&(o=n.screenX,l=n.screenY,d=n.offsetY-s.offsetHeight/2,i.ppn.addEventListener("mouseup",a,!1),i.ppn.addEventListener("mouseleave",r,!1),s.addEventListener("mouseleave",e,!1),s.addEventListener("mouseenter",t,!1),site2.DEFAULT.popups_posts.pop_down_temporarily(n,!0))}}()},cataLog.GEH=fe,cataLog.general_event_handler=new fe(pClg),setTimeout(cataLog.general_event_handler.init.bind(cataLog.general_event_handler),500);var he=function(e){return function(t){e(t,!0),t.stopPropagation()}}(fe.prototype.mouseover);return pref.test_mode[98]||site.popup_body.addEventListener("mouseover",he,!1),site.root_body.addEventListener("mouseover",fe.prototype.mouseover,!1),site.components.boardlist&&site.components.boardlist.addEventListener("click",fe.prototype.click_bl,!1),site2.DEFAULT.popups_posts.init(pClg.ppn),pref.test_mode[114]||(pClg.GEH=cataLog.general_event_handler),G.prototype.clone_threads=function(e){for(var t in e.threads)this.threads[t]||(this.clone_thread_1(t),this.view_attr_set(t,null,!0),this.idx_reorder(t,!0))},G.prototype.clone_thread_1=function(e){for(var t=liveTag.mems.getFromName(e),n=gClg.AllThreads[e],r=Object.keys(n[16]),a={th:{pn:null,__proto__:t.th},__proto__:re},s=["th","icon_sticky","icon_show_always","show_always","clg","threads"],i=0;i<r.length;i++)s.indexOf(r[i])==-1&&(a[r[i]]=n[16][r[i]]);this.threads[e]={0:!1,1:!1,9:[null,0,null,0],10:null,16:a,20:n[20],24:null,__proto__:n}},window.addEventListener("storage",G.prototype.Sync_watch_load,!1),"float"!==pClg.mode&&pref.float.auto_launch&&setTimeout(U,1e3),stats&&pref.stats.auto_acquisition_scan&&"archive"!==site.whereami&&setTimeout(stats.auto_acquisition_init,1e3*pref.stats.auto_acquisition_scan_delay),{destroy:function(){cataLog.general_event_handler.destroy(),pref_func.mirror_targets.pn12_0_2=null,pref_func.mirror_targets.pn12_0_4=null,brwsr.sw_cache&&brwsr.sw_cache.subscribe&&brwsr.sw_cache.subscribe(!1),z.destroy(),cnst.auto_shrink_board_selector.destroy(Q),a(),ne.destroy(),Tooltips.remove_root(V),Tooltips.hide(),K.parentNode.removeChild(K),window.removeEventListener("storage",site2[site.nickname].prep_own_posts_event,!1),K=null,liveTag.pn=null;for(var e in cataLog)cataLog[e]=null;return window.removeEventListener("storage",G.prototype.Sync_watch_load,!1),null},triage_exe_pipe:p,catalog_insert:C,pn12_0_4:V,pn12_0_2:X,get_threads:function(){return Z},scan_boards:ee,show_catalog:pe,catalog_liveTag_scan_site:q.scanSite,make_watcher:U}}var a,s,i,o,l,p=null;return cataLog.set_embed_xxxx=n,n(),e&&e.addEventListener("click",t,!1),styleSheet.init(o),{catalog_func:function(){return p},show_hide:t}}function make_chart_obj(e){function t(){new _}function n(){cnst.foreach(p,function(e){e.chart_posts.options.animation=e.options.animation})}function r(){pref.chart.off_anime_blur&&cnst.foreach(p,function(e){e.chart_posts.options.animation=!1})}function a(){cnst.foreach(p,function(e){e.destroy()})}function s(){return{labels:["dummy","dummy"],datasets:[]}}function i(e,t,n){return{label:e,fillColor:"rgba("+t+","+n+")",strokeColor:"rgba("+t+",1)",pointColor:"rgba("+t+",1)",pointStrokeColor:"#fff",pointHighlightFill:"#fff",pointHighlightStroke:"rgba("+t+",1)",data:[0,0]}}var o='<select name="chart.inst.time_sel"><option>1 min</option><option>10 mins</option><option>1 hour</option><option>1 day</option><option>1 week</option><select>',l=['Number of points: <ITB3"chart.inst.len"><br>','Scale of new thread: <ITB3"chart.inst.scale_thread"><br>',"Show: Posts/Threads:<br>",'&emsp;&emsp;<IC"chart.inst.show.np"><IC"chart.inst.show.nt" disabled style="visibility:hidden">Estimated, <IC"chart.inst.clip_np">Clip:<ITB4"chart.inst.clip_np_val"><br>','&emsp;&emsp;<IC"chart.inst.show.p"><IC"chart.inst.show.t">Observed<br>','&emsp;&emsp;<IC"chart.inst.show.ep"><IC"chart.inst.show.et">Alive<br>','<IC"chart.inst.show_legend">Legend<br>','<IC"chart.inst.options.animation">Animation (Doesn\'t work on FF)<br>','<IC"chart.inst.options.pointDot">Point dot: radius <ITB1"chart.inst.options.pointDotRadius"><br>'];if(!e)return{time_unit_sel_html:o,chart_options_str:l};e.addEventListener("click",t,!1);var p=[];window.addEventListener("beforeunload",a,!1);var c=0,_=function(e,t,a){if(a||common_func.deep_copy(this,pref.chart.inst),e)this.pn_canvas_root=e,this.show_legend=!1,this.show={np:!1,p:!0,ep:!1,nt:!1,t:!0,et:!1};else{cnst.subscribe(p,this),0===c.length&&(common_func.dom_addEventListener(common_obj.events_beforeunload,window,"focus",n),common_func.dom_addEventListener(common_obj.events_beforeunload,window,"blur",r)),this.name="graph_"+c++,this.pn2_obj=cnst.init3({this_obj:this,__proto__:this.pn2_template});var s=this.pn2_obj.pn;cnst.add_to_tb(s,o+(a?"":'<select name="chart.inst.board_sel"><select>')+cnst.icons.button_settings());s.childNodes[1].innerHTML=pref_func.format_html_str('<div style="display:none"><div style="float:right">'+l.join("")+'</div><div style="clear:both"></div></div><div style="position:relative"></div>'),pref_func.apply_prep(s,!1,void 0,void 0,void 0,a?{chart:{inst:this}}:void 0);var i=s.getElementsByTagName("select");cnst.auto_shrink_selector(i["chart.inst.time_sel"]),this.legend=cnst.init3({func_str:"border:1px solid lightblue:cursor:move:position:absolute:left:80px:top:40px"}),this.legend.pn.style.zIndex=null,this.pn2=s,this.set_legend_str();var _=this.onchange_entry.bind(this);if(s.childNodes[0].onchange=_,s.childNodes[1].childNodes[0].onchange=_,a)return cnst.bottom_top(s),s;this.pn_board_sel=i["chart.inst.board_sel"],cnst.auto_shrink_board_selector.setup(this.pn_board_sel,pref.catalog_board_list_sel),this.board_sel=pref.catalog_board_list_sel,this.pn_canvas_root=s.childNodes[1].childNodes[1]}this.pn_canvas_root.style.width=pref.chart.window_width+"px",this.pn_canvas_root.style.height=pref.chart.window_height+"px",this.pn_canvas_root.style.resize="both",this.pn_canvas_root.style.overflow="hidden",this.pn_canvas=document.createElement("canvas"),this.pn_canvas_root.appendChild(this.pn_canvas),this.chart_size_changed(!0),this.stats=e?new stats.Stats(this,t,"popup"):new stats.Stats(this,this.get_tgts(),pref.catalog_board_list_obj[this.board_sel][0].key),this.canvas_active=!0,this.pn_canvas_root.onmousemove=this.deactivate_canvas_if_mouse_on_corner.bind(this),this.pn_canvas_root.onclick=this.chart_size_changed.bind(this),this.show_legend&&this.append_legend(),e||cnst.bottom_top(s)};return _.prototype={get_tgts:function(e){return pClg.refresh_1?pClg.refresh_1("chart",!1,!1,!1,e,this.board_sel,!1,!0):[site.nickname+site.board]},board_sel_changed:function(e){e.target.blur();var t=this.get_tgts(pref.chart.instant_scan?this.name:null);"function"==typeof t?t(this.board_sel_changed.bind(this)):this.stats.tgts_changed(t,pref.catalog_board_list_obj[this.board_sel][0].key)},len_changed:function(){this.len>this.stats.len?this.stats.len_changed.call(this.stats,this.len):this.stats.len!=pref.stats.len_capture?this.stats.len_changed.call(this.stats,pref.stats.len_capture):this.replace_data(this.data_src)},deactivate_canvas_if_mouse_on_corner:function(e){var t=e.currentTarget.style;(parseInt(t.width,10)-e.offsetX<=10&&parseInt(t.height,10)-e.offsetY<=10)^!this.canvas_active&&(this.pn_canvas.style.pointerEvents=this.canvas_active?"none":"auto",this.canvas_active=!this.canvas_active)},chart_size_changed:function(e){this.pn_canvas.style.width=this.pn_canvas_root.style.width,this.pn_canvas.style.height=this.pn_canvas_root.style.height,this.pn_canvas.width=this.pn_canvas_root.clientWidth,this.pn_canvas.height=this.pn_canvas_root.clientHeight,e!==!0&&this.chart_redraw()},chart_redraw:function(){this.chart_posts&&this.chart_posts.destroy(),this.data_graph=s();var e=this.data_graph.datasets,t=this.data_src.fromNo,n=this.data_src.rm,r=this.data_src,a=0;this.idxs={};var o=this.idxs;o.np=t&&this.show.np?a++:-1,o.p=this.show.p?a++:-1,o.ep=n&&this.show.ep?a++:-1,o.t=this.show.t?a++:-1,o.et=n&&this.show.et?a++:-1,o.np!=-1&&(e[o.np]=i("post_fromNo","151,187,205",.2)),o.p!=-1&&(e[o.p]=i("Posts","98,152,179",.2)),o.ep!=-1&&(e[o.ep]=i("exist_p","66,119,136",.15)),o.t!=-1&&(e[o.t]=i("Threads","204,0,0",.2)),o.et!=-1&&(e[o.et]=i("exist_t","140,0,0",.2)),pref.test_mode[39]&&e[pref.test_mode.num]&&(e[pref.test_mode.num]=i(e[pref.test_mode.num].label,pref.test_mode.test_str,pref.test_mode.num_f));var l=this.len<this.stats.len?this.stats.len-this.len:0;if(this.data_graph.labels=r.data_l.slice(l),o.p!=-1&&(e[o.p].data=this.stats.merge_1(r.data_p.slice(l),r.data_p_old?r.data_p_old.slice(l):null)),o.t!=-1&&(e[o.t].data=this.stats.merge_1(r.data_t.slice(l),r.data_t_old?r.data_t_old.slice(l):null),1!=this.scale_thread&&this.scale_setup(e[o.t].data)),n&&(o.ep!=-1&&(e[o.ep].data=this.arr_dec_slice(r.data_p,n.data_p,l)),o.et!=-1&&(e[o.et].data=this.arr_dec_slice(r.data_t,n.data_t,l),1!=this.scale_thread&&this.scale_setup(e[o.et].data)),pref.test_mode[40]&&(e[a]=i("old_p","0,255,0",.1),e[a++].data=r.data_p_old.slice(l),e[a]=i("p_raw","98,152,179",.2),e[a++].data=r.data_p.slice(l))),t&&o.np!=-1){if(e[o.np].data=t.data_p_old?t.data_p_old.concat(t.data_p.slice(t.data_p_old.length)).slice(l):t.data_p.slice(l),t.data_p_old){var p=t.data_p_old.length-1;t.data_p[p]>t.data_p_old[p]&&p-l>=0&&(e[o.np].data[p-l]=t.data_p[p])}if(this.clip_np)for(var c=e[o.np].data,_=0;_<c.length;_++)c[_]=this.clip_np_func(c[_]);pref.test_mode[41]&&(e[a]=i("post_fromNo_old","0,255,0",.2),e[a++].data=t.data_p_old.slice(l),e[a]=i("post_fromNo","0,128,0",0),e[a++].data=t.data_p.slice(l))}this.scale_thread_old=this.scale_thread;var d=this.pn_canvas.getContext("2d");this.chart_posts=new Chart(d).Line(this.data_graph,this.options)},clip_np_func:function(e){return e<0?0:e>this.clip_np_val?this.clip_np_val:e},arr_dec_slice:function(e,t,n){for(var r=[],a=0,s=n;s<e.length;s++)r[a++]=e[s]-t[s];return r},scale_setup:function(e,t){if(void 0!==t)for(var n=0;n<e.length;n++)e[n].value=e[n].value/t*this.scale_thread;else for(var n=0;n<e.length;n++)e[n]*=this.scale_thread;return e},scale_changed:function(){this.set_legend_str(),0!==this.scale_thread_old?(this.scale_setup(this.chart_posts.datasets[this.idxs.t].points,this.scale_thread_old),void 0!==this.idxs.et&&this.data_graph.datasets[this.idxs.et]&&this.scale_setup(this.chart_posts.datasets[this.idxs.et].points,this.scale_thread_old),this.chart_posts.update()):this.chart_redraw(),this.scale_thread_old=this.scale_thread},set_legend_str:function(){var e='<span style="color:rgba(98,152,179,1)">●</span><span style="color: black;"> Posts</span><br><span style="color:rgba(204,0,0,1)">●</span><span style="color: black;"> Threads '+(1==this.scale_thread?"":"x"+this.scale_thread+" ")+"</span>";this.legend.pn.innerHTML=e},destroy:function(){return brwsr.ff||this.chart_posts.stop(),this.chart_posts.destroy(),this.stats.destroy(),this.stats=null,this.pn2&&(cnst.div_destroy(this.legend.pn,!1,this.legend),cnst.div_destroy(this.pn2,!0,this.pn2_obj),cnst.auto_shrink_board_selector.destroy(this.pn_board_sel),cnst.unsubscribe(p,this)),null},replace_data:function(e){this.stats||(this.stats=e),this.data_src=e,this.chart_redraw()},update_data2:function(e){for(var t=e.shift;t>0;)this.chart_posts.removeData(),t--;for(var n=[],t=e.data_p.length-e.shift;t<e.data_p.length;t++)e.fromNo&&this.idxs.np!=-1&&(n[this.idxs.np]=this.clip_np?this.clip_np_func(e.fromNo.data_p[t]):e.fromNo.data_p[t]),this.idxs.p!=-1&&(n[this.idxs.p]=e.data_p[t]),this.idxs.t!=-1&&(n[this.idxs.t]=e.data_t[t]*this.scale_thread),e.rm&&(this.idxs.ep!=-1&&(n[this.idxs.ep]=e.data_p[t]-e.rm.data_p[t]),this.idxs.et!=-1&&(n[this.idxs.et]=(e.data_t[t]-e.rm.data_t[t])*this.scale_thread)),this.chart_posts.addData(n,e.data_l[t]);var r=this.idxs.p!=-1?this.chart_posts.datasets[this.idxs.p]:null,a=this.idxs.t!=-1?this.chart_posts.datasets[this.idxs.t]:null,s=this.idxs.ep!=-1&&e.rm?this.chart_posts.datasets[this.idxs.ep]:null,i=this.idxs.et!=-1&&e.rm?this.chart_posts.datasets[this.idxs.et]:null,o=this.idxs.np!=-1&&e.fromNo?this.chart_posts.datasets[this.idxs.np]:null,l=e.min_idx-(this.stats.len-this.len),t=e.min_idx;for(l<0&&(t+=-l,l=0),pref.stats.patch_tm&&o&&l>0&&t>0&&(o.points[l-1].value=this.clip_np?this.clip_np_func(e.fromNo.data_p[t-1]):e.fromNo.data_p[t-1]);t<e.data_p.length-e.shift;)r&&(r.points[l].value=e.data_p_old&&e.data_p_old[t]>e.data_p[t]?e.data_p_old[t]:e.data_p[t]),a&&(a.points[l].value=(e.data_t_old&&e.data_t_old[t]>e.data_t[t]?e.data_t_old[t]:e.data_t[t])*this.scale_thread),s&&(s.points[l].value=e.data_p[t]-e.rm.data_p[t]),i&&(i.points[l].value=(e.data_t[t]-e.rm.data_t[t])*this.scale_thread),o&&(o.points[l].value=this.clip_np?this.clip_np_func(e.fromNo.data_p[t]):e.fromNo.data_p[t]),l++,t++;e.shift=0,this.chart_posts.update()},append_legend:function(){this.pn_canvas_root.appendChild(this.legend.pn)},remove_legend:function(){this.pn_canvas_root.removeChild(this.legend.pn)}},_.prototype.pn2_template={get func_str(){return"left:"+(c-1)%5*20+"px:tile2:get:bottom:"+(c-1)%5*20+":Show:tb"},maximize:_.prototype.chart_size_changed,maximize_embed_style_pnch1:{},maximize_float_style_pnch1:{},exit:_.prototype.destroy,get maximize_tgt(){return this.this_obj.pn_canvas_root}},_.prototype.onchange_entry=function(e){var t=pref_func.get_tgt(e.target.name.replace(/chart.inst./,""),this),n=t[1];pref_func.apply_prep_set(t[0],t[1],e.target),this.onchange_funcs[n]&&this.onchange_funcs[n].call(this,e)},_.prototype.onchange_funcs={pointDot:_.prototype.chart_redraw,pointDotRadius:_.prototype.chart_redraw,scale_thread:_.prototype.scale_changed,animation:function(){this.chart_posts.options.animation=this.options.animation},len:_.prototype.len_changed,separate:function(){this.stats.init()},time_sel:function(e){e.target.blur(),this.stats.time_unit_changed(this.time_sel)},board_sel:_.prototype.board_sel_changed,show_legend:function(e){e.target.checked?this.append_legend():this.remove_legend()},clip_np:_.prototype.chart_redraw,clip_np_val:function(){this.clip_np||(this.clip_np=!0,this.pn2.querySelector('input[name="chart.inst.clip_np"]').checked=!0),_.prototype.chart_redraw.call(this)}},_.prototype.onchange_funcs.np=_.prototype.onchange_funcs.separate,_.prototype.onchange_funcs.p=_.prototype.onchange_funcs.separate,_.prototype.onchange_funcs.ep=_.prototype.onchange_funcs.separate,_.prototype.onchange_funcs.t=_.prototype.onchange_funcs.separate,_.prototype.onchange_funcs.et=_.prototype.onchange_funcs.separate,{clear:function(){},dump:function(e){},data_update:function(e,t,n){},PostChart:_,time_unit_sel_html:o,chart_options_str:l,make:t}}function make_setting_obj(e){function t(){r=n(null==r)}function n(e){function n(e){pref_func.apply_prep(a,e),e&&(listener(),timer_obj.init())}function s(e){var r=e.currentTarget.value;"apply"==r?n(!0):"cancel"==r?t():"ok"==r?(n(!0),t()):"apply+save"==r?(n(!0),localStorage&&(localStorage[pref.script_prefix+".pref"]=JSON.stringify(pref))):"load_default"==r?(pref=pref_default(),n(!1),n(!0),pref_func.obj_init()):"load_samples"==r?pref_func.pref_samples.init():"Dump(csv)"==r?chart_obj.dump("csv"):"Dump(obj)"==r?chart_obj.dump("obj"):"Clear data"==r?chart_obj.clear():"JSON"==r?(pref_func.apply_prep(a.getElementsByTagName("TEXTAREA")["cli.json_str"],!0),pref_func.site2_json()):"EVAL"==r&&(pref_func.apply_prep(a.getElementsByTagName("TEXTAREA")["cli.eval_str"],!0),pref_func.site2_eval())}if(e&&(pref.test_mode[17]?(r=document.createElement("div"),r.innerHTML="<div></div><div></div>",site.root_body.appendChild(r)):r=cnst.init("left:0px:tile:get:bottom:Show:tb",cnst.void_func,cnst.void_func,t,cnst.void_func),a=pref.test_mode[17]?r:r.childNodes[1],a.innerHTML='<div><div style="float:left">Statistics:<br>&emsp;Interval: <input type="text" name="interval_found" size="6" style="text-align: right;">min<br>&emsp;<input type="checkbox" name="check_page"> Show page no. of this thread<br>&emsp;&emsp;<input type="checkbox" name="show_page_fraction"> Show fraction of page No.<br>&emsp;<input type="checkbox" name="check_post"> Show num of new posts in this board<br>&emsp;<input type="checkbox" name="check_thread"> Show num of new threads in this board<br>&emsp;&emsp; Max_capture: <input type="text" name="max_capture" size="6" style="text-align: right;"> points<br>&emsp;&emsp;&emsp;Show recent : <input type="text" name="max_graph" size="6" style="text-align: right;"> points in graph<br>&emsp;&emsp;&emsp;Scale of #threads in graph: <input type="text" name="scale_thread" size="6" style="text-align: right;"><br><!-- &emsp;&emsp;<input type="radio" name="autoconf" value="auto"> Automatic configuration<br>&emsp;&emsp;<input type="radio" name="autoconf" value="manual"> Manual configuration<br> -->&emsp;&emsp;&emsp;<input type="radio" name="aggregator" value="true"> Aggregate data<br>&emsp;&emsp;&emsp;&emsp;<input type="checkbox" name="write_to_ls"> Write to localStrage (server)<br>&emsp;&emsp;&emsp;<input type="radio" name="aggregator" value="false"> Listen from localStrage (client)<br>&emsp;&emsp;<input type="checkbox" name="load_data"> Load data from localStrage at the start<br>&emsp;&emsp;Import format (drop whole text on graph)<br>&emsp;&emsp;&emsp;<input type="radio" name="import_format" value="csv"> csv<br>&emsp;&emsp;&emsp;<input type="radio" name="import_format" value="obj"> obj<br>&emsp;&emsp;<input type="button" value="Dump(csv)"><input type="button" value="Dump(obj)">&emsp;<input type="button" value="Clear data"><br><input type="checkbox" name="auto_start"> Start automatically (Delayed 10sec.)<br><br><!-- Post form:<br>&emsp;<input type="checkbox" name="hide_rules"> Hide rules<br>&emsp;<input type="checkbox" name="hide_Go"> Hide \'Go\'<br> --><br><br></div></div><div style="clear: both"><input type="button" value="cancel"><input type="button" value="apply"><input type="button" value="ok">&emsp;<input type="button" value="apply+save"><input type="button" value="load_default"><input type="button" value="load_samples"></div>',pref.test_mode[17]||(n(!1),cnst.bottom_top(r))),!pref.test_mode[17])for(var i=a.getElementsByTagName("input"),o=0;o<i.length;o++)"button"==i[o].type&&(e?i[o].addEventListener("click",s,!1):i[o].removeEventListener("click",s,!1));return e?r:pref.test_mode[17]?(a.innerHTML="",r.parentNode.removeChild(r),null):(a=null,cnst.div_destroy(r,!0))}e.addEventListener("click",t,!1);var r=null,a=null}function make_listener(){function e(e){if(null!==e.newValue&&e.key===pipe_name&&"false"===pref.aggregator){var t=brwsr.JSON_parse(e.newValue);t[0]!=n&&(n=t[0],chart_obj.data_update(t[0],t[1],t[2]),timer_obj.show_page([null,"+"+t[1]+"+"+t[2]+"@"+t[0]]))}}function t(){r||"false"!==pref.aggregator?r&&"true"===pref.aggregator&&(window.removeEventListener("storage",e,!1),r=!1):(window.addEventListener("storage",e,!1),r=!0)}var n,r=!1;return t(),t}function make_timer_obj(e){function t(t){null==r&&(pref.check_page||"true"==pref.aggregator&&(pref.check_thread||pref.check_post))?r=make_timer(e):null!=r&&(t&&(pref.check_page||"false"!=pref.aggregator&&(pref.check_thread||pref.check_post))?t&&r.timer().restart(!1):n())}function n(){r=r.destroy(),e.style.color="gray"}e.addEventListener("click",function(){t(!1)},!1);var r=null;pref.auto_start&&setTimeout(function(){t(!1)},1e4);var a=["",""];return{init:function(){t(!0)},finished:function(){n()},timer:function(){return r},show_page:function(t){null!=t[0]&&(a[0]=t[0]+"@"+cnst.get_time()),t.length>=2&&null!=t[1]&&(a[1]=t[1]),t.length>=3&&null!=t[2]&&(a[0]=t[2]),""!=a[0]&&""!=a[1]?e.textContent=a[0]+", "+a[1]:e.textContent=a[0]+a[1]}}}function make_timer(e){function t(e,t,r){var a=common_func.name2domainboardthread(e,!0)[2].substr(1);n(t.date,a,(new DOMParser).parseFromString(t.responseText,"text/html"))}function n(e,t,n){for(var r=site.get_ops(n),a=_.myself(),s=0;s<r.length;s++)if(a==r[s]){i.str_set(t,s);var o=i.str_get()+"@"+new Date(e).toLocaleTimeString();timer_obj.show_page([null,null,o]),i.prep_next(),_.restart(!0),pref.check_page&&options.func0_exe(i.str_get());break}}function r(e){var t=i.no();if(a(e,_.myself(),t),i.all_got()&&i.no()!=site.max_page){var n=0==o?0:l-o,r="";pref.check_page&&(r=i.str_get()),pref.check_post&&(r=r+"+"+n),pref.check_thread&&(r=r+"+"+c),timer_obj.show_page([r]),i.prep_next(),_.found(),n=parseInt(n,10),(isNaN(n)||null==n)&&(n=0),(pref.check_post||pref.check_thread)&&chart_obj.data_update(_.timestr(),n,c),o=l,pref.check_page&&options.func0_exe(i.str_get())}else timer_obj.show_page([t+"?"]),i.step(),_.missing()}function a(e,t,n){for(var r=site.get_ops(e),a=0;a<r.length;a++)if(t==r[a]){i.str_set(n,a),i.flag_set(2);break}if(t==-1)return r[0];if(0==n&&(i.flag_set(0),l=s(e)),n==site.max_page-1){i.flag_set(1);var o=p.length;if(0!=o){for(var _=r[r.length-1],a=0;a<o&&_!=p[o-a-1];)a++;c=a}else c=0;p=r}}function s(e){for(var t=site.get_posts(e),n=t[0],r=1;r<t.length;r++)t[r]>n&&(n=t[r]);return n}var i=function(){function e(){var e=0;t[0]=-1,t[1]=-1,pref.check_post&&(t[e++]=0),pref.check_thread&&(t[e++]=site.max_page-1);var a=(r+1)%(site.max_page+1);r!=t[0]&&r!=t[1]&&(t[e++]=r),a!=t[0]&&a!=t[1]&&(t[e++]=a);for(var i=0;i<=site.max_page;i++)i!=r&&i!=a&&i!=t[0]&&i!=t[1]&&(t[e++]=i);flag=[!pref.check_post,!pref.check_thread,!s],n=0}var t=[],n=0,r=0,a="",s=pref.check_page;return window.location.href.search(site.thread_keyword)==-1&&(s=!1),e(),{no:function(){return t[n]},step:function(){n=(n+1)%(site.max_page+1)},prep_next:function(){e()},flag_set:function(e){flag[e]=!0},all_got:function(){return flag[0]&&flag[1]&&flag[2]},str_set:function(e,t){s&&e!=site.max_page&&(a=e+"."+t,r=e)},str_get:function(){return a},init:function(){e()}}}(),o=0,l=0,p=[],c=0,_=function(){function t(e){var t=new DOMParser;if(404==c.status)_.dead();else{var n=Date.now();pref.info_server&&i.no()!=site.max_page&&brwsr.sw_cache&&brwsr.sw_cache.setItem(info_raw+"p"+i.no(),{date:n,status:c.status,responseText:c.responseText}),pref.catalog_snoop_refresh&&null!=catalog_obj.catalog_func()&&catalog_obj.catalog_func().catalog_insert(info_raw+"p"+i.no(),{date:n,status:c.status,responseText:c.responseText}),r(t.parseFromString(c.responseText,"text/html"))}}function n(e){c.open("GET",e,!0),c.send(null)}function s(){u||(u=!0,d=cnst.get_time(),o())}function o(){var e=site2[site.nickname].make_url4([site.nickname,site.board,i.no(),"page_html"])[0];i.no()==site.max_page&&(e=window.location.href),n(e)}function l(e){(e||g!=pref.interval_found)&&(p(!1),m=setInterval(s,6e4*pref.interval_found)),g=pref.interval_found}function p(t){null!=m&&clearInterval(m),m=null,t&&(e.style.color="gray")}var c=new XMLHttpRequest;c.addEventListener("load",t,!1),c.addEventListener("error",t,!1),c.addEventListener("abort",t,!1);var d,u=!1,f=0,h=site.max_page+1+5,m=null,g=0;l(!0),s(),e.style.color="#000000";var v=window.location.href.search(site.thread_keyword)!=-1?a(document,-1,-1):-2;return{req:c,
found:function(){f=0,u=!1},missing:function(){200==c.status&&f++<h?setTimeout(o,1e3):(f=0,u=!1)},stop:function(e){p(e)},dead:function(){timer_obj.show_page(["Dead"]),p(!0),timer_obj.finished()},myself:function(){return v},restart:function(e){l(e)},timestr:function(){return d},destroy:function(){c.removeEventListener("load",t,!1),c.removeEventListener("error",t,!1),c.removeEventListener("abort",t,!1)}}}();return brwsr.sw_cache&&pref.info_client&&brwsr.sw_cache.subscribe(!0),{destroy:function(){return brwsr.sw_cache&&brwsr.sw_cache.subscribe(!1),_.stop(!0),_.destroy(),null},timer:function(){return _},page_check5:t}}function make_post_form_obj(e){function t(){site.components.postform_comment.focus()}function n(e){site2[site.nickname].postform.activation&&site2[site.nickname].postform.activation();var n=cnst.tack_float_nSblgs(e);n.rolldown=t,o=n.pn,n.cn.childNodes[0].innerHTML='<div><input type="checkbox" name="prevent_redirection">prevent redirection</div><div></div>',l=n.cn.childNodes[0],pref_func.apply_prep(l,!1),l.getElementsByTagName("input").prevent_redirection.onchange=s,options.func0_prep(n.cn.childNodes[0].childNodes[1],n.pn,n.cn),t(),site.postform.getAttribute("name")===pref.script_prefix+"_draft"&&(site.postform.style.display=null,n.pn.style.top="0px",n.pn.style.left="0px")}function r(e){cnst.tack_dock_nSblgs(e),site.postform.getAttribute("name")===pref.script_prefix+"_draft"&&(site.postform.style.display="none")}function a(){"none"!==i.style.display?n({currentTarget:i}):r({currentTarget:o.childNodes[0]})}function s(){if(null!=l&&pref_func.apply_prep(l,!0),1==pref.prevent_redirection){g||(g=cnst.make_iframe("redirect_target"),g.onload=function(){g.location&&"about:blank"!=g.location.href&&g.location.replace("about:blank")});for(var e=0;e<p.length;e++)m[e]=_[e].target,_[e].target="redirect_target"}else for(var e=0;e<p.length;e++)_[e].target=m[e]}var i;e.addEventListener("click",a,!1),site2[site.nickname].postform&&(i=site2[site.nickname].postform.init())&&cnst.set_tack_float(i,n,r);for(var o=null,l=null,p=[],c=[],_=document.getElementsByTagName("form"),d=0;d<_.length;d++)"post"==_[d].method&&c.push(_[d]);for(var d=0;d<c.length;d++)for(var u=c[d].getElementsByTagName("input"),f=0;f<u.length;f++)"submit"==u[f].type&&p.push(u[f]);for(var h=!1,m=[],d=0;d<p.length;d++)p[d].addEventListener("click",function(){h=!0},!1);var g;return 1==pref.prevent_redirection&&s(),a}function make_debug_obj(e){function t(e){console.log("debug"),null!=site.components.postform_submit&&(site.components.postform_submit.disabled=!1)}return e.addEventListener("click",t,!1),make_debug_obj}if(!(window.top!=window.self&&""===window.name||"post_tgt"===window.name&&window.location.href.indexOf("localhost")!=-1)){var brwsr={ff:navigator.userAgent.indexOf("Firefox")!=-1,sw_cache:!0,JSON_parse:function(e){var t=JSON.parse(e);for(var n in t)"string"==typeof t[n]&&t[n].search(/^\[.*\]$/)!=-1&&(t[n]=brwsr.JSON_parse(t[n]));return t}};brwsr.innerText=brwsr.ff?"textContent":"innerText",brwsr.Date_parse=brwsr.ff?function(e){var t=Date.parse(e);if(isNaN(t)){var n=e.lastIndexOf(".");t=Date.parse(e.substr(0,n),10)+parseInt(e.substr(n+1,3),10)}return t}:Date.parse,brwsr.document_body=brwsr.ff?document.documentElement:document.body,brwsr.mousewheel=brwsr.ff?"DOMMouseScroll":"mousewheel";var DelayBuffer=function(e,t){this.tgt=e,this.delay=t,this.id=null,this.do_tgt=this.do_tgt.bind(this)};DelayBuffer.prototype={do_tgt:function(){this.id=null,this.tgt()},delayed_do:function(e){null===this.id&&(void 0===e&&(e=this.delay),this.id=setTimeout(this.do_tgt,"number"==typeof e?e:this.hasFocus?e.fg:e.bg))},cancel:function(){null!==this.id&&(clearTimeout(this.id),this.id=null)},get_bound_func:function(){return this.delayed_do.bind(this)},hasFocus:!0};var Watchdog=function(e,t){DelayBuffer.call(this,e,t)};Watchdog.prototype={start:function(e){this.delayed_do(e)},stop:function(){this.cancel()},restart:function(e){this.cancel(),this.delayed_do(e)},get_bound_func:function(){return this.restart.bind(this)},__proto__:DelayBuffer.prototype};var common_func={Object_modifyDescriptor:function(e,t,n){n.__proto__=Object.getOwnPropertyDescriptor(e,t),Object.defineProperty(e,t,n)},Object_defProps:function(e,t){for(var n in t)e[n]=t[n];return t},Array_toObj:function(e,t){for(var n={},r=0;r<e.length;r++)n[e[r]]=t;return n}},site0=function(){var e=window.location.href,t=null,n=null,r=null,e=window.location.href;e.indexOf("/meguca.org/")!=-1?(t="meguca",n={pref2:{meguca:{utilize_boards_json:!1,utilize_boards_json_domain:!1}},thread:{env:{disp_offset:3}},scan:{max:100},proto:{env:{event_dynamic:!0}},style:{zIndex:300},tooltips:{zIndex:302}},r=!0):e.search(/(4chan(nel)*|4cdn).org/)!=-1?(t="4chan",n={catalog_expand_with_hr:!0,page:{env:{disp_filler:"<hr>"}},patch:{delayed_invoke:{use:brwsr.ff}},catalog:{t2h_sel:"N",thumbnail:{hover:{popup_zIndex:100001}},env:{popup_native:!1}},proto:{footer:{rOP:!1,iOP:!1},env:{event_dynamic:!0}},easy2:{limits:2},style:{addSS:{str:"//s.4cdn.org/css/flags.689.css"}}}):e.indexOf("lainchan.org")!==-1?(t="lain",n={page:{env:{disp_offset:1}},catalog:{image_hover:!0,board:{all_boards:!0},env:{disp_offset:1,disp_filler:"                                        "}},proto:{env:{localtime_native:!1,colorID_native:!1}},stats:{time_unit:3,patch_tm:!0},chart:{inst:{show:{p:!0},time_sel:3}},easy2:{limits:1},thread_reader:{own_posts_tracker:!0}}):e.indexOf("lainchan.jp")!=-1?(t="lainjp",n={page:{env:{disp_offset:1}},proto:{env:{localtime_native:!1,colorID_native:!1}},stats:{time_unit:3,patch_tm:!0},chart:{inst:{show:{p:!0},time_sel:3}},catalog:{image_hover:!0,board:{all_boards:!0},env:{disp_offset:1,disp_filler:" "}},thread:{auto_update:!0},thread_reader:{own_posts_tracker:!0},scan:{max:100},liveTag:{style:{urtm:"color:lime !important;font-weight:bold !important",ur:"color:limegreen !important;font-weight:bold !important",in:"color:red !important"}},virtualBoard:{scanDelay:1},easy2:{limits:1},style:{post_new:"border:2px solid red !important"}},r=!0):e.search(/8kun.top/)!=-1?(t="8chan",n={catalog_expand_with_hr:!0,page:{env:{disp_offset:1,disp_filler:"<hr>"}}}):e.search(/krautchan.net/)!=-1&&(t="KC",n={thread_reader:{own_posts_tracker:!0,check_num_of_children:!1},proto:{env:{popup_native:!1,expand_thumbnail_inline_native:!1,image_hover_native:!1,colorID_native:!1,backlink_native:!1,localtime_native:!1,auto_update_native:!1}},page:{use_expander_always:!0}});var a=["meguca","4chan","lain","lainjp","8chan","KC"];t&&a.unshift(a.splice(a.indexOf(t),1)[0]);var s=["8chan","8chan_live","vichan","KC","4chan_i","4chan","4chanB","4chanR","meguca","imeguca","lain","lainjp"];return r&&(r={catalog:{auto_load_filter:!0,auto_save_filter:!0,auto_save_filter_at_refresh:!0},liveTag:{use:!1,from:"op"},virtualBoard:{max:100,scan:!0,scan_domains:{}},network:{fetch_actively:!1},easy2:{presets:1,VB:{local:1},catalog:{auto_update:!1},page:{auto_update:!1}}},r.virtualBoard.scan_domains[t]="board"),{domain:t,domains:a,pref_default:n,pref_default2:r,isStep:window.opener&&s.indexOf(window.name)!=-1,add_domain:function(e){this.domains.push(e),this.debug_domains.push(e),pref.virtualBoard.scan_domains[e]="none",pref.debug_mode.domains[e]=!0},debug_domains:["DEFAULT","4chan","vichan","lain","lainjp","8chan","8chan_live","KC","meguca","meguca1","meguca2"],debug_types:["","_json","_html"]}}(),pref4={funcs:{set_options_to_selector:function(e,t){e.length=t.length;for(var n=0;n<t.length;n++)e.options[n].text=t[n]}},archive:{IDB_board_sel_gfunc_pre:function(e,t,n,r,a){pref4.funcs.set_options_to_selector(a,pref4.archive.IDB_board_sel_options||["Wait..."])},IDB_board_sel_options:null,IDB_thread_sel_gfunc_pre:function(e,t,n,r,a){pref4.funcs.set_options_to_selector(a,pref4.archive.IDB_thread_sel_options||["Wait..."])},IDB_thread_sel_options:null},refresh:{count:0},search_posts_active_once:!1,scan:{get loosen(){return pref4.search_posts_active_once&&pref.proto.searchAc.loosen},get max(){return"archive"===site.whreami?pref.scan.max_archive:this.loosen?pref.proto.searchAc.max:pref.scan.max},get max_threads(){return"archive"===site.whreami?pref.scan.max_archive:this.loosen?pref.proto.searchAc.max_threads:pref.scan.max_threads},max_threads_at_refresh:function(e){return this.loosen?pref.proto.searchAc.max_threads_at_refresh:e.pref.INST.safety.max}},mergeHist:{max:16,proto:[]}},pref0={triage:{menu_str:"KILL,Hide permanently,\nTIME,Hide until new replies,\nWATCH,Watch,\nUNWATCH,Unwatch,\nSTICKY,Sticky,\nUNSTICKY,Unsticky,\nUNDO,Undo,",postMenu_str:"PHIDE,hide,\nPHIDEAFTER,hide+,\nPUNHIDE,unhide,\n"},footer:{native:"(ar )(U: nm/nr / )(<iB>)R: (lp/)(RP)(*sp)(+dp)(</iB>)( /<iI> I: IM</iI>)( / P: pg) (ni/nf )(ct )(cT )(bt )(bT )(pt )(pT )(pr )(dn)(bd)(no) ",custom2:"(ar )(nm/)(nr/)(<iB>)(lp/)(RP)(*sp)(+dp)(</iB>)(/<iI>IM</iI>)(/pg) (ni/nf) (ct )(cT )(bt )(bT )(pt )(pT )(pr )(dn)(bd)(no) ",custom3:'(ar )(nm/)(nr/)(lp/)(<iB style="color:orange">RP</iB>)(<u>*sp</u>)(<span style="opacity:0.6">+dp</span>)(/<iI style="color:orange">IM</iI>)(/pg) (<u>ni/nf</u>) (ct )(cT )(bt )(bT )(pt )(pT )(pr )(dn)(bd)(no) '}},gGEH={get_key_rec:function(e){return this.get_key_recursive(e.target,e.currentTarget)},get_key_recursive:function(e,t,n){for(var r;e&&!(r=this.pns_all_keys.get(e))&&e!==t;)e=e.parentNode;return r&&(n||"string"==typeof r||(r=r.lths[0].key)),r},pns_all_keys:new WeakMap,pns_resize:new WeakMap,triage_in:null,triage_in2:null,last_viewed:null,time_jumped:0,drag:{sx:0,sy:0,effect:null,callback:null,move:null,started:function(e,t,n,r){this.sx=e.screenX,this.sy=e.screenY,document.body.addEventListener("dragover",this.dragover,!1),e.currentTarget.addEventListener("dragend",this.dragend,!1),this.effect=n,this.callback=t,this.move=r,e.stopPropagation()},dragover:function(e){e.preventDefault(),e.dataTransfer.dropEffect=gGEH.drag.effect},dragend:function(e){document.body.removeEventListener("dragover",gGEH.drag.dragover,!1);var t=e.currentTarget;t.removeEventListener("dragend",gGEH.drag.dragend,!1);var n=e.screenX-gGEH.drag.sx,r=e.screenY-gGEH.drag.sy;if(gGEH.drag.move){var a=t.style;pref.catalog_popup_size_fix&&"true"===t.dataset.isPopup&&(a.width=t.offsetWidth+"px",a.height=t.offsetHeight+"px"),a.left?a.left=parseInt(a.left,10)+n+"px":a.right=parseInt(a.right,10)-n+"px",a.top?a.top=parseInt(a.top,10)+r+"px":a.bottom=parseInt(a.bottom,10)-r+"px"}gGEH.drag.callback&&gGEH.drag.callback(e,n,r),gGEH.drag.callback=null,e.stopPropagation()}}},pref_func={delete_null:function(e){for(var t in e)null===e[t]?delete e[t]:"object"!=typeof e[t]||Array.isArray(e[t])||pref_func.delete_null(e[t])},pref_overwrite:function(e,t,n,r){for(var a in t)if(r||void 0!==e[a]&&(null!==e[a]||pref&&pref.test_mode[117])){if(n&&typeof t[a]!=typeof e[a])continue;"object"!=typeof t[a]||Array.isArray(t[a])?e[a]!==t[a]&&(e[a]=t[a]):pref_func.pref_overwrite(e[a],t[a],n,r)}return e},parseJSONCs:function(){function e(e,t,n){return 0===e.search(/^[\s\n]*$/)?0:(n||console.log("WARNING: "+t+": There are extra characters in JSON: "+e),1)}return function(t,n,r,a,s,i){for(var o={pass:0,fail:0,extra:0,prefix:0},l="",p="",c=0,_=0,d=-1;++d<t.length;)if('"'===t[d])for(;++d<t.length&&('"'!==t[d]||"\\"===t[d-1]););else if("{"===t[d])0==_++&&(l=p+t.slice(c,d),l&&(o.prefix+=e(l,r,a)),p="",c=d);else if("}"===t[d]){if(--_<=0){if(p+=t.slice(c,d+1),0===_){var u=void 0;try{u=JSON.parse(p),o.pass++}catch(e){console.log("ERROR: "+r+": in parsing JSON strings: "+p),console.log(e),o.fail++}void 0!==u&&n(u,l.replace(/^[\s\n]*/,""),s,i)}else _<0&&(o.extra+=e(p,r),_=0);p="",c=d+1}}else if("/"===t[d])if("/"===t[d+1]){for(p+=t.slice(c,d),d++;++d<t.length&&"\n"!==t[d];);c=d+1}else if("*"===t[d+1]){for(p+=t.slice(c,d),d++;++d<t.length&&("/"!==t[d]||"*"!==t[d-1]););c=d+1}return c===t.length&&""===p||(o.extra+=e(p+t.slice(c),r)),o}}(),queryOrSet_params_by_JSON:function(){function query_or_overwrite(obj,prefix,query,enables){for(var i in obj)"site2"!==i&&"pref"!==i&&"pref_func"!==i&&"liveTag"!=i&&"site3"!==i||enables&&enables.indexOf(i)==-1||(query?str_out='{"'+i+'":'+pref_func.pref_query(query===!0?eval(i):query,obj[i])+"}\n":pref_func.pref_overwrite(eval(i),obj[i],void 0,"site2"===i))}var str_out;return function(e,t,n,r){if(t){str_out="";var a=this.parseJSONCs(t,query_or_overwrite,"JSON_CLI",!1,e,n);if(r){var s=a.extra+a.prefix,i=0===a.fail&&0===s;r.style.color=i?"":"red",r.textContent=(i?"OK":(a.fail>0?"Failed:"+a.fail:"")+(s>0?(a.fail>0?", ":"")+"Extra strings:"+s:""))+", Passed:"+a.pass+" @"+(new Date).toLocaleString()}e&&i&&(pref.cli.json_str=str_out)}}}(),site2_json:function(e,t,n){this.queryOrSet_params_by_JSON(e,pref.cli.json_str,n)},sanitize:function(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}},pref=pref_default();!function(){function e(e){var t=e&&e[pref.script_prefix+".pref"];if(t){var n=JSON.parse(t);n.proto&&(pref_func.pref_overwrite(pref.proto,n.proto,!0),delete n.proto),pref_func.pref_overwrite(pref,n,!0)}}e(localStorage);for(var t in{catalog:null,page:null,float:null,thread:null})pref[t].save_board_list_sel||(pref[t].board_list_sel=0);if(e(sessionStorage),window.name)for(var t in{catalog:null,page:null,float:null,thread:null})pref[t].board_list_sel=0;if(pref.cli.auto&&pref_func.site2_json(!1,!0,["pref"]),pref.script_prefix=pref_func.sanitize(pref.script_prefix),site0.isStep){for(var t in pref.features)"domains"!==t&&(pref.features[t]=!1);for(var t in pref.features.domains)t!==site0.domain&&(pref.features.domains[t]=!1);brwsr.sw_cache=null,pref_func.pref_overwrite(pref,{catalog:{auto_update:!1},thread:{auto_update:!1},page:{auto_update:!1},float:{auto_update:!1},virtualBoard:{scan:!1},stats:{auto_acquisition_scan:!1},cloudflare:{auto_reload:!1}})}}();var pref3={stats:{use:null,estimate_posts:null},reload_required:!1,filter:{time_str:function(e,t,n,r){r.time_obj6=Date.parse(n)}},notify:{sound:{file:null}},archive:{working:!1,list_str:function(e,t,n){e[t.replace(/str$/,"obj2")]=pref_func.str2obj2(n)},list_obj2:null,jsons:null,imgs:null,dir:null},proto:{merge_list_str:function(e,t,n){this.merge_list_obj2_old||(this.merge_list_obj2_old=this.merge_list_obj2);var r=null,a=!0;this.merge_list_obj2=pref_func.str2obj2(n.replace(/\s*\+\s*/g,",+"),"merge",null,function(e,t){var n="+"===e[0],s=(n?e.slice(1):e)||"DEFAULT",i=common_func.name2domainboardthread(s,!0);i[0]&&i[1]&&i[2]||(a=!1),n&&r?r[r.length]=s:r=[s],t[s]=r}),a&&(this.merge_list_obj2[":F"]=!0)},merge_list_obj2:null,merge_list_obj2_old:null,merge_lv_str:function(e,t,n){this.merge_lv_obj2_old||(this.merge_lv_obj2_old=this.merge_lv_obj2),e.merge_lv_obj2=pref_func.str2obj2(n,"merge_lv",null,"val")},merge_lv_obj2:null,merge_lv_obj2_old:null},test_mode:{js_file:null}},gClg,pClg,debugWindow,cataLog={threads:null,scan_boards:null,scan_init:null,embed_mode:null,format_html:null,show_catalog:null,get_ref_height:null,catalog_obj2:null,healthIndicator:null,parent:null,general_event_handler:null,catalog_refresh_end:null,image_hover_reentry:null,image_hover_remove:null,scan_boards_keyword_callback2:null,scan_boards_keyword_callback2_default_args:null,catalog_filter_query_keyword:null,set_watch_time_thread:null,event_func:null,restore_th_from_IDB:null,components:null,triage:null,GEH:null,insert_myself:null,DIH:null,auto_update:null,gClg:null,InfoPv:null};pref_func=function(){return{__proto__:pref_func,mirror_targets:{pn12_0_2:null,pn12_0_4:null,get pn13_1(){return pref_func.settings.pn13&&pref_func.settings.pn13.childNodes[1]||null},boardlist:null},mirror_names:function(){var e={"virtualBoard.max":null,"*.merge":null,"*.merge_list":null,"*.refresh_src":null,"*.refresh_src_th":null};return function(t){var n=t.split(".");return"catalog"!==n[0]&&"page"!==n[0]&&"thread"!==n[0]||(n[0]="*"),n.join(".")in e}}(),apply_prep:function(e,t,n,r,a,s,i){var o=Array.isArray(e)?e:e instanceof HTMLCollection||e instanceof NodeList?Array.prototype.slice.call(e):(o=e.querySelectorAll("input,textarea,select"+(t?"":",span[data-class=show_value]")),o.length>0?Array.prototype.slice.call(o):[e]);this.apply_prep_2_all(o,t,n,!1,a,s),i||this.apply_prep_save(e,t,n,!1,a,s),this.apply_prep_mirror(o[0],t,n,r,a,s)},apply_prep_1n:function(e,t,n,r,a,s){this.apply_prep_1(pref_func.settings.pnOrDummy(e),t,n,r,a,s)},apply_prep_1:function(e,t,n,r,a,s){this.apply_prep_2(e,t,n,!1,a,s),this.apply_prep_save(e,t,n,!1,a,s),this.apply_prep_mirror(e,t,n,r,a,s)},apply_prep_mirror:function(e,t,n,r,a,s){var i=e.name||e.getAttribute("name");if(i&&this.mirror_names(i)&&(r=!0),r){var o=[];for(var l in this.mirror_targets)this.mirror_targets[l]&&(o=o.concat(Array.prototype.slice.call(this.mirror_targets[l].getElementsByTagName(e.tagName)).filter(function(e){return e.getAttribute("name")===i})));for(var l=0;l<o.length;l++)e!==o[l]&&("INPUT"===o[l].tagName&&"radio"===o[l].type&&o[l].value!==e.value||this.apply_prep_2(o[l],!1,!1,!1,!1,s))}},apply_prep_save:function(e,t,n,r,a,s){pref.test_mode[117]?sessionStorage&&t&&(sessionStorage[pref.script_prefix+".pref"]=JSON.stringify(pref_func.site2_json_ex_remove())):sessionStorage&&(t||a)&&(sessionStorage[pref.script_prefix+".pref"]=JSON.stringify(pref))},apply_prep_2_all:function(e,t,n,r,a,s){for(var i=0;i<e.length;i++)this.apply_prep_2(e[i],t,n,!1,a,s)},apply_prep_2:function(e,t,n,r,a,s){var i=e.name||e.getAttribute("name");if(i&&"button"!=e.type){var o=pref_func.get_tgt(i,"file"===e.type?pref3:s||t!==!0&&t||null),l=o[0],p=o[1];if(l){var c=e.tagName;if("INPUT"===c)"file"===e.type?!t&&l[p]&&l[p]!==e?e.parentNode.replaceChild(l[p],e):l[p]=e:t?this.apply_prep_set(l,p,e,i):this.apply_prep_load(e,l,p),(t||a)&&"string"==typeof l[p]&&"text"===e.type&&"str"===p.substr(-3,3)&&l[p.slice(0,-3)+"obj6"]&&pref_func.str2obj6(l,p,e.value,i);else if("TEXTAREA"===c){if(t?l[p]=e.value:e.value=l[p],(t||a)&&"str"===p.slice(-3)){var _=p.slice(0,-3);l[_+"obj"]?pref_func.str2obj(p):l[_+"obj2"]?l[_+"obj2"]=pref_func.str2obj2(e.value):void 0!==l[_+"obj5"]?pref_func.str2obj5(l,_+"obj5",e.value,"rm_list_str"===p):null===l[_+"obj6"]?pref_func.str2obj6(l,p,e.value,i):void 0!==l[_+"obj7"]&&(void 0!==l[_+"obj7_old"]&&(l[_+"obj7_old"]=l[_+"obj7"]),l[_+"obj7"]=pref_func.str2obj7.s2o({},e.value,i))}}else if("SELECT"===c)t?this.apply_prep_set(l,p,e,i):(l[p+"_gfunc_pre"]&&l[p+"_gfunc_pre"](l,p,l[p],i,e),this.apply_prep_load(e,l,p));else if("SPAN"===c&&!t&&"show_value"===e.getAttribute("data-class")){var d=l[p],u=this.apply_prep_2_str[p+":"+l[p]];u&&(d="string"==typeof u?u:u(l)),e.textContent=d.toString().replace(/^./,function(e){return e.toUpperCase()})}n&&(e.oninput&&e.oninput.call(e,{currentTarget:e,target:e},!0),e.onchange&&e.onchange.call(e,{currentTarget:e,target:e},!0))}}},apply_prep_set:function(e,t,n,r){var a=typeof e[t];if("number"===a){var s;e[t]="SELECT"===n.tagName?n.selectedIndex:(s=r&&"_f"===r.substr(-2)?parseFloat(n.value):parseInt(n.value,10),isNaN(s)?0:s)}else"boolean"===a?e[t]=n.checked:"string"===a&&("text"===n.type||"SELECT"===n.tagName||n.checked)&&(e[t]=n.value)},apply_prep_load:function(e,t,n){var r=t[n];if("SELECT"===e.tagName)e.selectedIndex="number"==typeof r?(r>=e.length&&(t[n]=0),t[n]):Array.prototype.slice.call(e.options).map(function(e){return e.value}).indexOf(t[n]);else{var a=typeof r;"number"==a?e.value=r:"boolean"==a?e.checked=r:"string"==a&&("text"===e.type?e.value=r:r===e.value&&(e.checked=!0))}},apply_prep_2_str:{"t2h_sel:L":function(e){return e.t2h_L},"t2h_sel:M":function(e){return e.t2h_M},"t2h_sel:N":function(e){return e.t2h_N},"t2h_sel:N_unread":function(e){return e.t2h_N+"+unread"},"t2h_sel:unread":"All unread","posts_search_op:opaque":function(e){return"opaque "+e.posts_search_op_opacity+"%"}},catalog_board_list_str_or:"",catalog_board_list_str_bt:"",catalog_board_list_str_bt_same:"",add_onchange:function(e,t,n){return this.set_event_target(e,this.add_onchange_entry_func.bind(t),n,t)},add_onchange_entry_func:function(e,t){var n=e.currentTarget.getAttribute("name");if(t||["INPUT","TEXTAREA","SELECT"].indexOf(e.currentTarget.tagName)==-1||pref_func.apply_prep_1(e.currentTarget,this["."]&&this["."].pref||!0),this[n])this[n].call(this,e);else if(this[n+" w/"])this[n+" w/"].call(this,e,n);else{var r=n.indexOf(".");if(r!=-1){var a=n.substr(r);if(this["*"+a])this["*"+a].call(this,e);else if(this["*w/"+a])this["*w/"+a].call(this,e,n);else{var s=n.lastIndexOf(".");if(s!=-1){var a=n.substr(0,s+1)+"*";if(this[a])this[a].call(this,e);else if(this[a+"w/"])this[a+"w/"].call(this,e,n);else{var i=n.split("."),o=i.slice(0,-2).join(".")+".*."+i.slice(-1)[0];if(this[o])this[o].call(this,e);else{var l=n.split(".").slice(0,-2).join(".")+".*.*w/";if(this[l])this[l].call(this,e,n);else if(r!=-1){var p=n.substr(0,r),c=n.substr(r+1);this[p]&&this[p][c]&&this[p][c](e)}}}}}}}},add_onchange_format:function(e){for(var t=Object.keys(e),n=0;n<t.length;n++)"string"==typeof e[t[n]]&&(e[t[n]]=e[e[t[n]]]);return e},set_event_target:function(){function e(e){n=e?e.target:null}function t(){n&&pref_func.apply_prep_1(n,!0)}var n=null;return window.addEventListener("beforeunload",t,!1),function(t,r,a,s){var i=function(e,t){n=null,r.call(this,e,t)},o=t.getElementsByTagName("*");0==o.length&&(o=[t]);for(var l=0;l<o.length;l++){var p=o[l].getAttribute("name");if(p){var c=o[l].tagName;"INPUT"===c||"TEXTAREA"===c||"SELECT"===c?a&&a[o[l].name]?o[l].oninput=i:(o[l].onchange=i,("INPUT"===c&&"text"===o[l].type||"TEXTAREA"===c)&&(o[l].oninput=e)):"BUTTON"===c?o[l].onclick=i:"A"===c?o[l].onclick=r:"SPAN"!==c&&"DIV"!==c||("SUB"===p&&(o[l].onchange=r),"SHOW2_I"!==p&&"SHOW4"!==p&&"HIDE4"!==p||(o[l].onclick=r))}}return i}}(),str2obj:function(e){var t=e.replace(/str$/,"obj");pref[t]=[],t=pref[t];var n="boards"===site.whereami?site2[site.nickname].boards_sel_from_tags():site.board+("thread"===site.whereami?site.no:"");if("//"===n&&(n="/ROOT_DUMMY/"),n+=","+n+"\n"+pref[e]+"\n",pref.catalog.board.recommendation){var r=site2[site.nickname].get_owners_recommendation();pref_func.catalog_board_list_str_or=r,n=n+r+"\n"}pref.catalog.board.board_tags&&""!==pref_func.catalog_board_list_str_bt&&(n=n+pref_func.catalog_board_list_str_bt+"\n"),pref.catalog.board.board_tags_same&&""!==pref_func.catalog_board_list_str_bt_same&&(n=n+pref_func.catalog_board_list_str_bt_same+"\n");for(var a=n.split("\n"),s=-1,i=0;i<a.length;i++){for(var o=a[i].replace(/\s*\/\/.*/,"").replace(/, +/g,",").split(","),l=0;l<o.length&&""==o[l];)l++;if(o[l]){t[++s]=[{key:o[l++]}];for(var p=0;l<o.length;)""!==o[l]&&(o[l].search(/^\s*!?#/)!==-1?(t[s][0].tags||(t[s][0].tags=[]),t[s][0].tags[t[s][0].tags.length]=o[l].replace(/\s/g,"")):o[l].search(/^\s*!/)!==-1?(t[s][0].cmds||(t[s][0].cmds=[]),t[s][0].cmds[t[s][0].cmds.length]=o[l].replace(/\s/g,"").substr(1)):(t[s][++p]={},t[s][p].key=o[l].replace(/[\*\^!].*/,"").replace(/\s/g,""),o[l].search(/\*/)!=-1&&(t[s][p].max_page=parseInt(o[l].replace(/[^\*\^!]*[\*\^!]/,"").replace(/[\^!].*/,""),10)),o[l].search(/\^/)!=-1&&(t[s][p].style=o[l].replace(/[^\*\^!]*[\*\^!]/,"").replace(/[\*!].*/,"")))),l++}}pref.catalog.board.all_boards&&(t[t.length]=[{key:"ALL"},{key:site.nickname}]);for(var i=0;i<t.length;i++)for(var l=1;l<t[i].length;l++){var c=t[i][l].key.replace(/\/.*/,"");""==c&&(c=site.nickname);var _="/"+t[i][l].key.replace(/[^\/]*\//,"").replace(/\/.*/,"")+"/";1==l?(t[i][0].domain=c,t[i][0].board=_):(t[i][0].domain!=c&&(t[i][0].domain=null),t[i][0].board!=_&&(t[i][0].board=null))}for(var i=0;i<t.length;i++)for(var l=1;l<t[i].length;l++){var d=common_func.name2domainboardthread(t[i][l].key,!1);t[i][l].key=common_func.name2domainboardthread(t[i][l].key,!0).join(""),""===d[1]&&""===d[2]&&(t[i][0].domains_for_all_boards||(t[i][0].domains_for_all_boards=[]),t[i][0].domains_for_all_boards[t[i][0].domains_for_all_boards.length]=d[0],t[i].splice(l--,1))}},get_tgt:function(e,t,n){t||(t="#"===e[0]?liveTag.tags:pref);for(var r=e.split("."),a=0;a<r.length;a++){if(n&&void 0===t[r[a]])return null;if(a==r.length-1)return[t,r[a]];t=t[r[a]]}},str2obj2:function(){function e(e,n){var r=e.replace(/[@;].*/,"").replace(/^\s*/,""),a=e.slice(r.length).replace(/@/g,";@").split(";").filter(function(e){return e});r||(r="DEFAULT"),n[r]||(n[r]={});for(var s=0;s<a.length;s++)t(n[r],a[s])}function t(e,t){if("@"===t[0])e.time=0==t[1]?0:brwsr.Date_parse(t.slice(1));else{var n=0===t.search(/^[A-Z]/)?"cmd":"style",r=t.split(":");e[n]||(e[n]={}),"cmd"!==n||"null"!==r[1]&&""!==r[1]?e[n][r[0]]="cmd"!==n?r[1]:1===r.length||"true"===r[1]||"false"!==r[1]&&r[1]:delete e[n][r[0]]}}function n(e,t){"+"===e[0]&&(e=e.slice(1));var n=e.replace(/[@;:].*/,"")||"DEFAULT",r=n.indexOf("/"),a=n.lastIndexOf("/");if(r>0&&r!==a&&a!=n.length-1){var s=n.slice(0,a+1);t[s]||(t[s]={}),t[s][n.slice(a+1)]=null}}function r(e,t){e=e.replace(/\s*/g,"");var n=e.indexOf(":");t[n>=1?e.substr(0,n):"DEFAULT"]=e.substr(n+1)}function a(e,t,n,r){delete this[e],delete t[n];var a=e.replace(/\+/,"\\+")+"([\\^@;:][^,\n]*)*";return r.replace(new RegExp("(^|,)"+a+"([,\n]+\\s*\\+*|$|\\+)","mg"),"$1").replace(new RegExp("\\+\\s*"+a+"(,|\n|$|\\s*\\+)","mg"),"$2")}function s(e,t){var n=t.indexOf("/"),r=t.lastIndexOf("/");if(n>0&&n!==r&&r!=t.length-1){var a=t.slice(0,r+1);return e[a]?delete e[a][t.slice(r+1)]:console.log("Error: an inconsistency was found in str2obj2.obj3_rm: "+t),!0}}function i(e,t,n,r){var a=e&&o(n,e),s=o(n,t);if(s&&(!e||a||r)){n="+"===s[1]?n.slice(0,s.index)+n.slice(s.index+s[0].length):n.slice(0,s.index+s[1].length)+n.slice(s.index+s[0].length+s[3].length);var i=s[0].length+("+"===s[1]?0:-s[1].length+s[3].length)}if(e)if(a){var l=(s&&a.index>s.index?a.index-i:a.index)+a[0].length;n=n.slice(0,l)+"+"+t+n.slice(l)}else s&&!r?n=n.slice(0,s.index+s[1].length)+e+"+"+n.slice(s.index+s[1].length):n+="\n"+e+"+"+t+"\n";return pref_func.fmt4str2(n)}function o(e,t){var n=t.replace(/\+/,"\\+");return new RegExp("(^|,|\\+)\\s*"+n+"(s*)(?=(,|\n|$|\\+))","mg").exec(e)}var l={_revise:function(t,r){r&&(r=r.replace(/\s*\/\/.*/gm,"").replace(/\n/g,",").replace(/\s*$/,"").split(/\s*,\s*/)[0]);var a=t in this;a&&(r||s(this[":REV"],t),delete this[t]),r&&(e(r,this),a||n(r,this[":REV"]))}},p={_revise:function(e,t,r,a,o){var l=this,p=l[e],c=l[t];if(!pref.test_mode[192]){if(o||(o={__proto__:l}),p)for(var _=p.slice(),d=0;d<p.length;d++)o.hasOwnProperty(p[d])||(o[p[d]]=_);else e&&!o.hasOwnProperty(e)&&(o[e]=void 0);if(c)for(var u=c.slice(),d=0;d<c.length;d++)o.hasOwnProperty(c[d])||(o[c[d]]=u);else o.hasOwnProperty(t)||(o[t]=void 0)}var f,h=c&&c.slice();c&&(!e||p||a)&&c.splice(c.indexOf(t),1),e?p?(p.splice(p.indexOf(e)+1,0,t),l[t]=p,f=h||[t]):c&&!a?(c.splice(c.indexOf(t),0,e),l[e]=c,f=p||[e]):l[e]=l[t]=f=[e,t]:(delete l[t],f=h);var m=l[":REV"];return e&&!p&&n(e,m),e&&!c?n(t,m):!e&&c&&s(m,t),r=i(e,t,r,a),c&&1==c.length&&s(m,c[0])&&(delete l[c[0]],r=i(null,c[0],r)),{str:r,tgts:f,old:o}},_rm:function(e,t,n,r){var i=this[e];return i.length>1&&(i.splice(i.indexOf(e),1),1==i.length&&s(this[":REV"],i[0])&&(delete this[i[0]],r=site2.DEFAULT.update_posts_merge_bases.add_to_list_2(null,i[0],r))),a.call(this,e,t,n,r)}},c={_revise:function(e,t,n,r){var a=e.lastIndexOf("/"),s=e.slice(0,a+1),i=this[":REV"][s],o=e.slice(a+1);n?(delete this[e],delete i[o]):(this[e]=t,i||(i=this[":REV"][s]={}),i[o]=null);var l=new RegExp("(^|,)\\s*"+e+"(:[^,\n]*)*(,|\n|$)","mg");return pref_func.fmt4str2(r.replace(l,",")+"\n"+(n?"":e+":"+t+"\n"))},_rm:a};return function(t,a,s,i){for(var o="merge"===a?{__proto__:p}:"merge_lv"===a?{__proto__:c}:a||{__proto__:l},_=t.replace(/\s*\/\/.*/gm,"").replace(/\n/g,",").replace(/\s*$/,"").split(/\s*,\s*/),d="val"===i?r:i||e,u=0;u<_.length;u++)_[u]&&d(_[u],o);if(s)return o;for(var f={},u=0;u<_.length;u++)_[u]&&n(_[u],f);return o[":REV"]=f,o}}(),fmt4str2:function(e){return e.replace(/,,+/g,",").replace(/^,/g,"").replace(/\n,/g,"\n").replace(/\n\n+/g,"\n").replace(/^\n/,"")},str2obj5:function(e,t,n,r){e[t]={};for(var a=e[t],s=n.replace(/\s*\/\/.*/gm,"").replace(/\n/g,",").split(","),i=0;i<s.length;i++){var o=s[i].replace(/\s*:\s*/,":").replace(/\s+$/,"");if(""!=o){var l,p=o.indexOf(":"),c=p!=-1?o.substr(0,p):"DEFAULT",_="/"===o[p+1]&&(l=o.lastIndexOf("/"))>p+2,d=_?o.slice(p+2,l):o.slice(p+1),u=(r?"g":"")+(_?o.slice(l+1).replace(/g/,""):"");void 0===a[c]&&(a[c]=[]);try{a[c][a[c].length]=new RegExp(_?d:this.str2rstr(d,r),u)}catch(e){console.log("ERROR at str2obj5 in string of: "+s[i])}}}},str2rstr:function(e,t){return e.replace(/[\.\(\)\[\]\+\^\$\{\}]/g,"\\$&").replace(/\*/g,t?"\\S*(\\s|\\n|$)":".*").replace(/\?/g,".")},str2obj7:function(){function e(e,t,n,r){e.__proto__=r,e.rexps=common_func.kwd_prep_regexp(e);var a=t.trim().replace(/\s*[;:]\s*/,"")||"DEFAULT";void 0===n[a]?n[a]=[e]:n[a][n[a].length]=e}var t={use:!0,str:"",re:!1,ci:!0,match:0,sentence:!1,ew:!1,op:!0,post:!1,sub:!0,name:!0,trip:!1,com:!0,file:!1,meta:!1,flag:!1,id:!1,id2:!1,cmds:"",hide:!1,boards:null,style:""},n={post:!0,__proto__:t};return{s2o:function(r,a,s){return pref_func.parseJSONCs(a,e,s,!0,r,s.indexOf("postFilter")!=-1?n:t),r},o2s:function(e,r){var a={},s=r?n:t;for(var i in s)s[i]!=e[i]&&(a[i]=e[i]);return delete a.use,e.sentence&&e.str.indexOf(" ")===-1&&delete a.sentence,JSON.stringify(a)}}}(),merge_obj5:function(e,t,n){return this.merge_obj5_all(e,t,n,this.merge_obj5_1)},merge_obj5a:function(e,t,n){return this.merge_obj5_all(e.key,t,n,this.merge_obj5_1a)},merge_obj5a_sc:function(e,t,n){if(":F"in t)return t[e];var r=common_func.fullname2dbt(e);return t[e]||t[r[1]+r[2]]||t[r[0]+r[2]]||t[r[2]]||t[r[0]+r[1]]||t[r[1]]||t[r[0]]||t.DEFAULT||n},merge_obj5_all:function(e,t,n,r){var a=common_func.fullname2dbt(e);return n=r(n,t,"DEFAULT"),n=r(n,t,a[0]),n=r(n,t,a[1]),n=r(n,t,a[0]+a[1]),n=r(n,t,a[2]),n=r(n,t,a[0]+a[2]),n=r(n,t,a[1]+a[2]),n=r(n,t,e)},merge_obj5_1:function(e,t,n){if(t[n]){var r=t[n];e||(e={});for(var a in r)if("object"!=typeof r[a])e[a]=r[a];else{void 0===e[a]&&(e[a]={});for(var s in r[a])e[a][s]=r[a][s]}}return e},merge_obj5_1a:function(e,t,n){var r=t[n];return r?e?e.concat(r):r:e},str2obj6:function(e,t,n,r){var a=pref_func.get_tgt(r,pref3);a[0][a[1]](a[0],t,n,e)},obj_init_hier:function(e,t){for(var n in e)"object"==typeof e[n]&&t[n]?this.obj_init_hier(e[n],t[n]):"function"==typeof e[n]&&e[n](e,n,t[n],t)},obj_init:function(){pref_func.str2obj("catalog_board_list_str"),pref.catalog.style_general_list_obj2=pref_func.str2obj2(pref.catalog.style_general_list_str),pref.catalog.board.ex_list_obj2=pref_func.str2obj2(pref.catalog.board.ex_list_str),pref_func.str2obj5(pref.liveTag,"ex_list_obj5",pref.liveTag.ex_list_str),pref_func.str2obj5(pref.liveTag,"rm_list_obj5",pref.liveTag.rm_list_str),pref_func.settings.onchange_funcs.archive["kwd.*"](),this.obj_init_hier(pref3,pref),pref.postFilter.obj7=pref_func.str2obj7.s2o({},pref.postFilter.str,"postFilter.str")},obj_elim_the_same:function(e,t,n,r){var a=!1;for(var s in e)if(e.hasOwnProperty(s)&&!Object.getOwnPropertyDescriptor(e,s).get||t.hasOwnProperty(s))if("object"==typeof e[s]&&t[s]&&"object"==typeof t[s])pref_func.obj_elim_the_same(e[s],t[s],n,!0)?(a=!0,n||(Array.isArray(e[s])||Array.isArray(t[s]))&&(e[s]=t[s])):delete e[s];else if(e[s]===t[s]){var i;!e.hasOwnProperty(s)&&(i=Object.getPrototypeOf(t))&&i!==Object.getPrototypeOf({})&&t[s]!==i[s]||delete e[s]}else a=!0,n||(e[s]=t[s]);return(Array.isArray(e)||Array.isArray(t))&&e.length!==t.length&&(a=!1),r?a:e},site2_json_ex_remove:function(){var e=pref_default(!0);delete e.INST,pref_func.obj_elim_the_same(e,pref);var t=pref_default().proto;return["catalog","page","thread","float"].forEach(function(n){pref_func.obj_elim_the_same(e[n],t,!0)||delete e[n]}),e},site2_json_ex:function(e,t){var n=this.site2_json_ex_remove();t||n.filter&&delete n.filter,e||n.catalog_board_list_str&&delete n.catalog_board_list_str,n.cli&&delete n.cli.json_str,pref.cli.json_str='{"pref":'+(t?'{"filter":'+JSON.stringify(n.filter)+"}":JSON.stringify(n))+"}"},pref_query:function(e,t){var n="";for(var r in t)void 0!==e[r]&&(n+='"'+r+'":'+("object"!=typeof t[r]||Array.isArray(t[r])?JSON.stringify(e[r]):pref_func.pref_query(e[r],t[r]))+",");return"{"+n.substr(0,n.length-1)+"}"},site2_eval:function(){},pref_samples:site0.isStep?null:{simple:{
catalog_triage_str:"KILL,X,",catalog:{style_general_list_str:"%border:4px solid #d6daf0\n%margin:4px",format:{show:{posts:!0}}}},backwash:{catalog_triage_str:"NONE,O,width:;height:,NONE,O,border:4px solid #ff0000;width:100px;height:100px,NONE,O,border:4px solid #00ff00;width:100px;height:100px,NONE,O,border:4px solid #0000ff;width:100px;height:100px,NONE,O,border:4px solid #ffff00;width:100px;height:100px,NONE,O,border:4px solid #ff00ff;width:100px;height:100px,NONE,O,border:4px solid #00ffff;width:100px;height:100px",page:{click:"expand"},catalog:{format:{show:{style:!0,contents:!0,layout:!0,posts:!0,fileinfo:!0,images_2nd:!0}}}},recommend:{max_threads_at_refresh:500,catalog:{auto_load_filter:!0,auto_save_filter:!0,auto_save_filter_at_refresh:!0,order:{sticky:"first"},board:{board_tags_same:!0},auto_update:!0,auto_update_period:1},page:{auto_update:!0,auto_update_period:1},float:{auto_update:!0,auto_update_period:1}},get easy2(){return pref.easy2},"easy2.presets":function(){var e=[{liveTag:{use:!1},virtualBoard:{scan:!1},LTfrom:0,VB:{local:0,global:0},network:{fetch_actively:!1}},{liveTag:{use:!1},virtualBoard:{scan:!0},LTfrom:0,VB:{local:1,global:0},network:{fetch_actively:!1}},{liveTag:{use:!1},virtualBoard:{scan:!0},LTfrom:0,VB:{local:1,global:1},network:{fetch_actively:!1}},{liveTag:{use:!0},virtualBoard:{scan:!0},LTfrom:0,VB:{local:2,global:0},network:{fetch_actively:!0}},{liveTag:{use:!0},virtualBoard:{scan:!0},LTfrom:0,VB:{local:2,global:1},network:{fetch_actively:!0}},{liveTag:{use:!0},virtualBoard:{scan:!0},LTfrom:0,VB:{local:2,global:2},network:{fetch_actively:!0}},{liveTag:{use:!0},virtualBoard:{scan:!0},LTfrom:1,VB:{local:2,global:0},network:{fetch_actively:!0}},{liveTag:{use:!0},virtualBoard:{scan:!0},LTfrom:1,VB:{local:2,global:1},network:{fetch_actively:!0}},{liveTag:{use:!0},virtualBoard:{scan:!0},LTfrom:1,VB:{local:2,global:2},network:{fetch_actively:!0}}],t=["none","board","thread"],n={catalog:{auto_load_filter:!0,auto_save_filter:!0,auto_save_filter_at_refresh:!0}};return function(r){var a=pref.easy2;void 0!==r&&pref_func.pref_overwrite(a,e[r]),a.virtualBoard.scan_domains={};for(var s in pref.virtualBoard.scan_domains)a.virtualBoard.scan_domains[s]=t[s===site.nickname?a.VB.local:a.VB.global];a.liveTag.from=0===a.LTfrom?"op":"post";var i={auto_update:pref.easy2.auto_update,auto_update_period:pref.easy2.auto_update_period};return a.catalog.embed&&pref_func.pref_overwrite(a,{catalog:i}),a.catalog.embed_page&&pref_func.pref_overwrite(a,{page:i}),a.thread.embed&&pref_func.pref_overwrite(a,{thread:i}),(a.filter.time_watch||a.filter.time_watch_creation)&&(a.filter.time_str=new Date(Date.now()-36e5*(a.filter.time_watch?a.time_post:a.time_op)).toLocaleString()),pref.easy2.basics&&pref_func.pref_overwrite(a,n),a}}(),"easy2.limits":function(){var e=[{virtualBoard:{max:100},scan:{max:100,max_threads:1e3},catalog:{max_threads_at_refresh:500}},{virtualBoard:{max:50},scan:{max:100,max_threads:1500},catalog:{max_threads_at_refresh:1500}},{virtualBoard:{max:150},scan:{max:100,max_threads:15e3},catalog:{max_threads_at_refresh:15e3}},{virtualBoard:{max:100},scan:{max:50,max_threads:15e3},catalog:{max_threads_at_refresh:15e3}},{virtualBoard:{max:150},scan:{max:100,max_threads:3e4},catalog:{max_threads_at_refresh:15e3}},{virtualBoard:{max:200},scan:{max:500,max_threads:1e5},catalog:{max_threads_at_refresh:15e3}},{virtualBoard:{max:200},scan:{max:1e4,max_threads:1e5},catalog:{max_threads_at_refresh:15e3}},{virtualBoard:{max:150},scan:{max:100,max_threads:15e3},catalog:{max_threads_at_refresh:15e3}}];return function(){pref_func.pref_overwrite(pref.easy2,e[pref.easy2.limits])}}(),"easy.virtualBoard_10_passive":{virtualBoard:{show:!0,scan:!0,max:20},catalog:{auto_load_filter:!0,auto_save_filter:!0,auto_save_filter_at_refresh:!0,auto_update:!0,auto_update_period:10},page:{auto_update:!0,auto_update_period:10},float:{auto_update:!0,auto_update_period:10},func:function(){for(var e in pref.virtualBoard.scan_domains)pref.virtualBoard.scan_domains[e]=e===site.nickname?"board":"none"}},"easy.virtualBoard_10":{virtualBoard:{show:!0,scan:!0,max:20},catalog:{auto_load_filter:!0,auto_save_filter:!0,auto_save_filter_at_refresh:!0,auto_update:!0,auto_update_period:10},page:{auto_update:!0,auto_update_period:10},float:{auto_update:!0,auto_update_period:10},func:function(){for(var e in pref.virtualBoard.scan_domains)pref.virtualBoard.scan_domains[e]=e===site.nickname?"thread":"none"}},"easy.virtualBoard_1":{virtualBoard:{show:!0,scan:!0,max:100,scanDelay:20},catalog:{auto_load_filter:!0,auto_save_filter:!0,auto_save_filter_at_refresh:!0,auto_update:!0,auto_update_period:1},page:{auto_update:!0,auto_update_period:1},float:{auto_update:!0,auto_update_period:1},func:function(){for(var e in pref.virtualBoard.scan_domains)pref.virtualBoard.scan_domains[e]=e===site.nickname?"thread":"none"}},"easy.virtualBoard_8_50":{virtualBoard:{show:!0,scan:!0,max:100,scanDelay:20},catalog:{auto_load_filter:!0,auto_save_filter:!0,auto_save_filter_at_refresh:!0,auto_update:!0,auto_update_period:5},page:{auto_update:!0,auto_update_period:5},float:{auto_update:!0,auto_update_period:5},func:function(){pref.scan.max=pref.easy.max_boards;for(var e in pref.virtualBoard.scan_domains)pref.virtualBoard.scan_domains[e]=e===site.nickname?"thread":"none"}},"easy.virtualBoard_8_all":{virtualBoard:{show:!0,scan:!0,max:100,scanDelay:20},scan:{max:1e4},catalog:{auto_load_filter:!0,auto_save_filter:!0,auto_save_filter_at_refresh:!0,auto_update:!0,auto_update_period:5},page:{auto_update:!0,auto_update_period:5},float:{auto_update:!0,auto_update_period:5},func:function(){for(var e in pref.virtualBoard.scan_domains)pref.virtualBoard.scan_domains[e]=e===site.nickname?"thread":"none"}},"easy.virtualBoard_interSite":{virtualBoard:{show:!0,scan:!0,max:100,scanDelay:20},catalog:{auto_load_filter:!0,auto_save_filter:!0,auto_save_filter_at_refresh:!0,auto_update:!0,auto_update_period:10},page:{auto_update:!0,auto_update_period:10},float:{auto_update:!0,auto_update_period:10},func:function(){for(var e in pref.virtualBoard.scan_domains)pref.virtualBoard.scan_domains[e]=e===site.nickname?"thread":"board"}},"easy.posts_0h":{filter:{time_str:null,time_watch:!0},func:function(){pref_func.pref_samples["easy.posts_0h"].filter.time_str=(new Date).toLocaleString()}},"easy.posts_24h":{filter:{time_str:null,time_watch:!0},func:function(){pref_func.pref_samples["easy.posts_24h"].filter.time_str=new Date(Date.now()-36e5*pref.easy.posts_ago).toLocaleString()}},"easy.threads_24h":{filter:{time_str:null,time_watch_creation:!0},func:function(){pref_func.pref_samples["easy.threads_24h"].filter.time_str=new Date(Date.now()-36e5*pref.easy.threads_ago).toLocaleString()}},"easy.embed_index":{catalog:{embed_page:!0,auto_load_filter:!0,auto_save_filter:!0,auto_save_filter_at_refresh:!0}},"easy.embed_index_lazy":{catalog:{embed_page:!0,auto_load_filter:!0,auto_save_filter:!0,auto_save_filter_at_refresh:!0,auto_watch:!1},liveTag:{use:!1},notify:{desktop:{notify:!1}},network:{fetch_actively:!1}},"easy.light":{catalog:{embed_page:!0,auto_load_filter:!0,auto_save_filter:!0,auto_save_filter_at_refresh:!0},filter:{time_watch:!1,time_watch_creation:!1},liveTag:{use:!1},stats:{use:!1},network:{fetch_actively:!1}},"easy.embed_index_infinite":{catalog_max_page_auto:!0,catalog:{embed_page:!0,auto_load_filter:!0,auto_save_filter:!0,auto_save_filter_at_refresh:!0}},"easy.embed_index_backwash":{catalog_max_page_auto:!0,catalog:{embed_page:!0,auto_load_filter:!0,auto_save_filter:!0,auto_save_filter_at_refresh:!0,auto_update:!0,auto_update_period:0},page:{auto_update:!0,auto_update_period:0},float:{auto_update:!0,auto_update_period:0}},"easy.stat_activate":{stats:{use:!0},virtualBoard:{scan:!0,scan_domains:{}},liveTag:{use:!0,from:"post"},func:function(){this.virtualBoard.scan_domains[site.nickname]="board"}},pn_samples:null,init:function(){if(!pref_func.pref_samples.pn_samples){var e=pref_func.format_html_str('General samples:<br><BTN"simple,simple"><br><BTN"backwash,backwash"><br><BTN"recommend,recommend for desktop/note"><br>Triages:<br><BTN"triage.sample.simple_kill"><br><BTN"triage.sample.simple"><br><BTN"triage.sample.basic"><br><BTN"triage.sample.basic_color"><br><BTN"triage.sample.colorful"><br><BTN"triage.sample.borders"><br><BTN"triage.sample.samples"><br><BTN"triage.sample.test"><br>'),t={simple:this.onclick_event,backwash:this.onclick_event,recommend:this.onclick_event,__proto__:pref_func.settings.onchange_funcs};cnst.make_popup(pref_func.pref_samples,"pn_samples",e,t)}},get_name:function(e,t,n){for(var r in e)"object"!=typeof e[r]?t.push(n+r):pref_func.pref_samples.get_name(e[r],t,n+r+".");return t},onclick_event:function(e,t){t||(t=pref_func.pref_samples[this.name||e.target.name]),t.func&&"function"==typeof t.func&&t.func(),pref_func.pref_overwrite(pref,t),pref_func.pref_overwrite(Tooltips.str,t);for(var n=pref_func.pref_samples.get_name(t,[],""),r=Array.prototype.slice.call(document.querySelectorAll("*[name]")),a=r.length-1;a>=0;a--)n.indexOf(r[a].name)==-1&&r.splice(a,1);r.length>0&&pref_func.apply_prep(r,!1,!0,null,!0)}},settings:{pn13:null,pnOrDummy:function(e){return this.pn13&&this.pn13.getElementsByTagName("*")[e]||{name:e,tagName:"TEXTAREA",onchange:cataLog.event_func,getAttribute:function(e){return this[e]}}},show_hide:function(e){if(null===pref_func.settings.pn13){var t=(2*e.clientX>window.innerWidth?"right":"left")+":0px:"+(2*e.clientY>window.innerHeight?"bottom:0":"top:"+site.header_height())+"px",n=cnst.init(t+":Show:tb",cnst.void_func,cnst.void_func,pref_func.settings.show_hide,cnst.void_func),r=cnst.add_to_tb(n,'<select name="settings.indexing"><option>'+pref_func.settings.options.join("</option><option>")+"</option></select>");r.getElementsByTagName("select")["settings.indexing"].selectedIndex=pref.settings.indexing<pref_func.settings.options.length?pref.settings.indexing:0,pref_func.settings.pn13=n,pref_func.settings.onchange_funcs["settings.indexing"](),pref_func.add_onchange(r,pref_func.settings.onchange_funcs_formatted),Tooltips.add_root(n.childNodes[1]),cnst.bottom_top(n)}else Tooltips.remove_root(pref_func.settings.pn13.childNodes[1]),pref_func.settings.files_store(),pref_func.settings.pn13=cnst.div_destroy(pref_func.settings.pn13,!0)},apply_pn13_1:function(e,t){pref_func.apply_prep(pref_func.settings.pn13.childNodes[1],e,t),pref_func.settings.onchange_funcs.pn13_1_warning()},files_store:function(){var e=pref_func.settings.pn13.querySelectorAll("input[type=file]");e.length>0&&pref_func.apply_prep_2_all(e,!0)},samples:{catalog:{get style_general_list_str(){return Tooltips.str["catalog.style_general_list_str"]().replace(/^[^\n]/gm,"// $&").replace(/^\n/m,"\n;background:#e5ecf9 // example for all threads\n;border:1px solid black\n8chan;background:#eef2ff;border:1px solid #d6daf0\n8chan;background:#eef2ff\nKC;background:#e0e0fc;border:1px solid #aaaacc\n4chan;background:#ffffee;border:1px solid #f0e0d6\n/a/;background:#eef2ff // color /a/ blue\n\n")}},postFilter:{get str(){return'// [Identifier:]JSONC for post filter\n// comments are started wich // or enclosed by /*...*/\n// You can edit this directly,\n//   but I recommend you to copy-paste from local postFilter whose JSONs are generated by GUI.\n// You can add identifier to each head of JSONC. If no indentifier, it will be applied to all.\n\n{"str":"cute","style":"border-left:10px solid pink"}\n\n'+Tooltips.str.Identifier.replace(/^[^\n]/gm,"// $&")+"// JSONC: is JSON but allows C-type comments in it."}},style:{userCSS:{str:'/* userCSS will be a <style> elemnt directly. You can use all CSS notations.*/\n/* comments must be enclosed by shash-aster, like this */\n\n/* levelized merge */\n.CatChan_merged1::before{float:left;content:">";}\n.CatChan_merged2::before{float:left;content:">>";}\n.CatChan_merged3::before{float:left;content:">>>";}\n.CatChan_merged4::before{float:left;content:">>>>";}\n.CatChan_merged5::before{float:left;content:">>>>>";}\n/* colored merge */\n.CatChan_merged1{border-left:10px solid red;}\n.CatChan_merged2{border-left:10px solid orange;}\n.CatChan_merged2{border-left:10px solid yellow;}\n.CatChan_merged2{border-left:10px solid green;}\n.CatChan_merged3{border-left:10px solid blue;}\n\n/* remove buttons in titleBar */\n.CatChan_titleBar button[name^="op"]{display:none} /* remove transparency buttons */\n.CatChan_titleBar button[name="roll_toggle"]{display:none} /* remove toggle button */\n.CatChan_titleBar button[name="max"]{display:none} /* remove maximize button */\n.CatChan_titleBar button[name="top"]{display:none} /* remove embed to top button */\n.CatChan_titleBar button[name="bottom"]{display:none} /* remove embed to bottom button */\n.CatChan_titleBar button[name="autoHeight"]{display:none} /* remove auto height button */\n/* give transparency to titlebar of watcher, add these 2 lines */\n.CatChan_FC>*:first-child{position:absolute;width:100%;opacity:0;top:-2em}\n.CatChan_FC>*:first-child:hover{opacity:1}\n/* remove titlebar, add these 5 lines */\n.CatChan_titleBar>*:first-child{position:absolute;width:100%;opacity:0}\n.CatChan_titleBar>*:first-child:hover{opacity:1}\n.CatChan_titleBar>*:first-child{pointer-events:none}\n.CatChan_titleBar>*:first-child>*{pointer-events:auto}\n.CatChan_titleBar>*:first-child>*:nth-child(4){pointer-events:none}\n\n/* patches */\n.CatChan_search_miss>*{opacity:inherit} /* patch for chrome in 4chan */\n'}},get how_to_triage(){return Triage.prototype.howto}},html_funcs:null,htmls:{__proto__:{show_hide_all_to_header:function(e){return"<span>"+e+'<a name="SHOWALL" style="float:right;cursor:pointer" data-str="[all▲]">[all▼]</a></span>'},show_hide_all:function(e,t){return'<a name="SHOWALL" style="cursor:pointer">['+e+']</a><a name="HIDEALL" style="cursor:pointer">['+t+"]</a>"},show_hide:function(e,t,n,r,a){return'<a name="SHOW" style="cursor:pointer'+(a?";"+a:"")+'" data-str="'+t+'">'+e+'</a><span style="display:none">'+(r||"")+"<br>"+n+"</span>"},popup:function(e){return'2,<IC"'+e+'.popup">Pop up reply'+this.rollup(this.popup_delay("proto.")+'<br>3,<IC"proto.popup_hlt">Highlight the post if it is visible')+"<br>2,"+this.rollup_radio(e+".inline_post"," :Click posts to",3,"",["no:No","inline:Inline the post, shift-click to jump","jump:Jump to the post"])+"<br>"},popup_delay:function(e,t){return'4,<IR"'+e+'popdown,imm">immediately<br>4,<IR"'+e+'popdown,delay">delayed: up:<ITB4"'+e+'popup_delay">'+(t?"":', down:<ITB4"'+e+'popdown_delay">')+' ms<br>5,<IC"'+e+'popup_mMove">Don\'t popup while mouse is moving<br>4,zIndex: <ITB3"'+e+'popup_zIndex">'},expand_thumbnail_inline:function(e){var t=e+".thumbnail.inline.";return'2,<IC"'+e+'.expand_thumbnail_inline">Image expansion at click'+this.rollup(this.limit_webm(t)+'3,<IC"'+e+'.expand_thumbnail_inline_all_after">Expand all images after clicked one automatically<br>4,On demand loading: <ITB3"'+t+'ref_height">% of screen height<br>4,<IC"'+t+'ondemandStop">Stop expanding when any expanded image is shrinked<br>3,<IC"'+t+'stopHover">Stop image hover on expanded image')+"<br>"},expand_thumbnail_hover:function(e){var t=e+".thumbnail.hover.";return'2,<IC"'+e+'.image_hover">Image hover'+this.rollup(this.popup_delay(t,!0)+"<br>"+this.limit_webm(t,!0)+'3,<IC"'+e+'.image_prefetch">Prefetch next image<br>3,<IC"'+t+'dragfloat">Drag thumbnail to make it window<br>4,<IC"'+t+'df_dblC">Double click to close<br>4,<IC"'+t+'df_mW">Wheel to scroll<br>3,<IC"'+t+'zoom_click">Click to zoom mode if limited<br>3,<IC"'+t+'zoom_over">Enter to zoom mode if limited<br>4,<IC"'+t+'zoom_dblC">Double click to close<br>4,<IC"'+t+'zoom_mW">Wheel to scroll<br>4,Tips for zoom mode: Limit max width.')+"<br>"},resize_thumbnails:function(e){return'<IC"'+e+'.format.thumb.resize">Resize thumbnails'+this.rollup(this.resize_thumbnails_size(e,"vsmall","Very small")+"<br>"+this.resize_thumbnails_size(e,"small","Small")+"<br>"+this.resize_thumbnails_size(e,"large","Large"))+"<br>"},resize_thumbnails_size:function(e,t,n){var r=e+".format.thumb.";return'3,<IR"'+r+"size,"+t+'">'+n+'<br>4,1st thumbnail: <ITB4"'+r+t+'.w1"> x <ITB4"'+r+t+'.h1"><br>4,2nd and later: <ITB4"'+r+t+'.w2"> x <ITB4"'+r+t+'.h2">'},limit_webm:function(e,t){return'4,<IC"'+e+'limit_width">Limit to browser\'s width - <ITB3"'+e+'margin_width"> px<br>4,<IC"'+e+'limit_height">Limit to browser\'s height - <ITB3"'+e+'margin_height"> px<br>4,<IC"'+e+'webm">Play webm'+(t?', or <IC"'+e+'webm_ctrl">play if ctrlKey':"")+'<br>5,<IC"'+e+'webm_loop">Loop<br>5,<IC"'+e+'webm_mute">Mute<br>'},env:function(e,t){return"1,Environment values:(advanced option)"+this.rollup('2,You are using native function of:<br>3,<IC"'+e+'.popup_native">Pop up reply<br>3,<IC"'+e+'.expand_thumbnail_inline_native">Image expansion<br>3,<IC"'+e+'.image_hover_native">Image hover<br>3,<IC"'+e+'.colorID_native">Color ID<br>3,<IC"'+e+'.backlink_native">Backlink<br>3,<IC"'+e+'.localtime_native">Local time'+t+'<br>2,<IC"'+e+'.popup_native_kill">Suppress native static popup<br>2,<IC"'+e+'.refresh_initial">Refresh at initial<br>2,Delay for posts search:<br>3,Incremental posts search may cause massive delay when keyword is short.<br>3,<ITB3"'+e+'.kwd_filter_delay">ms if &lt;<ITB2"'+e+'.kwd_filter_delay_len">letters')+"<br>"},posts_for_search:function(e){return"2,"+this.rollup_radio(e+".storePosts"," :Num of posts to store for search",3,"",["no:No additional posts are stored for search.<br>5,Search will be done only from posts for preview.","ALL:All posts are stored always.<br>5,Search will be done from all posts without preparation scan.","auto:All posts in all scanned threads are stored after the first activation of search.<br>5,Need (automatic) scans prior to search. (usual usage)",'ALL_agg:All posts in all scanned threads are stored.<br>5,Search will be done from all scanned threads.<br>5,This is an option for search from entire domains.<br>3,<IC"proto.searchAc.loosen">Auto loosen limits at the first activation'+this.rollup('6,Max boards of a scan: <ITB6"proto.searchAc.max"><br>6,Max threads of a scan: <ITB6"proto.searchAc.max_threads"><br>6,Max threads at refresh (auto deletion): <ITB6"proto.searchAc.max_threads_at_refresh"><br>5,<BTN"tighten_loosed_limits,Tighten loosed limits">')+'<br>3,<IC"'+e+'.searchAs">Auto scan from this (virtual) board if needed <BTN"scanBoardIf,Scan"><BTN"scanBoard,Rescan"><br>3,<IC"'+e+'.searchAsA">Auto scan from all (virtual) boards if needed <BTN"scanSiteIf,Scan"><BTN"scanSite,Rescan">'])+"<br>2,"+this.rollup_radio(e+".sourceOfSP"," :Posts to be used for search",3,"3,Posts may be stored also by function of deleted posts detection.<br>3,Number of stored posts can be shown in footer.<br>",["auto:All stored posts.(usual usage)","pv:Posts for preview only.<br>5,Search will be done only from recent or newer posts,<br>5,which depends on preview settings."])+"<br>"},op_in_search_result:function(e){return"2,"+this.rollup_radio(e+".posts_search_op"," :Unmatched OP in search result",3,"",["show:Show",'opaque:Opaque: <ITB3"'+e+'.posts_search_op_opacity"> %',"hide:Hide"])+"<br>"},deleted_posts_detection:function(e){return"2,"+this.rollup_radio(e+".deleted_posts.detect"," :Detect deleted posts",4,"3,Detection:<br>",["no:No","passive:Passive detection. Don't make any request","acc:Best effort without any additional requests","full:Full detection, read all posts at first","full_IDB:Full detection with IndexedDB"],'<br>3,<IC"'+e+'.deleted_posts.merge">Merge deleted posts with live posts')},popup_others:function(e){return'2,<IC"'+e+'.popupX.use">Pop up others'+this.rollup(this.popup_delay("proto.popupX.")+'<br>3,<IC"'+e+'.popupX.ID">Pop up ID<br>3,<IC"'+e+'.popupX.ID2">Pop up ID2<br>3,<IC"'+e+'.popupX.flag">Pop up flag<br>3,<IC"'+e+'.popupX.name">Pop up name<br>3,<IC"'+e+'.popupX.trip">Pop up trip')+"<br>"},radios:function(e,t,n,r){var a=t+',<IR"'+e+',$1">'+(r?r.map(function(e){return'<IR"'+e+',$1">'}).join(""):"");return n.map(function(e){return e.replace(/([^:]*):/,a)}).join("<br>")},rollup_radio:function(e,t,n,r,a,s,i){return'<a name="SHOW2" style="cursor:pointer" data-str="▲]">[<SSV"'+e+'"></span>▼]</a><span name="SHOW2_I">'+t+'</span><span style="display:none" name="SUB"><br>'+r+this.radios(e,n,a,i)+(s||"")+"</span>"},rollup:function(e,t,n){return(n?"":"&emsp;")+this.show_hide("[▼]","[▲]",e,t)},rollupHelp:function(e,t,n){return this.show_hide("["+e+"▼]","["+e+"▲]",t,n,"float:right")},rollupTrav:function(e,t){return'<a name="SHOW_T" style="cursor:pointer" data-str="['+t+'▲]" data-trav="'+e+'">['+t+"▼]</a>"},format_posts:function(e){return'2,<IC"'+e+'.open_spoiler_text">Open text spoiler<br>2,<IC"'+e+'.colorID">Color ID<br>'+this.backlink(e)+'2,<IC"'+e+'.localtime">Local time<br>'+this.deleted_posts_detection(e)+'<br>2,<IC"'+e+'.mark_new_posts">Mark new posts<br>2,<IC"'+e+".use_expander_always\">Use CatChan's expander always<br>"},backlink:function(e){return'2,<IC"'+e+'.backlink">Backlink'+this.rollup('3,<IC"proto.bl_ec">Explicit cross backlink<br>3,<IC"proto.bl_rm">Don\'t retain backlinks to OP<br>3,<IC"'+e+'.backlink_all">Track all backlinks<br>4,<IC"'+e+'.backlink_all_cross">Track all cross-board links')+"<br>"},merge_all:function(e){return'2,<IC"'+e+'.merge">Merge all threads'+this.rollup('2,<IC"'+e+'.merge_list">Merge listed threads&emsp;<BTN"cleanMerge,CleanUpList"><br>'+this.merges(e)+"<br>"+("thread"===e?'3,<IC"thread.scroll_lock">Don\'t scroll at merging<br>':""))+"<br>"},merge_list:function(e){return'2,<IC"'+e+'.merge_list">Merge listed threads'+this.rollup(this.merges(e)+'<br>2,<IC"'+e+'.merge">Merge all threads','&emsp;<BTN"cleanMerge,CleanUpList">')},merges:function(e){return'3,<TA"proto.merge_list_str,40,1"><br>3,<IC"'+e+'.merge_lv"'+("catalog"===e?" disabled":"")+'>Merge with level<br>4,<TA"proto.merge_lv_str,40,1"><br>4,Use style tips or user CSS to style'+this.rollup(this.userCSS(1))+"<br>"+("thread"===e||"page"===e?'3,<IC"'+e+'.merge_auto_list">Auto merge listed threads'+this.rollup('4,<IC"'+e+'.merge_auto_list_lv_add">with level <ITB2"'+e+'.merge_auto_list_lv">')+"<br>":"")+'3,<IC"'+e+'.merge_op_auto">Auto merge cross-linked threads in OP'+this.rollup('5,(For new thread of generals typically.)<br>4,to hop <ITB2"'+e+'.merge_op_auto_hop"><br>4,<IC"'+e+'.merge_op_lv_add">with level <ITB2"'+e+'.merge_op_lv">, <IC"'+e+'.merge_op_lv_inc">increment by hop<br>4,(Entries of level are also used as end flags.<br>4,Unmerged states will be cleared after relaod if they are not added.)<br>4,<IC"'+e+'.merge_op_list">Inherit value of exclusive list<br>4,<IC"'+e+'.merge_op_attr">Inherit value of attribute list')+'<br>3,<IC"'+e+'.merge_btn">Add merge button to cross-links'+this.rollup('4,Merge mode:<br>5,<IR"'+e+'.merge_btn_mode,all"'+("thread"!==e?" disabled":"")+">all (Don't modify the list)<br>5,<IR\""+e+'.merge_btn_mode,list"'+("thread"!==e?" disabled":"")+'>by list (target is added to the list)<br>4,<IC"'+e+'.merge_btn_lv_add">with level <ITB2"'+e+'.merge_btn_lv">')},userCSS:function(e){return e+",Style tips for merge:<br>"+(e+1)+',<IC"style.tips.merged1">Add ">" to merged threads of level 1<br>'+(e+1)+',<IC"style.tips.merged2">Add ">>" to merged threads of level 2<br>'+(e+1)+',<IC"style.tips.merged3">Add ">>>" to merged threads of level 3<br>'+e+","+this.ta_with_help("style.userCSS","User CSS")},vb_domains:function(){var e="virtualBoard.scan_domains.";return"2,Scan targets:<br>3,None/Board/Thread(No/Passive/Active)<br>"+site0.domains.map(function(t){return'3,<IR"'+e+t+',none"><IR"'+e+t+',board"><IR"'+e+t+',thread"> '+t+"<br>"}).join("")},make_sel:function(e,t){for(var n='<select name="'+e+'" style="float:none">',r=0;r<t.length;r++)n+="<option>"+t[r]+"</option>";return n+"</select>"},features_domains:function(){for(var e="",t=0;t<site0.domains.length;t++)e+='1,<IC"features.domains.'+site0.domains[t]+'">'+site0.domains[t]+"<br>";return e},cb_block:function(e,t,n){for(var r="",a=t-1;void 0!==pref[e][++a]&&(!n||a<n);)r+='<ICN"'+e+"."+a+'">'+(a%10==4?"&emsp;":a%50==49?"<br><br>":a%10==9?"<br>":"");return r},footer:function(e){var t=e+".footer.";return'1,<IC"'+t+'use">Show information footer<br>2,<IC"'+t+'nrtm">Show num of new replies to me (nm)'+this.rollup('3,<IC"'+t+'nrtm1">Style if &gt;0:<ITBL30"'+t+'nrtm1_style"><br>3,<IC"'+t+'nrtm0">Empty if 0')+'<br>2,<IC"'+t+'nr">Show num of new replies (nr)'+this.rollup('3,<IC"'+t+'nr1">Style if &gt;0:<ITBL30"'+t+'nr1_style"><br>3,<IC"'+t+'nr0">Empty if 0')+'<br>2,<IC"'+t+'rp">Show num of replies (rp), bold (RP)'+this.rollup('3,<IC"'+t+'rOP">Count OP<br>3,<IC"'+t+'rp0">Empty if OP only')+'<br>2,<IC"'+t+'im">Show num of images (im), bold (IM)'+this.rollup('3,<IC"'+t+'iOP">Count images in OP')+'<br>2,<IC"'+t+'nl">Show num of stored live posts (lp)<br>2,<IC"'+t+'nd">Show num of deleted posts (dp)<br>2,<IC"'+t+'ns">Show num of saged posts (sp)<br>2,<IC"'+t+'page">Show page No. (pg)<br>2,<IC"threadStats.use">Take statistics of each thread'+this.rollup('4,<IC"threadStats.full">Issue additional fetchs if required<br>5,<IC"threadStats.retry">Retry if obsolete data(may cause infinite loop)')+'<br>3,<IC"'+t+'nid">Show num of IDs (ni)<br>3,<IC"'+t+'nf">Show num of flags (nf)<br>2,<IC"'+t+'ctime"> <IC"'+t+'rctime">Show created time (ct), relative (cT)<br>2,<IC"'+t+'btime"> <IC"'+t+'rbtime">Show bumped time (bt), relative (bT)<br>2,<IC"'+t+'ptime"> <IC"'+t+'rptime">Show last posted time (pt), relative (pT)<br>2,<IC"'+t+'prate">Show post rate, posts/day (pr)<br>2,<IC"'+t+'domain">Show domain\'s name (dn)<br>2,<IC"'+t+'board">Show board\'s name (bd)<br>2,<IC"'+t+'no">Show thread\'s no (no)<br>2,<IC"'+t+'archived">Show archived (ar)<br>2,<IC"'+t+'tag">Show tags, <SE"proto.footer.merged_tag,no:no tags,any:in any threads,all:in all threads"> for merged threads<br>2,<IC"'+t+'flag">Show recent flags<br>2,<IC"'+t+'menu">Show menu button at last'+this.rollup("3,"+this.triage_config(t+"menu_str","Footer tail","kill,simple,menu:menu (default),headline,headline_ex,headline_merge,headline_merge_ex"))+'<br>2,<IC"'+t+'triage">Show triage button at head'+this.rollup("3,"+this.triage_config(t+"triage_str","Footer head","kill,simple:simple (default),menu,headline,headline_ex,headline_merge,headline_merge_ex"))+'<br>2,Design:<br>3,<IR"'+t+'design,native"> U: */* / R: * / I: * / P: *<br>3,<IR"'+t+'design,condensed"> */*/*/*/*<br>3,<IR"'+t+'design,meguca"> /bd/ */*/*/*/*'+this.rollup("How to custoimze design<br>1,** are replaced by the parameter above.<br>1,() forms a group, all parameters to be replaced must be in ().<br>1,b, i, u, s, span, iB, and iI tags are accepted.<br>1,Each tag can accept style attribute.<br>1,&lt;iB&gt; and &lt;iI&gt; are pseudo tags for italics at Bump/Image limit.")+'<br>3,<IR"'+t+'design,custom"> <ITBL40"'+t+'custom"><br>3,<IR"'+t+'design,custom2"> <ITBL40"'+t+'custom2"><br>3,<IR"'+t+'design,custom3"> <ITBL40"'+t+'custom3"><br>'},design_of_fc:function(e){return'<SE"'+e+'.view,headline:Headline,catalog:Catalog,page:Page"> :View'},design_of_fc_1:function(e,t){return': <ITBN4"'+e+".format."+t+'.width">x<ITB4"'+e+".format."+t+'.height">(<ICN"'+e+".format."+t+'.max">Max)'},design_of_fc_size_doms:document.createElement("div"),design_of_fc_size_doms_register:function(e,t){var n=this.design_of_fc_size_doms;0===n.childNodes.length&&(n.appendChild(e.cloneNode(!0)).name="float.catalog_size",n.appendChild(t.cloneNode(!0)).name="float.catalog_teaser")},design_of_fc_size:function(){return this.design_of_fc_size_doms.innerHTML},updates:function(e,t){return'<IC"'+e+'.auto_update">Auto update'+(t?"":", every ")+'<ITBN2"'+e+'.auto_update_period">min'+(t||".")+"<br>"+this.rollup_radio(e+".refresh_src"," :Refresh targets from",1,"",["bg:Boards group (usual catalog)","bgwl:Both; boards group and watch list (embed watcher)","wl:Watch list (watcher mode)"],'<br>2,Use catalog if >=<ITB3"'+e+'.refresh_src_th"> threads in a board')+"<br>"},broadcast_triage:function(e,t,n){return this.rollup_radio("triage.sync_"+e," :Sync "+(t||e)+" list in this tab"+(n||""),3,"",["no:No","bg:Sync among the same board group","all:Sync with any board group"])+"<br>"},popup3:function(e,t){return this.rollup_radio(e+".popup3.ww"," :Pop up",t,"3,WW/WN/NW/NN (Wider/Narrower) side:"+this.rollup(this.popup_delay("proto.popup3.")+'<br>4,Distance from mouse pointer, x:<ITB4"proto.popup3.oX">, y:<ITB4"proto.popup3.oY">')+"<br>",["no:No","sr:Search result","srpv:Search result or preview","pv:Preview","chart:Post rate chart (statistics must be activated)","dp:Deleted posts"],"",[e+".popup3.wn",e+".popup3.nw",e+".popup3.nn"])+"<br>"},t2h:function(e,t){return"2,"+this.rollup_radio(e+".t2h_sel"," :"+t,3,"",["page:Inherit from index page",'L: <ITB3"'+e+'.t2h_L"> posts(L posts)','M: <ITB3"'+e+'.t2h_M"> posts(M posts)','N: <ITB3"'+e+'.t2h_num_of_posts"> posts(N posts)',"N_unread:N + all unread posts","unread:All unread posts","ALL:All posts"])+"<br>"},appearance:function(e,t){return t||(t=""),'<IC"catalog.appearance.'+e+t+'"><IC"page.appearance.'+e+t+'"><IC"thread.appearance.'+e+t+'"><IC"float.appearance.'+e+t+'">'},triage_config:function(e,t,n){return this.inlineBlock("<span>"+t+': <span style="float:right"><SE"triage.sampleLoader,Load sample...,'+n+'" data-tgt="'+e+'"> '+this.rollupTrav("PPn","How to")+'</span></span><span style="display:none"><br><TA"samples.how_to_triage,40,1" disabled></span><br><TA"'+e+',40,1">')},triage_hover:function(e){return'3,<IC"'+e+'.triage_hover">'+("page"===e?"index ":"")+e+' view, <SE"'+e+'.triage_place,topLeft:Top left,bottomLeft:Bottom left,topRight:Top right,bottomRight:Bottom right"><br>'},IDinfo:function(e,t,n,r){return'3,<IC"IDinfo.'+e+'.use">nth/all by each '+e+', enclosed by <ITBL1"IDinfo.'+e+'.h"><ITBL1"IDinfo.'+e+'.t"><br>'+(n?'4,<IC"IDinfo.'+e+"."+n+'">nth/all/nof '+n+"s of the same "+e+"<br>":"")+'4,<IC"IDinfo.'+e+'.nof">nth/all'+(n?"(/"+r+")":"")+"/nof "+e+"s at that time<br>"+(t?'4,<IC"IDinfo.'+e+".op\">Add 'OP'<br>":"")},save_idx_promiscuous:function(e){return'2,<IC"'+e+'.save_board_list_sel">Save board group index<br>'+("float"===e?'2,<IC"'+e+'.clone">Clone threads at initial if others refer the same board group<br>':"")+'2,<IC"'+e+'.accept_others_refresh">Sync with others which refer the same board group<br>2,<IC"'+e+'.promiscuous">Show all fetched threads<br>'},ta_with_help:function(e,t,n,r){return this.inlineBlock('<IC"'+e+(n?"":".use")+'">'+t+this.rollupHelp(r||"sample",'1,<TA"samples.'+e+(n?"_":".")+'str,40,1" disabled>')+'<br>1,<TA"'+e+(n?"_":".")+'str,40,1">')+"<br>"},notify_init:function(e){return this.rollup('4,<IC"notify.'+e+'.supp_init">Suppressed at initial')+"<br>"},notify_tgts:function(e){return'2,<IC"notify.'+e+'.reply_to_me">New replies to me<br>2,<IC"notify.'+e+'.reply">New replies<br>2,<IC"notify.'+e+'.new_thread">New threads<br>'+(pref.test_mode[133]?'2,<IC"notify.'+e+'.appear">Appear threads<br>':"")},add_indent:function(e,t){return t.replace(/(^|<br>|<\/div>)(\d+,)*</g,function(t,n,r){var a=e+(parseInt(r,10)||0);return(n||"")+(a?a+",":"")+"<"})},inlineBlock:function(e){return'<div style="display:inline-block">'+e+"</div>"}},"Easy Setting2:":function(){
return'Easy Setting2: --- Welcome to CatChan! ---<br><br>1,0. <BTN"easy2.beginner,I\'m a beginner and I just want to try">, click this.<br>2,Then a reload will occur after loading settings for beginner.<br>2,(This will be default after a certain period of test.)<br>2,Or follow next steps to choose your favorite settings.<br><br>1,1. <input type="checkbox" name="easy2.reset"> Reset all settings before loading new one if you prefer.<br>1,2. Select a preset: <select name="easy2.presets" style="float:none"><option>Safe default</option><option>Silent inter-board operability (for beginner)</option><option>Silent inter-site operability</option><option>Active inter-board operability</option><option>Active inter-site ondemand operability</option><option>Active inter-site operability</option><option>Active in-board operability with LiveTag</option><option>Active inter-board operability with LiveTag</option><option>Active inter-site operability with LiveTag</option></select><br>1,3. Select limits for safe: <select name="easy2.limits" style="float:none"><option>General</option><option>/all/ for lain, meguca</option><option>/all/ for 4chan</option><option>8chan with top 50 boards</option><option>8chan with top 100 boards</option><option>8chan with top 500 boards</option><option>8chan with all boards</option><option>/all/ for KC</option></select><br>1,4. Modify details if you want.<br>2,<input type="checkbox" name="easy2.virtualBoard.show"> VirtualBoards, shows <input type="text" name="easy2.virtualBoard.max" size="3" style="text-align: right;"> virtual boards<br>4,Local: <select name="easy2.VB.local" style="float:none"><option>No</option><option>Passive</option><option>Active</option></select>&emsp;Global: <select name="easy2.VB.global" style="float:none"><option>No</option><option>Passive</option><option>Active</option></select><br>2,<input type="checkbox" name="easy2.liveTag.use"> LiveTag, from: <select name="easy2.LTfrom" style="float:none"><option>OP</option><option>Posts</option></select><br>2,<IC"easy2.catalog.embed">Use CatChan in catalog<br>2,<IC"easy2.catalog.embed_page">Use CatChan in index page<br>2,<IC"easy2.thread.embed">Use CatChan in thread<br>2,<IC"easy2.auto_update">Auto update, every <ITB2"easy2.auto_update_period"> min.<br>2,<IC"easy2.notify.desktop.notify">Desktop notification<br>2,Misc.'+this.rollup('3,<IC"easy2.filter.time_watch">Hide all threads which have no posts in recent <ITB3"easy2.time_post"> hours<br>3,<IC"easy2.filter.time_watch_creation">Hide all threads which are created before <ITB3"easy2.time_op"> hours ago<br>3,<IC"easy2.stats.use">Statistics<br>3,<IC"easy2.healthIndicator.expand_running">Show details of running indicators<br>3,<IC"easy2.network.fetch_actively">Fetch missing info actively<br>3,<IC"easy2.basics">Other basic settings<br>3,Limits for safe: <br>4,At scan: <ITB6"easy2.scan.max"> boards, <ITB6"easy2.scan.max_threads"> threads.<br>4,In a catalog: <ITB6"easy2.catalog.max_threads_at_refresh"> threads.')+'<br>1,5. Click <BTN"easy2.apply,Apply"><br>1,6. Click <BTN"save,Save"> if you want to save your settings to localStorage<br>1,7. Click <BTN"reload,Reload">, because some setting may need<br>'},"Easy Setting:":'Easy Setting:<br>&emsp;VBs: virtual boards<br>&emsp;AU: auto update every X min<br>1,<BTN"easy.virtualBoard_10_passive,Click"> 20 VBs / AU 10 min. / passive scan. (for all)<br>1,<BTN"easy.virtualBoard_10,Click"> 20 VBs / AU 10 min. (for lainchan and meguca)<br>1,<BTN"easy.virtualBoard_1,Click"> 100 VBs / AU 1 min. (for 4chan)<br>1,<BTN"easy.virtualBoard_8_50,Click"> 100 VBs / AU 5 min from top <input type="text" name="easy.max_boards" size="3" style="text-align: right;"> boards. (for 8chan)<br>1,<BTN"easy.virtualBoard_8_all,Click"> 100 VBs / AU 5 min from all boards. (for 8chan)<br>1,<BTN"easy.virtualBoard_interSite,Click"> 100 VBs / AU 10 min from all sites. / passive scan. (for all)<br><br>1,<BTN"easy.posts_0h,Click"> I want to check all new posts from now.<br>1,<BTN"easy.posts_24h,Click"> I want to check all posts from <input type="text" name="easy.posts_ago" size="3" style="text-align: right;"> hours ago.<br>1,<BTN"easy.threads_24h,Click"> I want to check all new threads from <input type="text" name="easy.threads_ago" size="3" style="text-align: right;"> hours ago.<br><br>1,<BTN"easy.embed_index_lazy,Click"> Setup for narrow band.<br>1,<BTN"easy.embed_index_infinite,Click"> Setup for infinite scroll.<br>1,<BTN"easy.embed_index_backwash,Click"> Backwash style. (infinite scroll/quick auto update)<br><br>1,<BTN"easy.light,Click"> Setup for light start up.<br>',"Virtual Board:":function(){return'Virtual Board:<br>&emsp;<input type="checkbox" name="virtualBoard.show"> Show virtual boards, up to: <input type="text" name="virtualBoard.max" size="3" style="text-align: right;"><br>2,<IC"virtualBoard.search.show">Show search bar in boardlist<br>&emsp;<input type="checkbox" name="virtualBoard.scan"> Scan at start up, delay: <input type="text" name="virtualBoard.scanDelay" size="2" style="text-align: right;">s<br>3,Scan: <BTN"virtualBoard.scanStart,Start">&emsp;<BTN"virtualBoard.scanStop,Stop"><br>'+this.vb_domains()+'&emsp;&emsp;<input type="checkbox" name="virtualBoard.instant_scan"> Instant scan<br>&emsp;Physical boards in boardlist:<br>&emsp;&emsp;<input type="radio" name="virtualBoard.p_board" value="both"> Show as they are<br>&emsp;&emsp;&emsp;<input type="checkbox" name="virtualBoard.p_remove"> Remove virtual boards of the same name<br>&emsp;&emsp;<input type="radio" name="virtualBoard.p_board" value="replace"> Replace with virtual boards<br>1,<IC"liveTag.info">Show infomation on hover<br>1,Styles:'+this.rollup('2,Selected:<ITBL30"liveTag.style.in"><br>2,Excluded:<ITBL30"liveTag.style.ex"><br>2,<IC"liveTag.style.use">Add style for unread posts:<br>3,Unread replies to me:<ITBL30"liveTag.style.urtm"><br>3,Unread replies:<ITBL30"liveTag.style.ur"><br>3,Unread replies to me + selected:<ITBL30"liveTag.style.inurtm"><br>3,Unread replies + selected:<ITBL30"liveTag.style.inur"><br>3,Unread replies to me + excluded:<ITBL30"liveTag.style.exurtm"><br>3,Unread replies + excluded:<ITBL30"liveTag.style.exur">')+"<br>"},"Catalog:":function(){return this.show_hide_all_to_header("Catalog:")+'<br>1,<IC"catalog.embed">Use CatChan in catalog<br>2,<IC"catalog.infoPv.use">Info preview hover'+this.rollup(this.popup_delay("catalog.infoPv."))+"<br>"+this.expand_thumbnail_hover("catalog")+this.popup_others("catalog")+'&emsp;&emsp;<input type="checkbox" name="catalog.open_spoiler_text"> Open text spoiler<br>'+this.add_indent(2,this.updates("catalog"))+'2,<IC"catalog.mark_new_posts">Mark new posts at opening threads<br>2,'+this.rollup_radio("catalog.click_area"," :Click to open the thread",3,"",["thumbnail:Thumbnail","entire:Entire thread card"])+"<br>2,"+this.popup3("catalog",3)+"2,"+this.rollup_radio("catalog.t2h_sel"," :Num of posts for preview or footer",3,"",["no:No",'N:Last <ITB3"catalog.t2h_num_of_posts"> posts (N posts)',"N_unread:N + all unread posts","unread:All unread posts","ALL:All posts"])+"<br>"+this.posts_for_search("catalog")+this.op_in_search_result("catalog")+this.deleted_posts_detection("catalog")+'<br>2,<IC"catalog.detect_sage">Detect saged posts in 4chan<br>3,<IC"catalog.page_his">Store page history in 4chan<br>'+this.backlink("catalog")+this.save_idx_promiscuous("catalog")+this.merge_list("catalog")+'<br>1,<IC"catalog.embed_archive">Generate catalog in archive'+this.rollup('5,from top <ITB5"scan.max_archive"> threads')+"<br><br>1,Environment values:(advanced option)"+this.rollup('2,You are using native function of:<br>3,<IC"catalog.env.popup_native">Pop up reply<br>3,<IC"catalog.env.image_hover_native">Image hover<br>2,<IC"catalog.env.refresh_initial">Refresh at initial<br>2,Custom size:<br>3,With OP'+this.design_of_fc_1("catalog","ec")+"<br>3,Without OP"+this.design_of_fc_1("catalog","c")+"<br>2,"+this.resize_thumbnails("catalog"))+"<br>"},"Index Page:":function(){return this.show_hide_all_to_header("Index Page:")+'<br>&emsp;<input type="checkbox" name="catalog.embed_page"> Use CatChan in index page'+this.rollup('3,Refresh up to:<br>4,<IR"catalog_max_page_select,manual"> <ITB2"catalog_max_page"> pages<br>4,<IR"catalog_max_page_select,auto"> Max pages<br>5,<IC"catalog_max_page_auto">Update automatically')+"<br>"+this.popup("page")+this.expand_thumbnail_inline("page")+this.expand_thumbnail_hover("page")+this.popup_others("page")+this.format_posts("page")+this.t2h("page","Num of posts to show")+this.posts_for_search("page")+this.op_in_search_result("page")+this.add_indent(2,this.updates("page"))+this.merge_all("page")+'2,<IC"page.scroll_lock">Don\'t scroll at update<br>'+this.save_idx_promiscuous("page")+"2,"+this.resize_thumbnails("page")+'2,<IC"page.hide_posts_without_images">Hide posts without images<br><br>'+this.env("page.env","")},"Thread:":function(){return this.show_hide_all_to_header("Thread:")+'<br>&emsp;<input type="checkbox" name="thread.embed"> Use CatChan in thread<br>'+this.popup("thread")+this.expand_thumbnail_inline("thread")+this.expand_thumbnail_hover("thread")+this.popup_others("thread")+this.format_posts("thread")+this.posts_for_search("thread")+this.add_indent(2,this.updates("thread"))+this.merge_all("thread")+this.t2h("thread","Num of posts to show at initial merging")+'2,<IC"archive.IDB.redirect_404">Open archive from IDB if 404'+this.rollup('3,<IC"archive.IDB.redirect_404_CSP">Open blob to bypass Content Security Policy')+'<br>2,<IC"thread.hide_posts_without_images">Hide posts without images<br><br>'+this.env("thread.env",'<br>3,<input type="checkbox" name="thread.env.auto_update_native"> Auto update')},"Watcher/FC:":function(){return'Watcher / Floating Catalog:<br>1,<IC"catalog.auto_watch">Auto add to watch list'+this.rollup('2,<IC"catalog.auto_watch_override">Override default behavior by triage<br>3,<TA"catalog.auto_watch_override_str,40,1">')+"<br>1,Default settings:<br>2,"+this.design_of_fc("float",3)+', max<ITB4"headline.max_letters">letters in headline<br>'+(this.design_of_fc_size()?"3,"+this.design_of_fc_size()+"<br>":"")+this.add_indent(2,this.updates("float"))+'2,<IC"float.hide_unwatched">Show watched threads only (watcher mode)<br>2,<IC"liveTag.NC">Separated virtual board for each instance<br>'+this.merge_list("float")+'<br>3,<IC"headline.merge_truncated">Truncate members in headline view<br>2,<IC"catalog.appearance.orderOnTB">Order selector on title bar<br>2,'+this.rollup_radio("catalog.appearance.initial.state",' :At initial, <ITBN4"catalog.appearance.initial.width">x<ITB4"catalog.appearance.initial.height">(0 means auto)',3,"",["max:Maximized",'float:Floating, left:<ITB4"catalog.appearance.initial.left">px, top:<ITB4"catalog.appearance.initial.top">px',"top:Embed to top","bottom:Embed to bottom"])+'<br>2,<IC"float.disable_kwd_filter_at_initial">Disable keyword filter at initial<br>1,'+this.popup3("float",2)+'1,<IC"float.auto_launch">Auto start an instance at initial<br>1,<IC"float.env.refresh_initial">Refresh at initial<br>'+this.add_indent(-1,this.save_idx_promiscuous("float"))+"1,"+this.resize_thumbnails("float")+(pref.test_mode[147]?this.add_indent(-1,this.merge_all("float")):"")+'<br>1,Advanced options:<br>2,<IC"common.consolidated_watch_list">Consolidated watch list (for watcher mode)<br>3,<IC"common.sync_watch_list">Sync watch list with other tabs<br>2,'+this.broadcast_triage("watch",null," (ignored if consolidated)")+"2,"+this.broadcast_triage("attr")+"2,"+this.broadcast_triage("ex","exclude")+'2,<IC"liveTag.watch_all">Watch all boards<br>'},"Gerenal 0":function(){return'General 0:<br>&emsp; Open short link<br>&emsp;&emsp;<input type="radio" name="catalog_open_last50" value="no">No. Open entire thread<br>&emsp;&emsp;<input type="radio" name="catalog_open_last50" value="exist">If it exists<br>&emsp;&emsp;<input type="radio" name="catalog_open_last50" value="exist_watch">If it exists and all unread posts are in it<br>&emsp; Open the thread in<br>&emsp;&emsp;<input type="radio" name="catalog_open_where" value="_self">this tab<br>&emsp;&emsp;<input type="radio" name="catalog_open_where" value="_blank">new tab always<br>&emsp;&emsp;<input type="radio" name="catalog_open_where" value="named">named tab<br>&emsp;&emsp;<input type="radio" name="catalog_open_where" value="CatChan_tgt">a fixed tab<br>2,<IC"pref2.meguca.historyAPI">Use historyAPI in meguca<br>1,'+this.ta_with_help("postFilter","Use global post filter")+"&emsp;Triage:<br>2,Use hover triage on and where<br>"+this.triage_hover("catalog")+this.triage_hover("page")+this.triage_hover("thread")+this.triage_hover("headline")+'2,<IC"triage.popdown">Auto pop down with delay <ITBN4"triage.popdown_delay">ms<br>2,<IC"triage.hide_toggle">Hide useless toggle buttons<br>2,Configurations of triages:<br>3,'+this.triage_config("catalog_triage_str","Hover","simple_kill,simple:simple (default),basic,basic_color,colorful,borders,toggles,samples,test")+"<br>3,"+this.triage_config("triage.menu_str","Menu","menu_basic:basic (default),menu_attr:attr,menu_full:full")+"<br>3,"+this.triage_config("triage.postMenu_str","PostMenu","simple:simple (default),basic,full")+"<br>"},"General 1":function(){return'General 1:<br>&emsp;Click to:<br>&emsp;&emsp;<input type="radio" name="float.click" value="open">Go to/open the thread<br>&emsp;&emsp;<input type="radio" name="float.click" value="expand">Expand/shrink the OP in catalog<br>&emsp;&emsp;&emsp;&emsp;<input type="checkbox" name="catalog_expand_with_hr"> Insert horizontal splitter when it is expanded<br>&emsp;&emsp;&emsp;<input type="checkbox" name="catalog_no_popup_at_expanded"> Don\'t popup when the catalog is expanded<br>&emsp;&emsp;<input type="radio" name="float.click" value="none">None<br>&emsp;Click area:<br>&emsp;&emsp;<input type="radio" name="float.click_area" value="thumbnail">Thumbnail<br>&emsp;&emsp;<input type="radio" name="float.click_area" value="entire">Entire thread card<br>1,Window handling<br>2,grab to move / select text:<br>3,<IR"proto.popup2_sel,move">Move always<br>3,<IR"proto.popup2_sel,auto">Auto, padding-x:<ITB4"proto.popup2_sel_tolerance"> px<br>3,<IR"proto.popup2_sel,sel">Select always<br>3,<IC"catalog_popup_size_fix">Fix size when you move it<br>2,<IC"proto.popup2_resize">Resize on borders of <ITB4"proto.popup2_resize_bw"> px<br>3,Size of corner angle: <ITB4"proto.popup2_resize_cw"> px<br>1,Appearance:'+this.rollup("2,catalog/page/thread/watcher<br>2,"+this.appearance("dummy",'" style="visibility:hidden')+"Shows in title bar:<br>2,"+this.appearance("titleBar.filter")+"Filter button<br>2,"+this.appearance("titleBar.settings")+"Settings button<br>2,"+this.appearance("titleBar.refresh")+"Refresh button<br>2,"+this.appearance("titleBar.boards_selector")+"Boards selector<br>2,"+this.appearance("dummy",'" style="visibility:hidden')+"Expands in filters panel by default<br>2,"+this.appearance("expand.kwd")+"Keyword filter<br>2,"+this.appearance("expand.time")+"Time filter<br>2,"+this.appearance("expand.tag")+"Tag filter<br>2,"+this.appearance("expand.list")+"List filter<br>2,"+this.appearance("expand.ctrl")+"Filter controls")+'<br><br>&emsp;<input type="checkbox" name="catalog.embed_frame"> Embed to frame<br>&emsp;&emsp;Frame size : &emsp;&emsp;<input type="text" name="catalog_size_frame0_width" size="4" style="text-align: right;">%, &emsp;&emsp;<input type="text" name="catalog_size_frame1_width" size="4" style="text-align: right;">%<br>&emsp;&emsp;<input type="checkbox" name="catalog.refresh.except_bt"> Except the page of selecting boards\' tag.<br>&emsp;<input type="checkbox" name="catalog.refresh.at_switch"> Clear and refresh when boards are switched<br>&emsp;<input type="checkbox" name="common.clear_at_manual_scan"> Clear all threads at manual scan<br>1,'+this.rollup_radio("common.watch_list_rm404"," :Remove 404 threads in watch list",2,"",["imm:Immediately","unread:Keep them if they have unread posts<br>4,(can't catch unread posts during offline)",'no:No, user interaction is need to remove<br>2,<IC"archive.IDB.auto_restore_watch">Auto restore pruned threads from IDB archive'])+"<br>1,"+this.rollup_radio("liveTag.rm_404"," :Remove 404 threads",2,"",["imm:Immediately","watched:Keep watched threads","unread:Keep watched threads if they have unread posts","no:No, keep all threads remain"])+'<br>1,<IC"common.blur_404">Blur 404 threads<br>&emsp;<input type="checkbox" name="catalog.bookmark_list_rm404"> Remove 404 threads from bookmark<br>&emsp;<input type="checkbox" name="pref2.8chan.utilize_boards_json"> Utilize boards.json in 8chan<br>1,<IC"pref2.meguca.utilize_boards_json">Utilize boardTimestamps in meguca<br>2,<IC"pref2.meguca.utilize_boards_json_domain">Utilize boardTimestamps at refresh in meguca<br>1,<IC"common.consolidated_filter">Use consolidated filter<br>'},"Board Group":function(){return'Board Group:<br>&emsp;configuration:<br>&emsp;&emsp;<textarea rows="1" cols="40" name="catalog_board_list_str"></textarea><br>&emsp;&emsp;<input type="checkbox" name="catalog.board.recommendation"> Read owner\'s recommendation &emsp;&emsp;<BTN"tag.recommendation_add,Add to list"><br>2,<IC"catalog.board.all_boards">Add all boards group to the last<br>&emsp;&emsp;<input type="checkbox" name="catalog.board.board_tags"> Generate board groups from tags &emsp;&emsp;<BTN"tag.scan,Scan"><br>&emsp;&emsp;<input type="checkbox" name="catalog.board.board_tags_same"> Pick up boards which have the same tag&emsp;&emsp;<BTN"tag.same_tag_refresh,Refresh"><br>&emsp;<input type="checkbox" name="catalog.board.ex_list"> Use exclusive list<br>&emsp;&emsp;<textarea rows="1" cols="40" name="catalog.board.ex_list_str"></textarea><br>1,'+this.ta_with_help("catalog.style_general_list","Use general style",!0)+'&emsp;<input type="checkbox" name="catalog.mimic_base_site"> Mimic base site<br>&emsp;Scan:<br>&emsp;&emsp;Max scan boards <input type="text" name="scan.max" size="6" style="text-align: right;"><br>&emsp;&emsp;Max found threads <input type="text" name="scan.max_threads" size="6" style="text-align: right;"><br>&emsp;&emsp;Num of crawler: <input type="text" name="scan.crawler" size="2" style="text-align: right;"><br>&emsp;&emsp;&emsp;<input type="checkbox" name="scan.crawler_adaptive"> Spawn adaptively at idle<input type="text" name="scan.crawler_idle_time_to_spawn" size="2" style="text-align: right;">ms<br>'},"Live Tag":'Live Tag:<br>1,From:<br>2,<IR"liveTag.from,op">OP<br>2,<IR"liveTag.from,post">All posts<br>1,<IC"liveTag.use">Live<br>1,max: <ITB2"liveTag.max">, max string length: <ITB2"liveTag.maxstr"><br>1,<IC"liveTag.ci">Case insensitive<br>1,<IC"liveTag.inherit_board_name">Inherits board\'s name as a tag<br>2,<IC"liveTag.lock_board_name">Lock & sticky<br>1,<IC"liveTag.inherit_board_tags">Inherits board\'s tags<br>2,<IC"liveTag.lock_board_tags">Lock & sticky<br>1,<IC"liveTag.lock_tags_in_op">Lock & sticky tags in OP<br>1,<IC"liveTag.ex_list">Use exclusive list<br>2,String list to remove before extraction (costs much)<br>3,<textarea rows="1" cols="40" name="liveTag.rm_list_str"></textarea><br>2,Tag list to remove after extraction (costs less)<br>3,<textarea rows="1" cols="40" name="liveTag.ex_list_str"></textarea><br>1,Click function: tags in <br>2,boardlist / threads<br>2,<IR"liveTag.click_func_bl,pkin"><IR"liveTag.click_func,pkin">None -> Fetch/In -> None<br>2,<IR"liveTag.click_func_bl,in"><IR"liveTag.click_func,in">None -> In -> None<br>2,<IR"liveTag.click_func_bl,inex"><IR"liveTag.click_func,inex">None <-> In <-> Out <-> None (ctrl for backward)<br>2,<IR"liveTag.click_func_bl,ex"><IR"liveTag.click_func,ex">None -> Out -> None<br>1,Update intervals:<br>2,Foreground: <ITB4"liveTag.disp_delay.fg">ms<br>2,Background: <ITB4"liveTag.disp_delay.bg">ms<br>2,Lazy draw of incremental search:<br>3,every <ITB4"liveTag.lazy_each"> tags with <ITB4"liveTag.lazy_delay"> ms delay<br>',Statistics:function(){return'Statistics:<br>1,<IC"stats.use">Take statistics<br>3,<IC"stats.estimate_posts">Estimate num of posts from posts\' No.<br>4,<IC"stats.patch_tm">Patch for thread move<br>2,Default settings:<br>3,Time unit: '+chart_obj.time_unit_sel_html+"<br>3,"+chart_obj.chart_options_str.join("3,")+'3,Size of window: <ITB4"chart.window_width"> x <ITB4"chart.window_height"><br><br>2,Accumulation:<br>3,<IC"stats.load">Load data<br>4,<IC"stats.save">Save data: <ITB4"stats.len_capture"> points<br>4,Auto acquisition of data:<br>5,<IC"stats.auto_acquisition_all">All board groups which you saw once<br>5,<IC"stats.auto_acquisition">Board groups with \'!stats\'<br>6,<IC"stats.auto_acquisition_scan">Scan all targets at startup with <ITB2"stats.auto_acquisition_scan_delay"> secs delay<br>5,(Targets are colored <span style="background:#b5fbda">green</span> in board selector)<br><br>2,<IC"chart.instant_scan">Instant scan at switching board group<br>2,Delay to draw: <ITB2"stats.draw_delay"> sec.<br>2,<IC"chart.off_anime_blur">Off animation in background<br>2,<IC"stats.tolerant">Tolerant of inaccuracy of server and local clocks<br>5,up to <input type="text" name="stats.tolerance" size="2" style="text-align: right;"> min<br>'},Footer:function(){return"Footer:<br>"+this.footer("catalog")},"Footer for watcher":function(){return"Footer for watcher:<br>"+this.footer("float")},ThreadReader:function(){return'ThreadReader:<br>1,<IC"thread_reader.unmark_on_hover">Unmark post on hover<br>&emsp;<input type="checkbox" name="thread_reader.use"> Thread reader<br>&emsp;&emsp;<input type="checkbox" name="thread_reader.own_posts_tracker"> Own posts tracker<br>&emsp;&emsp;&emsp;&emsp;>> (You)<br>&emsp;&emsp;&emsp;&emsp;<input type="radio" name="thread_reader.show_reply_to_me_by" value="anchor"> anchor text<br>&emsp;&emsp;&emsp;&emsp;<input type="radio" name="thread_reader.show_reply_to_me_by" value="plain"> plain text (for dollchan)<br>&emsp;&emsp;&emsp;&emsp;(You) in name field<br>&emsp;&emsp;&emsp;&emsp;<input type="radio" name="thread_reader.show_own_post_by" value="anchor"> name string<br>&emsp;&emsp;&emsp;&emsp;<input type="radio" name="thread_reader.show_own_post_by" value="plain"> plain text<br>&emsp;&emsp;&emsp;<input type="checkbox" name="thread_reader.clean_up_own_posts"> Clean up localStorage at loading embed native catalog<br>&emsp;&emsp;<input type="checkbox" name="thread_reader.sync"> Sync with parent catalog<br>&emsp;&emsp;&emsp;<input type="checkbox" name="thread_reader.triage"> Show triage to parent catalog<br>2,<IC"IDinfo.use">ID counters'+this.rollup('4,<IC"IDinfo.auto">Auto off when OP doesn\'t have ID or flag')+"<br>"+this.IDinfo("ID",!0)+this.IDinfo("ID2",!0)+this.IDinfo("flag",!1,"ID","nof flagged IDs")+this.IDinfo("name",!1,"trip","nof named trips")+this.IDinfo("trip",!1,"name","nof tripped names")},Notifiers:function(){return'Notifiers:<br>1,<IC"notify.desktop.notify">Desktop Notification'+this.notify_init("desktop")+'3,<ITB3"notify.desktop.lifetime"> secs (0 means permanent)<br>3,max: <ITB3"notify.desktop.limit">, delay: <ITB3"notify.desktop.delay">ms<br>3,<IC"notify.desktop.show_last">Show the last post only<br>'+this.notify_tgts("desktop")+'1,<IC"notify.favicon">Favicon<br>1,<IC"notify.title.notify">Show number of unread replies in title<br>2,<IC"notify.title.hide_zero">Hide unread count in title bar when it is zero<br>1,<IC"notify.sound.notify">Sound&emsp;&emsp;<BTN"notify.sound.pause,Pause">'+this.notify_init("sound")+'3,<IR"notify.sound.src,beep">Beep &emsp;freq:<ITB4"notify.sound.beep_freq"> length:<ITB4"notify.sound.beep_length_f"> volume:<ITB4"notify.sound.beep_volume_f"><br>3,<IR"notify.sound.src,file">File &emsp;<input type="file" accept="audio/*" name="notify.sound.file"><br>'+this.notify_tgts("sound")},"JSON Archiver: Store":function(){return archiver.event_funcs.queryQuota(),"JSON Archiver: Store<br><br>1,1. Make sure DOWNLOAD DIRECTORY to be set correctly."+this.rollup('3,All files will be into the directory.<br>3,And also, make sure each download doesn\'t ask you anything.<br>3,So many files will be downloaded.<br>2,<IC"archive.editing_timeout">Timeout for editing posts (patch for meguca)')+'<br>1,2. Select sources for each target:<br>2,File: Manual/Auto<br>3,<IC"archive.oneshot.post"><IC"archive.live.post">Posts<br>3,<IC"archive.oneshot.tn"><IC"archive.live.tn">Thumbnails<br>3,<IC"archive.oneshot.img"><IC"archive.live.img">Images (original size)<br>3,<IC"archive.oneshot.webm"><IC"archive.live.webm">Webms<br>2,IndexedDB:'+this.rollup('4,<IC"archive.IDB.auto_clean">Automatic clean up<br>4,<IC"archive.IDB.auto_clean_init">Automatic clean up at start up<br>4,Delayed pruning: <ITB3"archive.IDB.prune"> hours<br>5,<IC"archive.IDB.prune_flush">Archive to file at pruning<br>4,num of transactions: <ITB3"archive.IDB.nof_tr"><br>4,num of requests in a cluster: <ITB3"archive.IDB.nof_cl"> - <ITB3"archive.IDB.nof_cl_max"><br>4,watchdog timer: <ITB3"archive.IDB.watchdog">s')+'<br>4,used / limit: <span name="SHOW_QUOTA"></span><button type="button" name="archive.queryQuota"><img src="'+cnst.icons.refresh+'" style="width:1em;height:1em"></button><br>3,Manual/Auto<br>3,<IC"archive.oneshot.post_idb"><IC"archive.live.post_idb">Posts<br>3,<IC"archive.oneshot.tn_idb"><IC"archive.live.tn_idb">Thumbnails<br>3,<IC"archive.oneshot.img_idb"><IC"archive.live.img_idb">Images (original size)<br>3,<IC"archive.oneshot.webm_idb"><IC"archive.live.webm_idb">Webms<br>1,3. <IC"archive.list_inherit">Inherit previous archiving list (for 4d,e)<br>1,4a. <IC"archive.store_watched">Auto archiving for watched threads<br>1,4b. <IC"archive.store_auto">Auto archiving if OP matches:<br>2,Keyword: <input type="text" name="archive.kwd.str" size="25">'+this.make_sel("archive.kwd.match",["match all","match any","unmatch all","unmatch any"])+'<br>3,<ICN"archive.kwd.sub">Subject <ICN"archive.kwd.name">Name <ICN"archive.kwd.com">Comment <br>3,<ICN"archive.kwd.ci">CI <ICN"archive.kwd.sentence">Sentence <ICN"archive.kwd.re">RE<br>1,4c. <IC"archive.list">List picker<br>2,<textarea rows="1" cols="40" name="archive.list_str" placeholder="lain  // whole lainchan\n/tech/  // whole /tech/\n/q/1234  // thread /q/1234"></textarea><br>1,4d. <BTN"archive.oneshot,OneShotArchive"> or <BTN"archive.start,StartArchiving"><br>3,<IR"archive.src,shown"> All shown threads<br>3,<IR"archive.src,watched"> All watched threads<br>3,<IR"archive.src,stored"> All stored threads<br>1,4e. You can select target threads individually using triage<br>'},"JSON Archiver: Restore":function(){return 2===pref.archive.files_sel&&archiver.event_funcs.queryList(),'JSON Archiver: Restore<br><br>1,1. Open a live catalog, index page or thread to be overriden.<br>2,CatChan must be working in it.<br>1,2. Select where to extract<br>2,<IR"archive.format,auto">Select from filename: Domain-Board-No_Sub.json<br>2,<IR"archive.format,manual">Set manually: '+this.make_sel("archive.domain",site0.domains)+'/<ITB5"archive.board">/No.<br>1,3a. <IC"archive.IDB.auto_restore">Automatic restore from IndexedDB<br>3,<IC"archive.IDB.auto_restore_remove">Remove deleted thread from display<br>1,3b. Select source from: '+this.make_sel("archive.files_sel",["Dir","Files","IndexedDB"])+'<br><span name="FILES_ARCHIVE0"'+(0===pref.archive.files_sel?"":' style="display:none"')+'>&emsp;&emsp;<span><IF"archive.dir" multiple webkitdirectory directory><BTN"archive.files_clear,X"></span><br></span><span name="FILES_ARCHIVE1"'+(1===pref.archive.files_sel?"":' style="display:none"')+'>&emsp;&emsp;JSONs/HTMLs: <IF"archive.jsons" multiple accept=".html,.json,text/*"><br>2,<IC"archive.load_img">Images: <IF"archive.imgs" multiple webkitdirectory directory><br></span><span name="FILES_ARCHIVE2"'+(2===pref.archive.files_sel?"":' style="display:none"')+'>&emsp;&emsp;<span><select name="archive.IDB_board_sel"'+(pref.archive.IDB_select_multiple?" multiple":"")+' style="float:none"></select><select name="archive.IDB_thread_sel" style="float:none'+(pref4.archive.IDB_thread_sel_options?'"':';display:none"')+(pref.archive.IDB_select_multiple?" multiple":"")+"></select></span>"+this.rollup('&emsp;&emsp;<IC"archive.IDB_select_multiple">Multiple select<br>&emsp;&emsp;Export selected &emsp;&emsp;&emsp;&emsp;<BTN"archive.IDB.export_thread,Threads"><br>&emsp;&emsp;Reset archived time of selected <BTN"archive.IDB.reset_time,Threads">')+this.rollup('&emsp;&emsp;Delete selected <BTN"archive.IDB.delete_board,Boards"><BTN"archive.IDB.delete_thread,Threads"><BTN"archive.IDB.delete_imgs,Images">')+'<br></span>&emsp;&emsp;<BTN"archive.restore_button,Restore"> <IC"archive.restore_auto">Auto restore after selection<br>3,<IC"archive.clear_threads">Clear all threads at opening an archive<br>3,<IC"archive.fix_inconsistency">Fix inconsistencies at open<br>'},"UIP tracker for 4chan":'UIP tracker for 4chan:<br>1,<IC"uip_tracker.on">Show num of unique IPs after post No.<br>3, Check interval: <ITB3"uip_tracker.interval">sec, <IC"uip_tracker.adaptive">Adaptive<br>3, Style of changes: <ITBL30"uip_tracker.highlight_str"><br>2,<IC"uip_tracker.posts">Show num of posts<br>2,<IC"uip_tracker.deletion.show">Show deleted posts\' No.<br>3,<IC"uip_tracker.deletion.link">as links<br>2, Apply style to deleted post:<br>3,<IC"uip_tracker.deletion.name">Add style to name: <ITBL30"uip_tracker.deletion.name_str"><br>3,<IC"uip_tracker.deletion.addName">Add <ITBL30"uip_tracker.deletion.addName_str"> to name<br>3,<IC"uip_tracker.deletion.post">Add style to post: <ITBL30"uip_tracker.deletion.post_str"><br>2,<IC"uip_tracker.annotate">Annotate history of UIP from catalog<br>2,<IC"uip_tracker.auto_open">Open next thread automatically<br>3,Conditions:<br>4,After <input type="text" name="uip_tracker.auto_open_th" size="3" style="text-align: right;">th post<br>4,OP contains <textarea style="height:1em" cols="20" name="uip_tracker.auto_open_kwd"></textarea><br>2,<IC"uip_tracker.sage.detect">Sage detection, tolerance: <ITB2"uip_tracker.sage.tolerance"> sec<br>3,<IC"uip_tracker.sage.name">Add style to name: <ITBL30"uip_tracker.sage.name_str"><br>3,<IC"uip_tracker.sage.addName">Add <ITBL30"uip_tracker.sage.addName_str"> to name<br>3,<IC"uip_tracker.sage.post">Add style to post: <ITBL30"uip_tracker.sage.post_str"><br>3,Bug patch for corrupted data<br>4,<IC"uip_tracker.sage.patch_bug3">Ignore corrupted data at head by history<br>4,<IC"uip_tracker.sage.patch_bug4">Recover by page history<br>4,<IC"uip_tracker.sage.patch_bug5">Cease detection at encountering obsolete data<br>4,<IC"uip_tracker.sage.patch_bug2">Loose detection, to <ITB2"uip_tracker.sage.patch_bug2nth">th thread<br>4,<IC"uip_tracker.sage.patch_bug">Re-evaluate and recover<br>3,<IC"uip_tracker.sage.page">Annotate page history<br>3,<IC"uip_tracker.sage.annotate">Annotate sage from catalog<br>4,<IC"uip_tracker.sage.annotate_page">Annotate page history from catalog<br>',"Command Line Interface":'Command interface for overwriting preference<br>&emsp;<textarea style="height:1em" cols="40" name="cli.json_str"></textarea><br>1,<BTN"CLIe.ex,extract"><BTN"CLIe.full,extract_full"><BTN"CLIe.filter,extract_current_filter"><br>1,<BTN"CLI.query"><BTN"CLI.query_default"><BTN"CLI.query_boards"><br><br>1,<BTN"CLI.apply"><span name="JSON_result"></span><br>1,<IC"cli.auto">auto apply at startup<br><br><br>&emsp;<textarea style="height:1em" cols="40" name="cli.eval_str"></textarea><br>1,<BTN"EVAL,EVAL"><br>',Networking:function(){
return'Networking:<br>1,Timeout: <ITB3"network.timeout"> sec.<br>&emsp;Cross domain connection:<br>'+this.radios("network.cross_domain",2,["direct: Direct connection",'indirect: Indirect connection<br>3,<IC"network.overXFO">Over X-Frame-Options<br>3,<IC"network.overCSPF">Over Content Security Policy frame',"GM: GreaseMonkey's extension"])+'<br>&emsp;Data source:<br>&emsp;&emsp;<input type="radio" name="catalog.design" value="page">Page<br>&emsp;&emsp;<input type="radio" name="catalog.design" value="auto">Auto<br>&emsp;&emsp;<input type="radio" name="catalog.design" value="catalog">Catalog<br>&emsp;&emsp;&emsp;<input type="checkbox" name="catalog.catalog_json"> From json file<br>1,Lazy load/draw<br>2,Catalog/IndexPage/Float <br>3,<IC"catalog.lazyDraw.merge" style="visibility:hidden"><IC"page.lazyDraw.merge"><IC"float.lazyDraw.merge" style="visibility:hidden">Lazy draw each <ITB3"proto.lazyDraw.merge_step">posts<br>3,<IC"catalog.draw_on_demand"><IC"page.draw_on_demand"><IC"float.draw_on_demand">Lazy draw each <ITB3"proto.lazyDraw.step">threads<br>3,<IC"catalog.load_on_demand"><IC"page.load_on_demand"><IC"float.load_on_demand">Lazy load HTMLs/JSONs<br>2,<input type="checkbox" name="network.adaptive"> Adaptive<br>3,100%: new <input type="text" name="network.th100" size="3" style="text-align: right;"> threads, <input type="text" name="network.th100_delay" size="4" style="text-align: right;"> ms delay<br>3,20%: new <input type="text" name="network.th20" size="3" style="text-align: right;"> threads, <input type="text" name="network.th20_delay" size="4" style="text-align: right;"> ms delay<br>1,<IC"catalog_auto_update_countdown">Show countdown to auto update<br>1,<IC"healthIndicator.show">Health indicator, history: <ITB3"healthIndicator.max"><br>2,<IC"healthIndicator.expand_running">Show details of running indicators<br>2,<IC"healthIndicator.dont_retire_running">Don\'t retire running indicators<br>2,<IC"healthIndicator.cancel">Cancel scan when it is clicked<br>1,<IC"network.fetch_actively">Fetch missing info actively<br>'},"General 2":'General 2:<br>&emsp;Localtime offset<input type="text" name="localtime_offset" size="2" style="text-align: right;"><br>Share loaded html with other tabs to update<br>&emsp;<input type="checkbox" name="info_server"> Broadcast loaded html to other tabs (server)<br>&emsp;<input type="checkbox" name="info_client"> Listen other tab\'s broadcasting (client)<br>Cloudflare<br>&emsp;<input type="checkbox" name="cloudflare.auto_reload"> Auto reload at server error<br>&emsp;&emsp;<input type="text" name="cloudflare.auto_reload_time" size="2" style="text-align: right;"> minutes after<br><br><input type="checkbox" name="tooltips.info.show"> Show infotips<br>&emsp;pop up delay: <input type="text" name="tooltips.info.popup_delay" size="4" style="text-align: right;"> ms<br>&emsp;pop down delay: <input type="text" name="tooltips.info.popdown_delay" size="4" style="text-align: right;"> ms<br><input type="checkbox" name="tooltips.help.show"> Show tooltips<br>&emsp;pop up delay: <input type="text" name="tooltips.help.popup_delay" size="4" style="text-align: right;"> ms<br>&emsp;pop down delay: <input type="text" name="tooltips.help.popdown_delay" size="4" style="text-align: right;"> ms<br>Z-Index of tooptips: <ITB4"tooltips.zIndex"><br>Misc.<br><input type="checkbox" name="recovery.comment"> Recover comment when browser was crashed<br><input type="checkbox" name="catalog_footer_ignore_my_own_posts"> Ignore my own posts at counting unread posts<br><input type="checkbox" name="pref2.KC.summer_time"> Summer time in KC<br><br>Patches<br><input type="checkbox" name="patch.delayed_invoke.use"> Delayed invoke for 4chan, <input type="text" name="patch.delayed_invoke.sec" size="2" style="text-align: right;">sec.<br>',Styles:function(){return'Styles:<br>1,<IC"style.addSS.use">Additional StyleSheets, URLs are below<br>2,<TA"style.addSS.str,40,1"><br>1,Windows and popups:<br>2,Z-Index: <ITB4"style.zIndex"><br>2,<IR"style.sel,fix"> Fixed <BTN"style.reset.fix,reset"><br>3,Title bar:<ITBL30"style.fix.titleBar_str"><br>3,Window:<ITBL30"style.fix.window_str"><br>3,Pop up:<ITBL30"style.fix.popUp_str"><br>2,<IR"style.sel,copy"> Copy from CSS <BTN"style.reset.copy,reset"><br>3,Title bar:<ITBL30"style.copy.titleBar_str"><br>3,Window:<ITBL30"style.copy.window_str"><br>3,Pop up:<ITBL30"style.copy.popUp_str"><br>1,Others:<br>2,New post:<ITBL30"style.post_new"><br>2,Editing post:<ITBL30"style.post_editing"><br>'+this.userCSS(1)},Features:function(){return'Features:<br>1,<IC"features.page">Page<br>1,<IC"features.graph">Graph<br>1,<IC"features.setting2">Setting2<br>1,<IC"features.postform">Postform<br>1,<IC"features.catalog">Catalog<br>1,<IC"features.listener">Listener<br>1,<IC"features.uip_tracker">UIP_tracker<br>1,<IC"features.thread_reader">Thread Reader<br>1,<IC"features.recovery">Recovery comment<br>Notifications:<br>1,<IC"features.notify.desktop">DesktopNotification<br>1,<IC"features.notify.sound">Sound<br>1,<IC"features.notify.favicon">Favicon<br>Sites:<br>'+this.features_domains()},About:function(){return'CatChan<br>Version 2021.07.18.3<br><a href="https://github.com/DogMan8/CatChan">GitHub</a><br><a href="https://github.com/DogMan8/CatChan/raw/master/CatChan.user.js">Get stable release</a><br><a href="https://github.com/DogMan8/CatChan/raw/develop/CatChan.user.js">Get BETA release</a><br><br><br>Debug mode<br><input type="checkbox" name="debug_mode.0"><input type="checkbox" name="debug_mode.1"><ITB12"debug_mode.unread_count"><input type="checkbox" name="debug_mode.2"><input type="checkbox" name="debug_mode.3"><input type="checkbox" name="debug_mode.4">&emsp;<input type="checkbox" name="debug_mode.5"><input type="checkbox" name="debug_mode.parse_error"><input type="checkbox" name="debug_mode.7"><input type="checkbox" name="debug_mode.8"><br><ITB20"debug_mode.site2func" placeholder="catalog_json2html3"><BTN"Debug.site2func,dump_site2"><IC"debug_mode.site2func_expand">func<br><ITB15"debug_mode.pfunc" placeholder="4chan:catalog_json"><BTN"debug_mode.pfunc,dump_parse_funcs"><IC"debug_mode.pfunc_expand">func<br><ITB15"debug_mode.pfunc_comp" placeholder="4chan:catalog_json"><BTN"debug_mode.pfunc_comp,compare_parse_funcs"><IC"debug_mode.pfunc_comp_expand_same"><IC"debug_mode.pfunc_comp_expand_diff">func <br><ITBL60"debug_mode.pfunc_comp_proto" placeholder="temporal prototype dictionary in JSON format, {&quot;BBC.page_html_template&quot;:&quot;RSS.page_html_template&quot;}"><br><ITB15"debug_mode.pfunc_all" placeholder="op_img_url"><BTN"debug_mode.pfunc_all,find_parse_funcs"><IC"debug_mode.pfunc_all_expand">func'+this.rollup('<div style="float:left">'+site0.debug_domains.map(function(e){return'<IC"debug_mode.domains.'+e+'">'+e}).join("<br>")+'</div><div style="float:left">'+site0.debug_types.map(function(e){return'<IC"debug_mode.types.'+e+'">'+e}).join("<br>")+'</div><div style="clear:both"></div>')+'<br><input type="checkbox" name="debug_mode.9"><br>'+this.cb_block("debug_mode",10)+'<BTN"debugWindow,debugWindow"><br>Test mode'+this.rollup(this.cb_block("test_mode",0,100))+this.rollup(this.cb_block("test_mode",100)+(Debug?" LastReloaded: "+new Date(Debug.lastReloaded).toLocaleString():"")+'<br><IC"test_mode.tips"><ITB6"test_mode.num"><ITBL30"test_mode.test_str"><ITB6"test_mode.num_f">&emsp;<BTN"button_test,test"><br>1,<BTN"load_samples,setting_samples"><br><IF"test_mode.js_file" accept=".js,text/*"><BTN"test_mode.js_load,JS_load">')+"<br>"}},html_common:'<span name="reload_recommended" style="display:none;background:yellow">&emsp;&emsp;RELOAD IS REQUIRED TO GET LIGHT FEELING&emsp;&emsp;<br></span><span name="reload_required" style="display:none;background:red;color:white">&emsp;&emsp;RELOAD IS REQUIRED&emsp;&emsp;</span><br><BTN"close,close">&emsp;<BTN"save,save"><BTN"load_default,load_default"><BTN"load_default_of_this_page,load_default_of_this_page">',options:["Easy Setting2:","Easy Setting:","Virtual Board:","Catalog:","Index Page:","Thread:","Watcher/FC:","Gerenal 0","General 1","Board Group","Live Tag","Statistics","Footer","Footer for watcher","ThreadReader","Notifiers","JSON Archiver: Store","JSON Archiver: Restore","UIP tracker for 4chan","Command Line Interface","Networking","General 2","Styles","Features","About"],tag_gen:null,get onchange_funcs_formatted(){return Object.defineProperty(this,"onchange_funcs_formatted",{value:pref_func.add_onchange_format(this.onchange_funcs),writable:!0,enumerable:!0,configurable:!0}),pref_func.add_onchange_format(this.onchange_funcs.archive),this.onchange_funcs_formatted},oninput_funcs:null,onchange_funcs_base:null,onchange_funcs:{__proto__:{__proto__:function(){var e={SHOWALL:function(e){this.TOGGLE(e.target,"HIDEALL","",null,"no"),Array.prototype.slice.call(e.target.parentNode.parentNode.querySelectorAll("[name=SHOW],[name=SHOW2]")).forEach(function(e){e.onclick({target:e,currentTarget:e})})},HIDEALL:function(e){this.TOGGLE(e.target,"SHOWALL","",null,"no"),Array.prototype.slice.call(e.target.parentNode.parentNode.querySelectorAll("[name=HIDE],[name=HIDE2]")).forEach(function(e){e.onclick({target:e,currentTarget:e})})},SHOW:function(e){this.TOGGLE(e.target,"HIDE","")},HIDE:function(e){this.TOGGLE(e.target,"SHOW","none")},TOGGLE:function(e,t,n,r,a){r||(r=e);var s=e.getAttribute("data-str");e.setAttribute("data-str",r.textContent),r.textContent=s,e.setAttribute("name",t),"no"!==a&&(a||(a=e.nextSibling),a.style.display=n)},SHOW2:function(e){this.TOGGLE2(e.target,"HIDE2","")},HIDE2:function(e){this.TOGGLE2(e.target,"SHOW2","none")},TOGGLE2:function(e,t,n){"A"!==e.tagName&&(e=e.parentNode),this.TOGGLE(e,t,n,e.childNodes[2],e.nextSibling.nextSibling)},SHOW3:function(e){this.SEARCH_HIER(e.target,"data-show3").style.display="",e.target.style.display="none"},HIDE3:function(e){this.SEARCH_HIER(e.target.parentNode,"data-show3").style.display="",e.target.parentNode.style.display="none"},SEARCH_HIER:function(e,t){for(var n,r=e.getAttribute(t),a=e.parentNode;a&&(n=a.querySelectorAll("["+t+"="+r+"]")).length<2;)a=a.parentNode;return n[0]===e?n[1]:n[0]},SHOW2_I:function(e){var t=e.target.previousSibling;t.onclick&&t.onclick({target:t,currentTarget:t})},SHOW4:function(e){e.target.style.display="none",e.target.previousSibling.style.display=null},HIDE4:function(e){e.target.parentNode.style.display="none",e.target.parentNode.nextSibling.style.display=null},SUB:function(e){var t=e.currentTarget.previousSibling.previousSibling;if(t&&t.querySelectorAll){var n=t.querySelectorAll("span[data-class=show_value]");n.length>0&&pref_func.apply_prep(n,!1,null,null,null,this["."]&&this["."].pref||null)}},"virtualBoard.search.str":function(){liveTag.filter_onchange(pref.virtualBoard.search)},SHOW5:function(e){this.TOGGLE(e.target,"HIDE5","",null,this.SEARCH_HIER(e.target,"data-show5"))},HIDE5:function(e){this.TOGGLE(e.target,"SHOW5","none",null,this.SEARCH_HIER(e.target,"data-show5"))},SHOW_T:function(e){this.TOGGLE(e.target,"HIDE_T","",null,this.TRAVERSE(e.target))},HIDE_T:function(e){this.TOGGLE(e.target,"SHOW_T","none",null,this.TRAVERSE(e.target))},TRAVERSE:function(e){for(var t=e.dataset.trav,n=-1;++n<t.length;)e="n"===t[n]?e.nextSibling:"P"===t[n]?e.parentNode:e;return e}};for(var t in e)e[t]=e[t].bind(e);return e}()},"uip_tracker.on":uip_tracker_init,"healthIndicator.show":function(){cataLog.healthIndicator.show()},"healthIndicator.expand_running":function(){cataLog.healthIndicator.shrink_running()},get".."(){return pref_func.settings},"settings.indexing":function(e){var t=this[".."],n=t.pn13.childNodes[1];t.files_store();var r=t.htmls[t.options[pref.settings.indexing]],a=("function"==typeof r?r.call(t.htmls):r)+t.html_common;n.innerHTML='<form name="CatChan_settings">'+pref_func.format_html_str(a)+"</form>",pref_func.add_onchange(n,t.onchange_funcs_formatted),t.apply_pn13_1()},pn13_1_warning_reload:function(){pref3.reload_required=!0,this.pn13_1_warning()},pn13_1_warning:function(){var e=this[".."].pn13.childNodes[1],t=e.getElementsByTagName("span").reload_required;t.style.display=pref3.reload_required||pref3.stats.use!==pref.stats.use||pref.stats.estimate_posts&&!pref3.stats.estimate_posts?"":"none";var t=e.getElementsByTagName("span").reload_recommended;t.style.display=!pref.stats.estimate_posts&&pref3.stats.estimate_posts?"":"none"},"tag.scan":function(){pref.catalog.board.board_tags=!0,pref_func.settings.onchange_funcs["tag.generate_caller"]("tag.scan"),liveTag.popup_filter.popup()},"tag.same_tag_refresh":function(){pref.catalog.board.board_tags_same=!0,pref_func.settings.onchange_funcs["tag.generate_caller"]("tag.same_tag_refresh")},"tag.generate_caller":function(e){site2[site.nickname].get_boards_json("manual_refresh_boards_json",null,null,!0)},"tag.gen":function(){for(var e=pref_func.settings.tag_gen.childNodes[1].getElementsByTagName("input"),t="",n=pref_func.settings.tag_gen.childNodes[1].getElementsByTagName("textarea")[0].value,r=site3["8chan"].boards,a=0;a<e.length;a++)if(e[a].checked){var s=e[a].nextSibling.textContent.replace(/ [0-9]*: /,"");""===n&&(n="#"+s);for(var i=0;i<r.length;i++)for(var o=0;o<r[i].tags.length;o++)r[i].tags[o]==s&&(t=t+"8chan/"+r[i].uri+"/,")}pref_func.catalog_board_list_str_bt=n+","+t,pref_func.settings.onchange_funcs.board_sel_refresh()},"tag.gen_add":function(){pref_func.settings.onchange_funcs["tag.gen"](),pref_func.settings.onchange_funcs["tag.add_to_list"](pref_func.catalog_board_list_str_bt)},"tag.recommendation_add":function(){pref_func.settings.onchange_funcs["tag.add_to_list"](pref_func.catalog_board_list_str_or)},"tag.add_to_list":function(e){""!==e&&(pref.catalog_board_list_str.search(/\n$/)==-1&&(pref.catalog_board_list_str=pref.catalog_board_list_str+"\n"),pref.catalog_board_list_str=pref.catalog_board_list_str+e+"\n",pref_func.settings.pn13&&pref_func.settings.apply_pn13_1(),pref_func.settings.onchange_funcs.board_sel_refresh())},board_sel_refresh:function(){pref_func.str2obj("catalog_board_list_str"),cnst.auto_shrink_board_selector.str_changed()},"stats.use":"pn13_1_warning","stats.estimate_posts":"pn13_1_warning","stats.auto_acquisition":function(){cnst.auto_shrink_board_selector.color()},"stats.auto_acquisition_all":"stats.auto_acquisition","catalog.board.recommendation":"board_sel_refresh","catalog.board.board_tags":"board_sel_refresh",catalog_board_list_str:"board_sel_refresh","catalog.board.all_boards":"board_sel_refresh","CLI.*w/":function(e,t){var n=t.split(".")[1],r="query_boards"===n?'{"site2":{"'+site.nickname+'":{"boards_json":""}}}':pref.cli.json_str;pref_func.queryOrSet_params_by_JSON("apply"!==n&&("query_default"!==n||pref_default()),r,null,pref_func.settings.pn13.getElementsByTagName("*").JSON_result),pref_func.settings.apply_pn13_1()},"CLIe.*w/":function(e,t){var n=t.split(".")[1];pref_func.site2_json_ex("full"===n,"filter"===n),pref_func.settings.apply_pn13_1()},EVAL:function(){pref_func.site2_eval()},close:function(){pref_func.settings.show_hide()},save:function(){localStorage&&(localStorage[pref.script_prefix+".pref"]=JSON.stringify(pref_func.site2_json_ex_remove()))},load_default:function(e){var t=pref_default();if(delete t.settings.indexing,delete t.catalog_board_list_sel,delete t.filter,"load_default_of_this_page"===e.target.name){for(var n=e.target.parentNode.getElementsByTagName("*"),r=0;r<n.length;r++)if(n[r].name){var a=pref_func.get_tgt(n[r].name,t,!0);if(a){var s=pref_func.get_tgt(n[r].name);s[0][s[1]]=a[0][a[1]]}}}else 0===e.target.name.indexOf("easy2")&&delete t.easy2,pref_func.pref_overwrite(pref,t),pref3.reload_required=!0;pref_func.obj_init(),pref_func.settings.apply_pn13_1(),pref_func.settings.apply_pn13_1(!0,"load_default_of_this_page"===e.target.name&&cataLog.threads)},load_default_of_this_page:"load_default",load_samples:function(){pref_func.pref_samples.init()},catalog_triage_str:function(){cataLog.triage&&cataLog.triage.remake()},"triage.hide_toggle":"catalog_triage_str","triage.menu_str":"catalog_triage_str","triage.postMenu_str":"catalog_triage_str","catalog.footer.*w/":function(e,t){cataLog.Footer&&cataLog.Footer.update_all_force(e,t)},"float.footer.*w/":"catalog.footer.*w/","proto.footer.*w/":"catalog.footer.*w/","liveTag.style.*w/":"catalog.footer.*w/","thread_reader.use":thread_reader_init,"catalog.appearance.titleBar.*w/":function(e,t){for(var n=t.split(".")[0],r=gClg.Clgs,a=0;a<r.length;a++)r[a].mode===n&&(r[a].components.titleBar.getElementsByTagName("*")[t.split(".").pop()].style.display=e.currentTarget.checked?"":"none")},"virtualBoard.p_board":function(){liveTag.update_boardlist(!0)},"virtualBoard.p_remove":"virtualBoard.p_board","virtualBoard.max":"virtualBoard.p_board","virtualBoard.show":"virtualBoard.p_board","easy.*w/":function(e,t){this.pn13_1_warning_reload(),pref_func.pref_samples.onclick_event.call(e.target)},"easy2.beginner":function(e){pref.easy2.presets=1,pref_func.settings.onchange_funcs["easy2.presets"](e,pref.easy2.presets),pref_func.settings.onchange_funcs["easy2.apply"](e,!0),pref_func.settings.onchange_funcs.reload(e)},"easy2.presets":function(e,t){pref_func.pref_samples["easy2.presets"](void 0!==t?t:pref.easy2.presets),pref_func.settings.apply_pn13_1()},"easy2.limits":function(e,t){pref_func.pref_samples["easy2.limits"](),pref_func.settings.apply_pn13_1()},"easy2.apply":function(e,t){(pref.easy2.reset||t)&&pref_func.settings.onchange_funcs.load_default(e),pref_func.pref_samples["easy2.presets"](),pref_func.settings.onchange_funcs.pn13_1_warning_reload(),pref_func.pref_samples.onclick_event(null,pref.easy2)},reload:function(){location.reload()},"triage.sampleLoader":function(e){var t=e.target.dataset.tgt;if("catalog_triage_str"===t)this["triage.sample.*w/"](e,e.target.selectedOptions[0].value||e.target.selectedOptions[0].textContent);else{var n=t.indexOf("footer")!=-1?{kill:"KILL,x,,SPC, ,",simple:"KILL,x,,SPC, ,,WATCH,w,,SPC, ,,UNWATCH,uw,,SPC, ,",menu:"SPC, ,,MENU,▶,",hl:"KILL,x,,SPC, ,,NONE, H,background:lightcyan,NONE,R,opacity:0.7;background:gray,NONE,N,,",ex:"EXPAND,▶,◀,SPC, ,,",mr:"MERGEB,B,border:1px solid red,MERGE,M,,",sp:"SPC, ,",get headline(){return this.hl+this.sp},get headline_ex(){return this.ex+this.hl+this.sp},get headline_merge(){return this.hl+this.mr+this.sp},get headline_merge_ex(){return this.ex+this.hl+this.mr+this.sp}}:t.indexOf("post")!=-1?{simple:"PHIDE,hide,\nPHIDEAFTER,hide+,\nPUNHIDE,unhide,\n",get basic(){return this.simple+"PCLEARHIDE,clear,\n"},get full(){return this.basic+"PDISABLEHIDE,disable,\nPENABLEHIDE,enable,\nPWATCH,Watched,\n"}}:{menu_core:"KILL,Hide permanently,\nTIME,Hide until new replies,\nWATCH,Watch,\nUNWATCH,Unwatch,\nSTICKY,Sticky,\nUNSTICKY,Unsticky,\n",menu_undo:"UNDO,Undo,",get menu_basic(){return this.menu_core+this.menu_undo},get menu_attr(){return this.menu_core+'SHOW,Show always,\nUNSHOW,Remove "show" mark,\nATTR,Red border,border:solid 2px red\nATTR,Red background,background:#fac2c5\nNONE,Remove style,\n'+this.menu_undo},get menu_full(){return this.menu_attr+"\n"+this.menu_arcMerge},menu_arcMerge:"ARC1,Take one-shot archive,\nARC,Start archiving,\nUNARC,Stop archiving,\nMERGEB,Set merge base,\nMERGE,Merge,\nMERGEOP,Merge threads in op,\nUNMERGE,Unmerge,\nUNDOMERGE,Undo last merge,\n"},r=e.target.selectedOptions[0],a=this[".."].pn13.getElementsByTagName("TEXTAREA")[t];a.value=n[r.value||r.textContent],pref_func.apply_prep(a,!0,!0)}e.target.selectedIndex=0},"triage.sample.*w/":function(e,t){var n={simple_kill:"KILL,X,",simple:"KILL,X,,TIME,v,,WATCH,W,,UNWATCH,UW,,UNDO,U,",basic:"KILL,X,,TIME,v,,WATCH,W,,UNWATCH,UW,,SHOW,★,,UNSHOW,☆,,STICKY,S,,UNSTICKY,US,,UNDO,U,",basic_color:"KILL_N,X,,TIME_N,v,,WATCH,W,,UNWATCH,UW,,SHOW,★,,UNSHOW,☆,,STICKY,S,,UNSTICKY,US,,UNDO,U,\nNONE,O,,ATTR,O,background:#c3dcf9,ATTR,O,background:#b8efc2,ATTR,O,background:#efedbe,ATTR,O,background:#fbd5fb,ATTR,O,background:#fac2c5\nATTR,O,border:3px solid blue,ATTR,O,border:3px solid lime,ATTR,O,border:3px solid yellow,ATTR,O,border:3px solid orange,ATTR,O,border:3px solid red\n",colorful:"KILL,X,,KILL,X,background:#c3dcf9,KILL,X,background:#b8efc2,KILL,X,background:#efedbe,KILL,X,background:#fbd5fb,KILL,X,background:#fac2c5\nTIME,v,,TIME,v,background:#c3dcf9,TIME,v,background:#b8efc2,TIME,v,background:#efedbe,TIME,v,background:#fbd5fb,TIME,v,background:#fac2c5\nNONE,O,,NONE,O,background:#c3dcf9,NONE,O,background:#b8efc2,NONE,O,background:#efedbe,NONE,O,background:#fbd5fb,NONE,O,background:#fac2c5\nUNDO,U,,WATCH,W,,UNWATCH,UW,,GO,G,\n",borders:"KILL,X,,KILL,X,border:3px solid blue,KILL,X,border:3px solid lime,KILL,X,border:3px solid yellow,KILL,X,border:3px solid orange,KILL,X,border:3px solid red\nTIME,v,,TIME,v,border:3px solid blue,TIME,v,border:3px solid lime,TIME,v,border:3px solid yellow,TIME,v,border:3px solid orange,TIME,v,border:3px solid red\nNONE,O,,NONE,O,border:3px solid blue,NONE,O,border:3px solid lime,NONE,O,border:3px solid yellow,NONE,O,border:3px solid orange,NONE,O,border:3px solid red\nUNDO,U,,WATCH,W,,UNWATCH,UW,,GO,G,\n",toggles:"KILL,X,,TIME,v,,WATCH,W,,UNWATCH,UW,,UNDO,U,,SHOW,★,,UNSHOW,★,border:2px inset,STICKY,†,,UNSTICKY,†,border:2px inset;,NONE,n,",samples:"KILL,delete forever,\nTIME,hide until new replies,\nNONE,back to default design,background:;border:;\nNONE,border and background,background:#c3dcf9;border:3px solid blue\nNONE,border 3px,border:3px solid blue\nNONE,background,background:#c3dcf9\nNONE,border 5px,border:5px solid blue\nNONE,border 1px,border:1px solid blue\nNONE,transparent,background:\nNONE,shrink,width:100px;height:100px\nGO,open this thread,\n",test:"KILL,X,,TIME,v,,WATCH,W,,UNWATCH,UW,,SHOW,★,,UNSHOW,☆,,STICKY,S,,UNSTICKY,US,,UNDO,U,,ARC,A+,,ARC1,A1,,UNARC,A-,"};pref.catalog_triage_str=n[t.split(".").pop()];var r=pref_func.settings.pn13.getElementsByTagName("*").catalog_triage_str;r&&pref_func.apply_prep(r,!1),this.catalog_triage_str(e)},"virtualBoard.scanStart":function(){catalog_obj&&null!==catalog_obj.catalog_func()&&catalog_obj.catalog_func().catalog_liveTag_scan_site()},"virtualBoard.scanStop":function(){scan.abort()},"virtualBoard.scan_domains.*w/":function(e,t){if(pref.virtualBoard.instant_scan){var n=t.split(".").pop();scan.keyword_load_1(n)}},"virtualBoard.search.show":function(e,t){if(site.components.boardlist){var n="virtualBoard.search",r=site.components.boardlist.getElementsByTagName("input")[n+".str"];r&&(r=r.parentNode),pref.virtualBoard.search.show?r||(r=document.createElement("span"),r.innerHTML=pref_func.format_html_str('<ITBL10"'+n+'.str"><span style="display:none"><ICN"'+n+'.re">RE, &lt;<ITB2"virtualBoard.max"><span name="HIDE4">◀</span></span><span name="SHOW4">▶</span>'),r.style="float:right",pref_func.apply_prep(r,!1),pref_func.add_onchange(r,pref_func.settings.onchange_funcs_formatted,pref_func.settings.oninput_funcs),site.settings.parentNode.insertBefore(r,site.settings),pref_func.mirror_targets.boardlist=r,t||liveTag.update_pn()):r&&(site.settings.parentNode.removeChild(r),pref_func.mirror_targets.boardlist=null,liveTag.update_pn())}},"virtualBoard.search.*":"virtualBoard.search.str","liveTag.ex_list_str":function(){liveTag.ex_list_changed()},"liveTag.inherit_board_name":function(){liveTag.inherit_board_name_changed()},"liveTag.inherit_board_tags":function(){liveTag.inherit_board_tags_changed()},"page.mark_new_posts":function(){if(gClg.Clgs)for(var e=0;e<gClg.Clgs.length;e++)gClg.Clgs[e].view_time_filter_changed()},"recovery.comment":function(){recovery.setup()},"*.scroll_lock":function(){cataLog.general_event_handler.setup()},button_test:function(){function e(e,t,n,r){console.log(r)}IDB.req_raw("meguca","meguca","mine",null,e,"get_all",!0)},archive:{restore2:function(e,t,n){if(cataLog.threads&&(!e||pref.archive.restore_auto||"archive.restore_button"===e.target.name)){n||(t=Array.prototype.slice.call(pref3.archive.dir.files),n=t.filter(function(e,t,n){return e.name.search(/\.(json|html*)$/)!=-1}),n=n.filter(function(e,t,n){return e.name.indexOf("_deleted.json")==-1}));var r=t.filter(function(e,t,n){return e.name.search(/\.(json|html*)$/)==-1});0!==n.length&&archiver.restore_entry(n,r,this.clear_files_button,t.filter(function(e,t,n){return e.name.indexOf("_deleted.json")!=-1}))}},dir:"restore2",files_sel:function(e){e.target.parentNode.querySelectorAll('span[name="FILES_ARCHIVE0"]')[0].style.display=0===pref.archive.files_sel?"":"none",e.target.parentNode.querySelectorAll('span[name="FILES_ARCHIVE1"]')[0].style.display=1===pref.archive.files_sel?"":"none",e.target.parentNode.querySelectorAll('span[name="FILES_ARCHIVE2"]')[0].style.display=2===pref.archive.files_sel?"":"none",2===pref.archive.files_sel&&this.queryList()},restore_button:function(e){0===pref.archive.files_sel&&this.restore2(e),2===pref.archive.files_sel?this.IDB_thread_sel(e):this.restore(e)},restore:function(e){var t=pref3.archive.jsons.files,n=pref3.archive.imgs.files;0===t.length||pref.archive.load_img&&0===n.length||this.restore2(null,Array.prototype.slice.call(n),t)},jsons:"restore",imgs:"restore",clear_files_button:function(){for(var e=[pref3.archive.jsons,pref3.archive.imgs],t=0;t<e.length;t++)if(e[t]&&e[t].parentNode){var n=e[t].parentNode.insertBefore(e[t].cloneNode(e[t]),e[t]);n.onchange=e[t].onchange,e[t].parentNode.removeChild(e[t]),n.onchange({target:e[t],currentTarget:e[t]})}},get pn_IDB_board_sel(){return pref_func.settings.pn13&&pref_func.settings.pn13.querySelector('select[name="archive.IDB_board_sel"]')},get pn_IDB_thread_sel(){return pref_func.settings.pn13&&pref_func.settings.pn13.querySelector('select[name="archive.IDB_thread_sel"]')},IDB_select_multiple:function(){this.pn_IDB_board_sel.multiple=pref.archive.IDB_select_multiple,this.pn_IDB_thread_sel.multiple=pref.archive.IDB_select_multiple},queryQuota:function(){navigator.webkitTemporaryStorage&&navigator.webkitTemporaryStorage.queryUsageAndQuota(this.showQuota.bind(this))},showQuota:function(e,t){var n=pref_func.settings.pn13.querySelector('span[name="SHOW_QUOTA"]');n&&(n.textContent=e.toLocaleString()+" / "+t.toLocaleString()+" ("+(100*e/t).toString().slice(0,5)+"%)")},queryList:function(){pref.test_mode[65]||pref4.archive.IDB_board_sel_options||(brwsr.ff?setTimeout(function(){this.showList({target:{result:Object.keys(liveTag.mems[site.nickname])}})}.bind(this),0):window.indexedDB.webkitGetDatabaseNames().onsuccess=this.showList.bind(this))},showList:function(e){if(e){for(var t=e.target.result,n=["Select board"],r=0;r<t.length;r++)n[n.length]=t[r].replace(/^[^\/]*/,"");n[n.length]="ALL ("+t.length+")"}else n=null;pref4.archive.IDB_board_sel_options=n,pref_func.apply_prep(this.pn_IDB_board_sel,!1)},IDB_board_sel:function(){pref4.archive.IDB_thread_sel_options=null;var e=this.pn_IDB_thread_sel;pref_func.apply_prep(e,!1),e.style.display="";for(var t=this.IDB_selected_boards(),n=0;n<t.length;n++)IDB.req(site.nickname,t[n],null,null,this.showThreadList_fromIDB.bind(this),"list_os")},IDB_selected_boards:function(){return 0===pref.archive.IDB_board_sel?[]:pref4.archive.IDB_board_sel_options&&pref.archive.IDB_board_sel===pref4.archive.IDB_board_sel_options.length-1?pref4.archive.IDB_board_sel_options.slice(1,-1):Array.prototype.slice.call(this.pn_IDB_board_sel.options).filter(function(e){return e.selected}).map(function(e){return e.textContent})},showThreadList_fromIDB:function(e,t,n){1==this.IDB_selected_boards().length&&(t="");for(var r=pref4.archive.IDB_thread_sel_options||["ALL"],a=0;a<n.length;a++)r[r.length]=t+n[a];r[0]=" ",r.sort(),r[0]="ALL ("+(r.length-1)+")",pref4.archive.IDB_thread_sel_options=r,pref_func.apply_prep(this.pn_IDB_thread_sel,!1)},IDB_thread_sel:function(e){cataLog.threads&&(pref.archive.restore_auto||"archive.restore_button"===e.target.name)&&(pref.archive.clear_threads&&cataLog.threads&&pClg.clear_threads(0),this["IDB.selected_threads"](IDB.req,null,this.restore3.bind(this),"get_all"))},"IDB.selected_threads":function(e,t,n,r){var a=0===pref.archive.IDB_thread_sel?pref4.archive.IDB_thread_sel_options.slice(1):Array.prototype.slice.call(this.pn_IDB_thread_sel.options).filter(function(e){return e.selected}).map(function(e){return e.textContent}),s=this.IDB_selected_boards(),i=1===s.length?s[0]:"";if(!e){for(var o={domain:site.nickname,boards:s},l=0;l<a.length;l++)a[l]={board:i||a[l].replace(/[^\/]*$/,""),no:a[l].replace(/\/[^\/]*\//,""),__proto__:o};return a}for(var l=0;l<a.length;l++)e(site.nickname,i||a[l].replace(/[^\/]*$/,""),a[l].replace(/\/[^\/]*\//,""),t,n,r)},restore3:function(e,t,n,r,a){var s=this.consolidate_IDB_result(r,e);if(s.posts.length>0){var i=archiver.restore({name:(site.nickname+t+n).replace(/\//,"-")},site2[e].parse_funcs.thread_json.prep_to_archive(s.posts),s.tn,!0,a);if(s.posts_deleted.length>0){pref.test_mode[80]&&(t=t.slice(0,-1)+"_IDB/");var o=liveTag.mems.init({domain:e,board:t,no:n});archiver.prep_deleted_posts(i,o,!0,s.posts_deleted,a)}}},consolidate_IDB_result:function(e,t){for(var n=[],r=[],a={},s=Object.create(a),i=Object.keys(e),o=0;o<i.length;o++)if(0===i[o].indexOf("posts_deleted"))r=r.concat(e[i[o]]);else if(0===i[o].indexOf("posts"))n=n.concat(e[i[o]]);else{if("pruned_time"===i[o])continue;var l=i[o].replace(/[^\.]*./,""),p="webm"===l?"video/webm":"image",c={type:p,file:e[i[o]]};0===i[o].indexOf("tn_")?s[i[o].substr(3)]=c:a[i[o].substr(4)]=c}for(var o=0;o<n.length-1&&n[o].no<n[o+1].no;)o++;if(o!==n.length-1)for(n.sort(this.consolidate_IDB_sort_func),o=0;o<n.length-1;){if(n[o].no===n[o+1].no){for(var _=o+2;_<n.length&&n[o].no===n[_].no;)_++;if("meguca"===t){for(var d=n[o].editing,u=o+1;u<_&&n[u].editing==d;)u++;if(u<_)for(u=_;--u>o;)n[u].editing&&(n.splice(u,1),_--)}for(;--_>o;)n.splice(_,1)}o++}_=0;for(var o=0;o<r.length;o++){for(;_<n.length&&n[_].no<r[o].no;)_++;_<n.length&&n[_].no===r[o].no&&n.splice(_,1)}var f=t&&site2[t].parse_funcs.thread_json.consolidate_IDB_result_sub;return f&&0!==n.length&&f(n),{posts:n,posts_deleted:r,img:a,tn:s}},consolidate_IDB_sort_func:function(e,t){return e.no!==t.no?e.no-t.no:e.com<t.com?-1:1},"IDB.delete_board":function(){for(var e=this.IDB_selected_boards(),t=0;t<e.length;t++)window.indexedDB.deleteDatabase(pref.script_prefix+"."+e[t]);var n=this.pn_IDB_thread_sel;n&&(n.style.display="none"),this.showList(null),this.queryList()},"IDB.delete_thread":function(){this["IDB.selected_threads"](IDB.req,null,null,"delete_th"),this.IDB_board_sel(null)},"IDB.delete_imgs":function(){this["IDB.selected_threads"](IDB.req,IDBKeyRange.bound("img_","img`",!1,!0),null,"delete")},"IDB.export_thread":function(){for(var e=this["IDB.selected_threads"](),t="CatChan_IDB_"+e[0].domain+"-"+(1==e[0].boards.length?e[0].board.slice(1,-1):e[0].boards.length)+"-"+(1===e.length?e[0].no:e.length)+".tar",n="IDB_extract_"+Date.now(),r=function(r){var a=e.length;return function(e,s,i,o){r.export_thread(e,s,i,o,n),0==--a&&archiver.tar.flush(n,t)}}(this),a=0;a<e.length;a++)IDB.req(e[a].domain,e[a].board,e[a].no,null,r,"get_all")},export_thread:function(e,t,n,r,a,s){for(var i=this.consolidate_IDB_result(r,e),o=Object.keys(i),l=0;l<o.length;l++)for(var p=Array.isArray(i[o[l]])?["dummy"]:Object.keys(i[o[l]]),c=0;c<p.length;c++){var _=0===o[l].indexOf("posts");if(!_||0!==i[o[l]].length){var d=_?new Blob([JSON.stringify(site2[e].parse_funcs.thread_json.prep_to_archive(i[o[l]]))],{type:"text/plain"}):i[o[l]][p[c]].file,u=_?e+"-"+t.slice(1,-1)+"-"+n+o[l].substr(5)+".json":o[l]+"_"+p[c];archiver.tar.add_blob(d,{domain:e,board:t,no:n},u,a,!0)}}s&&archiver.tar.flush(a,s)},"IDB.reset_time":function(){this["IDB.selected_threads"](archiver.clean_list)},start:function(e){archiver.store_entry("archive.start"===e.target.name?"ARC":"ARC1")},oneshot:"start","kwd.*":function(){pref.archive.kwd.rexps=common_func.kwd_prep_regexp(pref.archive.kwd)}},"test_mode.js_load":function(){var e=pref_func.settings.pn13.getElementsByTagName("input")["test_mode.js_file"].files[0],t=window.URL.createObjectURL(e),n=document.createElement("script");n.src=t,site.script_body.appendChild(n)},scanBoard:function(e){cataLog.event_func&&cataLog.event_func(e)},scanBoardIf:"scanBoard",scanSite:"scanBoard",scanSiteIf:"scanBoard",tighten_loosed_limits:function(e){pref4.search_posts_active_once=!1},
"*w/.t2h_sel":function(e,t){cataLog.Footer&&pref.catalog.footer.use&&pref.catalog.footer.flag&&cataLog.Footer.update_all_force(e,t,!0)},"*w/.t2h_num_of_posts":"catalog.t2h_sel",debugWindow:function(){debugWindow=cnst.init3({func_str:"left:0px:top:0px:tb:width:400px:height:400px:overflow:auto:Show:bottom_top:tb_press:float"}),debugWindow.connect=function(){return debugWindow.cn.appendChild(document.createElement("div"))}},cleanMerge:function(){for(var e=pref.proto.merge_list_str.replace(/\+/g,",+").replace(/\n/g,",\n,").split(","),t=!1,n=e.length-1;n>=0;n--){var r=e[n].replace(/^\s*/,"").replace(/\s*$/,"");"\n"!==r&&""!==r&&(0===r.search(/[^\/+]+\/[^\/]+\/[^\/]+/)?(t||e.splice(n,1),t=!1):t=!0)}pref.proto.merge_list_str=pref_func.fmt4str2(e.join(",").replace(/,\+/g,"+").replace(/,\n,/g,"\n")),pref_func.apply_prep_1n("proto.merge_list_str",!1,!0,null,!0);var a={key:"cleanMerge",obj:Object.keys(pref3.proto.merge_list_obj2[":REV"]).filter(function(e){var t=common_func.name2dbt(e),n=site2[t[0]].make_url4(t);return n&&n[0]&&n[1]}),found_threads:0,max_threads:1/0,__proto__:cataLog.scan_boards.args_proto}.initialize();httpd.req_serial(a,2)},"catalog.style_general_list":function(){for(var e=0;e<gClg.Clgs.length;e++)gClg.Clgs[e].onchange_funcs["filter.attr_list_str"]()},"catalog.style_general_list_str":function(){pref.catalog.style_general_list&&this["catalog.style_general_list"]()},"postFilter.*w/":function(e,t){if("postFilter.use"===t||pref.postFilter.use)for(var n=0;n<gClg.Clgs.length;n++)gClg.Clgs[n].onchange_funcs["filter."+t+" w/"](e,t);pref.postFilter.obj7_old=null},"*.hide_posts_without_images":function(){for(var e=0;e<gClg.Clgs.length;e++)for(var t in gClg.Clgs[e].threads)cataLog.format_html.hide_posts_without_images(gClg.Clgs[e],gClg.Clgs[e].threads[t][16].posts)}}},format_html_str:function(e){return e=e.replace(/(<br>|<\/div>)([0-9]),/g,function(e,t,n){for(var r=t,a=0;a<n;a++)r+="&emsp;";return r}),e=e.replace(/<SE"([^"]*)"([^>]*)>/g,function(e,t,n){var r=t.split(",");return'<select name="'+r[0]+'"'+n+">"+r.slice(1).map(function(e){var t=e.indexOf(":");return"<option"+(t>=0?' value="'+e.slice(0,t)+'">':">")+e.slice(t+1)+"</option>"}).join("")+"</select>"}),e=e.replace(/<TA"([\w.]+),(\d+),(\d+)"([^>]*)>/g,'<textarea style="height:1em" rows="$3" cols="$2" name="$1"$4></textarea>'),e=e.replace(/<IC(N)?"([\w.]+)"([^>]*)>(\w)?/g,function(e,t,n,r,a){return'<input type="checkbox" name="'+n+'"'+r+">"+(a&&!t?" "+a:a||"")}),e=e.replace(/<ITB(N)?(L)?(\d+)"([\w.]+)"([^>]*)>(\w)?/g,function(e,t,n,r,a,s,i){return'<input type="text"'+(n?"":' style="text-align: right;"')+' size="'+r+'" name="'+a+'"'+s+">"+(i&&!t?" "+i:i||"")}),e=e.replace(/<IR"([\w\.]+),([^"]+)"([^>]*)>/g,'<input type="radio" name="$1" value="$2"$3>'),e=e.replace(/<SSV("[\w\.]+")>/g,'<span data-class="show_value" style="font-weight:bold" name=$1></span>'),e=e.replace(/<BTN"([\w.\s]+)(,[^"]+)*"([^>]*)>/g,function(e,t,n,r){return'<button type="button" name="'+t+'"'+r+">"+(n?n.slice(1):t.split(".").pop())+"</button>"}),e=e.replace(/<IF"/g,'<input type="file" name="'),e.replace(/<input type="(checkbox|radio)[^>]+>[^<]+/g,"<label>$&</label>")}}}(),pref_func.settings.onchange_funcs_base=pref_func.settings.onchange_funcs.__proto__.__proto__,pref_func.settings.oninput_funcs=pref_func.add_onchange_format(pref_func.settings.onchange_funcs.__proto__),pref_func.settings.onchange_funcs["tag.gen_str"]=pref_func.settings.onchange_funcs["tag.gen"],pref_func.settings.html_funcs=pref_func.settings.htmls.__proto__;var options={func0_prep:function(){},func0_exe:function(){}};common_func={__proto__:common_func,overwrite_prop:function(e,t){for(var n in t)void 0===t[n]&&e[n]?delete e[n]:"object"==typeof e[n]&&"object"==typeof t[n]?common_func.overwrite_prop(e[n],t[n]):e[n]=t[n]},name2domainboardthread:function(e,t){var n=e.substr(e.lastIndexOf("/")+1),r=e.substr(0,e.indexOf("/")),a=e.substr(r.length,e.length-n.length-r.length);return e===n&&n.search(/[^0-9]/)!=-1&&(r=n,n=""),t&&(""===r&&(r=site.nickname),""===a&&(a=site.board)),[r,a,n]},name2dbt:function(){var e={c:"catalog_html",j:"catalog_json",p:"page_html",q:"page_json",t:"thread_json"};return function(t){var n=this.name2domainboardthread(t,!0);return n[3]=e[n[2][0]],n[3]?n[2]=n[2].substr(1):n[3]="thread_html",n}}(),fullname2dbt:function(e){var t=e.substr(e.lastIndexOf("/")+1),n=e.substr(0,e.indexOf("/"));return[n,e.substr(n.length,e.length-t.length-n.length),t]},dom_addEventListener:function(e,t,n,r){t.addEventListener(n,r,!1),e[e.length]=[t,n,r]},dom_removeEventListener:function(e,t,n,r){for(var a=e.length-1;a>=0;a--)if(!(t&&t!==e[a][0]||n&&n!==e[a][1]||r&&r!==e[a][2])){var s=e.splice(a,1)[0];s[0].removeEventListener(s[1],s[2],!1)}},dom_addAttribute:function(e,t,n){var r=e.getAttribute(t);r&&(n=r+" "+n),e.setAttribute(t,n)},perf_out:function(e){e.push(performance.now());for(var t="",n=null,r=0;r<e.length;r++)"number"==typeof e[r]?(n&&(t+=e[r]-n+", "),n=e[r]):t+=e[r]+", ";console.log(t)},shallow_copy_1:function(e){var t=Object.create(null);for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t},deep_copy:function(e,t){for(var n in t)t.hasOwnProperty(n)&&(Array.isArray(t[n])?e[n]=t[n].slice():"object"==typeof t[n]?e[n]=this.deep_copy({},t[n]):e[n]=t[n]);return e},deep_copy2:function(e,t){for(var n in t)t.hasOwnProperty(n)&&(Array.isArray(t[n])?e[n]=t[n].slice():"object"==typeof t[n]?null===t[n]?e[n]=null:e[n]=this.deep_copy({},t[n]):e[n]=t[n]);return e},kwd_prep_regexp:function(e,t){if(!e.str)return null;for(var n=e.sentence?[e.str]:e.str.split(" "),r=[],a=0;a<n.length;a++)if(n[a]){if(e.re)s=n[a].replace(/\\$/,"");else{var s=n[a].replace(/[\.\(\)\[\]\+\^\$\{\}\\]/g,"\\$&").replace(/\*/g,".*").replace(/\?/g,".");s=t?"^"+s+"$":e.ew?"(^|\\s|\\n)"+s+"(\\s|\\n|$)":s.replace(/([^\\])\.\**$/,"$1")}for(;s.length>0;)try{r[r.length]=new RegExp(s,e.ci?"i":"");break}catch(e){s=s.slice(0,-1)}}return r.length>0?r:null},escape:function(){function e(e){return t[e]}var t={"<":"&lt;",">":"&gt;","&":"&amp;",'"':"&quot;","'":"&#039;"};return function(t){return t.replace(/[<>"'&]/g,e)}}(),escape_text:function(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;")},arraybuffer2blob:function(){var e={jpg:"image/jpeg",jpeg:"image/jpeg",gif:"image/gif",png:"image/png",pdf:"application/pdf",svg:"image/svg+xml",svgz:"image/svg+xml",htm:"text/html",html:"text/html",txt:"text/plain",webm:"video/webm",mpg:"video/mpeg",mpeg:"video/mpeg",mp4:"video/mp4",ogv:"video/ogg",mp3:"audio/mp3",gz:"application/x-gzip",tar:"application/x-tar",tgz:"application/x-tar",zip:"application/x-compress","7z":"application/x-7z-compressed",xz:"application/x-xz"};return function(t,n){var r=t.substr(t.lastIndexOf(".")+1),a=e[r]||"text/plain";return new Blob([n],{type:a})}}()};var common_obj={thread_reader:null,events_beforeunload:[]};common_func.dom_addEventListener(common_obj.events_beforeunload,window,"beforeunload",function(){common_func.dom_removeEventListener(common_obj.events_beforeunload)}),common_func.dom_addEventListener(common_obj.events_beforeunload,window,"focus",function(){DelayBuffer.prototype.hasFocus=!0}),common_func.dom_addEventListener(common_obj.events_beforeunload,window,"blur",function(){DelayBuffer.prototype.hasFocus=!1});var site={max_page:20,autosage:300,page:0,url_prefix:"https://krautchan.net/int/",url_prefix2:{},nickname:"KC",nicknames:["CatChan_tgt"],thread_keyword:"thread",postform:null,postform_rules:null,get_ops:null,get_posts:null,server_name:null,protocol:document.location.href.search(/https/)!=-1?"https:":"http:",catalog_threads_in_page:null,remove_posts:function(e){return e},remove_files_info:function(e){return e},remove_checkboxes:function(e){return e},get_time_of_last_post:function(e){return null},patch:null,get key(){return site.nickname+site.board+("thread"===site.whereami?site.no:"")},header_height:function(){return this.components.header_height},components:Object.create(null,{query:{value:function(e){var t=site2[site.nickname].components[e];return"string"==typeof t?document.querySelector(t):document.querySelectorAll(t[0])[t[1]]},configurable:!0,writable:!0},query_set:{value:function(e){var t=this.query(e);t?this[e]=t:delete this[e]},configurable:!0,writable:!0},header_height:{get:function(){var e=this.query("header");return e?e.offsetHeight:0},configurable:!0}}),config:function(e,t,n){var r=window.location.href,a=r.substr(0,r.indexOf(e)+e.length),s=decodeURI(r.substr(a.length+1))+"/";if(site.board="/"+s.substr(0,s.indexOf("/")+1),site.url_prefix=a+site.board,site.server_name=r.substr(0,r.indexOf(e)-1).replace(/https*:\/\/*/,""),site.nickname=t,void 0===site.no&&(site.no="thread"===site.whereami?site2[site.nickname].get_ops(document)[0]:""),!n){!site0.isStep&&site2[t].features&&pref_func.pref_overwrite(site.features,site2[t].features);for(var i in site2[site.nickname].components)"header"!==i&&site.components.query_set(i);!site.settings&&site.components.boardlist&&(site.settings=site.components.boardlist.appendChild(document.createElement("span")),site.components.boardlist2&&(site.settings3=site.components.boardlist2.appendChild(document.createElement("span")))),site.patch=site2[site.nickname].patch}},features:{page:!1,graph:!0,setting:!0,setting2:!0,postform:!0,catalog:!0,listener:!1,uip_tracker:!1,thread_reader:!0,debug:!1},owners_recommendation:"",catalog:!1,whereami:null,embed_to:{},root_body:document.getElementsByTagName("body")[0],embed_frame:"CatChan_embed_frame",embed_frame_win:null,boardlist:null,settings:null,__proto__:{get myself(){return Object.defineProperty(this,"myself",{value:site2[site.nickname].wrap_to_parse.get(document,site.nickname,site.board,"thread_html",{thread:site.no})[0],writable:!0,enumerable:!0,configurable:!0}),this.myself}}};site.protocol=document.location.href.search(/https/)!=-1?"https:":"http:",site.root_body2=site.root_body;var site2={};site2.DEFAULT={nickname:"DEFAULT",home:"",check_func:function(){return window.location.href.indexOf(this.domain_url)!=-1&&(site.whereami="other",site.config(this.domain_url,this.nickname),!0)},boards_sel_from_tags:function(){return""},protocol:site.protocol,components:{},spoiler_text:{spoiler:/span.spoiler$/,open:/span.spoiler:hover/},make_tack:function(){var e=document.createElement("i");return e.setAttribute("class","fa fa-thumb-tack"),e},make_showAlways:function(){var e=document.createElement("i");return e.setAttribute("class","fa"),e.textContent="★",e},set_icon:function(e,t,n,r,a){if(e){var s=r["icon_"+n]||"sticky"==n&&this.get_icon(e,t,n,r);if(a&&s)return r.systemSticky&&(s.style.opacity=null),s;if(a){if(!s)return this.add_icon(e,t,n,r)}else"sticky"==n&&r.systemSticky?(s||(r.icon_sticky=s=this.add_icon(e,t,n,r)),s.style.opacity="0.4"):s.parentNode&&s.parentNode.removeChild(s)}return null},postform:function(){function e(e){this.tack&&(this.tack.style.display="none"===this.tack.style.display?"":"none")}return{tack:null,init:function(){return site.postform&&(this.tack=site2[site.nickname].make_tack(),this.tack.setAttribute("style","float:right;font-size:2em"),site.postform.parentNode.insertBefore(this.tack,site.postform)),this.tack},on:e,off:e}}(),postform_prep:function(){site.components.postform_submit2=null,site.components.postform_submit2_observer=new MutationObserver(this.postform_submit2_find),site.components.postform_submit2_observer.observe(document.getElementsByTagName("body")[0],{childList:!0})},postform_submit2_find:function(){site.components.postform_submit2;site.components.query_set("postform_submit2"),site.components.query_set("postform_comment2"),common_obj.thread_reader&&common_obj.thread_reader.setup_submit2(),pref.features.recovery&&recovery.setup2()},general_event_handler:function(){var e={common:{subscribe:function(e){this.mouseover&&e.addEventListener("mouseover",this.mouseover,!1)},unsubscribe:function(e){this.mouseover&&e.removeEventListener("mouseover",this.mouseover,!1)},get_mark:function(e,t){return this.get_mark_from_height(t,document.getElementByTagName("div"))},get_mark_from_height:function(e,t){for(var n=t.length,r=n>>1,a=0;r>0;)t[a+r].offsetTop<e&&(a+=r),r>>=1;for(;a+1<n&&t[a+1].offsetTop<e;)a++;return t[a]},isThumbnail:function(e){var t=e.target;return"IMG"===t.tagName&&t.parentNode&&"A"===t.parentNode.tagName},recSearch_thread:function(e,t,n){for(n||(n="thread");e&&e!=t;){if(e.classList&&e.classList.contains(n))return e;e=e.parentNode}return null},getID:function(e){},getCountry:function(e){},getTrip:function(e){},getName:function(e){return e.classList.contains("name")&&e.textContent||void 0},an2srcNo:function(e,t){for(;e;){if(e.classList&&e.classList.contains("post"))return site2[t.domain_html].parse_funcs.post_html.no({pn:e});if(gGEH.pns_all_keys.get(e))return site2[t.domain_html].parse_funcs.catalog_html.no({pn:e});e=e.parentNode}},menu2keyTime:function(e){var t=this.recSearch_thread(e,null,"post"),n=gGEH.get_key_recursive(t,document),r=site2[site.nickname].parse_funcs.post_html;return[n,r.no({pn:t}),r.time({pn:t})*r.time_unit]}}};return e.thread=Object.create(e.common),e.page=Object.create(e.common),e.catalog=Object.create(e.common),e}(),horizontal_separator_in_index:function(){var e=document.createElement("hr");return e.setAttribute("class",pref.script_prefix+"_hs"),e},get_next_image:function(e,t,n){n||(n=cataLog.parent.getElementsByTagName("img"));var r=Array.prototype.indexOf.call(n,e);if(t)for(;n[r+1]&&n[r+1].offsetTop<t;)r++;return r>=0?n[r+1]:null},catalog_threads_in_page:function(e){return[]},remove_posts:function(e,t){},remove_files_info:function(e){return e},postform_rules:null,thread_keyword:"thread",max_page:function(e){return 10},generate_boards_json:function(e,t){for(var n={pages:t},r=[],a=0;a<e.length;a++)r[r.length]=Array.isArray(e[a])?{board:e[a][0],pages:e[a][1],__proto__:n}:{board:e[a],__proto__:n};return{boards:r}},url_boards_json:function(){return""},get_boards_json:function(e,t,n,r){var e="boards_json_"+this.nickname;this.boards_json?this.get_boards_json_callback(this.nickname,{status:200,response:this.boards_json},[t,n]):httpd.req({initiator:e,tgts:[{domain:this.nickname,url:this.url_boards_json()[0],responseType:"json",data_type:"json"}],callback_1:function(r,a){this.get_boards_json_callback(e,a,[t,n,!0])}.bind(this)},6)},get_boards_json_callback:function(e,t,n){200==t.status&&(this.postprocess_board(t.response),site3[this.nickname].boards||(liveTag.update_pn_buf.cancel(),liveTag.update_pn_buf.do_tgt()),site3[this.nickname].boards="8chan"!==site.nickname||"boards"!==site.whereami||t.response),n[0]&&(n[1]||200===t.status)&&(n[2]?n[0]():setTimeout(n[0],0))},postprocess_board:function(e){for(var t=0;t<e.boards.length;t++){var n=liveTag.mems.init({domain:this.nickname,board:"/"+e.boards[t].board+"/"});n.o=t,e.boards[t].pages&&!n.pgs&&(n.pgs=e.boards[t].pages),e.boards[t].tags&&0!=e.boards[t].tags.length&&liveTag.postprocess_board_add_btag(e.boards[t].tags,n)}},boardlist_boards:Object.create(null,{sel:{value:null,writable:!0}}),show_boardlist_physical_board:function(e,t){var n=this.boardlist_boards;if(n.sel===!0&&"replace"===pref.virtualBoard.p_board||n.sel===!1&&"both"===pref.virtualBoard.p_board){var r=n.sel?"v":"p",a=n.sel?"p":"v";for(var s in n){var i=n[s];i[r]&&i[a]&&(i[a].parentNode.insertBefore(i[r],i[a]),i[a].parentNode.removeChild(i[a]))}n.sel=!n.sel}if(null===this.boardlist_boards.sel&&"replace"===pref.virtualBoard.p_board){for(var o=site.components.boardlist.getElementsByTagName("a"),s=0;s<o.length;s++){var l=o[s].textContent;this.show_boardlist_physical_extract_func&&(l=this.show_boardlist_physical_extract_func(l)),"#"!==l[0]&&(this.boardlist_boards["#"+(pref.liveTag.ci?l.toLowerCase():l)]={p:o[s]})}this.boardlist_boards.sel=!1}if("replace"===pref.virtualBoard.p_board){for(var p={},s=e.length-1;s>=0;s--){var l=pref.liveTag.ci?e[s].toLowerCase():e[s],i=this.boardlist_boards[l];if(i){if(!i.v){var c=i.p,_=liveTag.create_tag_node_1(l,t,"a");_.setAttribute("href",c.getAttribute("href")),c.parentNode.insertBefore(_,c),c.parentNode.removeChild(c),i.v=_}e.splice(s,1),p[l]=null}}if(pref.virtualBoard.v_remove)for(var s in this.boardlist_boards)if(this.boardlist_boards[s].v&&void 0===p[s]){var c=this.boardlist_boards[s].p,_=this.boardlist_boards[s].v;_.parentNode.insertBefore(c,_),_.parentNode.removeChild(_),delete this.boardlist_boards[s].v}}return e},boardlist_tags:null,boardlist_tags_pn:null,show_boardlist:function(e,t){var n=site.components.boardlist,r=this.show_boardlist_physical_board(e.slice(),t);if(pref.virtualBoard.show&&0!==r.length){var a=pref.test_mode[118]?liveTag.create_tag_nodes(r," / ",t):liveTag.update_tag_nodes(r," / ",t,this.boardlist_tags_pn,this.boardlist_tags);if(this.boardlist_tags_pn)pref.test_mode[118]&&this.boardlist_tags_pn.parentNode.replaceChild(a,this.boardlist_tags_pn);else{var s=document.createElement("span");s.appendChild(document.createTextNode("[ ")),s.appendChild(a),s.appendChild(document.createTextNode(" ]")),n.appendChild(s)}this.boardlist_tags_pn=a,this.boardlist_tags=r}else this.boardlist_tags_pn&&(n.removeChild(this.boardlist_tags_pn.parentNode),this.boardlist_tags_pn=null,this.boardlist_tags=null)},query_tag_node:function(e){var t=this.boardlist_boards[e];if(t)return t.v;if(this.boardlist_tags_pn){var n=this.boardlist_tags.indexOf(e);if(n>=0)return this.boardlist_tags_pn.childNodes[2*n]}},get_ops:function(e){return[]},get_posts:function(e){return[]},absolute_link:function(e){this.absolute_link_exe(e,this.protocol+"//"+this.domain_url)},absolute_link_exe:function(e,t){for(var n=["src","href"],r=e.getElementsByTagName("*"),a=0;a<r.length;a++)for(var s=0;s<n.length;s++){var i=r[a].getAttribute(n[s]);i&&0!=i.indexOf("http")&&0!=i.indexOf("mailto:")&&0!=i.indexOf("blob")&&"//"!=i.substr(0,2)&&r[a].setAttribute(n[s],t+i)}},absolute_link_1:function(e){return site2[this.nickname].protocol+"//"+site2[this.nickname].domain_url+e},link_dbtp2href_abs:function(e,t){return(this.nickname!=site.nickname?this.protocol+"//"+this.domain_url:"")+this.link_dbtp2href(e,t)},ls_key_own_posts:pref.script_prefix+".own_posts.",prep_own_posts_event:function(e){e&&site2[site.nickname].prep_own_posts_1(e.key),window.name===site.nickname&&send_message("parent",["OWN_POSTS",window.name,site3[window.name].own_posts])},prep_own_posts:function(e){if(site3[this.nickname].own_posts={},localStorage)for(var t=e?[this.ls_key_own_posts+e]:Object.keys(localStorage),n=0;n<t.length;n++)this.prep_own_posts_1(t[n])},prep_own_posts_1:function(e){if(0==e.indexOf(this.ls_key_own_posts)){var t=e.substr(this.ls_key_own_posts.length),n=t.substr(0,t.lastIndexOf("/")+1);site3[this.nickname].own_posts[n]||(site3[this.nickname].own_posts[n]={});for(var r=JSON.parse(localStorage[e]||"[]"),a=0;a<r.length;a++)site3[this.nickname].own_posts[n][r[a]]=null}},clean_up_LS:function(e,t,n){if(e===site.nickname&&localStorage){var r=Object.keys(localStorage);pref.thread_reader.own_posts_tracker&&pref.thread_reader.clean_up_own_posts&&this.clean_up_LS_th(r,this.ls_key_own_posts,t,n),pref[cataLog.embed_mode].deleted_posts.auto_clean&&this.clean_up_LS_th(r,this.ls_key_deletedPosts,t,n),pref.recovery.auto_clean&&this.clean_up_LS_th(r,this.ls_key_comment,t,n),pref.test_mode[162]&&this.clean_up_LS_th(r,this.ls_key_hiddenPosts,t,n)}},ls_key_deletedPosts:pref.script_prefix+".deletedPosts.",clean_up_deleted_posts_1:function(e){localStorage&&delete localStorage[this.ls_key_deletedPosts+e]},ls_key_comment:pref.script_prefix+".draft.",ls_key_hiddenPosts:pref.script_prefix+".hiddenPosts.",clean_up_LS_th:function(e,t,n,r){for(var a=t+n,s=0;s<e.length;s++)0==e[s].indexOf(a)&&void 0===r[e[s].substr(a.length)]&&delete localStorage[e[s]]},check_reply:function(){function e(e,t){for(var n=e.pn.getElementsByTagName("a"),r=0;r<n.length;r++){var a=!1,o=n[r].textContent;if(s&&null===s[o.substr(2)]&&f.test(o)&&(a=!0),!a&&i&&m.test(o)){var l=o.split("/"),p="/"+l[1]+"/";i[p]&&null===i[p][l[2]]&&(a=!0)}a&&("plain"===pref.thread_reader.show_reply_to_me_by?n[r].parentNode.insertBefore(document.createTextNode(" (You)"),n[r].nextSibling):n[r].textContent=n[r].textContent+" (You)")}if(t&&s&&null===s[e.no]){var c=e.parse_funcs_html.pn_name(e);"plain"===pref.thread_reader.show_own_post_by?c.parentNode.insertBefore(document.createTextNode(" (You)"),c.nextSibling):c.innerHTML=c.innerHTML+" (You)"}}function t(e,t,r,a){var o=s&&e.no in s;if(o&&(e.reply_of_mine=!0),!o||!pref.catalog_footer_ignore_my_own_posts){var l=p?e.com:e.body;if(l){var c=!1;if(s){var f=l.match(_);if(null!==f)for(var h=0;h<f.length;h++){var m=f[h].substr(d);if(null===s[m]){c=!0;break}}}if(!c&&i&&null!==(f=l.match(u)))for(var h=0;h<f.length;h++){var m=f[h].split("/"),g="/"+m[1]+"/";if(i[g]&&null===i[g][m[2]]){c=!0;break}}c&&(e.reply_to_me=!0,t[1]+=65536)}t[1]++}a[a.length]=e,r&&n(e,r)}function n(e,t){if(p){var n=e.com;if(!n)return;n=n.replace(/<[^>]*>|&[^;]*;/g," "),pref.test_mode[47]&&(c.innerHTML=n,n=c[brwsr.innerText])}else{if(e.editing)return void(t[t.length]=e);if(!(n=e.body||e.txt))return}if(n.indexOf("#")!==-1){if(l)for(var r=0;r<l.length;r++)n=n.replace(l[r],"\n");var a=n.match(liveTag.scan_regex);if(null!==a)for(var r=0;r<a.length;r++)if(a[r].length<=pref.liveTag.maxstr){if(o){for(var s=o.length-1;s>=0&&!o[s].test(a[r]);s--);if(s>=0)continue}t[t.length]=a[r]}}}function r(e){"txt"===e.parse_funcs.type_com?(_=h,d=2,u=g,p=!1):(_=v,d=8,u=b,p=!0)}function a(e){pref.liveTag.ex_list?(o=pref_func.merge_obj5a(e,pref.liveTag.ex_list_obj5,null),l=pref_func.merge_obj5a(e,pref.liveTag.rm_list_obj5,null)):(o=null,l=null)}var s,i,o,l,p=!1,c=document.createElement("div"),_="",d=0,u="",f=/^>>[0-9]+/,h=/>>[0-9]+/g,m=/^>>>\/[0-9A-z_\+]+\/[0-9]+/,g=/>>>\/[0-9A-z_\+]+\/[0-9]+/g,v=/&gt;&gt;[0-9]+/g,b=/&gt;&gt;&gt;\/[0-9A-z_\+]+\/[0-9]+/g,y=!0;return{remake_own_posts:function(){y=!0},make_own_posts:function(){site2[site.nickname].prep_own_posts(),y=!1},add_you:e,set_own_posts:function(e){i=site3[e.domain].own_posts,s=i[e.board]||i.ALL,0==Object.keys(i).length&&(i=void 0)},check_t1_op:function(e){r(e),a(e);var t=[];return n(e,t),t},get_checked_time:function(e){return e[2]},set_watch_time:function(e,t,n){t>0&&(e[0]|=pref.test_mode[167]?67108864:262144,8388608&e[0]?e[2]=t:(this.time_watch[n]=t,e[0]&=4286578687))},set_watched_to_last:function(e,t,n,r){!(8388608&e[0])&&524288&e[0]||this.set_watch_time(e,t,n),e[1]=r||0},set_unwatch:function(e){e[0]&=4218683391,e[1]=0},time_watch:{},check:function(e,s,i,o,l,p){var c=131072&i[0],_=i[2],d=!1,u=i[2];262144&i[0]&&(8388608&i[0]?(_=0,i[2]=0):(u=this.time_watch[e.key],delete this.time_watch[e.key]),i[1]=0,i[0]=(4286251008&i[0]|524288)+(e.omitted_posts?e.omitted_posts+1:0),d=!0);var f=_,h=liveTag.generate_ur(i[1]),m=67895296&i[0];if(p)m&&(i[1]+=p-(0==(65535&i[0])&&i[2]<65536?i[2]:0));else{var g=e.posts.length-1;i[2]=e.posts[g].time*e.parse_funcs.time_unit||i[2],1!=e.parse_funcs.time_unit&&(_=Math.floor(_/e.parse_funcs.time_unit),u=d?Math.floor(u/e.parse_funcs.time_unit):_);var v="post"===pref.liveTag.from?[]:null;if(v&&a(e),(m||v)&&r(e),m)for(y&&this.make_own_posts(),r(e),this.set_own_posts(e);g>=0&&e.posts[g].time>u;)t(e.posts[g--],i,v,l);if(v)for(;g>0&&(c||e.posts[g].time>_);)n(e.posts[g--],v);if(u!==_||!m){for(g=e.posts.length;g>0&&e.posts[g-1].time>_;)g--;var b=0===g?e.posts:e.posts.slice(g)}pref3.stats.use&&stats.aggregate(e,b||l)}if(v&&0!=v.length)var w=liveTag.extract_tags(e,v,null,!c);if(m&&(liveTag.dirtify_ur(e),pref.liveTag.style.use)){var k=liveTag.generate_ur(i[1]);h!=k&&liveTag.update_ur(s,k,0!=h&&d)}return i[0]=(4294508544&i[0])+e.nof_posts,o&&67895296&i[0]&&(pref.notify.desktop.notify&&(0!=l.length?site2[e.domain].wrap_to_parse.posts({posts:l,__proto__:e}):p&&(l[l.length]={com:1==p?"a new reply.":p+" of new replies.",time:i[2]})),notifier.changed(e,l)),{tags:w,posts:b||l,time_check_old:f}}}}(),get_post_offsetTop:function(e,t){},favicon:{get_favicon:function(){for(var e=document.getElementsByTagName("head")[0].getElementsByTagName("link"),t=0;t<e.length;t++)if("shortcut icon"==e[t].getAttribute("rel"))return e[t];var n=document.createElement("link");return n.setAttribute("rel","shortcut icon"),n.setAttribute("href",this.none),n.setAttribute("type","image/x-icon"),document.getElementsByTagName("head")[0].appendChild(n)},get_title:function(){var e=document.getElementsByTagName("head")[0].getElementsByTagName("title")[0];return e||(e=document.createElement("title"),e=document.getElementsByTagName("head")[0].appendChild(e)),e}},get_icon:function(){},add_icon:function(){},time_revised_check:function(e){return!1},format_thread_layout:function(e){},format_thread_style:function(e){},format_thread_contents:function(e){},format_thread_always:function(e){},format_remove_tn_area_size:function(e){},mark_newer_posts2:function(e,t,n,r){t/=this.parse_funcs.post_json.time_unit;for(var a=null,s=e.length-1;s>=0;s--){var i=e[s].pn;if(t<e[s].time)i.setAttribute("style",pref.style.post_new),n&&i.addEventListener("mouseleave",this.unmark_post_from_event,!1),a=s;else{if(r)break;null!=i.getAttribute("style")&&i.removeAttribute("style")}}return a},format_pn:function(e,t,n,r,a){n||(n=pref[cataLog.embed_mode]),n.colorID&&this.colorID(e),n.backlink&&this.backlink(e,t,a),n.localtime&&this.localtime(e),r&&(site2.DEFAULT.check_reply.add_you(r,!0),r.deleted_after&&e.classList.add("CatChan_deleted"),void 0!==r.search_result&&site2[r.domain_html].update_posts0_class(e,r.search_result))},colorID:function(){},localtime:function(){},unmark_post_from_event:function(e){e.currentTarget.removeEventListener("mouseleave",site2.common.unmark_post_from_event,!1),site2.DEFAULT.unmark_post(e.target)},unmark_post:function(e){e.removeAttribute("style")},modify_thread_link:function(e){return[]},preprocess_html:function(e){return e},check_thread_archived:function(e){return!1},get_owners_recommendation:function(){return""},get_board_tags:function(){return{}},get_json_url_catalog:function(e){return""},parse_json_thread:function(e,t){},uip_tgt_post:function(e){return null},uip_post_num:function(e){return null},uip_check:function(e){},catalog_native_prep_sel:function(e,t,n){if(n){if(0!=n.selectedIndex){n.selectedIndex=0;var r=document.createEvent("UIEvents");r.initUIEvent("change",!1,!0,window,1),n.dispatchEvent(r)}n.style.display="none"}var a=e.getElementsByTagName("select")["catalog.order.ordering"];a.parentNode.removeChild(a.nextSibling),n?n.parentNode.insertBefore(a,n):t.childNodes[3].insertBefore(a,t.childNodes[3].firstChild)},catalog_native_prep_swap_sortSel:function(e){e.parentNode.insertBefore(cataLog.components.ordering,e.nextSibling),e.setAttribute("style","display:none")},catalog_frame_prep:function(e){},catalog_native_frame_prep:function(e){function t(){a?(site.root_body.removeChild(n),n=null,site.embed_frame_win=null,site2.common.disgorge_children(r)):(r=site2.common.absorb_children(site.root_body),r.style.width=pref.catalog_size_frame0_width+"%",r.style.float="left",r.style.height=window.innerHeight+"px",r.style.overflow="scroll",n=site2[site.nickname].catalog_native_frame_prep_frame(site.root_body,null)),a=!a}var n,r,a=!1;return e.addEventListener("click",t,!1),t},catalog_native_frame_prep_frame:function(e,t){return ifrm=document.createElement("iframe"),ifrm.setAttribute("name",site.embed_frame),ifrm.style.height=window.innerHeight+"px",ifrm.style.margin="0px",ifrm.style.width=pref.catalog_size_frame1_width+"%",e.insertBefore(ifrm,t),site.embed_frame_win=ifrm.contentWindow,ifrm},catalog_embed_prep:function(e){e.style.position=null,e.childNodes[1].style.width=null,e.childNodes[1].style.height=window.innerHeight+"px",e.childNodes[0].childNodes[0].style.display="none",e.childNodes[0].childNodes[1].style.display="none",e.style.border=null,e.style.left=null,e.style.resize=null,e.style.top=null},thread2search_obj:function(e){return[e[brwsr.innerText],"","","","","","",""]},popups_posts:function(){function e(){function e(e,n,r,a){"imm"===e.popdown?r(n):(a||(a=n.target),e.popup_mMove&&a.addEventListener("mousemove",t,!1),s=r,i=e,o=a,t(n,!0))}function t(e,t){(r||t)&&(r&&clearTimeout(r),r=setTimeout(n,i.popup_delay),a=e)}function n(e){e&&clearTimeout(r),r=null,i.popup_mMove&&o.removeEventListener("mousemove",t,!1),e||s(a)}var r=null,a=null,s=null,i=null,o=null;return{over:e,stop:function(){return!!r&&(n(!0),!0)},get up_timer(){return r},out:function(e){return e.relatedTarget===m?(m=null,e.relatedTarget):this.stop()}}}function t(e,t,r){var a=h.get(e);if(a)if(Array.isArray(a))for(var s=0;s<a.length;s++)a[s]&&a[s]!==t&&n(a[s],r);else a!==t&&n(a,r)}function n(e,t){var n=h.get(e),r=n.pf&&n.pf()||pref.proto;t||"imm"===r.popdown?a(e):n.timer=setTimeout(a.bind(null,e),r.popdown_delay)}function r(e,t,n,r){h.set(e,r||t),h.set(t,n||{src:e}),t.addEventListener("mouseenter",s,!1),t.addEventListener("mousedown",cnst.div_mousedown,!1)}function a(e,t){if(e&&e.parentNode){t||e.parentNode.removeChild(e);var n=h.get(e);n.key&&C.pop_load_req_delete(n.key,e),n.chart&&!t&&n.chart.destroy(),n.scroll&&e.removeEventListener(brwsr.mousewheel,cnst.div_scroll,!1);var r=n.src,a=h.get(r);if(Array.isArray(a)){a[a.indexOf(e)]=null;for(var o=0;o<a.length&&!a[o];o++);o==a.length&&h.delete(r)}else h.delete(r);if(h.delete(e),e.removeEventListener("mouseenter",s,!1),e.removeEventListener("mousedown",cnst.div_mousedown,!1),t)return e.removeEventListener("mouseleave",i,!1),n}}function s(e){var t=e.currentTarget,n=h.get(t);"imm"===(n.pf&&n.pf()||pref.proto).popdown?a(t):(n.timer&&o(n),m=e.relatedTarget,t.addEventListener("mouseleave",i,!1))}function i(e){var t=e.currentTarget;t.removeEventListener("mouseleave",i,!1),n(t)}function o(e){clearTimeout(e.timer),e.timer=null}function l(e,t,n,r,a){var s=n?"left"===g?.75:.25:.5,i=n?"top"===v?.8:.2:.5;b=document.documentElement.clientWidth,y=document.documentElement.clientHeight;var o=pref.proto.popup3.oX,l=pref.proto.popup3.oY;b*s-t.clientX>0^r?(e.style.left=t.clientX+o+"px",g="left"):(e.style.right=b-t.clientX+o+"px",g="right"),y*i-t.clientY>0^a?(e.style.top=t.clientY+l+"px",v="top"):(e.style.bottom=y-t.clientY+l+"px",v="bottom")}function p(e,t){var n=e.style,r=parseInt(n.top?n.top:n.bottom,10);if(!(e.offsetHeight+r<y)&&r>.5*y){var a=y-e.offsetHeight,s=(a<0?0:a)+"px";n.top?(n.top=s,v="bottom"):(n.bottom=s,v="top")}var i=parseInt(n.left?n.left:n.right,10);if(!(e.offsetWidth+i<b)&&i>.5*b){var s=b-parseInt(n.left?n.left:n.right,10)+20+"px";n.left?(n.right=s,n.left=null):(n.left=s,n.right=null)}}function c(e){return _(e.getAttribute("href"))||_(e.href)}function _(e){if("/"===e[0]||"#"===e[0])return site.nickname;for(var t in liveTag.mems)if(e.indexOf(site2[t].domain_url)!=-1)return site2[t].nickname;for(var t in site2)if(e.indexOf(site2[t].domain_url)!=-1)return site2[t].nickname}function d(e,t){u(e);var n=e.target,r=pref[cataLog.embed_mode];r.popup&&"A"===n.tagName&&site2.DEFAULT.popups_link_regex.test(n.textContent)?C.over(e,t):(r.image_hover||r.infoPv.use)&&f.isThumbnail(e)?(r.image_hover&&k.over(r.thumbnail.hover,e,cataLog.DIH.image_hover_add),r.infoPv.use&&x.over(r.infoPv,e,cataLog.InfoPv.show)):r.popupX.use&&k.over(r.popupX,e,I.X)}function u(e){if(cataLog.DIH.image_hover_remove(e),!k.out(e)){var n=e.relatedTarget;n&&("A"===n.tagName||I.et)&&t(n),I.et=null,cataLog.InfoPv.hide(),x.out(e)}}var f,h=new Map,m=null,g="left",v="top",b=0,y=0,w=new WeakSet,k=e(),x=e(),C=function(){function e(e,n){if(!pref.proto.popup_hlt||!v(e)){k.force=n,k.over(pref.proto,e,t);c(e.target)!==site.nickname&&e.stopPropagation()}}function t(e){var t=k.force,r=e.target;if(h.has(r))return void o(h.get(h.get(r)));var a=c(r);if(!t&&pref[cataLog.embed_mode].env.popup_native)if(pref[cataLog.embed_mode].env.event_dynamic&&!pref.test_mode[100]){if(site.nickname===a)return}else if(w.has(r))return;n(e,a)}function n(e,t){var n=T(e,t);return n&&(N(e,n.pn),r(e.target,n.pn,n.key?{src:e.target,key:n.key}:null)),n.pn}function s(e,t){var n=c(e.target);if(e.shiftKey||"jump"===pref[t.mode].inline_post){var r=t.jump_to_post(site2[n].popups_href2th_q(e.target.getAttribute("href"))[2]);r&&(r.classList.add(site2[site.nickname].popups_posts_class_hlt),r.addEventListener("mouseleave",_,!1))}else i(e,n)}function i(e,t){var n=e.target,r=I.get(n)
;if(r)r.parentNode.removeChild(r),I.delete(n);else{var a=T(e,t);a&&(n.parentNode.insertBefore(a.pn,n.nextElementSibling),I.set(n,a.pn))}}function _(e){e.currentTarget.removeEventListener("mouseleave",_,!1),e.currentTarget.classList.remove(site2[site.nickname].popups_posts_class_hlt)}function d(e,t){var r=E.get(e);if(r){for(var s=r.length-1;s>=0;s--){var o=r[s],l=h.get(o.target);if(l){a(l);n(o,t)}I.get(o.target)&&(i(o,t),i(o,t))}E.delete(e)}}function m(e,t,n){var r={target:e.target,clientX:e.clientX,clientY:e.clientY,pn:n},a=E.get(t);a?a.unshift(r):E.set(t,[r])}function g(e,t){var n=E.get(e);if(n){for(var r=n.length-1;r>=0;r--)n[r].pn===t&&n.splice(r,1);0===n.length&&E.delete(e)}}function v(e){var t=e.target.getAttribute("href"),n=c(e.target),r=site2[n].popups_href2th_q(t),a=r[1],s=cataLog.threads[r[0].key],i=s&&s[16]&&s[16].posts;if(i){for(var o=i.length-1;o>=0&&i[o].no!==a;o--);var l=o>=0?i[o].pn:void 0;if(l&&"none"!==window.getComputedStyle(l).display){var p=l.offsetTop,_=brwsr.document_body.scrollTop;if(p>_&&p+l.offsetHeight<_+document.documentElement.clientHeight)return l.classList.add(site2[site.nickname].popups_posts_class_hlt),e.target.addEventListener("mouseout",b,!1),h.set(e.target,l),y(l,e,{domain_html:pref.catalog.mimic_base_site?site.nickname:n}),!0}}return!1}function b(e){var t=e.target;t.removeEventListener("mouseout",b,!1),h.get(t).classList.remove(site2[site.nickname].popups_posts_class_hlt),h.delete(t),A&&(A.classList.remove("dotted"),A=null)}function y(e,t,n){if(!pref.test_mode[108]){var r=site2[n.domain_html].post_pn2ce(e),a=r?r.getElementsByTagName("a"):void 0;if(a&&a.length>1){var s=f.an2srcNo(t.target,n);if(s)for(var i=0;i<a.length;i++){var o=a[i].getAttribute("href");if(o&&site2[n.domain_html].popups_href2dbtp(o)[3]==s){a[i].classList.add("dotted"),A=a[i];break}}}}}function x(e,t,n,r){cataLog.format_html.prepare_html_prep_posts({posts:[r],__proto__:e}),cataLog.format_html.prepare_html_post(e,r,t.q)}function C(e,t,n){if(e.ta)for(var r=e.ta.posts.length-1;r>=0;r--)if(e.ta.posts[r].no==t){var a=e.ta.posts[r],n={domain_html:n.domain_html,lth:e,type_data:a.type_data||(a.pn?"html":"json"),posts:[a],__proto__:e};return void x(n,e,t,a)}}function T(e,t){var n=site2[t].popups_href2th_q(e.target.getAttribute("href"));if(n){var r,a=n[2],s=n[0][n[1]],i=a[3]==a[2],o=n[3],l={domain:t,domain_html:pref.catalog.mimic_base_site?site.nickname:t,posts:[s],lth:o,__proto__:o};if(void 0===s&&pref.test_mode[80]){l.no=n[2][2];for(var p=["_IDB/","_File/"],c=0;c<2;c++){l.board=n[2][1].slice(0,-1)+p[c];var _=liveTag.mems[l.domain][l.board]&&liveTag.mems[l.domain][l.board][l.no]&&liveTag.mems[l.domain][l.board][l.no].q;if(_){n[0]=_;break}}}if(void 0===s||Array.isArray(s)?(C(o,parseInt(a[3],10),l),s=n[0][n[1]]):s&&!s.pn&&x(l,o,a[2],s),void 0===s||Array.isArray(s)){site2[l.domain].popups_post_fetch(l,a),r=site2[l.domain_html].post_json2html({time:Date.now(),com:"Loading...",domain:t,board:a[1],no:a[2]},a[1]);var d=a[0]+a[1]+a[2]+"#"+a[3];m(e,d,r),site2.DEFAULT.popups_set_waiting(n[0],n[1])}else{if(!s.pn||i&&("4chan"!==site.nickname||"thread"!==site.whereami)){if(!s.domain){var u=s;if(u.domain=l.domain,u.extra_files)for(var c=0;c<u.extra_files.length;c++)u.extra_files[c].domain=l.domain}r=site2[l.domain_html].post_json2html(s,a[1])}else r=s.pn.cloneNode(!0);cataLog.format_html.prep_anchor_links(r,n[0]),site2[l.domain_html].format_pn(r,s,null,null,n[0]),y(r,e,l)}return gGEH.pns_all_keys.set(r,a[0]+a[1]+a[2]),pref.debug_mode[10]&&console.log("popup: "+n[1]+": "+site2[l.domain].popups_debug(n[0])),d?{pn:r,key:d}:{pn:r}}}function N(e,t){t.style={},t.style.position="fixed",l(t,e,!0),t.style.zIndex=pref[cataLog.embed_mode].popup_zIndex,"KC"!==site.nickname&&(t.style.borderStyle="solid"),t.style.boxShadow="rgb(153, 153, 153) 1px 1px 1px","4chan"===site.nickname&&(t.classList.add("preview"),t.style.display="block"),site2[site.nickname].popups_post_pnode(e.target).appendChild(t),p(t,e)}var I=new WeakMap,E=new Map,A=null;return gGEH.triage_in2=u,{over:e,pop_load:d,pop_load_req_delete:g,inline_post:s}}(),T=!1,N=function(){function n(e,t,n){var r=pref[n.mode].popup3;if("no"!==r.ww||"no"!==r.wn||"no"!==r.nw||"no"!==r.nn)if(t&&!T){if(u===t||d.up_timer&&d.src===t)return;s(e),d.src=t,m=n,d.over(r,e,i,t)}else s(e)}function s(e,n){var r=d.out(e);if(r!==!0){var a=f.recSearch_thread(e.relatedTarget,e.currentTarget)||u;a&&t(a,r,n),u=null,m=null}}function i(e){if(m){var t=gGEH.get_key_recursive(d.src,document),n=h.get(d.src)||[],r=pref[m.mode].popup3;pref.test_mode[110]||p(r.ww,e,t,n,0,!1,!1),p(r.wn,e,t,n,1,!1,!0),p(r.nw,e,t,n,2,!0,!1),p(r.nn,e,t,n,3,!0,!0),u=d.src,d.src=null}}function p(e,t,n,s,i,p,u,f,g){if("no"!==e){if(s[i])return void o(h.get(s[i]));var v=document.createElement("div");if(v.setAttribute("class",pref.script_prefix+"_window"),v.style.position="fixed",v.style.border="1px solid blue",v.style.zIndex=pref.proto.popup3.popup_zIndex,"chart"===e||m.pop_up_set_contents(v,e,n,f)){if(v.addEventListener(brwsr.mousewheel,cnst.div_scroll,!1),l(v,t,!1,p,u),s[i]=site.popup_body.appendChild(v),"chart"===e)if(chart_obj&&pref3.stats.use)var b=m.merge_bases.bases[n],y=new chart_obj.PostChart(v,b&&b.pn===d.src&&b.keys||[n]);else v.innerHTML="Statistics needs to be activated.";v.dataset.isPopup="true",cnst.tack_for_popup(v,function(e){var t,r=e.currentTarget,s=r.parentNode,i=a(s,!0).chart;if(i){var o=document.createElement("div"),l=site2[common_func.name2dbt(n)[0]].parse_funcs.catalog_html.tn_imgs({pn:cataLog.threads[n][0]});l[0]?o.appendChild(l[0].cloneNode()):o.innerHTML=n,common_func.overwrite_prop(o.style,{position:"absolute",bottom:"0px",left:"0px",opacity:.4}),s.replaceChild(o,r),t=chart_obj.PostChart.call(i,null,null,i),t.childNodes[1].replaceChild(s,t.childNodes[1].childNodes[1])}else s.removeChild(r),t=cnst.tack_for_popup_swap(s);cnst.tack_for_popup_swap_pos(t,s)}),f?r(g,v,{src:g,scroll:!0,pf:c}):r(d.src,v,y?{src:d.src,chart:y,scroll:!0,pf:_}:{src:d.src,scroll:!0,pf:_},s)}}}function c(){return pref.proto.popupX}function _(){return pref.proto.popup3}var d=e(),u=null,m=null;return{th_over:n,th_over:n,th_out:s,pop_up_th_1:p,set on_clg(e){m=e}}}(),I=function(){function e(e,n){var r=gGEH.get_key_recursive(e.target,e.currentTarget);r&&(n.rexps=common_func.kwd_prep_regexp(n,!0),N.pop_up_th_1("sr",e,r,[],4,!1,!1,n,e.target),t=e.target)}var t=null;return{X:function(t){var n=pref[cataLog.embed_mode].popupX;if(n.ID){var r=f.getID(t.target);if(r)return e(t,{str:r,id:!0})}if(n.flag){var a=f.getCountry(t.target);if(a)return e(t,{str:a,flag:!0})}if(n.name){var s=f.getName(t.target);if(!pref.anon&&"Anonymous"===s)return;if(s)return e(t,{str:s,name:!0,sentence:!0})}if(n.trip){var i=f.getTrip(t.target,t);if(i)return e(t,{str:i,trip:!0})}if(n.ID2){var o=f.getID2(t.target,t);if(o)return e(t,{str:o,id2:!0,sentence:!0})}},get et(){return t},set et(e){t=e}}}(),E=function(){function e(e){var t=this["."],n=f.recSearch_thread(e.target,e.currentTarget,"headline"===t.view?pref.script_prefix+"_headline":void 0);if(/*!pref.test_mode['127'] &&*/"catalog"===t.mode||"float"===t.mode?n?N.th_over(e,n,t):N.th_out(e):N.on_clg=t,n){var r=gGEH.pns_all_keys.get(n)||gGEH.pns_all_keys.get(n.parentNode);if(r)return cataLog.triage.thread_in(e,r,n,t)}cataLog.triage.thread_out2(e)}function t(e){var t=this["."];/*!pref.test_mode['127'] &&*/"catalog"===t.mode||"float"===t.mode?N.th_out(e):N.on_clg=null,cataLog.triage.thread_out2(e)}return{init:function(n,r){n.addEventListener("mouseover",e.bind(r),!1),n.addEventListener("mouseleave",t.bind(r),!1)},destroy:function(t){site.root_body.removeEventListener("mouseover",e,!1)},th_over:e}}();return{over:d,leave:function(){k.stop,x.stop()},pop_load:C.pop_load,blacklist:w,set_pos:l,href2domain:_,init:function(e){f=site2[site.nickname].general_event_handler[site.whereami],gGEH.triage_in=N.th_out},init2:function(e,t){E.init(e,t)},inline_post:C.inline_post,menu_click:E.th_over,pop_up_unlock:function(){T=!1},pop_down_temporarily:function(e,t){N.th_out(e,!0),t&&(T=!0)}}}(),popups_posts_class_hlt:"highlighted",popups_post_fetch:function(e,t){cataLog.scan_init("popup",[e.domain+t[1]+(pref.catalog.catalog_json?"t":"")+t[2]],{priority:8})},popups_post_pnode:function(e){if(pref.test_mode[107])return site.popup_body;if(!pref.test_mode[106])for(var t=e.parentNode;t;){if(t===cataLog.parent)return site.popup_body;t=t.parentNode}for(var n;(!(n=e.getAttribute("class"))||n.indexOf("post")==-1&&n.indexOf("thread")==-1)&&e.parentNode;)e=e.parentNode;return e},popups_href2th_q:function(e){var t=this.popups_href2dbtp(e);if(!t[0]||!t[1]||!t[2])return null;var n=liveTag.mems.init({domain:t[0],board:t[1],no:parseInt(t[2],10)});return void 0===n.q&&(n.q=n.no>1e6?Object.create(n):Object.create({0:void 0,1:void 0,2:void 0,__proto__:n})),[n.q,parseInt(t[3],10),t,n]},popups_prep:function(e,t){t||(t=liveTag.mems[e.domain][e.board][e.no]),void 0===t.q&&(t.q=e.no>1e6?Object.create(t):Object.create({0:void 0,1:void 0,2:void 0,__proto__:t}))},popups_release_all_not_exist:function(e,t){if(e.q){var n={};if(t)for(var r=0;r<t.length;r++)n[t[r].no]=null;for(var a=Object.keys(e.q),r=0;r<a.length;r++)void 0===n[a[r]]&&"waiting"!==a[r]&&this.popups_release(e,a[r])}},popups_add_1_cross:function(e,t,n){for(var r=0;r<t.length;r++){var a=e.parse_funcs.hrefs(t[r]);if(a)for(var s=0;s<a.length;s++)if("#"!==a[s][0]&&(n||0===a[s].indexOf(e.board))){var i=site2[e.domain].popups_href2th_q(a[s]);if(i){var o=i[2][0]!==e.domain?e.key:i[2][1]!==e.board?e.board+e.no:i[2][2]!=e.no?e.no:null;null!==o&&site2[e.domain_html].popups_add_backlink(i[0],i[1],o+"#"+t[r].no,e,!1,!1)}}}},popups_link_regex:/^>>(>\/[^\/]+\/)*[0-9]+/,popups_add_1:function(e,t,n,r,a,s){var i=Array.prototype.slice.call(site2[e.domain_html].post_pn2ce(t.pn).getElementsByTagName("a"));if(n&&pref[cataLog.embed_mode].env.backlink_native){var o=i.length,l=site2[e.domain_html].add_backlinks_bks_query(t.pn);l&&(i=i.concat(Array.prototype.slice.call(l.getElementsByTagName("a"))))}if(i.length>0)for(var p=[],c=0;c<i.length;c++){var _=i[c].textContent;if(_.search(this.popups_link_regex)!=-1){if(n){if(pref[cataLog.embed_mode].env.popup_native_kill){var d=i[c].cloneNode(!0);i[c].parentNode.replaceChild(d,i[c]),i[c]=d}else this.popups_posts.blacklist.add(i[c]);if(c>=o)continue}var u=site2[e.domain].popups_href2th_q(i[c].getAttribute("href"));if(u){pref[cataLog.embed_mode].link_show_op&&u[2][2]==u[2][3]&&_.indexOf("(OP)")==-1&&(i[c].textContent+=" (OP)"),u[0]!==r&&(pref[cataLog.embed_mode].link_show_cross&&_.indexOf("→")===-1&&(i[c].textContent+=" →"),pref[cataLog.embed_mode].merge_btn&&i[c].parentNode.insertBefore(Triage.prototype.doms.emMerge.cloneNode(!0),i[c].nextSibling)),p[p.length]=[u[0],u[1]];var f=u[2][0]!==e.domain?e.key:u[2][1]!==e.board?e.board+e.no:u[2][2]!=e.no?e.no:null;site2[e.domain_html].popups_add_backlink(u[0],u[1],null!==f?f+"#"+t.no:t.no,e,a,s,a)}}}this.popups_set(r,t.no,t,p&&0!=p.length&&p,a)},popups_add_backlink:function(e,t,n,r,a,s,i){if(void 0===e[t])e[t]=[n],a&&this.popups_set_waiting(e,t);else if(Array.isArray(e[t]))e[t].indexOf(n)==-1&&(e[t][e[t].length]=n,a&&this.popups_set_waiting(e,t));else{e[t].backlinks||(e[t].backlinks=[]);var o=e[t].backlinks;if(o.indexOf(n)==-1&&(o[o.length]=n,s)){e[t].pn&&site2[r.domain_html].add_backlinks(e[t].pn,o,o.length-1,r);var l=!i&&(r.posts.filter(function(e){return e.no===t})[0]||{}).pn;l&&site2[r.domain_html].add_backlinks(l,o,o.length-1,r)}}},add_backlinks:function(e,t,n,r){var a=this.add_backlinks_bks_query(e),s=a||this.add_backlinks_bks();n||(s.innerHTML="");for(var i=n||0;i<t.length&&(this.add_backlinks_add_1(s,this.popups_backlink2dbtpth(t[i],r)),!n);i++);a||this.add_backlinks_bks_append(e,s)},popups_backlink2dbtpth:function(e,t){var n,r="number"==typeof e?[t.domain,t.board,t.no,e,">>"+e]:(n=e.split(/[\/#]/),2==n.length?[t.domain,t.board,n[0],n[1],">>"+(pref.proto.bl_ec?n[0]+"#":"")+n[1]]:[n[0]||t.domain,"/"+n[1]+"/",n[2],n[3],(n[0]?">>>>"+n[0]:">>>")+"/"+n[1]+"/"+(pref.proto.bl_ec?n[2]+"#":"")+n[3]]);return r[5]=site2[r[0]].link_dbtp2href_abs(r),r},remove_backlink:function(e,t){},popups_remove_backlink:function(e,t,n){if(e[t]){var r=Array.isArray(e[t])?e[t]:e[t].backlinks,a=r.indexOf(n);a>=0&&(r.splice(a,1),e.no===t&&pref.proto.bl_rm&&e[t]&&this.remove_backlink(e[t].pn,a))}},popups_set:function(e,t,n,r,a){t<=2&&(Object.hasOwnProperty.call(e,t)||(e[t]=void 0)),void 0===e[t]?(n.backlinks&&(n.backlinks=void 0),e[t]=n):Array.isArray(e[t])?(n.backlinks=e[t],e[t]=n):(e[t].backlinks&&(n.backlinks=e[t].backlinks),a&&(e[t]=n)),r&&(e[t].quotes=r),n.editing&&this.popups_set_waiting(e,t),this.popups_remove_waiting(e,t)},popups_release:function(e,t){function n(e,t){if(e.no!=t&&e.q&&e.q[t]){var n=Array.isArray(e.q[t])?e.q[t]:e.q[t].backlinks;if(!n||0===n.length){this.popups_remove_waiting(e.q,t),a[s++]=[e,t];var r=e.q&&e.q[t]&&e.q[t].quotes;if(r)for(var i=r.length-1;i>=0;i--)a[s++]=[e,t,r[i]]}}}function r(e){var t=Object.keys(e.q);return t.length-(t.indexOf("waiting")==-1?0:1)}var a=[],s=0;if(pref.debug_mode[12])var i={no:t,lth:e,len:r(e)};for(n.call(this,e,t);--s>=0;){var o=a[s];if(e=o[0],t=o[1],3==o.length){var l=o[2][0],p=o[2][1],c=l.domain!==e.domain?e.key:l.board!==e.board?e.board+e.no:l.no!=e.no?e.no:null;this.popups_remove_backlink(l,p,null!==c?c+"#"+t:parseInt(t,10)),n.call(this,Object.getPrototypeOf(l),p)}else delete e.q[t]}if(pref.debug_mode[12]){var _=r(i.lth);_!==i.len&&console.log("popups_release: "+i.lth.key+": "+_+" <- "+i.len+", "+i.no+(pref.debug_mode[10]?"    "+this.popups_debug(e.q):""))}},popups_set_waiting:function(e,t){if(e.waiting){for(var n=0;n<e.waiting.length&&e.waiting[n]<t;)n++;e.waiting[n]!=t&&e.waiting.splice(n,0,t)}else e.waiting=[t]},popups_remove_waiting:function(e,t){if(e.waiting){var n=e.waiting.indexOf(t);n!=-1&&(e.waiting.splice(n,1),0===e.waiting.length&&delete e.waiting)}},popups_fetched:function(e,t,n){n||(n=0);for(var r=e.posts.length-1,a=t.q.waiting.length-1;a>=0;a--){for(var s=t.q.waiting[a];r>n&&s<e.posts[r].no;)r--;s===e.posts[r].no?this.popups_set(t.q,s,e.posts[r]):"thread"===e.type_source&&(pref.test_mode[64],this.popups_set(t.q,s,{time:0,com:"DELETED"})),this.popups_posts.pop_load(e.key+"#"+e.posts[r].no,e.domain)}},backlink:function(e,t,n){var r=t?Array.isArray(t)?t:t.backlinks:null;r&&this.add_backlinks(e,r,void 0,n)},popups_debug:function(e){if(!e)return"";for(var t=Object.keys(e),n=t.length+", "+e.key+": ",r=0;r<t.length;r++){var a=t[r];n+=a+":"+(Array.isArray(e[a])?e[a]:e[a].backlinks||e[a].remove_if_no_backlinks||"P")+", "}return n},toplevel_anchor_pos:1,toplevel_anchor:function(e,t){for(var n=e.getElementsByTagName("a"),r=0;r<n.length;r++){var a=n[r].getAttribute("href");a&&"#"===a[0]&&n[r].setAttribute("href",this.link_dbtp2href([t.domain,t.board,t.no,a.substr(this.toplevel_anchor_pos)]))}},wrap_to_parse:function(){function e(e){return e?site4.parse_funcs_html:pref.debug_mode.parse_error?site4.parse_funcs_on_demand_debug:site4.parse_funcs_on_demand}function t(t,n,a){var s=a.substr(0,a.indexOf("_")),i=a.substr(a.indexOf("_")+1),o=r[s]+r[i]+(pref.debug_mode.parse_error?"_debug":""),l=liveTag.mems.init({domain:t,board:n}).p[o];if(!l){var p=liveTag.mems[t].p,l=p[o];if(!l){var c=!pref.test_mode[182]&&site2[t].parse_funcs[a+"_template"]||site2[t].parse_funcs[i+"_template"]||e("html"===i),_=pref.catalog.mimic_base_site||site2[t].mimic_always?site.nickname:t;if(l={domain:t,parse_funcs:site2[t].parse_funcs[a],parse_funcs_html:site2[_].parse_funcs[s+"_html"],type_parse:a,type_source:s,type_data:i,type_html:s,domain_html:_,__proto__:c},pref.test_mode[182])for(var d=site2[t].parse_funcs[a+"_template"]||c;d&&d!==c;){for(var u in d)d.hasOwnProperty(u)&&!l.hasOwnProperty(u)&&Object.defineProperty(l,u,Object.getOwnPropertyDescriptor(d,u));d=Object.getPrototypeOf(d)}l.parse_funcs.missing_info&&(l.missing_info=l.parse_funcs.missing_info),p[o]=l}l={board:n,__proto__:l},liveTag.mems[t][n].p[o]=l}return l}var n=/[A-z]/,r={catalog:"c",page:"i",thread:"t",post:"p",shortCatalog:"b",shortThread:"s",html:"h",json:"j"};return{get_getters:e,prep_pfunc:t,get:function(e,r,a,s,i){var o=t(r,a,s);return i&&(void 0!==i.thread&&n.test(i.thread)&&(i.thread=i.thread.substr(1)),i.__proto__=o,o=i),s.indexOf("_json")==-1?o.parse_funcs.ths({pn:e,__proto__:o}):o.parse_funcs.ths(e,o)},posts:function(e,n,r){if(void 0===e.type_data){var a=[];if(e.posts)for(var s=0;s<e.posts.length;s++)!e.posts[s].parse_funcs&&e.posts[s].pn&&(a[a.length]=e.posts[s]);0!=a.length&&this.posts({type_data:"html",posts:a,__proto__:e},0,common_func.shallow_copy_1(r)),e={type_data:"json",__proto__:e}}var i=t(e.domain,e.board,"post_"+(e.posts[0].type_data||e.type_data));r&&(r.__proto__=i,i=r);var o=e.localArchive;if(o&&(i={localArchive:o,__proto__:i}),e.posts)for(var s=n||0;s<e.posts.length;s++)if(!e.posts[s].parse_funcs||o){if(e.posts[s].extra_files)for(var l=0;l<e.posts[s].extra_files.length;l++)e.posts[s].extra_files.parse_funcs||(e.posts[s].extra_files[l].__proto__=i);e.posts[s].__proto__=i}if(e.extra_files&&(!e.extra_files[0].parse_funcs||o))for(var l=0;l<e.extra_files.length;l++)e.extra_files[l].__proto__=i;if(e.posts[0].extra_files)for(var l=0;l<e.posts[0].extra_files.length;l++)e.posts[0].extra_files.parse_funcs||(e.posts[0].extra_files[l].__proto__=i)}}}(),parse_pn_dummy:document.createElement("div"),parse_funcs:{common:{posts:function(){},com:function(){},flags:function(){},flag:function(){},id:function(){},pn_id:function(){},pn_name:function(){},country:function(){},hrefs:function(){},trip:function(){},pn_trip:function(){},id2:function(){},th_init:null,tn_as:function(e){return e.pn.getElementsByTagName("a")},tn_imgs:function(e){var t=[],n=e.pn&&e.pn.getElementsByTagName("a");if(n)for(var r=0;r<n.length;r++){var a=n[r].getElementsByTagName("img")[0];a&&(t[t.length]=a)}return t},key:function(e){return e.domain+e.board+e.no},op_img_url:function(e){return site2[e.domain].catalog_json2html3_thumbnail(e,e.board)},get_op_src:function(e){return e.op_img_url},ths_array:function(e,t){var n=[];if(t)for(var r=0;r<t.length;r++){var a="catalog"===e.type_html?Math.floor(r/15)+"."+r%15:"page"===e.type_html?e.page+"."+r:void 0;n[r]={pn:t[r],page:a,__proto__:e.__proto__}}return n},time:function(e){},time_posted:function(e){},time_unit:1,has_posts:!0,txt:function(e){return site2.DEFAULT.parse_pn_dummy.innerHTML=e.com,site2.DEFAULT.parse_pn_dummy[brwsr.innerText]},type_com:"html",footer_prep:function(e,t){var n=t.innerHTML.replace(/ *R:[0-9 \/]*I:[0-9 \/]*/,"");n=n.replace(/P:[0-9 \/]*/,""),""!==(n=n.replace(/ *\(sticky\) */,""))&&(t.innerHTML="<span></span>"+n,t=t.childNodes[0])},get_lth_from_node:function(e){for(;e&&!e.name;)e=e.parentNode;return e&&liveTag.mems.getFromName(e.name)||null},nativeUpdate2pn:function(e){return e.lastChild},nofFiles:function(){return 0}},headline_html:{footer:function(e){return e.pn.insertBefore(cnst.dom('<span style="padding:0 3px 0 0"></span>'),e.pn.firstChild)},css:".threadIcons {margin:0px;position:static;width:auto;text-align:left;display:inline}"},catalog_html:{posts:function(e){return[{pn:e.pn,__proto__:e.__proto__}]},time:function(e){return e.time_created},posts_full:function(){var e={posts:null,pn:null,flag:null,flags:null,footer:null,pn_name:null,ths:null,page:null,tn_as:null,tn_imgs:null,txt:null,pn_id:null,pn_trip:null,parse_funcs:null,parse_funcs_html:null,type_parse:null,type_source:null,type_data:null,type_html:null,domain:null,board:null,domain_html:null,exe_sub:null,exe_sub2:null};return function(t){for(var n in t)void 0===e[n]&&t.parse_funcs[n]&&Object.defineProperty(t.posts[0],n,{value:t[n],enumerable:!0,configurable:!0,writable:!0})}}(),has_posts:!1,type_com:"txt",filename:function(e){if(e.op_img_url){var t=e.op_img_url.replace(/.*\//,""),n=t.indexOf(".");return e.tim=t.substr(0,n),e.tim}}},catalog_json:{ths:function(e,t){for(var n=[],r=0;r<e.length;r++)if(e[r].threads)for(var a=0;a<e[r].threads.length;a++){var s=e[r].threads[a];s.sticky=1===e[r].threads[a].sticky,s.__proto__=t,n[n.length]={page:r+"."+a,posts:[s],__proto__:s}}return n},has_posts:!1},page_html:{posts_array:function(e,t){var n=[],r=site2[e.domain].wrap_to_parse.prep_pfunc(e.domain,e.board,"post_html");if(pref.test_mode[5])n.pns=t,n.idx0=0,n.idx1=t.length-1,n.get0=this.posts_get0,n.get1=this.posts_get1,n.proto=r,Object.defineProperty(n,n.idx0,{get:n.get0,enumerable:!0,configurable:!0}),Object.defineProperty(n,n.idx1,{get:n.get1,enumerable:!0,configurable:!0});else for(var a=0;a<t.length;a++)n[n.length]={pn:t[a],__proto__:r};return n},posts_get0:function(){var e={pn:this.pns[this.idx0],__proto__:this.proto};return Object.defineProperty(this,this.idx0,{value:e,enumerable:!0,configurable:!0,writable:!0}),++this.idx0<this.idx1&&Object.defineProperty(this,this.idx0,{get:this.get0,enumerable:!0,configurable:!0}),e},posts_get1:function(){var e={pn:this.pns[this.idx1],__proto__:this.proto};return Object.defineProperty(this,this.idx1,{value:e,enumerable:!0,configurable:!0,writable:!0}),--this.idx1>this.idx0&&Object.defineProperty(this,this.idx1,{get:this.get1,enumerable:!0,configurable:!0}),e},posts:function(e){return this.posts_array(e,e.pn.getElementsByClassName("post"))},time_posted:"thread_html",time_bumped:function(e){return e.posts[e.posts.length-1].time},time_created:function(e){return e.posts[0].time},key:function(e){return e.domain+e.board+e.no},insert_footer4:function(e){var t=document.createElement("div");return e.parentNode.insertBefore(t,e)},flags:function(e){var t=[],n=e.posts.length-1,r=pref[cataLog.embed_mode].t2h_num_of_posts-1;if(n<r)for(r=0;r<=n;)e.posts[r]&&(t[r]=e.posts[r].flag),r++;else for(;r>=0;)e.posts[n]&&(t[r--]=e.posts[n--].flag),0==r&&(n=0);return t},html_org:function(e){return e.pn.innerHTML},sticky:function(){return!1},type_com:"txt",replace_omitted_info:function(e,t){e.textContent=t.textContent},replace_omitted_info2:"replace_omitted_info",posts_full:"catalog_html",get_max_page:function(e){var t=e.getElementsByClassName("pages")[0];if(t){t=t.childNodes;for(var n=0,r=0;r<t.length;r++)n+1==t[r].textContent&&n++;return n}}},page_json:{ths:function(e,t){var n=[];if(e&&e.threads)for(var r=0;r<e.threads.length;r++){var a=e.threads[r];a&&(a.page=t.page?t.page+"."+r:void 0,a.key=t.domain+t.board+a.posts[0].no,a.posts[0].__proto__=t,a.__proto__=a.posts[0],n[r]=a)}return n},flags:function(e){if(e.country){var t=e.posts.length-pref[cataLog.embed_mode].t2h_num_of_posts;return[e].concat(e.posts.slice(t<=1?1:t))}}},thread_html:{ths_array:function(e,t){return[{pn:t,__proto__:e.__proto__}]},time_posted:function(e){return 1e3*e.posts[e.posts.length-1].time},posts_full:"catalog_html",id:function(e){return e.posts[0].id},country:function(e){return e.posts[0].country},trip:function(e){return e.posts[0].trip},flag:function(e){return e.posts[0].flag},name:function(e){return e.posts[0].name},type_com:"txt",time_unit:1e3},thread_json:{ths:function(e,t){return e.key=t.domain+t.board+e.posts[0].no,e.posts[0].__proto__=t,e.__proto__=e.posts[0],[e]},time_created:function(e){return 1e3*e.posts[0].time},time_bumped:function(e){if(!e.posts[0].bumplimit){for(var t=e.posts.length-1;t>0&&e.posts[t].email&&"sage"===e.posts[t].email;)t--;return 1e3*e.posts[t].time}},time_posted:function(e){return 1e3*e.posts[e.posts.length-1].time},nof_posts:function(e){return e.posts[0].replies+1},nof_files:function(e){return e.posts[0].images+1},has_nof_files:!0,sub:function(e){return e.posts[0].sub||""},name:function(e){return e.posts[0].name||""},com:function(e){return e.posts[0].com||""},sticky:function(e){return 1===e.posts[0].sticky},time_unit:1e3,prep_to_archive:function(e){return{posts:e}},rip_from_archive:function(e){return e.posts||e}},post_html:{sub:function(e){var t=e.pn.getElementsByClassName("subject")[0];return t?t.textContent:""},img2src:function(e){return e.parentNode.href},img2ext:function(e){return e.parentNode.getAttribute("data-ext")},nofFiles:function(e){return e.pn.getElementsByClassName("file").length}},post_json:{time_unit:1e3,pn:function(e){return site2[e.domain_html].post_json2html(e,e.board)},anchor:function(){},hrefs:function(e){if(e.com){var t=e.com.match(/href="([^"]*)"/g);if(t)for(var n=0;n<t.length;n++){var r=t[n].indexOf("://");t[n]=t[n].slice(r===-1?6:r+1,-1)}return t}}},base_html:{time_created:function(e){return e.posts[0].time},time_posted:function(e){return e.posts[e.posts.length-1].time},time_unit:1,proto:"page_html"},json_template:{sub:"",name:"Anonymous",com:"",sticky:void 0,no:void 0,time:void 0,get nofFiles(){return this.filename?1:0}}},parse_parts:{add_op_img_url:function(e,t,n){for(var r=0;r<e.length;r++)e[r].op_img_url=site2[n].catalog_json2html3_thumbnail(e[r],t)}},update_posts_merge_prep:function(e,t,n,r){if(e){n=n>=0?n+1:(t&&t.length?t.length:0)+e.length,n<e.length&&(e=e.slice(0,1).concat(e.slice(e.length-n+1)));var a=1,s=0,i=[e[0]];if(r)for(;a<e.length&&s<t.length;)e[a].no!==t[s].no?i[i.length]=e[a].no<t[s].no?e[a++]:t[s++]:(i[i.length]=e[a++],s++);else for(;a<e.length&&s<t.length;)i[i.length]=e[a].time*e[a].parse_funcs.time_unit<t[s].time*t[s].parse_funcs.time_unit?e[a++]:t[s++];return i=i.concat(a<e.length?e.slice(a):t.slice(s)),i.length<=n?i:i.slice(0,1).concat(i.slice(i.length-n+1,i.length))}},update_posts_merge_bases:{factory:function(){return{bases:{},initialized:!1,shown:new Map,shownSet:new Set,__proto__:this}},bases:{},bases_unique:function(){var e=new Map;for(var t in this.bases)e.set(this.bases[t],t);return e},reorder_bases:function(e){for(var t in this.bases)this.bases[t].reorder_req>=4?this.bases[t].reorder_all(e):this.bases[t].re_style(e)},initialized:!1,query:function(e,t,n,r,a){var s=this.base_tgts(e,a.pref[a.mode]);if(s){var i=this.bases[s],o=i||this.base_factory(e,t,n,r,a);return this.bases[e]=o,this.merge_th(t,n,o,e,a),i?r&&a.func_hide_org(e):this.initialized||this.setup_hook(a),t[0]=o.pn,o}},base_factory:function(){function e(e){return e[8][0]}function t(e){return e[8][1]}function n(e){return e[8][2]}function r(e){return e[8][3]}function a(e){return e[8][4]}function s(e,t){return e>t?e:t}function i(e,t){return e<t?e:t}function o(e,t){return e+t}function l(e){return u.lths.map(e).reduce(p)}function p(e,t){return e&&t?e+t:e?e:t}function c(e){return e.ta&&e.ta.posts?e.ta.posts.length:""}function _(e){return e.pd?e.pd.length:""}function d(e){return e.sg?e.sg.size:""}var u,f={posts:{get length(){return l(c)}}},h={get length(){return l(_)}},m={get size(){return l(d)}},g={recent_posts:function(e){void 0!==e&&null!==e||(e={lth:u,__proto__:u.tgt_ths[0][16]}.get_t2h_num_of_posts());var t=u.posts||(u.lths.forEach(function(e){e.ta&&site2[e.domain].wrap_to_parse.posts({posts:e.ta.posts,__proto__:e.ta.posts[0]})}),u.tgt_ths.map(function(t){return t[16].recent_posts(e)}).reduce(function(t,n){return site2.DEFAULT.update_posts_merge_prep(t,n,e)}));return site2.DEFAULT.update_posts_replace_prep(null,t,e)}},v={lazy_draw:function(e){e>=this.lazy.length?this.lazy[e]=!0:this.lazy.splice(e,0,!0),this.lazy_idx>e&&(this.lazy_idx=e)},remove:function(e){return this.posts.splice(e,1),e<this.lazy_idx&&this.lazy_idx--,!this.lazy||!this.lazy.splice(e,1)[0]},draw_1_pos:function(e){for(var t=e+1;t<this.lazy.length&&this.lazy[t];)t++;return this.lazy[e]=!1,t},get_class:function(e,t,n){if(!t&&!pref.proto.merge_lv)return null;var r=pref_func.merge_obj5a_sc(e,n?pref3.proto.merge_lv_obj2_old:pref3.proto.merge_lv_obj2,null);return null===r?null:pref.script_prefix+"_merged"+r},posts:null,lazy:null,lazy_idx:null,get 0(){return this.tgt_ths.map(e).reduce(s)},get 1(){return this.tgt_ths.map(t).reduce(i)},get 2(){return this.tgt_ths.map(n).reduce(o)},get 3(){return this.tgt_ths.map(r).reduce(o)},get 4(){return this.tgt_ths.map(a).reduce(s)},get 8(){return this},get 14(){if(1==this.tgt_ths.length)return this.tgt_ths[14];var e,t=this.tgt_ths.map(function(t){return e=(t[14]||"").split("."),e[0]=parseInt(e[0],10),e}).sort(function(e,t){return e[0]!=t[0]?e[0]-t[0]:e[1].length!=t[1].length?e[1].length-t[1].length:e[1]<t[1]?-1:1});return t[0].join(".")+"-"+t[t.length-1].join(".")},get 16(){return u=this,g},domain:"",board:"",no:"",get tags(){var e=pref.proto.footer.merged_tag;if("no"===e)return[];if("all"===e){for(var t={},n=0;n<this.lths.length;n++)for(var r=this.lths[n].tags,a=0;a<r.length;a++)t[r[a]]=(t[r[a]]||0)+1;for(var s=this.lths[0].tags,a=0;a<s.length;a++)if(t[s[a]]!=this.lths.length)return r.slice(0,a);return s}for(var t=new Map,n=0;n<this.lths.length;n++)for(var r=this.lths[n].tags,a=0;a<r.length;a++)t.set(r[a],(t.get(r[a])||0)+1);var i=[];for(var o of t.keys())i[i.length]=o;return i.sort(function(e,n){return t.get(n)-t.get(e)})},get watched(){return this.lths.some(function(e){return e.watched})},get watched_p(){return this.lths.some(function(e){return e.watched_p})},get nrtm(){return this.lths.map(function(e){return e.watched&&e.nrtm||0}).reduce(o)},get nr(){return this.lths.map(function(e){return e.watched_p&&e.nr||0}).reduce(o)},get ta(){return u=this,f},get pd(){return u=this,h},get sp(){return u=this,m},get archived(){var e=this.lths.filter(function(e){return e.archived}).length;return 0===e?0:e===this.lths.length?1:8},get keys(){return this.lths.map(function(e){return e.key})},reorder_all(e){var t=this.keys;if(!(t.length<2)){for(var n=e.idx_insert_bulk(t,e,!0,!0),r=0;r<n.length;r++)if(n[r]!=t[r]){var a=t.indexOf(n[r]);t.splice(r,0,t.splice(a,1)[0]),this.lths.splice(r,0,this.lths.splice(a,1)[0]),this.tgt_ths.splice(r,0,this.tgt_ths.splice(a,1)[0]);var s=this.tgt_ths[r],i=s[16].domain_html;"headline"===e.view?site2[i].headline_reorder(s[3],this,e,r):"catalog"===e.view&&site2[i].catalog_reorder(s[3],this,e,r)}this.re_style(e)}},re_style:function(e){var t=e.pref.filter.attr_list_obj2,n=this.lths,r=2&this.reorder_req;r&&e.view_attr_set(n[0].key,!0);for(var a=0;a<n.length;){if(t[n[a].key]&&t[n[a].key].style){r||e.view_attr_set(n[0].key,!0),0!==a&&e.view_attr_set(n[a].key,!0);break}a++}this.reorder_req=0}};return function(e,t,n,r,a){var s={pn:t[0],isShown:0,top_key:e,tgt_ths:[],lths:[],footer:null,reorder_req:0,__proto__:v};if("catalog"===a.view)s.cns=null;else if("page"===a.view||"thread"===a.view){var i=t[16].posts||n.posts;a.merge_bases.class_add_all(i,v.get_class(e)),s.posts=i.slice(),s.lazy=pref[a.view].lazyDraw.merge?i.map(function(){return!1}):null,s.lazy_idx=pref[a.view].lazyDraw.merge?i.length:null}return s}}(),class_add_all:function(e,t){if(t)for(var n=0;n<e.length;n++)e[n].pn&&e[n].pn.parentNode&&e[n].pn.parentNode.classList.add(t)},class_remove_all:function(e,t){if(t)for(var n=0;n<e.length;n++)e[n].pn&&e[n].pn.parentNode&&e[n].pn.parentNode.classList.remove(t)},remove_th:function(e,t,n){var r=this.bases[e];if(r){var a=t[16].domain_html;t[0]="catalog"===n.view?site2[a].catalog_separate(r,t[3],t[16],n,r.isShown>1&&r.keys[0]===e):"headline"===n.view?site2[a].headline_separate(r,t[3]):this.remove_th_page(t[16],!1,r,n),2===r.isShown&&(r.footer[0].parentNode.removeChild(r.footer[0]),r.footer=null),n.remake_html_prep(t,"headline"!==n.view&&(pref.test_mode[191]||"catalog"!==n.view)&&e),t[3]=null;var s=r.lths.indexOf(liveTag.mems.getFromName(e));r.tgt_ths.splice(s,1),r.lths.splice(s,1),n.footer.draw_merge(t,e,null),1==--r.isShown?gGEH.pns_all_keys.set(r.pn,r.lths[0].key):0!==r.isShown&&(r.reorder_req|=0===s?3:1),r.top_key===e&&(r.top_key=null),delete this.bases[e]}},merge_th:function(e,t,n,r,a){var s=e[16].domain_html;"catalog"===a.view?e[3]=site2[s].catalog_merge(e[0],n,a,r):"headline"===a.view?e[3]=site2[s].headline_merge(e[0],n,a):(1===n.isShown&&(n.footer=[n.pn.insertBefore(cnst.dom('<div style="clear:both"></div>'),n.pn.firstChild)]),0!==n.isShown&&this.merge_th_page({pn:e[0],posts:e[16].posts||t.posts,__proto__:e[16]},n,a)),n.tgt_ths[n.tgt_ths.length]=e,n.lths[n.lths.length]=liveTag.mems.getFromName(r),a.footer.draw_merge(e,r,n),n.isShown++,2===n.isShown&&(gGEH.pns_all_keys.set(n.pn,n),gGEH.pns_all_keys.set(n.footer[0],n)),pref.test_mode[148]&&n.isShown>=2&&(n.reorder_req|=2===n.isShown?7:5),gGEH.pns_all_keys.set(e[24][0],r)},remove_th_page:function(e,t,n,r){var a=t?null:site2[e.domain_html].page_json2html3_skelton(e)
;return site2[e.domain_html].update_posts_separate(e,n,a,r),a},merge_th_page:function(e,t,n){for(var r=0,a=0;a<e.posts.length;a++)r=site2[e.domain_html].update_posts_merge_1(e,t,a,r);t.lazy&&t.lazy_idx<t.posts.length&&n.lazy_tgts.set(t,e.key)},base_arr:function(e){return pref_func.merge_obj5a_sc(e,pref3.proto.merge_list_obj2,null)},base_arr_old:function(e){return pref_func.merge_obj5a_sc(e,pref3.proto.merge_list_obj2_old||{},null)},base_tgts:function(e,t){if(t.merge)return Object.keys(this.bases)[0]||e;if(!t.merge_list)return null;var n=this.base_arr(e);if(!n)return null;for(var r=0;r<n.length;r++)if(this.base_arr(n[r])===n&&this.bases[n[r]])return n[r];return e},query_merged_keys:function(e){var t=this.bases[e];return t?t.keys:[e]},func_check_reorder:function(e,t){var n=this.merge_bases,r=n.bases[e];if(r)for(var a=t,s=0;s<r.lths.length;s++){var i=r.lths[s].key,o=i===e?t:this.idxs.indexOf(i);o<=a&&(a=o,r.top_key=i)}},func_show:function(e,t,n){var r=this.merge_bases,a=(this.threads[e],r.bases[e]);return a?(a.top_key===e&&this.func_show_org(e,t,n),!0):this.func_show_org(e,t,n)},func_hide:function(e){var t=this.merge_bases,n=t.bases[e];return n?(1===n.isShown&&(this.func_hide_org(e),t.shown.delete(n),"page"!==this.view&&"thread"!==this.view||this.lazy_tgts.delete(n)),t.remove_th(e,this.threads[e],this),!0):this.func_hide_org(e)},func_search_ref_idx:function(e,t,n){var r=this.merge_bases,a=this.threads[e],s=r.bases[e],i=s||!a[1]&&r.query(e,a,null,!1,this);if(!i||s&&n)return t;if(pref.test_mode[179])return r.shown.get(i)||t;var o=this.idxs.indexOf(i.top_key);return o===-1||o>t?(i.top_key=e,t):o},func_search_ref:function(e){var t=this.merge_bases,n=t.bases[e];return n&&n.top_key!==e},func_check_overrated:function(e){var t=this.merge_bases,n=t.bases[e];return n&&null===n.top_key},func_track_shown:function(e,t,n){var r=this.merge_bases,a=r.bases[e];if(a){var s=this.pref[this.mode].merge;if(!r.shown.has(a)){var i=!0;this.func_track_shown_org(e,!s&&t),r.shown.set(a,n),pref.test_mode[179]&&(a.top_key=e),r.shownSet.add(r.base_arr(e))}if(a.lazy&&a.lazy_idx<a.posts.length&&this.lazy_tgts.set(a,e),s&&t&&("page"===this.view||"thread"===this.view)){var o=pref.test_mode[88]?1:pref.proto.lazyDraw.merge_step;++this.post_count%o==0&&(this.drawn_y=this.threads[e][16].posts[0].pn.offsetTop)}return i}return this.func_track_shown_org(e,t),!1},shown:new Map,shownSet:new Set,isShownForTails:function(e){var t=this.base_arr(e);return!!t&&this.shownSet.has(t)},func_track_reset:function(){var e=this.merge_bases;e.shown.clear(),e.shownSet.clear(),this.post_count=0,this.lazy_tgts.clear(),this.func_track_reset_org()},setup_hook:function(e){e.func_show_org=e.func_show,e.func_show=this.func_show,e.func_hide_org=e.func_hide,e.func_hide=this.func_hide,e.func_track_shown_org=e.func_track_shown,e.func_track_shown=this.func_track_shown,e.func_track_reset_org=e.func_track_reset,e.func_track_reset=this.func_track_reset,e.func_search_ref=this.func_search_ref,e.func_search_ref_idx=this.func_search_ref_idx,e.func_check_overrated=this.func_check_overrated,e.post_count=0,e.lazy_tgts=new Map,e.func_lazy_draw=this.func_lazy_draw,e.func_check_reorder=this.func_check_reorder,this.initialized=!0},func_lazy_draw:function(){if("page"===this.view||"thread"===this.view){var e=this.get_ref_height(4);for(var t of this.lazy_tgts.keys()){var n=t.lazy_idx;if(n>=1&&t.posts[n-1].pn.offsetTop>e)break;for(var r=0,a=pref.test_mode[88]?1:pref.proto.lazyDraw.merge_step,s=pref.catalog.mimic_base_site?site.nickname:this.threads[this.lazy_tgts.get(t)][16].domain_html;n<t.posts.length;){if(t.lazy[n]){for(r<n&&(r=n+1);r<t.lazy.length&&t.lazy[r];)r++;site2[s].update_posts_insert(t.posts,t.posts,n,r,t.pn),t.lazy[n]=!1;var i=t.get_class(t.posts[n].key_op);i&&t.posts[n].pn.parentNode.classList.add(i)}if(!pref.test_mode[111]&&++this.post_count%a==0&&t.posts[n].pn.offsetTop>e)break;n++}t.lazy_idx=n,n>=t.posts.length&&this.lazy_tgts.delete(t)}}else"headline"!==this.view&&"catalog"!==this.view||this.merge_bases.reorder_bases(this)},release_hook:function(){},auto_merge_list:function(e,t){if(this.bases[e]){var n=this.base_arr(e);if(n){var r=n.slice().splice(n.indexOf(e),1);scan.scan_ui("mergeAuto",{tgts:r,options:{refresh:t}}),pref[pClg.mode].merge_auto_list_lv_add&&pClg.merge_bases.add_to_lv_list(r,pref[pClg.mode].merge_auto_list_lv,pClg)}}},add_to_list_fromUI:function(e,t,n){scan.scan_ui("mergeUI",{tgts:[t],options:{refresh:n}}),pref.proto.merge_btn_lv_add&&this.add_to_lv_list(t,pref.proto.merge_btn_lv,n),"all"===n.pref[n.mode].merge_btn_mode?n.pref[n.mode].merge||(n.pref[n.mode].merge=!0,pref_func.apply_prep(n.components.merge,!1,!0,"float"!==n.mode)):(this.add_to_list_1(e,t,n,null,!0),pref.proto.merge_list||(pref.proto.merge_list=!0,pref_func.settings.pnOrDummy(pClg.mode+".merge_list").checked=!0,n.onchange_funcs["*w/.merge_list"]()))},add_to_lv_list:function(e,t,n,r){if(pref.test_mode[193]){if(Array.isArray(e))for(var a=0;a<e.length;a++)pref.proto.merge_lv_str=pref3.proto.merge_lv_obj2._revise(e[a],t,r,pref.proto.merge_lv_str);else pref.proto.merge_lv_str=pref3.proto.merge_lv_obj2._revise(e,t,r,pref.proto.merge_lv_str);pref_func.settings.pnOrDummy("proto.merge_lv_str").value=pref.proto.merge_lv_str}else{if(Array.isArray(e)){for(var a=0;a<e.length;a++)this.add_to_lv_list(e[a],t,a===e.length-1?n:null,r);return}var s=new RegExp("(^|,)\\s*"+e+"\\s*:\\s*\\w+\\s*(,|\n|$)","mg"),i=pref.proto.merge_lv_str.replace(s,",")+"\n"+(r?"":e+":"+t+"\n");if(pref.proto.merge_lv_str=pref_func.fmt4str2(i),!n)return;pref_func.apply_prep_1n("proto.merge_lv_str",!1,null,null,!0)}this.base_arr(e)&&n.onchange_funcs["*w/.merge_lv_str"](null,n.mode,e)},add_to_list_1:function(e,t,n,r,a){var s=this.base_arr(t);if(!(e&&t&&s)||!r&&s!==this.base_arr(e))if(pref.test_mode[192]){var i=pref3.proto.merge_list_obj2._revise(e,t,pref.proto.merge_list_str,"no_insert"===a);pref_func.settings.pnOrDummy("proto.merge_list_str").value=pref.proto.merge_list_str=i.str,n.onchange_funcs["*w/.merge_list_str"](null,n.mode,common_func.Array_toObj(i.tgts,null),r,!0,a)}else{if(pref.test_mode[178])var o=pref3.proto.merge_list_obj2_old,l=pref3.proto.merge_list_obj2,p=this.debug_copy(o||l),c=pref.proto.merge_list_str;var _=pref.proto.merge_list_str;if(_=this.add_to_list_2(e,t,_,"no_insert"===a),(null===e||this.base_arr(e)||"no_insert"===a)&&s&&2===s.length){var d=s[s.indexOf(t)?0:1],u=d.indexOf("/"),f=d.lastIndexOf("/");u>0&&u!==f&&f!==d.length-1&&(_=this.add_to_list_2(null,d,_))}pref.proto.merge_list_str=_,pref_func.apply_prep_1n("proto.merge_list_str",!1,null,null,!0);var h=common_func.Array_toObj((s||[]).concat(this.base_arr(t)||[]),null);if(n.onchange_funcs["*w/.merge_list_str"](null,n.mode,h,r,!0,a),pref.test_mode[178]){var m=pref3.proto.merge_list_obj2,i=l._revise(e,t,c,"no_insert"===a,g||o),g=i.old;for(var v in g)g[v]&&this.debug_error_check(t,e,v,g,p,"old!==old_org");for(var v in p)g[v]||this.debug_error_check(t,e,v,p,g,"old_org!==old");for(var v in l)this.debug_error_check(t,e,v,l,m,"now!==now_org",p);for(var v in m)l[v]||this.debug_error_check(t,e,v,m,l,"now_org!==now",p);for(var b in l[":REV"])for(var v in l[":REV"][b])l[":REV"][b][v]!==m[":REV"][b][v]&&console.log("ERROR: now3!==now_org3, "+b+v);for(var b in m[":REV"])for(var v in m[":REV"][b])m[":REV"][b][v]!==l[":REV"][b][v]&&console.log("ERROR: now_org3!==now3, "+b+v);if(i.str!==pref.proto.merge_list_str){for(var v=0;v<i.str.length&&i[v]===pref.proto.merge_list_str[v];v++);console.log("ERROR: str at "+v+"\n"+_.slice(v-10,v+100)+"\n"+pref.proto.merge_list_str.slice(v-10,v+100))}}}},debug_copy:function(e){var t={};for(var n in e)t[n]=Array.isArray(e[n])?e[n].slice():e[n];return t},debug_error_check:function(e,t,n,r,a,s,i){":REV"!==n&&":F"!==n&&"_revise"!==n&&"_rm"!==n&&(a[n]&&r[n].join()===a[n].join()||console.log("ERROR: ",e,t,s+": "+n+": "+r[n].join()+": "+(Array.isArray(a[n])?a[n].join():a[n])+": "+(i?i[n]:"----")))},add_to_list_2:function(e,t,n,r){var a=e&&this.existIn(n,e),s=this.existIn(n,t);if(s&&(!e||a||r)){n="+"===s[1]?n.slice(0,s.index)+n.slice(s.index+s[0].length):n.slice(0,s.index+s[1].length)+n.slice(s.index+s[0].length+s[3].length);var i=s[0].length+("+"===s[1]?0:-s[1].length+s[3].length)}if(e)if(a){var o=(s&&a.index>s.index?a.index-i:a.index)+a[0].length;n=n.slice(0,o)+"+"+t+n.slice(o)}else s&&!r?n=n.slice(0,s.index+s[1].length)+e+"+"+n.slice(s.index+s[1].length):n+="\n"+e+"+"+t+"\n";return pref_func.fmt4str2(n)},existIn:function(e,t){var n=t.replace(/\+/,"\\+");return new RegExp("(^|,|\\+)\\s*"+n+"(s*)(?=(,|\n|$|\\+))","mg").exec(e)},hide_merge_tgts:function(e,t,n,r){var a=pref.test_mode[192]&&n||{};if(!n||!pref.test_mode[192]){n||(n=e.threads);for(var s in n){var i=e.threads[s];i&&(i[1]||r)&&t.call(this,s)&&(a[s]=i)}}return e.func_hide_all(a),e.func_track_reset(),this.initialized||this.setup_hook(e),a},onchange_funcs:common_func.Object_defProps(pref_func.settings.onchange_funcs,{"*w/.merge_list_str":function(e,t,n,r,a,s){gClg.BroadcastEventByMode(t.split(".")[0],this["*w/.merge_list_str_1"],arguments),pref3.proto.merge_list_obj2_old=null},"*w/.merge_list_str_1":function(e,t,n,r,a,s){var i=this["."];if(i.pref[i.mode].merge_list){var o=i.merge_bases.hide_merge_tgts(i,function(e){var t=this.base_arr(e),n=this.base_arr_old(e);return t?!n||t.join()!==n.join()&&(!s||this.bases[this.base_tgts(e,i.pref[i.mode])]!==this.bases[e]):n},n,s);a||(i.dirty|=16),!r&&Object.keys(o).length&&i.show_catalog_buf(o)}},"*w/.merge_list":function(e,t){var n=this["."];if(!n)return void gClg.BroadcastEventByMode(t.split(".")[0],this["*w/.merge_list"],arguments);n.merge_bases.hide_merge_tgts(n,function(e){return this.base_arr(e)||this.base_arr_old(e)}),n.dirty|=16,n.show_catalog(0)},"*w/.merge":function(e,t){var n=this["."];if(!n)return void gClg.BroadcastEventByMode(t.split(".")[0],this["*w/.merge"],arguments);n.merge_bases.hide_merge_tgts(n,function(){return!0}),n.dirty|=16,n.pref[n.mode].merge&&(n.order.ordering_old=n.order.ordering),n.components.ordering.onfocus(),n.order.ordering=n.pref[n.mode].merge?n.idx_idxMergeAll:n.order.ordering_old||0,pref_func.apply_prep(n.components.ordering,!1,!0),n.components.ordering.onblur(),n.components.ordering.disabled=n.pref[n.mode].merge},"*w/.merge_lv_str":function(e,t,n){gClg.BroadcastEventByMode(t.split(".")[0],this["*w/.merge_lv_1"],[e,t,!0,n]),pref3.proto.merge_lv_obj2_old=null},"*w/.merge_lv":function(e,t){this["."]?this["*w/.merge_lv_1"](e,t):gClg.BroadcastEventByMode(t.split(".")[0],this["*w/.merge_lv_1"],arguments)},"*w/.merge_lv_1":function(e,t,n,r){var a=this["."];if(a.pref[a.mode].merge||a.pref[a.mode].merge_list){var s=a.merge_bases,i=r?a.threads[r]?common_func.Array_toObj([r],null):{}:a.threads;for(var t in i)if(a.threads[t][1]){var o=s.bases[t];if(o){var l=o.get_class(t),p=n?o.get_class(t,!0,!0):null;if(!n||l!=p){var c="page"===a.view||"thread"===a.view?a.threads[t][16].posts:[{pn:o.pn}];!n&&a.pref[a.mode].merge_lv||s.class_remove_all(c,n?p:l),(n||a.pref[a.mode].merge_lv)&&s.class_add_all(c,l)}}}}}})},update_posts_replace_prep:function(e,t,n){if(!e||e.length<=1)return n<0||t.length<=n+1?t:0==n?t.slice(0,1):t.slice(0,1).concat(t.slice(-n));if((n=n>=0?n+1:t.length+e.length-1)==e.length)return e;if(n<e.length)return e.slice(0,1).concat(e.slice(e.length-n+1));for(var r=e[1].no,a=1;a<t.length&&t[a].no<r;)a++;if(1===a)return e;var s=a>n-e.length?a-(n-e.length):1;return e.slice(0,1).concat(t.slice(s,a),e.slice(1))},update_posts0_class:function(e,t){t?e.classList.remove("CatChan_search_miss"):e.classList.add("CatChan_search_miss")},update_posts_replace:function(e,t,n,r,a,s,i,o){if(r&&(n=r.pn,a=r.isShown),t.posts){if(pref.test_mode[140]){var l=t.parse_funcs_html.get_omitted_info(t.posts[0]),p=e.posts[0].pn&&(pref.test_mode[139]||e.posts[0]!==t.posts[0])?e.parse_funcs_html.get_omitted_info(e.posts[0]):site2[e.domain_html].page_json2html3_add_omitted_info(e,null,e.posts);l?t.parse_funcs_html.replace_omitted_info2(l,p,e):p&&t.parse_funcs_html.set_omitted_info(t.posts[0],p)}else site2[e.domain].page_json2html3_add_omitted_info(e,t,pref[i.view].use_expander_always);for(var c=-1,_=e.posts.length-1,d=null,u=t.posts.length-1;u>=1;u--){for(;_>1&&e.posts[_].no>t.posts[u].no;)_--;var f=t.posts[u].editing&&t.posts[u].pn&&t.posts[u]!==e.posts[_];(e.posts[_].no!=t.posts[u].no||f)&&(c=this.update_posts_remove_1(t,u,n,a,r,c,i)),f&&(d?d[d.length]=e.posts[_]:d=[e.posts[_]])}}this.update_posts_add(e,t,n,r,a,s,d,o)},update_posts_add:function(e,t,n,r,a,s,i,o){if(t.posts&&e.posts)for(var l=liveTag.mems[e.domain][e.board][e.no].q,p=(r&&e.parse_funcs.time_unit,-1),c=r?0:1,_=r?0:1;_<e.posts.length;_++){for(;c<t.posts.length&&e.posts[_].no>t.posts[c].no;)c++;if(c>=t.posts.length||e.posts[_].no!=t.posts[c].no){var d=i&&i.indexOf(e.posts[_])!=-1,l=d?liveTag.mems[e.domain][e.board][e.no].q:null;cataLog.format_html.prepare_html_post(e,e.posts[_],null,null,null,o,!0),d&&pref[cataLog.embed_mode].backlink&&l[e.posts[_].no].backlinks&&site2[e.domain_html].add_backlinks(e.posts[_].pn,l[e.posts[_].no].backlinks,void 0,e),r?p=this.update_posts_merge_1(e,r,_,p):this.update_posts_insert(e.posts,t.posts,_,c,n),c<t.posts.length?t.posts.splice(c,0,e.posts[_]):t.posts[t.posts.length]=e.posts[_],s[s.length]=e.posts[_]}c<t.posts.length&&c++}},update_posts_remove_1:function(e,t,n,r,a,s,i){var o=e.posts[t];return r&&pref[cataLog.embed_mode].scroll_lock&&i.show_catalog_scroll_lock.modified(o),a?(s=s==-1?a.posts.indexOf(o):a.posts.lastIndexOf(o,s),s==-1&&(s=a.posts.lastIndexOf(o)),s>=0&&a.remove(s)&&this.update_posts_remove(e,t,n)):o.pn&&this.update_posts_remove(e,t,n),e.posts.splice(t,1),s},update_posts_merge_1:function(e,t,n,r){var a=e.posts[n].time_tu;for(r==-1&&(r=t.posts.length-1);r>0&&t.posts[r].time_tu>=a;)r--;for(;r<t.posts.length&&(t.posts[r].time_tu<a||t.posts[r].time_tu==a&&t.posts[r].no<=e.posts[n].no);)r++;if(t.lazy&&t.lazy_draw(r),!t.lazy||!pref.test_mode[89]&&0==n){this.update_posts_insert(e.posts,t.posts,n,t.lazy?t.draw_1_pos(r)-1:r,t.pn);var s=t.get_class(e.key);s&&e.posts[n].pn.parentNode.classList.add(s)}return r<t.posts.length?t.posts.splice(r,0,e.posts[n]):t.posts[t.posts.length]=e.posts[n],r},update_posts_separate:function(e,t,n,r){for(var a=t.get_class(e.key,!0),s=0,i=0;i<e.posts.length;i++){var o=e.posts[i];s=t.posts.indexOf(o,s),s==-1&&(s=t.posts.indexOf(o));var l=s!=-1&&t.remove(s);t.isShown&&pref[cataLog.embed_mode].scroll_lock&&r.show_catalog_scroll_lock.modified(o),a&&o.pn.parentNode&&o.pn.parentNode.classList.remove(a),n?this.update_posts_insert(e.posts,[],i,i,n):l&&this.update_posts_remove(e,i,t.pn)}},short_link:function(){return""},link_sanitizedTxt2html:function(e,t){return e.replace(/&gt;&gt;(&gt;(&gt;[^\/]+)*\/\w+\/)*(\d\d+)/g,function(e,n,r,a){var s=[r?r.slice(4):site.nickname,n?n.slice(n.indexOf("/")):site.board,a,a];return t._links?t._links[t._links.length]=s:t._links=[s],this.link_dbtp2html(s,e)}.bind(this))},link_dbtp2txt:function(e,t,n){return(e[0]!==(n||site.nickname)?">>>>"+e[0]+e[1]+"/":e[1]!==(t||site.board)?">>>"+e[1]:">>")+(e[3]||e[2])},modify_a2anchor:function(e){if(0==e.childElementCount&&">"!==e.textContent[0]){var t=this.popups_posts.href2domain(e.href);if(t&&site2[t]){var n=e.textContent.replace(e.href," ()"),r=site2[t].popups_href2dbtp(e.href);e.textContent=this.link_dbtp2txt(r)+(" ()"===n?"":n)}}},modify_href2html:function(e,t,n,r){var a=this.popups_href2dbtp(r);return e._links?e._links[e._links.length]=a:e._links=[a],'<a href="'+r+'">'+this.link_dbtp2txt(a,n,t)+"</a>"+(pref.test_mode[147]?Triage.prototype.MERGEE_button_html:"")},page_json2html3_replace_expander:function(){},page_json2html3_add_omitted_info:function(e,t,n,r){if(!r){var a=e.posts,s=e.lth.pd,i=e.nof_posts-a.length+(s?s.length:0);if(i){for(var o=0,l=0;l<a.length;l++)o+=a[l].nofFiles;if(s){for(var p={},l=0;l<a.length;l++)a[l].deleted_after&&(p[a[l].no]=null);for(var l=0;l<s.length;l++)void 0===p[s[l].no]&&(o-=s[l].nofFiles)}var c=e.nof_files-o}}t.pn_summary||(n|=e.domain!==site.nickname,(i>0||n)&&(t.pn_summary=this.page_json2html3_prep_omitted_info(t.posts?t.posts[0]:e.posts[0],e,n))),t.pn_summary&&!r&&(t.pn_summary.textContent=this.page_json2html3_set_omitted_info(i,c||0))},page_json2html3_cloneOPWithoutFooter:function(e){if(e){var t=e.cloneNode(!0),n=t.getElementsByClassName(pref.script_prefix+"_footer")[0];return n&&n.parentNode.removeChild(n),t}},post_json2html_fname_server:function(e){return e.tim+e.ext},post_json2html_fname:function(e){return e.filename+e.ext},post_com2txt_finisher:function(){var e=document.createElement("div");return function(t,n){return t.search(/&[#\w\d]+;/)==-1?t:(pref.debug_mode[17]&&console.log("not interpreted html: "+t),e.innerHTML=n&&n.com,e.textContent)}}(),post_com2txt:function(e){return e.com?this.post_com2txt_finisher(e.com.replace(/<[^>]*>/g," ").replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&amp;/g,"&"),e):""},patch:{},post_pn2ce:function(e){return"BLOCKQUOTE"===e.lastChild.tagName?e.lastChild:e.getElementsByTagName("blockquote")[0]},headline_json2html:function(e){var t=site2[e.domain].post_com2txt(e),n=pref.headline.max_letters-(e.sub?e.sub.length+9:0),r=(e.sub?"<b>"+e.sub+"</b>: ":"")+(t.length<n?t:t.slice(0,n)+" ..."),a=cnst.dom('<div class="'+pref.script_prefix+'_headline">'+r+"</div>");return gGEH.pns_all_keys.set(a,e.key),a},headline_merge:function(e,t,n){if(0===t.isShown)return e;if(1===t.isShown){var r=t.pn;t.pn=t.tgt_ths[0][0]=cnst.dom('<div class="'+pref.script_prefix+"_headline "+pref.script_prefix+'_merged"></div>'),r.parentNode&&r.parentNode.insertBefore(t.pn,r);var a=pref.headline.merge_truncated,s=cnst.dom('<div class="'+pref.script_prefix+'_mergedMembers"'+(a?' style="display:none"':"")+"></div>");s.appendChild(r),t.footer=[n.footer.add_menu(cnst.dom('<span class="'+pref.script_prefix+'_footer"></span>'))];var i=this.headline_prep_summary(cnst.dom("<div></div>"),r,t.footer[0],cnst.dom('<a class="'+pref.script_prefix+'_button" name="'+(a?"SHOW_T":"HIDE_T")+'" data-trav="Pn" data-str="'+(a?'[▲]">[▼]':'[▼]">[▲]')+"</a>"));t.pn.appendChild(i),t.pn.appendChild(s)}return t.pn.lastChild.appendChild(e)},headline_separate:function(e,t){if(e.isShown>=3)return e.pn.lastChild.firstChild===t&&this.headline_prep_summary(e.pn.firstChild,e.pn.lastChild.childNodes[1]),e.pn.lastChild.removeChild(t);if(2==e.isShown){var n=e.pn.lastChild,r=n.firstChild===t?1:0,a=1===r?n.lastChild:n.firstChild;e.pn.parentNode&&e.pn.parentNode.replaceChild(a,e.pn),e.pn=e.tgt_ths[r][0]=a}return t},headline_prep_summary:function(e,t,n,r){var a,s=pref.script_prefix+"_footer",i=n||e.getElementsByClassName(s)[0],o=r||i.nextSibling;if(!n)for(;a=e.firstChild;)e.removeChild(a);for(var l=0;a=t.childNodes[l++];)e.appendChild(a.classList&&a.classList.contains(s)?(e.appendChild(i),o):a.cloneNode(!0));return e},headline_reorder:function(e,t,n,r){t.pn.childNodes[1].insertBefore(e,t.pn.childNodes[1].childNodes[r]||null),0==r&&this.headline_prep_summary(t.pn.firstChild,e)}},site2.common={absorb_children:function(e){for(var t=document.createElement("div");0!=e.childNodes.length;)t.appendChild(e.childNodes[0]);return e.appendChild(t),t},disgorge_children:function(e){for(;0!=e.childNodes.length;)e.parentNode.appendChild(e.childNodes[0]);e.parentNode.removeChild(e)},remove_by_classname:function(e,t,n,r){void 0===n&&(n=0);for(var a=e.getElementsByClassName(t),s=a.length-1-n;s>=0;s--)r&&a[s].nextSibling&&"BR"===a[s].nextSibling.tagName&&a[s].parentNode.removeChild(a[s].nextSibling),a[s].parentNode.removeChild(a[s])},remove_by_tagname:function(e,t,n){void 0===n&&(n=0);for(var r=e.getElementsByTagName(t),a=r.length-1-n;a>=0;a--)r[a].parentNode.removeChild(r[a])},remove_by_attribute:function(e,t,n){for(var r=e.length-1;r>=0;r--)for(var a=e[r].childNodes.length-1;a>=0;a--)e[r].childNodes[a].getAttribute&&e[r].childNodes[a].getAttribute(t)&&e[r].childNodes[a].getAttribute(t).search(n)!=-1&&e[r].removeChild(e[r].childNodes[a])},remove_attribute:function(e,t){for(var n=e.getElementsByTagName("*"),r=n.length-1;r>=0;r--)n[r].getAttribute&&n[r].getAttribute(t)&&n[r].removeAttribute(t)},add_attribute_by_classname:function(e,t,n,r){for(var a=e.getElementsByClassName(t),s=a.length-1;s>=0;s--)a[s].setAttribute(n,r)},add_attribute_by_tagname:function(e,t,n,r){for(var a=e.getElementsByTagName(t),s=a.length-1;s>=0;s--)a[s].setAttribute(n,r)},add_attribute_by_attribute:function(e,t,n,r,a){for(var s=e.length-1;s>=0;s--)for(var i=e[s].childNodes.length-1;i>=0;i--)e[s].childNodes[i].getAttribute&&e[s].childNodes[i].getAttribute(t)&&e[s].childNodes[i].getAttribute(t).search(n)!=-1&&e[s].setAttribute(r,a)},move_up_and_delete_parent:function(e){for(var t=0;t<e.length;t++){var n=e[t].parentNode,r=n.parentNode;r.insertBefore(e[t],n),r.removeChild(n)}},remove_last_hrs_and_brs:function(e){for(;;){var t=e.childNodes[e.childNodes.length-1];if("HR"!==t.tagName&&"BR"!==t.tagName)break;e.removeChild(t)}},remove_brs:function(e){for(var t=e.getElementsByTagName("br"),n=t.length-1;n>=0;n--)t[n].parentNode.removeChild(t[n])},remove_double_br:function(e){for(var t=e.getElementsByTagName("*"),n=t.length-2;n>=0;n--)"<br>"===t[n].outerHTML&&t[n].nextSibling&&"BR"===t[n].nextSibling.tagName&&t[n].parentNode.removeChild(t[n].nextSibling)},remove_double_tags:function(e,t){for(var n=e.getElementsByTagName("*"),r=n.length-2;r>=0;r--)n[r].tagName===t&&n[r+1].tagName===t&&n[r+1].parentNode.removeChild(n[r+1])},change_utc_to_local:function(e){var t=new Date(e);return t.toLocaleString().replace(/\ /," ("+t.toString().replace(/\ .*/,"")+") ")}};var site4={parse_funcs_getters:{get no(){return this.exe_sub("no")},get key(){return this.exe_sub("key")},get time_bumped(){return this.exe_sub("time_bumped")},get nof_posts(){return this.exe_sub("nof_posts")},get nof_files(){return this.exe_sub("nof_files")},get time_created(){return this.exe_sub("time_created")},get posts(){return this.exe_sub("posts")},get sub(){return this.exe_sub("sub")},get name(){return this.exe_sub("name")},get com(){return this.exe_sub("com")},get flag(){return this.exe_sub("flag")},get flags(){return this.exe_sub("flags")},get footer(){return this.exe_sub("footer")},get sticky(){return this.exe_sub("sticky")},get time(){return this.exe_sub("time")},get time_posted(){return this.exe_sub("time_posted")},get tn_as(){return this.exe_sub2("tn_as")},get tn_imgs(){return this.exe_sub2("tn_imgs")},get op_img_url(){return this.exe_sub("op_img_url")},get txt(){return this.exe_sub("txt")},get time_tu(){return this.time*this.parse_funcs.time_unit},get time_tu1000(){return this.time},get lth(){return liveTag.mems[this.domain][this.board][this.no]},get type_mimic(){return this.type_source},get key_op(){return this.domain+this.board+(this.resto||this.op||this.no)}}};site4.parse_funcs_on_demand={exe_sub:function(e){return Object.defineProperty(this,e,{value:this.parse_funcs[e](this),enumerable:!0,configurable:!0,writable:!0})[e]},exe_sub2:function(e){return this.parse_funcs_html[e](this)},__proto__:site4.parse_funcs_getters},site4.parse_funcs_on_demand_debug={exe_sub:function(e){try{return Object.defineProperty(this,e,{value:this.parse_funcs[e](this),enumerable:!0,configurable:!0,writable:!0})[e]}catch(t){console.log("parse_error: "+this.key+", "+this.type_parse+", "+e),console.trace(),console.log(this)}},exe_sub2:function(e){try{return this.parse_funcs_html[e](this)}catch(t){console.log("parse_error: "+this.key+", "+this.type_parse+", "+e),console.trace(),console.log(this)}},__proto__:site4.parse_funcs_getters},site4.parse_funcs_no_cache={exe_sub:function(e){return this.parse_funcs[e](this)},exe_sub2:function(e){return this.parse_funcs_html[e](this)},__proto__:site4.parse_funcs_getters},site4.parse_funcs_one_time={get posts(){return Object.defineProperty(this,"posts",{value:this.parse_funcs.posts(this),enumerable:!0,configurable:!0,writable:!0}).posts},exe_sub:function(e){return this.parse_funcs[e](this)},exe_sub2:function(e){return this.parse_funcs_html[e](this)},__proto__:site4.parse_funcs_getters},site4.parse_funcs_html={get id(){return this.exe_sub("id")},get pn_id(){return this.exe_sub("pn_id")},get pn_name(){return this.exe_sub("pn_name")},get nofFiles(){return this.exe_sub("nofFiles")},__proto__:pref.debug_mode.parse_error?site4.parse_funcs_on_demand_debug:site4.parse_funcs_on_demand},pref.features.domains["8chan"]&&(site2["8chan"]={nickname:"8chan",domain_url:"8kun.top",domain_url_image:"media.8kun.top",home:site.protocol+"//8kun.top"+(brwsr.ff?"/faq.html":"/favicon.ico"),protocol:site.protocol,features:{uip_tracker:!0},utilize_boards_json:!0,check_func:function(){var e=window.location.href;if(e.indexOf(this.domain_url)!==-1){if(this.home=site.protocol+"//"+this.domain_url+this.home.substr(this.home.lastIndexOf("/")),site.whereami=document.title.indexOf("404 - Page Not Found")!=-1?"404":e.search(/8kun\.top\/?$/)!=-1?"frame":e.search(/catalog\.html/)!=-1?"catalog":e.search(/res\/[0-9\+]*\.html/)!=-1?"thread":e.search(/8kun\.top\/index/)!=-1?"boards":e.search(/\/$|(index|[0-9]+)\.html|\/#all$/)!=-1?"page":e.search(/boards.html/)!=-1?"boards":"other",site.config(site2["8chan"].domain_url,"8chan"),site.header_height=function(){var e=document.getElementsByClassName("boardlist")[0];return e?e.offsetHeight:0},site.postform=document.getElementsByTagName("form")[0],site.postform&&this.postform_prep(),site.max_page=site2["8chan"].max_page(site.board),site.catalog=e.search(/catalog\.html/)!=-1,site.embed_to="thread"===site.whereami||"page"===site.whereami?{top:function(){return document.getElementsByName("postcontrols")[0]},bottom:function(){return document.getElementsByClassName("boardlist bottom")[0]}}:"catalog"===site.whereami?{top:function(){return document.getElementsByClassName("thumbnail")[0].nextSibling},bottom:function(){return document.getElementsByTagName("footer")[0]}}:{},site.components.boardlist&&(site.components.boardlist.style.zIndex=0),"boards"===site.whereami){var t=document.getElementById("search-form").parentNode,n=t.parentNode.insertBefore(document.createElement("button"),t);n.textContent="TagSearch";var r=document.createElement("div");r.innerHTML=pref_func.format_html_str('<BTN"tagSearch.genResult,Generate Result"><IC"tagSearch.auto">Auto, &lt;= <ITB4"tagSearch.th_b">boards or <ITB4"tagSearch.th_t">tags, Now: <span></span>');var a=r.lastChild;pref_func.apply_prep(r,!1),n.onclick=function(e){pref.catalog.board.board_tags=!0,pref_func.settings.onchange_funcs["tag.generate_caller"]("tag.scan");var a=liveTag.popup_filter.embed(r);a&&(n.parentNode.insertBefore(a,n.nextSibling),n.textContent="Hide original search",n.onclick=function(e){t.style.display="none",e.target.style.display="none"})};var s=document.getElementsByClassName("board-list-tbody")[0],i=function(e,t){function n(e){var t=e.slice(1);return'<a class="tag-link" href="/boards.php?tags='+t+'">'+t+"</a>"}var r=liveTag.tags_array_old.filter(function(e){return liveTag.tags[e.key].pn});if(0==r.length)return void(a.textContent="none");for(var i={},o=[],l=0;l<r.length;l++)for(var p=Object.keys(liveTag.tags[r[l].key].mems_boards()),c=0;c<p.length;c++){var _=p[c].replace(/^8chan/,"");void 0===i[_]&&(o[o.length]=_,i[_]=null)}if(
//            var bds = tags.map(function(v){return Object.keys(liveTag.tags[v.key].mems_boards()).map(function(v){return v.replace(/^8chan/,'');}).filter(function(bd){return bds_check[bd]===undefined && (bds_check[bd]=null || true);});}).reduce(function(a,c){return a.concat(c);});
a.textContent=o.length+" board"+(o.length>=2?"s":"")+", "+r.length+" tag"+(r.length>=2?"s":""),!t||site3["8chan"].boards&&!(o.length>pref.tagSearch.th_b&&r.length>pref.tagSearch.th_t)){var d=site3["8chan"].bds;d||(d={},site3["8chan"].boards.forEach(function(e){d["/"+e.uri+"/"]=e}),site3["8chan"].bds=d),s.innerHTML=o.map(function(e){return"/"!==e[0]?"":'<tr><td class="board-uri"><p class="board-cell"><a href="'+e+'">'+e+"</a>"+(1==d[e].sfw?'<i class="fa fa-briefcase board-sfw" title="SFW"></i>':"")+'</p></td><td class="board-title"><p class="board-cell" title="Created ">'+d[e].title+'</p></td><td class="board-pph"><p class="board-cell board-pph-desc" title="'+d[e].pph+" made in the last hour, "+d[e].pph_average+' on average">'+d[e].pph+'</p></td><td class="board-unique"><p class="board-cell">'+d[e].active+'</p></td><td class="board-tags"><p class="board-cell">'+d[e].tags.map(n).join("")+'</p></td><td class="board-max"><p class="board-cell">'+d[e].max+"</p></td></tr>"}).join("")}};setTimeout(function(){liveTag.popup_filter.onchange_funcs["tagSearch.genResult"]=i,liveTag.sub_tagSearch=function(){pref.tagSearch.auto&&i(0,!0)}},0)}return!0}return brwsr.ff||(this.protocol="https:",this.home=this.protocol+"//"+this.domain_url+this.home.substr(this.home.lastIndexOf("/"))),!1},postprocess_board:function(e){for(var t=0;t<e.length;t++)if(e[t].max>0){var n=liveTag.mems.init({domain:this.nickname,board:"/"+e[t].uri+"/"});n.o=t,e[t].pages&&!n.pgs&&(n.pgs=e[t].pages),Object.defineProperty(n,"max",{value:parseInt(e[t].max,10),writable:!0}),void 0===n.read_max&&Object.defineProperty(n,"read_max",{value:0,writable:!0}),e[t].tags&&0!=e[t].tags.length&&liveTag.postprocess_board_add_btag(e[t].tags,n)}},catalog_frame_prep:function(e){document.getElementsByTagName("header")[0].style.display="none",document.getElementsByClassName("footer")[0].style.display="none";var t=document.getElementsByClassName("menuCol")[0];t.firstChild.style.display="none";var n=document.getElementsByClassName("bodyCol")[0];n.firstChild.style.display="none",t.insertBefore(e,t.firstChild);this.catalog_native_frame_prep_frame(n,n.firstChild);this.catalog_embed_prep(e)},prep_own_posts_event:function(e){e&&"own_posts"===e.key&&site2["8chan"].prep_own_posts(),"8chan"===window.name&&send_message("parent",["OWN_POSTS",window.name,site3[window.name].own_posts])},prep_own_posts:function(){var e={},t=JSON.parse(localStorage.getItem("own_posts"));for(var n in t){var r="/"+n+"/";e[r]={};for(var a=0;a<t[n].length;a++)e[r][t[n][a]]=null}site3["8chan"].own_posts=e},parse_funcs:{catalog_html:{before_test:["ths",":ITER",":ALL","ths",["key","time_bumped","nof_posts","nof_files"]],after_test:["time_created","sub","name","com","footer","sticky","format"],full_hier:["ths",":ITER",":ALL","ths",["key","time_bumped","nof_posts","nof_files","time_created","sub","name","com","footer","sticky","format"]],ths:function(e){var t=e.pn.getElementsByClassName("mix"),n=[];if(pref.test_mode[0])for(var r=0;r<t.length;r++)"DIV"===t[r].tagName&&(n[n.length]={pn:t[r],page:Math.floor(r/15)+"."+r%15});else{for(var r=0;r<t.length;r++)"DIV"===t[r].tagName&&(n[n.length]=t[r]);n=this.ths_array(e,n)}return n},th_init:function(e){var t=e.pn.getElementsByTagName("div")[0];t.className=t.className.replace(/grid\-size\-[a-z]*/,"grid-size-"+site2["8chan"].catalog_native_size)},no:function(e){return parseInt(e.pn.getAttribute("data-id"),10)},sticky:function(e){return"true"===e.pn.getAttribute("data-sticky")},posts:"DEFAULT.catalog_html",proto:"vichan.catalog_html"},catalog_json:{get_op_src:"thread_json",proto:"vichan.catalog_json"},page_html:{ths:function(e){var t=this.ths_array(e,e.pn.getElementsByClassName("thread"));if("page"!==site.whereami||!pref.catalog.embed_page)for(var n=0;n<t.length;n++)t[n].pn.removeAttribute("class");return t},filename:"thread_html",proto:"vichan.page_html"},page_json:{has_posts:!0,proto:"vichan.page_json"},thread_html:{filename:function(e){var t=[],n=(e.pn.classList.contains("op")?e.pn.parentNode:e.pn).getElementsByClassName("files")[0];if(n)for(var r=n.getElementsByClassName("postfilename"),a=0;a<r.length;a++)t[a]=r[a].textContent;if(t.length>1){e.extra_files=[];for(var a=1;a<t.length;a++)e.extra_files[a-1]={filename:t[a],__proto__:e.__proto__}}return t[0]},get_op_src:"thread_json",proto:"vichan.thread_html"},thread_json:{get_op_src:function(e){return e.op_img_url.replace("thumb","src").replace(".jpg",e.ext)},proto:"vichan.thread_json"}},update_posts_remove:function(e,t,n){n.removeChild(e.posts[t].pn.nextSibling),n.removeChild(e.posts[t].pn)},update_posts_insert:function(e,t,n,r,a){var s,i=r<t.length?t[r].pn:(s=t[t.length-1].pn.nextSibling)&&s.nextSibling;e[n].pn||(e[n].pn=this.post_json2html(e[n],e[n].board)),a.insertBefore(e[n].pn,i),a.insertBefore(document.createElement("br"),i)},catalog_json2html3_thumbnail:function(e,t){return".jpg"===e.ext||".png"===e.ext||".jpeg"===e.ext||".gif"===e.ext||".webm"===e.ext||".mp4"===e.ext?this.protocol+"//"+(64!=e.tim.length?this.domain_url+t+"thumb/"+e.tim+(".gif"===e.ext?".gif":".jpg"):this.domain_url_image+"/file_store/thumb/"+e.tim+(".gif"===e.ext?".gif":".png"===e.ext?".png":".jpeg"===e.ext?".jpeg":".jpg")):e.embed?("//"==e.embed.slice(0,2)?"https:":"")+e.embed.replace(/.*src="/,"").replace(/".*/,""):".swf"===e.ext?"/static/file.png":""},short_link:function(){return""},favicon:{__proto__:site2.DEFAULT.favicon,none:"/favicon.ico",reply:"png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAQElEQVR42mNgGEbg/5n/GJgYORQFDQ0IjK4BmxxWzehsQnJYBdFtxCWH1QBcrkKWw2sAWS6gKAwojgWqpIORDQBVkjfW5KYpFQAAAABJRU5ErkJggg==",reply_to_me:"png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAWUlEQVR42mNgAIH/Z/4zNDRgYpA4UQBqADIYZAaAaHRMtAEwjB42cEPQFaCzCclhFcQWK9jk0A1A8QJW2xgYiDeAJBdQFAbYAhLdRryxgByVuOKaYDoY2QAAcHCIXLRHYMUAAAAASUVORK5CYII="},proto:"vichan"},site2["8chan_live"]={parse_funcs:{thread_html:{posts:function(e){return this.posts_array(e,e.pn.querySelectorAll(":scope>.post.reply"))},proto:"8chan.thread_html"}},proto:"8chan"}),(pref.features.domains["8chan"]||pref.features.domains.lain||pref.features.domains.lainjp)&&(site2.vichan={components:{boardlist:".boardlist",postform_comment:['textarea[name="body"]',0],postform_comment2:['textarea[name="body"]',1],postform_submit:['input[name="post"]',0],postform_submit2:['input[name="post"]',1]},general_event_handler:function(){var e={thread:{get_mark:function(e,t){for(;e&&e!==cataLog.parent;)if("BR"!==e.tagName&&e.classList){if(e.classList.contains("post"))return e;if(e.classList.contains("postcontainer"))return e.getElementsByClassName("post")[0];if(e.parentNode&&e.parentNode.id&&e.parentNode.id.search(/^thread/)!=-1){if(e=e.previousSibling)continue;break}if(e.id&&e.id.search(/^thread/)!=-1)break;e=e.parentNode}else e=e.previousSibling||e.parentNode;return this.get_mark_from_height(t)},get_mark_from_height:function(e){return this.__proto__.get_mark_from_height(e,document.getElementsByClassName("post"))},image_hover_check_mode:function(e){return e.parentNode.parentNode.classList.contains("file")?"page":"catalog"},getID:function(e){return e.classList.contains("poster_id")&&e.textContent},__proto__:site2.DEFAULT.general_event_handler.common}};return e.page={add_mouseover:pref.test_mode[68],mouseover:function(e){var t=e.target;"A"===t.tagName&&pref[cataLog.embed_mode].popup_truncated&&"toolong"===t.parentNode.className&&site2.DEFAULT.popups_posts.over(e)},__proto__:e.thread},e.catalog=Object.create(e.thread),e}(),boards_sel_from_tags:function(){for(var e=document.getElementsByClassName("board-list-tbody")[0],t="SELECTED_BOARDS,",n=0;n<e.childNodes.length;n++)"none"!==e.childNodes[n].style.display&&(t=t+"8chan"+e.childNodes[n].getElementsByClassName("board-uri")[0].getElementsByTagName("a")[0].getAttribute("href")+",");return t+"\n"},get_next_image:function(e,t){var n=Array.prototype.slice.call(cataLog.parent.getElementsByClassName("post-image")).filter(function(e){return".webm"!==e.src.substr(-5,5)});return site2.DEFAULT.get_next_image(e,t,n)},modify_thread_link:function(e){var t=e.getElementsByClassName("post op");if(0==t.length)return[];var n=[];t=t[0].getElementsByTagName("a");for(var r=t.length-1;r>=0;r--)if("[Reply]"==t[r].innerHTML||"[Last 50 Posts]"==t[r].innerHTML){var a=t[r].getAttribute("href");a&&(n.push([t[r],a]),t[r].removeAttribute("href"))}return n},catalog_threads_in_page:function(e){for(var t={domain:site.nickname,pn:e},n=this.parse_funcs.page_html.ths(t),r=0;r<n.length;r++)n[r]=n[r].pn;return n},remove_posts:function(e,t){site2.common.remove_by_classname(e,"post reply",t,!0)},remove_files_info:function(e){site2.common.remove_by_classname(e,"fileinfo"),site2.common.move_up_and_delete_parent(e.getElementsByClassName("post-image"))},postform_rules:null,thread_keyword:"res",max_page:function(){return 15},make_url4:function(e){var t=this.protocol+"//"+this.domain_url+e[1];return"page_html"===e[3]?[t+(0!=e[2]?parseInt(e[2],10)+1:"index")+".html","html"]:"page_json"===e[3]?[t+parseInt(e[2],10)+".json","json"]:"catalog_json"===e[3]?[t+"catalog.json","json"]:"catalog_html"===e[3]?[t+"catalog.html","html"]:"thread_html"===e[3]?[t+"res/"+e[2]+".html","html"]:"thread_json"===e[3]?[t+"res/"+e[2]+".json","json"]:void 0},url_boards_json:function(){return[site2["8chan"].protocol+"//"+site2["8chan"].domain_url+"/boards.json","json"]},get_ops:function(e){for(var t=e.getElementsByClassName("post op"),n=[],r=0;r<t.length;r++)n.push(parseInt(t[r].id.substring(3),10));return n},get_posts:function(e){for(var t=[],n=e.getElementsByClassName("post_no"),r=0;r<n.length;r++)n[r].id&&t.push(parseInt(n[r].id.substr(8),10));return t},get_post_offsetTop:function(e,t){return e.getElementsByClassName("post")[t].offsetTop},get_icon:function(e,t,n,r){return"sticky"===n?e.getElementsByClassName("fa-thumb-tack")[0]:null},add_icon:function(e,t,n,r){var a,s="sticky"===n?this.make_tack():this.make_showAlways();if("catalog"===t||"headline"===t)a=e.getElementsByClassName("threadIcons")[0]||(a="catalog"===t?e.firstElementChild:e.getElementsByClassName(pref.script_prefix+"_footer")[0].parentNode,a.insertBefore(cnst.dom('<div class="threadIcons"'+("catalog"===t?'style="position:absolute"':"")+"></div>"),a.firstChild)),a.appendChild(s);else{var i=e.getElementsByClassName("op")[0];a=i.getElementsByClassName("mentioned")[0]||i.getElementsByClassName("post_no")[1].nextSibling,a.parentNode.insertBefore(s,a)}return s},favicon:{__proto__:site2.DEFAULT.favicon,none:"/favicon.ico",reply:"png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAQElEQVR42mNgGEbg/5n/GJgYORQFDQ0IjK4BmxxWzehsQnJYBdFtxCWH1QBcrkKWw2sAWS6gKAwojgWqpIORDQBVkjfW5KYpFQAAAABJRU5ErkJggg==",reply_to_me:"png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAWUlEQVR42mNgAIH/Z/4zNDRgYpA4UQBqADIYZAaAaHRMtAEwjB42cEPQFaCzCclhFcQWK9jk0A1A8QJW2xgYiDeAJBdQFAbYAhLdRryxgByVuOKaYDoY2QAAcHCIXLRHYMUAAAAASUVORK5CYII="},time_revised_check:function(e){return e>300},format_thread_layout:function(e){site2.common.add_attribute_by_tagname(e,"img","style","margin:0px"),site2.common.add_attribute_by_tagname(e,"iframe","style","margin:0px"),site2.common.add_attribute_by_classname(e,"post","style","padding:0px"),site2.common.add_attribute_by_classname(e,"intro","style","margin:0px"),site2.common.add_attribute_by_classname(e,"body","style","margin:12px 5px")},format_thread_contents:function(e){site2.common.remove_by_classname(e,"delete"),site2.common.remove_by_classname(e,"omitted")},localtime:function(e){for(var t=e.getElementsByTagName("time"),n=0;n<t.length;n++)t[n].textContent=site2.common.change_utc_to_local(t[n].getAttribute("datetime"))},format_remove_tn_area_size:function(e){for(var t=e.getElementsByClassName("file"),n=0;n<t.length;n++){var r=t[n].getAttribute("style");r&&(r=(r?r+";":"")+"float:left;",r.indexOf("width")!=-1&&(r=r.replace(/width:[^;]*(;|$)/,"")),r.indexOf("height")!=-1&&(r=r.replace(/height:[^;]*(;|$)/,"")),t[n].setAttribute("style",r))}},get_owners_recommendation:function(){if(document.getElementsByClassName("blotter")[0]){or_str=document.getElementsByClassName("blotter")[0][brwsr.innerText];var e="Recommendation: ",t=or_str.indexOf(e);if(t!=-1)return or_str.substr(t+e.length)}return""},get_json_url_catalog:function(e){return site2["8chan"].protocol+"//"+site2["8chan"].domain_url+e+"catalog.json"},thread2search_obj:function(e){function t(e){if(0!=e.length){for(var t=e[0].parentNode;t.classList.contains("post");)t=t.parentNode;for(var n=t.classList.contains("op")?-1:0,r=n>=0?e[0][brwsr.innerText]:"",a="",s=n+1;s<e.length;s++)a=a+e[s][brwsr.innerText]+"\n";return[r,a]}return["",""]}var n=t(e.getElementsByClassName("body")),r=t(e.getElementsByClassName("subject")),a=t(e.getElementsByClassName("name")),s=e.getElementsByClassName("files"),i=["",""];if(0!=s.length){for(var o=0;o<s.length;o++){var l=s[o].getElementsByClassName("unimportant");i[o]="";for(var p=0;p<l.length;p++)0!=l[p].getElementsByTagName("a").length&&(i[o]=i[o]+l[p].getElementsByTagName("a")[0][brwsr.innerText]+"\n"),0!=l[p].getElementsByTagName("span").length&&(i[o]=i[o]+l[p].getElementsByTagName("span")[0][brwsr.innerText]+"\n")}for(var o=2;o<i.length;o++)i[1]=i[1]+i[o]+"\n";s[0].parentNode!=e&&(i[1]=i[0]+"\n"+i[1],i[0]="")}return[n[0],r[0],a[0],i[0],n[1],r[1],a[1],i[1]]},parse_json_thread:function(e,t){for(var n={posts:[]},r={},a=0,s=document.getElementsByClassName("post"),i=0;i<s.length;i++){n.posts[i]={},n.posts[i].no=s[i].id.replace(/op_/,"").replace(/reply_/,"");var o=s[i].getElementsByClassName("poster_id")[0].textContent;n.posts[i].id=o,void 0===r[o]&&(a++,r[o]=1),n.posts[i].unique_ips=a}return n},uip_check:function(e){e(0,200,"")},uip_tgt_post:function(e){var t=document.getElementById("reply_"+e);return t?t:document.getElementById("op_"+e)},uip_post_num:function(e){return e.getElementsByClassName("intro")},catalog_native_prep:function(e,t,n){var r="catalog"===site.whereami?document.getElementsByClassName("threads")[0]:document.getElementsByName("postcontrols")[0];if(site2.DEFAULT.catalog_native_prep_sel(e,t,"catalog"===site.whereami?document.getElementById("sort_by"):null),"catalog"===site.whereami)t.style.display="inline",t.childNodes[3].style.display="inline";else if("page"===site.whereami){var a=document.getElementsByName("postcontrols")[0];if(pref.catalog_expand_with_hr)for(var s=a.childNodes.length-1;s>=0;s--)"HR"===a.childNodes[s].tagName&&a.childNodes[s].setAttribute("class",pref.script_prefix+"_hs");else for(var s=a.childNodes.length-1;s>=0;s--)"HR"===a.childNodes[s].tagName&&a.removeChild(a.childNodes[s]);a.parentNode.insertBefore(document.createElement("hr"),a.nextSibling)}r.parentNode.insertBefore(t,r)},catalog_native_size:document.getElementById("image_size")?document.getElementById("image_size").value:"small",catalog_native_size_changed:function(){site2["8chan"].catalog_native_size=this.value},catalog_get_native_area:function(){return"catalog"===site.whereami?document.getElementById("Grid"):document.getElementsByName("postcontrols")[0]},parse_funcs:{catalog_html:{ths:function(e){return this.ths_array(e,e.pn.getElementsByClassName("mix"))},no:function(e){return parseInt(e.pn.getElementsByTagName("img")[0].id.substr(4),10)},time_bumped:function(e){return 1e3*parseInt(e.pn.getAttribute("data-bump"),10)},time:function(e){return parseInt(e.pn.getAttribute("data-time"),10)},time_created:function(e){return 1e3*e.time},nof_posts:function(e){return parseInt(e.pn.getAttribute("data-reply"),10)+1},nof_files:function(e){return parseInt(e.pn.getElementsByTagName("strong")[0].textContent.replace(/.*I: */,""),10)+1},key:function(e){return pref.test_mode[0]&&(e.hasOwnProperty("no")||Object.defineProperty(e,"no",{value:this.no(e),enumerable:!0,configurable:!0,writable:!0})),e.domain+e.board+e.no},sub:"DEFAULT.post_html",name:function(e){return e.pn.getElementsByTagName("img")[0].getAttribute("data-name")},com:function(e){return e.pn.getElementsByClassName("replies")[0].innerHTML.replace(/\s*<strong>[^<]*<\/strong>\s*(<br>)*/,"").replace(/\s*$/,"")},type_com:"html",footer:function(e){return e.pn.getElementsByTagName("strong")[0]},sticky:function(e){return null},op_img_url:function(e){var t=e.pn.getElementsByTagName("img")[0];return t?t.getAttribute("src"):void 0},dynamic_image_hover:!0,missing_info:2,img2src:function(e){var t=this.get_lth_from_node(e);if(!t)return null;var n=e.src;return t.th&&t.th.ext?n=n.replace(/thumb/,"src").replace(/.[^\.]*$/,t.th.ext):t.th.missing_info&&scan.scan_ui("image_hover",{tgts:[t.domain+t.board+"j0"],options:{callback:function(){cataLog.image_hover_reentry(e)},priority:6}}),n},get_op_src:"thread_json",time_unit:1e3},catalog_json:{before_test:["ths",":ITER",":ALL","ths",["key","time_bumped","nof_posts","nof_files"]],after_test:["time_created","pn","footer"],full_hier:["ths",":ITER",":ALL","ths",["key","time_bumped","nof_posts","nof_files","pn","footer"]],ths:"DEFAULT.catalog_json",time_bumped:function(e){return 1e3*e.last_modified},time_created:function(e){return 1e3*e.time},nof_posts:function(e){return e.replies+1},nof_files:function(e){return e.images+e.omitted_images},key:function(e){return e.domain+e.board+e.no},sub:function(e){return e.hasOwnProperty("sub")?e.sub:""},name:function(e){return e.hasOwnProperty("name")?e.name:""},com:function(e){return e.hasOwnProperty("com")?e.com:""},op_img_url:"DEFAULT.common",missing_info:1,get_op_src:"thread_json",time_unit:1e3,type_com:"html",posts:"DEFAULT.catalog_json",posts_full:null,get_max_page:function(e){return e.length},proto:"catalog_html"},page_json:{has_posts:!0,nof_posts:"DEFAULT.thread_json",nof_files:function(e){return e.posts[0].images+e.posts[0].omitted_images},ths:"DEFAULT.page_json",proto:"thread_json"},page_html:{before_test:["ths",":ITER",":ALL","ths",["key","time_bumped","nof_posts","nof_files"]],after_test:["time_created",":ITER",":ALL","posts",["sub","name","com","flag"],":ITER",":GALL","posts",["flags","flag"]],before_test_post:["posts",":ITER",":FL","posts",["time"],"html_org","footer"],ths:function(e){return this.ths_array(e,e.pn.querySelectorAll("div[id^=thread_]"))},th_init:function(e){"page"===site.whereami&&pref.catalog.embed_page||e.pn.removeAttribute("class")},no:"post_html",time:function(e){var t=e.pn.getElementsByTagName("time")[0];return t?Date.parse(t.getAttribute("datetime"))/1e3:void 0},time_unit:1e3,time_bumped:function(e){for(var t=e.posts.length;--t>=0;){var n=e.posts[t].pn.getElementsByClassName("email")[0];if(!n||"mailto:sage"!==n.href)return e.posts[t].time_tu}},time_created:function(e){return pref.test_mode[0]&&(e.hasOwnProperty("posts")||this.entry(e,this.before_test_post)),e.posts[0].time},nof_posts:function(e){var t=e.pn.getElementsByClassName("post").length,n=e.pn.getElementsByClassName("fileinfo").length,r=e.pn.getElementsByClassName("omitted")[0];if(r){var a=r.childNodes[0].textContent.replace(/\n/g,"");t+=parseInt(a.replace(/\ post.*/,""),10)||0,n+=parseInt("0"+a.replace(/\ image.*/,"").replace(/[^\ ]*\ /g,""),10)||0}return Object.defineProperty(e,"nof_files",{value:n,enumerable:!0,configurable:!0,writable:!0}),t},nof_files:function(e){return e.hasOwnProperty("nof_posts")||this.nof_posts(e),e.nof_files},key:function(e){return pref.test_mode[0]&&(e.hasOwnProperty("no")||Object.defineProperty(e,"no",{value:this.no(e),enumerable:!0,configurable:!0,writable:!0})),e.domain+e.board+e.no},sub:"DEFAULT.post_html",com:function(e){var t=e.pn.getElementsByClassName("body")[0];return t?t.innerHTML:""},type_com:"html",footer:function(e){return this.insert_footer4(e.pn.getElementsByClassName("post op")[0])},sticky:function(e){return 0!=e.pn.getElementsByClassName("fa-thumb-tack").length},flag:"post_html",op_img_url:function(e){var t=e.pn.getElementsByTagName("img");if(t.length>=2){e.op_img_url2=[];for(var n=1;n<t.length;n++){var r=t[n].getAttribute("src");r&&(e.op_img_url2[e.op_img_url2.length]=r)}}return t&&t[0]?t[0].getAttribute("src"):void 0},tn_as:function(e){return e.tn_imgs},tn_imgs:function(e){var t=[],n=(e.pn.classList.contains("op")?e.pn.parentNode:e.pn).getElementsByClassName("files")[0];if(n){n=n.getElementsByClassName("file");for(var r=0;r<n.length;r++){var a=n[r].getElementsByTagName("img")[0]||n[r].getElementsByTagName("video")[0];a&&(t[t.length]=a)}}return t},get_thread_links:function(e){for(var t=[],n=e.pn.getElementsByClassName("post op")[0].getElementsByTagName("a"),r=0;r<n.length;r++)"[Reply]"===n[r].textContent&&t.unshift(n[r]),"[Last 50 Posts]"===n[r].textContent&&t.push(n[r]),n[r].classList.contains(pref.script_prefix+"_link")&&t.push(n[r]);return t},get_omitted_info:function(e){return e.pn.getElementsByClassName("omitted")[0]},set_omitted_info:function(e,t){e.pn.lastChild.appendChild(t)},replace_omitted_info2:function(e,t){e.childNodes[0].textContent=t?t.childNodes[0].textContent:""},filename:"thread_html",get_op_src:"thread_json",id:"DEFAULT.thread_html",country:"DEFAULT.thread_html",trip:"DEFAULT.thread_html",flag:"DEFAULT.thread_html",name:"DEFAULT.thread_html",pn_name:"post_html"},thread_html:{after_test:["time_created",":ITER",":FLx","posts",["sub","name","com","flag"],":ITER",":GFLx","posts",["flags","flag"]],get_op_src:"thread_json",filename:function(e){var t=(e.pn.classList.contains("op")?e.pn.parentNode:e.pn).getElementsByClassName("files")[0];if(t){t=t.querySelectorAll(":scope>.file");for(var n=0;n<t.length;n++){var r=t[n].getElementsByTagName("a")[0];if(r){r=r.textContent,1===n&&(e.extra_files=[]),n>=1&&(e.extra_files[n-1]={domain:e.domain,board:e.board});var a=0===n?e:e.extra_files[n-1];a.filename="lain"===e.domain?t[n].getElementsByTagName("a")[1].getAttribute("download"):t[n].getElementsByClassName("postfilename")[0].textContent.replace(/\..*/,""),a.ext=r.substr(r.indexOf(".")),a.tim=r.substr(0,r.indexOf("."));var s="lainjp"!==e.domain?t[n].getElementsByClassName("details")[0].textContent.split(","):t[n].getElementsByClassName("unimportant")[0].textContent.split(",");a.w=parseInt(s[1].substr(0,s[1].indexOf("x")),10),a.h=parseInt(s[1].substr(s[1].indexOf("x")+1),10);var i=s[0].split(/\s/);i[1]="KB"===i[1]?1024:"MB"===i[1]?1048576:1,a.fsize=parseFloat(i[0].replace(/\(/,""))*i[1];var o=t[n].querySelector("img.post-image");o&&(a.tn_w=parseInt(o.style.width,10),a.tn_h=parseInt(o.style.height,10))}}}return t?e.filename:void 0},proto:"page_html"},thread_json:{nof_posts:function(e){return e.posts.length},nof_files:function(e){for(var t=0,n=1;n<e.posts.length;n++)e.posts[n].filename&&t++,e.posts[n].extra_files&&(t+=e.posts[n].extra_files.length);return t},add_op_img_url:site2.DEFAULT.parse_parts.add_op_img_url,get_op_src:function(e,t){return!e.ext&&e.missing_info&&scan.scan_ui("image_hover",{tgts:[e.domain+e.board+"j0"],options:{callback:function(){cataLog.image_hover_reentry(t)},priority:6}}),e.ext?e.op_img_url.replace("thumb","src").replace(".png",e.ext):t.src},pn_name:"post_html",proto:"DEFAULT.thread_json"},post_html:{com:"page_html",no:function(e){var t=e.pn.getAttribute("id");return t&&parseInt(t.substring(t.indexOf("_")+1),10)},name:function(e){return e.pn_name?e.pn_name.textContent:""},pn_name:function(e){return e.pn.getElementsByClassName("name")[0]},time_pn:function(e){return Date.parse(e.getElementsByTagName("time")[0].getAttribute("datetime"))},txt2com_spoiler_replace_txt:'<span class="spoiler">$1</span>',flag:function(e){return e.pn.getElementsByClassName("flag")[0]},pn_id:function(e){return e.pn.getElementsByClassName("poster_id")[0]},id:function(e){return e.pn_id?e.pn_id.textContent:void 0},time:"page_html",time_unit:1e3,proto:"DEFAULT.post_html"},post_json:{proto:"DEFAULT.post_json"},json_template:{get nofFiles(){return this.filename?this.extra_files?this.extra_files.length+1:1:0}}},update_posts_remove:function(e,t,n,r){var a=e.posts[t].pn;r&&a.parentNode===n?this.update_posts_insert_pack(a):a=a.parentNode,n.removeChild(a.nextSibling),n.removeChild(a)},update_posts_insert:function(e,t,n,r,a){var s=r<t.length?t[r].pn:null,i=s&&s.parentNode;i&&i!==a&&(s=i),r>=t.length&&(s=a.getElementsByClassName("clear")[0]),e[n].pn||(e[n].pn=this.post_json2html(e[n],e[n].board)),0===n&&this.update_posts_insert_pack(e[n].pn),0===r&&t[0]&&this.update_posts_insert_pack(t[0].pn);var o=0===r&&0===n?e[n].pn:this.post_container(e[n].pn,e[n].no);a.insertBefore(o,s),a.insertBefore(document.createElement("br"),s),0===n&&0===r&&this.update_posts_insert_unpack(e[n].pn)},update_posts0_class:function(e,t){site2.DEFAULT.update_posts0_class(e,t),this.update_posts_insert_pack_iter(e,t?function(e){e.classList.remove("CatChan_search_miss")}:function(e){e.classList.add("CatChan_search_miss")})},update_posts_insert_pack:function(e){this.update_posts_insert_pack_iter(e,function(t){e.insertBefore(t,e.firstChild)})},update_posts_insert_pack_iter:function(e,t){for(var n=e.previousSibling;n;){var r=n.previousSibling;if(n.classList&&(n.classList.contains(pref.script_prefix+"_footer")||n.classList.contains("files"))&&t(n),n.classList&&n.classList.contains("op"))break;n=r}},update_posts_insert_unpack:function(e){for(;;){var t=e.firstChild;if(!t||!t.classList||!t.classList.contains(pref.script_prefix+"_footer")&&!t.classList.contains("files"))break;e.parentNode.insertBefore(t,e)}},add_backlinks_bks:function(){var e=document.createElement("span");return e.setAttribute("class","mentioned unimportant"),function(){return e.cloneNode(!1)}}(),add_backlinks_add_1:function(){var e=document.createElement("a");return e.setAttribute("class","mentioned"),function(t,n){var r=e.cloneNode(!0);r.setAttribute("href",n[5]),r.textContent=n[4],r.onclick=this.backlink_onclick,t.appendChild(r)}}(),add_backlinks_bks_query:function(e){return e.getElementsByClassName("mentioned")[0]},add_backlinks_bks_append:function(e,t){var n=e.getElementsByClassName("post_no")[1],r=n.parentNode;do{n=n.nextSibling}while(n&&"I"===n.tagName);r.insertBefore(t,n)},popups_href2dbtp:function(e){var t=e.split("/"),n=t[t.length-1].substr(t[t.length-1].indexOf("#")+1),r=t[t.length-1].substr(0,t[t.length-1].indexOf("."))||"#"===e[0]&&site.no,a=t.length>=3?"/"+t[t.length-3]+"/":site.board;return[this.nickname,a,r,n]},link_dbtp2href:function(e){return e[1]+"res/"+e[2]+".html#"+e[3]},backlink_onclick:function(){highlightReply.call(this,parseInt(this.textContent.substr(2),10))},colorID:function(e){var t=e.getElementsByClassName("poster_id")[0];if(t){var n=t.textContent,r=parseInt(n.substr(0,2),16),a=parseInt(n.substr(2,2),16),s=parseInt(n.substr(4,2),16),i=r+a+s>384?0:255;t.setAttribute("style","padding: 0px 5px; border-radius: 8px; color: rgb("+i+","+i+","+i+"); background-color: rgb("+r+","+a+","+s+");")}},post_container:function(e,t){var n=document.createElement("div");return n.setAttribute("id","pc"+t),n.setAttribute("class","postcontainer"),n.innerHTML='<div class="sidearrows">&gt;&gt;</div>',n.appendChild(e),n},short_link:function(e,t,n,r,a){var s=common_func.fullname2dbt(e);return t>100?'<a href="'+s[1]+"res/"+s[2]+'+50.html" class="'+pref.script_prefix+'_link">'+r+"50"+a+"</a>":""},post_json2html:function(e,t,n,r){var a=document.createElement("div"),s=e.parse_funcs&&e.parse_funcs.time_unit||1,i=new Date((e.time||0)*s),o='<div class="post '+(n?"op":"reply")+'" id="reply_'+e.no+'" style="border: none"><p class="intro"><input type="checkbox" class="delete" name="delete_'+e.no+'" id="delete_'+e.no+'"><label for="delete_'+e.no+'">'+(e.sub?'<span class="subject">'+e.sub+" </span>":"")+(e.email?'<a class="email" href="mailto:'+e.email+'">':"")+'<span class="name">'+(e.name||"")+"</span>"+(e.trip?'<span class="trip">'+e.trip+"</span>":"")+(e.capcode?'<span class="capcode" style="color:orange;font-weight:bold">## '+e.capcode+"</span>":"")+(e.email?"</a> ":" ")+(e.country?'<img class="flag flag-'+e.country.toLowerCase()+'" src="/static/blank.gif" style="width:16px;height:11px;" alt="'+e.country_name+'" title="'+e.country_name+'"> ':" ")+'<time datetime="'+i.toISOString()+'">'+i.toLocaleString()+"</time></label>"+(e.id?'<span class="poster_id">'+e.id+"</span>":"")+'&nbsp;<a class="post_no" id="post_no_'+e.no+'">No.</a><a class="post_no">'+e.no+"</a>"+(n?'<a href="'+site2[e.domain].make_url4([e.domain,t,e.no,"thread_html"])[0]+'">[Reply]</a>'+(r?r:""):"")+"</p>";if(e.filename){if(o+='<div class="files">'+this.post_json2html_file(e,t,e.extra_files),e.extra_files)for(var l=0;l<e.extra_files.length;l++)o+=this.post_json2html_file(e.extra_files[l],t,!0);o+="</div>"}return o+='<div class="body">'+(e.com?e.com:"")+"</div></div>",a.innerHTML=o,a.childNodes[0]},post_pn2ce:function(e){return"body"===e.lastChild.className?e.lastChild:e.getElementsByClassName("body")[0]},post_json2html_file:function(e,t,n){var r=(.005+(e.fsize>1048576?e.fsize/1048576:e.fsize/1024)).toString();r=r.substr(0,r.indexOf(".")+3)+(e.fsize>1048576?" MB":" KB");var a=site2[e.domain].post_json2html_fname_server(e),s=site2[e.domain].post_json2html_fname(e),i=site2[e.domain].catalog_json2html3_src(e,t),o=site2[e.domain].catalog_json2html3_thumbnail(e,t);return'<div class="file'+(n?" multifile":"")+'"'+(n?' style="width:'+(e.tn_w+40)+'px"':"")+'><p class="fileinfo">File: <a href="'+i+'">'+a+'</a> <span class="details">('+r+", "+e.w+"x"+e.h+', <span class="postfilename">'+s+'</span>) </span></p><a href="'+i+'" target="_blank">'+(".webm"!==e.ext?'<img class="post-image" src="'+o+'" style="width: '+e.tn_w+"px; height: "+e.tn_h+'px; max-width: 98%;" alt=""'+(128===e.tn_w&&128===e.tn_h?"onerror=\"this.onerror=null;this.src='/static/spoiler.png';\"":"")+">":'<video class="post-image" src="'+i+'" style="width: '+e.tn_w+"px; height: "+e.tn_h+'px; max-width: 98%;">')+"</a></div>"},page_json2html3_skelton:function(e,t){var n=document.createElement("div");n.setAttribute("class","thread"),n.setAttribute("id","thread_"+e.no),n.setAttribute("data-board",e.board.slice(1,-1));var r=document.createElement("br");return r.setAttribute("class","clear"),n.appendChild(r),n.appendChild(document.createElement("hr")),t?[n,r]:n},page_json2html3:function(e,t,n,r,a){var s=this.page_json2html3_skelton(e,!0),i=s[0],o=s[1],l=this.post_json2html(e.posts&&e.posts[0]?e.posts[0]:e,e.board,!0,site2[e.domain].short_link(e.key,e.nof_posts,2,"[Last "," Posts]")),p=l.getElementsByClassName("files")[0];if(p&&i.insertBefore(p,o),t&&e.posts[0].pn&&(l=e.posts[0].pn.cloneNode(!0)),l.setAttribute("class","post op"),e.posts&&e.posts[0]&&e.posts[0].extra_files&&l.setAttribute("style","clear:both;"),i.insertBefore(l,o),e.posts[0].pn=l,e.posts){for(var c=1;c<e.posts.length;c++){var _=t&&e.posts[c].pn&&e.posts[c].pn.cloneNode(!0)||this.post_json2html(e.posts[c],e.board);i.insertBefore(this.post_container(_,e.posts[c].no),o),i.insertBefore(document.createElement("br"),o),e.posts[c].pn=_}a||this.page_json2html3_add_omitted_info(e,n,r)}return i},page_json2html3_replace_expander:function(e,t,n){var r=e[0].pn.getElementsByClassName("omitted")[0];r&&(r.childNodes.length>=3&&r.removeChild(r.childNodes[2]),r.childNodes.length>=2&&r.removeChild(r.childNodes[1]),r.appendChild(cnst.config_expander(n,t)))},page_json2html3_prep_omitted_info:function(e,t,n){var r=e.pn.getElementsByClassName("omitted")[0];return r||(r=document.createElement("span"),r.setAttribute("class","omitted"),r.innerHTML="dummy",e.pn.appendChild(r)),n&&r.appendChild(cnst.config_expander(t.key)),r.childNodes[0]},page_json2html3_set_omitted_info:function(e,t){return e<=0?"Showing all replies.":e+" post"+(1!==e?"s":"")+(t?" and "+t+" image repl"+(1===t?"y":"ies"):"")+" omitted. "},catalog_json2html3_thumbnail:function(e,t){return".jpg"===e.ext||".jpeg"===e.ext||".gif"===e.ext||".png"===e.ext?"https://"+this.domain_url+t+"thumb/"+e.tim+e.ext:""},catalog_json2html3_src:function(e,t){return".jpg"===e.ext||".jpeg"===e.ext||".gif"===e.ext||".png"===e.ext||".webm"===e.ext?"https://"+this.domain_url+t+"src/"+e.tim+e.ext:""},catalog_json2html3:function(e,t,n,r){var a=document.createElement("div");return a.setAttribute("class","mix"),a.setAttribute("style","display: inline-block;"),
a.innerHTML='<div class="thread grid-li grid-size-'+site2[site.nickname].catalog_native_size+'"><a href="'+site2[e.domain].make_url4([e.domain,e.board,e.no,"thread_html"])[0]+'"><img src="'+n+'" id="img-'+e.no+'" data-subject="'+e.sub+'" data-name="'+e.name+'" data-muhdifference="" data-last-reply="" data-last-subject="" data-last-name="" data-last-difference=""class="'+t+' thread-image" title="'+new Date(1e3*e.last_modified).toLocaleString()+" "+e.ext+'"></a><div class="replies"><strong>'+(r?" R: "+(e.nof_posts-1)+" / I: "+e.nof_files:"")+"</strong>"+(e.sub?'<p class="intro"><span class="subject">'+e.sub+"</span></p>":"<br>")+e.com+"</div></div>",a},catalog_from_json3:function(e,t){var n;return pref.test_mode[0]?(n={domain:"8chan",board:site.board,obj:e},this.parse_funcs.catalog_json.entry(n,this.parse_funcs.catalog_json.full_hier),n.ths):site2[this.nickname].wrap_to_parse.get(e,this.nickname,t,"catalog_json")},patch:{expand_thumbnail_inline_load:function(){var e=this.parentNode&&this.parentNode.parentNode;e&&e.classList&&e.classList.contains("multifile")&&e.style.width&&(this.setAttribute("data-originalWidth",e.style.width),e.style="")}},proto:"DEFAULT"}),pref.features.domains.KC&&(site2.KC={nickname:"KC",domain_url:"krautchan.net",components:{boardlist:".menu",postform_comment:"#postform_comment",postform_submit:"#postform_submit"},make_tack:function(){var e=document.createElement("img");return e.setAttribute("src","/images/sticky.gif"),e},boards_json:site2.DEFAULT.generate_boards_json([["b",15],["int",20],"vip","a","c","co","d","e","f","fb","fe","fit","jp","k","l","li",["m",5],"n","ng","p","ph","prog","sp","t",["trv",18],"tu","tv","v","w","we","wk","wp","z","zp","ft","r",["h",8],"s","bans","kc","rfk",["rvss",15]],10),check_func:function(){site2.KC.force_https||(site2.KC.protocol=site.protocol);var e=window.location.href;return e.search(/krautchan.net/)!=-1&&(site.whereami=document.head.innerHTML.indexOf("404 Not Found")!=-1?"404":e.search(/krautchan\.net\/?$/)!=-1?"frame":e.search(/catalog/)!=-1?"catalog":e.search(/thread/)!=-1?"thread":e.search(/\/$|(index|[0-9]+)\.html|\/#all$/)!=-1?"page":"other","page"!==site.whereami&&"thread"!==site.whereami||(this.components.boardlist="body > div:nth-child(3)",delete this.show_boardlist_physical_extract_func),site.config("krautchan.net","KC"),site.max_page=void 0==site2.KC.max_page_kc[site.board]?10:site2.KC.max_page_kc[site.board],"catalog"===site.whereami&&("/"===e[e.length-1]&&(e=e.substr(0,e.length-1)),site.board=e.substr(e.lastIndexOf("/"))+"/"),"frame"===site.whereami&&(site.root_body2=document.createElement("div"),site.embed_frame="main",site.embed_frame_win=main,navigation.onload=function(){site.root_body=navigation.document.body,site.root_body.appendChild(site.root_body2)}),site.embed_to="thread"===site.whereami||"page"===site.whereami?{top:function(){return document.querySelector('form[action="/delete"]')},bottom:function(){return document.querySelector('form[action="/delete"]').nextSibling}}:{},site.postform=document.getElementById("postform"),site.postform_rules=document.getElementById("rules_row"),!0)},force_https:!1,protocol:"https:",home:site.protocol+"//krautchan.net/regeln.html",show_boardlist_physical_extract_func:function(e){return e.substr(1,e.length-2)},catalog_frame_prep:function(e){var t=[navigation.document.body,main.document.body];site2.common.absorb_children(t[0]).style.display="none",site2.common.absorb_children(t[1]).style.display="none",t[0].insertBefore(e,t[0].firstChild),t[0].insertBefore(e,t[0].firstChild),site.root_body.appendChild(site.root_body2),this.catalog_embed_prep(e)},catalog_threads_in_page:function(e){return e.getElementsByClassName("thread_body")},max_page_kc:{"/int/":20,"/b/":15,"/trv/":13,"/m/":5},max_page:function(e){return site2.KC.max_page_kc[e]},make_url4:function(e){var t=this.protocol+"//"+this.domain_url;return e[3]=e[3].replace(/_json/,"_html"),"page_html"===e[3]?[t+e[1]+(0==e[2]?"":e[2]+".html"),"html"]:"catalog_html"===e[3]?[t+"/catalog"+e[1].substr(0,e[1].length-1),"html"]:"thread_html"===e[3]?[t+e[1]+"thread-"+e[2]+".html","html"]:void 0},trim_list:"no",get_next_image:function(e,t){var n=Array.prototype.slice.call(document.querySelectorAll("img[id^=thumbnail]")).filter(function(e){return".webm"!==e.src.substr(-5,5)});return site2.DEFAULT.get_next_image(e,t,n)},get_ops:function(e){for(var t=[],n=e.getElementsByTagName("div"),r=0;r<n.length;r++)"thread"!=n[r].className&&"thread kc_showReplies"!=n[r].className||t.push(n[r].id.substring(7));return t},get_posts:function(e){for(var t=[],n=e.getElementsByTagName("a"),r=0;r<n.length;r++)""!=n[r].name&&t.push(n[r].name);return t},modify_thread_link:function(e){for(var t=[],n=e.getElementsByClassName("postheader")[0].getElementsByTagName("a"),r=0;r<n.length;r++)if("Reply"==n[r][brwsr.innerText]||"Antworten"==n[r][brwsr.innerText]){var a=n[r].getAttribute("href");t.push([n[r],a]),n[r].removeAttribute("href")}return t},time_offset:1,localtime:function(e){var t=e.getElementsByClassName("postdate")[0];if(t){var n=t.cloneNode(!1);n.setAttribute("class","CatChan_localtime"),n.textContent=site2.common.change_utc_to_local(site2.KC.parse_funcs.post_html.time_pn_1(t)),t.parentNode.insertBefore(n,t.nextSibling),t.setAttribute("style","display:none")}},remove_files_info:function(e){site2.common.remove_by_classname(e,"filename"),site2.common.remove_by_classname(e,"fileinfo");for(var t=e.getElementsByTagName("img"),n=0;n<t.length;n++)t[n].id&&t[n].id.search("thumbnail")!=-1&&(t[n].removeAttribute("onmouseover"),t[n].removeAttribute("onmouseout"),t[n].removeAttribute("onload"),site2.common.move_up_and_delete_parent([t[n]]));for(var r=e.getElementsByClassName("file_thread"),n=0;n<r.length;n++)site2.common.remove_brs(r[n]);for(var n=0;n<r.length;n++)site2.common.remove_by_attribute([r[n]],"id","filename")},remove_posts:function(e,t){for(var n=e.getElementsByTagName("table"),r=n.length-1-t;r>=0;r--)n[r].previousSibling.previousSibling&&n[r].parentNode.removeChild(n[r].previousSibling.previousSibling),n[r].parentNode.removeChild(n[r].previousSibling),n[r].parentNode.removeChild(n[r])},format_thread_layout:function(e){site2.common.add_attribute_by_classname(e,"file_thread","style","float:left;margin:5px"),site2.common.add_attribute_by_classname(e,"file_reply","style","float:left;margin:5px"),e.getElementsByTagName("blockquote")[0].setAttribute("style","margin:5px;clear:both")},format_thread_style:function(e){site2.common.add_attribute_by_classname(e,"postreply","style","background:#cacaec")},format_thread_contents:function(e){site2.common.remove_by_tagname(e,"input"),site2.common.remove_by_classname(e,"report_parent"),site2.common.remove_by_attribute(e.getElementsByClassName("postheader"),"onclick","hideThread"),site2.common.remove_by_attribute(e.getElementsByClassName("file_thread"),"onclick","toggleThumbnail"),site2.common.remove_by_attribute(e.getElementsByClassName("file_thread"),"href","shipainter"),site2.common.remove_by_tagname(e,"hr"),site2.common.remove_by_classname(e,"omittedinfo")},preprocess_html:function(e,t){return e&&(t&&(e=e.replace(/<script[> ].*<\/script>/gm,"")),e=e.replace(/onload="imageFinishedLoading\([0-9]*\)"/gm,""),e=e.replace(/onmouseover="[^"]*"/gm,""),e=e.replace(/onmouseout="[^"]*"/gm,""),e=e.replace(/onclick="[^"]*"/gm,"")),e},catalog_native_prep:function(e,t,n){var r="catalog"===site.whereami?document.getElementsByClassName("catalog")[0]:document.querySelector('form[action="/delete"]'),a=e.getElementsByTagName("select")["catalog.order.ordering"];a.setAttribute("style","float:left"),r.parentNode.insertBefore(a,r),t.childNodes[3].setAttribute("style","float:left"),r.parentNode.insertBefore(t,r)},catalog_get_native_area:function(){return"page"===site.whereami?document.querySelector('form[action="/delete"]'):document.getElementsByClassName("catalog")[0]},no_JSONAPI:!0,parse_funcs:{catalog_html:{ths:function(e){for(var t=this.ths_array(e,e.pn.getElementsByClassName("thread")),n=Date.now()-36e5*pref.localtime_offset,r=0;r<t.length;r++)t[r].time_bumped<0&&(t[r].time_bumped+=n);return t},no:function(e){return parseInt(e.pn.getAttribute("id").substr(7),10)},time_bumped:function(e){return-1-16*parseInt(e.page.substr(0,e.page.indexOf(".")),10)-parseInt(e.page.substr(e.page.indexOf(".")+1))},time_created:function(e){return 0},nof_posts:function(e){var t=e.pn.getElementsByClassName("omitted_text")[0],n=t?parseInt(t.textContent.match(/[0-9]+/),10):0;return isNaN(n)?1:n+1},nof_files:function(e){return 0},key:function(e){return e.domain+e.board+e.no},sub:function(e){var t=e.pn.getElementsByTagName("header")[0].textContent.trim();return 0==t.search(/^#[0-9]+$/)?"":t},name:function(e){return""},com:function(e){return e.pn.getElementsByTagName("section")[0].innerHTML},type_com:"html",footer:function(e){var t=e.pn.getElementsByClassName("omitted_text")[0];return t.innerHTML="",t},sticky:function(e){return!1},op_img_url:function(e){var t=e.pn.getElementsByClassName("thumbnail"),n=t[0]?t[0].getElementsByTagName("img"):null;return n&&n[n.length-1]?n[n.length-1].getAttribute("src"):void 0},get_op_src:"thread_html",filename:function(e){var t=(e.pn.classList.contains("thread")||e.pn.classList.contains("thread_body"),e.pn.getElementsByClassName("post_files")[0].getElementsByTagName("figure"));if(t)for(var n=0;n<t.length;n++){var r=t[n].getElementsByTagName("img")[0].getAttribute("src");1===n&&(e.extra_files=[]),n>=1&&(e.extra_files[n-1]={domain:e.domain,board:e.board});var a=r.lastIndexOf("/"),s=0===n?e:e.extra_files[n-1];s.filename=t[n].getElementsByTagName("img")[0].getAttribute("alt"),s.filename_server=r.substr(a+1)}return e.filename},prep_mimic:"page_html",tn_imgs:function(){return[]},img2src:function(e){return th.op_img_url.replace("thumbnails","files")},dynamic_image_hover:!0},catalog_json:{proto:"catalog_html"},page_html:{ths:function(e){return this.ths_array(e,e.pn.getElementsByClassName("thread"))},th_init:function(e){e.pn.removeAttribute("class"),e.pn.style.clear="none"},no:function(e){return parseInt(e.pn.id?e.pn.id.replace(/[^_\-]*./,""):e.pn.getElementsByClassName("postnumber")[0].getElementsByTagName("a")[1].textContent,10)},posts:function(e){return this.posts_array(e,e.pn.querySelectorAll(".thread_body, td.postreply"))},time:"post_html.time",nof_posts:function(e){var t=e.pn.getElementsByTagName("table").length+1,n=e.pn.getElementsByClassName("filename").length,r=e.pn.getElementsByClassName("omittedinfo");if(r[0]){var a=r[0][brwsr.innerText].replace(/\n/g,"");t+=parseInt(a.replace(/\ post.*/,""),10),n+=parseInt("0"+a.replace(/\ file.*/,"").replace(/[^\ ]*\ /g,""),10)}return Object.defineProperty(e,"nof_files",{value:n,enumerable:!0,configurable:!0,writable:!0}),t},nof_files:function(e){return e.hasOwnProperty("nof_posts")||this.nof_posts(e),e.nof_files},sub:function(e){var t=e.pn.getElementsByClassName("postsubject")[0];return t?t.textContent:""},name:function(e){return e.pn.getElementsByClassName("postername")[0][brwsr.innerText]},pn_name:function(e){return e.pn.getElementsByClassName("postername")[0]},com:function(e){return(e.pn.getElementsByClassName("postbody")[0]||e.pn).getElementsByTagName("p")[0].innerHTML.replace(/^\s*/,"").replace(/\s*$/,"")},type_com:"html",footer:function(e){return this.insert_footer4(e.pn.getElementsByClassName("file_thread")[0])},flag:function(e){for(var t=e.pn.getElementsByTagName("img"),n=0;n<t.length&&t[n].getAttribute("src").search(/images\/balls/)==-1;n++);if(n<t.length){var r=document.importNode(t[n],!1);return r.setAttribute("src",site2.KC.absolute_link_1(r.getAttribute("src"))),r}return null},op_img_url:function(e){var t=e.pn.getElementsByClassName("file_thread"),n=t[0]?t[0].getElementsByTagName("img"):null,r=n&&n[n.length-1]?n[n.length-1].getAttribute("src"):void 0;if(t.length>=2){e.op_img_url2=[];for(var a=1;a<t.length;a++){n=t[a].getElementsByTagName("img");var s=n&&n[n.length-1]?n[n.length-1].getAttribute("src"):void 0;s&&(e.op_img_url2[e.op_img_url2.length]=s)}}return site2[e.domain].protocol+"//"+site2[e.domain].domain_url+r},get_op_src:"thread_html",get_thread_links:function(e){for(var t=e.pn.getElementsByClassName("postheader")[0].getElementsByTagName("a"),n=0;n<t.length;n++)if("Reply"===t[n].textContent||"Antworten"===t[n].textContent)return[t[n]]},get_omitted_info:function(e){return e.pn.getElementsByClassName("omittedinfo")[0]},set_omitted_info:function(e,t){e.pn.insertBefore(t,e.pn.getElementsByClassName("postbody")[0].nextSibling)},replace_omitted_info2:function(e,t){e.childNodes[0].textContent=t?t.childNodes[0].textContent:""},filename:function(e){var t=e.pn.classList.contains("thread")||e.pn.classList.contains("thread_body"),n=e.pn.getElementsByClassName(t?"file_thread":"file_reply");if(n)for(var r=0;r<n.length;r++){var a=n[r].getElementsByClassName("filename")[0].getElementsByTagName("a")[0].getAttribute("href");1===r&&(e.extra_files=[]),r>=1&&(e.extra_files[r-1]={domain:e.domain,board:e.board});var s=a.lastIndexOf("/"),i=0===r?e:e.extra_files[r-1];i.filename=a.substr(s+1),i.filename_server=a.substr(0,s).replace(/[^\/]*\//g,"").replace(/jpeg$/,"jpg");var o=n[r].getElementsByClassName("fileinfo")[0].textContent.replace(/\s/g,"").split(",");i.w=parseInt(o[1].substr(0,o[1].indexOf("x")),10),i.h=parseInt(o[1].substr(o[1].indexOf("x")+1),10);var l=o[1].split(/\s/);l[1]="kB"===l[1]?1e3:"MB"===l[1]?1e6:1,i.fsize=parseInt(l[0],10)*l[1];var p=n[r].querySelector("img[id^=thumbnail]");p&&(i.tn_w=parseInt(p.getAttribute("width"),10),i.tn_h=parseInt(p.getAttribute("height"),10))}return e.filename},tn_imgs:function(e){return e.pn.querySelectorAll("img[id^=thumbnail]")},prep_mimic:function(e){e.op_img_url=e.parse_funcs.op_img_url(e)},get_op_src:function(e){return site2.KC.catalog_json2html3_src(e)},get_max_page:function(e){for(var t=e.querySelectorAll("form[action*=delete]")[0].lastChild.previousSibling.previousSibling.previousSibling.childNodes[1].childNodes[1].childNodes[0].childNodes[3].childNodes,n=0,r=0;r<t.length;r++){var a=t[r].textContent.replace(/\s+/g,"");n+1!=a&&"["+(n+1)+"]"!==a||n++}return n}},thread_html:{com:function(e){return e.pn.getElementsByTagName("blockquote")[0].innerHTML.replace(/^\s*/,"").replace(/\s*$/,"")},type_com:"html",time_created:function(e){return e.parse_funcs.time(e.posts[0])},time_bumped:function(e){return e.parse_funcs.time(e.posts[e.posts.length-1])},get_op_src:function(e){return e.op_img_url.replace("thumbnails","files")},proto:"page_html"},post_html:{flag:"page_html",time:function(e){return site2.KC.parse_funcs.post_html.time_pn(e.pn)},time_pn:function(e){var t=e.getElementsByClassName("postdate")[0];return t?site2.KC.parse_funcs.post_html.time_pn_1(t):void 0},time_pn_1:function(e){return Date.parse(e.textContent)+36e5*(pref.localtime_offset-site2.KC.time_offset)}},post_json:{time_unit:1}},general_event_handler:{},popups_href2dbtp:function(e){var t=e.split(/[\/#]/),n=t[t.length-1],r=t[t.length-2].replace("thread-","").replace(".html","");return["KC",t.length>=3?"/"+t[t.length-3]+"/":site.board,r,n]},link_dbtp2href:function(e){return e[1]+"thread-"+e[2]+".html#"+e[3]},post_json2html_fname_server:function(e){return e.filename_server},post_json2html_fname:function(e){return e.filename},catalog_json2html3_src:function(e){return site.protocol+"//"+site2[e.domain].domain_url+"/files/"+e.filename_server},catalog_json2html3_thumbnail:function(e){return site.protocol+"//"+site2[e.domain].domain_url+"/thumbnails/"+e.filename_server},post_json2html:function(e,t,n,r,a){var s=document.createElement("div"),i=e.parse_funcs&&e.parse_funcs.time_unit||1,o=new Date((e.time||0)*i-36e5*(pref.localtime_offset-site2.KC.time_offset)),l="";if(e.filename&&(l+=this.post_json2html_file(e,t,e.extra_files),e.extra_files))for(var p=0;p<e.extra_files.length;p++)l+=this.post_json2html_file(e.extra_files[p],t,!0);return s.innerHTML='<div class="'+(n?"thread_body":'postreply" id="post-'+e.no)+'"><div class="postheader"><input name="post_'+e.no+'" value="delete" type="checkbox">'+(e.flag?e.flag.outerHTML:"")+'<span class="postsubject">'+e.sub+'</span> <span class="postername">'+e.name+'</span> <span class="postdate">'+o.toLocaleString()+'</span> <span class="postnumber"><a href="/int/thread-'+a+".html#"+e.no+'" class="quotelink">No.</a><a href="/int/thread-'+a+".html#q"+e.no+'" class="quotelink">'+e.no+'</a></span> <div class="report_parent"><a href="/report/int/'+a+'" class="report_link"><img src="/images/icon-report.png"></a></div>'+(n?' [<a href="'+t+"thread-"+e.no+'.html">Reply</a>] ':"")+"</div>"+l+"<div"+(n?' class="postbody"':"")+'><blockquote><p id="post_text_'+e.no+'">'+e.com+"</p></blockquote></div></div>",s.childNodes[0]},post_pn2ce:function(e){return"BLOCKQUOTE"===e.lastChild.firstChild.tagName?e.lastChild.firstChild:e.getElementsByTagName("blockquote")[0]},post_json2html_file:function(e,t,n){var r=(.005+(e.fsize>1048576?e.fsize/1048576:e.fsize/1024)).toString();r=r.substr(0,r.indexOf(".")+3)+(e.fsize>1048576?" MB":" KB");var a=site2[e.domain].post_json2html_fname_server(e),s=site2[e.domain].post_json2html_fname(e),i=site2[e.domain].catalog_json2html3_src(e,t),o=site2[e.domain].catalog_json2html3_thumbnail(e,t);return'<div class="file_thread"><span class="filename"><a href="/download/'+a+"/"+s+'">'+s+'</a></span><br><span class="fileinfo"> '+s.substr(s.lastIndexOf(".")+1).toUpperCase()+", "+e.w+"x"+e.h+", "+r+'</span><br><a href="'+i+'" target="_blank"><img style="display: block" id="thumbnail_'+a+'" src="'+o+'" width="'+e.tn_w+'" height="'+e.tn_h+'"></a></div>'},page_json2html3:function(e,t,n,r,a){var s=document.createElement("div");s.setAttribute("id","thread_"+e.no),s.setAttribute("style","clear:both"),s.innerHTML="<hr><a name="+e.no+"></a>";var i=this.post_json2html(e.posts&&e.posts[0]?e.posts[0]:e,e.board,!0,site2[e.domain].short_link(e.key,e.nof_posts,2,"[Last "," Posts]"),e.no);if(s.appendChild(i),e.posts[0].pn=i,e.posts){for(var o=1;o<e.posts.length;o++){var l=this.post_json2html(e.posts[o],e.board);this.update_posts_insert_1(this.post_container(l,e.posts[o].no),e.posts[o].no,null,s),e.posts[o].pn=l}a||this.page_json2html3_add_omitted_info(e,e.posts,e.posts)}return s},page_json2html3_replace_expander:function(e,t,n){var r=e[0].pn.getElementsByClassName("omittedinfo")[0];r&&r.appendChild(cnst.config_expander(n,t))},page_json2html3_add_omitted_info:function(e,t,n){for(var r=0,a=1;a<n.length;a++)r+="html"===n[a].type_data?n[a].pn.getElementsByClassName("file_thread").length:n[a].filename?n[a].extra_files?n[a].extra_files.length+1:1:0;var s=e.nof_files-r,i=e.nof_posts-n.length,o=t?t[0].pn.getElementsByClassName("omittedinfo")[0]:null;return e.nof_posts>1?(o||(o=document.createElement("span"),o.setAttribute("class","omittedinfo"),o.innerHTML="dummy",o.appendChild(cnst.config_expander(e.key)),t&&t[0].pn.insertBefore(o,t[0].pn.getElementsByClassName("postbody")[0].nextSibling)),o.childNodes[0].textContent=0!==i?i+" post"+(1!==i?"s":"")+(s?" and "+s+" file"+(1===s?"":"s"):"")+" are not shown. ":""):o&&(o.childNodes[0].textContent="Showing all posts."),o},update_posts_remove:function(e,t,n,r){n=n.getElementsByClassName("thread_body")[0];var a=e.posts[t].pn;r&&a.parentNode===n?this.update_posts_insert_pack(a):a=a.parentNode.parentNode.parentNode,a.previousSibling&&"A"===a.previousSibling.tagName&&n.removeChild(a.previousSibling),n.removeChild(a)},update_posts_insert:function(e,t,n,r,a){var s=t[r];s=s?s.pn:null;var i=s&&s.parentNode&&s.parentNode.parentNode&&s.parentNode.parentNode.parentNode;i&&i.parentNode&&i.parentNode.parentNode===a&&(s=i),e[n].pn||(e[n].pn=this.post_json2html(e[n],e[n].board)),0===n&&this.update_posts_insert_pack(e[0].pn),0===r&&s&&this.update_posts_insert_pack(t[0].pn);var o=0===r&&0===n?e[n].pn:this.post_container(e[n].pn,e[n].no);this.update_posts_insert_1(o,e[n].no,s,a),0===n&&0===r&&this.update_posts_insert_unpack(e[0].pn)},update_posts_insert_1:function(e,t,n,r){r=r.getElementsByClassName("thread_body")[0];var a=document.createElement("a");a.setAttribute("name",t),r.insertBefore(a,n),r.insertBefore(e,n)},update_posts0_class:site2.vichan.update_posts0_class,update_posts_insert_pack:site2.vichan.update_posts_insert_pack,update_posts_insert_pack_iter:function(e,t){for(var n=e.previousSibling;n;){var r=n.previousSibling;if(n.classList&&(n.classList.contains(pref.script_prefix+"_footer")||n.classList.contains("file_thread")||n.classList.contains("post_header"))&&t(n),n.classList&&n.classList.contains("postbody"))break;n=r}},update_posts_insert_unpack:function(e){for(;;){var t=e.firstChild;if(!(t&&t.classList&&(t.classList.contains(pref.script_prefix+"_footer")||t.classList.contains("file_thread")||t.classList.contains("post_header"))))break;e.parentNode.insertBefore(t,e)}},post_container:function(e,t){var n=document.createElement("table");return n.innerHTML='<tbody><tr><td valign="top">&gt;&gt;</td></tr></tbody>',n.childNodes[0].childNodes[0].appendChild(e),n},catalog_json2html3:function(e,t,n,r){var a=document.createElement("article");a.setAttribute("class","thread teaser"),a.setAttribute("id","thread-"+e.no);var s=null;return e.flags&&e.flags[0]&&(s=document.importNode(e.flags[0],!1),s.setAttribute("class","post_country")),a.innerHTML='<article class="thread_OP" id="'+e.no+'"><div class="post"><header><a><h1>'+(s?s.outerHTML:"")+(e.sub?e.sub:"#"+e.no)+'</h1></a></header><div class="post_body"><a><div class="post_files multiple"><figure><div class="thumbnail"><img src="'+e.op_img_url+'"></div></figure>'+(e.op_img_url2&&e.op_img_url2[0]?'<figure><div class="thumbnail"><img src="'+e.op_img_url2[0]+'"></div></figure>'+(e.op_img_url2&&e.op_img_url2[1]?'<figure><div class="thumbnail"><img src="'+e.op_img_url2[1]+'"></div></figure>'+(e.op_img_url2&&e.op_img_url2[2]?'<figure><div class="thumbnail"><img src="'+e.op_img_url2[2]+'"></div></figure>':""):""):"")+'</div></a><div class="omittedposts"><span class="omitted_text">'+(r?"R: 0 / I: 0 / P: 0.0&emsp;/catalog/":"")+'</span></div><div class="post_text"><section>'+e.com+"</section></div></div></div></article>",a.getElementsByClassName("thumbnail")[0].childNodes[0].addEventListener("load",site2.KC.catalog_json2html3_onload,!1),a},catalog_json2html3_onload:function(){this.removeEventListener("load",site2.KC.catalog_json2html3_onload,!1);var e=this.naturalWidth,t=this.naturalHeight,n=(e>t?e:t)/200;this.setAttribute("width",e/n),this.setAttribute("height",t/n)},favicon:{__proto__:site2.DEFAULT.favicon,none:"/favicon.ico",reply:"png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAIAAACQkWg2AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAKJJREFUOE9jZPh/hgECfv4yts59/PgxlAujZGVlzx6dzMDOBhMAaoCjtEA01SAuUBBZDQrnwEwsGoCCKBp+HEPwPx6QkZFB1gPifjyAUABUbGxsDLIUaAxEItQFxRIgFygIlAIqSAsEKYYDkGGhLpaWlsgaQNxQFxRrxcTEsLgbhxBI8SDUQLKnSQ9WUiOO9KRBfuL7cQzoH2C0oAGQJ5GcDQBwM6RhinByrgAAAABJRU5ErkJggg==",reply_to_me:"png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAIAAACQkWg2AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAMxJREFUOE9jZPh/hgECfv4yts59/PgxlAujZGVlzx6dzMDOBhMAavh/5j8MoKkGcdMCQYbCEYSFT8OBmagafhxD1iAjI4NsCYj78QBCA1CxsbEx0FKEDaEuKK4CcoFOAOoB2pMWCFIMAXANlpaWyBpA3FAXFGvFxMSQNWDxNJIQSDFEA5EAoQFfKGG1gQQNcP0gn4W6EPY0JFhBoQYJb8LBCo44KPp4gHDEoUQ70B5MgJ40kBMW0G2YAGviA9nz4xjQP8CQRgMgTyI5GwD2xdfU779fsgAAAABJRU5ErkJggg=="},add_backlinks:function(e,t,n,r){}}),(pref.features.domains["4chan"]||pref.features.domains.meguca)&&(site2["4chan_i"]={domain_url:"i.4cdn.org",check_func:site2.DEFAULT.check_func,proto:"4chan"},site2["4chan"]={nickname:"4chan",get home(){return site.protocol+"//"+this.domain_url+"/favicon.ico"},protocol:"https:",make_tack:function(){var e=document.createElement("img");return e.setAttribute("src","//s.4cdn.org/image/sticky.gif"),e.setAttribute("class","stickyIcon retina"),e},postform_rules:null,postform:{activation:function(){document.getElementById("togglePostFormLink").getElementsByTagName("a")[0].click(),this.activation=null},__proto__:site2.DEFAULT.postform},features:{uip_tracker:!0},components:{header:"#header",boardlist:".boardList",boardlist2:[".boardList",1],postform_comment:'textarea[name="com"]',postform_submit:'input[type="submit"]',postform_comment2:['textarea[name="com"]',1],postform_submit2:['input[type="submit"]',2]},spoiler_text:{open_rule:"s,s a:not(:hover) {color: #fff!important;}"},general_event_handler:function(){var e={thread:{get_mark:function(e,t){for(;e&&e!==cataLog.parent;){if(e.classList.contains("post"))return e;if(e.classList.contains("postContainer"))return e.getElementsByClassName("post")[0];if(e.parentNode&&e.parentNode.classList.contains("thread")){if(e=e.previousSibling)continue;break}if(e.classList.contains("thread"))break;e=e.parentNode}return this.get_mark_from_height(t)},get_mark_from_height:function(e){return this.__proto__.get_mark_from_height(e,document.getElementsByClassName("post"))},image_hover_check_mode:function(e){return e.parentNode.classList.contains("fileThumb")?"page":"catalog"},getID:function(e){return e.classList.contains("hand")&&e.textContent},getCountry:function(e){return e.classList.contains("flag")&&e.getAttribute("class").replace(/\s*flag\-*/g,"").toUpperCase()||e.classList.contains("bfl")&&e.className.replace(/\s*bfl\-*/g,"").toLowerCase()},getTrip:function(e){return e.classList.contains("postertrip")&&e.textContent},__proto__:site2.DEFAULT.general_event_handler.common}};return e.catalog=Object.create(e.thread),e.page=Object.create(e.thread),e.archive=Object.create(e.thread),e}(),domain_url:"boards.4chan.org",check_func:function(){var e=window.location.href,t=e.indexOf(site2["4chanB"].domain_url)!==-1?"4chanB":e.indexOf(site2["4chanR"].domain_url)!==-1?"4chanR":null;return!!t&&(this.domain_url=site2[t].domain_url,site.whereami=document.title.indexOf("404 Not Found")!=-1?"404":e.search(/catalog/)!=-1?"catalog":e.search(/thread\/[0-9]+/)!=-1?"thread":e.search(/archive/)!=-1?"archive":e.search(/\/$|(index|[0-9]+)(\.html)*|\/#all$/)!=-1?"page":"other","thread"===site.whereami?site.no=parseInt(e.replace(/.*thread\/([0-9]+)/,"$1"),10):"page"===site.whereami?site.page=parseInt((e.match(/\/([0-9]+)\/*/)||[])[1],10)||0:"catalog"===site.whereami&&e.indexOf("catalog#s=")!=-1&&(this.catalog_native_prep_wait_loop=this.catalog_native_prep_wait_loop_if_searched),site.config(this.domain_url,"4chan"),this.postform_prep(),site.max_page=site2["4chan"].max_page(site.board),site.embed_to="thread"===site.whereami?{top:function(){return document.getElementsByClassName("navLinks")[0]},bottom:function(){return document.getElementsByClassName("bottomad")[0]||document.getElementById("boardNavDesktopFoot")}}:"page"===site.whereami?{top:function(){return document.getElementById("ctrl-top")},bottom:function(){return document.getElementsByClassName("pagelist")[0]}}:"catalog"===site.whereami?{top:function(){return document.getElementById("content").previousSibling},bottom:function(){return document.getElementsByClassName("navLinksBottom")[0].nextSibling}}:{},site.postform=document.getElementsByClassName("postForm")[0],!0)},get_next_image:function(e,t){var n=cataLog.parent.querySelectorAll("img[data-md5]");0===n.length&&(n=site.popup_body.querySelectorAll("img[data-md5]"));var r=Array.prototype.indexOf.call(n,e);if(r==-1&&(r=Array.prototype.indexOf.call(n,e.previousSibling)),t)for(;n[r+1]&&n[r+1].offsetTop<t;)r++;if(r>=0){if(pref.test_mode[164])for(;n[r+1]&&n[r+1].parentNode.getAttribute("href").search(/\.webm$/)!=-1;)r++;return n[r+1]}return null},format_expanded_thumbnail:function(e){e.removeAttribute("data-md5"),e.className="expanded-thumb"},catalog_threads_in_page:function(e){return e.getElementsByClassName("thread")},catalog_posts_in_thread:function(e){return e.getElementsByClassName("replyContainer")},max_page:function(){return 10},make_url4:function(e,t){var n=site.protocol+"//"+this.domain_url+e[1],r=site.protocol+"//a.4cdn.org"+e[1];return("catalog_html"===e[3]||t&&0==e[2]&&"page_json"===e[3])&&(e[3]="catalog_json"),"page_json"===e[3]?[r+(parseInt(e[2],10)+1)+".json","json",t?"4chan"+e[1]+"j0":void 0]:"catalog_json"===e[3]?[r+"catalog.json","json","4chan"+e[1]+"j0"]:"thread_json"===e[3]?[r+"thread/"+e[2]+".json","json"]:"page_html"===e[3]?[n+(0!=e[2]?parseInt(e[2],10)+1:""),"html"]:"thread_html"===e[3]?[n+"thread/"+e[2],"html"]:null},trim_list:"force_init",url_boards_json:function(){return[site.protocol+"//a.4cdn.org/boards.json","json"]},archive_patch_domain:function(e){Object.defineProperty(e,"domain_xhr",{get:function(){return this.url.indexOf("i.4cdn.org/")===-1?null:"4chan_i"},configurable:!0,enumerable:!0})},get_ops:function(e){for(var t=[],n=e.getElementsByClassName("thread"),r=0;r<n.length;r++)t.push(n[r].id.substring(1));return t},get_posts:function(e){for(var t=[],n=e.getElementsByClassName("postContainer"),r=0;r<n.length;r++)t.push(parseInt(n[r].id.substring(2),10));return t},modify_thread_link:function(e){var t=e.getElementsByClassName("replylink")[0];if(t){var n=t.getAttribute("href");return t.removeAttribute("href"),[[t,n]]}return[]},check_thread_archived:function(e){return 0!=e.getElementsByClassName("archivedIcon").length},localtime:function(e){for(var t=e.getElementsByClassName("dateTime"),n=0;n<t.length;n++)t[n].textContent=site2.common.change_utc_to_local(1e3*parseInt(t[n].getAttribute("data-utc"),10))},remove_files_info:function(e){site2.common.remove_by_classname(e,"fileText"),site2.common.remove_by_classname(e,"mFileInfo");for(var t=e.getElementsByClassName("fileThumb"),n=0;n<t.length;n++)site2.common.move_up_and_delete_parent([t[n].childNodes[0]])},remove_posts:function(e,t){site2.common.remove_by_classname(e,"postContainer replyContainer",t,!0)},format_thread_layout:function(e){site2.common.add_attribute_by_classname(e,"post op","style","padding:0px"),site2.common.add_attribute_by_tagname(e,"blockquote","style","margin:12px 5px")},format_thread_contents:function(e){site2.common.remove_by_tagname(e,"input"),site2.common.remove_by_classname(e,"mobile"),site2.common.remove_by_classname(e,"sideArrows"),site2.common.remove_by_classname(e,"summary")},get_json_url_catalog:function(e){return site.protocol+"//a.4cdn.org"+e+"catalog.json"},uip_check:function(e,t){var n=[site.nickname,site.board,site.no,"thread_json"],r=pref.test_mode[136]&&pClg?function(t,n,r){e(t,n,r);cataLog.scan_boards_keyword_callback2(t,n,["sage_detect",{refresh:null,__proto__:cataLog.scan_boards_keyword_callback2_default_args}])}:e;http_req.get("uip",n.join(),"",r,!1,!1),pref.uip_tracker.sage.detect&&(n[3]="catalog_json",http_req.get("sage_detection",n.join(),"",this.sage_detect,!1,!1,t))},sage_detect:function(e,t,n){var r=e.split(","),a=pref.test_mode[136]&&pClg?cataLog.scan_boards_keyword_callback2(e,t,["sage_detect",{refresh:null,__proto__:cataLog.scan_boards_keyword_callback2_default_args}]):site2["4chan"].wrap_to_parse.get(t.response,r[0],r[1],r[3],{page:0});n(site2["4chan"].parse_funcs.catalog_json.add_sage(a,site.no)||a.filter(function(e){return e.no===site.no})[0],t.response[0].threads.length)},sage_detect_all:function(e){this.parse_funcs.catalog_json.add_sage(e,null);for(var t=0;t<e.length;t++){for(var n=e[t].posts,r=liveTag.mems.init(e[t]),a=0;a<n.length;a++)"sage"===n[a].email&&(r.sg||(r.sg=new Set),r.sg.add(n[a].no));if(pref.catalog.page_his){r.pgh||(r.pgh={});var s=r.pgh,i=e[t].posts[e[t].posts.length-1].no;s[i]?this.page_his_update(s[i],t):s[i]=[t]}}},page_his_update:function(e,t){var n=e[e.length-1];return n!=t&&(e[e.length-(e.length<=1?0:n<t&&e[e.length-2]<n?1:0)]=t),n!=t},parse_json_thread:function(e,t){if(t)return e.posts[e.posts.length-1].unique_ips=e.posts[0].unique_ips,e;for(var e={posts:[]},n={},r=0,a=document.getElementsByClassName("postContainer"),s=0;s<a.length;s++){e.posts[s]={},e.posts[s].no=a[s].id.replace(/pc/,"");var i=a[s].getElementsByClassName("posteruid")[0];i&&(i=i.textContent,e.posts[s].id=i,void 0===n[i]&&(r++,n[i]=1)),e.posts[s].unique_ips=r}return e.posts[a.length-1].unique_ips=0,e},uip_tgt_post:function(e){return document.getElementById("p"+e)},uip_post_num:function(e){
return e.getElementsByClassName("postNum")},prep_own_posts_reg:/^4chan\-track\-[0-9A-z]+\-[0-9]+$/,prep_own_posts_event:function(e){e&&site2["4chan"].prep_own_posts_1(e.key)&&(e=null),"4chan"!==window.name||e||send_message("parent",["OWN_POSTS",window.name,site3[window.name].own_posts])},prep_own_posts:function(e){if(site3[this.nickname].own_posts={},localStorage)for(var t=e?[("4chan-track"+e).replace(/\//g,"-")]:Object.keys(localStorage||"{}"),n=0;n<t.length;n++)this.prep_own_posts_1(t[n])},prep_own_posts_1:function(e){if(this.prep_own_posts_reg.test(e)){var t="/"+e.replace(/^4chan\-track\-/,"").replace(/\-[0-9]+$/,"")+"/";site3[this.nickname].own_posts[t]||(site3[this.nickname].own_posts[t]={});var n=JSON.parse(localStorage[e]||"{}");for(var r in n)site3[this.nickname].own_posts[t][r.substr(2)]=null;return!0}return!1},catalog_native_prep_wait_loop:null,catalog_native_prep_wait_loop_if_searched:function(e,t){var n=document.getElementById("qf-ctrl"),r=document.getElementById("qf-clear"),a=function(){n.removeEventListener("click",a,!1),r.removeEventListener("click",a,!1),setTimeout(t,100)};n.addEventListener("click",a,!1),r.addEventListener("click",a,!1)},catalog_native_prep_watcher:!0,catalog_native_prep:function(e,t,n,r){var a="catalog"===r.mode?document.getElementById("ctrl"):document.getElementById("ctrl-top");if("float"!==r.mode){if("thread"===r.mode||!a)for(var a=document.getElementsByClassName("navLinks"),s=0;s<a.length;s++)if("none"!==window.getComputedStyle(a[s]).display){a=a[s];break}site2.DEFAULT.catalog_native_prep_sel(e,t,"catalog"===r.mode?document.getElementById("order-ctrl"):null)}var i=r.components.native_size,o="catalog"===r.mode?cnst.cloneSwap(document.getElementById("size-ctrl")):cnst.doms_insertBefore(null,'<br>&emsp;<select size="1"> <option value="small">Small</option> <option value="large">Large</option> </select>',i);o.add(cnst.dom("<option>custom</option>")),"float"===r.mode&&(o.selectedIndex=pref.float.catalog_size),r.pref[r.mode].format.thumb.size=o.value;var l="catalog"===r.mode?cnst.cloneSwap(document.getElementById("teaser-ctrl")):i.parentNode.insertBefore(cnst.dom('<select size="1"> <option value="off">Off</option> <option value="on">On</option> </select>'),i);"float"===r.mode&&(l.selectedIndex=pref.float.catalog_teaser);var p=function(e,t,n){return function(r){e.ppn.setAttribute("class",e.ppn.getAttribute("class").replace(/(extended\-)*(small|large|custom)/g,"").replace(/\s\s*/," ").replace(/^\s|\s$/,"")),"catalog"===e.view&&e.ppn.classList.add(_[n.selectedIndex]+d[t.selectedIndex]),r&&(r.target===t&&e.image_resize_all(r.target.value),"catalog"===e.mode&&localStorage&&(localStorage["catalog-settings"]=JSON.stringify({extended:1==n.selectedIndex,large:1==t.selectedIndex,orderby:"alt"})),r.stopPropagation())}}(r,o,l);if(pref_func.settings.html_funcs.design_of_fc_size_doms_register(o,l),o.addEventListener("change",p,!1),l.addEventListener("change",p,!1),"catalog"===r.mode){r.kwd_init(document.getElementById("qf-box"),e,this.catalog_native_prep_wait_loop).id=null,document.getElementById("qf-ctrl").addEventListener("click",r.kwd_clear,!1),document.getElementById("qf-clear").addEventListener("click",r.kwd_clear,!1);var c=document.getElementById("settings");t.childNodes[3].style.float="left",t.style.float="right",a.appendChild(e),a.insertBefore(t.childNodes[3],c),a.insertBefore(t,c)}else"page"===r.mode?(t.childNodes[3].style.display="inline",t.style.float="right",a.appendChild(t.childNodes[3]),a.appendChild(t),a.appendChild(e)):"thread"===r.mode&&(a.appendChild(t),a.appendChild(e),document.getElementsByClassName("navLinksBot")[0].appendChild(n));"archive"===site.whereami&&(styleSheet.register_cc("threads","padding:20px 0;text-align:center;"),styleSheet.register_cc("threads>.thread","width:180px;max-height:320px;vertical-align:top;display:inline-block;word-wrap:break-word;overflow:hidden;margin-top:5px;margin-bottom:20px;padding:5px 0 3px;position:relative;"));var _=["","extended-"],d=["small","large","custom"];r.native.viewChanged=p},catalog_get_native_area:function(){if("archive"===site.whereami){var e=document.getElementById("arc-list"),t=document.createElement("div");t.setAttribute("class",pref.script_prefix+"_threads"),e.parentNode.insertBefore(t,e);var n=document.createElement("button");return n.textContent="More threads",e.parentNode.insertBefore(n,e),n.onclick=function(){cataLog.insert_myself(null,null,!0)},t}return"catalog"===site.whereami?document.getElementById("threads"):document.getElementsByClassName("board")[0]},catalog_float_prep:function(e){"catalog"===site.whereami&&e.ppn.appendChild(cnst.dom('<div style="clear:both"></div>'))},parse_funcs:{catalog_html:{ths_hook:function(e){var t=document.createElement("script");t.innerHTML="var clg; try{clg = JSON.stringify(catalog);} catch (e){clg = null;} document.body.lastChild.textContent = clg;";var n=new MutationObserver(function(r){document.body.removeChild(t),n.disconnect();try{site.data_embedded=JSON.parse(t.textContent)}catch(e){}e()});n.observe(t,{childList:!0}),document.body.appendChild(t)},ths:function(e){var t=e.pn.getElementsByClassName("thread"),n=site.data_embedded;if(!n)return this.ths_array(e,t);var r=[],a={get filename(){return this.file.slice(0,this.file.indexOf("."))},get tim(){return this.imgurl},get ext(){return this.file.slice(this.file.lastIndexOf("."))},get name(){return this.author},get com(){return Object.defineProperty(this,"com",{value:site2["4chan"].link_sanitizedTxt2html(this.teaser,this),writable:!0,configurable:!0,enumerable:!0}).com},parse_funcs:{type_com:"html",__proto__:this},missing_info:void 0,__proto__:e.__proto__};for(var s in n.threads){var i=n.threads[s];if(!(i.b>t.length)){if(i.no=parseInt(s,10),i.page=Math.floor(i.b/(n.pagesize||15))+"."+i.b%(n.pagesize||15),i.nof_posts=i.r+1,i.nof_files=i.i+1,i.time_created=1e3*i.date,i.time_posted=1e3*(i.lr&&i.lr.date||i.date),i.time_bumped=i.time_posted,i.time=i.date,i.name=i.author||n.anon,i.lr&&i.lr.id!=s&&(i.last_name=i.lr.author||n.anon,i.last_no=i.lr.id),pref.test_mode[159]){i.last_modified=i.lr&&i.lr.date||i.date;var o=i.lr&&i.lr.id!=s?{name:i.lr.author||n.anon,no:i.lr.id,time:i.lr.date}:null}if(i.__proto__=a,pref.test_mode[146]){var l=t[i.b].getElementsByClassName("teaser")[0],p=(i.sub?"<b>"+i.sub+"</b>: ":"")+i.com;p!==l.innerHTML.replace(/\'/g,"&#039;")&&(l.innerHTML=p)}r[i.b]={pn:t[i.b],posts:o?[i,o]:[i],__proto__:i}}}if(pref.test_mode[159]){site2["4chan"].parse_funcs.catalog_json.add_sage(r);for(var s=0;s<r.length;s++)r[s].posts.splice(1,1)}return r},no:function(e){return parseInt(e.pn.getAttribute("id").substr(7),10)},time_bumped:function(e){return 0},time_created:function(e){return 0},nof_posts:function(e){var t=e.footer.textContent.match(/[0-9]+/g),n=t&&t[1]&&parseInt(t[1],10)+1||1;return Object.defineProperty(e,"nof_files",{value:n,enumerable:!0,writable:!0,configurable:!0}),t&&parseInt(t[0],10)+1||1},nof_files:function(e){var t=e.footer.textContent.match(/[0-9]+/g),n=t&&parseInt(t[0],10)+1||1;return Object.defineProperty(e,"nof_posts",{value:n,enumerable:!0,writable:!0,configurable:!0}),t&&t[1]&&parseInt(t[1],10)+1||1},sub:function(e){var t=e.pn.getElementsByClassName("teaser")[0],n=t?t.getElementsByTagName("b"):null,r=t?n&&n[0]?t.childNodes[1]?t.childNodes[1].textContent:"":t.childNodes[0].textContent:"";return Object.defineProperty(e,"com",{value:r,enumerable:!0,writable:!0,configurable:!0}),n&&n[0]?n[0].textContent:""},name:function(e){return""},com:function(e){return e.hasOwnProperty("sub")||Object.defineProperty(e,"sub",{value:this.sub(e),enumerable:!0,writable:!0,configurable:!0}),e.com},footer:function(e){return e.pn.getElementsByClassName("meta")[0]},sticky:function(e){return void 0!==e.pn.getElementsByClassName("stickyIcon")[0]},tn_as:function(e){return e.pn.getElementsByTagName("a")},class_thread:"thread",class_thumbnail:"thumb",op_img_url:function(e){return site2["4chan"].catalog_json2html3_thumbnail(e,e.board)||e.tn_imgs[0]&&e.tn_imgs[0].getAttribute("src")||void 0},get_op_src:"thread_json",dynamic_image_hover:!0,missing_info:1,img2src:function(e){var t=site2["4chan"].popups_href2dbtp(e.parentNode.getAttribute("href")),n=liveTag.mems.getFromName(t[0]+t[1]+t[2]);return n?n.th&&n.th.ext?e.src.replace(/thumb/,"src").replace(/s\.[^\.]*$/,n.th.ext):(n.th.missing_info&&cataLog.DIH.fetch_and_reentry([n.domain+n.board],e),e.src):null},time_unit:1e3,footer_prep:function(e,t){var n=document.createElement("span"),r=t.lastChild;r&&t.removeChild(r),t.insertBefore(n,t.firstChild);for(var a;a=n.nextSibling;)n.appendChild(a);return n}},catalog_json:{ths:function(e,t){for(var n=[],r=0;r<e.length;r++)if(e[r].threads)for(var a=0;a<e[r].threads.length;a++){var s=e[r].threads[a];s.__proto__=t,n[n.length]={page:r+"."+a,key:t.domain+t.board+s.no,__proto__:s}}return n},time_posted:function(e){return e.last_replies?1e3*e.last_replies[e.last_replies.length-1].time:e.time_created},time_bumped:function(e){return e.bumplimit?void 0:e.time_posted},time_created:function(e){return 1e3*e.time},nof_posts:function(e){return e.replies+1},nof_files:function(e){return e.images+1},op_img_url:"DEFAULT.common",posts:function(e){return e.last_replies?[e.__proto__].concat(e.last_replies):[e.__proto__]},has_posts:!0,add_op_img_url:site2.DEFAULT.parse_parts.add_op_img_url,time_unit:1e3,get_op_src:"thread_json",type_com:"html",posts_full:null,missing_info:void 0,tn_as:"catalog_html",tn_imgs:"catalog_html",footer:"catalog_html",class_thread:"catalog_html",class_thumbnail:"catalog_html",add_sage:function(){function e(e,t){var n=(e.domain!==site.nickname?e.domain:"")+(e.board!==site.board?e.board:"")+e.no;return"p"+e.page+", "+n+"#"+e.posts[t].no+", "+e.posts[t].time}var t={},n={};return function(r,a){for(var s=pref.uip_tracker.sage,i=0;i<r.length&&r[i].sticky;){if(r[i].no===a)return r[i];i++}if(s.patch_bug3){for(var o=(r[0].domain!==site.nickname?r[0].domain:"")+r[0].board,l=t[o]||0;i<r.length&&r[i].last_modified<l;){if(r[i].no===a)return r[i];i++}i<r.length&&(t[o]=r[i].last_modified);for(var p=i;--p>=0;)Object.defineProperty(r[p],"time_bumped",{value:r[i].last_modified*_,enumerable:!0,configurable:!0,writable:!0})}if(i!=r.length){if(r[i].no==a)return r[i];l=r[i].last_modified;for(var c=(r[0].domain!==site.nickname?r[0].domain:"")+(r[0].board!==site.board?r[0].board:""),_=this.time_unit,d=[],u=!1;++i<r.length;){var f=r[i],h=c?c+f.no:f.no;if(f.bumplimit)l--;else{for(var p=f.posts.length-1;p>=1;p--){var m=f.posts[p].time;if(t[h]===m&&i<n[h]){pref.debug_mode[30]&&console.log("Bumped without any posts: p"+i+"<-"+n[h]+", "+e(f,p)+", "+(i<r.length-2?r[i+1].posts[r[i+1].posts.length-1].time:"")+", "+l),u=!0;break}if(t[h]>=m)break;if(l+s.tolerance>=m)break;if(s.patch_bug4&&i<n[h]&&(p>=2||1===f.nof_posts)&&f.posts[p-1].time<=t[h]){var g=p===f.posts.length-1&&p-1>=0&&f.posts[p-1].time===t[h]&&!(t[h]+s.tolerance>=l);pref.debug_mode[30]&&console.log("RECOVERED by page history: "+e(f,p)+", "+(g?"sure":"maybe")+", p"+i+"<-"+n[h]+", "+m+"<-"+t[h]+", "+l),l=m;for(var v=i;--v>=0;){var b=d[v]||r[v].posts.length-1,y=r[v].posts[b].time;if(y+s.tolerance>=l)break;for(;++b<r[v].posts.length;)if(d[v]=b,r[v].posts[b].email="",pref.debug_mode[30]&&console.log("Recovered saged posts: "+e(r[v],b)+", "+l),(y=r[v].posts[b].time)+s.tolerance>=l){l=y>l?y:l,Object.defineProperty(r[v],"time_bumped",{value:l*_,enumerable:!0,configurable:!0,writable:!0});break}b===r[v].posts.length&&pref.debug_mode[30]&&console.log("There should be updated data after: "+e(r[v],b-1)+", "+l)}u=!0;break}f.posts[p].email="sage",pref.debug_mode[30]&&console.log("detect: sage: "+e(f,p)+", "+m+", "+l)}d[i]=p,0===p&&(m=f.nof_posts===f.posts.length?f.posts[0].time:l-1);var w=t[h]!=m;(t[h]||0)<m&&(t[h]=m),w&&(l=s.patch_bug2&&i<s.patch_bug2nth?f.last_modified:t[h])}if(Object.defineProperty(f,"time_bumped",{value:l*_,enumerable:!0,configurable:!0,writable:!0}),n[h]=i,f.no==a)return f;if(s.patch_bug5&&u&&i<r.length-2&&m+s.tolerance<r[i+1].posts[r[i+1].posts.length-1].time){pref.debug_mode[30]&&console.log("Vailed out by bad data: p"+i);break}}}}}(),flags:"DEFAULT.page_json",hrefs:"DEFAULT.post_json",proto:"DEFAULT.common"},page_html:{footer2:void 0,ths:function(e){var t=this.ths_array(e,e.pn.getElementsByClassName("thread"));if(pref.test_mode[159]){for(var n=0;n<t.length;n++)site2["4chan"].wrap_to_parse.posts(t[n]),t[n].last_modified=t[n].posts[t[n].posts.length-1].time;site2["4chan"].parse_funcs.catalog_json.add_sage(t)}return t},proto:"thread_html"},thread_html:{time_created:"DEFAULT.thread_json",time_bumped:"DEFAULT.thread_json",time_posted:"DEFAULT.thread_json",posts:function(e){return this.posts_array(e,e.pn.querySelectorAll(":scope>.postContainer>.post"))},ths:function(e){return this.ths_array(e,e.pn.getElementsByClassName("thread"))},id:"DEFAULT.thread_html",country:"DEFAULT.thread_html",trip:"DEFAULT.thread_html",flag:"DEFAULT.thread_html",name:"DEFAULT.thread_html",th_init:function(e){e.pn.removeAttribute("class")},nof_posts:function(e){var t=e.pn.getElementsByClassName("postContainer").length,n=e.pn.getElementsByClassName("fileText").length,r=e.pn.getElementsByClassName("summary desktop")[0];if(r){var a=r[brwsr.innerText].replace(/\n/g,"");t+=parseInt(a.replace(/\ post.*/,""),10),n+=parseInt("0"+a.replace(/\ image.*/,"").replace(/[^\ ]*\ /g,""),10)}return Object.defineProperty(e,"nof_files",{value:n,enumerable:!0,configurable:!0,writable:!0}),t},nof_files:function(e){return e.hasOwnProperty("nof_posts")||this.nof_posts(e),e.nof_files},footer:function(e){return this.insert_footer4(e.pn.getElementsByClassName("postInfo")[0])},footer2:function(e){return document.getElementsByClassName("navLinksBot")[0].appendChild(cnst.dom('<div style="clear:both;float:right"></div>'))},sticky:function(e){return 0!=e.pn.getElementsByClassName("stickyIcon").length},op_img_url:function(e){var t=e.pn.querySelector("img[data-md5]");return t?t.getAttribute("src"):void 0},get_thread_links:function(e){return e.pn.querySelectorAll(".replylink,."+pref.script_prefix+"_link")},get_omitted_info:function(e){var t=e.pn.parentNode&&e.pn.parentNode.nextSibling;return t&&t.classList.contains("summary")?t:void 0},set_omitted_info:function(e,t){e.pn.parentNode.parentNode.insertBefore(t,e.pn.parentNode.nextSibling)},replace_omitted_info:function(e,t){e.childNodes[1].textContent=t.childNodes[1].textContent},replace_omitted_info2:function(e,t,n){if("A"===e.tagName){var r=document.createElement("span");r.setAttribute("class","summary"),r.appendChild(document.createElement("span")),r.appendChild(e),e=r}t?("none"===e.childNodes[1].style.display&&(n.domain===site.nickname&&e.childNodes[0].removeAttribute("style"),e.childNodes[1].removeAttribute("style")),this.replace_omitted_info(e,t)):(e.childNodes[0].setAttribute("style","display:none"),e.childNodes[1].setAttribute("style","display:none"))},get_op_src:"thread_json",proto:"post_html"},page_json:{ths:"DEFAULT.page_json",get_op_src:"thread_json",proto:"thread_json"},thread_json:{tn_as:"catalog_html.tn_as",sticky:function(e){return e.posts[0].sticky},get_op_src:function(e,t){return e.op_img_url.indexOf("s.4cdn.org")!=-1?e.op_img_url:(!e.ext&&e.missing_info&&scan.scan_ui("image_hover",{tgts:[e.domain+e.board+"j0"],options:{callback:function(){cataLog.image_hover_reentry(t)},priority:6}}),e.localArchive?site2[e.domain].catalog_json2html3_src(e,e.board):e.ext?e.op_img_url.replace(/s(\.\w+)$/,e.ext):t.src)},consolidate_IDB_result_sub:function(e){e[0].nof_posts=e.length;for(var t=0,n=0;n<e.length;n++)e[n].filename&&t++;e[0].nof_files=t},flags:"DEFAULT.page_json",hrefs:"DEFAULT.post_json",proto:"DEFAULT.thread_json"},post_html:{no:function(e){var t=e.pn.getAttribute("id");return t?parseInt(t.substr(1),10)||parseInt(t.substr(2),10):null},time:function(e){return parseInt(e.pn.getElementsByClassName("dateTime")[0].getAttribute("data-utc"),10)},time_pn:function(e){return 1e3*parseInt(e.getElementsByClassName("dateTime")[0].getAttribute("data-utc"),10)},flag:function(e){return e.pn.getElementsByClassName("flag")[1]||e.tFlag},tFlag:function(e){return e.pn.getElementsByClassName("bfl")[1]},country:function(e){return e.flag?e.flag.getAttribute("class").replace(/\s*flag\-*/g,"").toUpperCase():e.tFlag?e.tFlag.className.replace(/\s*bfl\-*/g,"").toLowerCase():void 0},country_name:function(e){return e.flag?e.flag.getAttribute("title"):e.tFlag?e.tFlag.getAttribute("title"):void 0},txt2com_anchor_class:"quotelink",txt2com_spoiler_replace_txt:"<s>$1</s>",pn_name:function(e){return e.pn.getElementsByClassName("desktop")[0].getElementsByClassName("name")[0]},name:function(e){return this.pn_name(e).textContent},pn_id:function(e){var t=e.pn.getElementsByClassName("posteruid")[1];return t?t.childNodes[1]:void 0},id:function(e){return e.pn_id?e.pn_id.textContent:void 0},pn_trip:function(e){return e.pn.getElementsByClassName("postertrip")[1]},trip:function(e){return e.pn_trip?e.pn_trip.textContent:void 0},time_unit:1e3,com:function(e){return e.pn.getElementsByClassName("postMessage")[0].innerHTML},type_com:"html",txt:function(e){return e.pn.getElementsByClassName("postMessage")[0][brwsr.innerText]},sub:"DEFAULT.post_html",img2src:"DEFAULT.post_html",img2ext:"DEFAULT.post_html",filename:function(e){if(e.pn.getElementsByClassName("file")[0]){var t=e.pn.getElementsByClassName("fileText")[0];if(t){var n=t.getElementsByTagName("a")[0],r=n.getAttribute("title")||n.textContent,a=r.lastIndexOf("."),s=r.slice(0,a);e.ext=r.slice(a);var i=n.nextSibling.textContent.replace(/^ \(/,"").replace(/\)$/,"").replace(",","").split(/ |x/);e.fsize=parseInt(i[0],10)*("KB"===i[1]?1024:"MB"===i[1]?1024e3:1),e.w=parseInt(i[2],10),e.h=parseInt(i[3],10);var o=e.pn.getElementsByTagName("img")[0];return e.md5=o.getAttribute("data-md5"),e.time=parseInt(e.pn.getElementsByClassName("dateTime")[0].getAttribute("data-utc"),10),e.tim=parseInt(n.href.slice(n.href.lastIndexOf("/")+1).split(".")[0],10),e.tn_w=o.naturalWidth,e.tn_h=o.naturalHeight,s}}},prep_mimic:function(e){e.name,e.sub,e.com,e.trip,e.id,e.id,e.country;e.country_name=e.parse_funcs.country_name(e)},nofFiles:"DEFAULT.post_html",proto:"DEFAULT.page_html"},post_json:{proto:"DEFAULT.post_json"},archive_html:{ths:function(e){for(var t=Array.prototype.slice.call(e.pn.getElementById("arc-list").getElementsByTagName("tr")).slice(1,pref.scan.max_archive+1),n=0;n<t.length;n++)t[n].parentNode.removeChild(t[n]);return this.ths_array(e,t)},no:function(e){return parseInt(e.pn.getElementsByTagName("td")[0].textContent,10)},sub:function(e){var t=e.pn.getElementsByTagName("td")[1].firstChild;return"B"===t.tagName?t.textContent:""},com:function(e){return e.pn.getElementsByTagName("td")[1].lastChild.textContent},nof_posts:function(){},nof_files:function(){},filename:function(){return""},footer:function(){return document.createElement("div")},proto:"catalog_html"},html_template:{get country(){return this.exe_sub("country")},get trip(){return this.exe_sub("trip")},get pn_trip(){return this.exe_sub("pn_trip")},get tFlag(){return this.exe_sub("tFlag")}},json_template:{get country(){return this.exe_sub("country")||this.board_flag&&this.board_flag.toLowerCase()||void 0}}},popups_posts_class_hlt:"highlight",popups_href2dbtp:function(e){e=e.replace(/^https*:/,"");var t=e.split(/[\/#]/),n=t.length,r=t[n-1].substr(1),a=n>=2&&t[n-2]||site.no,s=n>=4&&t[n-4]?"/"+t[n-4]+"/":site.board;if("catalog"===t[n-2])r="",a="",s=n>=3&&t[n-3]?"/"+t[n-3]+"/":site.board;else if("/"===e[0])if("/"===e[1]){if(0!==e.indexOf("//boards.4chan"))return[];r=n>=7?t[6].slice(1):"",a=n>=6?t[5]:"",s=n>=4?"/"+t[3]+"/":site.board}else 5!=n&&(r=n>=5?t[4].slice(1):"",a=n>=4?t[3]:"",s="/"+t[1]+"/");return["4chan",s,a,r]},update_posts_remove:function(e,t,n){pref.debug_mode[13]&&e.posts[t].pn.parentNode.parentNode!==n&&console.log(e.posts[t].pn);var r=e.posts[t].pn.parentNode,a=0==t?r.nextSibling:null;n.removeChild(r),a&&"SPAN"===a.tagName&&n.removeChild(a)},update_posts_insert:function(e,t,n,r,a){var s=r<t.length?t[r].pn.parentNode:null;e[n].pn||(e[n].pn=this.post_json2html(e[n],e[n].board));var i=e[n].pn.parentNode||this.post_container(e[n].pn,e[n].no),o=0==n?i.nextSibling:null;a.insertBefore(i,s),o&&"SPAN"===o.tagName&&a.insertBefore(o,s)},update_posts0_class:function(e,t){site2.DEFAULT.update_posts0_class(e,t);var n=e.parentNode&&e.parentNode.nextSibling;n&&n.classList.contains("summary")&&site2.DEFAULT.update_posts0_class(n,t)},post_container:function(e,t,n){var r=document.createElement("div");return r.setAttribute("id","pc"+t),r.setAttribute("class","postContainer "+(n?"op":"reply")+"Container"),n||(r.innerHTML='<div class="sideArrows" id="sa'+t+'">&gt;&gt;</div>'),r.appendChild(e),r},remove_backlink:function(e,t){var n=e&&e.getElementsByClassName("backlink")[0],r=n&&n.childNodes[t];r&&n.removeChild(r)},add_backlinks_bks:function(){var e=document.createElement("div");return e.setAttribute("class","backlink"),function(){return e.cloneNode(!1)}}(),add_backlinks_add_1:function(){var e=document.createElement("a");e.setAttribute("class","quotelink");var t=document.createElement("span");return t.appendChild(e),t.appendChild(document.createTextNode(" ")),function(n,r){e.setAttribute("href",r[5]),e.textContent=r[4];var a=t.cloneNode(!0);if("4chan"!==r[0]||pref.test_mode[91]){a.firstChild.onclick=this.backlink_onclick}n.appendChild(a)}}(),add_backlinks_bks_query:function(e){return e.getElementsByClassName("backlink")[0]},add_backlinks_bks_append:function(e,t){e.getElementsByClassName("desktop")[0].appendChild(t)},toplevel_anchor_pos:2,link_dbtp2href:function(e,t){return(e[1]!=site.board||e[2]!=site.no?e[1]+"thread/"+e[2]:"")+"#"+(t?"q":"p")+e[3]},backlink_onclick:function(){highlightReply.call(this,parseInt(this.textContent.substr(2),10))},backlink_parent_prevSib:function(e){return e.getElementsByClassName("postNum")[1]},link_dbtp2html:function(e,t){return'<a href="'+this.link_dbtp2href(e)+'" class="quotelink">'+(t?t:this.link_dbtp2txt(e))+"</a>"},post_com2txt:function(e){return e.com?this.post_com2txt_finisher(e.com.replace(/<[^>]*>/g," ").replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&quot;/g,'"').replace(/&#039;/g,"'").replace(/&#0*44;/g,",").replace(/&amp;/g,"&"),e):""},post_json2html:function(e,t,n,r,a){if(void 0===a&&(a=e.op||e.resto||e.no),void 0===n&&(n=0===e.resto||e.no==e.op),e.ext){var s=(.005+(e.fsize>1048576?e.fsize/1048576:e.fsize/1024)).toString();s=s.substr(0,s.indexOf(".")+3)+(e.fsize>1048576?" MB":" KB");var i=site2[e.domain].catalog_json2html3_src(e,t),o=site2[e.domain].catalog_json2html3_thumbnail(e,t),l=n?1:(e.tn_w>e.tn_h?e.tn_w:e.tn_h)/125,p='<div class="file" id="f'+e.no+'"><div class="fileText" id="fT'+e.no+'">File: <a '+(e.filename.length>30?'title="'+e.filename+e.ext+'" ':"")+'href="'+i+'" target="_blank">'+(e.spoiler?"Spoiler Image":e.filename.length>30?e.filename.slice(0,25)+"(...)":e.filename)+e.ext+"</a> ("+s+", "+e.w+"x"+e.h+')</div><a class="fileThumb" href="'+i+'" target="_blank"><img src="'+o+'" alt="'+s+'" data-md5="'+e.md5+'" style="height: '+(e.spoiler?100:n?e.tn_h:e.tn_h/l)+"px; width:"+(e.spoiler?100:n?e.tn_w:e.tn_w/l)+'px;"><div data-tip="" data-tip-cb="mShowFull" class="mFileInfo mobile">'+s+" "+e.ext.substr(1).toUpperCase()+"</div></a></div>"}var c=[e.domain,t,a,e.no],_=cnst.dom('<div id="p'+e.no+'" class="post reply">'+this.post_json2html_postinfo(e,!1,c)+"</div>"+(e.ext&&n?p:"")+this.post_json2html_postinfo(e,!0,c)+(n?' &nbsp; <span>[<a href="'+site2[c[0]].link_dbtp2href_abs(c)+'" class="replylink">Reply</a>]</span>'+(r?r.replace(/>\[/g,">").replace(/<a/g,"<span>[<a").replace(/\]<\/a/g,"</a>]</span"):""):"")+("4chan"===e.domain&&"4chan"===site.nickname?'<a href="#" class="postMenuBtn" title="Post menu" data-cmd="post-menu">▶</a>':"")+"</div>"+(e.ext&&!n?p:"")+'<blockquote class="postMessage" id="m'+e.no+'">'+(e.com||"")+"</blockquote></div>");return e.ext&&e.func_resize&&e.func_resize(_.childNodes[n?1:2]),_},post_json2html_postinfo:function(e,t,n){return'<div class="postInfo'+(t?" desktop":"M mobile")+'" id="pi'+(t?"":"m")+e.no+'">'+(t?'<input type="checkbox" name="'+e.no+'" value="delete"> '+(e.sub?'<span class="subject">'+e.sub+"</span> ":""):"")+this.post_json2html_nameblock(e,t)+'<span class="dateTime'+(t?"":" postNum")+'" data-utc="'+e.time_tu1000+'">'+site2.common.change_utc_to_local(e.time_tu)+(t?'</span> <span class="postNum desktop">':" ")+'<a href="'+site2[n[0]].link_dbtp2href_abs(n)+'" title="Link to this post">No.</a><a href="'+site2[n[0]].link_dbtp2href_abs(n,!0)+'" title="Reply to this post">'+e.no+"</a></span>"},post_json2html_nameblock:function(e,t){var n;return'<span class="nameBlock"><span class="name">'+e.name+"</span> "+(e.trip?'<span class="postertrip">'+e.trip+"</span> ":"")+(e.capcode?'<strong class="capcode hand id_mod" title="Highlight posts by Moderators">##'+e.capcode+"</strong>":"")+(e.since4pass?'<span title="Pass user since '+e.since4pass+'" class="n-pu"></span>':"")+(e.id?'<span class="posteruid id_'+e.id+'">(ID: <span class="hand" title="Highlight posts by this ID"'+(t?(n=this.post_json2html_colorID(e),' style="color: '+n[1]+"; background-color: rgb("+n[0]+');"'):"")+">"+e.id+"</span>)</span> ":"")+site2["4chan"].post_flag2html(e)+(t?"</span> ":"<br></span>")},post_flag2html:function(e){return e.board_flag?'<span title="'+e.flag_name+'" class="bfl bfl-'+e.board_flag.toLowerCase()+'"></span>':e.country?"<span "+(e.country_name?'title="'+e.country_name+'" ':"")+'class="flag flag-'+e.country.toLowerCase()+'"></span>':""},post_json2html_colorID:function(e){for(var t=0,n=0;n<e.id.length;n++)t=(t<<5)-t+e.id.charCodeAt(n);var r=t>>24&255,a=t>>16&255,s=t>>8&255;return[r+","+a+","+s,.299*r+.587*a+.114*s>125?"black":"white"]},page_json2html3_skelton:function(e){var t=document.createElement("div");return t.setAttribute("class","thread"),t.setAttribute("id","t"+e.no),t},page_json2html3:function(e,t,n,r,a){var s=this.page_json2html3_skelton(e),i=t&&this.page_json2html3_cloneOPWithoutFooter(e.posts[0].pn)||this.post_json2html(e.posts&&e.posts[0]?e.posts[0]:e,e.board,!0,site2[e.domain].short_link(e.key,e.nof_posts,2,"[Last "," Posts]"),e.posts[0].no);if(i.setAttribute("class","post op"),s.appendChild(this.post_container(i,e.posts[0].no,!0)),e.posts[0].pn=i,e.posts){for(var o=1;o<e.posts.length;o++){var l=t&&e.posts[o].pn&&e.posts[o].pn.cloneNode(!0)||this.post_json2html(e.posts[o],e.board);s.appendChild(this.post_container(l,e.posts[o].no)),e.posts[o].pn=l}a||this.page_json2html3_add_omitted_info(e,n,r)}return s},page_json2html3_prep_omitted_info:function(e,t,n){var r=this.parse_funcs.page_html.get_omitted_info(e);return r||(r=document.createElement("span"),r.setAttribute("class","summary"),r.innerHTML='<img class="extButton expbtn" title="Expand thread" alt="+" data-cmd="expand" data-id="'+t.posts[0].no+'" src="//s.4cdn.org/image/buttons/burichan/post_expand_plus.png"><span class="summary"></span><span style="display: none;">Showing all replies.</span>',t.domain!==site.nickname&&(r.childNodes[0].style.display="none"),this.parse_funcs.page_html.set_omitted_info(e,r)),n&&r.appendChild(cnst.config_expander(t.key)),r.childNodes[1]},page_json2html3_set_omitted_info:function(e,t){return e<=0?"Showing all replies.":e+(1==e?" reply":" replies")+(t?" and "+t+" image"+(1!==e?"s":""):"")+" omitted."},catalog_json2html3_thumbnail:function(e,t){return e.ext?e.spoiler?"//s.4cdn.org/image/spoiler-a1.png":this.protocol+"//i.4cdn.org"+t+e.tim+"s"+(".jpg"===e.ext||".png"===e.ext||".gif"===e.ext||".webm"===e.ext?".jpg":e.ext):""},catalog_json2html3_src:function(e,t){return e.ext?this.protocol+"//i.4cdn.org"+t+e.tim+e.ext:""},catalog_json2html3:function(e,t,n,r){var a,s,i=this.catalog_json2html3_skelton(e),o=pref.catalog.format.thumb,l="small"===o.size&&150===o.small.w1&&150===o.small.h1?.6:"large"===o.size&&250===o.large.w1&&250===o.large.h1?1:(a=o[o.size].w1/e.tn_w,s=o[o.size].h1/e.tn_h,a<s?a:s);return i.innerHTML='<a href="'+site2[e.domain].link_dbtp2href_abs([e.domain,e.board,e.no,e.no])+'"><img alt="" id="thumb-'+e.no+(e.tn_w?'" width="'+e.tn_w*l:"")+(e.tn_h?'" height="'+e.tn_h*l:"")+'" src="'+n+'" data-id="'+e.no+'"></a><div title="(R)eplies / (I)mages" id="meta-'+e.no+'" class="meta">'+(r?"R: <b>"+e.nof_posts+"</b> / I: <b>"+e.nof_files+"</b>":"")+'</div><div class="teaser">'+(e.sub?"<b>"+e.sub+"</b>":"")+(e.com?(e.sub?": ":"")+e.com:"")+"</div>",i},catalog_json2html3_skelton:function(e){return cnst.dom('<div class="thread" id="thread-'+e.no+'"></div>')},catalog_merge:function(e,t,n,r){if(1===t.isShown){t.pn.classList.add(pref.script_prefix+"_merged");var a=t.pn.getElementsByClassName("threadIcons")[0],s=n.footer.add_menu(t.pn.insertBefore(cnst.dom('<div style="clear:both" class="meta"></div>'),t.pn.childNodes[a?2:1]));t.footer=[s],t.cns=[s,t.pn.childNodes[a?4:3],t.pn.childNodes[0]]}var i=e.getElementsByClassName("threadIcons")[0],o=[e.childNodes[i?2:1],e.childNodes[i?3:2],e.childNodes[0]];return gGEH.pns_all_keys.set(o[2],r),t.pn!==e&&(t.pn.insertBefore(o[2],t.cns[0]),t.pn.insertBefore(o[0],t.cns[1]),t.pn.appendChild(o[1]),n.image_resize_img(o[2].firstChild)),o},catalog_separate:function(e,t,n,r,a){var s=this.catalog_json2html3_skelton(n);return 2===e.isShown&&(e.pn.classList.remove(pref.script_prefix+"_merged"),e.cns=null),s.appendChild(t[2]),e.cns&&t[0]===e.cns[0]&&(e.cns[0]=t[0].nextSibling),s.appendChild(t[0]),e.cns&&t[1]===e.cns[1]&&(e.cns[1]=t[1].nextSibling),s.appendChild(t[1]),r.image_resize_img(t[2].firstChild,!0),a&&r.image_resize_img(e.pn.firstChild.firstChild,!0),s},catalog_reorder:function(e,t,n,r){0==r&&(n.image_resize_img(e[2].firstChild,!0),n.image_resize_img(t.pn.firstChild.firstChild)),t.pn.insertBefore(e[2],t.pn.childNodes[r]||null);var a=t.isShown+(t.pn.childNodes[t.isShown]===t.footer[0]?1:2);t.pn.insertBefore(e[0],t.pn.childNodes[a+r]||null),t.pn.insertBefore(e[1],t.pn.childNodes[a+t.isShown+r]||null)},favicon:{__proto__:site2.DEFAULT.favicon,none:"/favicon.ico",reply:"png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAoUlEQVQ4T61TwRGAMAiTmexMDuVMOlM1XOEoAj60L20gDUlLy8dF6Kd+dM/TqTEmK6shAe4GW8zfQlLVMAGat2NVgr2dUDWJymomBRlJdUCoAEdbFZ7A4qEHw9jHCM5U/k1TiEyMkiqj8ikIgY1YCXxUUQp2NCW3F8malZno9kk9qKLKMKj4nwAScaGiETw2KRix8RWG5MhEjynB24usXusFrlPCCCmAi/UAAAAASUVORK5CYII=",reply_to_me:"png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAvUlEQVQ4T61TXRrDIAiDXWmeabvTzlSvVGb8hFIK3ct8aeUnJkSZxmLZBF+/hBvHWLafRQDY6Wn5B3WKANUhrIkIADQF0Zqxt0NGbP5PACREDhXMDFZREr22g+Wn9VmTMnj3RlqwmKTNJYNfAGi8MPD61mAvEnzAZlDZmA0xs7q08Q7AW5wCVC54aWaxl4A5qFWVCyE+DF830Tf7Kd/ZCBb/BwBFyMgkxNyJgVKFv5CTXeWYM4DqLsTHlD33Lx2GzAg15eTiAAAAAElFTkSuQmCC"},stats_ID:function(e,t,n){n.sID||(n.sID={ids:{},cs:{},nid:0,nc:0,np:0,h:null});var r=n.sID;if(e.unique_ips&&(r.np=e.unique_ips,!e.id&&e.posts)){r.h||(r.h=[]);var a=r.h.length;r.h[a-3]!=e.posts[e.posts.length-1].no||r.h[a-2]!=e.nof_posts||r.h[a-1]!=e.unique_ips?r.h.push(e.posts[e.posts.length-1].no,e.nof_posts,e.unique_ips):e.nof_posts<n.nof_posts&&scan.list_nup.add(n,0,!0)}if(t&&t.length>0&&(e.id||e.country))for(var s=0;s<t.length;s++){var i=t[s].country;if(i&&(r.cs[i]?r.cs[i]++:(r.cs[i]=1,r.nc++)),t[s].id){var o=(i||"")+t[s].id;r.ids[o]?r.ids[o]++:(r.ids[o]=1,r.nid++)}}return 1==e.nof_posts?(r.np=1,!1):t&&t.length>0&&pref.threadStats.full&&!e.id&&!e.unique_ips},get_icon:function(e,t,n,r){return"sticky"==n?e.getElementsByClassName("stickyIcon")[0]:null},add_icon:function(e,t,n,r){var a,s,i="sticky"===n?this.make_tack():this.make_showAlways();return("headline"!==t&&"catalog"!==t?e.getElementsByClassName("postNum")[1]:e.getElementsByClassName("threadIcons")[0]||(a=cnst.dom('<div class="threadIcons"></div>'),"headline"===t?(s=e.getElementsByClassName(pref.script_prefix+"_footer")[0],s.parentNode.insertBefore(a,s)):e.insertBefore(a,e.getElementsByClassName("meta")[0]))).appendChild(i),i}},site2["4chanB"]={domain_url:"boards.4channel.org",proto:"4chan"},site2["4chanR"]={domain_url:"boards.4chan.org",home:site.protocol+"//boards.4chan.org/pol/",proto:"4chan"}),pref.features.domains.meguca&&(site2.meguca1={nickname:"meguca",protocol:"https:",home:"https://meguca.org/favicon.ico",
domain_url:"meguca.org",domain_url_image:"meguca.org",features:{page:!1,graph:!1,setting2:!1,thread_reader:!1},components:{boardlist:"#navTop"},pref_default:{catalog:{image_hover:!0}},boards_json:{boards:[{board:"a"},{board:"an"},{board:"cr"},{board:"g"},{board:"v"}]},check_func:function(){var e=window.location.href;return e.indexOf("/meguca.org/")!=-1?(site.whereami=e.indexOf("/catalog")!=-1?"catalog":e.search(/page[0-9]/)!=-1?"page":e.search(/[0-9]+$/)!=-1?"thread":"other",site.config("meguca.org",this.nickname),site.max_page=3,site.header_height=function(){var e=document.getElementById("banner");return e?e.offsetHeight:0},!0):(this.prep_own_posts(),!1)},make_url4:function(e){var t=this.protocol+"//"+this.domain_url;return"page_json"===e[3]&&0==e[2]&&(e[3]="catalog_json"),"page_html"===e[3]?[t+(0!=e[2]?parseInt(e[2],10)+1:""),"html"]:"catalog_json"===e[3]?[t+"/api/board"+e[1].substr(0,e[1].length-1),"json"]:"thread_html"===e[3]?[t+e[1]+e[2],"html"]:"thread_json"===e[3]?[t+"/api/thread/"+e[2],"json"]:void 0},catalog_get_native_area:function(){return"catalog"===site.whereami?document.getElementById("catalog"):document.getElementsByName("postcontrols")[0]},catalog_native_prep:function(e,t,n){var r="catalog"===site.whereami?document.getElementsByTagName("threads")[0].getElementsByTagName("aside")[0]:document.getElementsByName("postcontrols")[0];if("catalog"===site.whereami){for(var a=document.createElement("span");t.firstChild;)a.appendChild(t.firstChild);t=a,t.appendChild(t.removeChild(t.childNodes[3]).firstChild),t.setAttribute("style","float:right")}else if("page"===site.whereami){var s=document.getElementsByName("postcontrols")[0];s.parentNode.insertBefore(document.createElement("hr"),s.nextSibling)}site.whereami,r.parentNode.insertBefore(t,r),r.parentNode.insertBefore(e,document.getElementById("catalog"));var i=e.getElementsByTagName("select")["catalog.order.ordering"];i.setAttribute("style","float:left"),"catalog"===site.whereami?r.parentNode.insertBefore(i,r):t.childNodes[3].insertBefore(i,t.childNodes[3].firstChild),r.setAttribute("style","float:left"),r.parentNode.insertBefore(t.childNodes[3],r.nextSibling)},catalog_json2html3:function(e,t,n,r){var a=document.createElement("article"),s=site2[e.domain].make_url4([e.domain,e.board,e.no,"thread_html"])[0],i=e.tn_w||e.posts[0].tn_w,o=e.tn_h||e.posts[0].tn_h,l=150/(i>o?i:o),p=site2[e.domain].historyAPI&&pref.pref2.meguca.historyAPI?"history":"",c=p+" "+pref.script_prefix+"_link",_=site2[e.domain].short_link(e.key,e.nof_posts,1,"Last ","");return a.innerHTML='<a target="_blank" rel="nofollow" href="'+s+'"'+(p?' class="'+p+'"':"")+'><img src="'+n+'" width="'+i*l+'" height="'+o*l+'" class="expanded"></a><br><small><span title="Replies/Images">'+(r?e.nof_posts-1+"/"+(e.nof_files-1):"")+'</span><span class="act expansionLinks"><a href="'+s+'" class="'+c+'">Expand</a>'+(_?"] ["+_:"")+"</span></small><br>"+(e.sub?"<h3>"+e.sub+" </h3>":"")+(e.com?e.com:""),a},prep_own_posts_event:function(e){e&&"mine"===e.key&&site2.meguca.prep_own_posts(),"meguca"===window.name&&send_message("parent",["OWN_POSTS",window.name,site3[window.name].own_posts.ALL])},prep_own_posts_event_received:function(e){site3[this.nickname].own_posts.ALL=e},prep_own_posts:function(e){if(!site3[this.nickname].own_posts.ALL){site3[this.nickname].own_posts.ALL={};for(var t=["/a/","/an/","/cr/","/g/"],n=0;n<t.length;n++)site3[this.nickname].own_posts[t[n]]=Object.create(site3[this.nickname].own_posts.ALL)}if(localStorage){var r=JSON.parse(localStorage.mine||"{}");for(var a in r)site3[this.nickname].own_posts.ALL[a]=null}},wrap_to_parse:{get:site2.DEFAULT.wrap_to_parse.get,posts:function(e){delete Object.getPrototypeOf(e.posts[0]).com}},short_link:function(e,t,n,r,a){var s=this.make_url4(common_func.name2dbt(e))[0],i=pref.script_prefix+"_link";return(!n||n>1?'<a href="'+s+'?last=50" class="'+i+'">'+r+"50"+a+"</a>":"")+'<a href="'+s+'?last=100" class="'+i+'">'+r+"100"+a+"</a>"},catalog_json2html3_src:function(e){return e.image?"/static/src/"+e.image.src:void 0},catalog_json2html3_thumbnail:function(e){return e.image?"/static/"+(void 0===e.image.spoiler||pref[cataLog.embed_mode].open_spoiler_image?void 0!==e.image.thumb?"thumb/"+e.image.thumb:"src/"+e.image.src:"spoil/spoilers"+e.image.spoiler+".png"):void 0},post_json2html_fname_server:function(e){return e.image?e.image.src:void 0},post_json2html_fname:function(e){return e.image?e.image.imgnm:void 0},popups_href2dbtp:function(e){var t=e.split(/[\/#]/),n=t[t.length-1],r=t[t.length-2];return["meguca","/"+t[t.length-3]+"/",r,n]},link_dbtp2href:function(e){return e[1]+e[2]+"#"+e[3]},time_offset:-5,parse_funcs:{post_json:{get no(){return this.num},get sub(){return this.subject},name:"Anonymous",get txt(){return this.body},get com(){return this.body?this.body.replace(this.anchor_regex,this.anchor_func):""},get filename(){return this.image?this.image.imgnm:void 0},get w(){return this.image?this.image.dims[0]:void 0},get h(){return this.image?this.image.dims[1]:void 0},get tn_w(){return this.image?void 0===this.image.spoiler||pref[cataLog.embed_mode].open_spoiler_image?this.image.dims[2]:250:void 0},get tn_h(){return this.image?void 0===this.image.spoiler||pref[cataLog.embed_mode].open_spoiler_image?this.image.dims[3]:250:void 0},get fsize(){return this.image?this.image.size:void 0},get ext(){return this.image?this.image.ext:void 0},domain:"meguca",get domain_html(){return site.nickname},get parse_funcs_html(){return site2[site.nickname].parse_funcs[site.whereami+"_html"]},anchor_regex:/(>>)([0-9]+)/g},thread_json:{ths:function(e,t){for(var n={board:t.board,anchor_func:function(){var e=['<a href="'+t.board+t.thread+"#",'">&gt;&gt;',"</a>"];return function(t,n,r){return e[0]+r+e[1]+r+e[2]}}(),get com(){return this.body},__proto__:site2[t.domain].parse_funcs.post_json},r=0;r<e.length&&void 0===e[r].state;)e[r++].__proto__=n;return r!==e.length&&e.splice(r,e.length-r),[{posts:e,nof_posts:e.length,key:t.domain+t.board+t.thread,no:t.thread,__proto__:t}]},get_op_src:function(e){return site2[e.domain].protocol+"//"+site2[e.domain].domain_url+"/static/src/"+e.posts[0].image.src},op_img_url:function(e){return site2[e.domain].protocol+"//"+site2[e.domain].domain_url+"/static/"+site2.meguca.catalog_json2html3_thumbnail(e.posts[0])},nof_files:function(e){return e.posts[0].imgctr-1},time:function(e){return e.posts[0].time},time_posted:function(e){return e.posts[e.posts.length-1].time},time_created:function(e){return e.posts[0].time},time_bumped:function(e){for(var t=e.posts.length-1;t>0;){if(!e.posts[t].email||"sage"!==e.posts[t].email)return e.posts[t].time;t++}return e.posts[0].time},sticky:function(e){return!1},com:function(e){return e.posts[0].body},sub:function(e){return e.posts[0].sub},name:function(e){return e.posts[0].name},filename:function(e){return e.posts[0].image.imgnm},type_com:"txt",time_unit:1,add_op_img_url:function(e,t,n){for(var r=0;r<e.length;r++)e[r].image&&(e[r].op_img_url=site2[n].protocol+"//"+site2[n].domain_url+"/static/thumb/"+e[r].image.thumb)},footer:"catalog_html",footer_prep:"catalog_html",proto:"DEFAULT.thread_json"},catalog_html:{footer:function(e){return e.pn.getElementsByClassName("counters")[0]},footer_prep:function(e){e.footer.textContent=""},ths:function(e){if(!pref.pref2.meguca.historyAPI)for(var t=e.pn.getElementsByClassName("history"),n=t.length-1;n>=0;n--)"Expand"===t[n].textContent||"Last 100"===t[n].textContent?t[n].setAttribute("class",pref.script_prefix+"_link"):t[n].removeAttribute("class");var r=this.ths_array(e,e.pn.getElementsByTagName("article"));if("/all/"===site.board)for(var n=r.length-1;n>=0;n--)r[n].board=r[n].pn.getElementsByTagName("a")[0].getAttribute("href").replace(/\d+$/,"");return r},no:function(e){return e.pn.getElementsByTagName("a")[0].getAttribute("href").replace(/.*\//g,"")},time_bumped:function(e){},time_created:function(e){},nof_posts:function(e){return parseInt(e.footer.textContent.split("/")[0],10)},nof_files:function(e){return parseInt(e.footer.textContent.split("/")[1],10)},sub:function(e){var t=e.pn.getElementsByTagName("h3")[0];return t?common_func.escape(t.textContent):void 0},name:function(e){},com:function(e){return e.pn.childNodes[e.pn.childNodes.length-1].textContent},sticky:function(e){return!1},op_img_url:function(e){var t=e.pn.getElementsByTagName("img")[0];return t&&t.getAttribute("src")||""},get_op_src:function(e){return e.op_img_url.replace(/thumb/,"src")},dynamic_image_hover:!0,missing_info:1,img2src:function(e,t){if(t||(t=this.get_lth_from_node(e)),!t)return null;var n=e.src;return t.th&&t.th.posts[0].ext?n=n.replace(/thumb/,"src").replace(/\.\w+$/,t.th.posts[0].ext):t.th.missing_info&&scan.scan_ui("image_hover",{tgts:[t.key],options:{callback:function(){cataLog.image_hover_reentry(e)},priority:6}}),n}},post_html:{time_pn:function(e){var t=e.getElementsByTagName("time")[0];return Date.parse(t.title||t.textContent)+36e5*(pref.localtime_offset-site2.meguca.time_offset)},pn_name:function(e){return e.pn.getElementsByClassName("name")[0]}}},general_event_handler:{page:{mouseover:function(e){}},catalog:{image_hover_check_mode:function(e){return"catalog"===e.parentNode.parentNode.parentNode.parentNode.id?"catalog":"page"},recSearch_thread:function(e,t,n){var r=site2.DEFAULT.general_event_handler.common.recSearch_thread;return r(e,t,"op")||n&&r(e,t,n)||null},__proto__:site2.DEFAULT.general_event_handler.catalog}},favicon:{__proto__:site2.DEFAULT.favicon,none:"/static/favicon.ico",reply:"/static/css/ui/unreadFavicon.ico",reply_to_me:"/static/css/ui/replyFavicon.ico"},make_tack:function(){var e=document.createElement("div");return e.innerHTML='<svg class="sticky" xmlns="http://www.w3.org/2000/svg" width="8" height="8" viewBox="0 0 8 8"><path d="M1.34 0a.5.5 0 0 0 .16 1h.5v2h-1c-.55 0-1 .45-1 1h3v3l.44 1 .56-1v-3h3c0-.55-.45-1-1-1h-1v-2h.5a.5.5 0 1 0 0-1h-4a.5.5 0 0 0-.09 0 .5.5 0 0 0-.06 0z"></path></svg>',e.childNodes[0]}},site2.meguca2={home:"https://meguca.org/assets/favicons/default.ico",components:{boardlist:"#banner"},boards_json:void 0,check_func:function(e){var t=window.location.href;if(t.indexOf("/meguca.org/")!=-1){if(site.whereami=t.search(/[A-z]+\/(\?page=\d+)*$/)!=-1?"page":t.search(/[0-9]+(\?last=\d+)*$/)!=-1?"thread":t.search(/catalog\/*$/)!=-1?"catalog":"other",site.config("meguca.org",this.nickname,e),site.no="thread"===site.whereami?parseInt(t.replace(/.*meguca\.org\/\w*\/([0-9]+)/,"$1"),10):"","page"===site.whereami){var n=t.indexOf("?page=");site.page=n!=-1&&parseInt(t.substr(n+6),10)||0}else site.page=null;if(e)return;return site.max_page=3,site.header_height=function(){var e=document.getElementById("banner");return e?e.offsetHeight:0},!0}return!1},check_func_whereami:function(){},utilize_boards_json:!0,url_boards_json:function(){return["https://meguca.org/json/boardTimestamps","json"]},postprocess_board:function(e){var t=0;for(var n in e){var r=liveTag.mems.init({domain:this.nickname,board:"/"+n+"/"});r.o=t++,Object.defineProperty(r,"max",{value:e[n],writable:!0}),void 0===r.read_max&&Object.defineProperty(r,"read_max",{value:0,writable:!0})}},make_url4:function(e){var t=this.protocol+"//"+this.domain_url;return"page"===e[3].substr(0,4)&&0==e[2]&&(e[3]="catalog_json"),"catalog_json"===e[3]?[t+"/json"+e[1],"json","meguca"+e[1]+"j0"]:"thread_html"===e[3]?[t+e[1]+e[2],"html"]:"thread_json"===e[3]?[t+"/json"+e[1]+e[2],"json"]:void 0},catalog_get_native_area:function(){return document.getElementById("catalog"===site.whereami?"catalog":"page"===site.whereami?"index-thread-container":"threads")},catalog_get_native_scroll_area:function(){return"catalog"===site.whereami?document.getElementsByTagName("section")[1]:window},catalog_native_prep_wait_loop_timeout:100,catalog_native_prep_wait_loop:function(e,t){--this.catalog_native_prep_wait_loop_timeout<0||(("catalog"!==e||document.getElementsByName("sortMode")[0])&&("page"!==e||document.getElementById("catalog-controls")&&document.getElementById("index-thread-container"))&&("thread"!==e||document.getElementById("expand-images")&&document.getElementById("threads"))?t():setTimeout(function(){this.catalog_native_prep_wait_loop(e,t)}.bind(this),1e3))},catalog_native_prep:function(e,t,n){var r="catalog"===site.whereami?document.getElementsByName("sortMode")[0]:"page"===site.whereami?document.getElementById("catalog-controls").getElementsByTagName("input").search:document.getElementById("expand-images");if("catalog"!==site.whereami||r.nextSibling!==cataLog.components.ordering){if(!cataLog.components.initialized){t.setAttribute("style","float:right"),cataLog.components.pn12_0=t,cataLog.components.pn_hi=t.removeChild(t.childNodes[3]);var a=function(){cataLog.catalog_obj2.func_track_reset(),cataLog.insert_myself(null,null,null,!0),cataLog.show_catalog()},s=function(n){pref[site.whereami].embed&&(cataLog.general_event_handler.destroy(),cataLog.triage_parent_set(),cataLog.general_event_handler=new cataLog.GEH(cataLog.parent),cataLog.general_event_handler.init(),a(),site2.meguca.catalog_native_prep(e,t))};new MutationObserver(s).observe(document.getElementById("threads"),{childList:!0}),pref_func.settings.onchange_funcs.button_test=s;var i=document.getElementById("loading-image"),o="none"!==i.style.display,l=function(n){if("none"!==n[0].target.style.display)site2.meguca.historyAPI_blocking=!0,"thread"===site.whereami&&site2.meguca.prep_own_posts();else{if(site2.meguca.historyAPI_blocking=!1,!o){cataLog.DIH.image_hover_remove(),cataLog.general_event_handler.destroy();for(var r in cataLog.threads)pClg.remove_thread(r,!0);site2.meguca.check_func(!0),pref[site.whereami].embed&&(cataLog.set_embed_xxxx(),cataLog.triage_parent_set(),cataLog.general_event_handler=new cataLog.GEH(cataLog.parent),cataLog.general_event_handler.init(),"catalog"!==site.whereami&&"page"!==site.whereami||pref.test_mode[90]||a(),site2.meguca.catalog_native_prep(e,t)),recovery.reentry(),receive_message_emu()}o=!1}};new MutationObserver(l).observe(i,{attributes:!0})}if("catalog"===site.whereami?(r.parentNode.appendChild(t),r.parentNode.parentNode.insertBefore(cataLog.components.pn_hi,r.parentNode)):(r.parentNode.insertBefore(t,r),r.parentNode.insertBefore(cataLog.components.pn_hi,r)),"catalog"===site.whereami){var p=document.getElementById("catalog");p.parentNode.insertBefore(e,p)}else r.parentNode.insertBefore(e,document.getElementById("catalog"));"catalog"===site.whereami?site2.DEFAULT.catalog_native_prep_swap_sortSel(r):r.parentNode.insertBefore(cataLog.components.ordering,r.nextSibling),"catalog"!=site.whereami&&"page"!=site.whereami||(document.getElementById("banner").style="height:auto",pClg.kwd_init(document.getElementById("catalog-controls").getElementsByTagName("input").search,e)),cataLog.components.initialized=!0}},post_json2html:site2["4chan"].post_json2html,page_json2html3_skelton:site2["4chan"].page_json2html3_skelton,page_json2html3:site2["4chan"].page_json2html3,page_json2html3_replace_expander:site2["4chan"].page_json2html3_replace_expander,page_json2html3_prep_omitted_info:site2["4chan"].page_json2html3_prep_omitted_info,page_json2html3_set_omitted_info:site2["4chan"].page_json2html3_set_omitted_info,post_container:site2["4chan"].post_container,wrap_to_parse:site2.DEFAULT.wrap_to_parse,catalog_json2html3_thumbnail:function(e){return e.image?this.protocol+"//"+this.domain_url_image+(void 0===e.image.spoiler||pref[cataLog.embed_mode].open_spoiler_image?14===e.image.thumbType?"/audio.png":"/images/thumb/"+e.image.SHA1+(0===e.image.thumbType||void 0===e.image.thumbType&&0===e.image.fileType?".jpg":".png"):"/spoil/default.jpg"):void 0},catalog_json2html3_src:function(e){return e.image?this.protocol+"//"+this.domain_url_image+"/images/src/"+e.image.SHA1+(e.ext||Object.getOwnPropertyDescriptor(this.parse_funcs.post_json_template,"ext").get.call(e)):void 0},post_json2html_fname_server:function(e){return e.image?e.image.SHA1+(0===e.image.fileType?".jpg":".png"):void 0},post_json2html_fname:function(e){return e.image?e.filename+e.ext:void 0},parse_funcs:{page_html:{get_omitted_info:site2["4chan"].parse_funcs.page_html.get_omitted_info,set_omitted_info:site2["4chan"].parse_funcs.page_html.set_omitted_info,replace_omitted_info:site2["4chan"].parse_funcs.page_html.replace_omitted_info,replace_omitted_info2:site2["4chan"].parse_funcs.page_html.replace_omitted_info2},thread_json:{ths:function(e,t){var n=this.prep_th_posts(e);return n.nof_posts=n.posts.length,e.__proto__=t,[n]},prep_th_posts:function(e){var t=Object.create(e);t.sticky&&(t.sticky=!0),t.board="/"+e.board+"/",e.no=e.id||e.no,delete e.id;var n=[e];if(e.posts)for(var r=0;r<e.posts.length;r++){var a=e.posts[r];a.id&&(a.no=a.id,delete a.id),n[n.length]=a}return t.posts=n,t},get_op_src:function(e){return site2[e.domain].catalog_json2html3_src(e.posts[0])},op_img_url:"DEFAULT.common",time_unit:1e3,type_com:"txt",posts_full:null,has_editing:!0,posts_obj:function(e,t){for(var n={},r=e.posts.length;--r>=0;){var a=e.posts[r].no;if(n[a]=e.posts[r],a===t)break}return n},key:"DEFAULT.common"},catalog_json:{ths:function(e,t){var n=[],r=parseInt(t.page||0,10);e.threads&&(e=e.threads);for(var a=0;a<e.length;a++){var s=this.prep_th_posts(e[a]);s.page=r+Math.floor(a/15)+"."+a%15,e[a].__proto__=t,n[n.length]=s}return n},has_posts:!0,proto:"thread_json"},shortCatalog_json_template:{proto:"catalog_json_template"},page_json_template:{proto:"catalog_json_template"},catalog_json_template:{dont_have_com:!0,get nof_posts(){return this.postCtr},proto:"thread_json_template"},thread_json_template:{get time_posted(){return 1e3*this.replyTime},get time_bumped(){return 1e3*this.bumpTime},get time_created(){return 1e3*this.time},get nof_files(){return this.imageCtr},get com(){return this.body},proto:"post_json_template"},post_json:{anchor:function(e,t,n,r,a){return a||(a=(r?"/all/":e)+"#p"+n),'<em><a class="history post-link" data-id="'+n+'" href="'+a+'">&gt;&gt;'+n+'</a><a class="hash-link history" href="'+a+'"> #</a> </em>'}},post_json_template:function(){var e=["jpg","png","gif","webm","pdf","svg","mp4","mp3","ogg","zip","7z","tar.gz","tar.xz","flac","noFile","txt"];return{get filename(){return this.image?this.image.name:void 0},get w(){return this.image?this.image.dims[0]:void 0},get h(){return this.image?this.image.dims[1]:void 0},get tn_w(){return this.image?void 0===this.image.spoiler||pref[cataLog.embed_mode].open_spoiler_image?this.image.dims[2]||125:150:void 0},get tn_h(){return this.image?void 0===this.image.spoiler||pref[cataLog.embed_mode].open_spoiler_image?this.image.dims[3]||125:150:void 0},get fsize(){return this.image?this.image.size:void 0},get ext(){return this.image?"."+e[this.image.fileType]:void 0},get sub(){return this.subject?common_func.escape(this.subject):""},get capcode(){return this.auth},get md5(){return this.image?this.image.MD5:void 0},get sha1(){return this.image?this.image.SHA1:void 0},get country(){return this.flag?this.flag.toUpperCase():void 0},name:"Anonymous",get txt(){return this.body},get com(){function e(e,t,n){for(var r=a.links,i=0;i<r.length&&r[i].id!=n;)i++;return i<r.length?s(a.board,r[i].op,n,a.op!=r[i].op,null):e}function t(e){return"<strong>"+e+" ("+(this[n]?this[n++].val:"")+")</strong>"}var n,r=site2[site.nickname].parse_funcs.post_html.txt2com_anchor_class?'" class="'+site2[site.nickname].parse_funcs.post_html.txt2com_anchor_class:"",a=null,s="meguca"===site.nickname?site2.meguca.parse_funcs.post_json.anchor:function(e,t,n,a){return'<a href="'+(a?"/cross/":e)+t+"#p"+n+r+'">&gt;&gt;'+n+"</a>"},i=site2[site.nickname].parse_funcs.post_html.txt2com_spoiler_replace_txt||"<spoiler>$1</spoiler>",o="meguca"===site.nickname?"<em>$1</em>":'<span class="quote">$1</span>';return Object.defineProperty(site2.meguca.parse_funcs.post_json_template,"com",{get:function(){if(!this.body)return"";var r=common_func.escape_text(this.body);return this.links&&(a=this,r=r.replace(/(>>)([0-9]+)/g,e)),r=r.replace(/(^>[^>].*$)/gm,o),r=r.replace(/\*\*(.*?)((\*\*)|$)/gm,i),this.commands&&(n=0,r=r.replace(/^#(pyu|flip|\d*d\d+|8ball)$/gm,t.bind(this.commands))),r=r.replace(/(https*:\/\/[^\s]*)(\s|$)/gm,'<a href="$1" target="_blank">$1</a>$2'),r.replace(/\n/g,"<br>")},enumerable:!0,configurable:!0}),this.com},sticky:!1,get no(){return this.id},time:void 0,flag:void 0,flags:void 0,get parse_funcs_html(){return Object.defineProperty(site2.meguca.parse_funcs.post_json_template,"parse_funcs_html",{value:site2[site.nickname].parse_funcs[site.whereami+"_html"],writable:!0,enumerable:!0,configurable:!0}),this.parse_funcs_html},proto:"DEFAULT.common"}}()},mimic_always:!0,post_com2txt:function(e){return e.body?e.body.replace(/\*\*([^(\*\*)\n]*)((\*\*)|$)/gm," $1 "):""},proto:"meguca1"},common_func.Object_modifyDescriptor(site2.meguca2,"check_func",{writable:!1}),site2.meguca={domain_url_image:"meguca.org/assets",check_func:site2.meguca2.check_func,url_boards_json:function(){return["https://meguca.org/json/board-list","json"]},postprocess_board:function(e){for(var t=0;t<e.length;t++){var n=liveTag.mems.init({domain:this.nickname,board:"/"+e[t].id+"/"});n.o=t,e[t].tags&&0!=e[t].tags.length&&liveTag.postprocess_board_add_btag(e[t].tags,n)}},utilize_boards_json:!1,catalog_get_native_scroll_area:void 0,make_url4:function(e){var t=this.protocol+"//"+this.domain_url;return"catalog_json"===e[3]?[t+"/json/boards"+e[1]+"catalog","json"]:"page_json"===e[3]?[t+"/json/boards"+e[1]+"?page="+e[2],"json"]:"thread_html"===e[3]?[t+e[1]+e[2],"html"]:"thread_json"===e[3]?[t+"/json/boards"+e[1]+e[2],"json"]:"page_html"===e[3]?[t+e[1],"html"]:void 0},differentAPI:!0,historyAPI:!1,historyAPI_blocking:!1,short_link:function(e,t,n,r,a){return'<a href="'+this.make_url4(common_func.name2dbt(e))[0]+'?last=100" class="history lastN-link '+pref.script_prefix+'_link">'+r+"100"+a+"</a>"},wrap_to_parse:{get:site2.DEFAULT.wrap_to_parse.get,posts:function(e,t){site2.DEFAULT.wrap_to_parse.posts(e,t||e.localArchive&&1||void 0,{op:e.no||e.id})}},lth_init:function(e){liveTag.mems.init({board:"/cross/",domain:e.domain}),Object.defineProperty(liveTag.mems.meguca,"/cross/",{value:liveTag.mems.meguca["/cross/"],configurable:!0,enumerable:!1,writable:!0})},prep_own_posts:function(e){window.opener&&"meguca"===window.name?setTimeout(this.prep_own_posts_IDB.bind(this),0):this.prep_own_posts_IDB()},prep_own_posts_IDB:function(e){IDB.req_raw("meguca","meguca","mine",null,this.prep_own_posts_IDB_callback.bind(this),"get_all")},prep_own_posts_IDB_callback:function(e,t,n,r){var a={};for(var s in r)a[r[s].id]=null;site3[this.nickname].own_posts={ALL:a},window.opener&&"meguca"===window.name&&this.prep_own_posts_event()},popups_post_pnode:function(e){for(;"ARTICLE"!==e.tagName&&e.parentNode;)e=e.parentNode;return e},add_backlinks_pn:function(e,t){var n=e.getElementsByClassName("backlinks")[0];return n?{pn:n,hrefs:this.add_backlinks_hrefs(n,t)}:(n=document.createElement("span"),n.setAttribute("class","spaced backlinks"),e.appendChild(n),{pn:n,hrefs:{}})},add_backlinks_hrefs:function(e,t){var n={};if(t)for(var r=e.getElementsByTagName("a"),a=0;a<r.length;a++)n[r[a].getAttribute("href")]=null;else e.innerHTML="";return n},add_backlinks_add_1:function(e,t,n){var r=document.createElement("span");r.innerHTML=site2.meguca.parse_funcs.post_json.anchor(t[1],t[2],t[3],null,n),r=r.childNodes[0],("meguca"!==t[0]||pref.test_mode[91])&&(r.childNodes[0].onclick=this.backlink_onclick,r.childNodes[1].onclick=this.backlink_onclick),e.pn.appendChild(r)},add_backlinks:function(e,t,n,r){for(var a=this.add_backlinks_pn(e,n),s=n||0;s<t.length;s++){var i=this.popups_backlink2dbtpth(t[s],r),o=i[0],l=site2[o].link_dbtp2href_abs(i);if(null!==a.hrefs[l]&&this.add_backlinks_add_1(a,i,l),n)break}},popups_href2dbtp:function(e){var t=e.split(/[\/#]/),n=t[t.length-1].substr(1),r="/"+t[t.length-3]+"/",a=t[t.length-2];return a||(a=-1),["meguca",r,a,n]},toplevel_anchor_pos:2,link_dbtp2href:function(e){return e[1]+e[2]+"#p"+e[3]},popups_post_fetch:function(e,t){httpd.req({initiator:"popup",tgts:[{url:"https://meguca.org/json/post/"+t[3],responseType:"json",tgt:t[0]+"/*/"+t[2]+"#"+t[3],data_type:"json",domain:e.domain}],callback_1:site2[e.domain].popups_post_fetch_callback.bind(site2[e.domain]),IDX:0,RUNNING:0,SUC:0,max:1,dbt:t},8)},popups_post_fetch_callback:function(e,t,n){var r={domain:n.dbt[0],board:n.dbt[1],no:n.dbt[2],type_data:"json",domain_html:site.nickname,key:n.dbt[0]+n.dbt[1]+n.dbt[2]};delete t.response.board;var a={posts:[r,t.response],__proto__:r};site2[a.domain].wrap_to_parse.posts(a);var s=liveTag.mems.init(a);this.popups_fetched(a,s,1)},post_json2html_imagesearch_href:{google:function(e){return"https://www.google.com/searchbyimage?image_url="+e},iqdb:function(e){return"http://iqdb.org/?url="+e},saucenao:function(e){return"http://saucenao.com/search.php?db=999&amp;url="+e},whatAnime:function(e){return"https://whatanime.ga/?url="+e},desustorage:function(e){return"https://desuarchive.org/_/search/image/"+e},exhentai:function(e){return"http://exhentai.org/?fs_similar=1&amp;fs_exp=1&amp;f_shash="+e}},post_json2html_imagesearch_1:function(e,t,n){return'<a class="image-search '+e+'" target="_blank" rel="nofollow" href="'+this.post_json2html_imagesearch_href[e](t)+'">'+n+"</a>"},post_json2html_imagesearch:function(e,t,n,r){return(e.google?this.post_json2html_imagesearch_1("google",t,"G"):"")+(e.iqdb?this.post_json2html_imagesearch_1("iqdb",t,"Iq"):"")+(e.saucenao?this.post_json2html_imagesearch_1("saucenao",t,"Sn"):"")+(e.whatAnime?this.post_json2html_imagesearch_1("whatAnime",t,"Wa"):"")+(e.desustorage&&n?this.post_json2html_imagesearch_1("desustorage",n,"Ds"):"")+(e.exhentai&&r?this.post_json2html_imagesearch_1("exhentai",r,"Ex"):"")},post_json2html:function(e,t,n,r,a){var s=document.createElement("div"),i=e.parse_funcs&&e.parse_funcs.time_unit||1,o=new Date((e.time||0)*i),l=(e.name,""),p="";if(e.ext){var c=(.005+(e.fsize>1048576?e.fsize/1048576:e.fsize/1024)).toString();c=c.substr(0,c.indexOf(".")+3)+(e.fsize>1048576?" MB":" KB");var _=site2[e.domain].catalog_json2html3_src(e,t),d=site2[e.domain].catalog_json2html3_thumbnail(e,t);n||(e.tn_w>e.tn_h?e.tn_w:e.tn_h);l='<figcaption class="spaced"><a class="image-toggle act" hidden=""></a>'+(pref[cataLog.embed_mode].imagesearch.use?'<span class="spaced image-search-container">'+this.post_json2html_imagesearch(pref[cataLog.embed_mode].imagesearch,_,e.md,e.sha1)+"</span>":"")+'<span class="fileinfo"><span class="filesize">'+c+'</span><span class="dims">'+e.w+"x"+e.h+'</span></span><a href="'+("meguca"===e.domain?_.replace(/images\.meguca\.org/,"meguca.org"):_)+'" download="'+e.filename+e.ext+'">'+e.filename+e.ext+"</a></figcaption>",p='<figure><a target="_blank" href="'+_+'"><img src="'+d+'" width="'+e.tn_w+'" height="'+e.tn_h+'"></a></figure>'}return s.innerHTML='<article id="p'+e.no+'" class="glass'+(e.ext?" media":"")+'"><input type="checkbox" class="deleted-toggle"><header class="spaced"><input type="checkbox" class="mod-checkbox hidden"><b class="name">'+e.name+"</b>"+(e.country?'<img class="flag" src="/assets/flags/'+e.country.toLowerCase()+'.svg" title="'+e.country+'">':"")+"<time>"+site2.common.change_utc_to_local(o)+'</time><nav><a class="history" href="#p'+e.no+'">No.</a><a class="history quote" href="#p'+e.no+'">'+e.no+"</a></nav>"+(n?'<span><span class="act"><a class="history expand-link" href="'+t+e.no+'">Expand</a></span>'+(r?'<span class="act">'+r+"</span>":"")+"</span>":"")+'<a class="control"><svg xmlns="http://www.w3.org/2000/svg" width="8" height="8" viewBox="0 0 8 8"><path d="M1.5 0l-1.5 1.5 4 4 4-4-1.5-1.5-2.5 2.5-2.5-2.5z" transform="translate(0 1)"></path></svg></a></header>'+l+'<div class="post-container">'+p+"<blockquote>"+e.com+"</blockquote></div></article>",s.removeChild(s.childNodes[0])},post_container:function(e){return e},update_posts_remove:function(e,t,n){n.removeChild(e.posts[t].pn)},update_posts_insert:function(e,t,n,r,a){var s=r<t.length?t[r].pn:a.getElementsByTagName("aside")[0];e[n].pn||(e[n].pn=this.post_json2html(e[n],e[n].board));var i=e[n].pn;a.insertBefore(i,s)},page_json2html3_skelton:function(e,t){var n=document.createElement("section");return n.setAttribute("class","index-thread"),n.setAttribute("data-id",e.no),n.innerHTML='<input type="checkbox" class="deleted-toggle"><aside class="act posting glass"><a href="'+e.board+e.no+'?last=100#bottom">Reply</a></aside>',t?[n,n.childNodes[1]]:n},page_json2html3:function(e,t,n,r,a){var s=this.page_json2html3_skelton(e,!0),i=s[0],o=s[1],l=this.post_json2html(e.posts&&e.posts[0]?e.posts[0]:e,e.board,!0,site2[e.domain].short_link(e.key,e.nof_posts,2,"Last ",""),e.no);if(i.insertBefore(l,o),e.posts[0].pn=l,e.posts){for(var p=1;p<e.posts.length;p++){var c=this.post_json2html(e.posts[p],e.board);i.insertBefore(c,o),e.posts[p].pn=c}a||this.page_json2html3_add_omitted_info(e,e.posts,e.posts)}return i},page_json2html3_replace_expander:function(e,t,n){var r=this.parse_funcs.page_html.get_omitted_info(e[0]);r&&r.appendChild(cnst.config_expander(n,t))},page_json2html3_add_omitted_info:function(e,t,n){for(var r=0,a=0;a<n.length;a++)r+="html"===n[a].type_data?n[a].pn.getElementsByClassName("figure").length:n[a].filename?1:0;var s=e.nof_files-r,i=e.nof_posts-n.length,o=t?this.parse_funcs.page_html.get_omitted_info(t[0]):null;return 0!=i?(o||(o=document.createElement("span"),o.setAttribute("class","omit"),o.setAttribute("data-omit",i),o.setAttribute("data-image-omit",s),o.innerHTML=' <span class="act"><a href="'+n[0].no+'" class="history">See All</a></span>',("meguca"!==e.domain||pref[cataLog.embed_mode].use_expander_always)&&o.appendChild(cnst.config_expander(e.key)),t&&this.parse_funcs.page_html.set_omitted_info(t[0],o)),o.childNodes[0].textContent=i+(1==i?" post":" posts")+(s?" and "+s+" image"+(1!==i?"s":""):"")+" omitted "):o&&(o.childNodes[0].textContent="Showing all posts."),o},catalog_json2html3:function(e,t,n,r){var a=document.createElement("article");a.id="p"+e.no,a.setAttribute("class","glass media op"+(e.deleted?" deleted":"")),a.setAttribute("data-id",e.no);var s=site2[e.domain].make_url4([e.domain,e.board,e.no,"thread_html"])[0];if(n)var i=e.tn_w||e.posts[0].tn_w,o=e.tn_h||e.posts[0].tn_h,l=150/(i>o?i:o);var p=site2[e.domain].historyAPI&&pref.pref2.meguca.historyAPI?"history":"",c=p+(p?" ":"")+pref.script_prefix+"_link",_=site2[e.domain].short_link(e.key,e.nof_posts,1,"Last ","");return a.innerHTML='<input type="checkbox" class="deleted-toggle">'+(n?'<figure><a class="'+p+'" href="'+t+e.no+'"><img width="'+i*l+'" height="'+o*l+'" class="catalog" src="'+n+'"></a></figure>':"")+'<span class="spaced thread-links hide-empty"><b class="board">'+t+'</b><span class="counters" title="Posts/Images">'+(r?e.nof_posts-1+"/"+(e.nof_files-1):"")+'</span><span class="act">'+("meguca"===e.domain?'<a class="'+p+' lastN-link" href="'+t+e.no+'?last=100">Last 100</a></span>':'<a href="'+s+'" class="'+c+' lastN-link">Expand</a>'+(_?"] ["+_:""))+"</span></span><br>"+(e.sub?"<h3>"+e.sub+" </h3>":"")+"<blockquote>"+(e.com?e.com:"")+"</blockquote>",a},parse_funcs:{shortCatalog_json:{has_posts:!1,proto:"meguca2.catalog_json"},catalog_json:{has_posts:!1},catalog_html:{ths_json:"thread_html",ths:function(e){for(var t=site2.meguca2.parse_funcs.catalog_html.ths(e),n=this.ths_json(e,t.map(function(e){return e.pn}),"shortCatalog_json","catalog"),r=0;r<n.length;r++)n[r].page=Math.floor(r/15)+"."+r%15;return n},get_omitted_info:function(){},set_omitted_info:function(){},pn_name:"thread_html"},page_json:{proto:"meguca2.catalog_json"},post_json:{pn:"DEFAULT.post_json"},page_html:{ths:function(e){for(var t=this.ths_json(e,document.getElementsByClassName("index-thread"),"page_json","page"),n=0;n<t.length;n++)t[n].page=site.page+"."+n;return t},get_max_page:function(e){var t,n=e.getElementsByClassName("pagination")[0];return n?(t=n.childNodes.length,t<=1?t:t-1):1},proto:"thread_html"},thread_html:{ths_json:function(e,t,n,r){var a=JSON.parse(e.pn.getElementById("post-data").innerHTML);a=site2.meguca.wrap_to_parse.get(a,"meguca",e.board,n);for(var s={},i=0;i<t.length;i++)s[t[i].dataset.id]=t[i]
;for(var i=0;i<a.length;i++){a[i].pn=s[a[i].no];var o=a[i].pn&&a[i].pn.getElementsByTagName("article");if(o){for(var l=0;l<a[i].posts.length;l++)a[i].posts[l].pn=o[l];Object.defineProperty(a[i],"footer",{value:this.footer(a[i]),configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(a[i],"type_mimic",{value:r,configurable:!0,enumerable:!0,writable:!0})}}return a[0].__proto__.__proto__.__proto__.parse_funcs_html=site2.meguca.parse_funcs[r+"_html"],a},ths:function(e){return this.ths_json(e,[document.getElementById("thread-container")],"thread_json","thread")},footer:function(e){return site2.DEFAULT.parse_funcs.page_html.insert_footer4(e.pn.getElementsByClassName("deleted-toggle")[0])},get_thread_links:function(e){return e.pn.querySelectorAll(".expand-link,.lastN-link,."+pref.script_prefix+"_link")},get_omitted_info:function(e){return e.pn&&e.pn.getElementsByClassName("omit")[0]||void 0},set_omitted_info:function(e,t){t&&e.pn.appendChild(t)},replace_omitted_info:function(e,t){e.childNodes[0].textContent=t.childNodes[0].textContent},replace_omitted_info2:function(e,t,n){if(t)"none"===e.childNodes[1].style.display&&(e.insertBefore(e.childNodes[0].childNodes[0],e.firstChild),e.removeChild(e.childNodes[1]),e.childNodes[1].removeAttribute("style")),this.replace_omitted_info(e,t);else{var r=document.createElement("span");r.setAttribute("style","display:none"),e.insertBefore(r,e.childNodes[1]),r.appendChild(e.childNodes[0]),e.childNodes[1].setAttribute("style","display:none")}},pn_name:function(e){return e.pn.getElementsByClassName("name")[0].childNodes[0]}},thread_json:{prep_to_archive:function(e){return e[0].posts=e.slice(1),e[0]},proto:"meguca2.thread_json"}},favicon:{__proto__:site2.DEFAULT.favicon,none:"/assets/favicons/default.ico",reply:"/assets/favicons/unread.ico",reply_to_me:"/assets/favicons/reply.ico"},proto:"meguca2"},common_func.Object_modifyDescriptor(site2.meguca,"check_func",{writable:!1}),site2.imeguca={nickname:"imeguca",domain_url:"images.meguca.org",home:"https://images.meguca.org/assets/favicons/default.ico",check_func:site2.DEFAULT.check_func}),(pref.features.domains.lain||pref.features.domains.lainjp)&&(site2.lain={nickname:"lain",home:site.protocol+"//lainchan.org/q/index.html",X_FRAME_OPTIONS:!0,CONTENT_SECURITY_POLICY_FRAME:!0,protocol:"https:",domain_url:"lainchan.org",postform_rules:null,features:{page:!1,graph:!0,setting2:!1},boards_json:site2.DEFAULT.generate_boards_json([["λ",5],["diy",2],["sec",6],["tech",6],["inter",2],["lit",3],["music",3],["vis",3],["hum",3],["drg",3],["zzz",2],["layer",1],["q",7],["r",7]],3),check_func:function(){var e=window.location.href;return e.indexOf(this.domain_url)!==-1&&e.search(new RegExp(this.domain_url+"/*$"))==-1&&(site.whereami=e.indexOf("/catalog")!=-1?"catalog":e.indexOf("/res/")!=-1?"thread":"404"===document.title?"404":"page","thread"===site.whereami&&(site.no=parseInt(e.replace(/.*res\//,"").replace(/\.html/,""),10)),site.config(this.domain_url,this.nickname),site.max_page=7,site.header_height=function(){var e=document.getElementsByClassName("boardlist")[0];return e?e.offsetHeight:0},site.embed_to="thread"===site.whereami||"page"===site.whereami?{top:function(){return document.getElementsByName("postcontrols")[0]},bottom:function(){return document.getElementsByTagName("footer")[0]}}:"catalog"===site.whereami?{top:function(){return document.getElementsByTagName("header")[0].nextSibling},bottom:function(){return document.getElementsByTagName("footer")[0]}}:{},"thread"!==site.whereami&&"page"!==site.whereami||(site.postform=document.getElementsByTagName("form").post,site.postform&&this.postform_prep()),!0)},styles:"a.dotted{border-bottom:1px dashed;}",catalog_posts_in_thread:function(e){return e.getElementsByClassName("replyContainer")},max_page:function(){return 10},all_boards:["/popular/","/all/","/mega/","/random/","/culture/","/psy/"],make_url4:function(e){return site2.lain.all_boards.indexOf(e[1])!=-1&&"catalog_html"!==e[3]?void 0:site2.vichan.make_url4.call(this,e)},catalog_native_prep:function(e,t,n){"lain"===this.nickname&&(styleSheet.add_to_watch(document.getElementById("stylesheet")),styleSheet.add_to_watch(document.getElementById("code_stylesheet")));var r="catalog"===site.whereami?document.getElementsByClassName("threads")[0]:document.getElementsByName("postcontrols")[0];if(site2.DEFAULT.catalog_native_prep_sel(e,t,"catalog"===site.whereami?document.getElementById("sort_by"):null),"catalog"===site.whereami){if(document.getElementById("image_size").addEventListener("change",site2.lain.catalog_native_size_changed,!1),t.style.display="inline",t.childNodes[3].style.display="inline","lain"===this.nickname)document.getElementsByClassName("controls")[0].appendChild(t);else{var a=document.getElementsByClassName("threads")[0];a.parentNode.insertBefore(t,a)}r.parentNode.insertBefore(e,r)}else{var s=document.getElementsByName("postcontrols")[0];if("lain"===this.nickname){var i=document.getElementsByClassName("blotter")[0],o=document.createElement("div");o.setAttribute("style","float:left"),o.appendChild(i.nextSibling.nextSibling),o.appendChild(i.nextSibling.nextSibling),"page"===site.whereami&&o.appendChild(document.createTextNode(" | ")),i.parentNode.insertBefore(o,i.nextSibling.nextSibling),o.parentNode.insertBefore(e,o.nextSibling),o.parentNode.insertBefore(t,o.nextSibling)}else s.parentNode.insertBefore(e,s),s.parentNode.insertBefore(t,s)}},catalog_native_size:document.getElementById("image_size")?document.getElementById("image_size").value:"small",catalog_native_size_changed:function(){site2[site.nickname].catalog_native_size=this.value},parse_funcs:{catalog_html:{sticky:function(e){return e.footer.textContent.indexOf("(sticky)")!=-1},ths:function(e){var t=this.__proto__.ths(e);if(site2.lain.all_boards.indexOf(site.board)!=-1)for(var n=t.length-1;n>=0;n--)t[n].board="/"+t[n].pn.getAttribute("data-board")+"/";for(var n=0;n<t.length;n++)t[n].page=Math.floor(n/10)+"."+n%10;return t}},page_html:{ths:function(e){var t=this.__proto__.ths(e);if(site2.lain.all_boards.indexOf(site.board)!=-1){for(var n=t.length-1;n>=0;n--){var r=site.nickname+"/"+t[n].pn.getAttribute("data-board")+"/"+t[n].no;cataLog.threads[r]?t.splice(n,1):t[n].board="/"+t[n].pn.getAttribute("data-board")+"/"}0===t.length&&cataLog.show_catalog()}return t}},catalog_json:{time_unit:1e3},post_html:{img2src:function(e){var t=e.parentNode.href;return t.search(/.webm/)!=-1&&(t=t.replace(/.*player.php\?v=/,"").replace(/&t=.*/,"")),t}}},colorID:function(e){var t=e.getElementsByClassName("poster_id")[0];if(t&&t.style&&!t.style.backgroundColor){site2.vichan.colorID(e);var n=t.previousSibling;t.textContent="ID: "+t.textContent," ID: "===n.textContent&&(n.textContent="")}},catalog_json2html3_thumbnail:function(e,t){return".jpg"===e.ext||".jpeg"===e.ext||".gif"===e.ext||".png"===e.ext||".pdf"===e.ext?"https://"+this.domain_url+t+"thumb/"+e.tim+".png":".epub"===e.ext?"https://"+this.domain_url+"/static/lain_epub.jpg":""},catalog_from_json3:function(e,t){return site2[this.nickname].wrap_to_parse.get(e,this.nickname,t,"catalog_json")},favicon:{__proto__:site2.DEFAULT.favicon,none:"/favicon.png",reply:"png;base64,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",
reply_to_me:"png;base64,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"},proto:"vichan"}),pref.features.domains.lainjp&&(site2.lainjp={nickname:"lainjp",home:site.protocol+"//lainchan.jp/lainicon.ico",X_FRAME_OPTIONS:!0,CONTENT_SECURITY_POLICY_DATAURI:!0,CONTENT_SECURITY_POLICY_FRAME:!0,protocol:"https:",domain_url:"lainchan.jp",postform_rules:null,features:{page:!1,graph:!0,setting2:!1,postform:!0},boards_json:site2.DEFAULT.generate_boards_json([["cyb",2],["tech",2],["cult",2],["λ",1],["μ",1],["psy",1],["feels",1],["q",2],["r",1]],2),check_func:site2.lain.check_func,components:{boardlist:"#overheader",__proto__:site2.vichan.components},parse_funcs:{catalog_html:{sticky:function(e){return e.pn.getElementsByTagName("strong")[0].textContent.search(/\(sticky\)/)!=-1},proto:"lain.catalog_html"}},post_container:function(e,t){return e},update_posts_remove:function(e,t,n,r){var a=e.posts[t].pn;0==t&&a.classList.contains("op")?this.update_posts_insert_pack(a):n.removeChild(a.nextSibling),n.removeChild(a)},catalog_json2html3_thumbnail:function(e,t){return".jpg"===e.ext||".jpeg"===e.ext||".gif"===e.ext||".png"===e.ext?"https://"+this.domain_url+t+"thumb/"+e.tim+".png":".pdf"===e.ext?"https://"+this.domain_url+"/static/pdf.png":""},favicon:{__proto__:site2.lain.favicon,none:"/lainicon.ico"},proto:"lain"}),window.location.href.search(/localhost/)!=-1&&(pref.test_mode[94]=!0,pref.catalog.embed_page=!1,pref.virtualBoard.scan_domains.dist="none"),pref.test_mode[94]&&(site2.dist={nickname:"dist",domain_url:"localhost",boards_json:site2.DEFAULT.generate_boards_json([["a",1],["undefined",1]],3),check_func:function(){site0.add_domain(this.nickname),site2.DEFAULT.check_func.call(this),site.postform=document.getElementsByClassName("postForm")[0]},make_url4:function(e,t){var n=site.protocol+"//"+this.domain_url+e[1];return("catalog_html"===e[3]||t&&0==e[2]&&"page_json"===e[3])&&(e[3]="catalog_json"),"page_json"===e[3]?[n+(parseInt(e[2],10)+1)+".json","json",t?this.nickname+e[1]+"j0":void 0]:"catalog_json"===e[3]?[n+"catalog.json","json",this.nickname+e[1]+"j0"]:"thread_json"===e[3]?[n+e[2]+".json","json"]:"page_html"===e[3]?[n+(0!=e[2]?parseInt(e[2],10)+1:""),"html"]:"thread_html"===e[3]?[n+e[2],"html"]:null},parse_funcs:{other_html:{}},testPoster:function(){function e(){var e=new Date;return e.toLocaleTimeString()+"."+("00"+e.getMilliseconds()).slice(-3)}function t(e){var t=!1;return function(n){return e.insertBefore(n,e.firstChild),t?e.removeChild(e.lastChild):(t=e.childNodes.length>=10,null)}}var n=[],r=document.getElementsByClassName("message")[1];if(r){r.innerHTML="<div></div><div></div><div></div><div></div>";var a=t(r.childNodes[0]),s=t(r.childNodes[1]),i=t(r.childNodes[2]),o=t(r.childNodes[3])}var l=new Map,p=[],c=document.getElementsByClassName("a_update")[0],_=DelayBuffer.prototype.delayed_do.bind(new DelayBuffer(function(){function t(t){var r=t.target,a=l.get(r),s=a.pn,i=a.data,o=200==r.status?r.response&&r.response.message:r.status,d=s.textContent,u=d.indexOf(": ")+2;if(d=[d.slice(0,u),d.slice(u)],o&&o.indexOf("OK.")!=-1){d[1]=d[1].replace(/(makeThread|post|prune)/,"");var o=o.split(" ");o[1]=o[1].slice(0,8),o[4]=o[4].slice(0,8),o[5]="op/sec,",o=o.join(" ")}s.textContent=d[0]+e()+": "+o+d[1],c.textContent=i.thread,i.board===site.board.slice(1,-1)&&"prune"!==i.action&&c.click(),n.length>0&&_(pref.test_mode.num||500),l.delete(r),p.push(r)}var r=n.shift(),d=r.op,u=r.post;if(u){u.no===d&&(u.new_thread=!0);var f={type:"json",action:u.new_thread?"makeThread":u.pruned?"prune":"post",board:u.board.slice(1,-1),thread:d,body:n.length+": "+u.com,subject:u.sub,debug:d};u.com&&u.com.indexOf(" is ")!=-1&&(f.tag=u.com.substr(u.com.indexOf(" is ")+4).split(/[\W]/)[0]);var h=document.createElement("div"),m=f.action+"/"+f.board+"/"+f.thread,g=p.shift()||function(){var e=new XMLHttpRequest;return e.addEventListener("load",t,!1),e.addEventListener("error",t,!1),e.addEventListener("abort",t,!1),e.responseType="json",e}();l.set(g,{pn:h,data:f}),g.open("POST","//localhost/post.php",!0),g.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),g.send(function(e){var t=[],n=0;for(var r in e)t[n++]=encodeURIComponent(r)+"="+encodeURIComponent(e[r]);return t.join("&").replace(/%20/g,"+")}(f)),h.textContent=e()+": "+m+(f.tag?" "+f.tag:"");var v=a(h);v&&(v.textContent.indexOf("OK.")===-1?o(v):v.textContent.indexOf("prune")!==-1?i(v):v.textContent.indexOf("makeThread")!==-1&&s(v))}},500));return function(e,t){"string"==typeof e?n=n.concat({post:{board:"/"+e.split("/")[1]+"/",pruned:!0},op:e.split("/")[2]}):e&&(n=n.concat({post:e,op:t})),_(pref.test_mode.num||500)}}(),features:{catalog:!0},parse_funcs:{catalog_json:{ths:function(e,t){for(var n=[],r=parseInt(t.page||0,10),a=0;a<e.length;a++){var s=Object.create(e[a]);s.sub=e[a].subject,s.board="/"+e[a].board+"/",s.page=r+Math.floor(a/15)+"."+a%15,s.posts=[e[a]],e[a].__proto__=t,n[n.length]=s}return n},op_img_url:function(){return"/distchan.png"},key:function(e){return e.domain+e.board+e.no},has_posts:!1,__proto__:site2.meguca.parse_funcs.catalog_json},thread_json:{ths:function(e,t){return site2.DEFAULT.parse_funcs.thread_json.ths({posts:e,nof_posts:e.length,board:"/"+e[0].board+"/"},t)},__proto__:site2.meguca.parse_funcs.thread_json},__proto__:site2.meguca.parse_funcs},catalog_json2html3:site2.meguca.catalog_json2html3,__proto__:site2["4chan"]});var Debug=function(){function e(e,t,r){return o(),n(e.split(":")[0],e.split(":")[1],void 0,t,r)}function t(t,n){var r=n?pref.debug_mode.pfunc_comp_expand_same||pref.debug_mode.pfunc_comp_expand_diff:pref.debug_mode.pfunc_expand,a={};if(console.log(e(t,a)),n){try{var s=JSON.parse(pref.debug_mode.pfunc_comp_proto||null)}catch(e){console.log("ERROR in JSON string: "+pref.debug_mode.pfunc_comp_proto)}var i={};console.log(e(n,i,s))}if(r)if(n){for(var o in i){var l=a[o]===i[o];(pref.debug_mode.pfunc_comp_expand_same&&l||pref.debug_mode.pfunc_comp_expand_diff&&!l)&&(console.log(o+": "+(l?"same":"differ")+": "+a[o]),l||console.log(o+": "+(l?"same":"differ")+": "+i[o])),delete a[o]}for(var o in a)console.log(o+": only_in_original: "+a[o])}else for(var o in a)console.log(o+": "+a[o])}function n(e,t,n,r,i){function o(e,t){if(!e||!e.debug____proto)return"";var n=!t&&Object.keys(e).filter(function(t){var n;return!(t in u)&&(n=Object.getOwnPropertyDescriptor(e,t),u[t]=n.value||n.get,!0)});f=t&&e.hasOwnProperty(t);var r=f&&a(e,t),i=f&&s(e,t),c=r?++l.get(r).refCount:i?l.set(i,{refCount:1,count:"value"}).refCount:0;return"/"+e.debug____proto+":"+(f?t+(r?" (==="+l.get(r).original+", "+c+")":", "+i):(t?"":n.join(","))+o(p(e),t))}function p(e){var t,n,r=i&&(n=e.debug____proto,(t=i[n])&&site2[t.split(".")[0]].parse_funcs[t.split(".")[1]]);return r?(i[n]=null,r):e.__proto__}var c=site2[e].parse_funcs,_=c[t+"_template"]||c[t.split("_")[1]+"_template"],d=c[t],u=Object.defineProperties(r||{},{debug____proto:{value:null},proto:{value:null}}),f=!1;return(e+":"+t+"::"+o(_,n)+(f?"":o(d,n))+(n&&!f?" undefined":"")).replace("::/"+e+"."+t+":","::")}function r(e){var t=Object.keys(site2).filter(function(e){return site2[e].hasOwnProperty("parse_funcs")}),r=["","_json","_html"],a=r.map(function(e){return pref.debug_mode.types[e]}),s=["common","post","thread","page","catalog","base"];o();for(var i=0;i<t.length;i++)for(var p=0;p<r.length;p++)for(var c=0;c<s.length;c++){var _=t[i],d=s[c]+r[p];if(("DEFAULT"===_||"common"!==s[c])&&(site2[_].no_JSONAPI?"_json"!==r[p]:"base_html"!==d)&&site2[_].parse_funcs[d]){var u=n(_,s[c]+r[p],e);pref.debug_mode.domains[_]&&a[p]&&console.log(u)}}var f=0;if(pref.debug_mode.pfunc_all_expand)for(var h of l.keys()){var m=l.get(h);m.refCount>0&&console.log(f+++"("+m.refCount+"/"+m.count+"): "+(m.original?m.original+": ":"")+h)}}function a(e,t){var n=Object.getOwnPropertyDescriptor(e,t);return n.get||n.value&&"function"==typeof e[t]&&n.value}function s(e,t){return Object.getOwnPropertyDescriptor(e,t).value}function i(e){for(var t in site2)if(site2[t].hasOwnProperty("parse_funcs"))for(var n in site2[t].parse_funcs)if(site2[t].parse_funcs.hasOwnProperty(n)&&"string"!=typeof site2[t].parse_funcs[n])for(var r in site2[t].parse_funcs[n])site2[t].parse_funcs[n].hasOwnProperty(r)&&e(site2[t].parse_funcs[n],r,t,n)}function o(){for(var e in site2)if(site2[e].hasOwnProperty("parse_funcs"))for(var t in site2[e].parse_funcs)site2[e].parse_funcs.hasOwnProperty(t)&&(site2[e].parse_funcs[t].debug____proto=e+"."+t);l=new Map,i(function(e,t,n,r){var s=a(e,t);s&&l.set(s,{original:n+":"+r+"."+t,count:0,refCount:0})}),i(function(e,t,n,r){var s=a(e,t);s&&l.get(s).count++}.bind(this))}pref_func.settings.onchange_funcs.Debug={site2func:function(){var e=pref.debug_mode.site2func;if(e){var t=new Map;for(var n in site2)site2[n].hasOwnProperty(e)&&t.set(site2[n][e],n);console.log(Object.keys(site2).map(function(n){return n+": "+t.get(site2[n][e])}).join(", ")),pref.debug_mode.site2func_expand&&Array.from(t).forEach(function(t){console.log(t[1]+": ","object"==typeof site2[t[1]][e]?site2[t[1]][e]:site2[t[1]][e].toString())})}},pfunc:function(){pref.debug_mode.pfunc&&t(pref.debug_mode.pfunc)},pfunc_comp:function(){pref.debug_mode.pfunc_comp&&t(pref.debug_mode.pfunc,pref.debug_mode.pfunc_comp)},pfunc_all:function(){pref.debug_mode.pfunc_all&&r(pref.debug_mode.pfunc_all)}},pref_func.settings.onchange_funcs.debug_mode=pref_func.settings.onchange_funcs.Debug;var l;return{lastReloaded:Date.now()}}();for(var i in site2)if(!pref.test_mode[94]||"dist"!==i){for(var j in site2[i].parse_funcs)if("string"!=typeof site2[i].parse_funcs[j]){for(var k in site2[i].parse_funcs[j])if("proto"!==k&&"string"==typeof Object.getOwnPropertyDescriptor(site2[i].parse_funcs[j],k).value){tgt=site2[i].parse_funcs[j][k].split(".");var tgt_obj=1===tgt.length?site2[i].parse_funcs[tgt[0]]&&site2[i].parse_funcs[tgt[0]][k]:2===tgt.length&&site2[i].parse_funcs[tgt[0]]&&site2[i].parse_funcs[tgt[0]][tgt[1]]?site2[i].parse_funcs[tgt[0]][tgt[1]]:2===tgt.length&&site2[tgt[0]]&&site2[tgt[0]].parse_funcs[tgt[1]]&&site2[tgt[0]].parse_funcs[tgt[1]][k]?site2[tgt[0]].parse_funcs[tgt[1]][k]:3===tgt.length&&site2[tgt[0]]&&site2[tgt[0]].parse_funcs[tgt[1]]?site2[tgt[0]].parse_funcs[tgt[1]][tgt[2]]:null;tgt_obj&&(site2[i].parse_funcs[j][k]=tgt_obj)}
if("DEFAULT"!==i||"common"!==j){var tmp,proto=site2[i].parse_funcs[j].hasOwnProperty("proto")?site2[i].parse_funcs[j].proto:site2[i].hasOwnProperty("proto")&&"DEFAULT"!==i?site2[i].proto+"."+j:site2.DEFAULT.parse_funcs[j]&&"DEFAULT"!==i?"DEFAULT."+j:"DEFAULT.common";tmp=j.slice(j.indexOf("_")+1),site2.DEFAULT.parse_funcs[tmp],proto="_template"===j.slice(-9)&&"DEFAULT.common"===proto?site2.DEFAULT.wrap_to_parse.get_getters(j.indexOf("html")!=-1):proto.indexOf(".")==-1?site2[i].parse_funcs[proto]:site2[proto.substr(0,proto.indexOf("."))].parse_funcs[proto.substr(proto.indexOf(".")+1)],site2[i].parse_funcs[j].__proto__=proto,delete site2[i].parse_funcs[j].proto}}else{var tgt=site2[i].parse_funcs[j];site2[i].parse_funcs[j]=site2[i].parse_funcs[tgt]}"DEFAULT"!==i&&(proto=site2[i].hasOwnProperty("proto")?site2[i].proto:"DEFAULT",site2[i].parse_funcs&&(site2[i].parse_funcs.__proto__=site2[proto].parse_funcs),site2[i].patch&&(site2[i].patch.__proto__=site2[proto].patch),site2[i].__proto__=site2[proto],delete site2[i].proto)}site2.ALL={};var site3={setup:function(e){for(var e in site2)"DEFAULT"!==e&&"common"!==e&&"meguca1"!==e&&"meguca2"!==e&&(site3[e]={boards:null,own_posts:{}},site2[e].hasOwnProperty("check_func")&&(site2[e].check_func(),delete site2[e].check_func),site.nicknames.push(e),site2.ALL[site2[e].domain_url]=e)}};for(var i in site2)"DEFAULT"!==i&&"common"!==i&&"meguca1"!==i&&"meguca2"!==i&&site3.setup(i);if(site.embed_to.top||(site.embed_to.top=function(){return site.root_body&&site.root_body.firstChild}),site.embed_to.bottom||(site.embed_to.bottom=function(){return site.root_body&&site.root_body.lastChild}),pref.pref2.KC.summer_time&&(site2.KC.time_offset=2),pref.cli.auto&&pref_func.site2_json(!1,!0,["site2","pref_func","site3"]),window.top!=window.self){if(site.nicknames.indexOf(window.name)==-1&&window.name!==site.embed_frame)return;for(var i in site2)site.nicknames.indexOf(i)!=-1&&i!=site.nickname&&site2[i].nickname!=site.nickname&&delete site2[i]}var pipe_name=pref.script_prefix+".graph."+site.board+"__pipe__",info_raw=site.nickname+site.board;window.SharedWorker||(pref.info_server=!1,pref.info_client=!1),site0.isStep||pref_func.obj_init(),pref3.stats.use=pref.stats.use,pref3.stats.estimate_posts=pref.stats.estimate_posts;var notifier=function(){var e=pref.features.notify.sound?function(){function e(){var e=[],t=function(t){function n(t,n,r){if(1==r)for(var a=0;a<n;a++)e.push("");for(var a=0;a<n;a++)1==r?e[e.length-1-a]=(t%256).toString(16):e.push((t%256).toString(16)),t=Math.floor(t/256)}var r=Math.floor(44100*t);return n(1380533830,4,1),n(r+46,4,0),n(1463899717,4,1),n(1718449184,4,1),n(18,4,0),n(1,2,0),n(1,2,0),n(44100,4,0),n(44100,4,0),n(1,2,0),n(8,2,0),n(0,2,0),n(1684108385,4,1),n(r,4,0),r}(pref.notify.sound.beep_length_f);!function(t,n,r){r*=127;for(var a=0;a<n;a++){var s=Math.floor(Math.sin(6.283185308*t*a/44100)*r+128)%256;e.push(s.toString(16))}}(pref.notify.sound.beep_freq,t,pref.notify.sound.beep_volume_f);for(var n=0;n<e.length;n++)1==e[n].length&&(e[n]="0"+e[n]);return new Audio("data:audio/wav,%"+e.join("%"))}function t(){if("file"===pref.notify.sound.src){var t=pref3.notify.sound.file&&pref3.notify.sound.file.files[0];if(t)return new Audio(URL.createObjectURL(t))}return e()}function n(e,t){a&&a.pause(),"pause"!==(t=t.slice(13))&&(a=null,!pref.notify.sound.notify||"notify"!==t&&"src"!==t&&0!==t.indexOf(pref.notify.sound.src)||r())}function r(){a||(a=t()),a.play()}var a=null;return pref_func.settings.onchange_funcs["notify.sound.*w/"]=n,{play:r}}():{play:function(){}},t=pref.features.notify.favicon?function(){function e(e){if(i!==e){var t=site2[site.nickname].favicon[e];"/"!==t[0]&&(t="data:image/"+t),r.setAttribute("href",t),i=e}}function t(){var t=new liveTag.CountNR;if(pref.liveTag.watch_all)t.count_all();else{var r=cataLog.threads;if(r)for(var a in r)t.count(r[a][19])}pref.notify.favicon&&e(0!=t.nrtm?"reply_to_me":0!=t.nr?"reply":"none"),pref.notify.title.notify&&n(0==t.nr&&pref.notify.title.hide_zero?"":(pref.catalog.footer.nrtm&&t.nrtm?t.nrtm+"/":"")+t.nr+" - ")}function n(e){o!==e&&(a.innerHTML=e+s,o=e)}var r=site2[site.nickname].favicon.get_favicon(),a=site2[site.nickname].favicon.get_title(),s=a.innerHTML,i="none",o="";return{set:new DelayBuffer(t,200).get_bound_func()}}():{set:function(){}},n=Notification&&pref.features.notify.desktop?function(){function e(){return"granted"!==Notification.permission&&Notification.requestPermission(function(e){Notification.permission!==e&&(Notification.permission=e)}),"granted"===Notification.permission}function t(t,r,a,s){if(pref.test_mode[94]&&"dist"===site.nickname)return site2[site.nickname].testPoster(num>=0?obj[num]:obj,t.no);o.length+l.length<pref.notify.desktop.limit&&("granted"===Notification.permission||e())&&n(t,r,a,s)}function n(e,t,n,a){if(!t.reply_of_mine||!pref.catalog_footer_ignore_my_own_posts){var s={icon:t.op_img_url,body:t.com||"",title:(a?"New Thread ":"")+(t.reply_to_me&&pref.notify.desktop.reply_to_me?"(You) in ":"")+(e.sub||e.key),tag:pref.script_prefix+"/"+e.key+", "+n,__proto__:t};p.innerHTML=s.body,s.body=p[brwsr.innerText].trim(),0===pref.notify.desktop.delay?r(s):(l[l.length]=s,c())}}function r(e){e||(e=l.shift());var t=new Notification(e.title,e);t.onclick=s;var n=0!=pref.notify.desktop.lifetime?setTimeout(a,1e3*pref.notify.desktop.lifetime):null;o[o.length]=[t,n],l.length>0&&c()}function a(){o.shift()[0].close()}function s(){window.focus();for(var e=o.length-1;e>=0;e--)if(o[e][0]===this||0==e){o[e][1]&&clearTimeout(o[e][1]),o.splice(e,1);break}}function i(){for(;o.length>0;)o[0][1]&&clearTimeout(o[0][1]),a()}var o=[],l=[],p=document.createElement("div"),c=new DelayBuffer(r,200).get_bound_func();return window.addEventListener("beforeunload",i,!1),{show:t}}():{show:function(){}};return{sound:e,favicon:t,desktop:n,changed:function(e,r){(pref.notify.favicon||pref.notify.title.notify)&&t.set();for(var a=!1,s=pref4.refresh.count<=1,i=pref.notify.sound,o=pref.notify.desktop,l=o.show_last?0:r.length-1,p=r.length-1;p>=0;p--)(i.reply||i.reply_to_me&&r[p].reply_to_me)&&(a=!0),p<=l&&o.notify&&(o.reply||o.reply_to_me&&r[p].reply_to_me)&&(s&&o.supp_init||n.show(e,r[p],p));i.notify&&a&&(s&&i.supp_init||notifier.sound.play())},appeared:function(e,t){var r=liveTag.mems[e.domain][e.board][e.no].wt;pref.notify.desktop.notify&&(pref.test_mode[133]&&pref.notify.desktop.appear&&(0===r[0]||!pref.notify.desktop.reply&&!pref.notify.desktop.reply_to_me)||pref.notify.desktop.new_thread&&t)&&n.show(e,e.posts&&e.posts[0]||e,0,!0),pref.notify.sound.notify&&(pref.notify.sound.appear||pref.notify.sound.new_thread&&t)&&notifier.sound.play()}}}(),ports={},messages_to_send={},init_func={},receive_func={},received_messages_404=null,send_message_emu=[];if(window.addEventListener("beforeunload",close_all,!1),window.opener&&(make_port_child(window.opener),site2[window.name]&&site2[window.name].prep_own_posts_event&&(window.addEventListener("storage",site2[window.name].prep_own_posts_event,!1),site2[window.name].prep_own_posts(),site2[window.name].prep_own_posts_event())),pref.cloudflare.auto_reload){var cf_error=document.getElementsByClassName("cf-error-code");cf_error.length>0&&parseInt(cf_error[0].textContent,10)>=500&&setTimeout(function(){location.reload()},6e4*pref.cloudflare.auto_reload_time)}var httpd=function(){function e(){U.id||t()}function t(e,s){if(!R)for(var i=8;i>=0;i--)if(O[i]&&(j<pref.scan.crawler||8==i)){for(;O[i][0]&&0===O[i][0].tgts.length;)O[i].shift();for(var l=O[i][0],p=0;l&&l.ERR_5xx&&s!==l;)l=O[i][++p];if(!l)continue;l.INDICATOR||(l.INDICATOR=(l.indicator||H).shift("limegreen",l.initiator[0],l.initiator,i),l.INDICATOR.report({start:Date.now(),prog:l}),l.IDX=0,l.RUNNING=0,l.SUC=0,l.max||(l.max=l.tgts.length));var c=l.ABORT?null:l.get_tgt_func?l.get_tgt_func(l):{REQ:l,__proto__:l.tgts[l.IDX++]};return(l.IDX>=l.max||!c&&l.ABORT)&&r(l,i),j++,l.RUNNING++,void(c?(l.INDICATOR.report({tgt:c.tgt||n(c.url)}),c.domain===site.nickname&&!c.domain_xhr||"indirect"!==pref.network.cross_domain?o(e,c):(e&&(A[A.length]=e),a(c)),pref.scan.crawler_adaptive?U.restart(pref.scan.crawler_idle_time_to_spawn):j<pref.scan.crawler&&t()):setTimeout(function(){u({type:"SKIPPED_TO_END"},e,{REQ:l},!0,{date:Date.now(),status:200})},0))}U.id&&U.stop(),e&&(A[A.length]=e)}function n(e){return e.substr(e.lastIndexOf("/")+1)}function r(e,t){O[t]&&O[t].length>1?O[t].shift():O[t]=null,D[D.length]=e}function a(e){var t=e.domain_xhr||e.domain;if(!T[t]){var n=function(t){u({type:"SKIPPED"},void 0,t||e,!1,{date:Date.now(),status:499})};if(void 0===T[t])cnst.make_iframe(t),T[t]=window.open(site2[t]&&site2[t].home||e.url,t),send_message(t,["HTTPD",["SUB_FRAME_INIT"]],T[t]),N[t]=[setTimeout(function(){T[t]=!1,N[t].slice(1).forEach(function(e){n(e)}),delete N[t]},1e3*pref.network.timeout)];else if(T[t]===!1)return void setTimeout(n,0)}B[t]=null,L[S]=e,e.archive||(e.responseType="text"),send_message(t,["HTTPD",["SUB_GET",[{ID:S++,url:e.url,responseType:e.responseType,domain:e.domain,board:e.board,no:e.no,key:e.key,archive:e.archive,to_file:e.to_file,to_idb:e.to_idb,kind:e.kind,timestamp:e.timestamp,domain_xhr:e.domain_xhr}]]]),N[t]&&N[t].push(e)}function s(e){clearTimeout(N[e[0]][0]),delete N[e[0]]}function i(e){o(void 0,e[0])}function o(e,t){e||(A.length>0?e=A.pop():"GM"===pref.network.cross_domain?e=new F:(e=new XMLHttpRequest,e.onload=d,e.onerror=d,e.onabort=d)),E.set(e,t),e.open("GET",t.url),e.responseType=t.responseType,pref.test_mode[186]&&t.tgt.indexOf("/news24/")>=0&&e.overrideMimeType("application/xml"),e.send(),l(e,Date.now(),t)}function l(e,t,n){n.TIMEOUT=(n.TIMEOUT?n.TIMEOUT:t)+1e3*pref.network.timeout,M[M.length]=e,1===M.length&&z.restart(1e3*pref.network.timeout)}function p(e,t){var n=M.indexOf(e);if(n<0)return!0;if(M.splice(n,1),0===n)if(M.length>0){var r=E.get(M[0]).TIMEOUT-t;r>0?z.restart(r):c()}else z.stop()}function c(){var e=M[0];pref.debug_mode[25]&&console.log("xhr_timeout: "+e.readyState+", "+e.responseURL),e.onreadystatechange?d({target:e,type:"TIMEOUT"}):(e.onreadystatechange=_,e.onprogress=_,_({target:e}))}function _(e){var t=e.target,n=E.get(t);pref.debug_mode[25]&&console.log("xhr_onreadystatechange: "+n.url+("progress"===e.type?": "+e.loaded+"/"+e.total:"")),"progress"===e.type&&(e.target.onreadystatechange=null);var r=Date.now();p(t,r),l(t,r,n)}function d(e){var t=e.target,n=Date.now();if(!p(t,n)){t.onreadystatechange=null,t.onprogress=null;var r=E.get(t),a=200===t.status||304===t.status;u(e,t,r,a,"text"===t.responseType?{date:n,status:t.status,responseText:a?t.responseText:null}:{date:n,status:t.status,response:a?t.response:null})}}function u(r,a,s,i,o){if(I){j--;var l=0==--s.REQ.RUNNING&&(s.REQ.IDX>=s.REQ.max||s.ABORT);t(a,o.status<500?s:null),l&&h(s.REQ),i?(s.REQ.SUC++,g(s,o)):(o.status>=500&&!s.REQ.ERR_5xx&&(s.REQ.ERR_5xx=setTimeout(function(t){return function(){delete t.ERR_5xx,e()}}(s.REQ),3e4)),s.REQ.INDICATOR.report({err_str:(s.tgt||n(s.url))+"("+o.status+("load"!==r.type?":"+r.type:"")+")"}),s.REQ.callback_1_fail&&s.REQ.callback_1_fail(s,o,s.REQ)),l&&w(s.REQ,o.date),s.REQ=null}else send_message("parent",["HTTPD",["SUB_ACK",[s.ID,{type:s.archive?"ARCHIVE":r.type},i,s.archive?{date:o.date,status:o.status,responseText:"",response:{}}:o]]]),A[A.length]=a,i&&s.archive&&v(s,o)}function f(e){var t=L[e[0]];delete L[e[0]],u(e[1],void 0,t,e[2],e[3])}function h(e){D.splice(D.indexOf(e),1),e.archive&&(e.TAR_FLUSH=B),m()}function m(){if(0===j){if(E.clear(),I)for(var e in B)send_message(e,["HTTPD",["SUB_FREE"]]);S=0,B={}}else for(var t=0;t<A.length;t++)E.delete(A[t]);A=[]}function g(e,t){"text"===e.responseType&&(pref.test_mode[154]&&"html"===e.data_type&&site2[e.domain].HTMLParser?t.response=new site2[e.domain].HTMLParser(t.responseText):pref.test_mode[154]&&"xml"===e.data_type&&site2[e.domain].XMLParser?t.response=site2[e.domain].XMLParser(t.responseText):"html"===e.data_type||"xml"===e.data_type?t.response=(new DOMParser).parseFromString(t.responseText,"text/"+e.data_type):"json"===e.data_type&&(brwsr.ff&&(t=Object.create(t)),t.response=JSON.parse(t.responseText))),e.REQ.callback_1(e,t,e.REQ),"text"===e.responseType&&"html"===e.data_type&&(t.response=null)}function v(e,t){if("string"==typeof e.archive)return void archiver.download_url4(t.response,e.archive);e.from&&I&&delete archiver.list_all_obj_downloading[e.from];var n="indirect"!==pref.network.cross_domain;if(e.domain===site.nickname&&(!I||!e.domain_xhr)||n){var r=e.kind+"_"+e.url.replace(/.*\//g,"");e.to_file&&archiver.download_url3(t.response,e,r,e.timestamp),e.to_idb&&(pref.test_mode[65]||IDB.req(e.domain,e.board,e.no,r,t.response,"put"))}if(I&&e.REQ.TAR_FLUSH){archiver.tar.flush(0===j?void 0:e.timestamp);for(var a in e.REQ.TAR_FLUSH)send_message(a,["HTTPD",["SUB_TAR_FLUSH",[0===j?void 0:e.timestamp]]])}}function b(e,t){e.from&&delete archiver.list_all_obj_downloading[e.from]}function y(e){if(O[0]&&O[0][0]&&O[0][0].timestamp===e&&O[0][0].tgts.length>0)return!1;for(var t=0;t<D.length;t++)if(D[t].timestamp===e)return!1;return archiver.tar.flush(0===j?void 0:e),!0}function w(e,t){e.callback&&e.callback(e),e.INDICATOR.report({end:t})}function k(e){archiver.tar.flush(e[0])}function x(){I=!1,send_message("parent",["HTTPD",["SUB_FRAME_INIT_ACK",[window.name]]])}function C(){R>0?--R>0&&P.delayed_do():(P.cancel(),e())}var T={},N={},I=!0,E=new Map,A=[],j=0,B={},S=0,L={},O=[],D=[],R=0,U=new Watchdog(t,pref.scan.crawler_idle_time_to_spawn),M=[],z=new Watchdog(c,3e4),H={shift:function(){return{report:function(){}}}},F=function(){this.onload=this.onload.bind(this),this.onerror=this.onerror.bind(this),this.onabort=this.onabort.bind(this)};F.prototype={open:function(e,t){this.method=e,this.url=t},send:function(){this.response=null,GM_xmlhttpRequest(this)},onload:function(e){this.response=e.response,this.response||(this.response="document"===this.responseType?(new DOMParser).parseFromString(e.responseText,"text/xml"):"json"===this.responseType?JSON.parse(e.responseText):e.responseText),this.onXXX("load",e,d)},onerror:function(e){this.onXXX("error",e,d)},onabort:function(e){this.onXXX("abort",e,d)},onXXX:function(e,t,n){this.type=e,this.result=t,n(this)},onXXX_factory:function(e,t){return function(n){this.onXXX(e,n,t)}.bind(this)},set onreadystatechange(e){this._onreadystatechange=e?this.onXXX_factory("readystatechange",e):e},get onreadystatechange(){return this._onreadystatechange||this.dummy_func},set onprogress(e){this._onprogress=e?this.onXXX_factory("progress",e):e},get onprogress(){return this._onprogress||this.dummy_func},dummy_func:function(){},get status(){return this.result&&this.result.status||1404},get responseText(){return this.result.responseText},get target(){return this},result:null};var P=new DelayBuffer(C,1e4),q={SUB_GET:i,SUB_ACK:f,SUB_FREE:m,SUB_TAR_FLUSH:k,SUB_FRAME_INIT:x,SUB_FRAME_INIT_ACK:s};return{req:function(e,n){O[n]?O[n].push(e):O[n]=[e],0!==e.tgts.length&&t()},req_add:function(t,n){O[n]&&0!==O[n].length?O[n][O[n].length-1].tgts=O[n][O[n].length-1].tgts.concat(t.tgts):O[n]=[t],e()},check_timestamp_and_flush:y,onload_archive:v,onload_archive_fail:b,sub_funcs:function(e){q[e[0]](e[1])},pause_req:function(){R++,P.delayed_do()},pause_cancel:C,set_health_indicator:function(e){H=e},get isLocal(){return I},req_serial:function(e,t){this.req(e,t)}}}();if(!site0.isStep||!pref.test_mode[142]){var http_req={get:function(e,t,n,r,a,s,i,o){var l=t.indexOf(",")==-1?common_func.name2dbt(t):t.split(",");""===n?n=site2[l[0]].make_url4(l):"string"==typeof n&&(n=[n,"raw"]),t=l.join(","),httpd.req({initiator:e||t,tgts:[{url:n[0],responseType:"html"===n[1]?"document":"raw"===n[1]?"text":n[1],tgt:t,data_type:n[1],domain:l[0]}],callback_1:function(e,n){r(t,n,i)}},6)}},cnst=function(){function e(e){var t=e.target,n="click"===e.type?"BUTTON"===t.tagName&&this[t.name]||"BUTTON"===t.parentNode.tagName&&this[t.parentNode.name]:("DIV"===t.tagName||"SPAN"===t.tagName)&&this.roll_toggle;n&&(e.stopPropagation(),n.call(this,e,m.get(e.currentTarget.parentNode)))}function t(e){var t=m.get(e.currentTarget);(t&&t.float||cnst.tack_float_nSblgs)(e)}function n(e){var t=m.get(m.get(e.currentTarget.parentNode).tack);(t&&t.embed||cnst.tack_dock_nSblgs)(e)}function r(e,t){return("BackCompat"===document.compatMode?window.innerHeight:document.documentElement.clientHeight)-parseInt(e,10)-t.offsetHeight}function a(e,t){return document.documentElement.clientWidth-parseInt(e,10)-t.offsetWidth}function s(e){(pref.proto.popup2_resize||gGEH.pns_resize.has(e.currentTarget))&&i(e)||"sel"===pref.proto.popup2_sel||d(e)||c(e,e.currentTarget)}function i(e){for(var t=e.currentTarget,n=e.target,s=t.style,i="fixed"===s.position,p=i?null:n.getBoundingClientRect(),c=i?null:t.getBoundingClientRect(),_=i?e.clientY-(s.top?parseInt(s.top,10):r(s.bottom,t)):e.offsetY+p.top-c.top,d=i?e.clientX-(s.left?parseInt(s.left,10):a(s.right,t)):e.offsetX+p.left-c.left,u=t.offsetHeight-_,f=t.offsetWidth-d,h=[_,d,u,f],m=0;m<4;m++)if(h[m]<=pref.proto.popup2_resize_bw){for(var g=0;g<4;g++)h[g]=h[g]<=pref.proto.popup2_resize_cw?parseInt(window.getComputedStyle(t)[g%2?"width":"height"],10):null;return document.body.addEventListener("mouseup",l,!1),document.body.addEventListener("dragend",l,!1),document.body.addEventListener("drag",o,!1),v=e.screenX,b=e.screenY,h.push(parseInt(s.top,10),parseInt(s.left,10),parseInt(s.bottom,10),parseInt(s.right,10),t,s.width,s.height),y=h,e.stopPropagation(),t.draggable=!0,!0}return!1}function o(e){if(0!==e.screenX){var t=y,n=t[8],r=n.style,a=e.screenX-v,s=e.screenY-b;t[0]&&(r.height=t[0]-s+"px",r.top&&(r.top=t[4]+s+"px")),t[1]&&(r.width=t[1]-a+"px",r.left&&(r.left=t[5]+a+"px")),t[2]&&(r.height=t[2]+s+"px",r.bottom&&(r.bottom=t[6]-s+"px")),t[3]&&(r.width=t[3]+a+"px",r.right&&(r.right=t[7]-a+"px")),e.stopPropagation()}}function l(e){var t=e.currentTarget;t.removeEventListener("drag",o,!1),t.removeEventListener("dragend",l,!1),t.removeEventListener("mouseup",l,!1),e.stopPropagation(),t.draggable=!1;var n=y[8],r=gGEH.pns_resize.get(n)||null;r&&(n.childNodes[1].style.width=parseInt(n.style.width,10)-6+"px",n.childNodes[1].style.height=parseInt(n.style.height,10)-n.childNodes[0].offsetHeight-3+"px",y[9]||(n.style.width=null),y[10]||(n.style.height=null),r()),y=null}function p(e){var t=e.currentTarget.parentNode;c(e,t)!==!1&&g.roll_if_auto({currentTarget:t},!0,!0)}function c(e,t){if(e.stopPropagation(),"fixed"!==t.style.position)return!1;t.draggable=!0,t.addEventListener("dragstart",u,!1),t.addEventListener("mouseup",_,!1)}function _(e){e.currentTarget.removeEventListener("dragstart",u,!1),e.currentTarget.removeEventListener("mouseup",_,!1),e.currentTarget.draggable=!1,g.roll_if_auto(e,!1)}function d(e){if("INPUT"===e.target.tagName||"TEXTAREA"===e.target.tagName||"SELECT"===e.target.tagName)return!0;if("move"===pref.proto.popup2_sel)return!1;for(var t=e.target.childNodes,n=new Range,r=0;r<t.length;r++){var a="BUTTON"===t[r].tagName||"SELECT"===t[r].tagName?0:pref.proto.popup2_sel_tolerance;n.selectNode(t[r]);for(var s=n.getClientRects(),i=0;i<s.length;i++){var o=s[i];if(o.bottom>e.clientY&&e.clientY>=o.top&&o.left-a<e.clientX&&e.clientX<o.right+a)return!0}}return!1}function u(e){g.roll_if_auto(e,!0),f(e,!0)}function f(e,t){e.dataTransfer.setData("text/plain",""),gGEH.drag.started(e,t?_:null,"move",!0)}function h(e){var t=brwsr.ff?40*-e.detail:e.wheelDelta,n=e.currentTarget.style;n.bottom?n.bottom=parseInt(n.bottom,10)-t+"px":n.top=parseInt(n.top,10)+t+"px",e.preventDefault()}var m=new WeakMap,g={INHERITED:"tb_funcs",op_p:function(e){var t=e.currentTarget.parentNode.style,n=parseFloat(t.opacity)||1;t.opacity="op_p"===e.target.name?n+.1>=1?1:n+.1:n-.1<=.1?.1:n-.1},roll_toggle:function(e,t){t.tb.classList.contains(pref.script_prefix+"_autoTp")?t.cn.style.height=parseInt(t.cn.style.height,10)?null:t.tb.offsetHeight+"px":"none"==t.cn.style.display?this.rolldown(t):this.rollup(t)},roll_if_auto:function(e,t,n){var r=m.get(e.currentTarget);r&&(t?r.auto_roll&&"none"!==r.cn.style.display&&r.cn.offsetHeight>window.innerHeight&&(n?r.auto_unroll=!0:(r.auto_unroll=[r.cn.parentNode.style.height],r.cn.parentNode.style.height=r.cn.parentNode.offsetHeight+"px"),this.rollup(r)):r.auto_unroll&&"none"===r.cn.style.display&&(this.rolldown(r),Array.isArray(r.auto_unroll)&&(r.cn.parentNode.style.height=r.auto_unroll[0]),r.auto_unroll=!1))},rolldown:function(e){e.tb.style.width="",e.cn.style.display="",e.onrolldown&&e.onrolldown.call(e.this_obj)},rollup:function(e){e.tb.style.width=e.tb.offsetWidth+"px",e.cn.style.display="none",e.onrollup&&e.onrollup.call(e.this_obj)},top:function(e,t){this.maximize_internal(t.pn,t.tb,t.cn,e.target.name,t,e.target)},maximize_internal:function(e,t,n,r,a,s){var i=a.maximize_state,o=i.now,l=(a.maximize_tgt||n).style,p=e.style;if(i.btn.style.display=null,"max"===r&&(i.before_max={pns:{width:p.width,height:p.height},cns:{width:l.width,height:l.height}}),"max"===i.now?(common_func.overwrite_prop(p,i.before_max.pns),common_func.overwrite_prop(l,i.before_max.cns)):"float"===i.now&&(i.float={left:p.left,top:p.top,right:p.right,bottom:p.bottom}),"max"===r){var c=site.header_height(),_=document.documentElement.clientWidth,d=document.documentElement.clientHeight-c;common_func.overwrite_prop(p,{left:"0px",top:c+"px",position:"fixed",width:_+"px",height:d+"px",zIndex:pref.style.zIndex,right:null,bottom:null,float:null}),common_func.overwrite_prop(l,{width:_-6+"px",height:d-t.offsetHeight-3+"px"})}else if("float"===r)common_func.overwrite_prop(p,{position:"fixed",float:null,zIndex:pref.style.zIndex,__proto__:i.float});else{var u=site.embed_to[r]();u&&(common_func.overwrite_prop(p,{position:"relative",float:"left",zIndex:null,top:null,left:null,right:null,bottom:null}),u.parentNode.insertBefore(e,u))}i.now=r,i.btn=s,s.style.display="none",a.maximize&&a.maximize.call(a.this_obj,r,o)},exit:function(e,t){t.exit?t.exit.call(t.this_obj,e):cnst.div_destroy(t.pn,!0)},settings:function(e,t){var n="BUTTON"===e.target.tagName?e.target:e.target.parentNode,r=this.this_obj&&this.this_obj.components&&this.this_obj.components[n.getAttribute("name")]||t.cn.childNodes[0];r.style.display="none"===r.style.display?null:"none",cnst.toggleButton(n),this.settings_after&&this.settings_after()},evfunc_factory:function(e,t){return function(n){cnst.tb_funcs[t](n,m.get(e.pn))}}};g.op_m=g.op_p,g.bottom=g.top,g.float=g.top,g.max=g.top,g.filter=g.settings;var v,b,y=null,w=(document.body,{left:0,bottom:0,last_pn:null}),k=document.createElement("div");return{init3:function(e){return this.init(e.func_str,null,null,null,null,e.pn_st,e)},init2:function(e){return this.init(e.func_str,e.rolldown_func,e.rollup_func,e.exit_func,e.maximize_func,e.pn_st)},init:function(t,n,r,a,i,o,l){var c=void 0!==l;void 0===l&&(l={exit:a,maximize:i});var _=l.pn||document.createElement("span");if(l.pn=_,o)return _.textContent=" "+t.replace(/.*:button:/,"").replace(/:.*/,""),_.setAttribute("style","cursor:pointer"),o.appendChild(document.createTextNode(" ")),o.appendChild(_),_;_.style||(_.style={}),_.style.position="fixed",_.draggable=!0,_.style.padding="0px",_.style.zIndex=pref.style.zIndex,_.style.float="left",_.style.display="inline-block";var d=t.split(":"),u=0;if("pop"!=d[0]);else{var v=!0;_.addEventListener(brwsr.mousewheel,h,!1),_.name="catalog_pop",u=1,_.draggable=!1}_.classList.add(pref.script_prefix+"_window");for(var b=_;u<d.length;){var y=d[u++];if("etb"===y||"tb"===y||"ftb"===y||"fitb"===y){_.classList.remove(pref.script_prefix+"_window"),_.classList.add(pref.script_prefix+"_titleBar"),"fitb"!==y&&(_.innerHTML='<div class="'+pref.script_prefix+'_window" style="margin: 0px 3px 3px 3px"></div>');var k=_.firstChild,x=pref_func.format_html_str('<div style="height:auto;overflow:hidden"><div style="float: left">'+("etb"===y?"":'<BTN"roll_toggle,-"><BTN"op_m,&lt;"><BTN"op_p,&gt;"><span style="width:16px;display:inline-block"></span>')+'</div><div style="float: right">'+("etb"===y?"":'<BTN"top,^"><BTN"bottom,v"><BTN"float,o" style="display:none"><BTN"max,[]">'+("fitb"===y?'<BTN"exit,x">':"")+'<BTN"exit,X">')+"</div><div></div></div>"),C=_.insertBefore(cnst.dom(x),"tb"===y||"etb"===y?k:k.nextSibling);b=k,l.maximize_state={now:"float",btn:C.childNodes[1].childNodes[2]},_.draggable=!1;var T=e.bind("tb_funcs"===l.INHERITED?l:g);C.onclick=T,"etb"!==y&&(C.ondblclick=T),C.onmousedown=p,l.tb=C,l.cn=k,m.set(_,l),"ftb"!=y&&"fitb"!=y||(C.style.width="100%",C.classList.add(pref.script_prefix+"_autoTp"),k.style.margin="3px")}else if("tb_press"==y){var N=d[u++];"float"!==N&&T({target:C.getElementsByTagName("button")[N],currentTarget:C,type:"click",stopPropagation:function(){}})}else"embed"==y?C.onmousedown=null:"bottom_top"==y?this.bottom_top(_):"txt"==y||brwsr.ff&&"button"==y?(b.appendChild(document.createTextNode(d[u++])),b.style.cursor="pointer",b.style.padding="2px 5px 2px 5px"):"button"==y?(b.innerHTML='<input type="button" value="'+d[u++]+'">',b.style.padding="0",b.style.border="0",b.style.background="none"):"Show2"==y?site.root_body!==site.root_body2&&site.root_body2?(_.style.position="static",site.root_body2.appendChild(_)):site.root_body.appendChild(_):"Show"==y?site.script_body.appendChild(_):"tile"==y||"tile2"==y?"set"==d[u++]?"left"==d[u]?(w[d[u]]=parseInt(_.style[d[u]].replace(/px/,""),10)+_.offsetWidth,u++):(w[d[u]]=parseInt(_.style[d[u]].replace(/px/,""),10)+_.offsetHeight,u++):"tile"===y?(_.style[d[u]]=w[d[u]]+"px",u++):(_.style[d[u]]=w[d[u]]+parseInt(d[u+1],10)+"px",u+=2):b.style[y]=d[u++]}return C||v?_.addEventListener("mousedown",s,!1):_.addEventListener("dragstart",f,!1),w.last_pn=_,c?l:_},tile_set_bottom:function(){w.last_pn&&(w.bottom=w.last_pn.offsetHeight)},tile_set_left:function(){w.last_pn&&(w.left=w.last_pn.offsetWidth)},left2right:a,bottom_top:function(e){var t=e.style;t.bottom&&(t.top=r(t.bottom,e)+"px",t.bottom=null),t.right&&(t.left=a(t.right,e)+"px",t.right=null)},void_func:function(){},div_mousedown:s,div_dragstart:f,div_scroll:h,div_destroy:function(e,t,n){return t&&e.parentNode.removeChild(e),e.name||m.has(e)?e.removeEventListener("mousedown",s,!1):e.removeEventListener("dragstart",f,!1),e.name&&e.removeEventListener(brwsr.mousewheel,h,!1),null},add_to_tb:function(e,t){var n=document.createElement("div");return n.style.float="right",n.style.resize="none",n.style.overflow="visible",n.innerHTML=t,e.childNodes[0].insertBefore(n,e.childNodes[0].childNodes[e.childNodes[0].childNodes.length-1]),brwsr.ff&&n.setAttribute("style","float: right"),n},show_hide:function(e,t,n){"none"==e.style.display?(e.style.display="",t&&(t.style.height=parseInt(t.style.height.replace(/px/,""),10)-e.offsetHeight+"px"),n&&(n.style.top=parseInt(n.style.top.replace(/px/,""),10)+e.offsetHeight+"px")):(t&&(t.style.height=parseInt(t.style.height.replace(/px/,""),10)+e.offsetHeight+"px"),n&&(n.style.top=parseInt(n.style.top.replace(/px/,""),10)-e.offsetHeight+"px"),e.style.display="none")},name2domainboardthread:common_func.name2domainboardthread,get_time:function(){var e=new Date,t=e.getHours(),n=e.getMinutes(),r=e.getSeconds();return t<10&&(t="0"+t),n<10&&(n="0"+n),r<10&&(r="0"+r),t+":"+n+":"+r},make_destroy:function(e,t,n,r){e[t]?e[t]=r():e[t]=n()},make_popup:function(e,t,n,r){e[t]=cnst.init("left:0px:tile:get:bottom:Show:tb",cnst.void_func,cnst.void_func,function(){e[t]=cnst.div_destroy(e[t],!0)},cnst.void_func),e[t].childNodes[1].innerHTML=n,pref_func.add_onchange(e[t].childNodes[1],r)},make_iframe:function(e){if(!(site2[e]&&site2[e].X_FRAME_OPTIONS&&pref.network.overXFO||site2[site.nickname].CONTENT_SECURITY_POLICY_FRAME&&pref.network.overCSPF)){var t=document.createElement("iframe");return t.name=e,t.setAttribute("style","display:none"),site.script_body.appendChild(t),t}},subscribe:function(e,t){e.push(t)},unsubscribe:function(e,t){var n=e.indexOf(t);n!=-1&&e.splice(n,1)},foreach:function(e,t){for(var n=0;n<e.length;n++)t(e[n])},auto_shrink_board_selector:function(){function e(){this.removeAttribute("style");for(var e=0;e<this.length;e++)this.options[e].text=pref.catalog_board_list_obj[e][0].key,r(this.options[e],e)}function t(){for(var e=0;e<this.length;e++)e!=this.selectedIndex&&(this.options[e].text="");r(this,this.selectedIndex)}function n(e,t){void 0===t&&(t=e.selectedIndex),e.length=0;for(var n=0;n<pref.catalog_board_list_obj.length;n++)e.length++,e.options[e.length-1].text=pref.catalog_board_list_obj[n][0].key;return e.selectedIndex=t>=e.length?0:t,e.onblur(),e.selectedIndex}function r(e,t){pref3.stats.use&&(pref.stats.auto_acquisition||pref.stats.auto_acquisition_all)&&stats.query_auto_acquisition(t)?e.setAttribute("style","background:#b5fbda"):e.removeAttribute("style")}var a=[];return{setup:function(r,s){return cnst.subscribe(a,r),r.onfocus=e,r.onblur=t,n(r,s)},str_changed:function(){cnst.foreach(a,n)},destroy:function(e){cnst.unsubscribe(a,e)},color:function(){cnst.foreach(a,function(e){r(e,e.selectedIndex)})}}}(),tb_funcs:g,auto_shrink_selector:function(){function e(){for(var e=n[this.getAttribute("name")],t=0;t<this.length;t++)""===this.options[t].text&&(this.options[t].text=e[t])}function t(){for(var e=[],t=0;t<this.length;t++)e[t]=this.options[t].text,t!=this.selectedIndex&&(this.options[t].text="");n[this.getAttribute("name")]=e}var n=Object.create(null);return function(n){n.onfocus=e,n.onblur=t,n.onblur()}}(),config_expander:function(){function e(){var e=pref[cataLog.embed_mode].t2h_num_of_posts;return["Same as the page",pref[cataLog.embed_mode].t2h_L+" posts",pref[cataLog.embed_mode].t2h_M+" posts",e+" posts",e+" + all unread posts","All unread posts","All"]}function t(){for(var t=e(),n=0;n<this.length;n++)""===this.options[n].text&&(this.options[n].text=t[n])}function n(){for(var e=0;e<this.length;e++)e!=this.selectedIndex&&(this.options[e].text="")}return function(r,a){var s=document.createElement("select");return s.className=pref.script_prefix+"_expander",s.setAttribute("data-key",r),s.length=7,void 0===a&&(a=0),s.selectedIndex=a,s.options[a].text=0===a?"Expand...":e()[a],s.onfocus=t,s.onblur=n,s}}(),icons:{filter:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcAQAAAABaduI5AAAAAnRSTlMAAQGU/a4AAABUSURBVAjXY/j///8HBjAx////CQz8//8zMLD//8fAwPz/DwND4/8fAgwH/n8wYHhQ/6CA4YP9gQ8MP+QbPzD84Wf+wPCPnx2ol5+fLKJfHmovnAAAn79HiYOE2q8AAAAldEVYdGRhdGU6Y3JlYXRlADIwMTUtMTAtMjlUMDI6MTM6MzkrMDk6MDBxKtFiAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE1LTEwLTI5VDAyOjEzOjM5KzA5OjAwAHdp3gAAAABJRU5ErkJggg==",settings:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcAQAAAABaduI5AAAAAnRSTlMAAQGU/a4AAABWSURBVAjXdY6xDcAgDAQvGzAKG2QllykiwWgexWxgKQ2dI4yULs1X9/dPWHMyHrudYZegvVQ6FBQqdqrgzRwLF0ZM4YjJfySS8K4tQaq2dOlzKCe/By9fz0MDWLKIZgAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAxNS0xMC0yOVQwMjowMzowNiswOTowMMhjeagAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMTUtMTAtMjlUMDI6MDM6MDYrMDk6MDC5PsEUAAAAAElFTkSuQmCC",refresh:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcAQAAAABaduI5AAAAAnRSTlMAAQGU/a4AAABmSURBVAjXbY6xDYAwDASfijLegBUYLRuAlCIljITEAowQNnCZIspjQ0tzkvX6e4NKBREudIw7KgaBTqugLEVwUwWnI9HOzMNh6UarhR+8QWaXD4nNBW02VY0ujdAA9SH1yXfcYG88J0BH+yT9vZAAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTUtMTAtMjhUMjM6NDg6MDYrMDk6MDASyn1kAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE1LTEwLTI4VDIzOjQ4OjA2KzA5OjAwY5fF2AAAAABJRU5ErkJggg==",img:function(e){return'<img src="'+e+'" style="width:14px;height:14px">'},button_settings:function(){return'<button type="button" name="settings">'+this.img(this.settings)+"</button>"}},toggleButton:function(e){e.style&&e.style.border?e.style.border="":e.style.border="inset 2px"},createElement:function(e){var t=document.createElement("div");return t.innerHTML=e,1===t.childNodes.length?t.childNodes[0]:t.querySelectorAll("*")},set_tack_float:function(e,n,r){return(n||r)&&m.set(e,{float:n,embed:r}),e.onclick=t,e},tack_float_nSblgs:function(e,t,r){var a=e.currentTarget,s=a.nextSibling,i=s.getBoundingClientRect(),o=cnst.init3({func_str:"left:"+i.left+"px:top:"+(i.top>0?i.top:0)+"px:overflow:hidden:"+(r?"fitb":"Show:tb"),exit:n,tack:a,pn:r?s:null});if(!r){o.cn.innerHTML='<div style="display: none"></div><div></div>';var l=o.cn.childNodes[1];if(s.parentNode.insertBefore(o.pn,s),l.appendChild(s),
t)for(;o.pn.nextSibling;)l.appendChild(o.pn.nextSibling)}return a.style.display="none",o},tack_dock_nSblgs:function(e,t){var n=e.currentTarget.parentNode,r=m.get(n),a=r.tack.parentNode,s=r.tack.nextSibling;if(t)n.style.position="static",n.removeChild(r.tb),r.tack.nextSibling!==n&&a.insertBefore(n,r.tack.nextSibling);else for(var i=r.cn.childNodes[1];i.firstChild;)a.insertBefore(i.firstChild,s);return cnst.div_destroy(n,!t),r.tack.style.display=null,r},tack_dock_e2tack:function(e){var t=e.currentTarget.parentNode;return m.get(t).tack},dom:function(e){return k.innerHTML=e,k.removeChild(k.firstChild)},doms_insertBefore:function(e,t,n){k.innerHTML=t,e||(e=n.parentNode);for(var r;k.firstChild;)r=e.insertBefore(k.firstChild,n);return r},tack_for_popup:function(e,t){var n=document.createElement("button");return n.classList.add(pref.script_prefix+"_autoTp"),n.appendChild(site2[site.nickname].make_tack()),e.appendChild(n),n.onclick=t,n},tack_for_popup_swap:function(e,t,n){var r=cnst.init3({func_str:"Show:tb"});return t&&cnst.tack_for_popup_swap_pos(r.pn,t,n),r.cn.appendChild(e),r.pn},tack_for_popup_swap_pos:function(e,t,n){cnst.bottom_top(t),e.style.top=parseInt(t.style.top,10)-e.offsetHeight+"px",e.style.left=t.style.left,n||common_func.overwrite_prop(t.style,{position:"relative",border:null,top:null,left:null})},cloneSwap(e){var t=e.cloneNode(!0);return e.id&&(t.id=e.id,e.removeAttribute("id")),"SELECT"===e.tagName&&(t.selectedIndex=e.selectedIndex),e.style.display="none",e.parentNode.insertBefore(t,e)}}}(),styleSheet=site0.isStep?{}:function(){function e(){var e=["titleBar","window","popUp"],n=e.map(function(e){return pref.style.fix[e+"_str"]});"copy"===pref.style.sel&&t(e.map(function(e){return pref.style.copy[e+"_str"]}).filter(function(e){return e}),n),e.forEach(function(e,t){p(e,n[t])})}function t(e,t){for(var a=document.styleSheets.length-1;a>=0;a--){var s=document.styleSheets[a].cssRules;if(s)for(var i=s.length-1;i>=0;i--)for(var o=e.length-1;o>=0;o--)s[i].selectorText===e[o]&&(t[o]=r(n(t[o]),n(s[i].cssText)),e.splice(o,1))}}function n(e){var t=new Map;return e.replace(/.*\{/,"").replace(/\}.*/,"").split(";").forEach(function(e){var n=e.split(":");t.set(n[0],n[1])}),t}function r(e,t){for(var n of t.keys())n.search(/\s*(background|color)/)>=0&&e.set(n,t.get(n));return Array.from(e.entries()).map(function(e){return e.join(":")}).join(";")}function a(e){new MutationObserver(s).observe(e,{attributes:!0})}function s(){if(u){var e=document.createElement("img");e.src=this.href,e.onerror=i,document.getElementsByTagName("body")[0].appendChild(e)}}function i(){this.parentNode.removeChild(this),e()}function o(){if(cataLog.embed_mode){var e=site2[site.nickname].spoiler_text;if(e.spoiler){if(!h&&!m&&e&&pref[cataLog.embed_mode].open_spoiler_text)for(var t=0;t<document.styleSheets.length;t++)if(document.styleSheets[t].cssRules)for(var n=0;n<document.styleSheets[t].cssRules.length;n++){var r=document.styleSheets[t].cssRules[n].selectorText;r&&(r.search(e.spoiler)!=-1&&(h=[t,n,document.styleSheets[t].cssRules[n].style.cssText]),r.search(e.open)!=-1&&(m=[t,n,document.styleSheets[t].cssRules[n].style.cssText]))}h&&m&&(document.styleSheets[h[0]].cssRules[h[1]].style.cssText=h[2]+(pref[cataLog.embed_mode].open_spoiler_text?m[2]:""))}else pref[cataLog.embed_mode].open_spoiler_text?(m=[document.styleSheets.length-1,document.styleSheets[document.styleSheets.length-1].cssRules.length,e.open_rule],document.styleSheets[m[0]].insertRule(m[2],m[1])):m&&document.styleSheets[m[0]].deleteRule(m[1])}}function l(e,t){if(void 0===t){var n=e.indexOf("{");t=e.slice(n+1,e.lastIndexOf("}")),e=e.slice(0,n)}var r=g.indexOf(e);r!=-1&&u.deleteRule(r),null===t||""===t?r!=-1&&g.splice(r,1):(r===-1&&(r=g.length,g[r]=e),u.insertRule(e+" {"+t+"}",r))}function p(e,t){l(v+e,t)}function c(){f&&f.forEach(function(e){e.parentNode.removeChild(e)}),f=null;var e=pref.style.addSS;e.use&&(f=e.str.split("\n").filter(function(e){return e}).map(function(e){var t=document.createElement("link");return t.rel="stylesheet",t.href=e,document.head.appendChild(t)}))}function _(){var e=pref.style.userCSS;if(e.use){var t=b||document.createElement("style");t.textContent=e.str,b||(b=document.head.appendChild(t))}else b&&(document.head.removeChild(b),b=null)}function d(e){return(0==e.width?"":"width:"+e.width+"px;")+(0==e.height?"":(e.max?"max-":"")+"height:"+e.height+"px")}var u,f,h=null,m=null,g=[],v="."+pref.script_prefix+"_";c();var b=null;return _(),{init:function(t){var n=v+"tag{cursor:pointer;}\n"+v+"autoTp{opacity:0; position:absolute; top:0px; left:0px;}\n"+v+"autoTp:hover{opacity:1;}\n"+v+"embeddedTriage{display:inline-block;cursor:pointer}\n"+v+"button{cursor:pointer;}\n\n"+(site2[site.nickname].styles||"");document.head.insertBefore(document.createElement("style"),b).textContent=n,u=document.head.insertBefore(document.createElement("style"),b).sheet,p("deleted","opacity:0.4;"),e(),"4chan"===site.nickname&&("catalog"!==site.whereami&&(l(".teaser","display:none"),l(".extended-small .teaser, .extended-large .teaser","display: block"),l(".small .thread","width: 165px"),l(".large .thread","width: 270px"),l(".extended-small .thread","width: 180px; max-height: 320px"),l(".extended-large .thread","width: 270px; max-height: 410px")),p("catalogView","text-align:center"),l(".extended-custom .teaser","display:block"),l(".extended-custom .thread",d(pref.float.format.ec)),l(".custom .thread",d(pref.float.format.c)));for(var r in pref.style.tips)"_str"!==r.slice(-4)&&pref.style.tips[r]&&this.register_cc(pref.style.tips[r+"_str"]);var a={"style.tips.*w/":function(e,t){var n=t.split(".")[2],r=pref.style.tips[n+"_str"];p(pref.style.tips[n]?r:r.slice(0,r.indexOf("{")),pref.style.tips[n]?void 0:null)},"style.sel":e,"style.fix.*":e,"style.copy.*":e,"style.reset.*w/":function(t,n){var r=pref_default(),a=n.split(".")[2];pref_func.pref_overwrite(pref.style[a],r.style[a]),pref_func.settings.apply_pn13_1(),e()},"style.addSS.*":c,"style.userCSS.*":_,"style.post_editing":function(){p("post_editing",pref.style.post_editing)},"*.open_spoiler_text":o,"*.posts_search_op":function(e,t){var n=pref[t||cataLog.embed_mode];p("search_miss","opaque"===n.posts_search_op?"opacity:"+n.posts_search_op_opacity/100+" !important":"hide"===n.posts_search_op?"display:none !important":null)},"float.format.fc.*w/":function(e,t){var n=t.split("."),r=n[0],a=n[2];l("."+("ec"==a?"extended-":"")+"custom .thread",d(pref[r].format[a]))}};a["*.posts_search_op_opacity"]=a["*.posts_search_op"];var s=a["float.format.fc.*w/"];a["catalog.format.fc.*w/"]=s,a["page.format.fc.*w/"]=s,a["catalog.format.c.*w/"]=s,a["page.format.c.*w/"]=s,a["catalog.format.ec.*w/"]=s,a["page.format.ec.*w/"]=s;for(var i in a)pref_func.settings.onchange_funcs[i]=a[i];a["*.posts_search_op"](null,t),a["style.post_editing"](),pref[t].open_spoiler_text&&o(),pref.test_mode[98]||"catalog"!==t||l(".backlink","display:inline;font-size:0.8em;")},add_to_watch:a,register_cc:p}}(),Tooltips=site0.isStep?null:function(){function e(e){var t=e&&(e.target.name||e.target.getAttribute("name"))||this.name;if(t&&e&&"radio"===e.target.type&&(t+=", "+e.target.value),t||"LABEL"!==e.target.tagName||(t=e.target.childNodes[0].name+("radio"===e.target.childNodes[0].type?", "+e.target.childNodes[0].value:"")),"SHOW2_I"===t&&(t=e.target.previousSibling.childNodes[1].getAttribute("name")),"SHOW2"===t&&(t=e.target.childNodes[1].getAttribute("name")),t){var n="function"==typeof b[t]?b[t](e):b[t];return n||(n=b[t.substr(0,t.lastIndexOf(".")+1)+"*"]),n||(n=p(b,t,"")||""),pref.test_mode.tips&&(n="Name: "+t+"\n"+n),n=n.replace(/\n/gm,"<br>").replace(/  /g,"&emsp;"),"#"===t[0]?b["#*"](e,n):n}}function t(t){var r=t.target.getAttribute("name"),a=r&&"#"===r[0]?"info":"help";pref.tooltips[a].show&&n(a,t,e,"help"===a)}function n(e,t,n,s){d^s&&(d=s,_.style.display=s?null:"none"),f=e;var i={target:t.target,currentTarget:t.currentTarget,clientX:t.clientX,clientY:t.clientY};u?a(t,n(t))&&(g=i):(null!==h&&clearTimeout(h),h=setTimeout(r,pref.tooltips[e].popup_delay),g=i,v=n)}function r(){h=null,a(g,v(g))?site.script_body.appendChild(c):g=null,v=null}function a(e,t){return t?("string"==typeof t?c.firstChild.innerHTML=t:(c.firstChild.innerHTML=t.html,t.callback&&t.callback(c.firstChild)),null!==m&&(clearTimeout(m),m=null),e&&u!==e.target&&(c.style.left=e.clientX+20+"px",c.style.top=e.clientY+20+"px",u=e.target),!0):(i(),!1)}function s(e){g&&g.currentTarget===e&&i()}function i(){g&&null===m&&(null!==h&&(clearTimeout(h),h=null),m=setTimeout(o,pref.tooltips[f].popdown_delay))}function o(){m=null,u&&(c.parentNode.removeChild(c),u=null,g=null)}function l(e){null!==m&&(clearTimeout(m),m=null),g.currentTarget=e.currentTarget}function p(e,t){if(!e)return null;var n=t.indexOf(".");return n==-1?e[t]||e["*"]||null:p(e[t.substr(0,n)],t.substr(n+1))}var c=document.createElement("div");c.style.position="fixed",c.setAttribute("class",pref.script_prefix+"_popUp"),c.style.zIndex=pref.tooltips.zIndex,c.innerHTML="<div></div>",c.onmouseover=l,c.onmouseleave=i;var _=cnst.tack_for_popup(c,function(e){cnst.tack_for_popup_swap(c.replaceChild(document.createElement("div"),c.firstChild),c,!0),o()}),d=!0,u=null,f="help",h=null,m=null,g=null,v=null,b={catalog_promiscuous:"Gather information whatever.",filter:{kwd:{ew:"Exact word match.\n 'index' matches 'index' but 'indexing' if checked.\n 'index*' maches 'index' and 'indexing'.",re:"Regular Expression.",ci:"Case insensitive. Don't distinguish upper and lower case.",sentence:'"XXXX YYYY" matches itself as a whole instead of matching "XXXX" and/or "YYYY"',inPost:"In a post restriction.\n all keywords must be in a post if checked.\n No difference if one keyword."},time:"Time : Hide threads which have no posts after the time.",time_creation:"Time(Creation Time) : Hide threads which were created before the time.",time_watch:"Watch: watch threads which have posts after the time.",time_watch_creation:"Watch(Creation Time): watch threads which were created after the time."},"filter.tag_search.str":"String for searching tags.\n[CAUTION] this function is very heavy, keep blank here when you don't use.","filter.tag_list":!1,"network.cross_domain":"Use 'direct' if you could, because it's quite light, but it doesn't work in almost of all environments.\n'indirect' usually works well and gives full functionality.\nOr you can use 'GreaseMonkeyM's extension if your browser tend to close steps for cross domain when you connect over X-Frame-Options, but this doesn't provide localStorage/IDB features in remote domains.",debug_mode:"Debug mode.",show_tooltip:"Show this tooltip.","liveTag.rm_list_str":function(){return this.TagExLists()},"liveTag.ex_list_str":function(){return this.TagExLists()},TagExLists:function(){return"String, ...  or\n/RegularExpression/, ... or \nIdentifier:String, ... or \nIdentifier:/RegularExpression/, ...\n\nRegularExpression must be embraced by shashes, and accepts i flag(case insensitive).\nIdentifier must be followed by :(colon). First colon is interpreted as a delimiter always. Put a colon at the head of line when you want to use colons in search strings for global search(without any identifiers)\n"+this.GeneralRules},catalog_board_list_str:function(){return"How to write 'Board groups'.\n\nNameOfBoardGroup,[Identifier, ...,][Commands, ...]\n\nEach line becomes each board group, one line per one board group.\nFirst column is a name of board group. The name is shown in board selector and become a key for localStorage or statistics.\nSecond or later columns are identifiers or commands.\n\n"+this.GeneralRules+"Commands: \n&emsp;#xx: include filter for the tag #xx\n&emsp;##xx: pickup and include filter for the tag #xx\n&emsp;!#xx: exclude filter for the tag #xx\n&emsp;!stats: take statistics if the function is enabled.\nExamples:\n&emsp;CC, lain/λ/, #CatChan  // load lain/λ/ and filter by #CatChan, then shows a thread for CatChan in lain/λ/.\n&emsp;lain#lainchan, lain, #lainchan  // load all boards of lain and filter by #lainchan, then show all threads which have the tag(#lainchan).\n&emsp;#tech, ##tech  // load all boards which have #tech from sites which are set in VirtualBoard, and filter by #tech, then show all threads which have the tag(#tech) from sites.\n"},get GeneralRules(){return this.CommentDS+this.Identifier},CommentDS:"Comment:\n  Double slash(//) is a beginning of comment.\n",Identifier:"Identifier:\n  Identifier is a string which contains domain, board and/or thread.\n  Any parts of identifier can be omitted.\n  If all parts of identifier are omitted, it means 'for all'\n  Board identifier must be enclosed by slashes, like /a/.\n  Thread identifier must be numeric.\n  Otherwise, it is taken to be a domain identifier.\n  Domain identifier must be one of "+site0.domains.slice(0,-1).join(", ")+" and "+site0.domains.slice(-1)+".\n  When some identifiers are omitted, it'll be interpreted as follows. Top has the priority.\n    domain/board/thread\n    /board/thread\n    domain/thread\n    thread\n    domain/board/\n    /board/\n    domain\n",StyleString:"StyleString:\n  StyleString is set to object.style.XXXX directly.\n  You can use all of styles in CSS, which has 'background', 'border', 'fontSize', 'opacity', 'width' and 'height'.\n  Delimiter is a semicolon as well as CSS, and you can use '!important' also.\n","catalog.style_general_list_str":function(){return'[Identifier][;StyleString][;StyleCommand]\n  (NOTE: There must be a delimiter ";" even if whole identifier is omitted)\n\n'+this.GeneralRules+this.StyleString+this.StyleCommand},StyleCommand:"StyleCommand:\n  STICKY[:false] // sticky or unsticky.\n  SHOW // the thread is shown always when keyword filter is not active. (ignore tag/time/list filters)\n","catalog.board.recommendation":"Scans 'board announcement' and gets owner's recommendation. This recommendation must be start 'Recommendation: ', and the following part of the line is treated as a line of board groups. The recommendation can be seen in a last line of board groups.","cli.eval_str":"For developers. This function is killed by security reason. If you want to use, you must uncomment the function 'pref_func.site2_eval' by yourself.",catalog_open_where:"this tab: open the thread in this tab, and catalog will be closed.\nnew tab always: this enables you to open a thread in multiple tabs.\nnamed tab: this prevents you from opening a thread in multiple tabs.\na fixed tab: this enables you to use a catalog window as a dashboard.","virtualBoard.scan_domains.*":"None: Don't scan.\nBoard: Read boards.json and set them to boardlist, not scan threads at startup. Threads are scanned when you read them.\nThread: Scan all threads at startup.",scanBoard:"Scan selected virtual boards.\nScan this physical board if no virtual board is selected.",scanSite:"Scan all virtual boards.\nScan all boards in this site if no virtual board is selected.","style.fix.*":"Write style strings.","style.copy.*":"Write exact selectorText in CSS, then its styles are copied.",debug_mode:["pipe","","removed threads from catalog"],dummy:"",archive:{kwd:null},"#*":function(e,t){return liveTag.tooltip(e,t)}};return b.archive.kwd=b.filter.kwd,b["filter.tag_search.re"]=b.filter.kwd.re,{add_root:function(e){e.addEventListener("mouseover",t,!1),e.addEventListener("mouseleave",i,!1)},remove_root:function(e){e.removeEventListener("mouseover",t,!1),e.removeEventListener("mouseleave",i,!1)},show:e,str:b,req_show:n,hide2:i,show_2:a,hide:i,hide_if:s}}(),Triage=site0.isStep?null:function(){var e={KILL:"Hide this thread permanently, and set style",TIME:"Hide this thread until it gets new replies, and set style",NONE:'Delete "hidden" mark and set style',KILL_N:"Hide this thread permanently",TIME_N:"Hide this thread until it gets new replies",ATTR:"Set style additionally",WATCH:"Watch and mark as I've read all posts so far",UNWATCH:'Delete "watched" mark',SHOW:"Show always without regard to filter",UNSHOW:'Remove "show" mark',STICKY:"Sticky this thread",UNSTICKY:"Unsticky this thread",GO:"Open this thread",UNDO:"Undo last modification",ARC1:"Take an archive (one-shot archive)",ARC:"Start archiving this thread",UNARC:"Stop archiving this thread",MERGEB:"Mark as marge base",MERGE:"Merge this thread with merge base",MERGEOP:"Merge all threads in OP",UNMERGE:"Unmerge this thread",UNDOMERGE:"UNDO last merge operation",SPC:"Spacer for caption. Nothing happen",MENU:"Open menu",PMENU:"Open post menu",EXPAND:"Expand following triages",PWATCH:"Mark as I've read all posts before this",PHIDE:"Hide this post",PHIDEAFTER:"Hide this post and posts which replies to this post",PUNHIDE:"Unhide this post",PDISABLEHIDE:"Disable hide function; Shows all posts temporarily",PENABLEHIDE:"Enable hide function; Hide hidden marked posts again",PCLEARHIDE:"Clear hide list and show all posts"};Tooltips.str.triage=function(t){var n=t.target.getAttribute("data-cmd"),r=t.target.getAttribute("data-attr"),a=["NONE","ATTR","KILL","TIME"].indexOf(n)!==-1;return e[n]+"."+(a?"\nSet style "+(r||"default")+".":"")};var t=function(e,t){var n=t.onclick?this.prep_func_onclick(t.onclick):null,r=[],a=t.embed?"span":"div",s=["WATCH","UNWATCH","SHOW","UNSHOW","STICKY","UNSTICKY","ARC","ARC1","UNARC"],i=cnst.dom("<"+a+(t.style?' style="'+t.style+'"':"")+' class="'+pref.script_prefix+"_"+(t.class||"triage")+'"></'+a+">");this.pn=i,Tooltips.add_root(i);for(var o=e.replace(/\s*\/\/.*/gm,"").split("\n").filter(function(e){return e}),l=0;l<o.length;l++){0==l||t.menu||i.appendChild(document.createElement("br"));for(var e=o[l].replace(/,\s*$/,"").split(","),p=0;p<e.length;p+=3)if("SPC"!==e[p])if("EXPAND"!==e[p]){var c=t.embed?document.createElement("a"):cnst.dom('<button name="triage" type="button"></button>');if(c.textContent=e[p+1],t.embed||"MERGEC"===e[p]||c.setAttribute("style","pointer-events:auto;"+(t.child_style||"")+e[p+2]),t.child_class&&c.setAttribute("class",pref.script_prefix+"_"+t.child_class),c.setAttribute("data-cmd",e[p]),e[p+2]&&c.setAttribute("data-attr",e[p+2]),n&&(c.onclick=n),t.onmousewheel&&(c["on"+brwsr.mousewheel]=t.onmousewheel),t.menu){var _=document.createElement("div");_.appendChild(c),_.appendChild(document.createElement("br")),c=_}i.appendChild(c),s.indexOf(e[p])!=-1&&(r[r.length]=[c,e[p]])}else i=cnst.doms_insertBefore(i,'<a class="CatChan_button" name="SHOW" data-str="'+e[p+2]+'">'+e[p+1]+'</a><span style="display:none"></span>',null);else i.appendChild(document.createTextNode(e[p+1]))}this.format_tgt=0!==r.length?r:null};return t.prototype.destroy=function(){Tooltips.remove_root(this.pn)},t.prototype.tooltips=e,t.prototype.et2tr=function(e){return{cmd:e.getAttribute("data-cmd"),attr:e.getAttribute("data-attr")||""}},t.prototype.prep_func_onclick=function(e){return function(n){n.stopPropagation();var r=t.prototype.et2tr(n.target);r.cmd&&"SPC"!==r.cmd&&e(r.cmd,r.attr,n.target)}},t.prototype.howto="How to describe triage:\n\nEach line will be each line of triage.\n1st column: command\n"+["KILL","TIME","NONE","KILL_N","TIME_N","ATTR","WATCH","UNWATCH","STICKY","UNSTICKY","SHOW","UNSHOW","UNDO","GO","ARC1","ARC","UNARC","MERGEB","MERGE","MERGEOP","UNMERGE","UNDOMERGE","SPC","MENU","EXPAND"].map(function(t){return"  "+t+": "+e[t]+("UNDO"===t?". Effective to commands above":"")+".\n"}).join("")+"2nd column: caption on the triage button.\n3rd column: style applied to the thread.\nRepeat these as you wish.\nSample loader will help you to understand.\n",t.prototype.MERGEE_button_html=' <a class="'+pref.script_prefix+'_button" data-type="triage" data-cmd="MERGEE">[M]</a>',t.prototype.doms=null,t}(),timer_obj,chart_obj,setting_obj,catalog_obj,cnst_obj=function(){function e(e){return cnst.init2({func_str:"tile:get:left:tile:get:bottom:button:"+e+":Show2:tile:set:left",pn_st:a})}site.script_body=document.createElement("div"),site.script_body.className=pref.script_prefix,site.script_body.innerHTML='<div style="display:none"></div><div></div>',site.popup_body=site.script_body.childNodes[1],site.root_body.appendChild(site.script_body);var t=site.features,n=pref.features;if(t.postform&&n.postform&&null==site.postform&&!site2[site.nickname].postform.activation){var r=document.createElement("div");r.innerHTML='<div><textarea style="height:5em;display:none" cols="20" name="'+pref.script_prefix+'_draft"></textarea><button name="'+pref.script_prefix+'_send" style="display:none">send</button></div>',site.script_body.appendChild(r),r=r.childNodes[0],site.components.postform_comment=r.childNodes[0],site.postform=site.components.postform_comment,site.components.postform_submit=r.childNodes[1]}if(site.settings){site.settings.innerHTML="<span>[CC</span><span></span>]",site.settings.setAttribute("style","float:right;");var a=site.settings.childNodes[1];site.settings.childNodes[0].setAttribute("style","cursor:pointer"),site.settings.childNodes[0].onclick=function(){cnst.show_hide(a)},site.settings.childNodes[1].setAttribute("style","display:none")}if(t.setting&&n.setting&&e("settings").addEventListener("click",pref_func.settings.show_hide,!1),t.catalog&&n.catalog&&(catalog_obj=make_catalog_obj(pref[site.whereami]&&pref[site.whereami].embed&&pref.test_mode[114]?null:e("Watcher")),pref.catalog.embed&&"catalog"===site.whereami))var s=site2[site.nickname].catalog_native_frame_prep(e("Frame"));if(pref.test_mode[94]||cnst.tile_set_left(),chart_obj=make_chart_obj(t.graph&&n.graph&&pref3.stats.use?e("Graph"):null),t.setting2&&n.setting2&&(setting_obj=make_setting_obj(e("settings2"))),t.postform&&n.postform&&(null!=site.postform||site2[site.nickname].postform.activation))var i=make_post_form_obj(e(r?"Draft":"PostForm"));if(t.debug&&n.debug)var o=make_debug_obj(e("debug"));if(t.page&&n.page){var l=cnst.init2({func_str:"tile:get:left:tile:get:bottom:txt:init:Show2",pn_st:a});timer_obj=make_timer_obj(l)}if(cnst.tile_set_bottom(),t.catalog&&n.catalog&&pref.catalog.board.board_tags_same&&pref_func.settings.onchange_funcs["tag.same_tag_refresh"](),site.settings3){var p={CC:function(e){cnst.show_hide(e.target.previousSibling)},entry:function(e){"A"===e.target.tagName&&p[e.target.textContent](e)},Settings:pref_func.settings.show_hide,Watcher:catalog_obj&&catalog_obj.show_hide,Frame:s,Graph:chart_obj&&chart_obj.make,Draft:i,PostForm:i,debug:o};site.settings3.innerHTML='<span style="float:right">[<span style="display:none">'+(t.setting&&n.setting?"<a>Settings</a> ":"")+(t.catalog&&n.catalog?"<a>Watcher</a> ":"")+(t.catalog&&n.catalog&&pref.catalog.embed&&"catalog"===site.whereami?"<a>Frame</a> ":"")+(t.graph&&n.graph&&pref3.stats.use?"<a>Graph</a> ":"")+(t.postform&&n.postform&&(null!=site.postform||site2[site.nickname].postform.activation)?"<a>"+(r?"Draft":"PostForm")+"</a> ":"")+(t.debug&&n.debug?"<a>debug</a> ":"")+"</span><a>CC</a>]</span>",site.settings3.setAttribute("style","float:right;"),site.settings3.addEventListener("click",p.entry,!1)}}(),uip_tracker=null,liveTag={pn:null,pn_summary:null,active:{pk:0,in:0,ex:0},tags_ci:null,tags:Object.create(Object.create(null)),mems:Object.create(null,{getFromName:{value:function(e){var t=common_func.fullname2dbt(e);return t[2]?this[t[0]][t[1]][t[2]]:this[t[0]][t[1]]}},init:{value:function(){function e(e,t){var n=Object.create(Object.create(t.acc,{domain:{value:e.domain}}),{p:{value:Object.create(null)}});t[e.domain]=n,site2[e.domain].lth_init&&site2[e.domain].lth_init(e,n)}function t(e,t){var n="#"+e.board.substr(1,e.board.length-2);liveTag.tags[n]&&liveTag.tags[n].ref_tag===n&&(n=liveTag.tags[n].ref_tag);var r=Object.create(Object.create(Object.getPrototypeOf(t),{board:{value:e.board},btag:{value:n,writable:!0}}),{nr:{value:0,writable:!0},nrtm:{value:0,writable:!0},u:{value:0,writable:!0},o:{value:null,writable:!0},p:{value:{},configurable:!0,writable:!0},pgs:{value:null,writable:!0},d:{value:0,writable:!0}});pref.liveTag.inherit_board_name&&(liveTag.update_tags_in_th_sub([],{},[n],{},1,null,0,r),liveTag.update_pn_buf.delayed_do());var a=site2[e.domain].btags&&site2[e.domain].btags[e.board.slice(1,-1)];return a&&Object.defineProperty(Object.getPrototypeOf(r),"btag2",{value:a,writable:!0}),r}function n(e,t){return Object.create(Object.getPrototypeOf(t),{1:{value:void 0,writable:!0},2:{value:[8585216,0,0]},u:{value:0,writable:!0},no:{value:parseInt(e.no,10)}})}return function(r){var a=this[r.domain];if(void 0===a&&(e(r,this),a=this[r.domain]),!r.board)return a;var s=a[r.board];if(void 0===s&&(a[r.board]=s=t(r,a)),!r.no)return s;var i=s[r.no];return void 0===i?s[r.no]=n(r,s):i}}()},acc:{value:Object.create(null,{0:{get:function(){var e=this.btags;return this.tl&&(e=e?e.concat(this.tl):this.tl),e||[]},set:function(e){var t=this.btags;if(t){pref.liveTag.ci&&(t=t.map(function(e){return e.toLowerCase()}));for(var n=0;n<e.length;n++)t.indexOf(pref.liveTag.ci?e[n].toLowerCase():e[n])!=-1&&e.splice(n--,1)}e.length>0?this.tl=e:void 0!==this.tl&&delete this.tl}},t:{get:function(){return this[1]}},t0:{get:function(){return this[0]},set:function(e){this[0]=e}},t1:{get:function(){return this[1]},set:function(e){this[1]=e}},wt:{get:function(){return this[2]},set:function(e){this[2]=e}},key:{get:function(){return this.domain+this.board+(this.no?this.no:"")}},tags:{get:function(){return(this[0]||[]).concat(this[1]||[])}},btags:{get:function(){var e=pref.liveTag.inherit_board_name&&pref.liveTag.lock_board_name?[this.btag]:null;return this.btag2&&pref.liveTag.inherit_board_tags&&pref.liveTag.lock_board_tags?e?e.concat(this.btag2):this.btag2:e}},watched:{get:function(){return 786432&this[2][0]}},watched_p:{get:function(){return 67895296&this[2][0]}},time_checked:{get:function(){return this[2][2]}},archived:{get:function(){return(7340032&this[2][0])>>20},set:function(e){this[2][0]=4287627263&this[2][0]|(7&e)<<20}},posts_saved:{get:function(){return(33554432&this[2][0])>>25},set:function(e){this[2][0]=4261412863&this[2][0]|(1&e)<<25}},force_ar:{get:function(){return(5242880&this[2][0])>>20}},rescan_dp:{get:function(){return(16777216&this[2][0])>>24},set:function(e){this[2][0]=4278190079&this[2][0]|(1&e)<<24}},nrtm:{get:function(){return this[2][1]>>16}},nr:{get:function(){return 65535&this[2][1]},set:function(e){this[2][1]=(4294901760&this[2][1])+e}},nof_posts:{get:function(){return 65535&this[2][0]},set:function(e){this[2][0]=(4294901760&this[2][0])+e}},LS_synced:{get:function(){return 1&this.d},set:function(e){this.d=4294967294&this.d|1&e}},IDB_synced:{get:function(){return(2&this.d)>>1},set:function(e){this.d=4294967293&this.d|(1&e)<<1}}})}}),postprocess_board_add_btag:function(e,t){for(var n=0;n<e.length;n++)e[n]="#"+e[n].replace(/[&<>'"#]/g,""),e[n].length>pref.liveTag.maxstr&&e.splice(n--,1);var r=t.btag2&&t.btag2.length===e.length;if(r)for(var n=0;n<e.length;n++)if(e[n]!==t.btag2[n]){r=!1;break}if(!r){for(var n=0;n<e.length;n++)liveTag.tags[e[n]]&&liveTag.tags[e[n]].ref_tag===e[n]&&(e[n]=liveTag.tags[e[n]].ref_tag);Object.defineProperty(Object.getPrototypeOf(t),"btag2",{value:e,writable:!0}),pref.liveTag.inherit_board_tags&&liveTag.inherit_board_tags_changed_1(e,t)}},retag:function(e,t){t&&(t.list_nup.add_scan(e),e.wt[0]|=131072);var n={com:e.tags.join(" "),parse_funcs:{type_com:"txt"},__proto__:e};liveTag.prep_tags(n,!0),cataLog.threads[e.key]&&cataLog.Footer.update_force(e.key,null,e)},retag_db:DelayBuffer.prototype.delayed_do.bind(new DelayBuffer(function(){gClg.FilterChanged()},10)),inherit_board_name_changed:function(){for(var e in this.mems)for(var t in this.mems[e])this.inherit_board_tags_changed_1([this.mems[e][t].btag],this.mems[e][t],!pref.liveTag.inherit_board_name)},inherit_board_tags_changed:function(){for(var e in this.mems)for(var t in this.mems[e])this.mems[e][t].btag2&&this.inherit_board_tags_changed_1(this.mems[e][t].btag2,this.mems[e][t],!pref.liveTag.inherit_board_tags)},inherit_board_tags_changed_1:function(e,t,n){for(var r=0;r<e.length;r++)this.retag_in_th_sub(e[r],t,n);for(var a in t){t.domain,t.board,t[a].no;this.retag(t[a],n&&t[a].tags.length>=pref.liveTag.max)}this.retag_db(),this.update_pn_buf.delayed_do()},ex_list_changed:function(){if(pref.liveTag.ex_list)for(var e in this.mems)for(var t in this.mems[e])for(var n in this.mems[e][t]){var r=this.mems[e][t][n],a=r.tags.length;this.exclude_tags(r,r.t0,r.t1,!0)&&this.retag(r,a>=pref.liveTag.max)}},exclude_tags:function(e,t,n,r){var a=pref_func.merge_obj5a(e,pref.liveTag.ex_list_obj5,null);if(a){var s=this.exclude_tags_1(t,a,r?e:null),i=this.exclude_tags_1(n,a,r?e:null);return r&&(s&&(e.t0=s),i&&(e.t1=i)),s||i}},exclude_tags_1:function(e,t,n){var r=!1;if(e)for(var a=e.length-1;a>=0;a--)e:for(var s=0;s<t.length;s++)if(t[s].test(e[a])){n&&this.delete_tags(e[a],n.key),e.splice(a,1),r=!0;break e}return r?e:null},key_dirty:Object.create(null),tags_array_old:[],tags_proto:{pk:!1,in:!1,ex:!1,pn:null,mems_keys_obj:function(){var e={};for(var t of this.mems.keys())if(void 0===t.no)for(var n in t)e[t[n].key]=this.mems.get(t);else e[t.key]=this.mems.get(t);return e},mems_keys:function*(){for(var e of this.mems.keys())if(void 0===e.no)for(var t in e)yield e[t];else yield e},mems_keys_length:function(){var e=0;for(var t of this.mems.keys())if(void 0===t.no)for(var n in t)++e;else++e;return e},mems_keys_length_and_set_top:function(){var e=0,t={};for(var n of this.mems.keys()){var r=this.mems.get(n);if(void 0===t[r]&&(t[r]=0),void 0===n.no)for(var a in n)++t[r],++e;else++t[r],++e}for(var a in t)(t[a]>t[this.key]||t[a]==t[this.key]&&a<this.key)&&(this.key=a);return this.key===this.ref_tag&&(this.key=this.ref_tag),e},mems_boards:function(){var e={};for(var t of this.mems.keys())e[t.key.substr(0,t.key.lastIndexOf("/")+1)]=null;return e},caption:function(e){return this.num+(e?"/"+Object.keys(this.mems_boards()).length:"")+": "+this.key},re_caption:function(e){this.pn.childNodes[3].textContent=this.caption(e)},make_pn:function(){var e=cnst.dom('<div name="dummy"><input type="checkbox" name="pk"><input type="checkbox" name="in"><input type="checkbox" name="ex"> </div>');return function(t){var n=e.cloneNode(!0);return n.setAttribute("name",this.key),n.childNodes[0].checked=this.pk,n.childNodes[1].checked=this.in,n.childNodes[2].checked=this.ex,n.childNodes[3].textContent=this.caption(t),this.pn=n,n}}(),inv_val:function(e){var t=!this[e];return this[e]=t,null!==this.pn&&(this.pn.childNodes["pk"===e?0:"in"===e?1:2].checked=t),t}},scan_regex:/#[^#, \.:;\n\|"<>&]+(?=[#, \.:;\n\|"<>&]|$)/g,update_tags_in_th_sub:function(e,t,n,r,a,s,i,o,l){for(var p=e.length,c=0;p<a&&c<n.length;){var _=n[c++],d=pref.liveTag.ci?_.toLowerCase():_;if(d===_&&(d=_),void 0===r[d]&&void 0===t[d]){if(t[d]=_,void 0===this.tags[_]){if(void 0===this.tags_ci[d]){null===this.key_dirty[d]&&this.update_pn();var u=new Map;this.tags_ci[d]={key:_,mems:u,ref_tag:_,num:0,ur:i,__proto__:this.tags_proto},this.tags_array_old[this.tags_array_old.length]=this.tags_ci[d]}_!==d&&(this.tags[_]=this.tags_ci[d],void 0===this.tags_ci[d].sb?this.tags_ci[d].sb=[_]:this.tags_ci[d].sb[this.tags_ci[d].sb.length]=_)}var f=this.tags[_].mems;if(_===this.tags[_].ref_tag)_=this.tags[_].ref_tag;else for(var h in f)if(_===f.get(h)){_=f.get(h);break}if(f.has(o))l||(this.key_dirty[d]=null);else{var m=null===s?o:o[s.no],g=f.get(m);void 0!==g&&g===_||(this.key_dirty[d]=null),f.set(m,_)}e[p++]=_}var v=this.tags_reserved[d];if(null===s){var b=this.tags_ci[d].pk;(void 0!==v||b)&&this.tags_reserved_found_scan(d,!0,v,b,o)}else void 0!==v&&this.tags_reserved_found(d,!0,v)}return c},retag_in_th_sub:function(e,t,n){if(n)this.tags[e]&&this.delete_tags(e,t.key);else{this.update_tags_in_th_sub([],{},[e],{},1,null,0,t);var r=this.tags[e].mems;for(var a in t)r.has(a)&&r.delete(a)}},update_tags_in_th:function(e,t,n,r,a,s,i){var o=this.generate_ur(s[1]),l=[],p={};if(this.update_tags_in_th_sub(l,p,e,n,r,a,o,i),t)for(var c=this.update_tags_in_th_sub(l,p,t,n,r,a,o,i);c<t.length;){var _=t[c++],d=pref.liveTag.ci?_.toLowerCase():_;void 0===n[d]&&(p[d]!==_&&(this.key_dirty[d]=null),void 0===p[d]&&this.delete_tags(_,a.key))}for(var c in n)this.check_update_tags_color(n[c],o);for(var c=0;c<l.length;c++)this.check_update_tags_color(l[c],o);return e=null,
this.keys_fix=p,l},remove_tags_in_th:function(e){var t=this.mems[e[0]][e[1]][e[2]];if(t){for(var n=t.tags,r=0;r<n.length;r++)this.delete_tags(n[r],t.key);var a=t.btags;if(pref3.stats.use&&stats.thread_removed(e),t.q&&(t.q=null),t.nr&&(pref.notify.favicon||pref.notify.title.notify)&&notifier.favicon.set(),delete this.mems[e[0]][e[1]][e[2]],a)for(var r=0;r<a.length;r++)this.key_dirty[pref.liveTag.ci?a[r].toLowerCase():a[r]]=null,pref.liveTag.style.use&&this.update_ur_1(a[r]);this.update_pn_buf.delayed_do()}},delete_tags:function(e,t,n){if(!n&&0!=this.subscribers.length)for(var r=0;r<this.subscribers.length;r++)this.delete_tags.call(this.subscribers[r],e,t,!0);var a=pref.liveTag.ci?e.toLowerCase():e;if(this.key_dirty[a]=null,this.tags[e]&&(this.tags[e].mems.delete(this.mems.getFromName(t))&&pref.liveTag.style.use&&this.update_ur_1(e),0==this.tags[e].mems.size)){this.tags[e].pn;null!==this.tags[e].pn&&this.pn.removeChild(this.tags[e].pn);for(var r in this.active)this.tags[e][r]&&this.active[r]--;var s=this.tags_ci[a].sb;if(s)for(var r=0;r<s.length;r++)delete this.tags[s[r]];delete this.tags_ci[a],pref.debug_mode[3]&&console.log("Remove: "+e)}},check_update_tags_color:function(e,t){var n=this.tags[e].ur;this.tags[e].ur|=t,~n&t&&this.update_tag_node(e,null,!0)},rm_404_list:function(e,t,n){var r={};if(this.mems[e]&&this.mems[e][t]){var a=this.mems[e][t];for(var s in a)void 0===n[s]&&(r[s]=a[s])}return r},rm_404_1:function(e,t,n,r){var a=e+t+n;pref.test_mode[65]||pref.archive.IDB.auto_clean&&IDB.req(e,t,n,"pruned_time",Date.now(),"check_clean"),pref.test_mode[67]||archiver.clean_list(e,t,n),!r&&!pref.test_mode[65]&&pref.archive.IDB.auto_restore&&cataLog.threads[a]&&cataLog.restore_th_from_IDB(e,t,n),r||this.rm_404_2(e,t,n)},rm_404_2:function(e,t,n){this.remove_tags_in_th([e,t,n]),pref[cataLog.embed_mode].deleted_posts.auto_clean&&site2[e].clean_up_deleted_posts_1(t+n)},tooltip:function(e,t){var n,r=e.target;if("checkbox"===r.type){var a=r.name;n=r.parentNode.getAttribute("name"),t+=("pk"===a?"Fetch":"in"===a?"Show":"Hide")+" threads which have "+n+"."}else{n=r.getAttribute("name"),t+=n+": "+liveTag.make_info(n)+"<br>";var s=new RegExp("^"+site.nickname);for(var i of liveTag.tags[n].mems.keys())t+=i.key.replace(s,"")+", "}return t},boardlist_click_entry:function(e){if(!e.ctrlKey){e.preventDefault();var t=e.target.textContent;this.cbx_changed(t,pref.liveTag.click_func_bl,null,e.target)}},generate_ur:function(e){return e>>16!=0?3:0!=(65535&e)?1:0},CountNR:function(){var e=function(){this.nrtm=0,this.nr=0,this.nth=0};return e.prototype={count:function(e){if(67895296&e[0]){var t=65535&e[1];t&&(this.nrtm+=e[1]>>16,this.nr+=t,this.nth++)}},count_all:function(){for(var e in liveTag.mems)for(var t in liveTag.mems[e]){var n=liveTag.mems[e][t];if(n.nr<0){var r=new liveTag.CountNR;for(var a in n)r.count(n[a].wt);n.nrtm=r.nrtm,n.nr=r.nr}this.nrtm+=n.nrtm,this.nr+=n.nr}}},e}(),dirtify_ur:function(e){this.mems[e.domain][e.board].nr=-1},update_ur:function(e,t,n){for(var r=e.tags,a=0;a<r.length;a++)n?this.update_ur_1(r[a]):this.tags[r[a]]&&this.check_update_tags_color(r[a],t)},update_ur_1:function(e){var t=this.tags[e].ur,n=0;if(pref.test_mode[24])for(var r of this.tags[e].mems_keys())n|=liveTag.generate_ur(r.wt[1]);else{var a=this.tags[e].mems_keys_obj();for(var r in a){var s=this.mems.getFromName(r);s&&(n|=liveTag.generate_ur(s.wt[1]))}}t!=n&&(this.tags[e].ur=n,this.update_tag_node(e,null,!0))},count_ur:function(e){var t=0,n={},r=new this.CountNR;if(pref.test_mode[24])for(var a of this.tags[e].mems_keys())r.count(a.wt),n[a.domain+a.board]=null,t++;else{var s=this.tags[e].mems_keys_obj();for(var a in s){var i=common_func.fullname2dbt(a),o=this.mems[i[0]][i[1]][i[2]].wt;o&&r.count(o),n[i[0]+i[1]]=null}t=this.tags[e].mems_keys_length()}var l=Object.keys(this.tags[e].mems_boards()).length;return[r.nrtm,r.nr,r.nth,t,Object.keys(n).length,l]},make_info:function(e){var t=liveTag.count_ur(e);return"U: "+t[0]+"/"+t[1]+"/"+t[2]+" / T: "+t[3]+" / B: "+t[4]+"/"+t[5]},tag_onmouseover:function(e){return liveTag.make_info(e.target.textContent)},filter_changed_broadcast:function(){if(this.NC)this.clg.filter_changed();else for(var e=gClg.Clgs,t=0;t<e.length;t++)e[t].liveTag.NC||e[t].filter_changed()},cbx_changed:function(e,t,n,r,a){var s=this.tags[e],i=s.in===!1&&s.ex===!0,o=s.in===!1&&s.ex===!1,l=s.in===!0&&s.ex===!1,p="pkin"===t||"in"===t||"inex"===t&&(a?!o:!i),c="pkin"===t&&s.pk===s.in,_="ex"===t||"inex"===t&&(a?!l:!o);p&&this.cbx_emulate_inv(e,"in",n),c&&this.cbx_emulate_inv(e,"pk",n),_&&this.cbx_emulate_inv(e,"ex",n),this.filter_changed_broadcast(),this.update_tag_node(e,r)},filter_onchange:function(e,t,n){e.rexps=common_func.kwd_prep_regexp(e),this===liveTag||!e.rexps||this.subscribed||this.subscribe(),t&&!this.subscribed||this.update_pn(n)},tags_reserved:Object.create(null),tags_reserved_found_scan:function(e,t,n,r,a){("pk"===n||r)&&(scan.list_nup.add_board(a,0),scan.scan("b",a.domain)),void 0!==n&&this.tags_reserved_found(e,t,n)},tags_reserved_found:function(e,t,n){this.tags_ci[e][n]!=t&&this.cbx_changed(e,"pk"===n?"pkin":n,!0),delete this.tags_reserved[e]},tags_reserved_init:function(e,t){this.tags_reserved=Object.create(null);for(var n={},r=0;r<e.length;r++){var a="!"===e[r][0]?"ex":"#"===e[r][1]?"pk":"in",s="in"===a?e[r]:e[r].slice(1),i=pref.liveTag.ci?s.toLowerCase():s;if(this.tags_ci[i]){if(this.tags_reserved_found(i,t,a),t&&"pk"===a){var o=liveTag.tags_ci[i].mems_boards();for(var l in o)n[l]=null}}else t&&(this.tags_reserved[i]=a)}return n},update_pn_last_filter_active:!1,sort_func:function(e,t){return t.num-e.num||t.mems.size-e.mems.size||(t.key>e.key?-1:1)},update_pn_disp_func:function(e,t){if(null===e)return 0;for(var n=0;n<e.length;n++)if(e[n].test(t))return 1;return 0},update_pn_buf:null,setup_pn:function(e,t){this.pn=e.getElementsByTagName("div")["filter.tag_list"],this.pn.onchange=this.cbx_onchange_entry.bind(this),this.pn_summary=this.pn.nextSibling.childNodes[0],this.filter_onchange(t,!0,!0)},update_pn:function(e){null!==this.pn&&(this.update_pn_1_lazy.cancel(),this.update_pn_1(e,!0))},update_pn_pos:null,update_pn_1_lazy:null,update_pn_1:function(e,t){var n=this===liveTag,r=this.tags_array_old,a=0,s=0;for(var i in this.key_dirty)this.tags_ci[i]?n&&(this.tags_ci[i].num=pref.liveTag.ci?this.tags_ci[i].mems_keys_length_and_set_top():this.tags_ci[i].mems_keys_length()):s++,a++;n&&(a||pref.test_mode[73])&&r.sort(this.sort_func),a&&(t=!0);var o=e||this.update_pn_pos,l=pref.liveTag.lazy_each,p=(this.clg?this.clg.pref:pref).filter,c=p.tag_search.rexps,_=c||this.update_pn_last_filter_active;if(_||s){for(var d=t?this.pn.firstChild:this.update_pn_pos[0],u=t?0:this.update_pn_pos[2],f=d?null:document.createDocumentFragment(),h=p.tag_search.show_nof_boards,m=t?0:this.update_pn_pos[1];m<r.length;m++){var g=r[m].key,v=pref.liveTag.ci?g.toLowerCase():g,b=v in this.key_dirty,y=this.tags_ci[v]||!n&&b&&(this.prep_NC(g),this.tags_ci[v]);if(y){if(_){var w=y.pn;if(o||b){var k=this.update_pn_disp_func(c,v);0===k?null!==w&&(d===w&&(d=w.nextSibling),this.pn.removeChild(w),y.pn=null):(null!==w?b&&y.re_caption(h):l>0&&(w=y.make_pn(h)),d!==w?l>0&&(f?f.appendChild(w):(this.pn.insertBefore(w,d),d=w.nextSibling),0==--l&&(this.update_pn_pos=[d,m+1,u])):d=w.nextSibling,u++)}else w&&(d=w.nextSibling,u++)}}else n&&r.splice(m--,1);if((a<=0||b&&--a<=0)&&(!_||l<=0))break}l<=0&&this.update_pn_pos[1]<r.length?this.update_pn_1_lazy.delayed_do(pref.liveTag.lazy_delay):this.update_pn_pos=null,f&&this.pn.appendChild(f),this.pn_summary.textContent=c?u+(this.update_pn_pos?"...":"")+"/"+r.length:""}if(this.update_pn_last_filter_active=c,n){if(pref.virtualBoard.show&&!e&&this.update_boardlist(),0!=this.subscribers.length){for(var m=0;m<this.subscribers.length;m++)for(var x in this.key_dirty)this.subscribers[m].key_dirty[x]=null;if(null===this.update_pn_pos&&!e&&t)for(var m=0;m<this.subscribers.length;m++)this.subscribers[m].update_pn_buf.delayed_do()}this.sub_tagSearch&&null===this.update_pn_pos&&this.sub_tagSearch()}else c||this.unsubscribe();this.key_dirty=Object.create(null)},subscribers:[],subscribe:function(){this.NC||(this.tags_ci={},this.tags=Object.create(this.tags_ci));for(var e=0;e<this.tags_array_old.length;e++)this.prep_NC(this.tags_array_old[e].key);liveTag.subscribers.push(this),this.subscribed=!0},unsubscribe:function(e){if(e)for(var t in this.tags_ci)this.tags_ci[t].pn&&this.tags_ci[t].pn.remove();if(this.NC){for(var t in this.tags_ci)this.tags_ci[t].pk||this.tags_ci[t].in||this.tags_ci[t].ex||delete this.tags_ci[t];for(var t in this.tags)this.tags[t].pk||this.tags[t].in||this.tags[t].ex||delete this.tags[t]}else delete this.tags_ci,delete this.tags;liveTag.subscribers.splice(liveTag.subscribers.indexOf(this),1),this.subscribed=!1},factory:function(e,t,n){var r={clg:e,footer:t,pn:null,pn_summary:null,NC:n,subscribed:!1,key_dirty:Object.create(null),__proto__:liveTag};return r.update_pn_buf=new DelayBuffer(liveTag.update_pn.bind(r),pref.liveTag.disp_delay),r.update_pn_1_lazy=new DelayBuffer(liveTag.update_pn_1.bind(r,!0),pref.liveTag.lazy_delay),n&&(r.tags_ci={},r.tags=Object.create(r.tags_ci),r.active={pk:0,in:0,ex:0}),r},popup_filter:function(){var e={"filter.tag_search.str":function(){this["."]?this["."].liveTag.filter_onchange(this["."].pref.filter.tag_search,null,!0):liveTag.filter_onchange(pref.filter.tag_search,null,!0)},__proto__:pref_func.settings.oninput_funcs.__proto__},t={"filter.tag_search.re":e["filter.tag_search.str"],"filter.tag_search.show_nof_boards":function(){for(var e=(this["."]&&this["."].pref||pref).filter.tag_search.show_nof_boards,t=this["."]&&this["."].liveTag||liveTag,n=0;n<t.tags_array_old.length;n++){var r=t.tags_array_old[n].key,a=t.tags[r];a&&a.pn&&a.re_caption(e)}},__proto__:e};return{html:'<div style="float:left"><div><ICN"filter.tag">Tag :</div><div style="text-align:right"><a name="SHOW5" style="cursor:pointer" data-show5="tagButtons" data-str="[▲]">[▼]</a></div></div><div style="float:left"><div> Fetcn / In / Out / Threads / Tag <ITBL25"filter.tag_search.str" placeholder="Search tags..."> <ICN"filter.tag_search.re">RE</div><div style="display:none" data-show5="tagButtons"><span style="display:inline-block"><BTN"tagB.all_c_pk,C"><BTN"tagB.all_c_in,C"><BTN"tagB.all_c_ex,C"> Clear checkboxes of all tags<br><BTN"tagB.shown_c_pk,C"><BTN"tagB.shown_c_in,C"><BTN"tagB.shown_c_ex,C"> Clear checkboxes of shown tags<br><BTN"tagB.shown_t_pk,T"><BTN"tagB.shown_t_in,T"><BTN"tagB.shown_t_ex,T"> Toggle checkboxes of shown tags<br></span><span><IC"filter.tag_search.show_nof_boards">Show number of boards</span></div><div style="overflow:auto;resize:both;display:inline-block;height:16px;width:250px" name="filter.tag_list"></div><div style="display:inline-block"><span></span></div>'+pref_func.settings.html_funcs.rollup('<div style="clear:both"><BTN"tag2bList,Add"> selected tags to the last of board group by <SE"filter.tag2bList.by,tag:Tag,board:Board"><br>1,Label: <ITBL20"filter.tag2bList.label" placeholder="default: topmost tag"><br></div>')+'</div><div style="clear:both"></div>',oninput_funcs:e,onchange_funcs:t,embed:function(n){if(!liveTag.pn){var r=document.createElement("div");r.innerHTML="<div>"+pref_func.format_html_str(this.html)+"</div>",r.appendChild(n),liveTag.setup_pn(r,pref.filter.tag_search);var a=site2[site.nickname].make_tack();return a.onclick=cnst.tack_float_nSblgs,a.setAttribute("style","float:right;font-size:2em"),r.insertBefore(a,r.firstChild),pref_func.add_onchange(r,t,e),pref_func.apply_prep(r,!1),Tooltips.add_root(r),liveTag.update_pn(!0),r}},popup:function(){if(!liveTag.pn){var n=function(){Tooltips.remove_root(r.pn),liveTag.pn=null,cnst.div_destroy(r.pn,!0)},r=cnst.init3({func_str:"top:0px:left:0px:Show:tb",exit:n});r.cn.innerHTML=pref_func.format_html_str(liveTag.popup_filter.html),pref_func.add_onchange(r.cn,t,e),pref_func.apply_prep(r.pn,!1),Tooltips.add_root(r.pn),liveTag.update_pn(!0)}}}}(),cbx_all_onchange:function(e){var t=this["."]&&this["."].liveTag||liveTag,n=e.target,r="c"===n.name.substr(-4,1),a=n.name.substr(-2,2),s="all"===n.name.substr(-8,3),i=null;for(var o in t.tags_ci){var l=t.tags_ci[o];if((s||l.pn)&&(!r||l[a])&&(t.cbx_emulate_inv(o,a,!0),t.update_tag_node(o),"pk"===a&&l[a])){var p=liveTag.tags_ci[o].mems_boards();if(i)for(var c in p)i[c]=p[c];else i=p}}i&&0!=Object.keys(i).length&&scan.scan_ui("refresh_tag",{tgts:i,options:{callback:function(){scan.scan("t")},priority:6}}),t.filter_changed_broadcast()},cbx_emulate_inv:function(e,t,n,r){this.cbx_onchange(e,t,this.tags[e].inv_val(t),n,r)},cbx_onchange_entry:function(e){var t=e.target,n=t.parentNode.getAttribute("name");pref.liveTag.ci&&(n=n.toLowerCase());var r=t.name;this.tags[n]||this.prep_NC(n),this.tags[n][r]=t.checked,this.cbx_onchange(n,r,this.tags[n][r]),this.filter_changed_broadcast(),this.update_tag_node(n)},cbx_onchange:function(e,t,n,r,a){if(a&&!this.NC||(this.active[t]+=n?1:-1),"pk"===t&&(n&&!this.tags[e].in&&this.cbx_emulate_inv(e,"in"),!a&&n&&!r&&gClg)){var s=this.tags[e].mems_boards();0!=Object.keys(s).length&&scan.scan_ui("refresh_tag",{tgts:s,options:{callback:function(){scan.scan("t")},priority:6}})}if("in"!==t&&"ex"!==t||this.active.in+this.active.ex===(n?1:0)&&this.clg&&(this.clg.pref.filter.tag=n,this.clg.components.tag_use.checked=n),!a&&!this.NC)for(var i=gClg.Clgs,o=0;o<i.length;o++)this!==i[o].liveTag&&!i[o].liveTag.NC&&(i[o].liveTag===liveTag&&this.subscribed||i[o].liveTag.subscribed)&&(i[o].liveTag.subscribed&&!i[o].liveTag.tags[e]&&i[o].liveTag.prep_NC(e),i[o].liveTag.cbx_emulate_inv(e,t,r,!0))},add_tags_to_boardlist:function(){var e,t=liveTag.tags_array_old,n=pref.filter.tag2bList.label||(t.filter(function(e){return e.in})[0]||t.filter(function(e){return e.pk})[0]||t.filter(function(e){return e.ex})[0]).key;if("tag"===pref.filter.tag2bList.by)e=[t.filter(function(e){return e.in}).map(function(e){return e.key}).join(","),t.filter(function(e){return e.pk}).map(function(e){return"#"+e.key}).join(","),t.filter(function(e){return e.ex}).map(function(e){return"!"+e.key}).join(",")];else{for(var r=t.filter(function(e){return e.in}).map(function(e){return e.mems_boards()}),a=t.filter(function(e){return e.pk}).map(function(e){return e.mems_boards()}),s=t.filter(function(e){return e.ex}).map(function(e){return e.mems_boards()}),i={},o=0;o<r.length;o++)for(var l in r[o])i[l]=null;for(var o=0;o<a.length;o++)for(var l in a[o])i[l]=null;for(var o=0;o<s.length;o++)for(var l in s[o])delete i[l];e=Object.keys(i)}pref_func.settings.onchange_funcs["tag.add_to_list"](n+", "+e.filter(function(e){return e}).join(","))},search_by_tags:function(e){var t=!this.active.in,n=e.tags;if(this.active.in)for(var r=0;r<n.length;r++)if(n[r]in this.tags&&this.tags[n[r]].in){t=!0;break}if(t&&this.active.ex)for(var r=0;r<n.length;r++)if(n[r]in this.tags&&this.tags[n[r]].ex){t=!1;break}return t},keys_fix:null,prep_tags:function(e,t){var n=this.mems.init(e),r=n.wt;if((65536&r[0]&&pref.liveTag.watch_all&&e.time_created||8388608==(8650752&r[0])&&(e.time_created>0||e.time_posted>0))&&(cataLog.set_watch_time_thread(e.key,cataLog.embed_mode,e.time_created,e.time_posted,e,r),pref.archive.store_watched&&n.watched&&!n.archived&&archiver.start_1("ARC",n)),65536&r[0]||t){65536&r[0]&&(!pref.test_mode[64]&&pref[cataLog.embed_mode].deleted_posts.merge&&archiver.prep_deleted_posts(e,n),pref.test_mode[67]||archiver.check_op(e,n),r[0]=4294836224&r[0]);var a=(pref.liveTag,[[],[]]);if(pref.liveTag.inherit_board_name){a[pref.liveTag.lock_board_name?0:1][0]=n.btag}if(pref.liveTag.inherit_board_tags&&n.btag2){var s=pref.liveTag.lock_board_tags?0:1;a[s]=a[s].concat(n.btag2)}var i=site2[e.domain].check_reply.check_t1_op(e);if(0!=i.length){var o=pref.liveTag.lock_tags_in_op?0:1;a[o]=a[o].concat(i)}e.tags&&0!=e.tags.length&&pref.test_mode[153]&&(a[1]=a[1].concat(e.tags)),this.exclude_tags(e,a[0],a[1]),e.parse_funcs.has_editing&&e.posts[0].editing&&0!=a[0].length&&(a[0]=this.extract_tags_trim_editing(e,n,a[0])),0!=a[0].length&&(n.t0=this.update_tags_in_th(a[0],null,{},a[0].length<pref.liveTag.max?a[0].length:pref.liveTag.max,e,r,this.mems[e.domain][e.board])),0!=a[1].length?this.extract_tags(e,a[1],this.keys_fix):(null!==n.t1&&(n.t1=null),this.update_pn_buf.delayed_do())}return n},update_tags_in_editing_posts:function(e,t,n){for(var r=e.parse_funcs.posts_obj(e,t.ed_t[t.ed_t.length-1].no),a=!1,s=t.ed_t.length-1;s>=0;s--)if("string"!=typeof t.ed_t[s]){var i=r[t.ed_t[s].no];if(i&&!i.editing){if("post"===pref.liveTag.from||i.no==e.no){site2[e.domain].wrap_to_parse.posts({posts:[i],__proto__:e});var o=site2[e.domain].check_reply.check_t1_op(i);0!=o.length&&(a=!0),t.ed_t=t.ed_t.slice(0,s).concat(o).concat(t.ed_t.slice(s+1))}else t.ed_t.splice(s,1);n[n.length]=i}}if(0!=n.length)return pref.debug_mode[24]&&console.log(e.key+": retag_req: "+o+", "+a+", "+(t.ed_t&&t.ed_t.map(function(e){return"string"==typeof e?e:e.no+"("+e.time+")"}))),0==t.ed_t.length?void(t.ed_t=null):a?this.extract_tags(e,t.ed_t,null,null,!0):o?this.extract_tags_trim_editing(e,t,t.ed_t,!0)&&void 0:void 0},extract_tags_trim_editing:function(e,t,n,r){for(var a=null,s=n.length-1;s>=0;s--)"string"!=typeof n[s]&&(a||(a=n.slice(0,s+1)),n.splice(s,1));return(a||r)&&(t.ed_t=r||!t.ed_t?a:a.concat(t.ed_t),pref.debug_mode[24]&&console.log(e.key+": lth.ed_t: "+(t.ed_t&&t.ed_t.map(function(e){return"string"==typeof e?e:e.no+"("+e.time+")"})))),n},extract_tags:function(e,t,n,r,a){var s=this.mems[e.domain][e.board][e.no];if(e.parse_funcs.has_editing&&(t=this.extract_tags_trim_editing(e,s,t,a)),!n){this.keys_fix={};var i=s.t0;if(null!==i&&0!=i.length)if(pref.liveTag.ci)for(var o=0;o<i.length;o++)this.keys_fix[i[o].toLowerCase()]=i[o];else for(var o=0;o<i.length;o++)this.keys_fix[i[o]]=i[o]}var l=void 0!==i?i.length:s.t0.length,p=this.update_tags_in_th(t,s.t1,this.keys_fix,pref.liveTag.max-l,e,s.wt,this.mems[e.domain][e.board],r);return(0!=p.length||s.t1&&0!==s.t1.length)&&(s.t1=p),this.update_pn_buf.delayed_do(),this.keys_fix=null,s},tags_boardlist:null,update_boardlist:function(e){if(site.components.boardlist){null===this.tags_boardlist&&(this.tags_boardlist=[],pref_func.settings.onchange_funcs["virtualBoard.search.show"](null,!0),this.filter_onchange(pref.virtualBoard.search,!0));for(var t=0,n=e,r=0,a=0,s="both"===pref.virtualBoard.p_board&&pref.virtualBoard.p_remove,i=pref.virtualBoard.search.show&&pref.virtualBoard.search.rexps;a<pref.virtualBoard.max&&t<this.tags_array_old.length;){var o=this.tags_array_old[t].key;s&&"/"+o.substr(1)+"/"in this.mems[site.nickname]?r++:i&&!this.update_pn_disp_func(i,pref.liveTag.ci?o.toLowerCase():o)||(this.tags_boardlist[a]!==o&&(this.tags_boardlist[a]=o,n=!0),a++),t++}a!=this.tags_boardlist.length&&(this.tags_boardlist.splice(a,this.tags_boardlist.length-a),n=!0),n&&site2[site.nickname].show_boardlist(this.tags_boardlist,this.boardlist_click_entry)}},update_tag_node:function(e,t,n){if(null!==cataLog.threads){var r=liveTag.tags[e].mems_keys_obj(),a=n||!this.NC?gClg.footer:this.footer;for(var s in r)a.color_tag_node(s,e,n)}if(!this.NC){var i=this.tags_ci[pref.liveTag.ci?e.toLowerCase():e].key,o=t||site2[site.nickname].query_tag_node(i);o&&this.color_tag_node(o,i)}},color_tag_node:function(e,t){var n=pref.liveTag.style,r=this.tags[t],a=n.use?r?r.ur:liveTag.tags[t].ur:0,s=r&&r.ex?a>=2?n.exurtm:a>=1?n.exur:n.ex:r&&r.in?a>=2?n.inurtm:a>=1?n.inur:n.in:a>=2?n.urtm:a>=1?n.ur:null;s?e.setAttribute("style",s):e.removeAttribute("style")},update_tag_nodes:function(e,t,n,r,a){for(var s=pref.debug_mode[35]?a&&a.slice():null,i=s?[]:null,o=r||document.createElement("span"),l=o.firstChild,p=0;p<e.length;p++){var c=a&&a.slice();s&&i.push(l&&l.textContent||null);var _=null,d=e[p];if(a&&d==a[p])l&&(l=l.nextSibling),l&&p!=e.length-1&&(l=l.nextSibling),s&&i.push("same");else{var u=a?a.indexOf(d,p):-1;if(u==-1)o.insertBefore(this.create_tag_node_1(d,n,"span"),l),_=!0,a&&a.splice(p,0,d),s&&i.push("new");else if(u==p+1){var f=l,h=l.nextSibling;l=h.nextSibling;var m=e.indexOf(a[p],p+1),g=a.splice(p,1)[0];if(m==-1)o.removeChild(h),o.removeChild(f),s&&i.push("remove");else{var v=o.childNodes[2*(m+1)-1]||null;o.insertBefore(h,v),o.insertBefore(f,v),a.splice(m,0,g),s&&i.push("down")}l=l.nextSibling,l&&p!=e.length-1&&(l=l.nextSibling)}else{var f=o.childNodes[2*u];_=f.previousSibling,o.insertBefore(f,l),a.splice(p,0,a.splice(u,1)[0]),s&&i.push("up")}}p==e.length-1||l&&!_||o.insertBefore(_!==!0&&_||document.createTextNode(t),l),s&&(a&&e.slice(0,p+1).toString()!==a.slice(0,p+1).toString()&&console.log("ERROR: update_tag_nodes: arr: ",p,a,e,c,s,i),a&&0!=o.textContent.indexOf(a.slice(0,p+1).join(t))&&console.log("ERROR: update_tag_nodes_1: ",p,o.textContent,a,c,s,i))}if(l){for(;l.nextSibling;)o.removeChild(l.nextSibling);o.removeChild(l)}return s&&o.textContent!==this.create_tag_nodes(e,t,n).textContent&&console.log("ERROR: update_tag_nodes: ",o.textContent,e,s),o},create_tag_nodes:function(e,t,n){for(var r=document.createElement("span"),a=0;a<e.length;a++)0!=a&&t&&r.appendChild(document.createTextNode(t)),r.appendChild(this.create_tag_node_1(e[a],n,"span"));return r},create_tag_node_1:function(e,t,n){var r=document.createElement(n);return r.setAttribute("class",pref.script_prefix+"_tag"),r.textContent=e,this.color_tag_node(r,e),r},tag_node_onclick:function(e){var t=e.target.textContent;this.tags[t]||this.prep_NC(t),this.cbx_changed(t,pref.liveTag.click_func,null,null,e.ctrlKey)},prep_NC:function(e){if(this!==liveTag){var t=pref.liveTag.ci?e.toLowerCase():e;if(liveTag.tags_ci[t]){if(!this.tags_ci[t]){var n=liveTag.tags_ci[t];this.tags_ci[t]=this.NC?{pn:null,pk:!1,in:!1,ex:!1,__proto__:n}:{pn:null,pk:n.pk,in:n.in,ex:n.ex,__proto__:n}}this.tags[e]||(this.tags[e]=this.tags_ci[t])}}}};liveTag.update_pn_buf=new DelayBuffer(liveTag.update_pn.bind(liveTag),pref.liveTag.disp_delay),liveTag.update_pn_1_lazy=new DelayBuffer(liveTag.update_pn_1.bind(liveTag,!0),pref.liveTag.lazy_delay),liveTag.tags_ci=Object.getPrototypeOf(liveTag.tags),pref.cli.auto&&pref_func.site2_json(!1,!0,["liveTag"]);var hiddenPosts=pref.test_mode[162]?function(){function e(e,t,n){if(e&&e!==n)return t?e.classList.remove(pref.script_prefix+"_hidden"):e.classList.add(pref.script_prefix+"_hidden"),e}function t(e){var t=e.hp;return void 0===t?localStorage?JSON.parse(localStorage[site2[e.domain].ls_key_hiddenPosts+e.board+e.no]||null):null:t}function n(e,t){var n=Object.keys(t),r=site2[e.domain].ls_key_hiddenPosts+e.board+e.no;localStorage&&(0===n.length?delete localStorage[r]:localStorage[r]=JSON.stringify(t)),e.hp=n.length>0?t:null}function r(e,t,n){for(var r=e.threads[t][16].posts,a=0;a<r.length;a++)if(r[a].no===n)return r[a].pn}function a(e){for(;!e.classList.contains("post");)e=e.parentNode;return e}function s(n,r,a,s,i){var o=a||t(n.lth);if(o)for(var l=n.lth.q,p=0;p<r.length;p++){var c=r[p];if(c.no!==i)if(o[c.no]>(a?1:0))e(c.pn);else{if(c.quotes)for(var _=0;_<c.quotes.length;_++)if(c.quotes[_][0]===l&&1&o[c.quotes[_][1]]){o[c.no]=1,e(c.pn);break}!s||c.quotes&&_!==c.quotes.length||1!==o[c.no]||(delete o[c.no],e(c.pn,!0))}}}function i(i,o,l,p,c,_){var d=e(a(p),c);e(r(i,o,l),c,d);var u=liveTag.mems.getFromName(o),f=t(u)||{},h=_||c&&1&f[l];c?delete f[l]:f[l]=_?3:2,h&&s(i.threads[o][16],i.threads[o][16].posts,f,c,l),n(u,f)}return{hide_if_hit:s,cmd:function(r,a,s,o,l){if("PDISABLEHIDE"===l||"PENABLEHIDE"===l||"PCLEARHIDE"===l)for(var p=t(liveTag.mems.getFromName(a))||{},c=r.threads[a][16].posts,_=0;_<c.length;_++)c[_].no in p&&e(c[_].pn,"PENABLEHIDE"!==l);else i(r,a,s,o,"PUNHIDE"===l,"PHIDEAFTER"===l);"PCLEARHIDE"===l&&n(liveTag.mems.getFromName(a),{})}}}():null,IDB=function(){function e(e){console.log("IDB: ERROR: ",e),q.report({err_str:"IDB_ERROR:"+e.target.error.name});for(var t of L.keys())console.log(L.get(t));console.log("last_closed: ",S)}function t(e){pref.debug_mode[21]&&console.log("IDB: BLOCKED: "+e.oldVersion+" -> "+e.newVersion)}function n(e){console.log("IDBT: ABORT: "+e.target.error.name,e),q.report({err_str:"IDBT_ABORT:"+e.target.error.name});var t=e.target,n=t.db;navigator.webkitTemporaryStorage&&navigator.webkitTemporaryStorage.queryUsageAndQuota(console.log.bind(console)),x(n,t,"IDBT_abort:"+t.error.name)}function r(e){console.log("IDBT: ERROR: "+e.target.error.name,e),q.report({err_str:"IDBT_ERROR:"+e.target.error.name});var t=e.target.transaction;x(e.target.db||e.target.transaction&&e.target.transaction.db,t,"IDBT_onerror:"+t.error.name)}function a(e){e.target.onsuccess=null,s(e,!0)}function s(e,t){var n=e.target.result;D[n.name]=n.version,delete R[n.name+(t?"vc":"rw")];var r=t&&U[n.name]||M[n.name];if(pref.debug_mode[20]){var a=r&&r.debug_query()||null;console.log("IDB: opened: "+(L.size+1)+" "+n.name.replace(/^[^\/]*/,"")+" v"+n.version+", "+(a&&a.length)+" req(s), "+e.type+", "+(a&&a.coms))}var s={type:e.type,tr_count:1,reqs:r,pass:0,wdg:null,crawler:1,oss:{},tr_info:new Map,req_kinds:{},coms:a&&a.coms,done:0,done_put:0};if(L.set(n,s),r){for(var l=0;l<n.objectStoreNames.length;l++)s.oss[n.objectStoreNames[l]]=null;if(t){var _=e.target.transaction;if(T(n),u(_,function(){k({target:{db:n}})}),1==n.version)return delete R[n.name+"rw"],pref4.archive.IDB_board_sel_options=null,n.createObjectStore("Meta"),o(n,t);for(var d=0;;){G();var f=r.shift();if(s.pass++,!f)break;pref.debug_mode[20]&&s.done++,pref.debug_mode[22]&&"put"!==f.kind&&console.log("req_upgrade: "+f.no+", "+f.kind+", "+f.key+", "+r.debug_query().length),s.req_kinds[f.kind]=null;var h=null===s.oss[f.no];"put"===f.kind?h?(A(M,n.name,f),pref.debug_mode[22]&&d++):(c(n,f,k),s.oss[f.no]=null,pref.debug_mode[22]&&console.log("req_upgrade: "+f.no+", "+f.kind+", "+f.key+", "+r.debug_query().length)):"delete_th"===f.kind&&h&&p(n,f,_)}pref.debug_mode[22]&&d&&console.log("req_upgrade: downgraded: "+d),o(n,t)}else{var m=function e(){i(n,r,t,e)};s.complete_func=m,i(n,r,t,m)}}else o(n,t)}function i(e,t,n,r){var a=L.get(e);if(a){G();var s=void 0!==R[e.name+"vc"]?null:t.shift();if(a.pass++,s){pref.debug_mode[20]&&a.done++,pref.debug_mode[22]&&"put_m"!==s.kind&&console.log(e.name.replace(/^[^\/]*/,"")+s.no+", "+s.kind+", "+s.key+", "+t.debug_query().length);var l=null===a.oss[s.no];if("get_all_m"===s.kind){for(var p=[],c={},u=0;u<s.reqs.length;u++)null===a.oss[s.reqs[u].no]&&(p[p.length]=s.reqs[u],c[s.reqs[u].no]=null);0!==p.length?b(e,{nos:Object.keys(c),reqs:p},r):r()}else if("list_os"===s.kind)s.obj(site.nickname,e.name.substr(pref.script_prefix.length+1),Array.prototype.slice.call(e.objectStoreNames).filter(function(e){return"Meta"!==e})),r();else if("put_m"===s.kind){for(var p=[],c={},u=0;u<s.reqs.length;u++)null!==a.oss[s.reqs[u].no]?A(U,e.name,s.reqs[u]):(p[p.length]=s.reqs[u],c[s.reqs[u].no]=null);pref.debug_mode[22]&&console.log(e.name.replace(/^[^\/]*/,"")+(p[0]&&p[0].no||"skipped")+"("+Object.keys(c).length+"), "+s.kind+"("+p.length+"), "+s.key+", "+t.debug_query().length),p.length>1?(s.reqs=p,s.nos=Object.keys(c),_(e,s,r)):1==p.length?_(e,p[0],r):r()}else if("put"===s.kind)l?_(e,s,r):(A(U,e.name,s),r());else if("delete"===s.kind)l?d(e,s,r):r();else if("clean_up"===s.kind||"clean_m"===s.kind){O[e.name]||(O[e.name]={list:[],write:null});for(var f=O[e.name].list,m=f.length,c={Meta:null,__proto__:s.obj},u=0;u<f.length;u++)c[f[u].no]=null;if("clean_up"===s.kind)for(var v=Date.now(),y=e.objectStoreNames,u=0;u<y.length;u++)null!==c[y[u]]&&(f[f.length]={no:y[u],pruned_time:v});else for(var u=0;u<s.reqs.length;u++)null===a.oss[s.reqs[u].no]&&null!==c[s.reqs[u].no]&&(f[f.length]={no:s.reqs[u].no,pruned_time:s.reqs[u].obj});null===O[e.name].write?(O[e.name].write=!1,h(e,s,r)):g(e,null,r,f.length!==m)}else r();a.crawler<pref.archive.IDB.nof_tr&&!t.isEmpty&&(a.crawler++,i(e,t,n,r))}else 0==--a.crawler&&o(e,n)}}function o(e,t){k({target:{db:e}});var n=t&&U[e.name]&&U||M;n[e.name]&&n[e.name].isEmpty&&delete n[e.name],z[e.name]&&l(e.name),t?M[e.name]&&!M[e.name].isEmpty&&I(e.name):U[e.name]&&!U[e.name].isEmpty&&I(e.name,!0),0===Object.keys(M).length&&0===Object.keys(U).length&&0===Object.keys(z).length&&K.stop()}function l(e){M[e]?M[e].push_all(z[e]):M[e]=z[e],delete z[e]}function p(e,t,n){e.deleteObjectStore(t.no),pref.debug_mode[23]&&console.log("IDB: delete_th: "+e.name+t.no+", "+e.objectStoreNames.length)}function c(e,t,n){T(e);var r=e.createObjectStore(t.no).transaction;u(r,function(r){return function(a){pref.test_mode[66]?(A(M,e.name,t),n({target:{db:e}})):_(e,t,n),r&&r(a)}}(r.oncomplete))}function _(t,n,r){var a=n.reqs||[n];try{for(var s=u(t.transaction(n.nos||n.no,"readwrite",n),r,n,t),i=0;i<a.length;i++){var o=a[i];if(pref.test_mode[82]&&o.obj instanceof Blob)if(pref.test_mode[83])o.obj=null;else if(pref.test_mode[84]){for(var l="";2*l.length<o.obj.size;)l+=Math.random();o.obj=l}else{for(var p=[],c=0;2*c<o.obj.size;c++)p[c]=Math.floor(65536*Math.random());o.obj=String.fromCharCode.apply(null,p)}pref.debug_mode[23]&&console.log("put_"+(n.nos?"m: ":"1: ")+t.name.replace(/^[^\/]*/,"")+o.no+", "+o.key+("posts"===o.key?":"+o.obj.length:"")+(n.nos?" "+(i+1)+"/"+n.nos.length+"/"+n.reqs.length:""));s.objectStore(o.no).put("posts"!==o.key?o.obj:JSON.stringify(o.obj,archiver.store_json_func),"posts"!==o.key?o.key:o.key+"_"+o.obj[0].no).onerror=e}pref.debug_mode[20]&&(L.get(t).done_put+=a.length)}catch(e){console.log("IDB: fail to put: "+e.name+": "+JSON.stringify(o,["no","key","kind"]),e,L.get(t)),"InvalidStateError"===e.name&&(A(z,t.name,o),pref.debug_mode[20]&&console.log("IDB: re-scheduled:")),r({target:{db:t}})}}function d(e,t,n){u(e.transaction(t.no,"readwrite"),n).objectStore(t.no).delete(t.key)}function u(e,t,a,s){return e.oncomplete=a?f:t,e.onabort=n,e.onerror=r,a&&L.get(s).tr_info.set(e,{req:a,func:t}),e}function f(e){var t=L.get(e.target.db);if(t){var n=t.tr_info.get(e.target).func;t.tr_info.delete(e.target),n&&n(e)}}function h(e,t,n){e.objectStoreNames.contains("Meta")?u(e.transaction("Meta","readwrite"),n).objectStore("Meta").get("pruned_time").onsuccess=m:(O[e.name].write=!0,g(e,t,n,!0))}function m(e,t){var n=e.target.transaction.db,r=e.target.result;if(r){var a=L.get(n),s=a&&a.oss||{};r=r.filter(function(e){return null===s[e.no]});for(var i={},o=0;o<r.length;o++)void 0!==i[r[o].no]&&r.splice(i[r[o--].no],1),i[r[o].no]=o;O[n.name].list=r.concat(O[n.name].list.filter(function(e){return void 0===i[e.no]}))}O[n.name].write=!0,g(n,null,null,!0)}function g(e,t,n,r){for(var a=O[e.name].list,s=Date.now()-36e5*pref.archive.IDB.prune,i=0;i<a.length&&a[i].pruned_time<s;)pref.archive.IDB.auto_restore_remove&&gClg.Remove_thread_refresh(site.nickname+e.name.replace(/^[^\/]*/,"")+a[i].no,null,!0),pref.archive.IDB.prune_flush?A(M,e.name,{no:a[i++].no,key:null,obj:v,kind:"get_all"},!0):A(U,e.name,{no:a[i++].no,key:null,obj:null,kind:"delete_th"},!0);i>0&&a.splice(0,i),O[e.name].write&&(r||0!==i)&&A(M,e.name,{no:"Meta",key:"pruned_time",obj:a,kind:"put"}),n&&n()}function v(e,t,n,r){var a="CatChan_archive_pruned_"+e+"-"+t.slice(1,-1)+"-"+n+".tar",s="pruned_"+e+t+n+Date.now();archiver.event_funcs.export_thread(e,t,n,r,s,a),N(e,t,n,null,null,"delete_th")}function b(e,t,n){for(var r=u(e.transaction(t.nos,"readonly"),n),a=0;a<t.reqs.length;a++){var s=t.reqs[a];pref.debug_mode[23]&&console.log("get_all: "+e.name.replace(/^[^\/]*/,"")+s.no+", "+s.key);var i=r.objectStore(s.no).openCursor("posts"===s.key?IDBKeyRange.bound("posts","postt",!1,!0):void 0);i.onsuccess=w,s.result={},B.set(i,s)}}function y(e){var t=e.target.transaction.db,n=L.get(t);return n&&n.pass++,t}function w(e){var t=(y(e),e.target),n=B.get(t),r=e.target.result;if(r)n.result[r.key]=r.key.indexOf&&0===r.key.indexOf("posts")?JSON.parse(r.value):r.value instanceof ArrayBuffer?common_func.arraybuffer2blob(r.key,r.value):r.value,r.continue();else{B.delete(t);var a=e.target.transaction.db.name.replace(pref.script_prefix+".",""),s=e.target.source.name;if(setTimeout(function(e,t,n){return function(){e.obj(site.nickname,t,n,e.result)}}(n,a,s),0),pref.debug_mode[29]){var i=0;for(var o in n.result)i+=0===o.indexOf("posts")?2*JSON.stringify(n.result[o]).length:n.result[o]&&n.result[o].size
;console.log("IDB: "+a+s+": "+Object.keys(n.result).length+" files, "+i.toLocaleString()+" bytes.")}}}function k(e){var t=e.target.source&&e.target.source.transaction.db||e.target.db||e.target.result,n=L.get(t);n&&(1!==n.tr_count?n.tr_count-=1:C(t,n))}function x(e,t,n){var r=L.get(e);if(r&&"readonly"!==t.mode){var a=r.tr_info.get(t).req;A("delete_th"===a.kind?U:z,e.name,a),console.log(n+": close and re-req, "+a.kind)}}function C(e,t,n){if(t||(t=L.get(e)),n&&t)for(var r of t.tr_info.keys())x(e,r,n);L.delete(e);var a=!n&&void 0!==t.req_kinds.delete_th&&1===Object.keys(t.req_kinds).length||1==e.version;pref.debug_mode[26]&&a&&console.log("Hit the case of test_mode[78]"),!a||pref.test_mode[78]?e.close():setTimeout(function(){e.close()},0),pref.debug_mode[20]&&console.log("IDB: closed: "+L.size+" "+e.name.replace(/^[^\/]*/,"")+" v"+e.version+", "+(t?t.type+", done:"+t.done+", done_put:"+t.done_put+", "+t.coms:"")),t&&(t.db=e),S=t,G()}function T(e){L.get(e).tr_count+=1}function N(e,t,n,r,a,s){if(e===site.nickname){var i=pref.script_prefix+"."+t,o={no:n,key:r,obj:a,kind:s};A("delete_th"===s?U:M,i,o,!0)}else"function"==typeof a&&(H[e+t+n]=a,a="sub_callback"),pref.test_mode[86]&&a instanceof ArrayBuffer?send_message(e,["IDB",["ACC",[e,t,n,r,null,s]]],null,[a]):send_message(e,["IDB",["ACC",[e,t,n,r,a,s]]])}function I(n,r,i){var o=n+(r?"vc":"rw");if(void 0!==R[o]&&(!i||++R[o]<L.size))return void(pref.debug_mode[27]&&i&&console.log("IDB: WATCHDOG: "+o+", "+R[o]));R[o]=0;var l=window.indexedDB.open(n,r&&D[n]+1||void 0);l.onerror=e,l.onsuccess=s,l.onupgradeneeded=a,l.onblocked=t}function E(e,t,n,r,a,s){if(e===site.nickname){var i={no:n,key:r,obj:a,kind:s};A("delete_th"===s?U:M,t,i,!0)}}function A(e,t,n,r){if(W++,!q&&P?(q=P.shift("limegreen","w","IDB",0),q.report({start:Date.now(),prog_str:"Opening"})):G(),e[t]){var a=e===M&&e[t].isEmpty;if(e[t].push(n),a)for(var s of L.keys()){var i=L.get(s);if(i.crawler<pref.archive.IDB.nof_tr&&s.name===t&&"success"===i.type){i.crawler++,setTimeout(i.complete_func,100);break}}}else e[t]=new F(t,e!==U,n),r&&I(t,e===U);K.start(1e3*pref.archive.IDB.watchdog)}function j(){var e=0;for(var t of L.keys())e+=L.get(t).crawler;for(var n=[0,0,0,0,0,0,Object.keys(U).length,Object.keys(M).length,Object.keys(z).length,e,L.size,Object.keys(R).length],r=[U,M,z],a=0;a<3;a++)if(n[a+6])for(var s in r[a])n[a+3]+=r[a][s].length,n[a]+=r[a][s].length_whole;return{sums:n,total:n.reduce(function(e,t){return e+t}),str:n.join("/")+"/"+W}}var B=new Map,S=null,L=new Map,O={},D={},R={},U={},M={},z={},H={},F=function(e,t,n){this.ary=[],this.ary_ro=[],this.allow_multi=t,this.reqs[e]||(this.reqs[e]={}),this.reqs=this.reqs[e],this.cls={},n&&this.push(n),this.cl=null,this.cl_idx=0};F.prototype={shift:function(){for(var e=this.allow_multi?pref.archive.IDB.nof_cl_max:1,t=0;t<this.ary_ro.length&&t<e&&"get_all"===this.ary_ro[t].kind;)t++;if(0!=t)return{kind:"get_all_m",reqs:this.ary_ro.splice(0,t)};if(0!==this.ary_ro.length)return this.ary_ro.shift();if(0===this.ary.length&&!this.cl)return null;if(pref.test_mode[79]){for(;t<e;){var n=this.ary[t];if(!n)break;if(n.cl&&(this.ary=this.ary.slice(0,t+1).concat(n.cl,this.ary.slice(t+1)),n.cl=null),"put"!==n.kind)break;this.cls[n.no]=null,delete this.cls[n.no+n.key],t++}return t>1?{kind:"put_m",reqs:this.ary.splice(0,t)}:this.ary.shift()}var r=[];if(pref.test_mode[81])for(;r.length<e;){var n;if(null===this.cl){if(!(n=this.ary[t])||"put"!==n.kind)break;t++,n.cl&&(this.cls[n.no]=null,this.cl=n.cl,this.cl_idx=0,n.cl=null)}else n=this.cl[this.cl_idx++],this.cl_idx>=this.cl.length&&(this.cl=null);r[r.length]=n,delete this.reqs[n.no+n.key]}else{for(var a;r.length<e;){var n=this.ary[t];if(!n||"put"!==n.kind)break;if(void 0!==a&&(!n.no||a!==n.no))break;n.cl?(void 0===n.idx&&(this.ary[t]={kind:"put",cl:[n].concat(n.cl),idx:0,no:n.no},n.cl=null,n=this.ary[t],this.cls[n.no]=n),n.idx>=n.cl.length-1&&(this.cls[n.no]=null,t++),n=n.cl[n.idx++]):(this.cls[n.no]=null,t++),r[r.length]=n,delete this.reqs[n.no+n.key],r.length===pref.archive.IDB.nof_cl-1&&(a=n.no)}if(this.ary[t]&&this.ary[t].cl&&this.ary[t].idx<this.ary[t].cl.length){var s=this.ary.splice(t,1)[0];this.ary[this.ary.length]=s}}return t>0&&this.ary.splice(0,t),0===t&&this.ary[0]&&"check_clean"===this.ary[0].kind&&(this.cls.check_clean=null),r.length>1?{kind:"put_m",reqs:r}:r.length>0?r[0]:this.ary.shift()},push:function(e){if("get_all"===e.kind||"list_os"===e.kind)return void(this.ary_ro[this.ary_ro.length]=e);if("put"===e.kind)var t=e.no+e.key,n=this.reqs[t];if(n)n.obj="posts"===e.key?n.obj.concat(e.obj):e.obj;else if(t){"posts"!==e.key&&"pruned_time"!==e.key&&"posts_deleted"!==e.key||(this.reqs[t]=e);var r=this.cls[e.no];r?r.cl?r.cl[r.cl.length]=e:r.cl=[e]:(this.ary[this.ary.length]=e,this.cls[e.no]=e)}else if("check_clean"===e.kind){var t=null+e.key,n=this.cls[t];n?n.reqs[n.reqs.length]=e:(e={kind:"clean_m",reqs:[e],no:null},this.cls[t]=e,this.ary[this.ary.length]=e)}else this.ary[this.ary.length]=e},push_all:function(e){for(;!e.isEmpty;)this.push(e.shift())},get length(){return this.ary.length+this.ary_ro.length},get length_whole(){for(var e=0,t=0;t<this.ary.length;t++)e+=this.ary[t].cl?this.ary[t].cl.length-(this.ary[t].idx||0):1;return e+this.ary_ro.length},get isEmpty(){return 0===this.ary.length&&!this.cl&&0===this.ary_ro.length},reqs:{},debug_query:function(){for(var e=Array.prototype.concat.apply(this.ary_ro,this.ary.map(function(e){return e.cl?pref.test_mode[81]?[e].concat(e.cl):e.cl.slice(e.idx||0):e})),t=[],n=1,r=0;t.length<20&&r++<e.length;)e[r]&&e[r-1].kind===e[r].kind?n++:(t[t.length]=e[r-1].kind+(1!=n?"*"+n:""),n=1);return r<e.length&&(t[t.length-1]+="..."),{coms:t,length:this.ary_ro.length+"/"+this.ary.length+"/"+e.length}}};var P=null,q=null,W=0,G=function(){},G=DelayBuffer.prototype.delayed_do.bind(new DelayBuffer(function(){if(q){var e=j();q.report({prog_str:e.str}),0===e.total&&(q.report({end:Date.now()}),q=null,W=0)}},100)),K=new Watchdog(function(){function e(){t.str&&(q.report({err_str:"WDG: "+t.str}),t.str="")}var t=j();pref.debug_mode[27]&&console.log("IDB: "+t.str);var n={};for(var r of L.keys()){var a=L.get(r);pref.debug_mode[27]&&console.log(a),a.wdg!==a.pass?(a.wdg=a.pass,n[r.name]=null):(e(),C(r,a,"IDB: WDG"))}for(var s in U)null===n[s]||U[s].isEmpty||I(s,!0,!0);for(var s in M)null===n[s]||U[s]&&!U[s].isEmpty||M[s].isEmpty||I(s,void 0,!0);for(var s in z)null===n[s]||U[s]&&!U[s].isEmpty||M[s]&&!M[s].isEmpty||z[s].isEmpty||(l(s),I(s,void 0,!0));for(var i in R){var o=i.replace(/(rw|vc)$/,"");null===n[o]||U[o]||M[o]||(e(),I(o,i.search(/vc$/)!=-1,!0))}0!==t.total&&K.start(1e3*pref.archive.IDB.watchdog)},6e4);return{req:N,req_raw:E,clean_up:function(e,t,n){D[pref.script_prefix+"."+t]&&(N(e,t,null,null,n,"clean_up"),liveTag.mems[e][t].IDB_synced=1)},set_indicator:function(e){P||(P=e)},sub_funcs:function(e,t){if("ACC"===e[0])"sub_callback"===e[1][4]?e[1][4]=IDB.sub_ack:t.length>0&&(e[1][4]=t[0]),N.apply(this,e[1]);else if("ACK"===e[0]){var n=e[1].slice(0,3).join("");H[n]&&H[n].apply(this,e[1]),delete H[n]}},sub_ack:function(e,t,n,r){send_message("parent",["IDB",["ACK",[e,t,n,r]]])}}}(),archiver=function(){function e(e,n,r,s){window.URL&&(v||a(),t(new Blob([e],{type:n}),r,s,v))}function t(e,t,r,a){pref.archive.tar?m.add_blob(e,t,r,a):n(e,"CatChan_"+t.key.replace(/\//g,"_")+"_"+r)}function n(e,t){if(e instanceof ArrayBuffer&&(e=common_func.arraybuffer2blob(t,e)),brwsr.ff&&!httpd.isLocal)return void send_message("parent",["ARCHIVER",["DOWNLOAD",[e,t]]]);var n=window.URL.createObjectURL(e);r(n,t),window.URL.revokeObjectURL(n)}function r(e,t){if(!pref.test_mode[70]){var n=document.createElement("div");n.innerHTML="<a href="+e+' download="'+t+'">',brwsr.ff&&site.script_body.appendChild(n),n.childNodes[0].click(),brwsr.ff&&site.script_body.removeChild(n)}}function a(){var e=(new Date).toString().split(" ").slice(1,5);v=[e[2],b[e[0]],e[1],e[3].replace(/:/g,"")].join(""),httpd.req({tgts:[],timestamp:v,__proto__:g},0)}function s(e){httpd.req_add({tgts:e,timestamp:v,__proto__:g},0)}function o(e,t,n,r,s,i,o,l,p){for(var c=0;c<r.length;c++){var _="tn"===e?site2[t.domain].catalog_json2html3_thumbnail(r[c],t.board):site2[t.domain].catalog_json2html3_src(r[c],t.board);if(_){v||a();var d={domain:t.domain,board:t.board,no:t.no,key:t.key,kind:e,to_file:s||o,to_idb:i||l,timestamp:v,__proto__:g};if(site2[t.domain].archive_patch_domain&&site2[t.domain].archive_patch_domain(d),(".webm"===_.substr(-5,5)?o||l:s||i)&&(p[p.length]={url:_,__proto__:d}),r[c].extra_files)for(var u=0;u<r[c].extra_files.length;u++)_="tn"===e?site2[t.domain].catalog_json2html3_thumbnail(r[c].extra_files[u],t.board):site2[t.domain].catalog_json2html3_src(r[c].extra_files[u],t.board),(".webm"===_.substr(-5,5)?o||l:s||i)&&(p[p.length]={url:_,__proto__:d})}}}function l(){function e(e){return function(t,n){var r=e.call(this,t,n);return r&&t.localArchive?archiver.url2file(t.localArchive,r):r}}for(var t in site2)if(site2[t].hasOwnProperty("catalog_json2html3_thumbnail")&&(site2[t].catalog_json2html3_thumbnail=e(site2[t].catalog_json2html3_thumbnail)),site2[t].hasOwnProperty("catalog_json2html3_src")&&(site2[t].catalog_json2html3_src=e(site2[t].catalog_json2html3_src)),site2[t].hasOwnProperty("parse_funcs"))for(var n=["catalog_html","page_html","thread_html","post_html"],r=0;r<n.length;r++)site2[t].parse_funcs.hasOwnProperty(n[r])&&site2[t].parse_funcs[n[r]].hasOwnProperty("op_img_url")&&(site2[t].parse_funcs[n[r]].op_img_url=e(site2[t].parse_funcs[n[r]].op_img_url))}function p(e,t,n,r,a){if(window.URL){var s=r?t:"text/html"===e.type?(new DOMParser).parseFromString(t,"text/html"):JSON.parse(t),i="auto"===pref.archive.format?common_func.name2domainboardthread(e.name.replace(/\.[^\.]*$/,"").split("_")[0].split("-").slice(0,3).join("/"),!0):[site0.domains[pref.archive.domain],"/"+pref.archive.board.replace(/\//g,"")+"/"];if(pref.test_mode[80]&&(i[1]=i[1].slice(0,-1)+(r?"_IDB/":"_File/")),pref.archive.fix_inconsistency&&"meguca"!==i[0]){s.posts[0].no!=i[2]&&(s.posts=[common_func.deep_copy(s.posts[0])].concat(s.posts),s.posts[0].no=parseInt(i[2],10),console.log("Archiver: Fixed: added dummy OP: "+i.join("")));for(var o=0;o<s.posts.length;o++)s.posts[o].filename===!1&&(s.posts[o].filename="LOST_AT_ARCHIVE",console.log("Archiver: Fixed: filename was lost: "+i.join("")+"#"+s.posts[o].no))}w||(l(),w=!0);return cataLog.scan_boards_keyword_callback2(i[0]+","+i[1]+","+k+++",thread_"+("text/html"===e.type?"html":"json"),{date:Date.now(),status:200,response:s},["archive_restore",{localArchive:n,page:r?"IDB":"File",archiveFile:r?"IDB":e,refresh:a||pClg,__proto__:cataLog.scan_boards_keyword_callback2_default_args}])[0]}}function c(e,t,n,r){"ARC"===e||"ARC1"===e?(t.archived|="ARC"===e?6:1,r||scan.list_nup.add_scan(t)):"UNARC"===e&&(t.archived=0,archiver.clean_list(t.domain,t.board,t.no)),n&&pref.catalog.footer.archived&&cataLog.Footer.update_force(t.key)}function _(e,t){return null===x[e]?void 0:t}function d(){pref.debug_mode[28]&&console.log("list_all_obj_downloading: ",I);for(var e in liveTag.mems){var t=site2[e].parse_funcs.post_json.time_unit;for(var n in liveTag.mems[e]){var r=N[e]&&N[e][n],a=r||{};for(var s in liveTag.mems[e][n]){var i=liveTag.mems[e][n][s],o=I[i.key]||i.time_checked/t;i.ed_t&&(o=pref.archive.editing_timeout?u(i)||o:i.ed_t[i.ed_t.length-1].time-1),i.archived?I[i.key]?a[s]=I[i.key]:(!a[s]||a[s]<o)&&(a[s]=o):i.posts_saved&&(a[s]=-o)}r||0===Object.keys(a).length?r&&0===Object.keys(r).length&&delete N[e][n]:(N[e]||(N[e]={}),N[e][n]=a)}N[e]&&0===Object.keys(N[e])&&delete N[e]}}function u(e){for(var t=Date.now()/1e3,n=e.ed_t.length-1;n>=0;n--)if("string"!=typeof e.ed_t[n]){var r=e.ed_t[n].time;if(t-r<3600)return r}return null}function f(e){e&&e.key!==T||(N=JSON.parse(e&&e.newValue||localStorage[T]||"{}"))}function h(){pref3.archive.working&&localStorage&&(d(),0===Object.keys(N).length?delete localStorage[T]:localStorage[T]=JSON.stringify(N),pref.debug_mode[28]&&console.log("list_all_obj: ",N))}var m=function(){function e(e,n,a){var s=new Uint8Array(512);a="tn_"===a.substr(0,3)?"thumbs/"+r(a.substr(3)):"img_"===a.substr(0,4)?"images/"+r(a.substr(4)):r(a),t(s,0,n.domain+"/"+r(n.board.slice(1,-1))+"/"+n.no+"/"+a,100),t(s,100,"100777",8),t(s,108,"0",8),t(s,116,"0",8),t(s,124,(e.byteLength||e.size||0).toString(8),12),t(s,136,Math.floor(Date.now()/1e3).toString(8),12),t(s,148,"        ",8),s[156]=48;var o=0;for(i=0;i<157;i++)o+=s[i];return t(s,148,o.toString(8),8),s}function t(e,t,n,r){for(var a=0;a<n.length&&a<r;)e[t++]=255&n.charCodeAt(a++);a<r&&(e[t++]=0)}function r(e){return encodeURIComponent(e).replace(/[!'()*]/g,function(e){return"%"+e.charCodeAt(0).toString(16)})}var a={},s=0;return{add_blob:function(t,n,r,s,i){a[s]||(a[s]={files:[],size:0});var o=a[s],l=t.byteLength||t.size;o.files[o.files.length]=e(t,n,r),o.size+=1,o.files[o.files.length]=t,l%512!=0&&(o.files[o.files.length]=new Uint8Array(512-l%512)),o.size+=Math.floor((l+511)/512),!i&&(o.size>2*pref.archive.tarsize*1024||pref.test_mode[71])&&this.flush(s)},flush:function(e,t){if(e)a[e]&&(a[e].files[a[e].files.length]=new Uint8Array(1024),n(new Blob(a[e].files,{type:"application/x-tar"}),t||"CatChan_archive_updates_"+site.nickname+"_"+e+"_"+s+++".tar"),delete a[e]);else for(var r in a)this.flush(r)}}}(),g={initiator:"archive",get responseType(){return pref.test_mode[85]?"blob":"arraybuffer"},archive:!0,callback_1:httpd.onload_archive,callback_1_fail:httpd.onload_archive_fail,get max(){return this.tgts.length},get tgt(){return this.key+this.url.substr(this.url.lastIndexOf("/"))}},v=null,b={Jan:"01",Feb:"02",Mar:"03",Apr:"04",May:"05",Jun:"06",Jul:"07",Aug:"08",Sep:"09",Oct:"10",Nov:"11",Dec:"12"},y=DelayBuffer.prototype.delayed_do.bind(new DelayBuffer(function(){httpd.check_timestamp_and_flush(v)},5e3)),w=(new Map,!1),k=0,x={pn:null,time_bumped:null,time_created:null,time_posted:null,flag:null,footer:null,time_tu:null,pn_menu:null,nof_posts:null,nof_files:null,tags:null,page:null,extracted:null,parse_funcs:null,quotes:null,backlinks:null,reply_to_me:null,reply_of_mine:null,op_img_url:null,_links:null},C=function(){var e={html:function(){var e=document.createElement("div"),t={A:null,SPAN:null,DIV:null,BLOCKQUOTE:null,BR:null,WBR:null,U:null,S:null,STRIKE:null,B:null,I:null,BIG:null,SMALL:null,TT:null,SUB:null,SUP:null,EM:null,STRONG:null};return function(n,r,a){e.innerHTML=r;for(var s=e.getElementsByTagName("*"),i=0;i<s.length;i++)if(null!==t[s[i].tagName])return void(a[n]="")}}(),string:function(e,t,n){t.search(/[<>"'&]/)!=-1&&(n[e]="")}};return function(t){if(t)for(var n=0;n<t.length;n++){var r=t[n];for(var a in r)"string"==typeof r[a]&&("com"===a?e.html(a,r[a],r):e.string(a,r[a],r))}return t}}(),T=pref.script_prefix+".archived",N={};localStorage&&f(),pref.debug_mode[28]&&console.log("list_all_obj: ",N);var I={};return window.addEventListener("storage",f,!1),window.addEventListener("beforeunload",h,!1),{clean_list:function(e,t,n){N[e]&&N[e][t]&&delete N[e][t][n]},check_op:function(e,t){var n=pref.archive.kwd;(pref.archive.store_auto&&n.str&&(n.sub||n.name||n.com)&&cataLog.threads&&cataLog.catalog_filter_query_keyword.kwd(pref.archive.kwd,e.posts,e.domain)||this.check_archived_time(e,e.parse_funcs.time_unit,!0)!==!1)&&c("ARC",t,!1,!0)},check_archived_time:function(e,t,n){var r=n&&pref.archive.list&&pref_func.merge_obj5(e.key,pref3.archive.list_obj2,null);return r&&r.time?r.time/t||0:(pref.archive.list_inherit||!n||r)&&N[e.domain]&&N[e.domain][e.board]&&N[e.domain][e.board][e.no]||!1},update_archived_time:function(e){if(pref3.archive.working=!0,pref3.archive.list_obj2[e]&&pref3.archive.list_obj2[e].time){var t=new RegExp("(^|,)"+e.replace(/\+/,"\\+")+"([\\^@!][^,\n]*)*(,|\n|$)","mg");pref.archive.list_str=pref_func.fmt4str2(pref.archive.list_str.value.replace(t,",")+","+e+"\n"),pref3.archive.list_obj2[e].time=null}},store_entry:function(e,t){if(cataLog.threads)for(var n in cataLog.threads){var r=liveTag.mems.getFromName(n);("stored"===pref.archive.src||"watched"===pref.archive.src&&r.watched||"shown"===pref.archive.src&&pClg.filter_test(n,pClg.threads[n]))&&c(e,r,!0)}},start_1:c,restore_posts_from_IDB:function(t,n,r,a,s,i){var o=this.event_funcs.consolidate_IDB_result(i);if(o.posts.length>1){var l=n.lth;o.time_loaded=o.posts[o.posts.length-1].time;var p=this.check_deleted_posts(t,n,l,o,!0);if(l.archived&&p&&2&l.archived&&pref.archive.live.post){var c=n.key.replace(/\//g,"-");e(JSON.stringify(site2[n.domain].parse_funcs.thread_json.prep_to_archive(p)),"text/plain",l,c+"_deleted.json")}}},store_th_to_mem:function(e,t,n,r,a){if("no"!==r){if(a&&n.ta.posts)for(var s=n.ta.posts,i=s.length-1,o=a.length-1;o>=0;o--){for(;i>=0&&s[i].no!=a[o].no;)i--;i>=0?s[i]=a[o]:i=s.length-1}var l=pref[cataLog.embed_mode].deleted_posts.detect,p=t.posts&&t.posts.length>1&&t.nof_posts>t.posts.length&&n.ta&&"passive"!==l?(t.posts[0].type_data!==n.ta.posts[0].type_data&&site2[t.domain].wrap_to_parse.posts(t),site2[t.domain].update_posts_replace_prep(t.posts,n.ta.posts,"number"==typeof r?r:-1)):t.parse_funcs.has_posts?t.posts:n.ta&&n.ta.posts||t.posts;if(!pref.test_mode[65]&&(n.archived&&pref.archive.live.post_idb||"full_IDB"===l)){n.ta||"full_IDB"!==l||IDB.req(t.domain,t.board,t.no,"posts",this.restore_posts_from_IDB.bind(this,e,{posts:t.posts,__proto__:t}),"get_all");var c;n.ta?c=n.ta.posts[n.ta.posts.length-1].time:(c=N[t.domain]&&N[t.domain][t.board]&&N[t.domain][t.board][t.no])<0&&(c=-c);var _;if(c&&(!n.ta||n.ta.posts.length===n.ta.nof_posts||t.posts.length<t.nof_posts)){for(var o=t.posts.length;o>0&&t.posts[o-1].time>c;)o--;_=t.posts.slice(o)}else _=t.posts;a&&(_=a.concat(_)),_.length>0&&("html"===t.type_data&&cataLog.format_html.prepare_html_prep_posts({posts:_,__proto__:t},!0),IDB.req(t.domain,t.board,t.no,"posts",_,"put"),n.posts_saved=1),pref.debug_mode[28]&&_.length>0&&console.log("posts_saved: "+t.key+", "+c+", "+_[_.length-1].time+" "+new Date(_[_.length-1].time*t.parse_funcs.time_unit).toLocaleString()+", LS:"+(N[t.domain]&&N[t.domain][t.board]&&N[t.domain][t.board][t.no]))}n.ta={posts:p,nof_posts:t.nof_posts,time_loaded:e.date}}else n.ta&&delete n.ta},check_deleted_posts:function(e,t,n,r,a){if("no"!==pref[cataLog.embed_mode].deleted_posts.detect&&r&&r.posts.length>1){var s=t.posts,i=r.posts,o=t.nof_posts===t.posts.length||"thread"===t.type_source,l=1,p=1;o?n.rescan_dp=0:(l=r.nof_posts-i.length+1-(t.nof_posts-s.length),p=1,l<1&&(p+=1-l,l=1));for(var c,d=0,u=0,f=n.pd||[],h=a?[]:null;l<s.length&&(p<i.length||d<f.length);){for(;d<f.length&&s[l].no>f[d].no;)d++;if(d<f.length&&s[l].no==f[d].no)c=f.splice(d,1)[0],c.deleted_after&&(delete c.deleted_after,delete c.deleted_before,c.pn&&c.pn.classList.remove("CatChan_deleted"));else{if(p>=i.length){if(pref.test_mode[156])continue;break}if(s[l].no!==i[p].no)if(s[l].no<i[p].no)o&&a&&(h[h.length]=s[l]),l++;else{for(;u<f.length&&i[p].no>f[u].no;)u++;u<f.length&&i[p].no===f[u].no?p++:o?(c=i[p++],c.deleted_after||(!pref.debug_mode[33]||void 0!==c.no&&null!==c.no||alert("Stopped by illegal deleted posts,(BUG)"),c.deleted_after=r.time_loaded,c.deleted_before=e&&e.date||null,cataLog.format_html.prepare_html_prep_posts({posts:[c],__proto__:t},!0)),f.splice(u++,0,c)):(0===pref[cataLog.embed_mode].deleted_posts.detect.indexOf("full")&&(n.rescan_dp=1,scan.list_nup.add_scan(n)),p++)}else l++,p++,o=!0}}if(n.pd=f.length>0?f:null,c){if("no"!==pref[cataLog.embed_mode].deleted_posts.store&&t.domain===site.nickname){var m="LS"===pref[cataLog.embed_mode].deleted_posts.store?localStorage:sessionStorage;if(m){var g=site2[t.domain].ls_key_deletedPosts+t.board+t.no;f.length>0?m[g]=JSON.stringify(f,_):delete m[g]}}pref.test_mode[65]||"full_IDB"!==pref[cataLog.embed_mode].deleted_posts.detect||this.store_deleted_posts_to_IDB(t,f)}if(h&&h.length>0&&(t.domain!==site.nickname&&(h=JSON.parse(JSON.stringify(h,_))),IDB.req(t.domain,t.board,t.no,"posts",h,"put")),pref.debug_mode[19]&&c&&n.pd)for(var l=0;l<n.pd.length-1;l++)n.pd[l].no>=n.pd[l+1].no&&console.log("BUG: inorder of posts_deleted: "+t.key+", "+l+", "+n.pd[l].no+", "+n.pd[l+1].no)}return c?f:null},store_deleted_posts_to_IDB:function(e,t){IDB.req(e.domain,e.board,e.no,"posts_deleted",JSON.stringify(t,_),t.length>0?"put":"delete")},store_json_func:_,store:function(t,n,r,a,i,l,p,c){var d=this.check_deleted_posts(t,n,r,r.ta);if(this.store_th_to_mem(t,n,r,l,p),r.archived&&!c){var u=n.parse_funcs.time_unit,f=this.check_archived_time(n,u,4&r.archived)||0;if(i/=u,f<i&&(f=i),!(1&r.archived)&&4&r.archived&&(n.posts[n.posts.length-1].time<=f||n.time_posted<=f*u)&&!p)return void(r.archived&=2);n.parse_funcs.posts_full&&n.parse_funcs.posts_full(n);var h=2&r.archived,m=1&r.archived,g=h&&pref.archive.live.post||m&&pref.archive.oneshot.post,v=h&&pref.archive.live.post_idb||m&&pref.archive.oneshot.post_idb,b=n.key.replace(/\//g,"-");d&&(g&&e(JSON.stringify(site2[n.domain].parse_funcs.thread_json.prep_to_archive(d)),"text/plain",r,b+"_deleted.json"),v&&"full_IDB"!==pref[cataLog.embed_mode].deleted_posts.detect&&this.store_deleted_posts_to_IDB(n,d));var w="html"===n.type_data?"text/html":"text/plain",k="thread"===n.type_source||n.posts.length===n.nof_posts?n.posts:r.ta&&r.ta.posts.length===n.nof_posts?r.ta.posts:null;if(g){var x=(n.posts[0].sub||"").replace(/\..*/,""),C=b+(pref.archive.sub_in_filename&&x?"_"+x:"")+("html"===n.type_data?".html":".json");if(!k)return void this.store_rescan(r);e("thread"===n.type_source?t.responseText:JSON.stringify(site2[n.domain].parse_funcs.thread_json.prep_to_archive(k),_),w,r,C)}if(a||5&r.archived||p){var T=h&&pref.archive.live.tn||m&&pref.archive.oneshot.tn,N=h&&pref.archive.live.tn_idb||m&&pref.archive.oneshot.tn_idb,E=h&&pref.archive.live.img||m&&pref.archive.oneshot.img,A=h&&pref.archive.live.img_idb||m&&pref.archive.oneshot.img_idb,j=h&&pref.archive.live.webm||m&&pref.archive.oneshot.webm,B=h&&pref.archive.live.webm_idb||m&&pref.archive.oneshot.webm_idb;if(T||N||E||A||j||B||v){if(5&r.archived){if(!k&&(m||(!n.posts[1]||n.posts[1].time>f)&&(!r.ta.posts[1]||r.ta.posts[1].time>f)))return void this.store_rescan(r);if(m)a=k;else{for(var S=n.posts[1]&&n.posts[1].time<=f?n.posts:r.ta.posts,L=S.length;L>0&&S[L-1].time>f;)L--;a=S.slice(L)}}if(p&&(a=p.concat(a||[])),0!=a.length){pref.debug_mode[28]&&console.log("archive: "+n.key+", "+a.length+"/"+n.nof_posts);var O=[];(T||N)&&o("tn",n,r,a,T,N,j,B,O),(E||A||j||B)&&o("img",n,r,a,E,A,j,B,O),0!=O.length&&(O[O.length-1].from=n.key,I[n.key]=f,s(O)),!pref.test_mode[65]&&v&&5&r.archived&&IDB.req(n.domain,n.board,n.no,"posts",a,"put")}}}!g||!d&&!k||O&&0!==O.length&&n.domain===site.nickname||!pref.archive.tar||y(),r.archived&=2,this.update_archived_time(n.key)}},store_rescan:function(e){scan.list_nup.add_scan(e),e.archived|=4},restore_entry:function(e,t,n,r){for(var a={},s=0;s<t.length;s++)void 0===a[t[s].name]?a[t[s].name]={file:t[s]}:Array.isArray(a[t[s].name])?a[t[s].name].push({file:t[s]}):a[t[s].name]=[a[t[s].name],{file:t[s]}];var i={};if(!pref.test_mode[64]&&pref[cataLog.embed_mode].deleted_posts.merge)for(var s=0;s<r.length;s++)i[r[s].name]=r[s];var o=0;pref.archive.clear_threads&&cataLog.threads&&pClg.clear_threads(0);var l,c=new FileReader;c.onerror=function(e){console.log("ERROR at loading json file, "+e)},c.onload=function(t){if(l){var r=l.slice(0,-13).replace(/\-/g,"/");pref.test_mode[80]&&(r=r.replace(/\/\d+$/,"_File$&"));var s=liveTag.mems.getFromName(r);archiver.prep_deleted_posts(s.th,s,c.result)}else if(p(e[o-1],c.result,a),!pref.test_mode[64]&&pref[cataLog.embed_mode].deleted_posts.merge&&(l=e[o-1].name.replace(/(_|\.).*/,"")+"_deleted.json",i[l]))return void c.readAsText(i[l]);l=null,e.length>o?c.readAsText(e[o++]):pref.archive.clear_files&&n()},c.readAsText(e[o++])},url2file:function(e,t){var n=e[t.replace(/[^\/]*\//g,"")];return n?(Array.isArray(n)&&(n=t.search(/thumb/)!=-1?n[0]:n[n.length-1]),n.url||(n.url=window.URL.createObjectURL(n.file)),n.url+("video/webm"===n.file.type?'" data-ext=".webm':"")):t},prep_deleted_posts:function(e,t,n,r,a){var s=n?r||JSON.parse(n):"LS"===pref[cataLog.embed_mode].deleted_posts.store&&localStorage?C(JSON.parse(localStorage[site2[e.domain].ls_key_deletedPosts+e.board+e.no]||null)):"SS"===pref[cataLog.embed_mode].deleted_posts.store&&sessionStorage?JSON.parse(sessionStorage[site2[e.domain].ls_key_deletedPosts+e.board+e.no]||null):null;if(!pref.test_mode[123]&&s){for(var i={},o=0;o<e.posts.length;o++)i[e.posts[o].no]=null;for(var o=s.length-1;o>=0;o--)s[o].no&&null!==i[s[o].no]||s.splice(o,1);0===s.length&&(s=null)}if(s){s=site2[e.domain].parse_funcs.thread_json.rip_from_archive(s);var l={posts:[].concat(s),parse_funcs:site2[e.domain].parse_funcs.thread_json,type_parse:"thread_json",type_source:"thread",type_data:"json",__proto__:e};if(site2[e.domain].wrap_to_parse.posts(l),n&&t.th){t.pd=t.pd?site2[e.domain].update_posts_merge_prep(l.posts,t.pd,-1,!0).slice(1):s;var p=a||cataLog;"page"!==cataLog.embed_mode&&"thread"!==cataLog.embed_mode||pref.test_mode[64]||!pref[cataLog.embed_mode].deleted_posts.merge||(e.posts=site2[e.domain].update_posts_merge_prep(e.posts,t.pd,-1,!0),p.threads[e.key][16].th=e),p.footer.update_force(e.key)}else t.pd=s}},refresh_start:function(){h(),v=null},list_all_obj_downloading:I,download_url3:t,download_url4:n,tar:m,sub_funcs:function(e,t){if("SUB_INIT"===e[0])if(pClg.clear_threads(0),cataLog.auto_update.stop_if_running(),pref.stats.auto_acquisition=!1,pref[cataLog.embed_mode].t2h_sel="All",pref.common.blur_404=!1,e[1].IDB)IDB.req(e[1].domain,e[1].board,e[1].no,null,t?function(e,n,r,a){archiver.event_funcs.restore3(e,n,r,a),t()}:archiver.event_funcs.restore3.bind(archiver.event_funcs),"get_all");else for(var r=e[1],a=parseInt(r.files_sel,10),s=window.opener.document.getElementsByClassName(pref.script_prefix)[0].querySelectorAll('span[name="FILES_ARCHIVE'+a+'"]')[0].querySelectorAll('input[type="file"]'),i=0;i<s.length;i++)for(var o=0;o<s[i].files.length;o++){var l=s[i].files[o];if(l.name===r.name&&l.size===r.size&&l.lastModified===r.lastModified)return void archiver.event_funcs.restore2(null,Array.prototype.slice.call(s[i+a].files),[l])}else"DOWNLOAD"===e[0]&&n(e[1][0],e[1][1])},restore:p,event_funcs:pref_func.settings.onchange_funcs.archive}}(),recovery=pref.features.recovery&&localStorage?function(){function e(){if(i=site2[site.nickname].ls_key_comment+site.board+site.no,pref.recovery.comment){var e=localStorage[i]||"";e&&(site.components.postform_comment&&(site.components.postform_comment.value=e),site.components.postform_comment2&&(site.components.postform_comment2.value=e))}}function t(){o=this,p()}function n(){var e=o.value;(!l||l.length<=e.length)&&(l=e),o=null,c()}function r(){l?localStorage[i]=l:delete localStorage[i],l=null}function a(){o&&(l=o.value),null!==l&&r()}function s(e,n,r){if(!e&&pref.recovery.comment&&n){var a=t.bind(n);n.addEventListener("change",a,!1),n.addEventListener("keyup",a,!1),r.addEventListener("click",a,!1),e=[n,r,a]}else!e||pref.recovery.comment&&n||(e[0].removeEventListener("change",e[2],!1),e[0].removeEventListener("keyup",e[2],!1),e[1].removeEventListener("click",e[2],!1),e=null);return e}var i;e();var o=null,l=null,p=new DelayBuffer(n,1e3).get_bound_func(),c=new DelayBuffer(r,1e3*pref.recovery.interval).get_bound_func(),_=s(null,site.components.postform_comment,site.components.postform_submit),d=null;return window.addEventListener("beforeunload",a,!1),{setup:function(){_=s(_,site.components.postform_comment,site.components.postform_submit),d=s(d,site.components.postform_comment2,site.components.postform_submit2)},setup2:function(){d=s(d,site.components.postform_comment2,site.components.postform_submit2)},reentry:function(){a(),e()}}}():null,scan=function(){function e(e,t,n){return("b"===e?"scan":"scan_threads")+"_"+t+":"+(n||0)}function t(t,n){for(var a=e(t,n,0).replace(/0$/,""),s=8;s>=0;s--){var i=r.prototype.scanners[a+s];if(i||i===!1)return s}return-1}var n={add:function(e,t,n){"string"==typeof e&&(e=this.get_th(e)),t=(t||0)<<4,0===e.u?e.u=t|(n?7:3):e.u>0&&e.u<t&&(e.u=t|15&e.u)},add_scan:function(e){this.add(e),scan.scan_threads_delayed_do()},issued:function(e){return"string"==typeof e&&(e=this.get_th(e)),e&&(e.u=(1==(3&e.u)?4294967040:0)|(0===e.u?2:e.u-1)),e&&e.no&&e.archived},got_200:function(e,t){0===t.u||4&t.u&&"thread"!==e.type_source||(t.u=0)},got_404:function(e){"string"==typeof e&&(e=this.get_th(e)),e&&(e.u=-1)},get_th:function(e){var t=common_func.fullname2dbt(e);return t[2].search(/(p|q)[0-9]+$/)!=-1?null:("t"===t[2][0]?t[2]=t[2].substr(1):t[2].search(/^[0-9]/)==-1&&(t[2]=""),liveTag.mems.init({domain:t[0],board:t[1],no:t[2]}))},priority_th:[0,16,32,48,64,80,96,112,128,144,160,176,192,208,224,240,256],get_list_thread:function(e,t){var n=this.priority_th[t||0],r=0;for(var a in liveTag.mems[e])for(var s in liveTag.mems[e][a])liveTag.mems[e][a][s].u>n&&r++;return 0===r?null:[r,function*(t){for(var n in liveTag.mems[e])for(var r in liveTag.mems[e][n])liveTag.mems[e][n][r].u>t&&(yield liveTag.mems[e][n][r])}(n)]},get_list_thread2:function(e,t){var n=this.priority_th[t||0],r=[];for(var a in liveTag.mems[e])for(var s in liveTag.mems[e][a])liveTag.mems[e][a][s].u>n&&(r[r.length]=liveTag.mems[e][a][s]);return r},get_list_board:function(e,t){var n=this.priority_th[t||0],r=0;for(var a in liveTag.mems[e])liveTag.mems[e][a].u>n&&r++;return 0===r?null:[r,function*(t){for(var n in liveTag.mems[e])liveTag.mems[e][n].u>t&&(yield liveTag.mems[e][n])}(n)]},get_list_board2:function(e,t){var n=this.priority_th[t||0],r=[];for(var a in liveTag.mems[e])liveTag.mems[e][a].u>n&&(r[r.length]=liveTag.mems[e][a]);return r},add_domain:function(e,t,n){var r=pref4.scan.max;if(liveTag.active.pk){if(n)for(var a in liveTag.mems[e]){liveTag.tags[liveTag.mems[e][a].btag].pk&&this.add_board(e+a,null,t);var s=liveTag.mems[e][a].btag2;if(s)for(var i=0;i<s.length;i++)liveTag.tags[s[i]].pk&&this.add_board(e+a,null,t)}else for(var i=0;i<r;i++)if(liveTag.tags_array_old[i])for(var o of liveTag.tags[liveTag.tags_array_old[i].key].mems.keys())o.no?this.add(o,null,t):this.add_board(o,null,t)}else if(n)for(var i=0;i<n.length;i++)this.add_board(e+n[i],null,t);else for(var a in liveTag.mems[e])null!==liveTag.mems[e][a].o&&liveTag.mems[e][a].o<r&&this.add_board(e+a,null,t)},add_board:function(e,t,n,r,a){if("string"==typeof e&&(e=this.get_th(e)),2!==n){if(!r||e.read_max<e.max){var s=(t||0)<<4|(a?8:0)|(n?4:0);0===e.u?e.u=3|s:e.u>0&&e.u<t&&(e.u=s|15&e.u)}}else for(var i in e)e[i].ta&&e[i].nof_posts===e[i].ta.posts.length||this.add(e[i],t,!0)},got_200_board:function(e,t){var n=liveTag.mems[e][t];if(4&n.u)for(var r in n)this.add(n[r],240&n.u,!0);n.max&&(n.read_max=n.max),n.u=0},scan_boards_enumerate:function(e,t,n){var r="thread"===pref.virtualBoard.scan_domains[e]||n.has(liveTag.mems[e]),a=pref4.scan.max;for(var s in liveTag.mems[e])if((r||0!=Object.keys(liveTag.mems[e][s]).length)&&!n.has(liveTag.mems[e][s])&&null!==liveTag.mems[e][s].o&&liveTag.mems[e][s].o<a&&(!t||t(liveTag.mems[e][s])))return!0}},r=function(e,t,n,r){this.type=e,this.domain=t,this.key=r,this.priority=n||0,this.scanners[r]=this};r.prototype={scanners:Object.create(null),func_entry:function(){var e;pref.test_mode[51]?(e="b"===this.type?scan.list_nup.get_list_board(this.domain,this.priority):scan.list_nup.get_list_thread(this.domain,this.priority),e?this.func_scan(e,{tgts_iterator:e[1],max:e[0]}):this.exit()):(e="b"===this.type?scan.list_nup.get_list_board2(this.domain,this.priority):scan.list_nup.get_list_thread2(this.domain,this.priority),e=e.filter(function(e){return!s.has(e)}),0!=e.length?this.func_scan(e,null):this.exit())},func_scan:function(e,t,n){if(0!=e.length){for(var r=0;r<e.length;r++)s.add(e[r]);this.wdg||(this.wdg=new Watchdog(this.abort.bind(this),3e4)),cataLog.scan_init(this.key,e,{callback:this.func_cont.bind(this),watchdog:this.wdg.restart.bind(this.wdg),priority:this.priority,__proto__:t},n)}},func_cont:function(){this.req?(this.req=!1,this.func_entry()):this.exit()},exit:function(){this.wdg&&this.wdg.stop(),this.scanners[this.key]=null,
"b"===this.type?this.aborted||scan.scan("t",this.domain,this.priority):"t"===this.type&&cataLog.catalog_refresh_end&&cataLog.catalog_refresh_end(),this.callback&&this.callback();var n=t(this.type,this.domain),a=e(this.type,this.domain,n);this.scanners[a]===!1&&new r(this.type,this.domain,n,a).func_entry()},abort:function(){pref.debug_mode[7]&&console.log("Scanner_abort: "+this.key),cataLog.scan_boards.scan_abort(this.key),void 0===this.aborted?(this.aborted=!0,this.wdg.restart()):this.exit()}};var a=function(e,t){this.key=e,this.arg=t,this.scanners[e]=this,this.callback=this.arg.options&&this.arg.options.callback};a.prototype={scanners:Object.create(null),priority:8,func_entry:function(){this.func_scan(this.arg.tgts,this.arg.options,!0)},func_cont:function(){this.queue&&this.queue.length>0?(this.arg=this.queue.shift(),this.func_entry()):this.exit()},__proto__:r.prototype};var s=new Set;return{scan_refresh:function(e,t,r,a){s.clear();for(var i=0;i<t.length;i++){var o=common_func.name2domainboardthread(t[i],!0);0===o[2].search(/^[cj]/)||""===o[2]?s.add(liveTag.mems[o[0]][o[1]]):0===o[2].search(/^t*[0-9]+/)&&s.add(liveTag.mems[o[0]][o[1]]["t"===o[2][0]?o[2].substr(1):o[2]])}for(var i in a)s.add(liveTag.mems[i]);if(scan.scan("t",null,r),!pref.liveTag.use)for(var l in liveTag.tags)if(liveTag.tags[l].pk)for(var p of liveTag.tags[l].mems.keys())s.has(p)||(p.no?scan.list_nup.add(p,2):scan.list_nup.add_board(p,2));for(var c in liveTag.mems)pref.liveTag.use?site2[c].utilize_boards_json&&pref.pref2[c].utilize_boards_json?n.scan_boards_enumerate(c,null,s)?site2[c].get_boards_json("boards_"+c,function(e){return function(){scan.scan_refresh_1(e,!1)}}(c),!0,e):scan.scan("t",c):scan.scan_refresh_1(c,!1):scan.scan("b",c)},scan_refresh_1:function(e,t){n.scan_boards_enumerate(e,function(e){scan.list_nup.add_board(e,null,null,t)},s),scan.scan("b",e)},scan:function(n,a,s){if(a){var i=e(n,a,s),o=r.prototype.scanners[i];o?o.req=!0:t(n,a)>=s?r.prototype.scanners[i]=!1:"b"===n&&(o=r.prototype.scanners[e("t",a,s)])?o.callback=function(){scan.scan(n,a,s)}:new r(n,a,s,i).func_entry()}else for(var l in liveTag.mems)this.scan(n,l,s)},abort:function(){for(var e in r.prototype.scanners){var t=r.prototype.scanners[e];t&&(t.wdg&&t.wdg.stop(),t.abort())}},scan_ui:function(e,t){new a(e,t).func_entry()},scan_threads_delayed_do:DelayBuffer.prototype.delayed_do.bind(new DelayBuffer(function(){scan.scan("t")},200)),keyword_load:function(e,t){var n=!0;for(var r in pref.virtualBoard.scan_domains)"none"!==pref.virtualBoard.scan_domains[r]&&(this.keyword_load_1(r,e,null,t),n=!1);n&&this.keyword_load_1(site.nickname,e,null,t)},keyword_load_1:function(e,t,n,r){if(!site3[e].boards&&(!t&&"none"!==pref.virtualBoard.scan_domains[e]||t&&liveTag.active.pk||!n))return void site2[e].get_boards_json("kwd_load",function(){scan.keyword_load_1(e,t,n,r)},!1,r);("thread"===pref.virtualBoard.scan_domains[e]||t)&&(scan.list_nup.add_domain(e,pref.filter.kwd.post&&t,n),scan.scan("b",e))},list_nup:n}}(),stats=pref3.stats.use&&!site0.isStep?function(){function e(e){var t=liveTag.mems[e[0]][e[1]][e[2]];if(t.ss)if(Array.isArray(t.ss))for(var r=0;r<t.ss.length;r++)t.ss[r].rm&&t.ss[r].rm.update_thread(t.s,0,!0);else t.ss.rm&&t.ss.rm.update_thread(t.s,0,!0);pref.stats.retain_404&&t.s&&(u[e[0]]||(u[e[0]]={}),u[e[0]][e[1]]||(u[e[0]][e[1]]={}),u[e[0]][e[1]][e[2]]=liveTag.mems[e[0]][e[1]][e[2]],(pref.test_mode[44]||u[e[0]][e[1]].sr||Object.keys(u[e[0]][e[1]]).length>64)&&n(u[e[0]][e[1]]))}function t(e){for(var t=0;t<g.length;t++){pref_func.merge_obj5(e.key,g[t].tgts_obj2,null)&&g[t].check_and_add_thread(e)}}function n(e){e.sr||(r(e,"sr"),r(e,"srt"));for(var t in e){if(e[t].s)for(var n=0;n<h.length;n++)p(e.sr[n],null,0,e[t].s.length,e[t].s,h[n],s,0),p(e.srt[n],null,0,1,e[t].s,h[n],s,0);delete e[t]}}function r(e,t){Object.defineProperty(e,t,{value:[],configurable:!0,writable:!1});for(var n=0;n<h.length;n++)e[t][n]=[null,n<3?[]:{length:pref.stats.len_capture+2,__proto__:Array.prototype},[],0],a(e[t][n],h[n]);"s"===t&&(e[t][h.length]=-Object.keys(e).length)}function a(e,t,n){var r=Math.floor((Date.now()/6e4+e[3])/t)*t,a=r-t*pref.stats.len_capture;if(!e[0])return void(e[0]=a);if(a!==e[0]||n){var s=(a-e[0])/t,i=0;return n>s&&pref.stats.tolerant&&(e[3]+(n-s)*t<pref.stats.tolerance?(e[3]=n*t,i=n-s):(e[3]=pref.stats.tolerance,i=Math.floor((pref.stats.tolerance-e[3])/t))),e[1].splice(0,s+i),Array.isArray(e[1])||(e[1].length=pref.stats.len_capture+2),e[0]=a+i*t,s+i}}function s(e,t){e[t]=(e[t]||0)+1}function i(e,t,n,r){var a=n.posts[r].no||n.no;(void 0===e[t]||e[t]<a)&&(e[t]=a)}function o(e,t,n,r){var a=n.posts[r].no||n.no;(void 0===e[t]||e[t]>a)&&(e[t]=a)}function l(e,t,n,a){e.s||r(e,"s");for(var s=0;s<h.length;s++)p(e.s[s],t,n,a.length,a,h[s],pref.stats.patch_tm?o:i,t.posts.length);e.s[h.length]++}function p(e,t,n,r,s,i,o,l){for(var p,c=e[0],_=e[1],d=r-1;d>=n;d--){var u=Math.floor((s[d]-c)/i);if(!(--l>=0&&u===p)||pref.stats.patch_tm){var f=u-pref.stats.len_capture-1;if(f>0?(u-=a(e,i,f),u>pref.stats.len_capture+1&&(u=pref.stats.len_capture+1),c=e[0]):u<0&&(u=0),o(_,u,t,l),0===u&&!pref.stats.patch_tm)break;p=u}}for(var h=0;h<e[2].length;h++)e[2][h].update_posts_no(c,u)}function c(e){return pref.catalog_board_list_obj[e][0].key}function _(){if(pref.stats.auto_acquisition&&"thread"!==cataLog.embed_mode)for(var e=pref.catalog_board_list_obj.length-1;e>=0;e--)if(void 0!==x["@"+c(e)]){var t=pClg.refresh_1("chart",!1,!1,!1,!1,e,!1,!0);"function"!=typeof t&&new v(null,t,c(e),!1).destroy()}}function d(e){if(pref.stats.auto_acquisition&&pClg&&pClg.refresh_1&&"thread"!==cataLog.embed_mode){for(void 0===e&&(e=pref.catalog_board_list_obj.length-1);e>=0&&(!pref.catalog_board_list_obj[e][0].cmds||pref.catalog_board_list_obj[e][0].cmds.indexOf("stats")===-1);)e--;if(e>=0){pref.stats.auto_acquisition&&stats.register_auto_acquisition(e);var t=pClg.refresh_1("chart",!1,!1,!1,"stats_ac",e,!1,!0,function(){d(e-1)});"function"==typeof t&&t(function(){d(e)})}}}var u={},f={hour:function(e){return new Date(6e4*e).toString().split(" ")[4].replace(/:\d*$/,"")},day:function(e){return new Date(6e4*e).toString().replace(/\s\d{4}.*/,"")},sunday:function(e){var t=new Date(6e4*e).toString();return"Sun"==t.split(" ")[0]?t.replace(/\s\d{4}.*/,""):""},month:function(e){var t=new Date(6e4*e).toString();return"01"==t.split(" ")[2]?t.replace(/\s\d{4}.*/,""):""},quarter_year:function(e){var t=new Date(6e4*e).toString().split(" ");return t[2]<=7&&["Jan","Apr","Jul","Oct"].indexOf(t[1])!=-1?t.slice(1,4).join(" "):""}};f[1]=[60,f.hour,1],f[10]=[60,f.hour,1],f[60]=[1440,f.day,1],f[1440]=[1440,f.sunday,0],f[10080]=[1440,f.quarter_year,0];var h=[1,10,60,1440,10080],m=Math.floor(Date.now()/6e4),g=[],v=function(e,t,n){g.push(this),this.chart=e,this.tolerance=0,this.draw=DelayBuffer.prototype.delayed_do.bind(new DelayBuffer(this.refresh.bind(this),1e3*pref.stats.draw_delay)),this.wdg_tick=new Watchdog(this.prep_time.bind(this),6e4),this.fromNo=pref3.stats.estimate_posts?new w(this):null,this.tgts_changed(t,n,!0),this.time_unit_changed(pref.chart.inst.time_sel,!0),this.len_changed(this.chart&&this.chart.len>pref.stats.len_capture?this.chart.len:pref.stats.len_capture)};v.prototype={destroy:function(){this.chart=null,this.save_all_unsubscribe(!0),this.wdg_tick.stop(),g.splice(g.indexOf(this),1)},merge_1:function(e,t){if(t)for(var n=0;n<t.length;n++)e[n]<t[n]&&(e[n]=t[n]);return e},merge_1_hier:function(e,t,n){for(var r=this.time_unit/n.time_unit,a=Math.ceil((n.time_base-this.time_base)/this.time_unit),s=(r-n.time_base%this.time_unit/n.time_unit)%r;s<t.length;)this.merge_1_hier_1(e,t,a,s,r,n),s+=r,a++},merge_1_hier_1:function(e,t,n,r,a,s){for(var i=0,o=t.length>=r+a?a:t.length-r,l=0;l<o;l++)i+=t[r+l];pref.debug_mode[15]&&i>e[n]&&console.log("merge_1_hier_1: "+this.time_unit+": "+n+", "+e[n]+"->"+i+", "+new Date(6e4*(this.time_base+n*this.time_unit)).toLocaleString()+", "+new Date(6e4*(s.time_base+r*s.time_unit)).toLocaleString()+", "+a),i>e[n]&&(e[n]=i)},save_all_unsubscribe:function(e){if(this.tgts&&pref.stats.save&&void 0!==x["@"+this.key]){var t=Math.floor(Date.now()/6e4);if(x["@"+this.key]!==t){var n=this.chart;this.chart=null;for(var r=h.indexOf(this.time_unit),a=null,s=0;s<h.length;s++)this.time_unit_changed(s),this.save(a),a={data_p:this.data_p,data_t:this.data_t,time_unit:this.time_unit,time_base:this.time_base};e||this.time_unit_changed(r),this.chart=n,x["@"+this.key]=t}}this.tgts&&(this.prep("both",this.prep_thread_unsubscribe),this.fromNo&&this.fromNo.prep("live",this.fromNo.prep_board_unsubscribe))},Zcompress:function(e){return e.replace(/0,(0,)+/g,function(e){return"z"+e.length/2+","})},Zdecompress:function(e){return e.replace(/z(\d+),/g,function(e,t){for(var n="",r=parseInt(t,10),a=0;a<r;a++)n+="0,";return n})},get_ls_key:function(){return pref.test_mode[38]?pref.script_prefix+".graph."+this.time_unit+"."+this.key+"_test38":pref.script_prefix+".graph."+this.time_unit+"."+this.key},save:function(e){if(this.data_p&&pref.stats.load&&pref.stats.save&&localStorage){this.merge_1(this.data_p,this.data_p_old),this.merge_1(this.data_t,this.data_t_old),e&&(this.merge_1_hier(this.data_p,e.data_p,e),this.merge_1_hier(this.data_t,e.data_t,e));for(var t=0;t<this.data_p.length&&0===this.data_p[t]&&0===this.data_t[t];)t++;var n=[this.time_base+t*this.time_unit,this.data_p.slice(0,this.len+1).slice(t),this.data_t.slice(0,this.len+1).slice(t)];if(!pref.test_mode[42]&&this.fromNo){var r=this.fromNo;if(r.valid=!0,r.prep("live",r.prep_board_check_valid),r.valid){if(r.data_p_old){var a=r.data_p_old.length-1;r.data_p[a]>r.data_p_old[a]&&(r.data_p_old[a]=r.data_p[a])}}else for(var s=0;s<r.data_p.length;s++)r.data_p[s]=0;r.data_p_old&&(r.data_p=r.data_p_old.concat(r.data_p.slice(r.data_p_old.length)));for(var s=r.data_p.length-2-this.tolerance;s<r.data_p.length;s++)r.data_p[s]=0;n[3]=r.data_p.slice(0,this.len+1).slice(t)}localStorage[this.get_ls_key()]=this.Zcompress(JSON.stringify(n)),pref.debug_mode[15]&&console.log("saved: "+this.get_ls_key())}},load:function(){if(pref.stats.load&&localStorage){var e=localStorage[this.get_ls_key()];if(e){e=JSON.parse(this.Zdecompress(e));var t=(this.time_base-e[0])/this.time_unit,n=Math.floor((m-this.time_last)/this.time_unit);if(0===n&&(n=void 0),t>=0?(this.data_p_old=e[1].slice(t,n),this.data_t_old=e[2].slice(t,n),this.fromNo&&e[3]&&(this.fromNo.data_p_old=e[3].slice(t,n))):(this.data_p_old=this.array_init([],0,0).slice(0,-t).concat(e[1].slice(0,n)),this.data_t_old=this.array_init([],0,0).slice(0,-t).concat(e[2].slice(0,n)),this.fromNo&&e[3]&&(this.fromNo.data_p_old=this.array_init([],0,0).slice(0,-t).concat(e[3].slice(0,n)))),this.fromNo&&this.fromNo.data_p_old)for(;0===this.fromNo.data_p_old[this.fromNo.data_p_old.length-1];)this.fromNo.data_p_old.pop()}else this.data_p_old=null,this.data_t_old=null}},tgts_changed:function(e,t,n){this.save_all_unsubscribe(),this.tgts=e,this.key=t,this.tgts_obj2=pref_func.str2obj2(e.join(","),null,!0),this.prep("both",this.prep_thread_subscribe),n||this.init()},time_unit_changed:function(e,t){this.fromNo&&this.fromNo.prep("live",this.fromNo.prep_board_unsubscribe),this.time_sel=e,this.time_unit=h[e],t||this.init()},len_changed:function(e){this.len=e,this.init()},init:function(){this.time_last=null,this.data_p=[],this.data_t=[],this.data_l=[],this.rm=this.chart&&(this.chart.show.ep||this.chart.show.et)?new b(this):null,this.fromNo&&(this.fromNo.data_p=[],this.fromNo.data_p_old=[],this.fromNo.min_idx=0),this.refresh(!0)},array_init:function(e,t,n){for(var r=t;r<this.len+2;r++)void 0===e[r]&&(e[r]=n);return e},tz_offset:(new Date).getTimezoneOffset(),label_init:function(e){for(var t=f[this.time_unit],n=t[2]?Math.floor((Math.floor((this.time_base-this.tz_offset+(this.len+2)*this.time_unit)/t[0])*t[0]-(this.time_base-this.tz_offset))/this.time_unit):this.len+2;n>=e;)this.data_l[n]=t[1](this.time_base+n*this.time_unit),n-=t[2]?t[0]/this.time_unit:1},prep_time:function(e){var t=Math.floor((Date.now()/6e4+this.tolerance)/this.time_unit)*this.time_unit;if(this.time_last!==t){var n=(t-this.time_last)/this.time_unit;this.time_last=t,this.time_base=t-this.time_unit*this.len;var r=0;e||0===n||(n>this.len&&(n=this.len),this.data_p.splice(0,n),this.data_t.splice(0,n),this.data_l.splice(0,n),this.rm&&(this.rm.data_p.splice(0,n),this.rm.data_t.splice(0,n)),this.fromNo&&(this.fromNo.data_p.splice(0,n),this.fromNo.data_p_old&&(this.fromNo.data_p_old.splice(0,n),0===this.fromNo.data_p_old.length&&(this.fromNo.data_p_old=null)),this.fromNo.min_idx-=n),this.data_p_old&&(this.data_p_old.splice(0,n),0===this.data_p_old.length&&(this.data_p_old=null)),this.data_t_old&&(this.data_t_old.splice(0,n),0===this.data_t_old.length&&(this.data_t_old=null)),r=this.len-n,this.min_idx-=n,this.min_idx<0&&(this.min_idx=0)),this.array_init(this.data_p,r,0),this.array_init(this.data_t,r,0),this.array_init(this.data_l,r,""),this.rm&&(this.array_init(this.rm.data_p,r,0),this.array_init(this.rm.data_t,r,0)),this.fromNo&&this.array_init(this.fromNo.data_p,r,0),this.label_init(r),this.shift=e?0:this.shift+n}this.wdg_tick.restart(6e4*this.time_unit)},prep:function(e,t,n){for(var r=0;r<this.tgts.length;r++){var a=common_func.name2domainboardthread(this.tgts[r],!0);"live"!==e&&"both"!==e||this.prep_1(liveTag.mems,a,t,n),"dead"!==e&&"both"!==e||this.prep_1(u,a,t,n)}},prep_1:function(e,t,n,r){t[2]?e[t[0]]&&e[t[0]][t[1]]&&e[t[0]][t[1]][t[2]]&&null!==r&&(r?r:n).call(this,e[t[0]][t[1]][t[2]]):t[1]?e[t[0]]&&e[t[0]][t[1]]&&this.prep_board(e[t[0]][t[1]],n,r):e[t[0]]&&this.prep_domain(e[t[0]],n,r)},prep_domain:function(e,t){for(var n in e)this.prep_board(e[n],t,func_t)},prep_board:function(e,t){for(var n in e)t.call(this,e[n])},prep_thread_init:function(e){e.s&&this.update_thread(e.s,0)},check_and_add_thread:function(e){e.s&&!this.prep_thread_unsubscribe(e,!0)&&(this.update_thread(e.s,0,!0),this.prep_thread_subscribe(e))},prep_thread_subscribe:function(e){Array.isArray(e.ss)?e.ss.push(this):e.ss?e.ss=[e.ss,this]:e.ss=this},prep_thread_unsubscribe:function(e,t){if(Array.isArray(e.ss)){var n=e.ss.indexOf(this);if(t)return n!==-1;n!=-1&&(e.ss.splice(n,1),1===e.ss.length&&(e.ss=e.ss[0]))}else{if(e.ss!==this)return!1;if(t)return!0;delete e.ss}},refresh:function(e){pref.debug_mode[15]&&console.log("updated: "+this.data_p.slice(this.len-10).toString()+", "+this.min_idx),this.prep_time(e),e?(this.prep("live",this.prep_thread_init),this.rm_tmp=new b(this,this.data_p,this.data_t),this.rm_tmp.prep("dead",this.rm_tmp.prep_board_init,this.prep_thread_init),this.rm&&this.rm.prep("dead",this.rm.prep_board_init,this.prep_thread_init),this.fromNo&&this.fromNo.prep("live",this.fromNo.prep_board_init,!0),this.load(),this.chart&&this.chart.replace_data(this)):0===this.shift&&this.min_idx===this.data_p.length||(this.fromNo&&this.fromNo.prep("live",this.fromNo.prep_board_init,!1,!0),this.chart&&this.chart.update_data2(this)),this.min_idx=this.data_p.length},update_thread:function(e,t,n){e&&(0===t&&this.update_thread_1(this.data_t,e,0,0),this.update_thread_1(this.data_p,e,t,e.length-1),n&&this.draw())},update_thread_1:function(e,t,n,r){for(var a=r;a>=n;a--){var s=Math.floor((t[a]-this.time_base)/this.time_unit),i=s-this.len-1;if(i>0&&(pref.stats.tolerant&&(this.tolerance=i*this.time_unit+this.tolerance,this.tolerance>pref.stats.tolerance&&(this.tolerance=pref.stats.tolerance),this.prep_time(!1)),s=this.len+1),!(s>=0))break;e[s]++,s<this.min_idx&&(this.min_idx=s)}}};var b=function(e,t,n){this.data_p=t||[],this.data_t=n||[],Object.defineProperty(this,"min_idx",{set:function(e){this.__proto__.min_idx=e},get:function(){return this.__proto__.min_idx},configurable:!0,enumerable:!0});for(var r in y)this[r]=y[r];this.__proto__=e},y={prep_board:function(e,t,n){if(e.sr)t.call(this,e);else for(var r in e)n.call(this,e[r])},prep_board_init:function(e){this.prep_board_init_1(e.sr,this.data_p),this.prep_board_init_1(e.srt,this.data_t)},prep_board_init_1:function(e,t){for(var n=e[this.time_sel][1],r=(this.time_base-e[this.time_sel][0])/this.time_unit,a=r;a<n.length;)n[a]&&(t[a-r]+=n[a]),a++}},w=function(e){this.data_p=[],this.min_idx=0;for(var t in k)this[t]=k[t];this.__proto__=e},k={prep_board_subscribe:function(e){e.s||r(e,"s"),e.s[this.time_sel][2].push(this)},prep_board_unsubscribe:function(e){if(e.s&&this.time_sel){var t=e.s[this.time_sel][2].indexOf(this);t!=-1&&e.s[this.time_sel][2].splice(t,1)}},prep:function(e,t,n,r){if(n&&this.__proto__.prep.call(this.fromNo,"live",this.fromNo.prep_board_subscribe,null),r)for(var a=this.min_idx;a<this.data_p.length;a++)this.data_p[a]=0;this.new_vals={},this.__proto__.prep.call(this,"live",t,null);for(var a in this.new_vals)this[a]=this.new_vals[a];delete this.new_vals},prep_board:function(e,t){t.call(this,e)},prep_board_init:function(e,t){var n=e.s[this.time_sel][1],r=(this.time_base-e.s[this.time_sel][0])/this.time_unit,a=this.min_idx+r;a<2&&(a=2);for(var s,i=a-1;i>0&&!n[i];)i--;if(i>0)s=n[i];else{for(;a<n.length&&!n[a];)a++;s=n[a++]}if(pref.stats.patch_tm){for(var o=(i>0?i:a-1)-r,l=o;a<n.length;)n[a]&&(this.data_p[o]+=n[a]-s,s=n[a],l=o,o=a-r),a++;(void 0===this.new_vals.min_idx||this.new_vals.min_idx>l)&&(this.new_vals.min_idx=l)}else{for(;a<n.length;)n[a]&&(this.data_p[a-r]+=n[a]-s,s=n[a]),a++;(void 0===this.new_vals.min_idx||this.new_vals.min_idx>a-r)&&(this.new_vals.min_idx=a-r)}},update_posts_no:function(e,t){var n=(e-this.time_base)/this.time_unit+t;n>=0&&n<this.min_idx&&(this.min_idx=n)},prep_board_check_valid:function(e,t){this.valid&=e.s[h.length]>=0}},x={};return window.addEventListener("beforeunload",_,!1),{aggregate:function(e,n,r){var a=liveTag.mems[e.domain][e.board],s=a[e.no];s.s||(s.s=[],r?n.next&&(n.step=(n.next-n.start)/n.length):n=s.pd&&pref.test_mode[128]?site2[s.domain].update_posts_merge_prep(e.posts,s.pd,-1,!0):e.posts);var i=e.parse_funcs.time_unit,o=s.s.length,p=o,c=0;if(r){var _=(n.next||n.now)-e.time,d=pref.test_mode.num||36e5;if(p<=1&&_>d)for(var u=Math.pow(2,Math.log2((_+d)/d)/n.length),f=p?d*u:d;p<n.length;)s.s[p++]=Math.floor((n.start+f-d)/6e4),f*=u;else for(;c<n.length;)s.s[p++]=Math.floor((n.start+n.step*c++)/6e4)}else for(;c<n.length;)s.s[p++]=Math.floor(n[c++].time*i/6e4);if(s.ss)if(Array.isArray(s.ss))for(var c=0;c<s.ss.length;c++)s.ss[c].update_thread(s.s,o,!0);else s.ss.update_thread(s.s,o,!0);else 0===o&&t(s);pref3.stats.estimate_posts&&!r&&l(a,e,o,s.s,e.posts.length)},aggregate_passive:function(e,t,n){var r=liveTag.mems[e.domain][e.board].st||e.time_tu,a=(n-r)/t,s={start:r,step:a,length:t,next:e.time_nextThread,now:n};this.aggregate(e,s,!0)},thread_removed:e,Stats:v,register_auto_acquisition:function(e){x["@"+c(e)]=null,cnst.auto_shrink_board_selector.color()},query_auto_acquisition:function(e){return void 0!==x["@"+c(e)]},auto_acquisition_init:d}}():null,listener=null;site.features.listener&&pref.features.listener&&(listener=make_listener());var pn_debug=0;brwsr.sw_cache=brwsr.sw_cache&&window.SharedWorker&&(pref.info_server||pref.info_client)?function(){function e(e){if(!e){var r=new Blob(['          var ports = [];          var store = {};          var connections = 0;          self.addEventListener("connect", function(e){            var port = e.ports[0];            var no = connections++;            var func = function(e){msg_parser(e,port,no)};            port.addEventListener("message", func, false);            port.start();            port.postMessage(JSON.stringify(["INFO","Connected: #" + no]));            ports.push({port:port, func:func, echo:true, subscribe:false});          }, false);          function msg_parser(e,port,no){            if (ports[no].echo) port.postMessage(e.data);            var fields = JSON.parse(e.data);            if (fields[0]=="ECHO") ports[no].echo = fields[1];            else if (fields[0]=="GET") port.postMessage(JSON.stringify(["ACK",fields[1],store[fields[1]]]));            else if (fields[0]=="CLOSE") {              port.removeEventListener("message", ports[no].func, false);              ports[no] = null;            }/*            else if (fields[0]=="SET") store[fields[1]]=fields[2];*/            else if (fields[0]=="SET") {              var old_val = store[fields[1]];              if (old_val!=fields[2]) {                var msg = JSON.stringify(["EVENT",fields[1]]);                for (var i=0;i<ports.length;i++)                  if (i==no) store[fields[1]]=fields[2];                  else if (ports[i] && ports[i].subscribe) ports[i].port.postMessage(msg);              }            } else if (fields[0]=="STAT") stat_post(port,"STAT_ACK",fields[1]);else if (fields[0]=="SUBSCRIBE") ports[no].subscribe = fields[1];}var gc = setInterval(gc_func, 600000);function gc_func(){var date = Date.now() - 3600000;for (var i in store) if (store[i].date < date) delete store[i];}function stat_post(port,str,dump){var live = 0;for (var i=0;i<ports.length;i++) if (ports[i]) live++;var msg = JSON.stringify([str,"Connected: "+live+"/"+connections+", Stored: "+Object.keys(store).length]);port.postMessage(msg);var count = 0;if (dump) for (var i in store) port.postMessage(JSON.stringify(["DUMP_ACK",(count++)+": "+i+", "+JSON.stringify(store[i])]));}        '],{type:"text/javascript"});e=URL.createObjectURL(r),localStorage[i]=e}try{return a=new unsafeWindow.SharedWorker(e),a.port.addEventListener("message",t,!1),a.port.addEventListener("message",n,!1),a.port.start(),!0}catch(e){return!1}}function t(e){console.log((new Date).toLocaleTimeString()+", Worker said : "+e.data.substr(0,120)),s||(a.port.postMessage(JSON.stringify(["STAT"])),pref.debug_mode[0]||a.port.postMessage(JSON.stringify(["ECHO",!1])),window.addEventListener("beforeunload",function(){a.port.postMessage(JSON.stringify(["CLOSE"])),a.port.close()},!1)),s=!0,pref.debug_mode[0]||a.port.removeEventListener("message",t,!1)}function n(e){if(c=JSON.parse(e.data),"ACK"==c[0]){var t=c[1];clearTimeout(p[t]),l[t]&&(l[t][0](t,c[2],l[t][1]),delete l[t])}else if("EVENT"==c[0]){if(pref.info_client&&c[1].search(info_raw)!=-1&&"p"==c[1].substr(info_raw.length,1)){var n=(c[1].substr(info_raw.length+1),timer_obj?timer_obj.timer():null);null!=n&&brwsr.sw_cache.trygetItem(c[1],n.page_check5)}pref.info_client&&catalog_obj&&null!=catalog_obj.catalog_func()&&pref.catalog_snoop_refresh&&catalog_obj.catalog_func().catalog_insert(c[1])}c=null}function r(e){l[e][0](e,null,l[e][1]),delete l[e]}if(!localStorage)return null;var a=null,s=!1,i=pref.script_prefix+".bs",o=localStorage[i];o?e(o)||e():e(),!brwsr.ff&&a&&setTimeout(function(){null===o||s||(a.port.removeEventListener("message",t,!1),a.port.close(),e()||(brwsr.sw_cache=null))},5e3);var l=[],p=[],c=null;return a?{setItem:function(e,t){a.port.postMessage(JSON.stringify(["SET",e,t]))},trygetItem:function(e,t,n){l[e]=[t,n],p[e]=setTimeout(function(){r(e)},2e3),a.port.postMessage(JSON.stringify(["GET",e]))},subscribe:function(e){a.port.postMessage(JSON.stringify(["SUBSCRIBE",e]))},addEventListener:function(){}}:null}():null,site0.isStep||function(){var e="CatChan_archive_"+window.name,t=pref.catalog.embed_page&&"page"===site.whereami&&sessionStorage&&sessionStorage[e]?function(){catalog_obj.show_hide(),setTimeout(function(){var t=JSON.parse(sessionStorage[e]);sessionStorage[e+"M"]&&(t[2]=function(){if(send_message_emu=JSON.parse(sessionStorage[e+"M"]),receive_message_emu(window.name),pref.archive.IDB.redirect_404_CSP){var t=document.head.innerHTML+document.body.innerHTML,n=new Blob([t],{type:"text/html"}),r=URL.createObjectURL(n);window.open(r,window.name+"B")}}),send_message_emu=[t],receive_message_emu(window.name)},100)}:catalog_obj&&catalog_obj.show_hide;"404"===site.whereami&&pref.archive.IDB.redirect_404?sessionStorage&&setTimeout(function(){var t=e+"A";if(sessionStorage[t])delete sessionStorage[t];else{var n=common_func.fullname2dbt(window.name);sessionStorage[t]=JSON.stringify(["ARCHIVER",["SUB_INIT",{IDB:!0,domain:n[0],board:n[1],no:n[2]}]]),received_messages_404&&(sessionStorage[t+"M"]=JSON.stringify(received_messages_404));var r=site2[site.nickname].make_url4([site.nickname,site.board,"0","page_html"])[0];window.name=window.name+"A",window.open(r,"_self")}},5e3):(pref.catalog.embed&&"catalog"===site.whereami||pref.catalog.embed_page&&"page"===site.whereami||pref.thread.embed&&"thread"===site.whereami||pref.catalog.embed_archive&&"archive"===site.whereami)&&catalog_obj&&(site2[site.nickname].catalog_native_prep_wait_loop?site2[site.nickname].catalog_native_prep_wait_loop(site.whereami,t):pref.patch.delayed_invoke.use?setTimeout(t,1e3*pref.patch.delayed_invoke.sec):t()),setTimeout(thread_reader_init,0),setTimeout(uip_tracker_init,0)}(),options.func0_prep=function(e,t,n){function r(){if(null==l&&null==p){var t=e.childNodes[1].childNodes[1].selectedIndex,n=e.childNodes[1].childNodes[2].value,r=parseInt(n.substr(0,n.indexOf(":")),10),s=parseInt(n.substr(n.indexOf(":")+1),10),c=Date.now();0==t?(o=(new Date).setHours(r,s,0))<c&&(o+=864e5):o=c+1e3*(3600*r+60*s),a()}else null!=l&&(clearTimeout(l),l=null),null!=p&&(clearInterval(p),p=null),_.innerHTML="";i(!1)}function a(){var e=Date.now(),t=o-e;l=t%6e4>=1e3&&t>6e4?setTimeout(a,t%6e4):t<9e4?setTimeout(function(){p=s(30),l=null},t-3e4):setTimeout(a,(t+3e4)%6e4+3e4);var n="";t%6e4>=1e3&&t%6e4<=59499&&(n=Math.round(t%6e4/1e3)+"s"),t>=59500&&(n=Math.floor((t+500)%36e5/6e4)+"m"+n),t>=3599500&&(n=Math.floor((t+500)/36e5)+"h"+n),_.innerHTML=n}function s(e){function t(){if(e-=1,_.innerHTML=e+"s",0==e){var t=document.createEvent("MouseEvents");t.initUIEvent("click",!1,!0,window,1),site.components.postform_submit.dispatchEvent(t),r()}}return _.innerHTML=e+"s",i(!0),setInterval(t,1e3)}function i(t){n.style.background=t?"#ffc0cb":null!=l?"#f5ecf9":d.checked?"#e5f4f9":c;var r=t||null!=l?"Cancel":"Schedule";e.childNodes[1].childNodes[0].value=r}cnst.add_to_tb(t,cnst.icons.button_settings());e.innerHTML='<div style="float:left"><input type="checkbox">autobumper</div><div style="float:right"><input type="button" value="Schedule"><select name="time_sel"><option>at</option><option>later</option></select><input type="time" name="time" value="08:41"></div><div style="float:right"></div>',e.childNodes[1].childNodes[0].addEventListener("click",r,!1);var o,l=null,p=null,c=e.parentNode.style.background,_=e.childNodes[2],d=e.childNodes[0].childNodes[0];d.onchange=function(){i(!1)};var u=null;options.func0_exe=function(e){var t=document.getElementsByClassName("postreply").length-document.getElementsByClassName("de-post-deleted").length;parseFloat(e)>=site.max_page-1&&d.checked&&null==u&&t<site.autosage&&(p=s(30),u=setTimeout(function(){u=null},36e5))}}}}}();
//# sourceMappingURL=https://raw.github.com/Dogman8/CatChan/master/CatChan.user.js.map
