// ==UserScript==
// @name CatChan
// @version 2019.06.30.0
// @description Cross domain catalog for imageboards
// @include http*://*krautchan.net/*
// @include http*://boards.4chan.org/*
// @include http*://boards.4channel.org/*
// @include http*://i.4cdn.org/*
// @include http*://8chan.co/*
// @include http*://8ch.net/*
// @include http*://lainchan.org/*
// @include http*://lainchan.jp/*
// @include http*://*meguca.org/*
// @include http://localhost/*
// @require https://cdnjs.cloudflare.com/ajax/libs/Chart.js/1.0.1-beta.4/Chart.min.js
// @updateURL https://raw.github.com/Dogman8/CatChan/master/CatChan.meta.js
// @grant unsafeWindow
// @grant GM_xmlhttpRequest
// ==/UserScript==
//
//    Copyright 2014 DogMan8
//
//    This program is free software: you can redistribute it and/or modify
//    it under the terms of the GNU Affero General Public License as published by
//    the Free Software Foundation, version 3 of the License.
//
//    This program is distributed in the hope that it will be useful,
//    but WITHOUT ANY WARRANTY; without even the implied warranty of
//    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
//    GNU Affero General Public License for more details.
//
//    You should have received a copy of the GNU Affero General Public License
//    along with this program.  If not, see <http://www.gnu.org/licenses/>.
//
!function(){function pref_default(e){for(var t={image_hover:!1,image_prefetch:!1,click:"none",click_area:"thumbnail",format:{show:{style:!0,contents:!0,layout:!0,posts:!1,fileinfo:!1,images_2nd:!0},hover:{style:!0,contents:!1,layout:!1,posts:!0,fileinfo:!0,images_2nd:!0},search:{style:!1,contents:!1,layout:!1,posts:!0,fileinfo:!0,images_2nd:!0},thumb:{resize:!1}},footer:{use:!0,nrtm:!0,nr:!0,rp:!0,im:!0,domain:!1,board:!0,no:!1,flag:!1,tag:!0,page:!0,design:"native",rOP:!0,iOP:!0,custom:"(ar )(nm/)(nr/)(lp/)(rp)(*sp)(+dp)(/im)(/pg) (ni/nf) (ct )(cT )(bt )(bT )(pt )(pT )(pr )(dn)(bd)(no) ",custom2:"(ar )(nm/)(nr/)(lp/)(rp)(*sp)(+dp)(/im)(/pg) (ni/nf) (ct )(cT )(bt )(bT )(pt )(pT )(pr )(dn)(bd)(no) ",ctime:!1,btime:!1,ptime:!1,rctime:!1,rbtime:!1,rptime:!1,br:!0,prate:!1,archived:!0,nd:!1,nl:!1,nf:!1,nid:!1,ns:!1},footer_br:!0,draw_on_demand:!0,load_on_demand:!1,t2h_sel:"page",t2h_L:100,t2h_M:50,get t2h_N(){return this.t2h_num_of_posts},t2h_num_of_posts:5,save_board_list_sel:!1,board_list_sel:0,mark_new_posts:!0,auto_update:!1,auto_update_period:10,auto_update_countdown:!0,storePosts:"auto",sourceOfSP:"auto",searchAs:!0,searchAsA:!1,searchAc:{loosen:!0,max:1e3,max_threads:1e4,max_threads_at_refresh:1e4},popup:!0,colorID:!0,backlink:!0,popup_truncated:!0,popup_zIndex:100,backlink_all:!1,backlink_all_cross:!1,popup_hlt:!0,bl_ec:!1,bl_rm:!0,popup_delay:50,popdown_delay:500,popdown:"delay",popup_mMove:!0,link_show_op:!0,link_show_cross:!0,expand_thumbnail_inline:!0,localtime:!0,expand_thumbnail_inline_all_after:!1,expand_thumbnail_initial:!1,hide_posts_without_images:!1,thumbnail:{inline:{limit_width:!0,limit_height:!1,margin_width:40,margin_height:0,webm:!0,webm_mute:!1,webm_loop:!1,ondemand:!0,ref_height:400},hover:{limit_width:!0,limit_height:!0,margin_width:40,margin_height:0,webm:!1,webm_mute:!0,webm_loop:!1,popup_delay:50,popdown_delay:500,popdown:"delay",popup_mMove:!0,popup_zIndex:101,dragfloat:!0,df_dblC:!0,df_mW:!0,df_cV:!0,zoom:!1}},popupX:{popup_delay:500,popdown_delay:500,popdown:"delay",popup_mMove:!0,popup_zIndex:101,use:!1,ID:!0,flag:!0,name:!1,anon:!1,trip:!1},open_spoiler_text:!1,open_spoiler_image:!1,merge:!1,merge_list:!1,merge_list_str:"",merge_list_obj6:null,merge_first:!0,merge_lv:!0,merge_lv_str:"",merge_lv_obj6:null,lazyDraw:{merge:!0,merge_step:256,step:16},scroll_lock:!1,use_expander_always:!1,popup2:"sr",popup2_sel:"auto",popup2_sel_tolerance:10,popup2_resize:!1,popup2_resize_bw:8,popup2_resize_cw:20,popup3:{ww:"no",wn:"no",nw:"no",nn:"no",popup_delay:300,popdown_delay:500,popdown:"delay",popup_mMove:!0,popup_zIndex:100},posts_search_op:"opaque",posts_search_op_opacity:40,deleted_posts:{detect:"acc",store:"LS",merge:!0,auto_clean:!0},detect_sage:!1,page_his:!1,promiscuous:!1,imagesearch:{use:!0,google:!0,iqdb:!0,saucenao:!0,whatAnime:!0,desustorage:!0,exhentai:!0},env:{disp_offset:0,disp_filler:"",popup_native:!0,expand_thumbnail_inline_native:!0,image_hover_native:!1,colorID_native:!0,backlink_native:!0,localtime_native:!0,auto_update_native:!1,event_dynamic:!1,popup_native_kill:!0,refresh_initial:!0}},n={script_prefix:"CatChan",features:{page:!0,graph:!0,setting:!0,setting2:!0,postform:!0,catalog:!0,listener:!0,uip_tracker:!0,thread_reader:!0,debug:!1,notify:{desktop:!0,sound:!0,favicon:!0},recovery:!0,domains:site0.domains_obj(!0,!0)},max_capture:576,interval_found:10,write_to_ls:!0,aggregator:"true",server:!0,load_pref:!0,load_data:!0,check_page:!1,check_post:!1,check_thread:!1,import_format:"obj",max_graph:576,scale_thread:10,auto_start:!0,prevent_redirection:!1,graph_animation:!1,autoconf:"auto",info_server:!1,info_client:!1,wafd_tb:"tb",wafd_open_spoiler:!1,show_page_fraction:!0,catalog_max_page:5,catalog_max_page_auto:!0,catalog_max_page_select:"auto",catalog_snoop_refresh:!0,catalog_auto_rollup_when_moving:!0,catalog_size_width:240,catalog_size_height:350,catalog_size_text_width:400,catalog_size_text_height:16,catalog_size_tn1_width:240,catalog_size_tn1_height:240,catalog_size_tn2_width:80,catalog_size_tn2_height:80,catalog_size_frame0_width:30,catalog_size_frame1_width:69,catalog_load_on_demand_timeout:10,catalog_2nd_images_show:!1,catalog_2nd_images_hover:!0,catalog_2nd_images_search:!0,catalog_posts_on_demand:!0,catalog_refresh_clear:!0,catalog_popdown:"delay",catalog_popup_delay:300,catalog_popdown_delay:500,catalog_popup_size_fix:!0,catalog_open_last50:"exist_watch",catalog_board_list_str:"//sample of board group\n//board_name[,nickname+board_name[+thread No.]['*'+up to X page]]..., [#Tag|##Tag]..., [!stats]\nGlobal/int/,8chan/int/,KC/int/,4chan/int/\nGlobal/b/,8chan/b/,KC/b/,4chan/b/\nv+gg,8chan/v/,8chan/gamergatehq/,4chan/v/\nInter/pol/,8chan/pol/,4chan/pol/\nJapanShoppingMall,8chan/jpck/,8chan/japan2/\ntech,meguca/g/,lain/tech/,8chan/tech/,4chan/g/,KC/t/\n",catalog_board_list_obj:[],catalog_promiscuous:!1,get catalog_board_list_sel(){return cataLog&&cataLog.embed_mode&&this[cataLog.embed_mode]?this[cataLog.embed_mode].board_list_sel:0},set catalog_board_list_sel(e){cataLog&&cataLog.embed_mode&&this[cataLog.embed_mode]&&(this[cataLog.embed_mode].board_list_sel=e)},localtime_offset:-((new Date).getTimezoneOffset()/60),catalog_footer_ignore_my_own_posts:!0,catalog_footer_tag_letters:3,catalog_no_popup_at_expanded:!0,catalog_open_in_new_tab:!0,catalog_open_where:"named",catalog_open_where_click:!0,catalog_triage:!0,catalog_triage_place:"topLeft",catalog_triage_hist:16,triage:{show_always:!1,popdown_delay:2e3,hide_toggle:!0},catalog_triage_str:"KILL,X,,TIME,v,,WATCH,W,,UNWATCH,UW,,UNDO,U,",catalog_auto_update_countdown:!0,catalog_expand_with_hr:!1,overwrite_site2_json_str:'//{"site2":{"KC":{"time_offset":2}}} // summer time for KC.\n//{"site2":{"4chan":{"protocol":"https:"}}} // use https to 4chan.\n//{"pref":{"patch":{"rm_404_blacklist":["8chan"]}}} // 8chan sends corrupted data.\n',overwrite_site2_eval_str:"",tooltips:{help:{show:!0,popup_delay:2e3,popdown_delay:1e3},info:{show:!0,popup_delay:300,popdown_delay:500},zIndex:100},catalog:{indexing:0,max_threads_at_refresh:500,filter:{kwd:{use:!1,str:"",re:!1,ci:!0,match:0,sentence:!1,op:!0,post:!1,sub:!0,name:!0,trip:!1,com:!0,file:!1,meta:!1,flag:!1,id:!1,rexps:null},tag:!1,tag_ci:!1,time:!1,time_creation:!1,time_str:new Date(Date.now()-864e5).toLocaleString(),time_obj:!0,time_ago_str:"0:00",time_ago_str_sync_at_refresh:!1,time_track:!1,desktopime_mark_str:"",time_watch:!1,time_watch_creation:!1,list_time_scroll:!0,list:!0,list_str:"",list_obj2:{},attr_list:!0,attr_list_str:"",attr_list_obj2:{},bookmark_list:!0,bookmark_list_str:"",bookmark_list_obj2:{},watch_list_str:"",watch_list_obj2:{},tag_search:{str:"",re:!1,show_nof_boards:!1,get ci(){return pref.liveTag.ci},sentence:!1,rexps:null},tag2bList:{label:"",by:"tag"},auto_list:{use:!1,str:"",obj7:null,kill:!1,watch:!0,show:!1,sticky:!1,style:!1,style_str:""}},bookmark_list_rm404:!0,auto_load_filter:!1,auto_save_filter:!1,auto_save_filter_at_refresh:!1,tag:{ignore:12,max:12},board:{recommendation:!0,all_boards:!1,board_tags:!1,ex_list:!1,ex_list_str:"",ex_list_obj2:{},board_tags_same:!1},style_general_list:!0,style_general_list_str:"//^background:#e5ecf9\n//^border:1px solid black\n//8chan^background:#eef2ff;border:1px solid #d6daf0\n//8chan^background:#eef2ff\n//KC^background:#e0e0fc;border:1px solid #aaaacc\n//4chan^background:#ffffee;border:1px solid #f0e0d6\n",style_general_list_obj2:{},refresh:{except_bt:!0,at_switch:!0},design:"auto",catalog_json:!0,embed:!0,embed_page:!0,embed_frame:!0,embed_archive:!1,order:{reply_to_me:!0,reply:!0,watch:"dont_care",sticky:"first"},auto_watch:!0,unmark_on_hover:!0,mimic_base_site:!0,text_mode:{mode:"graphic",sub:!0,name:!1,com:!0},appearance:{titleBar:{filter:!0,settings:!0,refresh:!0,num_of_pages:!0,boards_selector:!0},initial:{state:"max",width:400,height:400,left:0,top:0}},t2h_sel:"no",click:"open",popupX:{__proto__:t.popupX},env:Object.create(t.env),footer:{__proto__:t.footer},__proto__:t},filter:{disable_list_when_kwd_active:!0,disable_tag_when_kwd_active:!1},page:{get embed(){return pref.catalog.embed_page},infinite:!1,format:{show:{style:!1,contents:!1,layout:!1,posts:!0,fileinfo:!0,images_2nd:!0},__proto__:t.format},image_hover:!0,get footer(){return pref.catalog.footer},footer_br:!1,load_on_demand:!0,popupX:{__proto__:t.popupX},env:Object.create(t.env),__proto__:t},thread:{embed:!1,format:{show:{style:!1,contents:!1,layout:!1,posts:!0,fileinfo:!0,images_2nd:!0},__proto__:t.format},image_hover:!0,get footer(){return pref.catalog.footer},footer_br:!1,popupX:{__proto__:t.popupX},env:{auto_update_native:!0,refresh_initial:!1,__proto__:t.env},t2h_num_of_posts:-1,auto_update:!1,__proto__:t},float:{click:"open",footer:{__proto__:t.footer},format:{thumb:{resize:!0},__proto__:t.format},save_board_list_sel:!0,popupX:{__proto__:t.popupX},env:Object.create(t.env),__proto__:t},common:{clear_at_manual_scan:!1},uip_tracker:{on:!1,posts:!0,deletion:!0,interval:10,adaptive:!0,highlight_str:"color:red",annotate:!0,auto_open:!1,auto_open_th:300,auto_open_kwd:"",deletion:{show:!0,link:!0,name:!0,name_str:"color:red",addName:!0,addName_str:"DELETED_",post:!1,post_str:"opacity:0.4"},sage:{detect:!0,name:!0,name_str:"color:blue",addName:!1,addName_str:"SAGE_",post:!1,post_str:"opacity:0.4",tolerance:1,patch_bug:!1,patch_bug2:!1,patch_bug2nth:8,patch_bug3:!0,annotate:!0,page:!1,patch_bug4:!0,patch_bug5:!0,annotate_page:!1}},thread_reader:{use:!0,sync:!0,triage:!0,triage_close:!0,check_num_of_children:!0,own_posts_tracker:!1,show_own_post_by:"anchor",show_reply_to_me_by:"anchor",clean_up_own_posts:!0},IDinfo:{ID:!0,flag:!0,IDFlag:!0,IDop:!0,nofIDs:!0,nofFlags:!0,auto:!0,name:!1,trip:!1,nameTrip:!1,nofNames:!0,nofTrips:!0},settings:{indexing:0},tag:{gen:!1,gen_str:""},cloudflare:{auto_reload:!0,auto_reload_time:5},scan:{max:1e4,lifetime:20,crawler:50,max_threads:1e3,crawler_adaptive:!0,crawler_idle_time_to_spawn:100,max_archive:150},notify:{sound:{notify:!1,src:"beep",beep_freq:1e3,beep_length_f:.2,beep_volume_f:1,reply_to_me:!0,reply:!0,new_thread:!0,appear:!0,supp_init:!0},desktop:{notify:!0,reply_to_me:!0,reply:!0,new_thread:!0,appear:!0,lifetime:30,show_last:!1,supp_init:!0,limit:brwsr.ff?10:30,delay:brwsr.ff?500:0},favicon:!0,title:{notify:!0,hide_zero:!0}},liveTag:{use:!0,max:12,maxstr:25,from:"post",lock_tags_in_op:!0,ci:!0,inherit_board_name:!0,lock_board_name:!0,inherit_board_tags:!0,lock_board_tags:!0,info:!0,style:{ex:"color:blue",exurtm:"color:cyan;font-weight:bold",exur:"color:deepskyblue;font-weight:bold",in:"color:red",inurtm:"color:yellow;font-weight:bold",inur:"color:orange;font-weight:bold",use:!0,urtm:"color:lime;font-weight:bold",ur:"color:limegreen;font-weight:bold"},pickup_interval:10,rm_404:"imm",disp_delay:{fg:500,bg:5e3},click_func:"in",click_func_bl:"pkin",watch_all:!0,lazy_each:150,lazy_delay:100,ex_list:!0,ex_list_str:"8chan:#selection\n",ex_list_obj5:null,rm_list:!0,rm_list_str:"http*\n",rm_list_obj5:null},virtualBoard:{show:!0,max:20,scan:!1,scanDelay:5,p_board:"replace",p_remove:!1,v_remove:!0,scan_domains:site0.domains_obj("none"),instant_scan:!0,search:{show:!0,str:"",re:!1,get ci(){return pref.liveTag.ci},sentence:!1,rexps:null}},style:{sel:"fix",zIndex:1,fix:{titleBar_str:"background:#b5ccf9;border:1px solid blue;font-weight:normal",window_str:"background:#e5ecf9;color:#000000;font-weight:normal",popUp_str:"background:#e5f4f9;color:#000000;border:2px solid blue;font-weight:normal"},copy:{titleBar_str:"body",window_str:"body",popUp_str:""},post_editing:"background:#cec952 !important",post_new:"border:2px solid red",userCSS:{use:!1,str:"",sample:'.CatChan_titleBar button[name^="op"]{display:none} /* remove transparency buttons in titleBar */\n.CatChan_merge1::before{float:left;content:">";} /* levelized merge */\n.CatChan_merge2::before{float:left;content:">>";}\n.CatChan_merge3::before{float:left;content:">>>";}\n.CatChan_merge4::before{float:left;content:">>>>";}\n.CatChan_merge5::before{float:left;content:">>>>>";}\n.CatChan_merge1{border-left:10px solid red;} /* colored merge */\n.CatChan_merge2{border-left:10px solid orange;}\n.CatChan_merge2{border-left:10px solid yellow;}\n.CatChan_merge2{border-left:10px solid green;}\n.CatChan_merge3{border-left:10px solid blue;}\n.CatChan_titleBar button[name="roll_toggle"]{display:none} /* remove toggle button in titleBar */\n.CatChan_titleBar button[name="max"]{display:none} /* remove maximize button in titleBar */\n.CatChan_titleBar button[name="top"]{display:none} /* remove embed to top button in titleBar */\n.CatChan_titleBar button[name="bottom"]{display:none} /* remove embed to bottom button in titleBar */\n.CatChan_search_miss>*{opacity:inherit} /* patch for chrome in 4chan */\n'}},recovery:{comment:!0,interval:10,auto_clean:!0},healthIndicator:{show:!0,max:10,expand_running:!1,dont_retire_running:!0,cancel:!0},network:{cross_domain:"indirect",fetch_actively:!0,adaptive:!0,th100:5,th100_delay:500,th20:10,th20_delay:100,timeout:15,overXFO:!0,overCSPF:!0},stats:{use:!1,retain_404:!0,draw_delay:10,estimate_posts:!0,save:!0,load:!0,len_capture:1440,auto_acquisition:!0,auto_acquisition_scan:!0,auto_acquisition_scan_delay:120,auto_acquisition_all:!1,tolerant:!0,tolerance:90,patch_tm:!1},chart:{off_anime_blur:!0,window_width:400,window_height:400,instant_scan:!0,load_on_demand:!1,inst:{len:120,scale_thread:10,time_sel:1,board_sel:0,show_legend:!0,show:{np:!0,p:!1,ep:!1,nt:!1,t:!0,et:!1},clip_np:!1,clip_np_val:0,options:{bezierCurve:!1,animation:!1,pointDot:!0,pointDotRadius:4}}},archive:{load_img:!0,restore_auto:!0,clear_threads:!0,clear_files:!1,format:"auto",domain:0,board:"",src:"shown",store_auto:!1,dir_dled:null,open_local:!1,fix_inconsistency:!0,store_watched:!1,oneshot:{post:!0,tn:!0,img:!0,webm:!0,post_idb:!0,tn_idb:!0,img_idb:!0,webm_idb:!0},live:{post:!0,tn:!0,img:!1,webm:!1,post_idb:!0,tn_idb:!0,img_idb:!1,webm_idb:!1},deleted:{post:!0,tn:!0,img:!1,webm:!1,post_idb:!0,tn_idb:!0,img_idb:!1,webm_idb:!1},IDB:{auto_clean:!0,auto_clean_init:!0,prune:168,prune_flush:!1,nof_tr:10,nof_cl:20,nof_cl_max:80,auto_restore:!1,auto_restore_remove:!0,watchdog:120,redirect_404:!1,redirect_404_CSP:!1},kwd:{use:!0,str:"",re:!1,ci:!0,match:0,op:!0,post:!1,sub:!0,name:!0,trip:!1,com:!0,file:!1,meta:!1,sentence:!1,rexps:null},list:!0,list_str:"",list_obj6:null,list_inherit:!1,tar:!0,tarsize:100,sub_in_filename:!0,files_sel:0,IDB_board_sel:0,IDB_board_sel_gfunc_pre:pref4.archive.IDB_board_sel_gfunc_pre,IDB_thread_sel:0,IDB_thread_sel_gfunc_pre:pref4.archive.IDB_thread_sel_gfunc_pre,IDB_select_multiple:!0,editing_timeout:!0},threadStats:{use:!1,full:!0,retry:!1},debug_mode:{unread_count:"",parse_error:!1,site2func:"",site2func_expand:!0,pfunc:"",pfunc_expand:!0,pfunc_all:"",pfunc_all_expand:!0,pfunc_comp:"",pfunc_comp_expand_same:!0,pfunc_comp_expand_diff:!0,pfunc_comp_proto:""},test_mode:{tips:!1,num:0,num_f:0,test_str:""},patch:{delayed_invoke:{use:!1,sec:10},rm_404_blacklist:[]},pref2:{KC:{summer_time:!1},meguca:{historyAPI:!0,utilize_boards_json:!0,utilize_boards_json_domain:!0},"8chan":{utilize_boards_json:!0}},easy:{posts_ago:24,threads_ago:24,max_boards:50},easy2:{reset:!0,presets:0,time_post:24,time_op:24,basics:!0,auto_update:!1,auto_update_period:10,VB:{local:0,global:0},LTfrom:0,limits:0,virtualBoard:{show:!0,scan:!0,max:100},liveTag:{use:!1,from:"op"},catalog:{embed:!0,embed_page:!0,max_threads_at_refresh:500,auto_load_filter:!0,auto_save_filter:!0,auto_save_filter_at_refresh:!0,auto_update:!0,auto_update_period:10,filter:{time_watch:!1,time_watch_creation:!1}},page:{auto_update:!0,auto_update_period:10},thread:{embed:!1,auto_update:!0,auto_update_period:10},notify:{desktop:{notify:!0}},stats:{use:!1},scan:{max:100,max_threads:1e3},network:{fetch_actively:!1},healthIndicator:{expand_running:!1}},proto:t},a=0;a<40;a++)n.debug_mode[a]=!1;for(var a=0;a<130;a++)n.test_mode[a]=!1;return site0.pref_default2&&pref_func.pref_overwrite(n,site0.pref_default2),site0.pref_default&&pref_func.pref_overwrite(n,site0.pref_default),e&&(pref_func.delete_null(n),Object.defineProperty(n.page,"footer",{get:function(){return n.catalog.footer},enumerable:!0,configurable:!0}),Object.defineProperty(n.thread,"footer",{get:function(){return n.catalog.footer},enumerable:!0,configurable:!0})),common_func.Object_modifyDescriptor(n.style.userCSS,"sample",{writable:!1}),n}function make_port_parent(e,t){function n(e,t,n){if(pref.debug_mode[0]&&console.log(window.name+": Connecting from "+e.data),e.source==n&&new RegExp(site.nicknames.join("|")).test(e.data)||e.source==site.embed_frame_win&&"frame"===site.whereami&&e.data.indexOf("CLOSE")==-1){if(pref.debug_mode[0]&&console.log(window.name+": Connected successfully."),brwsr.ff?init_receive_port(t,n):init_receive_port(t,e.ports[0]),window.removeEventListener("message",init_func[t],!1),delete init_func[t],messages_to_send[t]){for(var a=0;a<messages_to_send[t].length&&!send_message(t,messages_to_send[t][a][0],null,messages_to_send[t][a][1]);a++);delete messages_to_send[t]}"_blank"==t&&send_message(t,["CLOSE"])}else pref.debug_mode[0]&&console.log(window.name+": FAIL.")}ports[e]&&send_message(e,["CLOSE"]),ports[e]="init",init_func[e]=function(a){n(a,e,t)},window.addEventListener("message",init_func[e],!1),pref.debug_mode[0]&&console.log(window.name+": Waiting for connection from "+e+" ...")}function make_port_child(e){if(pref.debug_mode[0]&&console.log(window.name+": Try to connect to parent..."),brwsr.ff)init_receive_port("parent",e),e.postMessage(window.name,"*");else{var t=new MessageChannel;init_receive_port("parent",t.port1),e.postMessage(window.name,"*",[t.port2])}}function init_receive_port(e,t){ports[e]=t,receive_func[e]=function(t){receive_message(t,e)},brwsr.ff?window.onmessage=receive_func[e]:(t.addEventListener("message",receive_func[e],!1),t.start())}function close_connection(e){brwsr.ff||ports[e].close(),ports[e].removeEventListener("message",receive_func[e],!1),delete receive_func[e],delete ports[e]}function send_message(e,t,n,a){if(Array.isArray(t)&&Array.isArray(t[0])&&(t=t[0],console.log("WARNING, PATCHED: send_mesage")),n&&make_port_parent(e,n),"init"===ports[e])messages_to_send[e]||(messages_to_send[e]=[]),messages_to_send[e].push([t,a]);else if(ports[e]||(e="parent"),pref.debug_mode[0]&&console.log(window.name+": Sent to "+e+": "+JSON.stringify(t).substr(0,80)),brwsr.ff?ports[e].postMessage(t,"*",a):ports[e].postMessage(t,a),"CLOSE"==t[0])return close_connection(e),!0}function receive_message_emu(e){for(;send_message_emu.length>0;)receive_message({data:send_message_emu.shift()},e||site.key)}function receive_message(e,t){pref.debug_mode[0]&&console.log(window.name+": Received from "+t+": "+e.data.toString().substr(0,80));var n=e.data,a=e.ports;if("404"===site.whereami&&"CLOSE"!==n[0])return void(received_messages_404?received_messages_404.push(e.data):received_messages_404=[e.data]);if("string"==typeof n&&(n=JSON.parse(n)),"HTTPD"==n[0])httpd.sub_funcs(n[1]);else if("IDB"==n[0]&&IDB)IDB.sub_funcs(n[1],a);else if("ARCHIVER"==n[0]&&archiver)archiver.sub_funcs(n[1],n[2]);else if("CLOSE"==n[0])close_connection(t);else if("MARK"==n[0]&&n[1]>0){var r=site.myself&&site2[site.nickname].mark_newer_posts2(site.myself.posts,n[1],pref.catalog.unmark_on_hover,!0)||null;r?scrollTo(0,r.offsetTop-site.header_height()):scrollTo(0,document.body.clientHeight-window.innerHeight),common_obj.thread_reader&&common_obj.thread_reader.mark_posts_from_parent(n[1])}else"OWN_POSTS"==n[0]?site2[n[1]].prep_own_posts_event_received?site2[n[1]].prep_own_posts_event_received(n[2]):site3[n[1]].own_posts=n[2]:"TRIAGE"==n[0]?catalog_obj&&null!=catalog_obj.catalog_func()&&catalog_obj.catalog_func().triage_exe_pipe(n[1]):"UIP"==n[0]?uip_tracker&&uip_tracker.annotate_from_catalog(n[1]):pref.test_mode[34]&&"ECHO"===n[0]&&setTimeout(function(){send_message(window.name?"parent":"meguca",["ECHO",n[1]])},5e3)}function close_all(){for(var e in ports)send_message(e,["CLOSE"])}function make_uip_tracker(){function e(){u=null,site2[site.nickname].uip_check(n,l)}function t(){g.disconnect()}function n(e,t){o(e,t,!0)}function a(e){0!=f.length?r():w+y>Date.now()+1e3*pref.uip_tracker.interval&&(clearTimeout(u),v=0,s())}function r(){for(var e=0;e<f.length;e++){var t=f[e],n=t[0],a=site2[site.nickname].uip_tgt_post(n);if(a){var r=document.createElement("span");if(r.innerHTML=" (<span>"+t[2]+"</span>)",t[4]&&r.childNodes[1].setAttribute("style",pref.uip_tracker.highlight_str),pref.uip_tracker.posts){var o=document.createElement("span");o.innerHTML="<span>"+t[1]+"</span>"+(t[5]&&pref.uip_tracker.deletion.show?"("+(pref.uip_tracker.deletion.link?t[5].map(function(e){return'<a href="#p'+e+'" class="quotelink">&gt;&gt;'+e+"</a>"}):t[5]).join()+")":"")+"/",t[3]&&o.childNodes[0].setAttribute("style",pref.uip_tracker.highlight_str),r.insertBefore(o,r.childNodes[1])}if(t[5]&&(pref.uip_tracker.deletion.name||pref.uip_tracker.deletion.addName||pref.uip_tracker.deletion.post))for(var s=0;s<t[5].length;s++)c({no:t[5][s]},pref.uip_tracker.deletion,!0);if(pref.uip_tracker.sage.page){var i=document.createElement("span");x[n]?(x[n].pn=i,x[n].his.length>0&&p(x[n])):x[n]={pn:i,his:[]},r.insertBefore(i,r.lastChild)}var l=site2[site.nickname].uip_post_num(a);l[l.length-1].appendChild(r),k||0!=e||(k=[r,t]),f.splice(e--,1)}}}function o(e,t,n){if(v++,200==t.status){var a=site2[site.nickname].parse_json_thread("response"in t?t.response:JSON.parse(t.responseText),n).posts,o=a.length,i=a[o-1].unique_ips||m[2],l=a[o-1].no;if(m[0]!=l||m[1]!=o||m[2]!=i){pref.debug_mode[31]&&console.log(new Date(t.date).toLocaleTimeString()+", "+l+", "+o+", "+i);for(var c={},p=0;p<a.length;p++)c[a[p].no]=null;pref.uip_tracker.auto_open&&0!=m[0]&&b(a,c,h);var _=a.length<m[1]||a[m[1]-1].no!=m[0];if(pref.uip_tracker.deletion.show||pref.uip_tracker.deletion.name||pref.uip_tracker.deletion.addName||pref.uip_tracker.deletion.post){var u=[];for(var p in h)void 0===c[p]&&(u[u.length]=p);pref.debug_mode[31]&&""!==u&&console.log("uip_deleted "+u)}m=[l,o,i,_,m[2]!=i,0!=u.length?u:null],f.push(m),v=0,h=c}r();var g=a[0]}404==t.status||g&&(g.archived||g.closed)?d():s()}function s(){pref.uip_tracker.on?(y=0!==y&&0!=v&&pref.uip_tracker.adaptive?v%8==0?y>=18e5?36e5:2*y:y:1e3*(pref.uip_tracker.interval>10?pref.uip_tracker.interval:10),u=setTimeout(e,y),w=Date.now()):d()}function i(e){if("page"!==e[0]){if("sage"===e[0])return void l({posts:e.map(function(e){return{no:e,email:"sage"}})});for(var t=k?k[1]:0!=f.length?f.splice(0,1)[0]:null,n=0;n<e.length;n+=3)f[f.length]=[e[n],e[n+1],e[n+2],!1,e[n+1]==e[n+2]||n>=3&&e[n+2]!=e[n-1],null];if(pref.uip_tracker.sage.page){for(var a={},n=0;n<f.length;n++)a[f[n][0]]=null;for(var n in x)void 0===a[n]&&f.splice(f.length-1,0,[n,"?","?",!1,!1,null])}if(t){var o=f[f.length-1];o[0]==t[0]&&o[1]==t[1]&&o[2]==t[2]||(f[f.length]=t.slice(0,3).concat(!1,o[2]!=t[2],null)),k&&k[0].parentNode.removeChild(k[0])}else m=f[f.length-1],k=!0;r()}else{var s=JSON.parse(e[1]);for(var n in s)x[n]={pn:null,his:s[n]}}}function l(e){for(var t in N)c(N[t])&&delete N[t];if(e&&e.posts){for(var t=e.posts.length-1;t>=1&&("sage"===e.posts[t].email&&void 0===T[e.posts[t].no]);t--)c(e.posts[t]);if(pref.uip_tracker.sage.patch_bug)for(var t=e.posts.length-1;t>=1;t--)if("sage"!==e.posts[t].email){if(null!==T[e.posts[t].no]&&!N[e.posts[t].no])break;pref.debug_mode[30]&&console.log("OVERDETECTION: "+e.posts[t].no),null===T[e.posts[t].no]&&c(e.posts[t],{name_str:"",addName_str:"OVERDETECTED_",post_str:"",__proto__:pref.uip_tracker.sage}),delete N[e.posts[t].no],delete T[e.posts[t].no]}if(pref.uip_tracker.sage.page&&void 0!==e.page){var n=e.posts[e.posts.length-1].no,a=_(e.page);x[n]?site2["4chan"].page_his_update(x[n].his,a)&&x[n].pn&&p(x[n]):x[n]={pn:null,his:[a]}}}}function c(e,t,n){var a=site2[site.nickname].uip_tgt_post(e.no);if(a){var r=site2[site.nickname].parse_funcs.post_html.pn_name({pn:a,__proto__:e});return t||(t=pref.uip_tracker.sage),t.name&&r.setAttribute("style",t.name_str),t.addName&&(r.textContent=t.addName_str+r.textContent),t.post&&a.setAttribute("style",t.post_str),n||(T[e.no]=null),!0}n||(N[e.no]=e)}function p(e){e.pn.textContent="/"+e.his.map(function(e){return Math.floor(e/15)+"."+e%15}).join("→")}function _(e){var t=e.split(".");return 15*parseInt(t[0],10)+parseInt(t[1],10)}function d(){t(),uip_tracker=null}var u,f=[],m=[0,1,1],h={};e();var g=new MutationObserver(a);g.observe(site.myself.pn,{childList:!0});var b=function(){function e(e,a){for(var r=a.response,s=0;s<r.length;s++)for(var i=0;i<r[s].threads.length;i++){var l=r[s].threads[i];n[l.no]={sub:l.sub,name:l.name,com:l.com},o<l.no&&(o=l.no)}t()}function t(){var e=new RegExp(pref.uip_tracker.auto_open_kwd||".*");for(var t in a){var s=n[t];s&&t>site.no&&void 0===r[t]?((s.sub&&s.sub.search(e)!=-1||s.name&&s.name.search(e)!=-1||s.com&&s.com.search(e)!=-1)&&(window.open(site2[site.nickname].make_url4([site.nickname,site.board,t,"thread_html"])[0],"_blank"),r[t]=t),delete a[t]):(o>t||a[t]--<=0)&&delete a[t]}}var n={},a={},r={},o=site.no;return function(n,r,o){for(var s=n.length-1;s>=1&&s>=pref.uip_tracker.auto_open_th&&void 0===o[n[s].no];)s--;if(s!=n.length-1){for(var i=document.createElement("span");++s<n.length;){i.innerHTML=n[s].com;for(var l=i.getElementsByTagName("a"),c=0;c<l.length;c++){var p=l[c].textContent.match(/>>([0-9]+)$/);p&&(p=p[1],void 0===r[p]&&void 0===o[p]&&(a[p]=3))}}t(),0!=Object.keys(a).length&&http_req.get("uip_auto",[site.nickname,site.board,site.no,"catalog_json"].join(),"",e)}}}(),v=0,y=0,w=0,k=null,x={},T={},N={};return{get_id:function(){return u},annotate_from_catalog:i}}function uip_tracker_init(){null===uip_tracker&&site.features.uip_tracker&&pref.features.uip_tracker&&site.isthread&&pref.uip_tracker.on?uip_tracker=make_uip_tracker():pref.uip_tracker.on||(uip_tracker&&clearTimeout(uip_tracker.get_id()),uip_tracker=null)}function make_thread_reader(){function e(e){e.addEventListener("click",site2[site.nickname].check_reply.remake_own_posts,!1),d&&e.addEventListener("click",d.get_my_posts_no,!1)}function t(e){e.removeEventListener("click",site2[site.nickname].check_reply.remake_own_posts,!1),d&&e.removeEventListener("click",d.get_my_posts_no,!1)}function n(e){if(e/=site2[site.nickname].parse_funcs.thread_html.time_unit,f=!0,_[0]&&_[0].time<e){for(var t=1;t<_.length&&_[t].time<=e;)t++;o({target:_[t-1].pn})}else{var n=site.nickname+(site2[site.nickname+"_live"]?"_live":""),a=site2[site.nickname].wrap_to_parse.get(document,site.nickname,site.board,"thread_html",{thread:site.no,parse_funcs:site2[n].parse_funcs.thread_html})[0],r=a.posts.length;if(_[0])for(;r>0&&a.posts[r-1].time>=_[0].time;)r--;for(var t=r;t>0&&a.posts[t-1].time>e;)t--;_=a.posts.slice(t,r).concat(_)}}function a(e,t){for(var n=e.length-1;n>=0;n--)_.push(e[n]);p[c][19][1]=(4294901760&p[c][19][1])+_.length,d&&d.update_own_posts(e,t)}function r(e){if(this===window&&f)return void(f=!1);if(0!=_.length){var t=brwsr.document_body.scrollTop;t<=m||(m=t,t+=window.innerHeight,o(e,t))}}function o(e,t){for(var n;0!=_.length&&!(t&&_[0].pn.offsetTop+_[0].pn.offsetHeight>t);){n=_.shift().time*site2[site.nickname].parse_funcs.post_json.time_unit}if(n){p[c][19][1]=_.length;for(var a=0;a<_.length;a++)_[a].reply_to_me&&(p[c][19][1]+=65536);notifier.favicon.set(p),pref.thread_reader.sync&&window.opener&&send_message("parent",["TRIAGE",[c,"TRACK",p[c][19][1],!1,n]])}}function s(){var e=this.name.split(","),t=parseInt(e[0].replace(/[^\(]*\(/,""),10),n=parseInt(e[1].replace(/\).*/,""),10);i(u.str[t][n],u.str[t][n+2])}function i(e,t){send_message("parent",["TRIAGE",[c,e,t,!0,site2.DEFAULT.check_reply.get_checked_time(p[c][19])]]),pref.thread_reader.triage_close&&window.close()}function l(n,a){return!n&&pref.thread_reader.own_posts_tracker&&a?(e(a),n=a):!n||pref.thread_reader.own_posts_tracker&&a||(t(n),n=null),n}var c=site.nickname+site.board+site.no,p={};p[c]=[],p[c][19]=liveTag.mems.init({domain:site.nickname,board:site.board,no:site.no}).wt;var _=[],d=function(){function e(){a=!0}function t(e,t){if(0==e.length)return void(a=!1);if(a){var n=pref.script_prefix+".own_posts."+site.board+site.no,r=JSON.parse(localStorage[n]||"[]"),o=[];if(t)for(var s=0,i=e.length-1;s<r.length;){for(;i>0&&r[s]>e[i].no;)i--;r[s]===e[i].no&&(o[o.length]=e[i]),s++}else o[0]=e[e.length-1],r[r.length]=o[0].no,localStorage[n]=JSON.stringify(r);for(var s=0;s<o.length;s++){var l=o[s].parse_funcs_html.pn_name(o[s]);"plain"===pref.thread_reader.show_own_post_by?l.parentNode.insertBefore(document.createTextNode(" (You)"),l.nextSibling):l.innerHTML=l.innerHTML+" (You)"}a=!1}for(var s=0;s<e.length;s++)site2[site.nickname].check_reply.add_you(e[s])}function n(){"post"===this.name&&e()}var a=!0;return{update_own_posts:t,get_my_posts_no:e,event_submit:n}};pref.thread_reader.own_posts_tracker?(d=d(),site.components.postform_submit||window.addEventListener("submit",d.event_submit,!1)):d=null;var u,f=!1,m=0,h=document.createElement("div");h.innerHTML='<div><button name="thread_reader.buttons.B" type="button">B</button><button name="thread_reader.buttons.UB" type="button">UB</button>'+(window.opener?'<button name="thread_reader.buttons.X" type="button">X</button><button name="thread_reader.buttons.v" type="button">v</button>':"")+"</div>";var g=h.getElementsByTagName("button");g["thread_reader.buttons.B"].onclick=function(){common_func.modify_bookmark(c,!0)},g["thread_reader.buttons.UB"].onclick=function(){common_func.modify_bookmark(c,!1)},window.opener&&(g["thread_reader.buttons.X"].onclick=function(){i("KILL","")},g["thread_reader.buttons.v"].onclick=function(){i("TIME","")});var b="function"==typeof site.embed_to.bottom?site.embed_to.bottom():site.embed_to.bottom;b.parentNode.insertBefore(h,b),window.opener&&pref.thread_reader.triage&&(u=new common_func.Triage(pref.catalog_triage_str,{onclick:s,wheelpatch:!1,name:"thread_reader_triage"}),h.appendChild(u.pn)),pref_func.tooltips.add_root(h),pref.notify.favicon&&window.addEventListener("scroll",r,!1);var v=l(null,site.components.postform_submit),y=l(null,site.components.postform_submit2);return window.addEventListener("storage",site2[site.nickname].check_reply.remake_own_posts,!1),pref.test_mode[116]&&"4chan"===site.nickname&&function(){var e=new WeakMap;site2[site.nickname].catalog_get_native_area().addEventListener("click",function(n){var a=n.target;if("A"===a.tagName&&"embed"==a.dataset.cmd){var r=e.get(a);r?(r.parentNode?r.remove():e.get(r).remove(),e.delete(r),e.delete(a)):t.observe(a.parentNode,{childList:!0})}},!1);var t=new MutationObserver(function(n){var a=n[0].addedNodes[0],r=site2[site.nickname].make_tack();r.onclick=cnst.tack_float_nSblgs,e.set(a.previousElementSibling,r),e.set(r,a),a.parentNode.insertBefore(r,a),t.disconnect()})}(),pref.test_mode[120]&&(pref.IDinfo.ID||pref.IDinfo.flag)&&function(){function e(e){pref.IDinfo.ID&&i&&t(c,e,"pn_id","id","","",pref.IDinfo.nofIDs,null,null,pref.IDinfo.IDop),pref.IDinfo.flag&&l&&t(p,e,"flag","country","(",")",pref.IDinfo.nofFlags,pref.IDinfo.IDFlag&&_,"id"),pref.IDinfo.trip&&t(d,e,"pn_trip","trip","(",")",pref.IDinfo.nofTrips),pref.IDinfo.name&&t(u,e,"pn_name","name","(",")",pref.IDinfo.nofNames,pref.IDinfo.nameTrip&&f,"trip")}function t(e,t,r,o,s,i,l,c,p,_){var d={};if(t)for(var u=0;u<t.length;u++){var f=t[u],m=f[r];if(m){var h=f[o];n(e,h,m,d),c&&f[p]&&(void 0==c[h]&&(c[h]={}),c[h][f[p]]=null)}}else for(var u in e)d[u]=0;a(e,d,s,i,l,c,_)}function n(e,t,n,a){var r={pn:n,c:Object.keys(e).length+(e[t]?0:1)};e[t]?e[t].push(r):(r.m=!0,e[t]=[r]),void 0===a[t]&&(a[t]=e[t].length-1)}function a(e,t,n,a,r,o,i){for(var l in t)for(var c=o&&o[l]&&Object.keys(o[l]).length||0,p=i&&s===l?"OP:":"",_=e[l],d=0;d<_.length;d++){var u=(n||"")+p+(d+1)+"/"+_.length+(c?"/"+c:"")+(r?"/":a);if(d<t[l])_[d].pn.textContent=u;else{var f=document.createElement("span");f.innerHTML=u+(r?"<span"+(_[d].m?' style="color:red"':"")+">"+_[d].c+"</span>"+a:""),_[d].pn=_[d].pn.parentNode.insertBefore(f,_[d].pn.nextSibling).firstChild}}}function r(t,n){i&&pref.IDinfo.ID^"IDinfo.ID"===n&&o(c),l&&pref.IDinfo.flag^"IDinfo.flag"===n&&o(p,!0),
pref.IDinfo.name^"IDinfo.name"===n&&o(u,!0),pref.IDinfo.trip^"IDinfo.trip"===n&&o(d,!0),e(null)}function o(e,t){for(var n in e)for(var a=0;a<e[n].length;a++){var r=e[n][a].pn.parentNode;e[n][a].pn=r.previousSibling,r.parentNode.removeChild(r)}}var s=site.myself.parse_funcs.id(site.myself),i=!pref.IDinfo.auto||s,l=!pref.IDinfo.auto||site.myself.posts[0].flag;if(i||l||pref.IDinfo.trip||pref.IDinfo.name){var c={},p={},_={},d={},u={},f={};e(site.myself.posts);var m=site2.DEFAULT.wrap_to_parse.prep_pfunc(site.nickname,site.board,"post_html");new MutationObserver(function(t){for(var n=[],a=0;a<t.length;a++)if(t[a].addedNodes)for(var r=0;r<t[a].addedNodes.length;r++)n[n.length]={pn:t[a].addedNodes[r],__proto__:m};e(n)}).observe(site.myself.pn,{childList:!0}),pref_func.settings.onchange_funcs["IDinfo.*w/"]=r}}(),{destroy:function(){return pref_func.tooltips.remove_root(h),observer.disconnect(),window.removeEventListener("storage",site2[site.nickname].check_reply.remake_own_posts,!1),v&&t(v),y&&t(y),null},setup_submit2:function(){y=l(y,site.components.postform_submit2)},own_posts_tracker:d,updated:a,mark_posts_from_parent:n}}function thread_reader_init(){null===common_obj.thread_reader&&site.features.thread_reader&&pref.features.thread_reader&&"thread"===site.whereami&&pref.thread_reader.use?common_obj.thread_reader=make_thread_reader():!pref.thread_reader.use&&common_obj.thread_reader&&(common_obj.thread_reader=common_obj.thread_reader.destroy())}function make_catalog_obj(e){function t(){d=null===d?s():d.destroy()}function n(){i=pref.catalog.embed&&"catalog"===site.whereami||pref.catalog.embed_archive&&"archive"===site.whereami,l=pref.catalog.embed_page&&"page"===site.whereami,c=pref.catalog.embed_frame&&"frame"===site.whereami,p=i?"catalog":l?"page":pref.thread.embed&&"thread"===site.whereami?"thread":"float",_="float"!==p,cataLog.embed_mode=p}function a(e,t,n){var a=!0;void 0===n&&(n={cs:{},ci:{}},a=!1);for(var o in e){var s=e[o].tags;if(s){for(var i=cnst.name2domainboardthread(o,!0),l={},c=s.length-1;c>=0;c--)void 0===l[s[c]]?l[s[c]]=null:s.splice(c,1);if(s.length<=pref.catalog.tag.max)for(var p=pref.catalog.tag.ignore<s.length?pref.catalog.tag.ignore:s.length,c=0;c<p;c++)for(var _ in n){var d="cs"===_?s[c]:s[c].toLowerCase();void 0===n[_][d]?n[_][d]={num:1,mem:{}}:n[_][d].num++,n[_][d].mem[i[0]+i[1]]?n[_][d].mem[i[0]+i[1]]++:n[_][d].mem[i[0]+i[1]]=1}}}if(!a)return r(n,t,{cs:[],ci:[]})[0]}function r(e,t,n){for(var a in e){for(var r in e[a])for(var s="cs"===a?r:r.toLowerCase(),i=0;i<n[a].length;i++){var l="cs"===a?n[a][i].key:n[a][i].key.toLowerCase();if(s===l){for(var c in e[a][r].mem)n[a][i].mem[c]=e[a][r].mem[c];n[a][i].num=0;for(var c in n[a][i].mem)n[a][i].num+=n[a][i].mem[c];delete e[a][r];break}}for(var r in e[a])n[a].push({key:r,num:e[a][r].num,mem:e[a][r].mem});n[a].sort(function(e,t){return t.num!=e.num?t.num-e.num:t.key>e.key?-1:1})}for(var a=0;a<n.ci.length;a++)for(var p=n.ci[a].key.toLowerCase(),r=0;r<n.cs.length;r++)if(p===n.cs[r].key.toLowerCase()){n.ci[a].key=n.cs[r].key;break}return o(n,t)}function o(e,t){for(var n=pref.catalog.filter.tag_ci?e.ci:e.cs,a="",r=0;r<n.length;r++){a=a+'<input type="checkbox"'+t+"> "+(n[r].num+": "+n[r].key)+"<br>"}return[a,e]}function s(){function e(e){cnst.tack_float_nSblgs(e,!0),e.currentTarget.previousSibling.style.display="none"}function n(e){cnst.tack_dock_e2tack(e).previousSibling.style.display=null,cnst.tack_dock_nSblgs(e)}function r(){pref.catalog.auto_save_filter&&"thread"!==p&&$e.save(),window.removeEventListener("beforeunload",r,!1)}function o(){et=_?site2[site.nickname].catalog_get_native_area():Me,cataLog.parent=et,Ue.ppn=et}function s(e){var t;if(("graphic"!==pref.catalog.text_mode.mode||"catalog_size_text_width"!==e.name&&"catalog_size_text_height"!==e.name)&&("text"!==pref.catalog.text_mode.mode||"catalog_size_width"!==e.name&&"catalog_size_height"!==e.name)){t=e.name.substr(e.name.lastIndexOf("_")+1);var n=0==pref[e.name]?"":pref[e.name]+"px";for(var a in Xe)Xe[a][0].style[t]=n}}function i(e,t){var n=Date.now()-t;st.value=new Date(n).toLocaleString(),pref_func.apply_prep(st,!0,!0)}function l(e){ut.off(),pref_func.tooltips.remove_root(rt),e||d()}function d(){var e=new common_func.Triage(pref.catalog_triage_str,{onclick:f,wheelpatch:_?null:u,name:"pn_catalog_triage"});rt=e.pn,ot=e.str,rt.style.position="absolute",pref_func.tooltips.add_root(rt),rt.onmouseover=ut.triage_in,pref.test_mode[127]&&(rt.onmouseout=ut.triage_out),pref.triage.hide_toggle||(e.format_tgt=null),ut.set_trg(e)}function u(e){ut.off(),pref_func.tooltips.hide(),e.preventDefault();var t=document.createEvent("MouseEvents");t.initMouseEvent(e.type,e.canBubble,e.cancelable,e.view,e.detail,e.screenX,e.screenY,e.clientX,e.clientY,e.ctrlKey,e.altKey,e.shiftKey,e.metaKey,e.button,e.relatedTarget),et.dispatchEvent(t)}function f(){var e=this.name.split(","),t=parseInt(e[0].replace(/[^\(]*\(/,""),10),n=parseInt(e[1].replace(/\).*/,""),10);h(ut.get_triaged_thread_name(),ot[t][n],ot[t][n+2],!0)}function m(e){var t=e[0],n=liveTag.mems.getFromName(t);(Xe[t][8][4]||Xe[t][8][0])<e[4]?n.usWT=e:n.usWT&&(n.usWT=null),h(e[0],e[1],e[2],e[3],e[4])}function h(e,t,n,a,r){if(["ARC","ARC1","UARC"].indexOf(t)!=-1)return void(pref.test_mode[67]||archiver.start_1(t,liveTag.mems.getFromName(e),!0));var o=g(e,t,n,a,r);e=o.name,Xe[e]&&(o.attr&&Q(e,Xe[e][0]),o.ex&&(Xe[e][9]=ee(e))),o.watch&&(ht.idx_reorder(e),pref[p].mark_new_posts&&"catalog"!==p&&mt.update(e)),(o.ex||o.watch)&&(Nt(e),ut.off()),ut.get_trg().format_tgt&&ut.format_buttons(o.name),pref_func.tooltips.hide()}function g(e,t,n,a,r){"UNWATCH"===t&&common_func.modify_bookmark(e,!1);var o={ex:!1,attr:!1,watch:!1,name:e};if("GO"===t)return z(e,"force"),o;if("UNDO"!==t){a&&(dt.length>=4*pref.catalog_triage_hist&&dt.splice(0,4),dt.push(arguments),dt.push(lt.value),dt.push(ct.value),dt.push(it.value));var s=new RegExp("(^|,)"+e.replace(/\+/,"\\+")+"([\\^@!][^,\n]*)*(,|\n|$)","mg");if(["KILL","TIME","WATCH","UNWATCH","TRACK","DELETE","KILL_N","TIME_N"].indexOf(t)!=-1){r||(r="DELETE"!==t?Xe[e][8][4]||Xe[e][8][0]:0);var i=r%1e3,l="@"+new Date(r).toLocaleString()+(r%1e3==0?"":"."+i),c=it.value;if("UNWATCH"===t&&c.indexOf(s)==-1)var p=!0;c=c.replace(s,","),"DELETE"!==t&&("WATCH"===t||"TRACK"===t||"TIME"===t||"TIME_N"===t?(c+=","+e+l+"\n",X(e,r,"TRACK"===t&&n)):(p&&(c+=","+e+"@0\n"),X(e,null))),it.value=c.replace(/,,+/g,",").replace(/^,/g,"").replace(/\n,/g,"\n").replace(/\n\n+/g,"\n").replace(/^\n/,""),o.watch=!0}if(["KILL","TIME","NONE","DELETE","UNWATCH","KILL_N","TIME_N"].indexOf(t)!=-1){var _=lt.value.replace(s,",");["KILL","KILL_N","TIME","TIME_N"].indexOf(t)!=-1&&(_=_+","+e+("TIME"===t||"TIME_N"===t?l:"")+"\n"),lt.value=_.replace(/,,+/g,",").replace(/^,/g,"").replace(/\n,/g,"\n").replace(/\n\n+/g,"\n").replace(/^\n/,""),o.ex=!0}if(["KILL","TIME","NONE","DELETE","ATTR","SHOW","UNSHOW","STICKY","UNSTICKY"].indexOf(t)!=-1){var d;if("DELETE"===t)d="";else{var d=ct.value.match(s);d=d?d[0]:e;var u={val_obj2:null,val_obj3:null};if(pref_func.str2obj2(u,"val_obj2",d),"ATTR"===t&&n&&pref_func.str2obj2(u,"val_obj2",e+"^"+n,!0),u=u.val_obj2[e],u.style||(u.style={}),u.cmd||(u.cmd={}),"SHOW"===t?u.cmd.show=!0:"UNSHOW"===t?delete u.cmd.show:"STICKY"===t?Xe[o.name][16].systemSticky?delete u.cmd.sticky:u.cmd.sticky=!0:"UNSTICKY"===t&&(Xe[o.name][16].systemSticky?u.cmd.sticky=!1:delete u.cmd.sticky),d=e,["KILL","TIME","NONE"].indexOf(t)!=-1)""!==n&&(d+="^"+n);else{var f=Object.keys(u.style);if(0!=f.length){for(var m=0;m<f.length;m++)f[m]+=":"+u.style[f[m]];d+="^"+f.join(";")}}if(f=Object.keys(u.cmd),0!=f.length){for(var m=0;m<f.length;m++)u.cmd[f[m]]===!1&&(f[m]+=":false");d+="!"+f.join(";")}d=d===e?"":d+"\n"}d=ct.value.replace(s,",")+d,ct.value=d.replace(/,,+/g,",").replace(/^,/g,"").replace(/\n,/g,"\n").replace(/\n\n+/g,"\n").replace(/^\n/,""),o.attr=!0}}else if(0!=dt.length){o.watch=it.value!==dt[dt.length-1],o.attr=ct.value!==dt[dt.length-2],o.ex=lt.value!==dt[dt.length-3],it.value=dt.pop(),ct.value=dt.pop(),lt.value=dt.pop();var h=dt.pop();o.name=h[0]}if("DELETE"===t){if(null===n)return o;for(;0!=n.length;){var b=n.shift(),v=g(b,t,null,a,r);o.watch|=v.watch,o.ex|=v.ex,o.attr|=v.attr}}if("WATCH"===t&&pref.archive.store_watched){var y=liveTag.mems.getFromName(e);y.archived||archiver.start_1("ARC",y,!0)}return o.watch&&pref_func.apply_prep(it,!0),o.ex&&pref_func.apply_prep(lt,!0),o.attr&&pref_func.apply_prep(ct,!0),"UNDO"!==t||!o.watch&&"KILL"!==h[1]||Xe[o.name]&&(site2.DEFAULT.check_reply.set_watch_time(Xe[o.name][19],L(o.name,Xe[o.name][8][1],null,!0),o.name),nt.scan_init("triage_undo",[o.name],{refresh:!0,priority:8})),o}function b(e,t,n,a){pref.test_mode[7]||pref.test_mode[8]||(pref.test_mode[9]||(pref.test_mode[10]||(pref.test_mode[11]||n.fileinfo||site2[t].remove_files_info(e),pref.test_mode[12]||pref[p].t2h_num_of_posts>=0&&site2[t].remove_posts(e,n.posts?pref[p].t2h_num_of_posts:0),pref.test_mode[13]||n.contents&&site2[t].format_thread_contents(e)),n.layout&&site2[t].format_thread_layout(e),n.style&&site2[t].format_thread_style(e),site2[t].format_thread_always(e)),pref[p].localtime&&site2[t].localtime(e))}function v(e,t,n,a){var r=F(a,pref[p].mark_new_posts,pref[p].mark_new_posts,pref[p].mark_new_posts);r>0&&site2[t].mark_newer_posts(e,r),pref[p].format.thumb.resize&&site2[t].format_remove_tn_area_size(e)}function y(){this.removeEventListener("load",common_func.image_resize1_onload,!1),common_func.image_resize(this,pref.catalog_size_tn1_width,pref.catalog_size_tn1_height)}function w(){this.removeEventListener("load",common_func.image_resize2_onload,!1),common_func.image_resize(this,pref.catalog_size_tn2_width,pref.catalog_size_tn2_height)}function k(e,t,n,a){return site2[e.domain].update_posts_merge_prep(t,e.pd,n===!1?t.length-1:n===-1?-1:n,!0)}function x(e,t,n,a){var t=t,r=e.key;pref.test_mode[28]||site2[e.domain].preprocess_doc&&!a&&site2[e.domain].preprocess_doc(e.pn),pref.test_mode[26]&&(a||"html"!==e.type_data||(e.pn=document.adoptNode(e.pn))),pref.test_mode[27]&&(a||"html"!==e.type_data||(e.pn=document.importNode(e.pn,!0)));var o=!1,s=Xe[r],i=[e.time_bumped,e.time_created,e.nof_posts,e.nof_files,e.time_posted];s&&s[16].needs_update&&(s[16].needs_update===!0?(s[7]&&(e.page=s[7].page),Ke.remove_thread(r),s=void 0):delete s[16].needs_update);var l=e.lth;if(void 0==s&&(pref.test_mode[19]&&e.parse_funcs_html.th_init&&e.parse_funcs_html.th_init(e),o=!0,Xe[r]=[!!a&&e.pn,a&&"archive"!==site.whereami,pref.test_mode[127]?"page"!==p&&pref.test_mode[110]?[E,j]:[ut.thread_in,null]:null,null,null,[],null,null,i,[!0,0,!0,0],null,null,null,t,e.page,0,{dbt:common_func.name2domainboardthread(r,!0),parse_funcs:e.parse_funcs,systemSticky:e.sticky,type_html:e.type_html,domain_html:e.domain_html,parse_funcs_html:e.parse_funcs_html,icon_sticky:null,icon_show_always:null,show_always:null,th:e,lth:l,op:e.posts&&e.posts[0],__proto__:ft},null,e.type_html,null,e.sticky,!1,{},null,null,null],s=Xe[r],s[19]=l.wt,"catalog"===p&&e.domain===site.nickname||!("KC"===e.domain&&"catalog"===e.type_source||e.posts[0].editing)?"archive"===e.type_source&&(s[16].needs_update=!0,scan.list_nup.add_scan(e.key)):(s[16].needs_update=!0,"catalog"===e.type_source&&scan.list_nup.add(e.key)),pref.test_mode[115]&&pref.catalog.filter.auto_list.use)){var c=pref.catalog.filter;if(!pref_func.merge_obj5_1(null,c.list_obj2,e.key)&&!pref_func.merge_obj5_1(null,c.watch_list_obj2,e.key)&&!pref_func.merge_obj5_1(null,c.attr_list_obj2,e.key)){var _=pref_func.merge_obj5a(e,pref.catalog.filter.auto_list.obj7,null);_&&At.auto_list(e,_)}}e.parse_funcs.posts_full&&e.parse_funcs.posts_full(e),i[0]||(i[0]=s[8][0]),i[4]||(i[4]=s[8][4]<i[0]?i[0]:s[8][4]?s[8][4]:site2[e.domain].check_reply.get_checked_time(s[19])),s[8]=i,a&&(Xe[r][16].posts=a.posts_shown),("page"===e.type_source||"4chan"===e.domain&&"catalog_json"===e.type_parse)&&(Xe[r][16].t2h_page=e.posts.length-1),s[16].expand_posts&&(s[16].expand_num<=e.nof_posts||"thread"===e.type_source)&&(s[16].expand_posts=!1);var d=("page"!==e.type_source||"page"!==(s[16].t2h_sel||pref[p].t2h_sel))&&s[16].get_t2h_num_of_posts();return d!==!1&&o&&(d<0||d+1>e.posts.length)&&e.posts.length<e.nof_posts&&"page"===p&&(s[16].expand_posts=!0,scan.list_nup.add_scan(e.key)),e.parse_funcs.has_posts&&(e.posts=s[16].recent_posts(d,e.posts)),!e.page&&s[16].th&&(e.page=s[16].th.page),!o&&e.parse_funcs.has_posts&&(s[16].th=e),(pref.test_mode[49]||"no"===pref[p].t2h_sel)&&!site2[site.nickname].historyAPI||s[7]&&!e.parse_funcs.has_posts||(s[7]=e),"no"===pref[p].t2h_sel&&(e.posts=e.posts.slice(0,1)),l.th=e,s[9][2]=null,s[9]=ee(r,!0),Q(e.key,s[0]),(a||s[16].expand_posts&&s[1]&&!pref.catalog.filter.kwd.posts_active||pref.test_mode[36])&&N(s,o,a,null,e),"meguca"===e.domain&&(l.ed_t?l.ed_u=e.replyTime:l.ed_u&&(l.ed_u=void 0)),pref.test_mode[114]&&De.prototype.Clgs.length>=2&&Ee(De.prototype.Clgs[1],r),ht.idx_reorder(r)}function T(e,t,n,a,r,o){var s=L(e,n,a,!0);s>0?site2.DEFAULT.check_reply.set_watch_time(o,s,e):0===s&&"thread"===t&&pref.catalog.auto_watch?site2.DEFAULT.check_reply.set_watched_to_last(o,a||n,e):site2.DEFAULT.check_reply.set_unwatch(o)}function N(e,t,n,a,r){var r=e[16].th||r;if(site2[r.domain].wrap_to_parse.posts(r),(t||"page"===p||"thread"===p)&&mt.prepare_html(r,t),t&&C(e,t,n,a,r),e[0]&&I(r,r.key,t,n),pref.test_mode[124]&&"catalog"===p&&r.parse_funcs.has_posts){var o=r.lth;o.ta&&o.ta.posts.length<r.posts?e[16].posts=r.posts:e[16].posts&&(e[16].posts=null)}e[16].th=null}function C(e,t,n,a,r){if(t){var o=e[0];if(e[3]=[o.innerHTML,r.domain],o.name=r.key,gGEH.pns_all_keys.set(o,r.key),("float"===p||r.domain!==site.nickname&&!pref.catalog.mimic_base_site)&&(o.style.width=("text"===pref.catalog.text_mode.mode?pref.catalog_size_text_width:pref.catalog_size_width)+"px",o.style.height=("text"===pref.catalog.text_mode.mode?pref.catalog_size_text_height:pref.catalog_size_height)+"px",o.style.float="left",o.style.overflow="hidden"),o.style||(o.style={}),pref.test_mode[127]&&e[0].addEventListener("mouseover",e[2][0],!1),pref.test_mode[104]){common_func.dom_addEventListener(e[5],r.pn,"click",U),common_func.dom_addAttribute(r.pn,"class",pref.script_prefix+"_thread");var s=r.parse_funcs_html.tn_as(r);if("page"!==p&&"thread"!==p)for(var i=0;i<s.length;i++)s[i].onclick=D,common_func.dom_addAttribute(s[i],"class",pref.script_prefix+"_thumbnail")}var l=r.parse_funcs_html.tn_imgs(r);if(pref[p].format.thumb.resize)for(var i=0;i<l.length;i++)l[i].addEventListener("load",0==i?y:w,!1);if(Q(r.key,e[0]),"float"===p&&"text"===pref.catalog.text_mode.mode){var c=document.createElement("span");c.innerHTML=(pref.catalog.text_mode.sub&&r.sub?"&emsp;"+r.sub:"")+(pref.catalog.text_mode.name&&r.name?"&emsp;"+r.name:"")+(pref.catalog.text_mode.com&&r.com?"&emsp;"+r.com:"");var _=r.footer,d=document.createElement("span");d.innerHTML=_.innerHTML,r.footer=d,r.pn.innerHTML="",r.pn.appendChild(r.footer),r.pn.appendChild(c),e[18]="text"}e[24]=Se.prep_footer3(r,e[24])}}function I(e,t,n,a,r){site2.DEFAULT.check_reply.set_own_posts(e);var o,s=n||a&&"meguca"===site.nickname;if(s&&("page"===e.type_html||"thread"===e.type_html)){var i=e.parse_funcs_html.get_thread_links(e.pn?e:{pn:Xe[t][0],__proto__:e});if(i)for(var l=0;l<i.length;l++)i[l].onclick=R}if("page"===p||"thread"==p?(o=mt.update_posts_in_page(e,t,s,a),pref[p].popup&&"catalog"!==e.type_html&&site2[e.domain].popups_add(Xe[t][16].posts,e,a&&pref[p].env.popup_native&&!pref[p].env.event_dynamic,a,!pref.catalog.filter.kwd.posts_active)):pref.test_mode[124]&&s&&(Xe[t][16].posts=e.posts,o=e.posts),s||"catalog"!==e.type_source&&"float"===p&&(Xe[t][3][0]=e.pn?e.pn.innerHTML:null),pref.test_mode[124]){var c=n?0:1;if("page"==p&&"json"===e.type_data){e.domain_html=site.nickname,e.parse_funcs_html=site2[e.domain_html].parse_funcs.page_html;for(var l=c;l<e.posts.length;l++)e.posts[l].pn||(e.posts[l].pn=site2[e.domain_html].post_json2html(e.posts[l],e.board));for(var l=c;l<e.posts.length;l++)e.posts[l].tn_imgs=e.parse_funcs_html.tn_imgs(e.posts[l]);o=e.posts.slice(c)}}pref[p].hide_posts_without_images&&mt.hide_posts_without_images(e,t),"catalog"!==p&&mt.update_draw(t,Xe[t][16].posts),A(e,o,a)}function A(e,t,n){if(t&&("page"===p||"thread"===p)){var a=!pref[p].env.expand_thumbnail_inline_native||!n||pref[p].expand_thumbnail_inline_all_after&&pref[p].env.event_dynamic,r=pref[p].expand_thumbnail_initial,o=pref[p].thumbnail.inline.ondemand;if(a||r||!pref.test_mode[104])for(var s=0;s<t.length;s++){var i=e.parse_funcs_html.tn_imgs(t[s]);if(i)for(var l=0;l<i.length;l++)pref.test_mode[104]?i[l].onclick=gt.expand_thumbnail_inline:a||pref[p].env.event_dynamic&&e.domain===site.nickname||Bt.prototype.blacklist_click.add(i[l]),r&&(o?(gt.expand_thumbnail_queue_add(i[l]),r=!1):gt.expand_thumbnail_inline.call(i[l],null,!0))}}}function L(e,t,n,a){var r=F(e,pref.catalog.filter.time_watch||pref.catalog.filter.time_watch_creation,!0,!0,a);return a&&r<0?-r:n&&r>n?0:!pref.catalog.filter.time_watch&&pref.catalog.filter.time_watch_creation&&r>t?0:r}function E(e){oe(e,this.name),ut.thread_in(e)}function j(e){oe(e,this.name)}function B(){ht.idx_re_sort()}function S(e){""==Xe[e][0].style.width?(pref.catalog_expand_with_hr&&"catalog"!==p&&J(e,"shrink"),Xe[e][0].style.width=pref.catalog_size_width+"px",Xe[e][0].style.height=pref.catalog_size_height+"px"):(Xe[e][0].style.width="",Xe[e][0].style.height="",pref.catalog_expand_with_hr&&"catalog"!==p&&J(e,"add"))}function O(e){for(;e&&!e.name;)e=e.parentNode;return e&&e.name}function D(e){"none"!==pref[p].click&&(e.preventDefault(),"entire"!==pref[p].click_area&&z(O(e.target),e.target.classList.contains(pref.script_prefix+"_link")?e.target.getAttribute("href"):null))}function U(){"entire"===pref[p].click_area&&z(this.name)}function z(e,t){t?q("force"===t?null:t,e):"open"===pref[p].click?q(null,e):"catalog"!==Xe[e][18]&&"expand"===pref[p].click&&S(e)}function R(e){e.preventDefault(),this.href&&q(this.href,O(this))}function M(e,t){for(var n=0;n<t.length;n++){var a=t[n][0],r=t[n][1],o=function(){q(r,e),"expand"===pref[p].click&&S(e)};a.addEventListener("click",o,!1),t[n][1]=o}return t}function H(e){for(var t=0;t<e.length;t++)e[t][0].removeEventListener("click",e[t][1],!1);return null}function F(e,t,n,a,r){if(a){var o=pref_func.merge_obj5(e,pref.catalog.filter.watch_list_obj2,{hit:!1});if("time"in o)return r?-o.time:o.time}if(n){if("time"in(o=pref_func.merge_obj5(e,pref.catalog.filter.list_obj2,{hit:!1})))return o.time;if(o.hit)return 0}return t&&""!==pref.catalog.filter.time_str?Date.parse(pref.catalog.filter.time_str):0}function q(e,t){var n=common_func.fullname2dbt(t);if(Xe[t][16].archiveFile)e=site2[pref.archive.open_local?site.nickname:n[0]].make_url4([site.nickname,site.board,"0","page_html"])[0];else if(null===e&&(e=site2[n[0]].make_url4(common_func.name2dbt(t))[0],"no"!==pref.catalog_open_last50)){var a=document.createElement("div");a.innerHTML=site2[n[0]].short_link(t,Xe[t][8][2],null,"","");for(var r=a.getElementsByTagName("a"),o=0;o<r.length;o++)if("exist"===pref.catalog_open_last50||!(786432&Xe[t][19][0])||parseInt(r[o].textContent,10)>(65535&Xe[t][19][1])){e=r[o].getAttribute("href");break}}var s=site.embed_frame_win?site.embed_frame:"named"===pref.catalog_open_where?t+(Xe[t][16].archiveFile?"A":""):"_blank"===pref.catalog_open_where?t+"_"+Date.now():pref.catalog_open_where,i=pref[p].mark_new_posts?L(t,Xe[t][8][1],null,!0):0,l=["MARK",i];if(site2[site.nickname].historyAPI&&site2[n[0]].historyAPI&&pref.pref2.meguca.historyAPI){if(site2[site.nickname].historyAPI_blocking)return;send_message_emu.push(l)}else{if(send_message(s,l,window.open(e,s)),pref.uip_tracker.on){var c=liveTag.mems.getFromName(t);pref.uip_tracker.sage.annotate&&(pref.uip_tracker.sage.annotate_page&&c.pgh&&send_message(s,["UIP",["page",JSON.stringify(c.pgh)]]),c.sg&&c.sg.size&&send_message(s,["UIP",["sage"].concat(Array.from(c.sg))])),pref.uip_tracker.annotate&&c.sID&&c.sID.h&&send_message(s,["UIP",c.sID.h])}if(Xe[t][16].archiveFile){var _=Xe[t][16].archiveFile;send_message(s,["ARCHIVER",["SUB_INIT","IDB"===_?{IDB:!0,domain:n[0],board:pref.test_mode[80]?n[1].slice(0,-5)+"/":n[1],no:n[2]}:{name:_.name,size:_.size,lastModified:_.lastModified,files_sel:pref.archive.files_sel}]])}}pref.catalog.auto_watch&&h(t,"WATCH","",!0)}function X(e,t,n){null!==t?site2.DEFAULT.check_reply.set_watched_to_last(Xe[e][19],t,e,n):site2.DEFAULT.check_reply.set_unwatch(Xe[e][19]),pref.liveTag.style.use&&liveTag.update_ur(e,0,!0),Ke.footer.update_force(e,pref.catalog.footer.flag),pref.notify.favicon&&notifier.favicon.set(Xe)}function W(){wt=null,Ue.drawn_idx!==!0?Nt():cataLog.catalog_obj2.lazy_draw&&cataLog.catalog_obj2.lazy_draw(),cataLog.DIH.expand_thumbnail_on_demand()}function P(e){return e||(e=1.5),wt||(wt={scrollTop:_t===window?brwsr.document_body.scrollTop:_t.scrollTop,innerHeight:_t===window?window.innerHeight:_t.clientHeight}),wt.scrollTop+wt.innerHeight*e}function K(){return _?brwsr.document_body.scrollTop:et.scrollTop}function Y(e,t,n,a){for(var r="drawn_idx:"+e+", drawn_y:"+t+", ref_count:"+n+" ",o=0;o<a.length;o++)Xe[a[o]]&&!Xe[a[o]][1]||(r+=a[o]+", ");return r+="::: "+JSON.stringify(a)}function G(e){var t=et.childNodes.length,n=pref.script_prefix+"_hs";return e<t&&et.childNodes[e].className===n&&e++,e}function J(e,t){if("catalog"!==p){var n=Xe[e][0],a=pref.script_prefix+"_hs";if("add"===t&&""===n.style.width&&""===n.style.height&&(n.previousSibling&&n.previousSibling.className!==a&&n.parentNode.insertBefore(site2[site.nickname].horizontal_separator_in_index(),n),n.nextSibling&&n.nextSibling.className!==a&&n.parentNode.insertBefore(site2[site.nickname].horizontal_separator_in_index(),n.nextSibling)),"shrink"===t||"remove"===t&&""===n.style.width&&""===n.style.height||"add"===t&&(""!==n.style.width||""!==n.style.height)){var r=n.previousSibling&&n.previousSibling.className===a?n.previousSibling.previousSibling:null;!r||""===r.style.width&&""===r.style.height||n.parentNode.removeChild(n.previousSibling);var r=n.nextSibling&&n.nextSibling.className===a?n.nextSibling.nextSibling:null;!r||""===r.style.width&&""===r.style.height||n.parentNode.removeChild(n.nextSibling)}"remove"===t&&n.previousSibling&&n.previousSibling.className===a&&n.nextSibling&&n.nextSibling.className===a&&n.parentNode.removeChild(n.nextSibling)}}function Q(e,t){var n=Xe[e],a=null;if(pref.catalog.filter.attr_list&&(pref.catalog.style_general_list&&(a=pref_func.merge_obj5(e,pref.catalog.style_general_list_obj2,a)),pref.catalog.filter.attr_list&&(a=pref_func.merge_obj5(e,pref.catalog.filter.attr_list_obj2,a))),n[0]){var r=n[22];if(a&&a.style)for(var o in a.style)o in r||(r[o]=t.style[o]),t.style[o]=a.style[o];for(var o in r)a&&a.style&&o in a.style||(void 0===r[o]?delete t.style[o]:t.style[o]=r[o],delete r[o])}if(a&&a.cmd||n[20]||n[16].icon_show_always||n[16].systemSticky){var s=!!(a&&a.cmd&&void 0!==a.cmd.sticky?a.cmd.sticky:n[16].systemSticky);s^n[20]&&(n[20]=s,ht.idx_reorder(e),flag_redraw=!0,Nt&&n[0]&&Nt(e)),n[20]!=n[16].icon_sticky&&(n[16].icon_sticky=site2[site.nickname].set_icon(n[0],n[16].type_html,"sticky",n[16],s));var i=a&&a.cmd&&a.cmd.show;i^!!n[16].icon_show_always&&(n[16].icon_show_always=site2[site.nickname].set_icon(n[0],n[16].type_html,"show_always",n[16]),n[16].show_always=i,n[9]=ee(e),Nt&&n[0]&&Nt(e))}}function V(e,t,n){t.str_old="",t.fail_list={},t.suc_list={},Z(e,t,n)}function Z(e,t,n){t||(t=pref.catalog.filter.kwd),t.rexps=common_func.kwd_prep_regexp(t),$(e,t,n)}function $(e,t,n){t||(t=pref.catalog.filter.kwd);var a=t.posts_active,r=t.use&&t.rexps&&(t.sub||t.name||t.com||t.file||t.meta||t.trip||t.id||t.flag);if(t.active=r&&(t.op||t.post),t.posts_active=r&&t.post,pref4.search_posts_active_once|=t.posts_active,n||t.posts_active||!a||mt.posts_search_inactivated(),t.timestamp=It++,!pref.test_mode[59]){if(!e||"catalog.filter.kwd.str"!==e.target.name||0!==t.match||t.re&&!/^[\w\s]*$/.test(t.str+t.str_old))t.fail_list={},t.suc_list={};else{for(var o in t.fail_list)0!==t.str.indexOf(t.fail_list[o])?delete t.fail_list[o]:t.fail_list[o]===t.str&&(t.timestamp=o);for(var o in t.suc_list)0!==t.suc_list[o].indexOf(t.str)?delete t.suc_list[o]:t.suc_list[o]===t.str&&(t.timestamp=o)}t.str&&(t.fail_list[t.timestamp]=t.str,t.suc_list[t.timestamp]=t.str)}n||ae()}function ee(e,t){var n=Xe[e],a=n[9][0];return n[9][0]=te(e,n),t||a===n[9][0]||(Ue.drawn_idx=0),n[9]}function te(e,t){if(t[16].show_always&&!pref.catalog.filter.kwd.active)return!0;if(pref.catalog.filter.tag&&(!pref.catalog.filter.kwd.active||!pref.filter.disable_tag_when_kwd_active)&&!liveTag.search_by_tags(t[16].lth))return!1;if(pref.catalog.filter.time&&(t[8][4]||t[8][0])<=pref3.catalog.filter.time_obj)return!1;if(pref.catalog.filter.time_creation&&t[8][1]<=pref3.catalog.filter.time_obj)return!1;if(pref.catalog.filter.list&&(!pref.catalog.filter.kwd.active||!pref.filter.disable_list_when_kwd_active)){var n=ne(e);if(n[0]===!1)return t[9]=n,t[9][0]}if(pref.catalog.filter.kwd.active){var a=t[16].recent_posts(pref.catalog.filter.kwd.post?"auto"===pref[p].sourceOfSP?-1:null:0);if(pref.test_mode[59]){if(!At.kwd(pref.catalog.filter.kwd,a,common_func.fullname2dbt(e)[0]))return!1}else if(pref.catalog.filter.kwd.fail_list[t[9][3]]&&t[9][2]===!1||pref.catalog.filter.kwd.suc_list[t[9][3]]&&t[9][2]===!0?pref.debug_mode[18]&&t[9][2]!==At.kwd(pref.catalog.filter.kwd,a,common_func.fullname2dbt(e)[0])&&console.log("BUG, test59, "+e):(t[9][3]=pref.catalog.filter.kwd.timestamp,t[9][2]=At.kwd(pref.catalog.filter.kwd,a,common_func.fullname2dbt(e)[0])),!t[9][2])return!1}return!0}function ne(e){var t=pref_func.merge_obj5(e,pref.catalog.filter.list_obj2,{hit:!1});return t.time?[!pref.catalog.filter.list||t.time<(Xe[e][8][4]||Xe[e][8][0]),t.time]:t.hit?[!pref.catalog.filter.list]:[!0]}function ae(){if(pref.test_mode[60])if(pref.catalog.filter.kwd.use||pref.catalog.filter.tag||pref.catalog.filter.time||pref.catalog.filter.list)for(var e in Xe)Xe[e][9]=ee(e);else{for(var e in Xe)Xe[e][9][0]=!0;Ke.drawn_idx=0}else{var t=!(pref.catalog.filter.kwd.use||pref.catalog.filter.tag||pref.catalog.filter.time||pref.catalog.filter.list)||null;for(var e in Xe)Xe[e][9][0]=t;Ke.drawn_idx=0}Nt&&Nt()}function re(){pref_func.apply_prep(ct,!0);for(var e in Xe)Q(e,Xe[e][0])}function oe(e,t){"no"===pref[p].popup2||"sr"===pref[p].popup2&&!pref.catalog.filter.kwd.active||("imm"==pref.catalog_popdown||Pe[t]?se(e,t):(Lt[t]?clearTimeout(Lt[t]):(Xe[t][0].addEventListener("mousemove",Xe[t][2][1]),Xe[t][6]=function(){clearTimeout(Lt[t])},Xe[t][0].addEventListener("mouseout",Xe[t][6])),Lt[t]=setTimeout(function(){se(e,t)},pref.catalog_popup_delay)))}function se(e,t){if(Pe[t])return void ie(t);var n=Xe[t][0];Lt[t]&&(n.removeEventListener("mousemove",Xe[t][2][1]),n.removeEventListener("mouseout",Xe[t][6]),delete Lt[t]);var a=pe(null,pref[p].popup2,t);a&&(site2.DEFAULT.popups_posts.set_pos(a,e),site.popup_body.appendChild(a)),pref.catalog_popup_size_fix&&(a.style.width=a.offsetWidth+"px",a.style.height=a.offsetHeight+"px"),Pe[t]=[null,function(){le(t)},function(){ie(t)},n,a],"chart"===pref[p].popup2&&(chart_obj&&pref3.stats.use?Pe[t][5]=new chart_obj.PostChart(a,[t]):a.innerHTML="Statistics needs to be activated."),"imm"==pref.catalog_popdown?document.documentElement.clientHeight/2-e.clientY>0?parseInt(a.style.top.replace(/px/,""),10)+a.offsetHeight>document.documentElement.clientHeight&&(a.offsetHeight>document.documentElement.clientHeight?a.style.top="0px":(a.style.top=null,a.style.bottom="0px")):parseInt(a.style.bottom.replace(/px/,""),10)+a.offsetHeight>document.documentElement.clientHeight&&(a.style.bottom="",a.style.top="0px"):(a.addEventListener("mouseover",Pe[t][2],!1),a.addEventListener("mouseout",Pe[t][1],!1)),n.addEventListener("mouseout",Pe[t][1],!1)}function ie(e){Pe[e][0]&&(clearTimeout(Pe[e][0]),Pe[e][0]=null)}function le(e){Pe[e][0]||(Pe[e][0]=setTimeout(function(){ce(e)},"imm"==pref.catalog_popdown?0:pref.catalog_popdown_delay))}function ce(e){Pe[e][5]&&Pe[e][5].destroy();var t=Pe[e][3],n=Pe[e][4];t.removeEventListener("mouseout",Pe[e][1],!1),"imm"!=pref.catalog_popdown&&(n.removeEventListener("mouseover",Pe[e][2],!1),n.removeEventListener("mouseout",Pe[e][1],!1)),Xe[e][12]&&(Xe[e][12]=H(Xe[e][12])),n=cnst.div_destroy(n,!0),delete Pe[e]}function pe(e,t,n,a){var r="sr"===t||"srpv"===t,o=a||pref.catalog.filter.kwd.posts_active,s={posts:Xe[n][16].recent_posts(r&&o&&"auto"===pref[p].sourceOfSP?-1:null),__proto__:Xe[n][7]||Xe[n][16]};if(!pref.test_mode[49]&&o&&s)var i=r?At.kwd_make_result(s.posts,s.domain,a):null;if("sr"!==t||i){if(e||(e=cnst.init("pop:border:1px solid blue")),"chart"!==t)if(pref.test_mode[49]){e.innerHTML=Xe[n][3][0],b(e,Xe[n][3][1],pref[p].format.hover,n),v(e,Xe[n][3][1],pref[p].format.hover,n);var l=n.replace(/\/.*/,""),c=F(n,pref[p].mark_new_posts,pref[p].mark_new_posts,pref[p].mark_new_posts);c>0&&site2[l].mark_newer_posts(e,c),Xe[n][12]=M(n,site2[l].modify_thread_link(e)),Q(n,e)}else{var _=s.lth;s="dp"===t?{posts:[{search_result:!1,__proto__:s.posts[0]}].concat(_&&_.pd||[]),__proto__:s}:"pv"!==t&&i&&{posts:i,__proto__:s}||s,mt.prepare_html_prep_posts(s);for(var d=0;d<s.posts.length;d++)s.posts[d]=Object.create(s.posts[d]);var u=site2[site.nickname].page_json2html3(s,s.board,s.op_img_url,!0,a);!pref.test_mode[98]&&pref[p].popup&&mt.prep_anchor_links(u,s),!pref.test_mode[98]&&pref[p].popup&&site2[s.domain].popups_add(s.posts,s,!1,!1,!a);for(var d=0;d<s.posts.length;d++)site2[s.domain_html].format_pn(s.posts[d].pn,_&&_.q&&_.q[s.posts[d].no],null,s.posts[d],s);site2.DEFAULT.check_reply.set_own_posts(s),pref[p].mark_new_posts&&mt.update_draw(s.key,s.posts),a&&!s.posts[0].search_result&&Array.prototype.forEach.call(u.getElementsByClassName("CatChan_search_miss"),function(e){e.style.display="none"}),e.name=s.key,gGEH.pns_all_keys.set(e,s.key),e.appendChild(u),Q(n,e.childNodes[0])}return e}}function _e(e,t,n){var a=pref.catalog_board_list_obj[t]&&pref.catalog_board_list_obj[t][0].tags||null;return a&&n&&(a=a.filter(function(e){return"#"===e[0]&&"#"===e[1]})),a?liveTag.tags_reserved_init(a,e):null}function de(e,t,n,a){var r=[],o={};"boards"===site.whereami&&0==e&&pref_func.str2obj("catalog_board_list_str");var s=pref.catalog_board_list_obj[e].slice(),i=s[0].domains_for_all_boards;if(i){for(var l=0;l<i.length;l++){var c=i[l];if(!site3[c].boards)return function(e){site2[c].get_boards_json("refresh_boards_json",e,!1,Be)}}for(var l=0;l<i.length;l++)if(n&&site2[i[l]].utilize_boards_json&&pref.pref2[i[l]].utilize_boards_json&&pref.pref2[i[l]].utilize_boards_json_domain)o[i[l]]=null;else for(var p in liveTag.mems[i[l]])s[s.length]=liveTag.mems[i[l]][p]}var _=_e(!0,e,a);for(var d in _){for(var p=1;p<s.length&&s[p].key!==d;p++);p==s.length&&(s[s.length]=liveTag.mems.getFromName(d))}t&&(r=t.replace(/\s*\/\/.*$/gm,",").replace(/\n/g,",").replace(/,,+/g,",").replace(/^,/,"").replace(/,$/,"").split(",")),""===r[0]&&(r=[]);for(var p=0;s.length>1;){for(var l=1;l<s.length;l++){var u=s[l].key.replace(/\s/g,""),f=cnst.name2domainboardthread(u,!0),m="auto"===pref.catalog_max_page_select&&liveTag.mems[f[0]]&&liveTag.mems[f[0]][f[1]]&&liveTag.mems[f[0]][f[1]].pgs||pref.catalog_max_page;f[2]?0==p?r.push(u):s.splice(l--,1):(!s[l].max_page||p<s[l].max_page)&&p<m?r.push(u+(pref.catalog.catalog_json?"q":"p")+p):s.splice(l--,1)}p++}return{tgts:r,tgt_domains:o}}function ue(e,t,n){if(pref.catalog.board.ex_list)for(var a=e.length-1;a>=0;a--){var r=pref_func.merge_obj5(e[a],pref.catalog.board.ex_list_obj2,{hit:!1});r.hit&&e.splice(a,1)}if("catalog"===pref.catalog.design||"auto"===pref.catalog.design&&"catalog"===n||"chart"===n)for(var a=e.length-1;a>=0;a--){var o=cnst.name2domainboardthread(e[a],!0);"no"===site2[o[0]].trim_list&&"chart"!==n||e[a].search(/\/[pq][0-9]*/)==-1||(e[a].search(/\/[pq]0$/)==-1||t&&o[1]==site.board&&o[0]==site.nickname&&"force_init"!==site2[o[0]].trim_list&&!pref3.stats.use?e[a].search(/\/[pq][0-9]$/)!=-1&&e.splice(a,1):e[a]=e[a].replace(/[pq]0/,pref.catalog.catalog_json||"force_init"===site2[o[0]].trim_list?"j0":"c0"))}if("page"===n&&t){if(pref.liveTag.use){for(var s={},a=0;a<e.length;a++){
var o=cnst.name2domainboardthread(e[a],!0);s[o[0]+o[1]+(pref.catalog.catalog_json?"j0":"c0")]=null}for(var a in s)e[e.length]=a}e[0]&&0===e[0].search(site.nickname+site.board+"[pq]0")&&e.splice(0,1),pref[n].load_on_demand&&(Ue.drawn_idx=0)}for(var a=e.length-1;a>=0;a--){var o=common_func.name2dbt(e[a]),i=site2[o[0]].make_url4(o,"page"!==pref.catalog.design&&(0!==pref.catalog.indexing||"none"!==pref.liveTag.from));i?i[2]&&i[2]!==e[a]&&(e.indexOf(i[2])!=-1?e.splice(a,1):e[a]=i[2]):e.splice(a,1)}return e}function fe(e,t){if(null!==Et){for(var n in Et)Xe[n]&&Et[n]===(Xe[n][8][0]>Xe[n][8][4]?Xe[n][8][0]:Xe[n][8][4]||Xe[n][8][0])&&Ke.remove_thread(n);Et=null}}function me(e,t){for(var n=0;n<We.length&&n<e;)"ODL:"===We[n++].substr(0,4)&&e++;if(t)for(null===Et&&(Et={});We.length>e;){var a=We[e++];"ODL:"===a.substr(0,4)?(Ke.remove_thread(a),e--):Et[a]=Xe[a][8][0]>Xe[a][8][4]?Xe[a][8][0]:Xe[a][8][4]||Xe[a][8][0]}else for(pref.test_mode[127]&&ut.off_delay();We.length>e;){var a=We[We.length-1];Ke.remove_thread(a)}}function he(e,t,n,a){pref4.refresh.count++,Ke.footer.refresh_start(),pref.test_mode[67]||t||archiver.refresh_start(),a||t||!pref.catalog.auto_save_filter_at_refresh||$e.save();var r=ge(p,e,t,n,"refresh",qe.selectedIndex,pref.catalog.filter.bookmark_list_str,!1,void 0,a);"function"==typeof r&&r(function(){he(e,t,n)})}function ge(e,t,n,a,r,o,s,i,l,c){var p=de(o,s,t,!n&&!c);if("function"==typeof p)return p;var _=p.tgts;if(i)for(var d={},u=0;u<_.length;u++){var f=common_func.name2domainboardthread(_[u],!0);f[2][0].search(/^[pqcj]/)!=-1?d[f[0]+f[1]]=null:d[f[0]+f[1]+f[2].replace(/^t/,"")]=null}r&&pref3.stats.use&&pref.stats.auto_acquisition_all&&stats.register_auto_acquisition(o),_=ue(_,n,e);var m=t?a?2:4:0;return 0===_.length?t?scan.scan_refresh(Be,_,m,p.tgt_domains):_:(t&&(fe(),pref.catalog_refresh_clear&&!n&&me(pref4.scan.max_threads_at_refresh,!0)),r&&nt.scan_init(r,_,{refresh:t,callback:function(){scan.scan_refresh(Be,_,m,p.tgt_domains),l&&l()},from_auto:a,load_on_demand:pref[e].load_on_demand,priority:m}),i?Object.keys(d):_)}function be(){if((pref.notify.favicon||pref.notify.title.notify)&&notifier.favicon.set(Xe),pref.debug_mode[3]){var e=0;for(var t in liveTag.mems)for(var n in liveTag.mems[t])for(var a in liveTag.mems[t][n])e++;var r={};for(var o in liveTag.tags_ci)for(var s of liveTag.tags_ci[o].mems.keys())r[s.key]=null;console.log("refresh_end: tags_ci+tags: "+Object.keys(liveTag.tags_ci).length+"+"+Object.keys(liveTag.tags).length+", threads:"+e+", "+Object.keys(r).length)}pref[p].load_on_demand&&Nt()}function ve(e,t,n,a){var r=[];if(!pref.test_mode[122]||n){if(e)for(var o=site2[site.nickname].parse_funcs.post_html.nativeUpdate2pn,s={},i=0;i<e.length;i++)if(e[i].addedNodes)for(var l=0;l<e[i].addedNodes.length;l++){var c="thread"===site.whereami?site.key:gGEH.get_key_recursive(e[i].addedNodes[l],document),_={pn:o(e[i].addedNodes[l])};s[c]?s[c][s[c].length]=_:s[c]=[_]}var d={init:n,posts_updated:n?null:s},u=nt.scan_boards_keyword_callback2(site.nickname+","+site.board+","+("thread"===site.whereami?site.no:"0")+","+site.whereami+"_html",{date:Date.now(),status:200,response:document},["native_prep",{native_prep:!0,ext_posts:r,force_annotate:a,__proto__:cataLog.scan_boards_keyword_callback2_default_args}],d);"thread"===site.whereami&&Object.defineProperty(site,"myself",{value:u[0],writable:!0,enumerable:!0,configurable:!0})}else{var o=site2[site.nickname].parse_funcs.post_html.nativeUpdate2pn;if(e)for(var i=0;i<e.length;i++)if(e[i].addedNodes)for(var l=0;l<e[i].addedNodes.length;l++)r[r.length]={pn:o(e[i].addedNodes[l])};site2[site.myself.domain].wrap_to_parse.posts({posts:r,__proto__:site.myself});for(var i=0;i<r.length;i++)mt.prepare_html_post(site.myself,r[i]);for(var i=0;i<r.length;i++)site.myself.posts[site.myself.posts.length]=r[i];A(site.myself,r,!0),Xe[site.myself.key][7]=site.myself,Xe[site.myself.key][16].posts=site.myself.posts}return"thread"===p&&common_obj.thread_reader&&0!==r.length&&common_obj.thread_reader.updated(r,n),u}function ye(e,t,n){var a=n.posts_updated&&n.posts_updated[e.key];a&&site2[e.domain].wrap_to_parse.posts({posts:a,__proto__:e});var r={init:n.init,posts_shown:t.pd?e.posts.slice():e.posts,posts_updated:a};if(t.pd){site.myself&&a&&site.myself.posts.length+a.length==e.posts.length&&(e.posts=site.myself.posts.slice().concat(a));for(var o=1,s=0;o<e.posts.length&&s<t.pd.length;)e.posts[o].no==t.pd[s].no?e.posts.splice(o,1):e.posts[o].no>t.pd[s].no?s++:o++}return r}function we(e){var t=e.split(",");(pref.catalog_promiscuous||t[0]+t[1]in boards)&&nt.scan_init("snoop",[e],{lifetime:3600,crawler_max:1,tgt_raw:!0})}function ke(e,t){jt[e]||(jt[e]={}),jt[e][t]||(jt[e][t]={}),IDB.req(e,t,null,null,xe,"list_os")}function xe(e,t,n){for(var a=0;a<n.length;a++)!pref.test_mode[80]&&Xe[e+t+n[a]]||Te(e,t,n[a])}function Te(e,t,n){IDB.req(e,t,n,null,archiver.event_funcs.restore3.bind(archiver.event_funcs),"get_all"),jt[e]||(jt[e]={}),jt[e][t]||(jt[e][t]={}),jt[e][t][n]=!0}function Ne(e,t,n){if(pref.patch.rm_404_blacklist.indexOf(e)==-1){for(var a=Object.create(pref.archive.IDB.auto_restore&&jt[e]&&jt[e][t]||null),r=0;r<n.length;r++)a[n[r].no]=null;liveTag.rm_404(e,t,a);var o=e+t;pref.catalog.bookmark_list_rm404&&(o in pref.catalog.filter.list_obj3||o in pref.catalog.filter.attr_list_obj3||o in pref.catalog.filter.watch_list_obj3)&&Ce(o,a),pref.test_mode[67]||archiver.clean_list_all(e,t,a);var s=liveTag.mems[e][t];s.LS_synced||(site2[e].clean_up_LS(e,t,a),s.LS_synced=1),pref.test_mode[65]||s.IDB_synced||!pref.archive.IDB.auto_clean_init||IDB.clean_up(e,t,a)}}function Ce(e,t){for(var n=[[pref.catalog.filter.list_str,pref.catalog.filter.list_obj2,lt],[pref.catalog.filter.attr_list_str,pref.catalog.filter.attr_list_obj2,ct],[pref.catalog.filter.watch_list_str,pref.catalog.filter.watch_list_obj2,it]],a=e.length,r=0;r<n.length;r++){var o=[];for(var s in n[r][1])s.length>a&&0===s.indexOf(e)&&!(s.substr(a)in t)&&(pref.debug_mode[2]&&console.log("rm_items_404: "+s),o[o.length]=s);o.length>0&&g(o[0],"DELETE",o.slice(1),!1)}}function Ie(e){var t=Fe.getElementsByTagName("textarea")["catalog.filter.bookmark_list_str"];t.value=Ae(e,t.value),pref_func.apply_prep(t,!0)}function Ae(e,t){var n=pref.catalog.bookmark_list_rm404?"":"//$&",a=e.split(",");return t.replace(new RegExp(a[0]+a[1]+a[2]+"(!page)*(,|\n|$)","g"),n)}function Le(){var e=(document.createElement("div"),new De(!1,"float",!0));for(var t in Ue.threads)Ee(e,t);e.show_catalog()}function Ee(e,t){if(!e.threads[t]){var n=liveTag.mems.getFromName(t),a=document.createElement("div");a.className=pref.script_prefix+"_headline";var r=site2[n.domain].post_com2txt(n.th),o=(n.th.sub?"<b>"+n.th.sub+"</b>: ":"")+r,s=500-(n.th.sub?2:0);o.length>=s&&(o=o.slice(0,s)+"..."),a.innerHTML="<span></span> "+o,e.threads[t]={0:a,16:{__proto__:Ue.threads[t][16]},24:[a.firstChild,null,null,null,6],__proto__:Ue.threads[t]}}e.idx_reorder(t)}var je=function(){function e(e){pref.tooltips.info.show&&(u=this,pref_func.tooltips.req_show("info",e,t))}function t(e){var t=e&&e.target||this,n=t.name||t.getAttribute("name"),r=p[n];if(r&&(r.prog&&(r.prog_str=r.prog.IDX?r.prog.IDX+"/"+r.prog.tgts.length+", "+r.tgt:r.prog.found_threads+"/"+r.prog.scanned+", "+r.prog.found_boards+"/"+r.prog.idx+"/"+r.prog.max+", "+r.tgt),!e&&pref.healthIndicator.expand_running&&r.start&&!r.end&&t.set(null," :"+r.prog_str),u&&u.getAttribute("name")===n)){var o=!r.end&&!pref.healthIndicator.cancel,s="Initiator: "+r.initiator+"&emsp;"+(o?'<button name="'+n+'">Cancel</button>':"")+"<br>"+(r.start?"Start: "+new Date(r.start).toLocaleTimeString()+"<br>":"")+(r.prog_str?"Progress: "+r.prog_str+"<br>":"")+"Priority: "+r.priority+"<br>"+(r.start&&!r.end&&r.prog?"Crawler: "+r.prog.crawler+"<br>":"")+(r.err_str?'<span style="color:red">Errors: '+r.err_str+"</span><br>":"")+(r.abort_str?'<span style="color:red">Abort: '+r.abort_str+"</span><br>":"")+(r.end?"End: "+new Date(r.end).toLocaleTimeString()+"<br>":""),i=o?{html:s,callback:a}:s;if(e)return i;pref_func.tooltips.show_2(null,i)}}function n(e){u=null,pref.tooltips.info.show&&pref_func.tooltips.hide2()}function a(e){e.getElementsByTagName("button")[0].onclick=o}function r(){pref.healthIndicator.cancel&&o.call(this)}function o(){var e=this.getAttribute("name");p[e]&&!p[e].end&&cataLog.scan_boards.scan_abort(p[e].initiator)}function s(){for(var e=pref.healthIndicator.show?"":"none",t=0;t<l.length;t++)l[t].pn.childNodes[1].style.display=e}function i(){if(!pref.healthIndicator.expand_running)for(var e=0;e<l.length;e++)for(var t=0;t<l[e].elems.length;t++)l[e].elems[t].pn.textContent.length>1&&l[e].elems[t].set(null,"r")}var l=[],c=0,p={},_=function(){this.pn=document.createElement("span"),this.pn.innerHTML='<span style="color:limegreen"></span><span></span>',this.pn_countdown=this.pn.childNodes[0],this.pn_hi=this.pn.childNodes[1],pref.healthIndicator.show||(this.pn.style.display="none"),l.push(this),this.elems=[]};_.prototype={shift:function(e,t,n,a){for(var r=this.elems.length-pref.healthIndicator.max;r>=0;r--)this.elems[r].remove_from_parent()&&this.elems.splice(r,1);var o=new d(e,t,n,a);return this.pn_hi.insertBefore(o.pn,this.pn_hi.firstChild),this.elems.push(o),o},destroy:function(){this.pn.parentNode.removeChild(this.pn),l.splice(l.indexOf(this),1)}};var d=function(a,o,s,i){this.pn=document.createElement("span"),this.name="healthIndicator."+c++,this.pn.setAttribute("name",this.name),this.set(a,o),this.pn.onmouseover=e,this.pn.onmouseout=n,this.pn.onclick=r,p[this.name]={initiator:s,priority:i},this.show_tooltip_delayed=new DelayBuffer(t.bind(this),100).get_binded_delayed_do()},u=null;return d.prototype={set:function(e,t){t&&(this.pn.textContent=t),e&&this.pn.setAttribute("style","color:"+e)},remove_from_parent:function(){return!(pref.healthIndicator.dont_retire_running&&!p[this.name].end)&&(delete p[this.name],this.pn.parentNode.removeChild(this.pn),this.pn===u&&n(),!0)},remove:function(){if(this.remove_from_parent())for(var e=0;e<l.length;e++){var t=l[e].elems.indexOf(this);if(t!=-1)return void l[e].elems.splice(t,1)}},report:function(e){var t=p[this.name];if(t){var n=t.prog;if(e)for(var a in e)if("err_str"===a?(t.err_str||this.set("orange"),t[a]=(t[a]?t[a]+", ":"")+e[a]):t[a]=e[a],"end"===a){n&&(t.prog_str=t.prog.IDX?n.IDX+"/"+n.tgts.length:n.found_threads+"/"+n.scanned+", "+n.found_boards+"/"+n.max,t.prog=null);var r=t.err_str&&"IDB"!==t.initiator?n&&n.SUC?"▲":"X":"●";this.set("X"===r?"red":null,r)}(u||pref.healthIndicator.expand_running)&&this.show_tooltip_delayed()}}},{HealthIndicator:_,show:s,shrink_running:i}}();cataLog.healthIndicator=je;var Be=new je.HealthIndicator;httpd.set_health_indicator(Be);var Se={mode:p,threads:Xe,timestamp:0,timestamp_set:function(){this.timestamp&&(this.timestamp+=16,this.clg.drawn_idx=0,this.clg.show_catalog())},update_all_force:function(e,t,n){if(!("float"===this.mode^t.indexOf("float")!=-1)){n||this.compile();for(var a in this.threads)this.update_force(a)}},update_force:function(e,t,n){this.update(e,t,n,!0)},update:function(e,t,n,a){var r=this.threads[e][24];r&&(this.threads[e][1]&&a?(this.insert_footer3(r,e,t,n),r[4]=this.timestamp):r[4]|=(t?1:0)|(n?4:0)|8)},try_dirtifying_tag:function(e,t,n,a){var r=this.threads[e][24];if(15&r[4])return r[4]|=4,!0},draw:function(e){var t=this.threads[e][24];t&&t[4]!==this.timestamp&&(this.insert_footer3(t,e),t[4]=this.timestamp)},factory:function(e,t,n){return{threads:t,timestamp:this.timestamp,mode:e,clg:n,__proto__:this}},pn:document.createElement("div"),prep_flag_dom:function(e){if(e.flag&&e.flag instanceof Element)return document.importNode(e.flag);if(site2[site.nickname].post_flag2html)return this.pn.innerHTML=site2[site.nickname].post_flag2html(e),this.pn.childNodes[0]},ts_refresh:null,refresh_start:null,formatted_arr:null,get_str:null,prep_footer3:function(e,t){var n=e.footer;n.classList.add(pref.script_prefix+"_footer");var a="catalog_html"===e.type_parse&&e.parse_funcs_html.footer_prep(e,n)||null;if(pref[this.mode].footer_br){var r=n.getAttribute("style");r=(r?r+";":"")+"clear:both",n.setAttribute("style",r)}return[n,null,null,null,6|(e.country?1:0),a,null,null]},color_tag_node:function(e,t){var n=this.query_tag_node(e,t);n&&liveTag.color_tag_node(n,t)},query_tag_node:function(e,t){var n=this.threads[e]&&this.threads[e][24];if(n)if(pref.test_mode[119]){var a=t.toLowerCase(),r=n[7];if(r)for(var o=0;o<r.length;o++)if(r[o]===t||pref.liveTag.ci&&r[o].toLowerCase()===a)return n[3].childNodes[2*o]}else{if(this.try_dirtifying_tag(e))return;for(var s=n[3]&&n[3].firstChild;s;){if(s.textContent===t)return s;s=s.nextElementSibling}}},insert_footer3:function(e,t,n,a){function r(e,t){e[0].removeChild(e[t]),e[t]=null}var o=this.threads[t],s=liveTag.mems.getFromName(t),i=pref[this.mode].footer;if(i.use){n=n||1&e[4],a=a||4&e[4];var l=this.get_str(o,s)}if(l?e[5]?e[5].textContent=l:e[5]=e[0].insertBefore(document.createTextNode(l),e[0].firstChild):e[5]&&r(e,5),i.tag&&i.use){if(a||!e[3])if(pref.test_mode[119]){var c=s.tags,p=liveTag.update_tag_nodes(s.tags,", ",liveTag.tag_node_onclick,e[3],e[7]);e[7]=c,e[3]||(e[3]=e[0].insertBefore(p,e[6]))}else{var p=liveTag.create_tag_nodes(s.tags,", ",liveTag.tag_node_onclick);e[3]&&e[3].parentNode.removeChild(e[3]),e[3]=e[0].insertBefore(p,e[6])}}else e[3]&&(r(e,3),e[7]=null);if(i.flag&&pref[this.mode].t2h_num_of_posts>=0&&i.use){if(!n&&e[6]||(n=o[16].recent_posts()),e[6]||(e[6]=e[0].appendChild(document.createElement("span"))),n&&n.length>0){for(var _=e[6].childNodes.length-1;_>=0;_--)e[6].removeChild(e[6].firstChild);for(var _=0;_<n.length;_++)if(n[_]){var d=Se.prep_flag_dom(n[_]);d&&(n[_].deleted_after&&d.classList.add("CatChan_deleted"),e[6].appendChild(d))}}}else e[6]&&r(e,6);if(pref.debug_mode[32]&&e[6]){for(var u=o[16].recent_posts(),p=document.createElement("span"),_=0;_<u.length;_++)if(u[_]){var d=Se.prep_flag_dom(u[_]);d&&(u[_].deleted_after&&d.classList.add("CatChan_deleted"),p.appendChild(d))}var f=[e[6],p].map(function(e){return Array.prototype.map.call(e.getElementsByClassName("flag"),function(e){return e.getAttribute("class").match(/flag\-(..)/)[1]}).toString()});f[0]!=f[1]&&console.log("Error: Flags: "+s.key+": \n"+f[0]+"\n"+f[1])}}};Se.get_str=function(e){function t(e){var t=e-r,n=t<0?"-":"+",a=Math.floor(Math.abs(t)/1e3),o=a%60,s=a>=60?Math.floor(a%3600/60):0,i=a>=3600?Math.floor(a%86400/3600):0,l=a>=86400?Math.floor(a/86400)+"d":"";return n+l+(l&&i<10?"0":"")+(a>=3600?i+":":"")+(a>=3600&&s<10?"0":"")+(a>=60?s+":":"")+(a>=60&&o<10?"0":"")+o}function n(e){return o||(o=new RegExp(new Date(r).toLocaleDateString(),"g")),new Date(e).toLocaleString().replace(o,"")+" "}function a(){r=Date.now(),o=null,this.timestamp_set()}var r=Date.now(),o=null,s=null,i=null,l=null,c={pg:function(e){return e.page?function(){return s[14]||"?"}:null},nm:function(e){return e.nrtm?function(){return i.watched?i.nrtm:""}:null},nr:function(e){return e.nr?function(){return i.watched?i.nr:""}:null},rp:function(e){return e.rp?e.rOP?function(){return l[2]}:function(){return l[2]-1}:null},im:function(e){return e.im?e.iOP?function(){return l[3]}:function(){return l[3]>1?l[3]-1:""}:null},lp:function(e){return e.nl?function(){return i.ta&&i.ta.posts?i.ta.posts.length:""}:null},dp:function(e){return e.nd?function(){return i.pd?i.pd.length:""}:null},ar:function(e){return e.archived?function(){return i.archived?"A":""}:null},nf:function(e){return e.nf?function(){return i.sID&&i.sID.nc||""}:null},ni:function(e){return e.nid?function(){return i.sID&&(i.sID.nid||i.sID.np)||""}:null},ct:function(e){return e.ctime?function(){return n(l[1])}:null},cT:function(e){return e.rctime?function(){return t(l[1])}:null},bt:function(e){return e.btime?function(){return l[0]?n(l[0]):""}:null},bT:function(e){return e.rbtime?function(){return l[0]?t(l[0]):""}:null},pt:function(e){return e.ptime?function(){return l[4]?n(l[4]):""}:null},pT:function(e){return e.rptime?function(){return l[4]?t(l[4]):""}:null},pr:function(e){return e.prate?function(){return Math.floor(l[2]/((r-l[1])/864e5))}:null},dn:function(e){return e.domain?function(){return i.domain}:null},bd:function(e){return e.board?function(){return i.board}:null},no:function(e){return e.no?function(){return i.no}:null},sp:function(e){return e.ns?function(){return i.sg?i.sg.size:""}:null},wrap:function(e,t,n){var a=t();return""!==a?e+a+n:""},concat:function(e){for(var t=e[1](),n=2;n<e.length-1;n+=2){var a=e[n+1]();""!==a&&(t+=e[n]+a)}return""!==t?e[0]+t+e[e.length-1]:""}},p={native:"(ar )(U: nm/nr / )R: (lp/)(rp)(*sp)(+dp)( / I: im)( / P: pg) (ni/nf )(ct )(cT )(bt )(bT )(pt )(pT )(pr )(dn)(bd)(no) ",condensed:"(ar )(nm/)(nr/)(lp/)(rp)(*sp)(+dp)(/im)(/pg) (ni/nf )(ct )(cT )(bt )(bT )(pt )(pT )(pr )(dn)(bd)(no) ",meguca:"(ar )(dn)(bd)(no) (nm/)(nr/)(lp/)(rp)(*sp)(+dp)(/im)(/pg) (ni/nf )(ct )(cT )(bt )(bT )(pt )(pT )(pr ) "};return e.compile=function(){for(var e=pref[this.mode].footer,t=p[e.design]||e[e.design]||"",n="ar|n[mrfio]|pg|rp|im|[lds]p|[cbp][tT]|pr|dn|bd",a=t.split(new RegExp("(\\(.*?(?:"+n+").*?\\))")).filter(function(e){return e}),r=new RegExp("("+n+")"),o={},s=0,i={enumerable:!0,configurable:!0},l=0;l<a.length;l++){var _=a[l].slice(1,-1).split(r);if(_.length>=3){for(var d=1;d<_.length;d+=2)_[d]=c[_[d]](e);for(var d=_.length-3;d>=0;d-=2)_[d+1]?d>0&&!_[d-1]&&(_[d]=""):_.splice(d,2);_[1]&&Object.defineProperty(o,s++,{get:_.length>=5?c.concat.bind(null,_):_[0]||_[2]?c.wrap.bind(null,_[0],_[1],_[2]):_[1],__proto__:i})}else a[l]&&Object.defineProperty(o,s++,{value:a[l],__proto__:i})}return o.length=s,this.formatted_arr=o,this.timestamp=e.prate||e.rptime||e.rbtime?16:0,o},e.refresh_start=a,Object.defineProperty(e,"ts_refresh",{get:function(){return r},enumerable:!0,configurable:!0}),function(e,t){return s=e,i=t,l=s[8],Array.prototype.join.call(this.formatted_arr,"")}}(Se),Se.compile(),cataLog.Footer=Se,cataLog.embed_mode=p,pref[p].open_spoiler_text&&styleSheet.open_spoiler_text(),brwsr.sw_cache&&pref.info_client&&brwsr.sw_cache.subscribe(!0);var Oe=!0,De=function(a,r,o){var s=pref.catalog.appearance.initial,i=cnst.init3({func_str:"left:"+s.left+"px:top:"+s.top+"px:resize:both:"+(a?"display:none:tb:embed":"tb")+":width:"+s.width+"px:height:"+s.height+"px:resize:both:overflow:auto:Show"+(a?"":":bottom_top")+("float"===r?":tb_press:"+s.state:""),exit:o?this.destroy.bind(this):t,maximize:yt,get auto_roll(){return pref.catalog_auto_rollup_when_moving}}).pn,l=i.childNodes[0],c=i.childNodes[1].appendChild(document.createElement("div")),p=cnst.add_to_tb(i,'<button type="button" name="filter">'+(site2[site.nickname].CONTENT_SECURITY_POLICY_DATAURI?"F":cnst.icons.img(cnst.icons.filter))+'</button><button type="button" name="settings">'+(site2[site.nickname].CONTENT_SECURITY_POLICY_DATAURI?"S":cnst.icons.img(cnst.icons.settings))+'</button><button type="button" name="refresh">'+(site2[site.nickname].CONTENT_SECURITY_POLICY_DATAURI?"R":cnst.icons.img(cnst.icons.refresh))+'</button><span name="num_of_pages"><span name="hide_at_embed"> up to <input type="text" name="catalog_max_page" size="2" style="text-align: right;">pages in </span></span><span name="boards_selector"><select name="catalog_board_list_sel"></select></span>'),_=p.getElementsByTagName("select").catalog_board_list_sel;cnst.auto_shrink_board_selector.setup(_,pref.catalog_board_list_sel),pref_func.apply_prep(p,!1);for(var d=["filter","settings","refresh","num_of_pages","boards_selector"],u=0;u<d.length;u++)pref.catalog.appearance.titleBar[d[u]]||(p.getElementsByTagName("*")[d[u]].style.display="none");if(!o){l.childNodes[3].appendChild(Be.pn);var f=document.createElement("span");f.textContent=" ",l.childNodes[3].appendChild(f);var m=new je.HealthIndicator;IDB.set_indicator(m),l.childNodes[3].appendChild(m.pn)}var h=document.createElement("div");"float"===r&&h.setAttribute("class",pref.script_prefix+"_window"),h.style="margin:0px 3px; clear:both",h.innerHTML=pref_func.format_html_str('<div style="float:right;display:none"><div style="float:right"><ICBX"'+r+'.auto_update"> Auto update<br>1,<ITB3"'+r+'.auto_update_period"> min.<br><ICBX"catalog_refresh_clear"> Clear latter than<br>1,<ITB4"catalog.max_threads_at_refresh">th at update<br><BTN"clear_threads,ClearAllThreads"></div><div style="float:right"><div name="hide_at_embed"><select name="catalog.indexing"><option>Bump order</option><option>Creation date</option><option>Reply count</option><option>Image count</option><option>Last reply</option><option>Fast</option><option>/Bump order</option><option>/Creation date</option><option>/Reply count</option><option>/Image count</option><option>/Last reply</option><option>Slow</option></select><br>size <span name="catalog.text_mode.mode.graphic"><input type="text" name="catalog_size_width" size="4" style="text-align: right;"> x <input type="text" name="catalog_size_height" size="4" style="text-align: right;"></span><span name="catalog.text_mode.mode.text"><input type="text" name="catalog_size_text_width" size="4" style="text-align: right;"> x <input type="text" name="catalog_size_text_height" size="4" style="text-align: right;"></span></div><div>'+pref_func.settings.html_funcs.rollup_radio("catalog.order.sticky"," :Sticky",1,"",["first:at first","last:at last","dont_care:don't care"])+'<br><IC"catalog.order.reply_to_me">New reply to me at first<br><IC"catalog.order.reply">New reply at first<br>'+pref_func.settings.html_funcs.rollup_radio("catalog.order.watch"," :Watch listed",1,"",["first:at first","last:at last","dont_care:don't care"])+'<br></div></div></div><div align="left" style="float:left;display:none"><div data-show3="kwd"><a name="HIDE3" style="cursor:pointer">[-]</a><ICBX"catalog.filter.kwd.use"> Keyword :<input type="text" name="catalog.filter.kwd.str" size="25"> <ICBX"catalog.filter.kwd.ci">CI '+pref_func.settings.html_funcs.make_sel("catalog.filter.kwd.match",["match all","match any","unmatch all","unmatch any"])+' <ICBX"catalog.filter.kwd.sentence">Sentence <ICBX"catalog.filter.kwd.re">RE<br>1,(<ICBX"catalog.filter.kwd.sub">Subject <ICBX"catalog.filter.kwd.name">Name <ICBX"catalog.filter.kwd.com">Comment <span style="display:none"><span name="HIDE4" style="cursor:pointer">◀</span><ICBX"catalog.filter.kwd.trip">Tripcode <ICBX"catalog.filter.kwd.id">ID <ICBX"catalog.filter.kwd.file">Filename <ICBX"catalog.filter.kwd.meta">No. <ICBX"catalog.filter.kwd.flag">Flag</span><span name="SHOW4" style="cursor:pointer">▶</span>) (<ICBX"catalog.filter.kwd.op">OP <ICBX"catalog.filter.kwd.post">Posts)<button name="scanBoard">></button><button name="scanSite">>></button>'+(pref.test_mode[115]?pref_func.settings.html_funcs.rollup('<div>&emsp;&emsp;<IC"filter.disable_list_when_kwd_active">Disable list filter when keyword filter is active<br>2,<IC"filter.disable_tag_when_kwd_active">Disable tag filter when keyword filter is active<br>1,<IC"catalog.filter.auto_list.use">Auto filter list:<br>2,<ICBX"catalog.filter.auto_list.kill">Hide <ICBX"catalog.filter.auto_list.watch">Watch <ICBX"catalog.filter.auto_list.show">Show <ICBX"catalog.filter.auto_list.sticky">Sticky <ICBX"catalog.filter.auto_list.style">Style:<ITBL25"catalog.filter.auto_list.style_str">&emsp;<BTN"add_to_auto,+"><br>2,<TA"catalog.filter.auto_list.str,40,1"></div>'):"")+'</div><div style="clear:both" data-show3="time"><a name="HIDE3" style="cursor:pointer">[-]</a>Time: Posted/Created <ICBX"catalog.filter.time"><ICBX"catalog.filter.time_creation">Hide <ICBX"catalog.filter.time_watch"><ICBX"catalog.filter.time_watch_creation">Watch <ITBL25"catalog.filter.time_str"><select name="catalog.filter.time_quick_sel"><option>quick select...</option><option>now</option><option>1 hour ago</option><option>2 hours ago</option><option>4 hours ago</option><option>12 hours ago</option><option>1 day ago</option><option>3 days ago</option><option>1 week ago</option></select><br></div><div style="clear:both;display:none" data-show3="tag"><a name="HIDE3" style="cursor:pointer;float:left">[-]</a><span class="PLACEHOLDER" style="float:right"></span>'+liveTag.popup_filter.html+'</div><div style="clear:both;display:none" data-show3="list"><a name="HIDE3" style="cursor:pointer;float:left">[-]</a><div style="float:left"><input type="checkbox" name="catalog.filter.list"> Exclusive list:<br>&emsp;<textarea style="height:1em" cols="20" name="catalog.filter.list_str"></textarea></div><div style="float:left"><input type="checkbox" name="catalog.filter.attr_list"> Attribute list:<br>&emsp;<textarea style="height:1em" cols="20" name="catalog.filter.attr_list_str"></textarea></div><div style="float:left">Watch time list:<br>&emsp;<textarea style="height:1em" cols="20" name="catalog.filter.watch_list_str"></textarea></div><div style="float:left"><input type="checkbox" name="catalog.filter.bookmark_list"> Bookmark list:<br>&emsp;<textarea style="height:1em" cols="10" name="catalog.filter.bookmark_list_str"></textarea></div><div style="float:left"><button name="load">load</button><input type="checkbox" name="catalog.auto_load_filter">Auto&emsp;<button name="load_default">clear_filters</button><br><button name="save">save</button><input type="checkbox" name="catalog.auto_save_filter">Auto&emsp;<input type="checkbox" name="catalog.auto_save_filter_at_refresh">Auto at refresh<br></div></div><div style="clear:both"></div><a name="SHOW3" style="cursor:pointer;float:left;display:none" data-show3="kwd">[+ keyword filter]</a><a name="SHOW3" style="cursor:pointer;float:left;display:none" data-show3="time">[+ Time filter]</a><a name="SHOW3" style="cursor:pointer;float:left" data-show3="tag">[+ Tag search]</a><a name="SHOW3" style="cursor:pointer;float:left" data-show3="list">[+ List filters]</a></div><div style="clear:both"></div>'),i.childNodes[1].insertBefore(h,c);var g=h.getElementsByClassName("PLACEHOLDER");g[0].appendChild(site2[site.nickname].make_tack()),cnst.set_tack_float(g[0],e,n);var b=p.getElementsByTagName("button");cnst.set_target_of_button(b.settings,h.childNodes[0]),cnst.set_target_of_button(b.filter,h.childNodes[1]),this.pn12=i,this.pn12_0=l,this.pn12_1=c,this.pn12_0_2=p,this.pn12_0_4=h,this.board_sel=_,this.threads={},this.idxs=[],this.drawn_idx=0,this.mode=r,this.order=pref.catalog.order,this.threads_odl={},this.Clgs.push(this),this.ppn=c;var v=De.prototype.Clgs;2==v.length&&this.hook_set({set drawn_idx(e){this.Clgs.forEach(function(t){t.drawn_idx=e})},footer:{update:function(e,t,n,a){for(var r=De.prototype.Clgs,o=0;o<r.length;o++)r[o].threads[e]&&r[o].footer.update(e,t,n,a)},update_force:function(e,t,n){for(var a=De.prototype.Clgs,r=0;r<a.length;r++)a[r].threads[e]&&a[r].footer.update_force(e,t,n)},color_tag_node:function(e,t){for(var n=De.prototype.Clgs,a=0;a<n.length;a++)n[a].threads[e]&&n[a].footer.color_tag_node(e,t)},update_all_force:function(e,t,n){for(var a=De.prototype.Clgs,r=0;r<a.length;r++)a[r].footer.update_all_force(e,t,n)},refresh_start:function(){var e=De.prototype.Clgs;e[0].footer.refresh_start();for(var t=1;t<e.length;t++)e[t].footer.timestamp_set()},__proto__:Se},show_catalog:function(e){for(var t=De.prototype.Clgs,n=0;n<t.length;n++){var a=t[n];if(e)if("string"==typeof e)a.threads[e]&&a.show_catalog(e);else{var r={},o=!1;for(var s in e)a.threads[s]&&(r[s]=null,o=!0);o&&a.show_catalog(r)}else a.show_catalog()}},remove_thread:function(e,t){for(var n=De.prototype.Clgs,a=0;a<n.length;a++)n[a].remove_thread(e,t)},__proto__:De.prototype}),this.footer=v.length>=2?Se.factory(this.mode,this.threads,this):(Se.clg=this,Se)};De.prototype={Clgs:[],destroy:function(e){var t=e.currentTarget.parentNode;cnst.div_destroy(e.currentTarget.parentNode,!0);var n=De.prototype.Clgs.map(function(e){return e.pn12}).indexOf(t);De.prototype.Clgs.splice(n,1)[0].footer.clg=null,1==De.prototype.Clgs.length&&De.prototype.hook_set(De.prototype.Clgs[0])},hook_set:function(e){Ke=e,cataLog.Footer=e.footer,Nt=e.show_catalog.bind(e),cataLog.show_catalog=Nt,cataLog.gClg=Ke},remove_thread:function(e,t){var n=this.idxs.indexOf(e),a=this.threads[e];if("ODL:"!==e.substr(0,4)){if(!a)return;var r=liveTag.mems.getFromName(e);t||r.q&&site2[r.domain].popups_release_all(r,{}),a[1]&&(a[0]&&a[0].parentNode===this.ppn&&this.func_hide(e),site2.DEFAULT.update_posts_merge_bases.remove_th(a[16],!0),n<this.drawn_idx&&(this.drawn_idx=0))}if(t)return a[0]=!1,a[1]=!1,a[16].th=a[7],a[16].posts=null,void(a[24]&&(a[24][0]=null));delete this.threads[e],pref.debug_mode[2]&&console.log("removed: "+e),n>=0&&this.idxs.splice(n,1),pref.test_mode[95]&&"dist"===site.nickname&&site2[site.nickname].testPoster(e)}};var Ue=new De(_,p),ze=Ue.pn12,Re=Ue.pn12_0,Me=Ue.pn12_1,He=Ue.pn12_0_2,Fe=Ue.pn12_0_4,qe=Ue.board_sel,Xe=Ue.threads;Se.threads=Ue.threads,cataLog.threads=Xe;var We=Ue.idxs,Pe={};Object.defineProperty(Ue,"idxs",{get:function(){return We},set:function(e){We=e}}),Object.defineProperty(Ue,"order",{get:function(){return pref.catalog.order}}),Object.defineProperty(Ue,"ppn",{get:function(){return et},set:function(e){et=e}});var Ke=Ue;cataLog.gClg=Ke,cataLog.components={catalog:{indexing:Fe.getElementsByTagName("select")["catalog.indexing"]},pn12_0:Re,pn12_0_4:Fe,pn_hi:null},"catalog"!==p&&"page"!==p&&"thread"!==p||(He.getElementsByTagName("span").hide_at_embed.style.display="none",Fe.getElementsByTagName("div").hide_at_embed.style.display="none");var Ye="text"===pref.catalog.text_mode.mode?"catalog.text_mode.mode.graphic":"catalog.text_mode.mode.text";Fe.getElementsByTagName("span")[Ye].style.display="none","thread"===p&&pref_func.pref_overwrite(pref.catalog.filter,pref_default().catalog.filter),V(null,pref.catalog.filter.kwd,!0),pref_func.tooltips.add_root(Fe),pref_func.apply_prep(Fe,!1,null,null,!0);for(var Ge=Fe.getElementsByTagName("select"),Je=0;Je<Ge.length;Je++)cnst.auto_shrink_selector(Ge[Je]);var Qe,Ve=Fe.childNodes[1],Ze={"catalog.filter.kwd.str":function(){var e=Ve.getElementsByTagName("*")["catalog.filter.kwd.use"];return function(t){pref.catalog.filter.kwd.use==!pref.catalog.filter.kwd.str&&(pref.catalog.filter.kwd.use=!pref.catalog.filter.kwd.use,pref_func.apply_prep(e,!1)),t&&".str"===t.target.name.substr(-4,4)&&pref3.catalog.filter.kwd.str(t),Z(t,pref.catalog.filter.kwd)}}(),"catalog.filter.list_str":function(){ae(),pref[p].mark_new_posts&&mt.time_filter_changed()},"catalog.filter.attr_list_str":function(){pref.catalog.filter.attr_list&&re()},"catalog.filter.tag_search.str":liveTag.popup_filter.oninput_funcs["catalog.filter.tag_search.str"],__proto__:pref_func.settings.oninput_funcs.__proto__},$e={refresh:function(){at.timer_tgt(!0)},catalog_board_list_sel:function(e,t){t||(e.target.blur(),pref.catalog.auto_save_filter&&$e.save(Qe),pref.catalog.refresh.at_switch&&me(0),_e(!1,Qe)),jt=Object.create(null),pref.catalog.auto_load_filter&&$e.load(),t||he(pref.catalog.refresh.at_switch,null,!1,!0),Qe=pref.catalog_board_list_sel},catalog_size_width:s,catalog_size_height:s,catalog_size_text_width:s,catalog_size_text_height:s,"catalog.indexing":B,"*.auto_update":function(){at.set()},"*.auto_update_period":"*.auto_update",clear_threads:function(){me(0),Nt()},load:function(){if(localStorage){pref_func.pref_overwrite(pref.catalog.filter,pref_default().catalog.filter);try{pref_func.pref_overwrite(pref.catalog.filter,JSON.parse(localStorage.getItem($e.load_save_key(qe.selectedIndex))),!0),pref_func.apply_prep(Ve,!1,null,null,!0),V(null,pref.catalog.filter.kwd,Oe),liveTag.filter_onchange(pref.catalog.filter.tag_search,!0),re()}catch(e){console.log(e)}}},save:function(e){if(localStorage){"number"!=typeof e&&(e=pref.catalog_board_list_sel);var t=pref.catalog.filter,n=JSON.stringify(pref_func.obj_elim_the_same(pref_default(!0).catalog.filter,pref.catalog.filter),t.time||t.time_watch||t.time_watch_creation||t.time_creation?void 0:function(e,t){return"time_str"===e?void 0:t}),a=$e.load_save_key(e);if(!a)return;"{}"===n?delete localStorage[a]:localStorage.setItem(a,n)}},load_default:function(){pref_func.pref_overwrite(pref.catalog.filter,pref_default().catalog.filter),pref_func.apply_prep(Fe,!1,null,null,!0),Z(null,pref.catalog.filter.kwd),re()},load_save_key:function(e){var t=pref.catalog_board_list_obj[e]
;return t?pref.script_prefix+".catalog.filter."+t[0].key:null},"catalog.filter.kwd.*":$,"catalog.filter.kwd.match":Z,"catalog.filter.kwd.re":Z,"catalog.filter.kwd.ci":Z,"catalog.filter.kwd.sentence":Z,"catalog.filter.kwd.post":function(e){$(e),e.target.checked&&(pref[cataLog.embed_mode].searchAs&&$e.scanBoard(e,!0,!0),pref[cataLog.embed_mode].searchAsA&&$e.scanSite(e,!0,!0))},"catalog.filter.tag":ae,"catalog.filter.time":Ze["catalog.filter.list_str"],"catalog.filter.time_creation":"catalog.filter.time","catalog.filter.time_str":"catalog.filter.time","catalog.filter.list":"catalog.filter.time","catalog.filter.watch_list_str":"catalog.filter.time","catalog.filter.attr_list":re,scanBoardIf:function(e){$e.scanBoard(e,!1,!0)},scanSiteIf:function(e){$e.scanSite(e,!1,!0)},scanBoard:function(e,t,n){!t&&pref.common.clear_at_manual_scan&&$e.clear_threads(),scan.keyword_load_1(site.nickname,!n||2,[site.board],Be)},scanSite:function(e,t,n){!t&&pref.common.clear_at_manual_scan&&$e.clear_threads(),scan.keyword_load(!n||2,Be)},"catalog.order.reply_to_me":B,"catalog.order.reply":B,"catalog.order.watch":B,"catalog.order.sticky":B,"catalog.filter.time_quick_sel":function(){i(null,36e5*[0,0,1,2,4,12,24,72,168][this.selectedIndex])},"catalog.filter.tag_search.re":"catalog.filter.tag_search.str","catalog.filter.tag_search.show_nof_boards":liveTag.popup_filter.onchange_funcs["catalog.filter.tag_search.show_nof_boards"],"tagB.*":liveTag.cbx_all_onchange,tag2bList:liveTag.add_tags_to_boardlist,add_to_auto:function(e){var t=pref.catalog.filter.auto_list,n=[t.kill?"KILL":null,t.watch?"WATCH":null,t.show?"SHOW":null,t.sticky?"STICKY":null,t.style?"ATTR:"+t.style_str:null].filter(function(e){return e}).join();if(""!==pref.catalog.filter.kwd.str){var a=pref_func.str2obj7.o2s({cmds:n,__proto__:pref.catalog.filter.kwd});pref.catalog.filter.auto_list.str+=a+"\n";var r=e.target.parentNode.getElementsByTagName("TEXTAREA")[0];pref_func.apply_prep(r,!1,null,null,!0)}},"filter.disable_list_when_kwd_active":function(){pref.catalog.filter.kwd.active&&ae()},"filter.disable_tag_when_kwd_active":"filter.disable_list_when_kwd_active",__proto__:Ze};window.addEventListener("beforeunload",r,!1),Ze=pref_func.add_onchange_format(Ze),$e=pref_func.add_onchange_format($e),pref_func.add_onchange(He,$e,Ze),cataLog.event_func=pref_func.add_onchange(Fe,$e,Ze),window.addEventListener("storage",site2[site.nickname].prep_own_posts_event,!1),site2[site.nickname].check_reply.make_own_posts(),Oe&&pref.virtualBoard.scan&&"thread"!==p&&setTimeout(function(){scan.keyword_load(!1,Be)},1e3*pref.virtualBoard.scanDelay);var et;Fe.childNodes[0];o(),cataLog.triage_parent_set=o,$e.catalog_board_list_sel(null,!0);var tt=new RegExp("#[^#, .:;\n]+(?=#|,| |.|:|;|\n|$)","g"),nt=function(){function e(e){return!i.args[e]||(i.args[e].max!=i.args[e].idx?(i.args[e].max=i.args[e].idx,i.args[e].indicator&&i.args[e].indicator.report({abort_str:"canceled"})):(i.args[e].indicator&&i.args[e].indicator.report({abort_str:"aborted",end:Date.now()}),delete i.args[e]),!1)}function t(t,a,r,o){if(pref.debug_mode[5]&&console.log("scan_init: "+t),o||e(t,!1)){if(Array.isArray(a)||(a=Object.keys(a)),0==a.length)return void(r.callback&&r.callback(r.callback_args));n(t,a,r)}}function n(e,t,n){i.pool||(i.pool={div:document.createElement("div"),parser:new DOMParser,doc:null,ths:null,dbt:null,tgts:null,tags:{cs:{},ci:{}},name:null,sticky:null,type:null,wrapper_obj:null}),i.args[e]={key:e,idx:0,max:t.length,max_threads:pref4.scan.max_threads,found_threads:0,found_boards:0,scanned:0,crawler:0,obj:t,lifetime:0,cache_write:!1,callback:null,callback_args:null,pool:i.pool,refresh:null,indicator:null,tgt_raw:!1,watchdog:null,from_auto:null,load_on_demand:null,senders_returned:[],priority:0,tgts_iterator:null,__proto__:i.args_proto};for(var a in n)i.args[e][a]=n[a];var o=i.args[e];if(o.load_on_demand&&!o.tgts_iterator){for(var a=0;a<o.obj.length;a++){var s=r(o,a);0===common_func.name2domainboardthread(s,!0)[2].search(/[cjpq][1-9]/)&&(ht.idx_insert_odl(s),o.obj.splice(a--,1))}if(0===o.obj.length){if(o.indicator&&o.indicator.remove(),o.callback)var l=o.callback,n=o.callback_args;return delete i.args[o.key],l?l(n):void 0}Ct.get()&&(o.callback=o.callback?function(e){return function(){Ct.release(),e()}}(o.callback):Ct.release),o.max=o.obj.length,Ue.drawn_idx=0}i.args_proto.init_func(o),httpd.req(o,o.priority<7?o.priority+1:1)}function r(e,t){var n=e.tgts_iterator?e.tgts_iterator.next().value:e.obj[t];if(n&&"string"!=typeof n){var a=128&n.u;n=n.key}var r;return n&&(r=cnst.name2domainboardthread(n,!0)),n?e.tgt_raw?n:""===r[2]?n+(pref.catalog.catalog_json|a?"j0":"c0"):pref.catalog.catalog_json&&r[2][0].search(/[0-9]/)!=-1?r[0]+r[1]+"t"+r[2]:n:n}function o(e,t,n,a){var r=n[1],o=e.split(",");if((200==t.status||304==t.status)&&t.response&&r.found_threads<r.max_threads)if("meguca1"===o[0]&&"catalog_json"===o[3]){for(var i=0;i<t.response.length;i++)liveTag.mems.init({domain:o[0],board:o[1],no:t.response[i]}),l[o[1]+t.response[i]]={page:parseInt(i/10)+"."+i%10,refresh:r.refresh||l[o[1]+t.response[i]]&&l[o[1]+t.response[i]].refresh},scan.list_nup.add(o[0]+o[1]+t.response[i],r.priority);scan.list_nup.got_200_board(o[0]+o[1])}else{var c={},_="thread_html"===o[3]||"thread_json"===o[3]?{thread:o[2]}:{page:o[2]};r.localArchive&&(_.localArchive=r.localArchive,_.page=r.page);var d=site2[o[0]].wrap_to_parse.get(t.response,o[0],o[1],o[3],_);if(r.localArchive){for(var i=0;i<d.length;i++)d[i].key=d[i].key.substr(0,d[i].key.lastIndexOf("/")+1)+d[i].posts[0].no;1===d.length&&(o[2]=d[0].posts[0].no)}if(r.force_annotate)for(var i=0;i<d.length;i++)Xe[d[i].key]&&d[i].pn&&Xe[d[i].key][0]!==d[i].pn&&(Xe[d[i].key][0]=d[i].pn,Xe[d[i].key][1]=!0,C(Xe[d[i].key],!0,!0,!0,d[i]),Xe[d[i].key][16].posts=d[i].posts);if(r.scanned+=d.length,pref.test_mode[22]){var u=r.pool.div,f="catalog_json"===o[3]||"catalog_html"===o[3];pref.catalog.filter.kwd.active||pref.catalog.filter.tag&&pt.length}else var h=pref.catalog.filter.kwd.active,g=pref.catalog.filter.tag&&liveTag.active.in;var b=r.refresh;if("meguca1"===o[0]&&"thread_json"===o[3]){var v=l[o[1]+o[2]];void 0!==v&&(b=v.refresh,d[0].page=v.page,delete l[o[1]+o[2]])}var y="post"===pref.liveTag.from||pref.stats.use||0===pref[p].deleted_posts.detect.indexOf("full")||"ALL_agg"===pref[p].storePosts||site2[o[0]].parse_funcs[o[3]].has_editing&&("page"===p||"thread"===p)||pref[p].backlink_all,w="ALL_agg"===pref[p].storePosts||"auto"===pref[p].storePosts&&pref4.search_posts_active_once?"ALL":pref[p].deleted_posts.detect;"no"===w&&"page"===p&&(w=pref[p].t2h_num_of_posts),pref[p].detect_sage&&"4chan"===o[0]&&"catalog_json"===o[3]&&site2["4chan"].sage_detect_all(d);for(var i=0;i<d.length;i++){var k=d[i];if(k.no)if(k.time_loaded=t.date,r.native_prep&&(k.native_prep=!0),pref.test_mode[33]&&"meguca1"===o[0]&&"thread_json"===o[3])scan.list_nup.got_200(k);else{if(pref.test_mode[22])r.scan_tag&&f&&("json"===k.type_data?u.innerHTML=k.name+"\n"+k.sub+"\n"+k.com:u=k.pn,k.tags=u[brwsr.innerText].match(tt));else{var T=liveTag.prep_tags(k),N=a&&ye(k,T,a);k.tags=T;var I=T.wt,A=Xe[k.key],L=A?void 0:k.tags,E=!(y||2883584&I[0])&&null;if(T.ed_t&&k.parse_funcs.has_posts){var j=[];L=liveTag.update_tags_in_editing_posts(k,T,j)||L,0===j.length&&(j=null)}T.q&&T.q.waiting&&k.parse_funcs.has_posts&&site2[k.domain].popups_fetched(k,T);var B=null,S=(T.archived||"no"!==w)&&!pref.test_mode[67]&&!r.localArchive,O=A&&A[16].get_t2h_num_of_posts()||"no",D="ALL"===w||"ALL"===pref[p].storePosts&&A?-1:"no"===w||"passive"===w&&"no"!==O?O:w;if(null!==E&&(T.nof_posts<k.nof_posts||393216&I[0])?"thread"===k.type_source||k.parse_funcs.has_posts&&k.posts.length>k.nof_posts-T.nof_posts&&(T.ta||0!==pref[p].deleted_posts.detect.indexOf("full"))||1===k.nof_posts&&k.posts[0].time>=0&&!k.parse_funcs.dont_have_com?(E=!0,B=site2[k.domain].check_reply.check(k,I,A,r.ext_posts||[]),pref[p].backlink_all&&site2[k.domain].popups_add_1_cross(k,B.posts,pref[p].backlink_all_cross),L=B.tags||L,scan.list_nup.got_200(k),pref.threadStats.use&&site2[k.domain].stats_ID&&(b||A)&&site2[k.domain].stats_ID(k,B.posts,T)&&scan.list_nup.add(k.key,0),S&&archiver.store(t,k,T,B.posts,B.time_check_old,D,j)):(scan.list_nup.add(k.key,r.priority),(j||pref.test_mode[129]&&"page"===p)&&S&&archiver.store(t,k,T,void 0,void 0,D,j)):(r.localArchive||scan.list_nup.got_200(k),pref.threadStats.use&&site2[k.domain].stats_ID&&(b||A)&&(site2[k.domain].stats_ID(k,null,T),pref.threadStats.retry&&pref.threadStats.full&&k.nof_posts<T.nof_posts&&"thread"===k.type_source&&scan.list_nup.add(k.key,0)),(pref.test_mode[129]&&"page"===p||T.rescan_dp||T.force_ar||j||T.nof_posts!=k.nof_posts&&k.parse_funcs.has_posts)&&S&&archiver.store(t,k,T,void 0,void 0,D,j),T.nof_posts!=k.nof_posts&&(T.nof_posts=k.nof_posts)),k.parse_funcs.has_editing){if(B&&"post"!==pref.liveTag.from){for(var U=void 0,z=0;z<B.posts.length;z++)B.posts[z].editing&&B.posts[z].no!=k.no&&(U?U[U.length]=B.posts[z]:U=[B.posts[z]]);U&&(T.ed_t=T.ed_t?U.concat(T.ed_t):U,pref.debug_mode[24]&&console.log(k.key+": lth.ed_t: "+T.ed_t.map(function(e){return"string"==typeof e?e:e.no+"("+e.time+")"})))}"catalog"===k.type_source&&(T.ed_p||T.ed_t)&&(T.archived||"no"!==pref[p].t2h_sel&&A)&&T.ed_u<k.replyTime&&scan.list_nup.add(k.key,r.priority)}}if(!pref.test_mode[32]||"meguca1"!==o[0]||"thread_json"!==o[3]){T.th&&(A?T.th.parse_funcs.missing_info&&(!k.parse_funcs.missing_info||k.parse_funcs.missing_info<T.th.parse_funcs.missing_info)&&(T.th.pn&&(k.pn=T.th.pn),T.th=k):delete T.th);var R="thread"===k.type_source&&"ALL_agg"===pref[p].storePosts,M=h&&At.kwd(pref.catalog.filter.kwd,k.posts,k.domain,k),H=g&&liveTag.search_by_tags(k.tags),F=M||H,q=void 0===A?void 0:A[9][0],X=A&&(A[16].expand_posts||"thread"===k.type_source&&A[16].needs_update===!0)||T.ed_u<k.replyTime||R;if(null===E&&A&&(b||F)){var W=A[8];E=!((W[0]>W[4]?W[0]:W[4]||W[0])>=(k.time_bumped>k.time_posted?k.time_bumped:k.time_posted||k.time_bumped)&&W[2]==k.nof_posts&&W[3]==k.nof_files)||"thread"===k.type_source}if(E&&(A||pref[p].promiscuous)||(b||F)&&!A||X){if(!A){var P=ft.get_t2h_num_of_posts.call({lth:T})||"no";"ALL"!==w&&("no"===w||"passive"===w&&"no"!==P)&&D!==P&&archiver.store_th_to_mem(t,k,T,P,null)}pref[p].scroll_lock&&vt.set(),x(k,t.date,M,N),c[k.key]=!0,A=Xe[k.key]}r.found_threads++,r.from_auto&&!q&&A[9][0]&&notifier.appeared(k,void 0===q),pref.test_mode[31]||A&&(k.page&&(A[14]=k.page),Ke.footer.update(k.key,k.country&&E,void 0!==q?L:k.tags)),T.usWT&&m(T.usWT)}}}if(pref.test_mode[22]&&r.scan_tag&&f&&s(d,r),"catalog_json"!==o[3]&&"catalog_html"!==o[3]||(scan.list_nup.got_200_board(o[0]+o[1]),Ne(o[0],o[1],d)),pref.catalog_max_page_auto&&("page_html"===o[3]||"catalog_json"===o[3]&&site2[o[0]].parse_funcs[o[3]].get_max_page)){var K=site2[o[0]].parse_funcs[o[3]].get_max_page(t.response);K&&(liveTag.mems[o[0]][o[1]].pgs=K)}if(pref[p].load_on_demand){var Y=d[d.length-1];!Y||"page"!==Y.type_source||site2[Y.domain].all_boards&&site2[Y.domain].all_boards.indexOf(site.board)==-1||ht.idx_raise_odl(Y)}0===Object.keys(c).length||r.native_prep||(r.found_boards++,Nt(c))}else if(404!=t.status||"thread_json"!==o[3]&&"thread_html"!==o[3]||(liveTag.rm_404_1(o[0],o[1],o[2]),scan.list_nup.got_404(o[0]+o[1]+o[2])),r.found_threads<r.max_threads&&404==t.status&&Ie(e),null===t.response&&200==t.status&&(pref.debug_mode[16]&&console.log("ERROR!!! Inconsistency in server. Server returned null with status 200 for "+site2[o[0]].make_url4(o)[0]+" , "+e),t.status=-200),404==t.status&&pref.catalog_max_page_auto&&("page_json"===o[3]||"page_html"===o[3])){var K=parseInt(o[2].replace(/^[pq]/,""),10);(!liveTag.mems[o[0]][o[1]].pgs||K<liveTag.mems[o[0]][o[1]].pgs)&&(liveTag.mems[o[0]][o[1]].pgs=K)}return!r.refresh||pref.test_mode[65]||!pref.archive.IDB.auto_restore||jt[o[0]]&&jt[o[0]][o[1]]||"catalog_json"!=o[3]&&"catalog_html"!==o[3]&&"page_json"!=o[3]&&"page_html"!==o[3]||window.opener||ke(o[0],o[1]),d}function s(e,t){for(var n={},r=0;r<e.length;r++)n[e[r].key]=e[r];a(n,"",t.pool.tags)}var i={args:{},pool:null};i.args_proto={callback_1:function(e,t,n){o(e.key2||"",t,[null,n])},get_tgt_func:function(e){if(e.IDX<e.max&&(e.refresh||e.found_threads<e.max_threads)){do{var t=r(e,e.IDX++)}while(e.IDX<e.max&&(!t||pref.catalog.board.ex_list&&pref_func.merge_obj5(t,pref.catalog.board.ex_list_obj2,{hit:!1}).hit));if(e.IDX<=e.max){var n=scan.list_nup.issued(t),a=common_func.name2dbt(t),o=site2[a[0]].make_url4(a),s=a.join(",");return{REQ:e,url:o[0],responseType:n?"text":"html"===o[1]?"document":o[1],tgt:t,key2:s,data_type:o[1],domain:a[0]}}}},callback:function(e){e.found_threads>=e.max_threads&&e.INDICATOR.report({err_str:"Aborted.(Reached upper limit)"}),delete i.args[e.key],0==Object.keys(i.args).length&&(i.pool=null),e.callback2&&e.callback2(e.callback_args)},init_func:function(e){Object.defineProperty(e,"idx",{get:function(){return this.IDX},configurable:!0}),Object.defineProperty(e,"indicator",{get:function(){return this.INDICATOR},configurable:!0}),Object.defineProperty(e,"tgts",{get:function(){return this.obj},configurable:!0}),Object.defineProperty(e,"initiator",{get:function(){return this.key},configurable:!0}),e.hasOwnProperty("callback")&&(e.callback2=e.callback,delete e.callback)}},i.args_proto.callback_1_fail=i.args_proto.callback_1,cataLog.scan_boards_keyword_callback2_default_args={refresh:!0,found_threads:0,get max_threads(){return pref4.scan.max_threads},found_board:0,scanned:0};var l={};return cataLog.scan_boards_keyword_callback2=o,cataLog.scan_init=t,{scan_init:t,scan_abort:function(e){t(e,{},{})},scan_boards_keyword_callback2:o}}();cataLog.scan_boards=nt;var at=function(){function e(){n&&(clearTimeout(n),n=null),pref.catalog_auto_update_countdown&&(Be.pn_countdown.textContent="")}function t(){Be.pn_countdown.textContent=a--,a<0?r():n=setTimeout(t,1e3)}var n=null,a=0,r=function(e){n=null,he(!0,null,!e),at.set()};return{set:function(){if(e(),pref[p].auto_update){var o=pref[p].auto_update_period||.5;pref.catalog_auto_update_countdown?(a=60*o,t()):n=setTimeout(r,6e4*o)}},stop_if_running:e,timer_tgt:function(){n&&(clearTimeout(n),n=null),r(!0)}}}();cataLog.auto_update=at,"archive"!==site.whereami&&at.set();var rt,ot,st=Ve.getElementsByTagName("*")["catalog.filter.time_str"],it=Ve.getElementsByTagName("textarea")["catalog.filter.watch_list_str"],lt=Ve.getElementsByTagName("textarea")["catalog.filter.list_str"],ct=Ve.getElementsByTagName("textarea")["catalog.filter.attr_list_str"],pt=[],_t=_?site2[site.nickname].catalog_get_native_scroll_area?site2[site.nickname].catalog_get_native_scroll_area():window:et.parentNode,dt=[],ut=function(){function e(e){for(var a=t.format_tgt,r=Xe[e],o=liveTag.mems.getFromName(e),s=0;s<a.length;s++)a[s][0].style.display=n[a[s][1]](r,o)?"none":""}var t=null,n={WATCH:function(e){return 786432&e[19][0]&&0===e[19][1]},UNWATCH:function(e){return!(786432&e[19][0])},SHOW:function(e){return e[16].icon_show_always},UNSHOW:function(e){return!e[16].icon_show_always},STICKY:function(e){return e[20]},UNSTICKY:function(e){return!e[20]},ARC:function(e,t){return t.archived},ARC1:function(e,t){return t.archived},UARC:function(e,t){return!t.archived}},a=function(){function n(){et.appendChild(rt),u=!1}function a(e,t){l||(u?rt=et.appendChild(rt):e.display="");var n=t.offsetLeft-et.scrollLeft;"Left"===pref.catalog_triage_place.slice(-4)?(e.left=n+"px",e.right=null):(e.right=et.offsetWidth-n-t.offsetWidth+"px",e.left=null);var a=t.offsetTop-et.scrollTop;"t"===pref.catalog_triage_place[0]?(e.top=t.offsetTop-et.scrollTop+"px",e.bottom=null):(e.bottom=window.innerHeight-a-t.offsetHeight+"px",e.top=null)}function r(n,r){if(pref.catalog_triage)if(pref.test_mode[127]){var o=n.currentTarget;if(p.cancel(),c===o)return;l||(u?rt=et.appendChild(rt):rt.style.display=""),pref.triage.show_always||(d.cancel(),d.delayed_do()),c&&c.removeEventListener("mouseout",_,!1);var i=o.offsetLeft-et.scrollLeft;"topLeft"===pref.catalog_triage_place||"bottomLeft"===pref.catalog_triage_place?(rt.style.left=i+"px",rt.style.right=null):(rt.style.right=et.offsetWidth-i-o.offsetWidth+"px",rt.style.left=null);var m=o.offsetTop-et.scrollTop;"topLeft"===pref.catalog_triage_place||"topRight"===pref.catalog_triage_place?(m<et.offsetTop&&(m=et.offsetTop),rt.style.top=m+"px",rt.style.bottom=null):(rt.style.bottom=window.innerHeight-m-o.offsetHeight+"px",rt.style.top=null),c=n.currentTarget,l=c.name,c.addEventListener("mouseout",_,!1),t.format_tgt&&e(l)}else{var o=n;if(pref.triage.show_always||f.restart(pref.triage.popdown_delay),c===o)return;a(rt.style,o),c=o,l=r,t.format_tgt&&e(l)}else s()}function o(){c&&(c.removeEventListener("mouseout",_,!1),c=null),s()}function s(){l&&(u?rt=rt.parentNode.removeChild(rt):rt.style.display="none",l=null),pref_func.tooltips.hide_if(rt)}function i(e){c=null,s()}var l=null,c=null,p=new DelayBuffer(o,100),_=DelayBuffer.prototype.delayed_do.bind(p),d=new DelayBuffer(s,pref.triage.popdown_delay),u=!0,f=new Watchdog(s,100);return{get_triaged_thread_name:function(){return l},change_mode:n,thread_in:r,off:s,off_delay:pref.test_mode[127]?function(){d.delayed_do(500)}:null,triage_in:pref.test_mode[127]?function(){d.cancel(),p.cancel()}:function(e){f.stop(),e.stopPropagation(),gGEH.triage_in2(e),gGEH.triage_in&&gGEH.triage_in(e)},triage_out:pref.test_mode[127]?function(){pref.triage.show_always||d.delayed_do(),p.delayed_do()}:null,thread_out2:i}}();return{get_triaged_thread_name:a.get_triaged_thread_name,change_mode:a.change_mode,thread_in:a.thread_in,off:a.off,off_delay:a.off_delay,triage_in:a.triage_in,triage_out:a.triage_out,set_trg:function(e){t=e},get_trg:function(){return t},format_buttons:e,thread_out2:a.thread_out2}}();d(),cataLog.triage=ut;var ft={get no(){return this.dbt[2]},get board(){return this.dbt[1]},get domain(){return this.dbt[0]},get key(){return this.dbt.join("")},get nof_posts(){return liveTag.mems.getFromName(this.key).nof_posts},get nof_files(){return Xe[this.key][8][3]},get tags(){return liveTag.mems.getFromName(this.key)},recent_posts:function(e,t,n){void 0!==e&&null!==e||(e=this.get_t2h_num_of_posts());var a=t;return e===!1||n||(pref.test_mode[113]?(this.th&&this.th.posts&&(a=site2[this.lth.domain].update_posts_replace_prep(a||this.th.posts,this.th.posts,e)),!this.posts||e==-1&&this.posts===a||(a=site2[this.lth.domain].update_posts_replace_prep(a||this.posts,this.posts,e))):this.lth.ta&&(a=site2[this.lth.domain].update_posts_replace_prep(null,this.lth.ta.posts,e))),t||(a&&this.lth.pd&&(a=a.filter(function(e){return!e.deleted_after})),(!a||e<0||a.length<=e)&&this.lth.ta&&(a=site2[this.lth.domain].update_posts_replace_prep(a||this.lth.ta.posts,this.lth.ta.posts,e)),a||(a=[this.op])),!pref.test_mode[64]&&pref[p].deleted_posts.merge&&this.lth.pd?k(this.lth,a,e,pref[p].t2h_sel):a},get_t2h_num_of_posts:function(){var e=this.t2h_sel||pref[p].t2h_sel;return"page"===e?this.t2h_page||pref[p].t2h_num_of_posts:"L"===e?pref[p].t2h_L:"M"===e?pref[p].t2h_M:"N"===e?pref[p].t2h_num_of_posts:"N_unread"===e?pref[p].t2h_num_of_posts+this.lth.nr:"unread"===e?this.lth.watched?this.lth.nr:this.t2h_page||pref[p].t2h_num_of_posts:"no"===e?0:-1},expand_num:function(){var e=this.get_t2h_num_of_posts()+1,t=this.nof_posts;return 0==e||e>t?t:e},expand:function(e){this.t2h_sel=mt.get_t2h_from_index(e);var t=this.expand_num(),n=this.recent_posts();if(n.length<t)this.expand_posts=!0,scan.scan_ui("expand_page",{tgts:[this.key],options:{refresh:!0}});else{var a={posts:n,__proto__:Xe[this.key][7]};site2[n[0].domain_html].page_json2html3_add_omitted_info(a,this.posts,a.posts),N(Xe[this.key],!1,!1,null,a),cataLog.show_catalog()}}};cataLog.set_watch_time_thread=T;var mt={prepare_html_prep_posts:function(e){site2[e.domain].wrap_to_parse.posts(e),"html"===e.type_data&&this.prepare_html_extract_params(e)},prepare_html_extract_params:function(e){if(!e.extracted){if(e.parse_funcs.filename){for(var t=0;t<e.posts.length;t++)e.posts[t].pn&&(e.posts[t].filename=e.parse_funcs.filename(e.posts[t]));e.filename=e.parse_funcs.filename(e)}e.parse_funcs.prep_mimic&&e.parse_funcs.prep_mimic(e),e.extracted=!0}},prepare_html:function(e,t){var n=Xe[e.key],a=(e.domain!==site.nickname||site.whereami+"_html"!==e.type_mimic)&&pref.catalog.mimic_base_site,r="page"!==p&&"thread"!==p||!site2[site.nickname].page_json2html3?"catalog":"page";if(pref.test_mode[92]&&(r="catalog"),a){if(t){var o="page"===r?site2[site.nickname].page_json2html3(e,e.board,e.op_img_url,!0):site2[site.nickname].catalog_json2html3(e,e.board,e.op_img_url);Object.defineProperty(e,"pn",{value:o,writable:!0,enumerable:!0,configurable:!0})}e.type_html=r,e.domain_html=site.nickname,e.parse_funcs_html=site2[site.nickname].parse_funcs[e.type_html+"_html"]}else"html"===e.type_data&&site2.common.remove_by_tagname(e.pn,"script");t&&(n[0]===!1&&(n[0]=e.pn,n[16].type_html=e.type_html,n[16].domain_html=e.domain_html,n[16].parse_funcs_html=e.parse_funcs_html),Object.defineProperty(e,"footer",{value:e.parse_funcs_html.footer(e),writable:!0,enumerable:!0,configurable:!0}),this.prep_anchor_links(e.pn,e))},prep_anchor_links:function(e,t){(pref.test_mode[109]||t.no!=site.no||t.board!=site.board||t.domain!=site.nickname)&&site2[t.domain].toplevel_anchor(e,t),site.nickname!==t.domain&&site2[t.domain].absolute_link(e)},prepare_html_post:function(e,t,n,a,r){t.pn||(t.pn=site2[e.domain_html].parse_funcs.post_json.pn(t),n||(n=e.lth.q)),r||this.prep_anchor_links(t.pn,e),site2[e.domain_html].format_pn(t.pn,n?n[t.no]:null,a,t,e),t.editing&&t.pn.classList.add(pref.script_prefix+"_post_editing")},get_t2h_from_index:function(e){return["page","L","M","N","N_unread","unread","all"][e]},get_t2h_index:function(e){var t=e[16].t2h_sel||pref[p].t2h_sel;return"page"===t?0:"L"===t?1:"M"===t?2:"N"===t?3:"N_unread"===t?4:"unread"===t?5:6},update_posts_in_page:function(e,t,n,a){var r=Xe[t],o=[],s=site2.DEFAULT.update_posts_merge_bases,i=!n||!r[1]&&s.initialized?null:s.base_tgts(e.key),l=r[1]&&i?s.query(r[16].posts&&r[16].posts!==e.posts?{pn:r[0],__proto__:r[16]}:e,i,!0):s.bases[e.key];!i||r[1]||s.initialized||s.setup_hook();var c=pref[p],_=a?{colorID:c.colorID&&!c.env.colorID_native,backlink:c.backlink&&!c.env.backlink_native,localtime:c.localtime&&!c.env.localtime_native}:c;if(l||r[16].posts&&(!a||a.init)&&r[16].posts!==e.posts){if(n){o=e.posts.slice();for(var d=0;d<e.posts.length;d++)mt.prepare_html_post(e,e.posts[d],e.lth.q,_,n)}site2[e.domain_html].update_posts_replace(e,r[16],r[0],l,r[1],o)}else{r[16].posts=e.posts,o=a?a.init?a.posts_shown:a.posts_updated:e.posts;for(var d=0;d<o.length;d++)mt.prepare_html_post(e,o[d],e.lth.q,_,n)}return n&&a&&"page"===p&&pref[p].use_expander_always&&site2[e.domain_html].page_json2html3_replace_expander(e.posts,mt.get_t2h_index(Xe[t]),t),o},replace_posts_by_search:function(e){var t=e[7];if(pref.catalog.filter.kwd.posts_active){if(e[10]!=pref.catalog.filter.kwd.timestamp||e[16].th){e[10]=pref.catalog.filter.kwd.timestamp;var n=At.kwd_make_result(e[16].recent_posts("auto"===pref[p].sourceOfSP?-1:null),t.domain);if(n){var a=!e[16].posts||e[16].posts.length!==n.length;if(!a)for(var r=n.length-1;r>=0;){if(e[16].posts[r].no!==n[r].no){a=!0;break}r--}e[16].posts&&e[16].posts[0]&&e[16].posts[0].pn&&e[16].posts[0].pn.classList.contains("CatChan_search_miss")==n[0].search_result&&site2[t.domain_html].update_posts0_class(e[16].posts[0].pn,n[0].search_result),a?(mt.prepare_html_prep_posts(t),e[16].th={posts:n,__proto__:t}):e[16].th&&(e[16].th=null)}else e[9][0]=!1,e[16].th=null}}else(e[10]||e[16].th)&&(e[16].th||(e[16].th={posts:e[16].recent_posts(null,null,!0),__proto__:t}),e[10]=!1);e[16].th&&e[7]&&e[16].posts===e[7].posts&&(e[7].posts=e[7].posts.slice())},posts_search_inactivated:function(){for(var e in Xe){var t=Xe[e][7],n=Xe[e][16];n.posts&&n.posts[0]&&n.posts[0].pn&&n.posts[0].pn.classList.contains("CatChan_search_miss")&&site2[t.domain_html].update_posts0_class(n.posts[0].pn,!0)}Ue.drawn_idx=0},hide_posts_without_images:function(e,t){for(var n=Xe[t][16].posts,a=0;a<n.length;a++){0===e.parse_funcs_html.tn_imgs(e.posts[a]).length&&(n[a].pn.style.display="none")}},update_draw:function(e,t){if(pref[p].mark_new_posts&&786432&Xe[e][19][0]){var n=F(e,pref.catalog.filter.time_watch||pref.catalog.filter.time_watch_creation,!0,!0);0===n&&"thread"===p&&(n=site2.DEFAULT.check_reply.get_checked_time(Xe[e][19])),n>0&&site2[Xe[e][16].domain_html].mark_newer_posts2(t,n,"thread"===p,!0)}},update:function(e){var t=pref[p].mark_new_posts&&786432&Xe[e][19][0]?F(e,!0,!0,!0):0;0===t&&(t=1/0),Xe[e][16].posts&&site2[Xe[e][16].domain_html].mark_newer_posts2(Xe[e][16].posts,t,null,!1)},time_filter_changed:function(){if("catalog"!==p)for(var e in Xe)this.update(e)}};cataLog.format_html=mt,cataLog.get_watch_time_of_a_thread=L,common_func.Object_defProps(De.prototype,function(){function e(e){var t=parseInt(e.substr(e.lastIndexOf("/")+2),10);return 0===t?{8:[void 0,void 0,void 0,void 0,void 0],__proto__:l}:{8:[-t,-t,-t,-t,-t],__proto__:l}}function t(t){return 0===t.indexOf(c)?r[t]||e(t):o[t]}function n(e,n,a){for(var r=s;r<i&&n(t(a[r]));)r++;n(e)?i=r:s=r}function a(e,a){var l=a.idxs;o=a.threads,r=a.threads_odl,s=0,i=l.length;var c=a.order,d=t(e);"dont_care"!==c.sticky&&n(d,"last"===c.sticky?p.sticky_last:p.sticky_first,l),c.reply_to_me&&n(d,p.reply_to_me,l),c.reply&&n(d,p.reply,l),"dont_care"!==c.watch&&n(d,"last"===c.watch?p.watch_last:p.watch_first,l);for(var u=_[pref.catalog.indexing%6],f=u(d[8]),m=pref.catalog.indexing>=5&&pref.catalog.indexing<11?function(e){return f>=u(e[8])}:function(e){return f<=u(e[8])},h=s;h<i&&m(t(l[h]));)h++;return h==l.length?l[l.length]=e:l.splice(h,0,e),h}var r,o,s,i,l={8:[0,0,0,0,0],19:[0,0,0]},c="ODL:",p={reply_to_me:function(e){return 786432&e[19][0]&&e[19][1]>>16!=0},reply:function(e){return 786432&e[19][0]&&0!=e[19][1]},watch_first:function(e){return 786432&e[19][0]},watch_last:function(e){return!(786432&e[19][0])},sticky_first:function(e){return e[20]},sticky_last:function(e){return!e[20]}},_={0:function(e){return e[0]||e[4]},4:function(e){return e[4]||e[0]},get 5(){var e=Se.ts_refresh;return function(t){return(e-t[1])/t[2]}},1:function(e){return e[1]},2:function(e){return e[2]},3:function(e){return e[3]}};return{idx_raise_odl:function(e){var t=this.idxs.indexOf(e.key);if(t!=-1)for(var n=c+e.domain+e.board;++t<this.idxs.length;)if(0===this.idxs[t].indexOf(n)){this.threads_odl[this.idxs[t]]={8:[e.time_posted||e.time_bumped,e.time_created,e.nof_posts,e.nof_files,e.time_bumped||e.time_posted],__proto__:l},a(this.idxs.splice(t,1)[0],this);break}},idx_delete_odl:function(e){for(var t=0;t<e.length;t++)delete this.threads_odl[c+e[t]]},idx_insert_odl:function(e){delete this.threads_odl[c+e],this.idx_reorder(c+e)},idx_re_sort:function(){var e=this.idxs.filter(function(e){return"ODL:"===e.substr(0,4)});this.idxs=[];for(var t in this.threads)a(t,this);this.idxs=this.idxs.concat(e),this.drawn_idx=0,this.show_catalog()},idx_reorder:function(e){var t=this.idxs.indexOf(e);t!=-1&&this.idxs.splice(t,1);var n=a(e,this);return n===t&&"page"!==this.mode||!(n<this.drawn_idx||t<this.drawn_idx)?"page"===this.mode&&this.drawn_idx===!0&&(this.drawn_idx=0):this.drawn_idx=0,n!==t||this.threads[e]&&this.threads[e][9][0]!=this.threads[e][1]}}}());var ht=Ue,gt=function(){function e(e,t,n){var a=w(e,t,n,"hover");if(a)return a.style.position="fixed",a.style.top="0px",a.style.right="0px",a.style.pointerEvents="none",a}function t(e){return e.currentTarget===site.popup_body?"page":p}function n(n,r){var o=t(n),i=n.target;if(pref[p].image_hover){var l,c=E&&E[1]===i;if(c)l=E[0],l.style.display="",E=null;else if(!(l=e(i,r,o)))return;l.style.zIndex=pref[p].thumbnail.hover.popup_zIndex,c||site.script_body.appendChild(l),n.preventDefault(),httpd.pause_req(),l.onload=s,l.onerror=httpd.pause_cancel,L&&a(),A=i,L=l}if(E&&(E[0].parentNode.removeChild(E[0]),E=null),pref[p].image_prefetch){var _=(O(i),site2[site.nickname].get_next_image(i));if(_){var d=e(_,null,o);d.style.display="none",site.script_body.appendChild(d),E=[d,_]}}}function a(){L&&site.script_body.removeChild(L),L=null}function r(){if(L)return i(L)&&(L.style.cursor="zoom-in",L.onclick=b),L}function o(){var e=L.style;e.position=null,e.pointerEvents=null,e.zIndex=null,e.top=null,e.right=null,"VIDEO"===L.tagName&&L.play(),L=null}function s(e){if(httpd.pause_cancel(),pref[p].thumbnail.hover.zoom){var t=e.target;i(t,!0)&&(A.addEventListener("mouseout",_,!1),A.addEventListener("mousemove",c,!1),A.addEventListener("click",d,!1),S={x:document.documentElement.clientWidth-t.clientWidth,y:t.clientHeight,state:null})}}function i(e,t){var n=pref[p].thumbnail.hover;if(t&&!n.zoom)return!1;var a=e.style;return n.limit_width&&e.naturalWidth>parseInt(a.maxWidth,10)||n.limit_height&&e.naturalHeight>parseInt(a.maxHeight,10)}function l(e){return e.clientX>S.x&&e.clientY<S.y}function c(e){l(e)?S.state||(e.target.style.cursor="zoom-in",S.state=!0):S.state&&(e.target.style.cursor="auto",S.state=!1)}function _(e){var t=e.currentTarget;t.removeEventListener("mouseout",_,!1),t.removeEventListener("mousemove",c,!1),t.removeEventListener("click",d,!1),t.style.cursor=null}function d(e){l(e)&&(e.stopPropagation(),e.preventDefault(),_(e),L.onmouseout=a,b({target:L,clientX:e.clientX,clientY:e.clientY}),u(L))}function u(e){e.style.pointerEvents="auto",e.draggable=!0,e.ondragstart=cnst.div_dragstart,e["on"+brwsr.mousewheel]=cnst.div_scroll}function f(e){return document.documentElement.clientWidth-pref[p].thumbnail[e].margin_width}function m(e){return document.documentElement.clientHeight-pref[p].thumbnail[e].margin_height}function h(e){var t=e.naturalWidth/(parseInt(e.style.maxWidth,10)||f("hover")),n=e.naturalHeight/(parseInt(e.style.maxHeight,10)||m("hover"));return t>n?t:n}function g(e,t,n){if(!t.top){t=e.target.parentNode.parentNode.style;var a=e.target.offsetTop,r=e.target.offsetLeft}t.top=parseInt(t.top,10)*n+((a||0)-e.clientY)*(n-1)+"px",t.right=parseInt(t.right,10)*n-(document.documentElement.clientWidth-(r||0)-e.clientX)*(n-1)+"px"}function b(e){var t=e.target,n=t.style;g(e,n,h(t)),n.maxWidth="none",n.maxHeight="none",n.cursor="zoom-out",t.onclick=v}function v(e){var t=e.target,n=t.style;g(e,n,1/h(t)),n.maxWidth=f("hover")+"px",n.maxHeight=m("hover")+"px",n.cursor="zoom-in",t.onclick=b}function y(e,t,n,a){var r=O(e);if(a||!pref[p].env.event_dynamic||void 0===n||("inline"===n?!pref[p].env.expand_thumbnail_inline_native:!pref[p].env.image_hover_native)){if(!r&&pref.test_mode[106]&&pref.test_mode[107])return e.src;var o=pref.catalog.mimic_base_site?site.nickname:Xe[r][16].domain_html;if("catalog"!==site2[o].general_event_handler[site.whereami].image_hover_check_mode(e))return site2[o].parse_funcs.post_html.img2src(e)||e.src;if(r){var s=liveTag.mems.getFromName(r);return site2[s.domain].parse_funcs[s.th.type_parse].get_op_src(s.th,e)}}}function w(e,t,n,a,r){var o=e.cloneNode();if(t||(t=y(e,n,a,r)),t){var s=0===t.search(/^blob/)?site2.DEFAULT.parse_funcs.post_html.img2ext(e):"";if(t.indexOf("data-ext")!=-1&&(s=t.slice(t.indexOf("data-ext")+10).replace(/".*/,""),t=t.replace(/".*/,"")),".webm"===t.substr(-5,5)||".webm"===s||".webm"===e.getAttribute("data-ext")){if(!pref[p].thumbnail[a].webm||r)return null;if(L&&L.src===t)o=L,L=null,o.style.position=null,o.style.top=null,o.style.right=null,o.style.pointerEvents=null;else{var o=document.createElement("video");o.controls=!0,o.autoplay=!0}pref.test_mode[63]||(o.loop=pref[p].thumbnail[a].webm_loop,o.muted=pref[p].thumbnail[a].webm_mute)}return o.src=t,o.style.width="auto",o.style.height="auto",pref[p].thumbnail[a].limit_width&&(o.style.maxWidth=document.documentElement.clientWidth-pref[p].thumbnail[a].margin_width+"px"),pref[p].thumbnail[a].limit_height&&(o.style.maxHeight=document.documentElement.clientHeight-pref[p].thumbnail[a].margin_height+"px"),o}}function k(e,n){var a=t(e||{currentTarget:this});if(pref[p].expand_thumbnail_inline&&B.indexOf(this)==-1){var r=w(this,null,a,"inline",n);if(!r)return void T.call(this);"VIDEO"!==r.tagName&&(r.style.display="none",r.addEventListener("load",x,!1),this.style.opacity=.5),this.parentNode.insertBefore(r,this.nextSibling),
B.push(r),e&&e.preventDefault(),"VIDEO"===r.tagName&&(x.call(r),r.play())}}function x(){this.previousSibling.style.display="none",this.style.display="",this.previousSibling.style.opacity="",this.removeEventListener("load",x,!1),this.onclick=I,site2[site.nickname].format_expanded_thumbnail&&site2[site.nickname].format_expanded_thumbnail(this);var e=B.indexOf(this);e>=0&&B.splice(e,1),site.patch.expand_thumbnail_inline_load&&site.patch.expand_thumbnail_inline_load.call(this),T.call(this)}function T(){if(pref[p].expand_thumbnail_inline&&(pref[p].expand_thumbnail_initial||pref[p].expand_thumbnail_inline_all_after)){var e=site2[site.nickname].get_next_image(this,K());e&&"none"!==e.style.display&&N(e)}}function N(e){var t,n=P(pref[p].thumbnail.inline.ref_height/100);if(Array.isArray(e)){for(var a,r=K(),o=0;o<e.length;o++){var s=e[o].offsetTop;(s>=r&&s<t||0===o)&&(a=e[o],t=s)}e=a}else t=e.offsetTop;t<n||!pref[p].thumbnail.inline.ondemand?(j=null,k.call(e,null,!0)):j=e}function C(e){j?Array.isArray(j)?j[j.length]=e:j=[j,e]:j=e,yt()}function I(e){if(this.previousSibling.style.display="",e.preventDefault(),this.getAttribute("data-originalWidth")){this.parentNode.parentNode.style.width=this.getAttribute("data-originalWidth")}this.parentNode.removeChild(this)}var A=null,L=null,E=null,j=null,B=[],S=null;return{image_hover_add:n,image_hover_remove:a,image_hover_reentry:function(e,t){t||(t=p),L&&L.src===e.src&&(L.src=y(e,t))},image_hover_snatch:r,image_hover_snatch_end:o,get hover_ex(){return L},expand_thumbnail_inline:k,expand_thumbnail_on_demand:function(){j&&N(j)},expand_thumbnail_queue_add:C}}();cataLog.DIH=gt,cataLog.image_hover_reentry=gt.image_hover_reentry;var bt,vt=function(){function e(){r.cancel(),a=null}function t(){var e=a[0].offsetTop||0,t=e-a[1]+a[2];t<0&&(t=0),e&&K()!==t&&(window.scrollTo(0,t),s())}function n(e){if(null===a||e){if(!e&&!(e=o.id?i:cataLog.general_event_handler.get_last_viewed()||i))return;a=[e,e.offsetTop,K()],i=e}o.restart(),s()}var a=null,r=new Watchdog(t,5),o=new Watchdog(e,100),s=Watchdog.prototype.restart.bind(r),i=null;return{modified:function(e){e.pn&&a&&a[0]===e.pn?(t(),a=null,n(site2[site.nickname].general_event_handler[site.whereami].get_mark_from_height(e.pn.offsetTop)),cataLog.general_event_handler.clear_last_viewed()):n()},set:n}}();cataLog.show_catalog_scroll_lock=vt;var yt=new DelayBuffer(W,200).get_binded_delayed_do();cataLog.show_catalog_cont=yt;var wt=null;cataLog.get_ref_height=P;var kt,xt={show_catalog:function(e){if(pref.debug_mode[11])var t=Y(this.drawn_idx,this.drawn_y,this.ref_count,this.idxs);pref.test_mode[23]&&(this.drawn_idx=0);var n=pref[p].draw_on_demand&&this.permit_draw_on_demand,a=n&&pref.network.adaptive,r=0;if(n){var o=P(pref[cataLog.embed_mode].merge?4:this.disp_th20?.2:this.disp_th100?1:1.5);if(0!==this.drawn_idx&&this.drawn_y>=o){if(!(this.ppn.offsetTop+this.ppn.offsetHeight<this.drawn_y))return;this.drawn_y=-1}}pref[p].scroll_lock&&vt.set();var s;"string"==typeof e?(s={},s[e]=null):s=e;var i=s?Object.keys(s).length:void 0,l=ut.get_triaged_thread_name(),c="float"===p&&pref.catalog_expand_with_hr||pref[p].env.disp_filler;if(void 0!==s)for(var _=0;_<this.drawn_idx;_++)if(this.idxs[_]in s){this.drawn_idx=_;break}this.ref_count_init=pref[p].env.disp_offset,c&&(this.ref_count_init=G(this.ref_count_init)),n&&0!==this.drawn_idx&&this.drawn_idx!==!0||this.func_track_reset();for(var d="",_=0,u=this.drawn_idx,f=!(!pref[cataLog.embed_mode].merge_list||!pref.proto.merge_first||pref[cataLog.embed_mode].merge)&&null,m=pref[cataLog.embed_mode].lazyDraw.step,h=!1;_<this.idxs.length;){var g=this.idxs[_],b=this.threads[g];if("ODL:"===g.substr(0,4)){if(""===d){d=g,Ct.call([d.substr(4)])&&this.idxs.splice(_,1);break}}else{if(n&&this.drawn_y>=o){if(!this.lazy_draw||f===!1)break;if(null===f&&(f=_+1),!site2.DEFAULT.update_posts_merge_bases.isShownForTails(g)){_++;continue}}if(0===i&&f===!1)break;if(_>=u&&(_%m==0&&(h=!0),n||void 0===s||g in s)){if(null===b[9][0]&&(b[9]=ee(g,!0)),b[9][0]&&("page"===p||pref.test_mode[52])&&mt.replace_posts_by_search(b),b[9][0]){if(b[0]&&!b[16].th||(N(b,!b[0],!1,!0),a&&(++r==pref.network.th100?(o=P(1),this.disp_th100||(this.disp_th100=setTimeout(function(){this.disp_th100=null,this.show_catalog()}.bind(this),pref.network.th100_delay))):r===pref.network.th20&&(o=P(.2),this.disp_th20||(clearTimeout(this.disp_th100),this.disp_th20=setTimeout(function(){this.disp_th20=null,this.show_catalog()}.bind(this),pref.network.th20_delay)),a=!1))),this.footer.draw(g),f){b[1]||this.func_show(g,null,c)&&(b[1]=!0),_++;continue}var v;if(void 0!==s){for(var y=_-1;y>=0&&("ODL:"===this.idxs[y].substr(0,4)||!this.threads[this.idxs[y]][1]||this.func_search_ref&&this.func_serach_ref(this.idxs[y]));)y--;y>=0?(v=this.threads[this.idxs[y]][0].nextSibling,c&&v&&(v=v.nextSibling)):v=this.ppn.childNodes[this.ref_count_init]}else v=this.ppn.childNodes[this.ref_count];v===b[0]&&b[1]||(this.func_show(g,v,c)&&(b[1]=!0),pref.test_mode[127]&&l&&(ut.off_delay(),l=null)),b[1]&&(this.func_track_shown(g,n&&h),h=!1)}else b[1]&&(Pe[g]&&le(g),this.func_hide(g,c)&&(b[1]=!1),pref.test_mode[127]&&l&&(ut.off_delay(),l=null));void 0!==s&&void 0!==s[g]&&i--}_++}l===g&&(l=null)}if(f&&(_=f-1),this.drawn_idx=!n||_==this.idxs.length||(_<u?u:_),this.lazy_draw&&this.lazy_draw(),pref.debug_mode[11]&&"thread"!==p&&!pref[p].merge){for(var w=-1,k=0,x=0;x<_;x++)if("O"!==this.idxs[x][0]&&this.threads[this.idxs[x]][1]){var T,C,I=common_func.fullname2dbt(this.idxs[x]);if("page"===p&&"4chan"===site.nickname?(T=this.ppn.getElementsByClassName("CatChan_thread")[k++],C=site.board+T.id.substr(1)):"page"===p&&"8chan"===site.nickname?(T=this.ppn.getElementsByClassName("CatChan_thread")[k++],C="/"+T.getAttribute("data-board")+"/"+T.id.substr(7)):(T=this.ppn.childNodes[pref[p].env.disp_offset+k++],C="page"===p?"/"+T.getAttribute("data-board")+"/"+T.id.substr(7):T.getElementsByTagName("a")[0].getAttribute("href").replace("res/","").replace(".html","").replace(/.*lainchan.org/,"").replace(/.*8ch.net/,"").replace("thread/","").replace(/.*4chan.org/,"").replace(/.*meguca.org/,"").replace(/.*krautchan.net/,"").replace(/thread\-/,""),"4chan"===I[0]&&"catalog"===p&&(C=C.substr(0,C.lastIndexOf("/")))),I[1]+I[2]!==C){for(var A="",y=x+1;y<x+5;y++)A+=this.idxs[y]+", ";console.log("ERROR: "+x+", "+C+", "+this.idxs[x]+": "+_+", "+A),w=_}}var L=Y(this.drawn_idx,this.drawn_y,this.ref_count,this.idxs);if(w!=-1){console.log("PREV: "+kt),console.log("IN:   "+t);for(var _=0;_<w+5;_++)this.ppn.childNodes[_]&&console.log(this.ppn.childNodes[_]);console.log("OUT:  "+L)}kt=L}},func_show:function(e,t){return this.ppn.insertBefore(this.threads[e][0],t&&t.parentNode===this.ppn?t:null),!0},func_hide:function(e){return this.ppn.removeChild(this.threads[e][0]),!0},func_track_shown:function(e,t){t&&(this.drawn_y=this.threads[e][0].offsetTop),this.ref_count+=this.ref_step},func_track_reset:function(){this.ref_count=this.ref_count_init,this.drawn_y=-1,this.drawn_idx=0},permit_draw_on_demand:!0,ref_step:1,drawn_y:-1,ref_count:0,ref_count_init:0};pref.test_mode[96]&&"catalog"===p&&(xt={func_track_shown:function(e){return function(t,n){var a=this.drawn_y,r=this.od_count%this.od_width==0;e.call(this,t,n&&r),r&&a==this.drawn_y&&this.od_width++,this.od_count++}}(xt.func_track_shown),func_track_reset:function(e){return function(){e.call(this),this.od_count=0}}(xt.func_track_reset),func_od_reset:function(){this.od_width=1,yt()},od_width:1,od_count:0,__proto__:xt}),_t.addEventListener("scroll",yt,!1),window.addEventListener("resize",pref.test_mode[96]&&"catalog"===p?xt.func_od_reset.bind(xt):yt,!1);var Tt=xt;"page"===p&&site2[site.nickname].all_boards&&site2[site.nickname].all_boards.indexOf(site.board)!=-1?Tt={func_show:function(e){var t=this.threads[e][0];return!(!t.previousSibling||"H2"!==t.previousSibling.tagName)&&(t.previousSibling.style.display="",t.style.display="",!0)},func_hide:function(e){var t=this.threads[e][0];return!(!t.previousSibling||"H2"!==t.previousSibling.tagName)&&(t.previousSibling.style.display="none",t.style.display="none",!0)},permit_draw_on_demand:!1,__proto__:xt}:pref[p].env.disp_filler?Tt=function(e){return{func_show:function(e,t){var n=this.threads[e][1]&&this.threads[e][0].nextSibling||this.filler.cloneNode(!1);return this.ppn.insertBefore(this.threads[e][0],t),this.ppn.insertBefore(n,t),!0},func_hide:function(e){return this.ppn.removeChild(this.threads[e][0].nextSibling),this.ppn.removeChild(this.threads[e][0]),!0},ref_step:2,filler:e,__proto__:xt}}("<"===pref[p].env.disp_filler[0]?document.createElement("hr"):document.createTextNode(pref[p].env.disp_filler)):"float"===p&&pref.catalog_expand_with_hr&&(Tt={func_show:function(e,t){return this.threads[e][1]&&J(e,"remove"),this.ppn.insertBefore(this.threads[e][0],t&&t.parentNode===this.ppn?t:null),J(e,"add"),!0},func_hide:function(e){return J(e,"remove"),this.ppn.removeChild(this.threads[e][0]),!0},func_track_shown:function(e,t){this.__proto__.func_track_shown.call(this,e,t),this.ref_count=G(this.ref_count)},__proto__:xt}),common_func.Object_defProps(De.prototype,Tt);var Nt=Ue.show_catalog.bind(Ue);cataLog.show_catalog=Nt,cataLog.catalog_obj2=Ue;var Ct=function(){function e(){n&&(clearTimeout(n),n=null),t=!0}var t=!0,n=null;return{call:function(e){return!!this.get()&&(ht.idx_delete_odl(e),nt.scan_init("on_demand_load",e,{refresh:!0,crawler_max:1,callback:Ct.release_draw}),!0)},release:e,release_draw:function(){e(),Nt()},get:function(){var a=t;return a&&(n=setTimeout(e,1e3*pref.catalog_load_on_demand_timeout)),t=!1,a}}}(),It=0,At=function(){function e(e,n,a,r,o){if(e.op&&t(e,n,a[0].DUMMY&&o||a[0],r))return!0;if(e.post)for(var s=1;s<a.length;s++)if(t(e,n,a[s],r))return!0;return!1}function t(e,t,n,a){if(e.sub&&n.sub&&t.test(n.sub))return!0;if(e.name&&n.name&&t.test(n.name))return!0;if(e.com)if(n.parse_funcs&&"txt"===n.parse_funcs.type_com){if(t.test(n.body||n.com))return!0}else{var r=site2[a].post_com2txt(n);if(r&&t.test(r))return!0}if(e.trip&&n.trip&&t.test(n.trip))return!0;if(e.id&&n.id&&t.test(n.id))return!0;if(e.file){if(n.filename&&t.test(n.filename))return!0;if(n.extra_files)for(var o=n.extra_files.length-1;o>=0;o--)if(n.extra_files[o].filename&&t.test(n.extra_files[o].filename))return!0}return!!(e.meta&&n.no&&t.test(n.no))||!!(e.flag&&n.country&&t.test(n.country))}document.createElement("div");return{kwd:function(t,n,a,r){if(!t.use||!t.rexps)return!0;for(var o=t.match%2==1,s=!!(t.match>=2^o),i=0;i<t.rexps.length;i++)if(s===e(t,t.rexps[i],n,a,r))return o;return!o},kwd_1:function(e,n,a){for(var r=e.match>=2,o=0;o<e.rexps.length;o++)if(t(e,e.rexps[o],n,a))return!r;return r},kwd_make_result:function(e,t,n){n||(n=pref.catalog.filter.kwd);var a=[Object.create(e[0])];a[0].search_result=this.kwd_1(n,e[0],t);for(var r=1;r<e.length;r++)this.kwd_1(n,e[r],t)&&(a[a.length]=e[r]);return 1!=a.length||a[0].search_result?a:null},auto_list:function(e,t){for(var n=0;n<t.length;n++)if(t[n].use!==!1&&this.kwd({use:!0,__proto__:t[n]},e.posts,e.domain,e))for(var a=t[n].cmds.split(","),r=0;r<a.length;r++){var o=a[r].indexOf(":");o===-1?h(e.key,a[r],""):h(e.key,a[r].slice(0,o),a[r].slice(o+1))}}}}();cataLog.catalog_filter_query_keyword=At,cataLog.catalog_filter_query=ee,cataLog.catalog_filter_changed=ae;var Lt={};cataLog.pop_up_set_contents=pe;var Et=null;cataLog.catalog_clear_threads=me,cataLog.catalog_refresh_1=ge,cataLog.catalog_refresh_end=be,c&&site2[site.nickname].catalog_frame_prep(ze),_&&(setTimeout(function(){cnst.tb_prep_for_embed(Re),Re.appendChild(Fe),site2[site.nickname].catalog_native_prep(Date.now(),Fe,Re,"catalog"===p);var e=ve(null,null,!0);if("page"===p&&site2[site.nickname].all_boards&&site2[site.nickname].all_boards.indexOf(site.board)!=-1||"thread"===p&&pref.thread.env.auto_update_native){new MutationObserver(ve).observe("page"===p?e[0].pn.parentNode:e[0].pn,{childList:!0}),ut.change_mode()}if(bt&&bt(),!pref.catalog.filter.kwd.active||"page"!==p&&"catalog"!==p||Nt(),0!==pref.catalog_board_list_sel&&(!pref.catalog.board.all_boards||pref.catalog_board_list_sel!==pref.catalog_board_list_obj.length-1)){var t=cataLog.catalog_refresh_1(p,!1,!1,!1,!1,pref.catalog_board_list_sel,!1,!1,null,!0),n=site.nickname+site.board+("catalog"===p?"c0":"page"===p?"p0":site.no),a=site.nickname+site.board+("catalog"===p?"j0":"page"===p?"q0":"t"+site.no);Array.isArray(t)&&pref.catalog.refresh.at_switch&&t.indexOf(n)===-1&&t.indexOf(a)===-1&&me(0)}},0),ze.parentNode.removeChild(ze)),cataLog.insert_myself=ve,window.opener&&window.name&&"A"===window.name.slice(-1)||"archive"===site.whereami||setTimeout(function(){(0!=pref.catalog_board_list_sel||pref[p].env.refresh_initial)&&he("boards"!==site.whereami,_,!1)},1),(pref[p].merge||pref[p].merge_list)&&setTimeout(site2.DEFAULT.update_posts_merge_bases.onchange_merge.bind(null,{target:{name:p+".merge"+(pref[p].merge?"":"_list")}}),2);var jt=Object.create(null);cataLog.restore_th_from_IDB=Te;Oe=!1,pref_func.mirror_targets.pn12_0_2=He,pref_func.mirror_targets.pn12_0_4=Fe;var Bt=function(e){this.parent=e,this.subscribers=[],this.valid=null,this.last_viewed=null,this.last_Y=0};Bt.prototype={setup:function(e){!pref[p].scroll_lock||this.valid||e?this.valid&&(this.parent.removeEventListener("mouseover",this.valid,!0),this.valid=null):(this.valid=this.mouseover_lock.bind(this),this.parent.addEventListener("mouseover",this.valid,!0))},mouseover_lock:function(e){this.last_viewed=e.target,this.last_Y=e.clientY},change:function(){var e=pref.script_prefix+"_expander";return function(t){if(t.target.className===e){var n=t.target.getAttribute("data-key");cataLog.threads[n][16].expand(t.target.selectedIndex),t.target.blur()}}}(),blacklist_click:new WeakSet,geh:site2[site.nickname].general_event_handler[site.whereami],click:function(e){function t(e,t,n){var n=t.target,a=document.createElement("span");if(a.innerHTML=' [<a data-cmd="'+pref.script_prefix+'_remove_next">Remove</a>] ',!n.nextSibling||n.nextSibling.innerHTML!==a.innerHTML){t.target.parentNode.insertBefore(a,n.nextSibling);var r=document.createElement("div");r.innerHTML='<iframe src="'+e+'" width="640" height="360" frameborder="0" allowfullscreen=""></iframe>',r.classList.add("media-embed"),n.parentNode.insertBefore(r,a.nextSibling)}t.stopPropagation(),t.preventDefault()}var n=e.target;if(pref.test_mode[104]){if("A"===n.tagName){if(pref.test_mode[93]){var a=n.getAttribute("download");if(a){var r=n.getAttribute("href"),o=r.search(/^(https*:)*\/\//)!=-1&&r.replace(/^(https*:)*\/\//,"").match(/^([^\/]*)\//)[1];if(site2.ALL[o]&&(o=site2[site2.ALL[o]].nickname),o!=site2[site.nickname].domain_url)return httpd.req({tgts:[{url:r,domain:o,archive:a,responseType:"blob"}],max:1,initiator:"download",callback_1:function(){}},6),e.preventDefault(),void e.stopPropagation()}}if(pref.test_mode[87])if(n.href.indexOf("//www.youtube.com")!==-1)t(n.href.replace(/watch\?v=/,"embed/"),e);else if(n.href.indexOf("//youtu.be")!==-1)t(n.href.replace(/youtu.be/,"youtube.com/embed"),e);else{var s=n.getAttribute("data-cmd");s&&0===s.indexOf(pref.script_prefix)&&"remove_next"===(s=s.substr(pref.script_prefix.length+1))&&function(e){e.target.parentNode.parentNode.removeChild(e.target.parentNode.nextSibling),e.target.parentNode.parentNode.removeChild(e.target.parentNode)}(e)}}}else{var i=Bt.prototype.geh.isThumbnail(e);if("catalog"!==cataLog.embed_mode||!i&&"entire"!==pref[cataLog.embed_mode].click_area){if(i){var l=site2.DEFAULT.popups_posts.href2domain(n.getAttribute("src"));Bt.prototype.blacklist_click.has(n)||pref[p].env.expand_thumbnail_inline_native&&pref[p].env.event_dynamic&&l===site.nickname||gt.expand_thumbnail_inline.call(e.target,e)}}else{e.preventDefault();var c=gGEH.get_key_recursive(e.target,e.currentTarget);c&&z(c)}}},get_last_viewed:function(){return this.last_viewed?site2[site.nickname].general_event_handler[site.whereami].get_mark(this.last_viewed,K()+this.last_Y):null},clear_last_viewed:function(){this.last_viewed=null},init:function(){site2[site.nickname].parse_funcs[site.whereami+"_html"].dynamic_image_hover,site2[site.nickname].general_event_handler[site.whereami];common_func.dom_addEventListener(this.subscribers,this.parent,"change",this.change),(pref.test_mode[87]||pref.test_mode[93]||!pref.test_mode[104])&&common_func.dom_addEventListener(this.subscribers,this.parent,"click",this.click),pref.test_mode[104]||site.popup_body.addEventListener("click",this.click,!1),this.setup(),this.parent.addEventListener("dragstart",this.dragstart,!1),this.parent.addEventListener("dragend",this.dragend,!1),site.popup_body.addEventListener("dragstart",this.dragstart,!1),site.popup_body.addEventListener("dragend",this.dragend,!1)},destroy:function(){this.setup(!0),common_func.dom_removeEventListener(this.subscribers)},mouseover:function(e,t){var n=e.target;site2.DEFAULT.popups_posts.over(e,t),pref.liveTag.info&&pref.tooltips.info.show&&(n.className===pref.script_prefix+"_tag"?pref_func.tooltips.req_show("info",e,liveTag.tag_onmouseover):pref_func.tooltips.hide2())},mouseleave_bl:function(e){pref.liveTag.info&&pref_func.tooltips.hide2()},drag_sx:0,drag_sy:0,dragstart:function(e){var t=Bt.prototype;t.drag_sx=e.screenX,t.drag_sy=e.screenY},dragend:function(e){if(pref[p].thumbnail.hover.dragfloat&&(gt.hover_ex||"IMG"===e.target.tagName)){var t=Bt.prototype,n=gt.image_hover_snatch(),a=(n?parseInt(n.style.right,10):cnst.left2right(e.clientX-e.offsetX,e.target))-(e.screenX-t.drag_sx),r=(n?parseInt(n.style.right,10):e.clientY-e.offsetY)+e.screenY-t.drag_sy;cnst.init3({func_str:"right:"+a+"px:top:"+r+"px:tb:ftb:overflow:auto:Show"}).cn.appendChild(n||e.target.cloneNode()),n&&gt.image_hover_snatch_end()}}},cataLog.GEH=Bt,cataLog.general_event_handler=new Bt(et),setTimeout(cataLog.general_event_handler.init.bind(cataLog.general_event_handler),500);var St=function(e){return function(t){e(t,!0),t.stopPropagation()}}(Bt.prototype.mouseover);return pref.test_mode[98]||site.popup_body.addEventListener("mouseover",St,!1),site.root_body.addEventListener("mouseover",Bt.prototype.mouseover,!1),site.components.boardlist&&(site.components.boardlist.addEventListener("mouseover",Bt.prototype.mouseover,!1),site.components.boardlist.addEventListener("mouseleave",Bt.prototype.mouseleave_bl,!1)),site2.DEFAULT.popups_posts.init(et),{destroy:function(){if(pref.test_mode[114])return Le(),styleSheet.register_cc("headline","white-space:nowrap;text-overflow:ellipsis;overflow:hidden;width:100%"),this;cataLog.general_event_handler.destroy();for(var e in Xe)Ke.remove_thread(e);pref_func.mirror_targets.pn12_0_2=null,pref_func.mirror_targets.pn12_0_4=null,me(0),brwsr.sw_cache&&brwsr.sw_cache.subscribe&&brwsr.sw_cache.subscribe(!1),Be.destroy(),cnst.auto_shrink_board_selector.destroy(qe),r(),l(!0),pref_func.tooltips.remove_root(Fe),pref_func.tooltips.hide(),at.stop_if_running(),ze.parentNode.removeChild(ze),window.removeEventListener("storage",site2[site.nickname].prep_own_posts_event,!1),_t.removeEventListener("scroll",yt,!1),window.removeEventListener("resize",yt,!1),ze=null,liveTag.pn=null;for(var t in cataLog)cataLog[t]=null;return null},remake_triage:l,triage_exe_pipe:m,catalog_insert:we,pn12_0_4:Fe,pn12_0_2:He,catalog_resized:s,get_threads:function(){return Xe},catalog_filter_changed:ae,scan_boards:nt,show_catalog:Nt,catalog_liveTag_scan_site:$e.scanSite}}var i,l,c,p,_,d=null;return cataLog.set_embed_xxxx=n,n(),e&&e.addEventListener("click",t,!1),styleSheet.init(p),pref.test_mode[98]||"catalog"!==p||styleSheet.register(".backlink","display:inline;font-size:0.8em;"),{catalog_func:function(){return d},scan_tags_common:a,show_hide:t}}function make_chart_obj(e){function t(){cnst.subscribe(c,new _),1===c.length&&(common_func.dom_addEventListener(common_obj.events_beforeunload,window,"focus",n),common_func.dom_addEventListener(common_obj.events_beforeunload,window,"blur",a))}function n(){cnst.foreach(c,function(e){e.chart_posts.options.animation=e.options.animation})}function a(){pref.chart.off_anime_blur&&cnst.foreach(c,function(e){e.chart_posts.options.animation=!1})}function r(){cnst.foreach(c,function(e){e.destroy()})}function o(){return{labels:["dummy","dummy"],datasets:[]}}function s(e,t,n){return{label:e,fillColor:"rgba("+t+","+n+")",strokeColor:"rgba("+t+",1)",pointColor:"rgba("+t+",1)",pointStrokeColor:"#fff",pointHighlightFill:"#fff",pointHighlightStroke:"rgba("+t+",1)",data:[0,0]}}var i='<select name="chart.inst.time_sel"><option>1 min</option><option>10 mins</option><option>1 hour</option><option>1 day</option><option>1 week</option><select>',l=['Number of points: <input type="text" name="chart.inst.len" size="3" style="text-align: right;"><br>','Scale of new thread: <input type="text" name="chart.inst.scale_thread" size="3" style="text-align: right;"><br>',"Show: Posts/Threads:<br>",'&emsp;&emsp;<input type="checkbox" name="chart.inst.show.np"><input type="checkbox" name="chart.inst.show.nt" disabled style="visibility:hidden"> Estimated, <input type="checkbox" name="chart.inst.clip_np">Clip: <input type="text" name="chart.inst.clip_np_val" size="4" style="text-align: right;"><br>','&emsp;&emsp;<input type="checkbox" name="chart.inst.show.p"><input type="checkbox" name="chart.inst.show.t"> Observed<br>','&emsp;&emsp;<input type="checkbox" name="chart.inst.show.ep"><input type="checkbox" name="chart.inst.show.et"> Alive<br>','<input type="checkbox" name="chart.inst.show_legend">Legend<br>','<input type="checkbox" name="chart.inst.options.animation">Animation (Doesn\'t work on FF)<br>','<input type="checkbox" name="chart.inst.options.pointDot">Point dot: radius <input type="text" name="chart.inst.options.pointDotRadius" size="1" style="text-align: right;"><br>'];if(!e)return{time_unit_sel_html:i,chart_options_str:l};e.addEventListener("click",t,!1);var c=[];window.addEventListener("beforeunload",r,!1);var p=0,_=function(e,t,n){if(n||common_func.deep_copy(this,pref.chart.inst),e)this.pn_canvas_root=e,this.show={np:!1,p:!0,ep:!1,nt:!1,t:!0,et:!1};else{this.name="graph_"+p++,this.pn2_obj=cnst.init3({this_obj:this,__proto__:this.pn2_template});var a=this.pn2_obj.pn;cnst.add_to_tb(a,i+(n?"":'<select name="chart.inst.board_sel"><select>')+cnst.icons.button_settings());a.childNodes[1].innerHTML=pref_func.format_html_str('<div style="display:none"><div style="float:right">'+l.join("")+'</div><div style="clear:both"></div></div><div style="position:relative"></div>'),pref_func.apply_prep(a,!1);var r=a.getElementsByTagName("select");cnst.auto_shrink_selector(r["chart.inst.time_sel"]),this.legend=cnst.init3({func_str:"border:1px solid lightblue:cursor:move:position:absolute:left:80px:top:40px"}),this.pn2=a,this.set_legend_str();var o=this.onchange_entry.bind(this);if(a.childNodes[0].onchange=o,a.childNodes[1].childNodes[0].onchange=o,n){cnst.bottom_top(a),this.show_legend=!1;for(var s=a.querySelectorAll("input[name],textarea[name],select[name]"),_=0;_<s.length;_++){var d=pref_func.get_tgt(s[_].getAttribute("name").replace(/chart.inst./,""),this);pref_func.apply_prep_load(s[_],d[0],d[1])}return cnst.subscribe(c,this),a}this.pn_board_sel=r["chart.inst.board_sel"],cnst.auto_shrink_board_selector.setup(this.pn_board_sel,pref.catalog_board_list_sel),this.board_sel=pref.catalog_board_list_sel,this.pn_canvas_root=a.childNodes[1].childNodes[1]}this.pn_canvas_root.style.width=pref.chart.window_width+"px",this.pn_canvas_root.style.height=pref.chart.window_height+"px",this.pn_canvas_root.style.resize="both",this.pn_canvas_root.style.overflow="hidden",this.pn_canvas=document.createElement("canvas"),this.pn_canvas_root.appendChild(this.pn_canvas),this.chart_size_changed(!0),this.stats=e?new stats.Stats(this,t,"popup"):new stats.Stats(this,this.get_tgts(),pref.catalog_board_list_obj[this.board_sel][0].key),this.canvas_active=!0,this.pn_canvas_root.onmousemove=this.deactivate_canvas_if_mouse_on_corner.bind(this),this.pn_canvas_root.onclick=this.chart_size_changed.bind(this),e||(this.show_legend&&this.append_legend(),cnst.bottom_top(a))};return _.prototype={get_tgts:function(e){return cataLog.catalog_refresh_1?cataLog.catalog_refresh_1("chart",!1,!1,!1,e,this.board_sel,!1,!0):[site.nickname+site.board]},board_sel_changed:function(e){e.target.blur();var t=this.get_tgts(pref.chart.instant_scan?this.name:null);"function"==typeof t?t(this.board_sel_changed.bind(this)):this.stats.tgts_changed(t,pref.catalog_board_list_obj[this.board_sel][0].key)},len_changed:function(){this.len>this.stats.len?this.stats.len_changed.call(this.stats,this.len):this.stats.len!=pref.stats.len_capture?this.stats.len_changed.call(this.stats,pref.stats.len_capture):this.replace_data(this.data_src)},deactivate_canvas_if_mouse_on_corner:function(e){var t=e.currentTarget.style;(parseInt(t.width,10)-e.offsetX<=10&&parseInt(t.height,10)-e.offsetY<=10)^!this.canvas_active&&(this.pn_canvas.style.pointerEvents=this.canvas_active?"none":"auto",this.canvas_active=!this.canvas_active)},chart_size_changed:function(e){this.pn_canvas.style.width=this.pn_canvas_root.style.width,this.pn_canvas.style.height=this.pn_canvas_root.style.height,this.pn_canvas.width=this.pn_canvas_root.clientWidth,this.pn_canvas.height=this.pn_canvas_root.clientHeight,e!==!0&&this.chart_redraw()},chart_redraw:function(){this.chart_posts&&this.chart_posts.destroy(),this.data_graph=o();var e=this.data_graph.datasets,t=this.data_src.fromNo,n=this.data_src.rm,a=this.data_src,r=0;this.idxs={};var i=this.idxs;i.np=t&&this.show.np?r++:-1,i.p=this.show.p?r++:-1,i.ep=n&&this.show.ep?r++:-1,i.t=this.show.t?r++:-1,i.et=n&&this.show.et?r++:-1,i.np!=-1&&(e[i.np]=s("post_fromNo","151,187,205",.2)),i.p!=-1&&(e[i.p]=s("Posts","98,152,179",.2)),i.ep!=-1&&(e[i.ep]=s("exist_p","66,119,136",.15)),i.t!=-1&&(e[i.t]=s("Threads","204,0,0",.2)),i.et!=-1&&(e[i.et]=s("exist_t","140,0,0",.2)),pref.test_mode[39]&&e[pref.test_mode.num]&&(e[pref.test_mode.num]=s(e[pref.test_mode.num].label,pref.test_mode.test_str,pref.test_mode.num_f));var l=this.len<this.stats.len?this.stats.len-this.len:0;if(this.data_graph.labels=a.data_l.slice(l),i.p!=-1&&(e[i.p].data=this.stats.merge_1(a.data_p.slice(l),a.data_p_old?a.data_p_old.slice(l):null)),i.t!=-1&&(e[i.t].data=this.stats.merge_1(a.data_t.slice(l),a.data_t_old?a.data_t_old.slice(l):null),1!=this.scale_thread&&this.scale_setup(e[i.t].data)),n&&(i.ep!=-1&&(e[i.ep].data=this.arr_dec_slice(a.data_p,n.data_p,l)),i.et!=-1&&(e[i.et].data=this.arr_dec_slice(a.data_t,n.data_t,l),1!=this.scale_thread&&this.scale_setup(e[i.et].data)),pref.test_mode[40]&&(e[r]=s("old_p","0,255,0",.1),e[r++].data=a.data_p_old.slice(l),e[r]=s("p_raw","98,152,179",.2),e[r++].data=a.data_p.slice(l))),t&&i.np!=-1){if(e[i.np].data=t.data_p_old?t.data_p_old.concat(t.data_p.slice(t.data_p_old.length)).slice(l):t.data_p.slice(l),t.data_p_old){var c=t.data_p_old.length-1;t.data_p[c]>t.data_p_old[c]&&c-l>=0&&(e[i.np].data[c-l]=t.data_p[c])}if(this.clip_np)for(var p=e[i.np].data,_=0;_<p.length;_++)p[_]=this.clip_np_func(p[_]);pref.test_mode[41]&&(e[r]=s("post_fromNo_old","0,255,0",.2),e[r++].data=t.data_p_old.slice(l),e[r]=s("post_fromNo","0,128,0",0),e[r++].data=t.data_p.slice(l))}this.scale_thread_old=this.scale_thread;var d=this.pn_canvas.getContext("2d");this.chart_posts=new Chart(d).Line(this.data_graph,this.options)},clip_np_func:function(e){return e<0?0:e>this.clip_np_val?this.clip_np_val:e},arr_dec_slice:function(e,t,n){for(var a=[],r=0,o=n;o<e.length;o++)a[r++]=e[o]-t[o];return a},scale_setup:function(e,t){if(void 0!==t)for(var n=0;n<e.length;n++)e[n].value=e[n].value/t*this.scale_thread;else for(var n=0;n<e.length;n++)e[n]*=this.scale_thread;return e},scale_changed:function(){this.set_legend_str(),0!==this.scale_thread_old?(this.scale_setup(this.chart_posts.datasets[this.idxs.t].points,this.scale_thread_old),void 0!==this.idxs.et&&this.data_graph.datasets[this.idxs.et]&&this.scale_setup(this.chart_posts.datasets[this.idxs.et].points,this.scale_thread_old),this.chart_posts.update()):this.chart_redraw(),this.scale_thread_old=this.scale_thread},set_legend_str:function(){var e='<span style="color:rgba(98,152,179,1)">●</span><span style="color: black;"> Posts</span><br><span style="color:rgba(204,0,0,1)">●</span><span style="color: black;"> Threads '+(1==this.scale_thread?"":"x"+this.scale_thread+" ")+"</span>";this.legend.pn.innerHTML=e},destroy:function(){return brwsr.ff||this.chart_posts.stop(),this.chart_posts.destroy(),this.stats.destroy(),this.stats=null,this.pn2&&(cnst.div_destroy(this.legend.pn,!1,this.legend),cnst.div_destroy(this.pn2,!0,this.pn2_obj),cnst.auto_shrink_board_selector.destroy(this.pn_board_sel),cnst.unsubscribe(c,this)),null},replace_data:function(e){this.stats||(this.stats=e),this.data_src=e,this.chart_redraw()},update_data2:function(e){for(var t=e.shift;t>0;)this.chart_posts.removeData(),t--;for(var n=[],t=e.data_p.length-e.shift;t<e.data_p.length;t++)e.fromNo&&this.idxs.np!=-1&&(n[this.idxs.np]=this.clip_np?this.clip_np_func(e.fromNo.data_p[t]):e.fromNo.data_p[t]),this.idxs.p!=-1&&(n[this.idxs.p]=e.data_p[t]),this.idxs.t!=-1&&(n[this.idxs.t]=e.data_t[t]*this.scale_thread),e.rm&&(this.idxs.ep!=-1&&(n[this.idxs.ep]=e.data_p[t]-e.rm.data_p[t]),this.idxs.et!=-1&&(n[this.idxs.et]=(e.data_t[t]-e.rm.data_t[t])*this.scale_thread)),this.chart_posts.addData(n,e.data_l[t]);var a=this.idxs.p!=-1?this.chart_posts.datasets[this.idxs.p]:null,r=this.idxs.t!=-1?this.chart_posts.datasets[this.idxs.t]:null,o=this.idxs.ep!=-1&&e.rm?this.chart_posts.datasets[this.idxs.ep]:null,s=this.idxs.et!=-1&&e.rm?this.chart_posts.datasets[this.idxs.et]:null,i=this.idxs.np!=-1&&e.fromNo?this.chart_posts.datasets[this.idxs.np]:null,l=e.min_idx-(this.stats.len-this.len),t=e.min_idx;for(l<0&&(t+=-l,l=0),pref.stats.patch_tm&&i&&l>0&&t>0&&(i.points[l-1].value=this.clip_np?this.clip_np_func(e.fromNo.data_p[t-1]):e.fromNo.data_p[t-1]);t<e.data_p.length-e.shift;)a&&(a.points[l].value=e.data_p_old&&e.data_p_old[t]>e.data_p[t]?e.data_p_old[t]:e.data_p[t]),r&&(r.points[l].value=(e.data_t_old&&e.data_t_old[t]>e.data_t[t]?e.data_t_old[t]:e.data_t[t])*this.scale_thread),o&&(o.points[l].value=e.data_p[t]-e.rm.data_p[t]),s&&(s.points[l].value=(e.data_t[t]-e.rm.data_t[t])*this.scale_thread),i&&(i.points[l].value=this.clip_np?this.clip_np_func(e.fromNo.data_p[t]):e.fromNo.data_p[t]),l++,t++;e.shift=0,this.chart_posts.update()},append_legend:function(){this.pn_canvas_root.appendChild(this.legend.pn)},remove_legend:function(){this.pn_canvas_root.removeChild(this.legend.pn)}},_.prototype.pn2_template={get func_str(){return"left:"+(p-1)%5*20+"px:tile2:get:bottom:"+(p-1)%5*20+":Show:tb"},maximize:_.prototype.chart_size_changed,maximize_embed_style_pnch1:{},maximize_float_style_pnch1:{},exit:_.prototype.destroy,get maximize_tgt(){return this.this_obj.pn_canvas_root}},_.prototype.onchange_entry=function(e){var t=pref_func.get_tgt(e.target.name.replace(/chart.inst./,""),this),n=t[1];pref_func.apply_prep_set(t[0],t[1],e.target),this.onchange_funcs[n]&&this.onchange_funcs[n].call(this,e)},_.prototype.onchange_funcs={pointDot:_.prototype.chart_redraw,pointDotRadius:_.prototype.chart_redraw,scale_thread:_.prototype.scale_changed,animation:function(){this.chart_posts.options.animation=this.options.animation},len:_.prototype.len_changed,separate:function(){this.stats.init()},time_sel:function(e){e.target.blur(),this.stats.time_unit_changed(this.time_sel)},board_sel:_.prototype.board_sel_changed,show_legend:function(e){e.target.checked?this.append_legend():this.remove_legend()},clip_np:_.prototype.chart_redraw,clip_np_val:function(){this.clip_np||(this.clip_np=!0,this.pn2.querySelector('input[name="chart.inst.clip_np"]').checked=!0),_.prototype.chart_redraw.call(this)}},_.prototype.onchange_funcs.np=_.prototype.onchange_funcs.separate,_.prototype.onchange_funcs.p=_.prototype.onchange_funcs.separate,_.prototype.onchange_funcs.ep=_.prototype.onchange_funcs.separate,_.prototype.onchange_funcs.t=_.prototype.onchange_funcs.separate,_.prototype.onchange_funcs.et=_.prototype.onchange_funcs.separate,{clear:function(){},dump:function(e){},data_update:function(e,t,n){},PostChart:_,time_unit_sel_html:i,
chart_options_str:l}}function make_setting_obj(e){function t(){a=n(null==a)}function n(e){function n(e){pref_func.apply_prep(r,e),e&&(listener(),timer_obj.init())}function o(e){var a=e.currentTarget.value;"apply"==a?n(!0):"cancel"==a?t():"ok"==a?(n(!0),t()):"apply+save"==a?(n(!0),localStorage&&(localStorage[pref.script_prefix+".pref"]=JSON.stringify(pref))):"load_default"==a?(pref=pref_default(),n(!1),n(!0),pref_func.obj_init()):"load_samples"==a?pref_func.pref_samples.init():"Dump(csv)"==a?chart_obj.dump("csv"):"Dump(obj)"==a?chart_obj.dump("obj"):"Clear data"==a?chart_obj.clear():"JSON"==a?(pref_func.apply_prep(r.getElementsByTagName("TEXTAREA").overwrite_site2_json_str,!0),pref_func.site2_json()):"EVAL"==a&&(pref_func.apply_prep(r.getElementsByTagName("TEXTAREA").overwrite_site2_eval_str,!0),pref_func.site2_eval())}if(e&&(pref.test_mode[17]?(a=document.createElement("div"),a.innerHTML="<div></div><div></div>",site.root_body.appendChild(a)):a=cnst.init("left:0px:tile:get:bottom:Show:tb",cnst.void_func,cnst.void_func,t,cnst.void_func),r=pref.test_mode[17]?a:a.childNodes[1],r.innerHTML='<div><div style="float:left">Statistics:<br>&emsp;Interval: <input type="text" name="interval_found" size="6" style="text-align: right;">min<br>&emsp;<input type="checkbox" name="check_page"> Show page no. of this thread<br>&emsp;&emsp;<input type="checkbox" name="show_page_fraction"> Show fraction of page No.<br>&emsp;<input type="checkbox" name="check_post"> Show num of new posts in this board<br>&emsp;<input type="checkbox" name="check_thread"> Show num of new threads in this board<br>&emsp;&emsp; Max_capture: <input type="text" name="max_capture" size="6" style="text-align: right;"> points<br>&emsp;&emsp;&emsp;Show recent : <input type="text" name="max_graph" size="6" style="text-align: right;"> points in graph<br>&emsp;&emsp;&emsp;Scale of #threads in graph: <input type="text" name="scale_thread" size="6" style="text-align: right;"><br><!-- &emsp;&emsp;<input type="radio" name="autoconf" value="auto"> Automatic configuration<br>&emsp;&emsp;<input type="radio" name="autoconf" value="manual"> Manual configuration<br> -->&emsp;&emsp;&emsp;<input type="radio" name="aggregator" value="true"> Aggregate data<br>&emsp;&emsp;&emsp;&emsp;<input type="checkbox" name="write_to_ls"> Write to localStrage (server)<br>&emsp;&emsp;&emsp;<input type="radio" name="aggregator" value="false"> Listen from localStrage (client)<br>&emsp;&emsp;<input type="checkbox" name="load_data"> Load data from localStrage at the start<br>&emsp;&emsp;Import format (drop whole text on graph)<br>&emsp;&emsp;&emsp;<input type="radio" name="import_format" value="csv"> csv<br>&emsp;&emsp;&emsp;<input type="radio" name="import_format" value="obj"> obj<br>&emsp;&emsp;<input type="button" value="Dump(csv)"><input type="button" value="Dump(obj)">&emsp;<input type="button" value="Clear data"><br><input type="checkbox" name="auto_start"> Start automatically (Delayed 10sec.)<br><br><!-- Post form:<br>&emsp;<input type="checkbox" name="hide_rules"> Hide rules<br>&emsp;<input type="checkbox" name="hide_Go"> Hide \'Go\'<br> --><br><br></div></div><div style="clear: both"><input type="button" value="cancel"><input type="button" value="apply"><input type="button" value="ok">&emsp;<input type="button" value="apply+save"><input type="button" value="load_default"><input type="button" value="load_samples"></div>',pref.test_mode[17]||(n(!1),cnst.bottom_top(a))),!pref.test_mode[17])for(var s=r.getElementsByTagName("input"),i=0;i<s.length;i++)"button"==s[i].type&&(e?s[i].addEventListener("click",o,!1):s[i].removeEventListener("click",o,!1));return e?a:pref.test_mode[17]?(r.innerHTML="",a.parentNode.removeChild(a),null):(r=null,cnst.div_destroy(a,!0))}e.addEventListener("click",t,!1);var a=null,r=null}function make_listener(){function e(e){if(null!==e.newValue&&e.key===pipe_name&&"false"===pref.aggregator){var t=brwsr.JSON_parse(e.newValue);t[0]!=n&&(n=t[0],chart_obj.data_update(t[0],t[1],t[2]),timer_obj.show_page([null,"+"+t[1]+"+"+t[2]+"@"+t[0]]))}}function t(){a||"false"!==pref.aggregator?a&&"true"===pref.aggregator&&(window.removeEventListener("storage",e,!1),a=!1):(window.addEventListener("storage",e,!1),a=!0)}var n,a=!1;return t(),t}function make_timer_obj(e){function t(t){null==a&&(pref.check_page||"true"==pref.aggregator&&(pref.check_thread||pref.check_post))?a=make_timer(e):null!=a&&(t&&(pref.check_page||"false"!=pref.aggregator&&(pref.check_thread||pref.check_post))?t&&a.timer().restart(!1):n())}function n(){a=a.destroy(),e.style.color="gray"}e.addEventListener("click",function(){t(!1)},!1);var a=null;pref.auto_start&&setTimeout(function(){t(!1)},1e4);var r=["",""];return{init:function(){t(!0)},finished:function(){n()},timer:function(){return a},show_page:function(t){null!=t[0]&&(r[0]=t[0]+"@"+cnst.get_time()),t.length>=2&&null!=t[1]&&(r[1]=t[1]),t.length>=3&&null!=t[2]&&(r[0]=t[2]),""!=r[0]&&""!=r[1]?e.textContent=r[0]+", "+r[1]:e.textContent=r[0]+r[1]}}}function make_timer(e){function t(e,t,a){var r=common_func.name2domainboardthread(e,!0)[2].substr(1);n(t.date,r,(new DOMParser).parseFromString(t.responseText,"text/html"))}function n(e,t,n){for(var a=site.get_ops(n),r=_.myself(),o=0;o<a.length;o++)if(r==a[o]){s.str_set(t,o);var i=s.str_get()+"@"+new Date(e).toLocaleTimeString();timer_obj.show_page([null,null,i]),s.prep_next(),_.restart(!0),pref.check_page&&options.func0_exe(s.str_get());break}}function a(e){var t=s.no();if(r(e,_.myself(),t),s.all_got()&&s.no()!=site.max_page){var n=0==i?0:l-i,a="";pref.check_page&&(a=s.str_get()),pref.check_post&&(a=a+"+"+n),pref.check_thread&&(a=a+"+"+p),timer_obj.show_page([a]),s.prep_next(),_.found(),n=parseInt(n,10),(isNaN(n)||null==n)&&(n=0),(pref.check_post||pref.check_thread)&&chart_obj.data_update(_.timestr(),n,p),i=l,pref.check_page&&options.func0_exe(s.str_get())}else timer_obj.show_page([t+"?"]),s.step(),_.missing()}function r(e,t,n){for(var a=site.get_ops(e),r=0;r<a.length;r++)if(t==a[r]){s.str_set(n,r),s.flag_set(2);break}if(t==-1)return a[0];if(0==n&&(s.flag_set(0),l=o(e)),n==site.max_page-1){s.flag_set(1);var i=c.length;if(0!=i){for(var _=a[a.length-1],r=0;r<i&&_!=c[i-r-1];)r++;p=r}else p=0;c=a}}function o(e){for(var t=site.get_posts(e),n=t[0],a=1;a<t.length;a++)t[a]>n&&(n=t[a]);return n}var s=function(){function e(){var e=0;t[0]=-1,t[1]=-1,pref.check_post&&(t[e++]=0),pref.check_thread&&(t[e++]=site.max_page-1);var r=(a+1)%(site.max_page+1);a!=t[0]&&a!=t[1]&&(t[e++]=a),r!=t[0]&&r!=t[1]&&(t[e++]=r);for(var s=0;s<=site.max_page;s++)s!=a&&s!=r&&s!=t[0]&&s!=t[1]&&(t[e++]=s);flag=[!pref.check_post,!pref.check_thread,!o],n=0}var t=[],n=0,a=0,r="",o=pref.check_page;return window.location.href.search(site.thread_keyword)==-1&&(o=!1),e(),{no:function(){return t[n]},step:function(){n=(n+1)%(site.max_page+1)},prep_next:function(){e()},flag_set:function(e){flag[e]=!0},all_got:function(){return flag[0]&&flag[1]&&flag[2]},str_set:function(e,t){o&&e!=site.max_page&&(r=e+"."+t,a=e)},str_get:function(){return r},init:function(){e()}}}(),i=0,l=0,c=[],p=0,_=function(){function t(e){var t=new DOMParser;if(404==p.status)_.dead();else{var n=Date.now();pref.info_server&&s.no()!=site.max_page&&brwsr.sw_cache&&brwsr.sw_cache.setItem(info_raw+"p"+s.no(),{date:n,status:p.status,responseText:p.responseText}),pref.catalog_snoop_refresh&&null!=catalog_obj.catalog_func()&&catalog_obj.catalog_func().catalog_insert(info_raw+"p"+s.no(),{date:n,status:p.status,responseText:p.responseText}),a(t.parseFromString(p.responseText,"text/html"))}}function n(e){p.open("GET",e,!0),p.send(null)}function o(){u||(u=!0,d=cnst.get_time(),i())}function i(){var e=site2[site.nickname].make_url4([site.nickname,site.board,s.no(),"page_html"])[0];s.no()==site.max_page&&(e=window.location.href),n(e)}function l(e){(e||g!=pref.interval_found)&&(c(!1),h=setInterval(o,6e4*pref.interval_found)),g=pref.interval_found}function c(t){null!=h&&clearInterval(h),h=null,t&&(e.style.color="gray")}var p=new XMLHttpRequest;p.addEventListener("load",t,!1),p.addEventListener("error",t,!1),p.addEventListener("abort",t,!1);var d,u=!1,f=0,m=site.max_page+1+5,h=null,g=0;l(!0),o(),e.style.color="#000000";var b=window.location.href.search(site.thread_keyword)!=-1?r(document,-1,-1):-2;return{req:p,found:function(){f=0,u=!1},missing:function(){200==p.status&&f++<m?setTimeout(i,1e3):(f=0,u=!1)},stop:function(e){c(e)},dead:function(){timer_obj.show_page(["Dead"]),c(!0),timer_obj.finished()},myself:function(){return b},restart:function(e){l(e)},timestr:function(){return d},destroy:function(){p.removeEventListener("load",t,!1),p.removeEventListener("error",t,!1),p.removeEventListener("abort",t,!1)}}}();return brwsr.sw_cache&&pref.info_client&&brwsr.sw_cache.subscribe(!0),{destroy:function(){return brwsr.sw_cache&&brwsr.sw_cache.subscribe(!1),_.stop(!0),_.destroy(),null},timer:function(){return _},page_check5:t}}function make_post_form_obj(e){function t(){site.components.postform_comment.focus()}function n(e){site2[site.nickname].postform.activation&&site2[site.nickname].postform.activation();var n=cnst.tack_float_nSblgs(e);n.rolldown=t,i=n.pn,n.cn.childNodes[0].innerHTML='<div><input type="checkbox" name="prevent_redirection">prevent redirection</div><div></div>',l=n.cn.childNodes[0],pref_func.apply_prep(l,!1),l.getElementsByTagName("input").prevent_redirection.onchange=o,options.func0_prep(n.cn.childNodes[0].childNodes[1],n.pn,n.cn),t(),site.postform.getAttribute("name")===pref.script_prefix+"_draft"&&(site.postform.style.display=null,n.pn.style.top="0px",n.pn.style.left="0px")}function a(e){cnst.tack_dock_nSblgs(e),site.postform.getAttribute("name")===pref.script_prefix+"_draft"&&(site.postform.style.display="none")}function r(){"none"!==s.style.display?n({currentTarget:s}):a({currentTarget:i.childNodes[0]})}function o(){if(null!=l&&pref_func.apply_prep(l,!0),1==pref.prevent_redirection){g||(g=cnst.make_iframe("redirect_target"),g.onload=function(){g.location&&"about:blank"!=g.location.href&&g.location.replace("about:blank")});for(var e=0;e<c.length;e++)h[e]=_[e].target,_[e].target="redirect_target"}else for(var e=0;e<c.length;e++)_[e].target=h[e]}var s;e.addEventListener("click",r,!1),site2[site.nickname].postform&&(s=site2[site.nickname].postform.init())&&cnst.set_tack_float(s,n,a);for(var i=null,l=null,c=[],p=[],_=document.getElementsByTagName("form"),d=0;d<_.length;d++)"post"==_[d].method&&p.push(_[d]);for(var d=0;d<p.length;d++)for(var u=p[d].getElementsByTagName("input"),f=0;f<u.length;f++)"submit"==u[f].type&&c.push(u[f]);for(var m=!1,h=[],d=0;d<c.length;d++)c[d].addEventListener("click",function(){m=!0},!1);var g;return 1==pref.prevent_redirection&&o(),{debug:function(){debug()}}}function make_debug_obj(e){function t(e){console.log("debug"),null!=site.components.postform_submit&&(site.components.postform_submit.disabled=!1),post_form_obj&&post_form_obj.debug()}e.addEventListener("click",t,!1)}if(!(window.top!=window.self&&""===window.name||"post_tgt"===window.name&&window.location.href.indexOf("localhost")!=-1)){var brwsr={ff:navigator.userAgent.indexOf("Firefox")!=-1,sw_cache:!0,JSON_parse:function(e){var t=JSON.parse(e);for(var n in t)"string"==typeof t[n]&&t[n].search(/^\[.*\]$/)!=-1&&(t[n]=brwsr.JSON_parse(t[n]));return t}};brwsr.innerText=brwsr.ff?"textContent":"innerText",brwsr.Date_parse=brwsr.ff?function(e){var t=Date.parse(e);if(isNaN(t)){var n=e.lastIndexOf(".");t=Date.parse(e.substr(0,n))+parseInt(e.substr(n+1,3))}return t}:Date.parse,brwsr.document_body=brwsr.ff?document.documentElement:document.body,brwsr.mousewheel=brwsr.ff?"DOMMouseScroll":"mousewheel";var DelayBuffer=function(e,t){this.tgt=e,this.delay=t,this.id=null,this.do_tgt=this.do_tgt.bind(this)};DelayBuffer.prototype={do_tgt:function(){this.id=null,this.tgt()},delayed_do:function(e){null===this.id&&(void 0===e&&(e=this.delay),this.id=setTimeout(this.do_tgt,"number"==typeof e?e:this.hasFocus?e.fg:e.bg))},cancel:function(){null!==this.id&&(clearTimeout(this.id),this.id=null)},get_binded_delayed_do:function(){return this.delayed_do.bind(this)},hasFocus:!0};var Watchdog=function(e,t){DelayBuffer.call(this,e,t)};Watchdog.prototype={start:function(e){this.delayed_do(e)},stop:function(){this.cancel()},restart:function(e){this.cancel(),this.delayed_do(e)},__proto__:DelayBuffer.prototype};var common_func={Object_modifyDescriptor:function(e,t,n){n.__proto__=Object.getOwnPropertyDescriptor(e,t),Object.defineProperty(e,t,n)},Object_defProps:function(e,t){for(var n in t)e[n]=t[n]}},site0=function(){var e=window.location.href,t=null,n=null,a=null,e=window.location.href;e.indexOf("/meguca.org/")!=-1?(t="meguca",n={pref2:{meguca:{utilize_boards_json:!1,utilize_boards_json_domain:!1}},thread:{env:{disp_offset:3}},scan:{max:100},proto:{env:{event_dynamic:!0}},style:{zIndex:300},tooltips:{zIndex:302}},a=!0):e.search(/(4chan(nel)*|4cdn).org/)!=-1?(t="4chan",n={catalog_expand_with_hr:!0,page:{env:{disp_filler:"<hr>"}},patch:{delayed_invoke:{use:brwsr.ff}},catalog:{t2h_sel:"N",thumbnail:{hover:{popup_zIndex:100001}}},proto:{footer:{rOP:!1,iOP:!1},env:{event_dynamic:!0}},easy2:{limits:2}}):e.indexOf("lainchan.org")!==-1?(t="lain",n={page:{env:{disp_offset:1}},catalog:{image_hover:!0,board:{all_boards:!0},env:{disp_offset:1,disp_filler:"                                        "}},proto:{env:{localtime_native:!1,colorID_native:!1}},stats:{time_unit:3,patch_tm:!0},chart:{inst:{show:{p:!0},time_sel:3}},easy2:{limits:1},thread_reader:{own_posts_tracker:!0}}):e.indexOf("lainchan.jp")!=-1?(t="lainjp",n={page:{env:{disp_offset:1}},proto:{env:{localtime_native:!1,colorID_native:!1}},stats:{time_unit:3,patch_tm:!0},chart:{inst:{show:{p:!0},time_sel:3}},catalog:{image_hover:!0,board:{all_boards:!0},env:{disp_offset:1,disp_filler:" "}},thread:{auto_update:!0},thread_reader:{own_posts_tracker:!0},scan:{max:100},liveTag:{style:{urtm:"color:lime !important;font-weight:bold !important",ur:"color:limegreen !important;font-weight:bold !important",in:"color:red !important"}},virtualBoard:{scanDelay:1},easy2:{limits:1},style:{post_new:"border:2px solid red !important"}},a=!0):e.search(/8chan.co|8ch.net/)!=-1?(t="8chan",n={catalog_expand_with_hr:!0,page:{env:{disp_offset:1,disp_filler:"<hr>"}}}):e.search(/krautchan.net/)!=-1&&(t="KC",n={thread_reader:{own_posts_tracker:!0,check_num_of_children:!1},proto:{env:{popup_native:!1,expand_thumbnail_inline_native:!1,image_hover_native:!1,colorID_native:!1,backlink_native:!1,localtime_native:!1,auto_update_native:!1}},page:{use_expander_always:!0}});var r=["meguca","4chan","lain","lainjp","8chan","KC"];t&&r.unshift(r.splice(r.indexOf(t),1)[0]);var o=["CatChan_tgt","8chan","8chan_live","vichan","KC","4chan_i","4chan","meguca","imeguca","lain","lainjp"];return a&&(a={catalog:{auto_load_filter:!0,auto_save_filter:!0,auto_save_filter_at_refresh:!0},liveTag:{use:!1,from:"op"},virtualBoard:{max:100,scan:!0,scan_domains:{}},network:{fetch_actively:!1},easy2:{presets:1,VB:{local:1},catalog:{auto_update:!1},page:{auto_update:!1}}},a.virtualBoard.scan_domains[t]="board"),{domain:t,domains:r,pref_default:n,pref_default2:a,domains_obj:function(e,n){for(var a={},o=0;o<r.length;o++)a[r[o]]=e;return n&&common_func.Object_modifyDescriptor(a,t,{writable:!1}),a},isStep:window.opener&&o.indexOf(window.name)!=-1}}(),pref4={funcs:{set_options_to_selector:function(e,t){e.length=t.length;for(var n=0;n<t.length;n++)e.options[n].text=t[n]}},archive:{IDB_board_sel_gfunc_pre:function(e,t,n,a,r){pref4.funcs.set_options_to_selector(r,pref4.archive.IDB_board_sel_options||["Wait..."])},IDB_board_sel_options:null,IDB_thread_sel_gfunc_pre:function(e,t,n,a,r){pref4.funcs.set_options_to_selector(r,pref4.archive.IDB_thread_sel_options||["Wait..."])},IDB_thread_sel_options:null},refresh:{count:0},search_posts_active_once:!1,scan:{get loosen(){return pref4.search_posts_active_once&&pref.proto.searchAc.loosen},get max(){return"archive"===site.whreami?pref.scan.max_archive:this.loosen?pref.proto.searchAc.max:pref.scan.max},get max_threads(){return"archive"===site.whreami?pref.scan.max_archive:this.loosen?pref.proto.searchAc.max_threads:pref.scan.max_threads},get max_threads_at_refresh(){return this.loosen?pref.proto.searchAc.max_threads_at_refresh:pref.catalog.max_threads_at_refresh}}},gGEH={get_key_recursive:function(e,t){for(var n;e&&!(n=this.pns_all_keys.get(e))&&e!==t;)e=e.parentNode;return n},pns_all_keys:new WeakMap,triage_in:null,triage_in2:null},pref_func={delete_null:function(e){for(var t in e)null===e[t]?delete e[t]:"object"!=typeof e[t]||Array.isArray(e[t])||pref_func.delete_null(e[t])},pref_overwrite:function(e,t,n){for(var a in t)if(void 0!==e[a]&&(null!==e[a]||pref&&pref.test_mode[117])){if(n&&typeof t[a]!=typeof e[a])continue;"object"!=typeof t[a]||Array.isArray(t[a])?e[a]!==t[a]&&(e[a]=t[a]):pref_func.pref_overwrite(e[a],t[a],n)}},site2_json:function(query,dumb,enables){var pn_out=document.getElementsByName("JSON_result")[0];pn_out&&(pn_out.style={});try{if(""!==pref.overwrite_site2_json_str){for(var fields=pref.overwrite_site2_json_str.split('"'),i=0;i<fields.length;)if(fields[i].search(/\/\/.*/)!=-1){for(;i+1<fields.length&&fields[i].search(/\/\/[^\n]*\n/)==-1;)fields[i]+=fields.splice(i+1,1);fields[i]=fields[i].replace(/\/\/[^\n]*(\n|$)/,"")}else i+=2;for(var str=fields.join('"'),ex_count=0,str_out="",count=0,start=0,j=0;j<str.length;j++)if(0==count&&"{"!==str[j]&&" "!==str[j]&&"\n"!==str[j]&&ex_count++,"{"===str[j]&&count++,"}"===str[j]&&0==--count){var obj=JSON.parse(str.substr(start,j-start+1));for(var i in obj)"site2"!==i&&"pref"!==i&&"pref_func"!==i&&"liveTag"!=i&&"site3"!==i||enables&&enables.indexOf(i)==-1||(query?str_out='{"'+i+'":'+pref_func.pref_query(eval(i),obj[i])+"}":pref_func.pref_overwrite(eval(i),obj[i]));start=j+1}pn_out&&(pn_out.textContent=(0!=ex_count?"OK, but there are extra useless strings, ":0!=count?"OK, but there are non-closed brackets, ":"OK, ")+(new Date).toLocaleString(),pn_out.style.color="",""!==str_out&&(document.getElementsByName("overwrite_site2_json_str")[0].value=str_out,pref.overwrite_site2_json_str=str_out))}}catch(e){pn_out&&(pn_out.textContent="ERROR!!!, "+(new Date).toLocaleString(),pn_out.style.color="red"),console.log("ERROR in overwtite strings:"),console.log(pref.overwrite_site2_json_str),console.log(e)}}},pref=pref_default();localStorage&&localStorage[pref.script_prefix+".pref"]&&pref_func.pref_overwrite(pref,JSON.parse(localStorage[pref.script_prefix+".pref"]),!0);for(var i in{catalog:null,page:null,float:null,thread:null})pref[i].save_board_list_sel||(pref[i].board_list_sel=0);if(sessionStorage&&sessionStorage[pref.script_prefix+".pref"]&&pref_func.pref_overwrite(pref,JSON.parse(sessionStorage[pref.script_prefix+".pref"]),!0),window.name)for(var i in{catalog:null,page:null,float:null,thread:null})pref[i].board_list_sel=0;if(pref_func.site2_json(!1,!0,["pref"]),site0.isStep){for(var i in pref.features)"domains"!==i&&(pref.features[i]=!1);for(var i in pref.features.domains)i!==site0.domain&&(pref.features.domains[i]=!1);brwsr.sw_cache=null,pref_func.pref_overwrite(pref,{catalog:{auto_update:!1},thread:{auto_update:!1},page:{auto_update:!1},float:{auto_update:!1},virtualBoard:{scan:!1},stats:{auto_acquisition_scan:!1},cloudflare:{auto_reload:!1}})}var styleSheet=site0.isStep?{}:function(){function e(e,t){p.cssRules[t]&&p.deleteRule(t),p.insertRule(e,t)}function t(){e("."+pref.script_prefix+("entire"===pref.catalog.click_area?"_thread":"_thumbnail")+" {cursor: pointer}",2)}function n(){var t=[pref.style.fix.titleBar_str,pref.style.fix.window_str,pref.style.fix.popUp_str];if("copy"===pref.style.sel)for(var n=[pref.style.copy.titleBar_str,pref.style.copy.window_str,pref.style.copy.popUp_str],r=document.styleSheets.length-1;r>=0;r--){var o=document.styleSheets[r].cssRules;if(o){for(var s=o.length-1;s>=0;s--){for(var i=0;i<3;i++)n[i]&&o[s].selectorText===n[i]&&(t[i]=a(o[s].cssText),n[i]=null);if(!t[0]&&!t[1]&&!t[2])break}if(!t[0]&&!t[1]&&!t[2])break}}e("."+pref.script_prefix+"_titleBar {"+t[0]+"}",4),e("."+pref.script_prefix+"_window {"+t[1]+"}",5),e("."+pref.script_prefix+"_popUp {"+t[2]+"}",6)}function a(e){for(var t=e.replace(/.*\{/,"").replace(/\}.*/,"").split(";"),n=t.length-1;n>=0;n--)t[n].split(":")[0].search(/\s*(background|color)/)==-1&&t.splice(n,1);return t.join(";")}function r(e){new MutationObserver(o).observe(e,{attributes:!0})}function o(){if(p){var e=document.createElement("img");e.src=this.href,e.onerror=s,document.getElementsByTagName("body")[0].appendChild(e)}}function s(){this.parentNode.removeChild(this),n()}function i(){if(cataLog.embed_mode){var e=site2[site.nickname].spoiler_text;if(e.spoiler){if(!_&&!d&&e&&pref[cataLog.embed_mode].open_spoiler_text)for(var t=0;t<document.styleSheets.length;t++)if(document.styleSheets[t].cssRules)for(var n=0;n<document.styleSheets[t].cssRules.length;n++){var a=document.styleSheets[t].cssRules[n].selectorText;a&&(a.search(e.spoiler)!=-1&&(_=[t,n,document.styleSheets[t].cssRules[n].style.cssText]),a.search(e.open)!=-1&&(d=[t,n,document.styleSheets[t].cssRules[n].style.cssText]))}_&&d&&(document.styleSheets[_[0]].cssRules[_[1]].style.cssText=_[2]+(pref[cataLog.embed_mode].open_spoiler_text?d[2]:""))}else pref[cataLog.embed_mode].open_spoiler_text?(d=[document.styleSheets.length-1,document.styleSheets[document.styleSheets.length-1].cssRules.length,e.open_rule],document.styleSheets[d[0]].insertRule(d[2],d[1])):d&&document.styleSheets[d[0]].deleteRule(d[1])}}function l(e,t){var n=u.indexOf(e);n!=-1&&p.deleteRule(n),null===t||""===t?n!=-1&&u.splice(n,1):(n===-1&&(n=u.length,u[n]=e),p.insertRule(e+" {"+t+"}",n))}function c(){var e=pref.style.userCSS;if(e.use){var t=m||document.createElement("style");t.textContent=e.str,m||(m=document.head.appendChild(t))}else m&&(document.head.removeChild(m),m=null)}var p,_=null,d=null,u=["dummy","dummy","dummy","dummy","dummy","dummy","dummy"],f="."+pref.script_prefix+"_",m=null;return c(),{init:function(e){p=document.head.insertBefore(document.createElement("style"),m).sheet,p.insertRule(".catalog_triage_parent {pointer-events: none;}",0),p.insertRule(".catalog_triage_button {pointer-events: auto;}",1),t(),p.insertRule("."+pref.script_prefix+"_tag {cursor:pointer;}",3),n(),pref_func.settings.onchange_funcs["*.posts_search_op"](null,e),pref_func.settings.onchange_funcs["style.post_editing"](),l(f+"autoTp:hover","opacity:1;"),l(f+"autoTp","opacity:0;"),l(f+"deleted","opacity:0.4;");var a=site2[site.nickname].styles;if(a)for(var r=0;r<a.length;r++)l(a[r][0],a[r][1])},make_rule_click_area:function(){p&&t()},styles_changed:function(){p&&n()},add_to_watch:r,open_spoiler_text:i,register:l,register_cc:function(e,t){this.register(f+e,t)},userCSS_changed:c}}(),pref3={stats:{use:null,estimate_posts:null},reload_required:!1,catalog:{indexing_old:0,filter:{time_str:function(e,t,n){e[t.replace(/str$/,"obj")]=Date.parse(n)},time_obj:0,kwd:{str:function(e){this.obj&&(this.obj[this.obj[0]===e.target?1:0].value=pref.catalog.filter.kwd.str)},obj:null,clear:function(){this.obj[1].value="",this.obj[1].oninput({target:this.obj[1],currentTarget:this.obj[1]})},init:function(e,t){var n;return this.obj?n=this.obj[1]:(n=e.cloneNode(!1),n.name="catalog.filter.kwd.str",n.oninput=cataLog.event_func,this.obj=[t.getElementsByTagName("input")["catalog.filter.kwd.str"],n]),e.setAttribute("style","display:none"),e.parentNode.insertBefore(n,e.nextSibling),this.clear(),n}}}},notify:{sound:{file:null}},archive:{working:!1,list_str:function(e,t,n){pref_func.str2obj2(e,t.replace(/str$/,"obj2"),n)},list_obj2:null,list_obj3:null,jsons:null,imgs:null,dir:null},proto:{merge_list_str:function(e,t,n){this.merge_list_obj2_old||(this.merge_list_obj2_old=this.merge_list_obj2);var a=null;pref_func.str2obj2(e,"merge_list_obj2",n.replace(/\s*\+/g,",+"),null,null,function(e,t){var n=e.search(/^\s*\+\s*/)!=-1,r=e.replace(/^\s*\+\s*/,"")||"DEFAULT";n&&a?(t[r]=t[a],t[r][t[r].length]=r):(t[r]=[r],a=r)})},merge_list_obj2:null,merge_list_obj2_old:null,merge_lv_str:function(e,t,n){this.merge_lv_obj2_old||(this.merge_lv_obj2_old=this.merge_lv_obj2),pref_func.str2obj2(e,"merge_lv_obj2",n,null,null,pref_func.str2obj2_func_for_val)},merge_lv_obj2:null,merge_lv_obj2_old:null,merge_lv_obj3:null},test_mode:{js_file:null}};Object.defineProperties(pref3.catalog.filter.kwd,{clear:{value:pref3.catalog.filter.kwd.clear,configurable:!0,enumerable:!1,writable:!0},init:{value:pref3.catalog.filter.kwd.init,configurable:!0,enumerable:!1,writable:!0}});var cataLog={threads:null,scan_boards:null,scan_init:null,catalog_filter_query:null,embed_mode:null,format_html:null,show_catalog:null,show_catalog_cont:null,get_ref_height:null,catalog_obj2:null,healthIndicator:null,parent:null,open_spoiler_text:null,show_catalog_scroll_lock:null,general_event_handler:null,catalog_refresh_1:null,catalog_refresh_end:null,catalog_filter_changed:null,image_hover_reentry:null,image_hover_remove:null,scan_boards_keyword_callback2:null,scan_boards_keyword_callback2_default_args:null,catalog_clear_threads:null,catalog_filter_query_keyword:null,set_watch_time_thread:null,get_watch_time_of_a_thread:null,event_func:null,restore_th_from_IDB:null,components:null,triage:null,GEH:null,insert_myself:null,DIH:null,pop_up_set_contents:null,auto_update:null,gClg:null};pref_func=function(){return{__proto__:pref_func,mirror_targets:{pn12_0_2:null,pn12_0_4:null,pn13_1:null,boardlist:null},apply_prep:function(e,t,n,a,r){if(e){var o;if(a){o=[];for(var s in this.mirror_targets)if(this.mirror_targets[s]){var i=this.mirror_targets[s].getElementsByTagName("input")[e.name];i&&(Array.isArray(i)?o=o.concat(Array.prototype.slice.call(i)):o[o.length]=i)}for(var s=o.length-1;s>=0;s--)o[s]===e&&o.splice(s,1);if(0==o.length)return}else if(Array.isArray(e))o=e;else{var l="input,textarea,select"+(t?"":",span[data-class=show_value]");o=Array.prototype.slice.call(e.querySelectorAll(l)),0==o.length&&(o=[e])}this.apply_prep_2(o,t,n,a,r)}},apply_prep_2:function(e,t,n,a,r){for(var o=0;o<e.length;o++){var s=e[o],i=s.getAttribute("name");if(i&&"button"!=s.type){var l=pref_func.get_tgt(i,"file"===s.type?pref3:null),c=l[0],p=l[1],_=s.tagName;if("INPUT"===_)"file"===s.type?!t&&c[p]&&c[p]!==s?s.parentNode.replaceChild(c[p],s):c[p]=s:t?(void 0!==c[p+"_old"]&&(c[p+"_old"]=c[p]),this.apply_prep_set(c,p,s,i),a||"radio"===s.type||this.apply_prep(s,!1,!1,!0)):this.apply_prep_load(s,c,p),(t||r)&&"string"==typeof c[p]&&"text"===s.type&&"str"===p.substr(-3,3)&&c[p.substr(0,p.length-3)+"obj"]&&pref_func.str2obj6(c,p,s.value,i);else if("TEXTAREA"===_){if(t?c[p]=s.value:s.value=c[p],(t||r)&&"str"===p.slice(-3)){var d=p.slice(0,-3);c[d+"obj"]?pref_func.str2obj(p):c[d+"obj2"]?pref_func.str2obj2(c,d+"obj2",s.value):void 0!==c[d+"obj5"]?pref_func.str2obj5(c,d+"obj5",s.value,"rm_list_str"===p):null===c[d+"obj6"]?pref_func.str2obj6(c,p,s.value,i):void 0!==c[d+"obj7"]&&pref_func.str2obj7.s2o(c,d+"obj7",s.value)}}else if("SELECT"===_)t?this.apply_prep_set(c,p,s,i):(c[p+"_gfunc_pre"]&&c[p+"_gfunc_pre"](c,p,c[p],i,s),this.apply_prep_load(s,c,p));else if("SPAN"===_&&!t&&"show_value"===s.getAttribute("data-class")){var u=c[p],f=this.apply_prep_2_str[p+":"+c[p]];f&&(u="string"==typeof f?f:f(c)),s.textContent=u.toString().replace(/^./,function(e){return e.toUpperCase()})}n&&(s.oninput&&s.oninput.call(s,{currentTarget:s,target:s},!0),s.onchange&&s.onchange.call(s,{currentTarget:s,target:s},!0))}}pref.test_mode[117]?sessionStorage&&t&&(sessionStorage[pref.script_prefix+".pref"]=JSON.stringify(pref_func.site2_json_ex_remove())):sessionStorage&&(t||r)&&(sessionStorage[pref.script_prefix+".pref"]=JSON.stringify(pref))},apply_prep_set:function(e,t,n,a){var r=typeof e[t];if("number"===r){var o;e[t]="SELECT"===n.tagName?n.selectedIndex:(o=a&&"_f"===a.substr(-2)?parseFloat(n.value):parseInt(n.value,10),isNaN(o)?0:o)}else"boolean"===r?e[t]=n.checked:"string"===r&&("text"===n.type||n.checked)&&(e[t]=n.value)},apply_prep_load:function(e,t,n){var a=t[n];if("SELECT"===e.tagName)a>=e.length&&(t[n]=0),e.selectedIndex=t[n];else{var r=typeof a;"number"==r?e.value=a:"boolean"==r?e.checked=a:"string"==r&&("text"===e.type?e.value=a:a===e.value&&(e.checked=!0))}},apply_prep_2_str:{"t2h_sel:L":function(e){return e.t2h_L},"t2h_sel:M":function(e){return e.t2h_M},"t2h_sel:N":function(e){return e.t2h_N},"t2h_sel:N_unread":function(e){return e.t2h_N+"+unread"},"t2h_sel:unread":"All unread","posts_search_op:opaque":function(e){return"opaque "+e.posts_search_op_opacity+"%"},"popup2:sr":"SearchResult","popup2:srpv":"SearchResult/Preview","popup2:pv":"Preview","popup2:chart":"PostRateChart","popup2:dp":"DeletedPosts"},catalog_board_list_str_or:"",catalog_board_list_str_bt:"",catalog_board_list_str_bt_same:"",add_onchange:function(e,t,n){return this.set_event_target(e,this.add_onchange_entry_func.bind(t),n)},add_onchange_entry_func:function(e,t){var n=e.currentTarget.getAttribute("name");if(t||["INPUT","TEXTAREA","SELECT"].indexOf(e.currentTarget.tagName)==-1||pref_func.apply_prep(e.currentTarget,!0),this[n])this[n].call(e.currentTarget,e);else{var a=n.indexOf(".");if(a!=-1){var r=n.substr(a);if(this["*"+r])this["*"+r].call(e.currentTarget,e);else if(this["*w/"+r])this["*w/"+r].call(e.currentTarget,e,n);else{var o=n.lastIndexOf(".");if(o!=-1){var r=n.substr(0,o+1)+"*";if(this[r])this[r].call(e.currentTarget,e);else if(this[r+"w/"])this[r+"w/"].call(e.currentTarget,e,n);else if(a!=-1){var s=n.substr(0,a),i=n.substr(a+1);this[s]&&this[s][i]&&this[s][i](e)}}}}}},add_onchange_format:function(e){for(var t=Object.keys(e),n=0;n<t.length;n++)"string"==typeof e[t[n]]&&(e[t[n]]=e[e[t[n]]]);return e},set_event_target:function(){function e(e){n=e?e.target:null}function t(){n&&pref_func.apply_prep(n,!0)}var n=null;return window.addEventListener("beforeunload",t,!1),function(t,a,r){var o=function(e,t){n=null,a.call(this,e,t)},s=t.getElementsByTagName("*");0==s.length&&(s=[t]);for(var i=0;i<s.length;i++){var l=s[i].getAttribute("name");if(l){var c=s[i].tagName;"INPUT"===c||"TEXTAREA"===c||"SELECT"===c?r&&r[s[i].name]?s[i].oninput=o:(s[i].onchange=o,("INPUT"===c&&"text"===s[i].type||"TEXTAREA"===c)&&(s[i].oninput=e)):"BUTTON"===c?s[i].onclick=o:"A"===c?"SHOW"!==l&&"SHOWALL"!==l&&"HIDEALL"!==l&&"SHOW2"!==l&&"SHOW3"!==l&&"HIDE3"!==l||(s[i].onclick=a):"SPAN"!==c&&"DIV"!==c||("SUB"===l&&(s[i].onchange=a),"SHOW2_I"!==l&&"SHOW4"!==l&&"HIDE4"!==l||(s[i].onclick=a))}}return o}}(),str2obj:function(e){var t=e.replace(/str$/,"obj");pref[t]=[],t=pref[t];var n="boards"===site.whereami?site2[site.nickname].boards_sel_from_tags():site.board+("thread"===site.whereami?site.no:"");if("//"===n&&(n="/ROOT_DUMMY/"),n+=","+n+"\n"+pref[e]+"\n",pref.catalog.board.recommendation){var a=site2[site.nickname].get_owners_recommendation();pref_func.catalog_board_list_str_or=a,n=n+a+"\n"}pref.catalog.board.board_tags&&""!==pref_func.catalog_board_list_str_bt&&(n=n+pref_func.catalog_board_list_str_bt+"\n"),pref.catalog.board.board_tags_same&&""!==pref_func.catalog_board_list_str_bt_same&&(n=n+pref_func.catalog_board_list_str_bt_same+"\n");for(var r=n.split("\n"),o=-1,s=0;s<r.length;s++){for(var i=r[s].replace(/\s*\/\/.*/,"").replace(/, +/g,",").split(","),l=0;l<i.length&&""==i[l];)l++;if(i[l]){t[++o]=[{key:i[l++]}];for(var c=0;l<i.length;)""!==i[l]&&(i[l].search(/^\s*!?#/)!==-1?(t[o][0].tags||(t[o][0].tags=[]),t[o][0].tags[t[o][0].tags.length]=i[l].replace(/\s/g,"")):i[l].search(/^\s*!/)!==-1?(t[o][0].cmds||(t[o][0].cmds=[]),t[o][0].cmds[t[o][0].cmds.length]=i[l].replace(/\s/g,"").substr(1)):(t[o][++c]={},t[o][c].key=i[l].replace(/[\*\^!].*/,"").replace(/\s/g,""),i[l].search(/\*/)!=-1&&(t[o][c].max_page=parseInt(i[l].replace(/[^\*\^!]*[\*\^!]/,"").replace(/[\^!].*/,""),10)),i[l].search(/\^/)!=-1&&(t[o][c].style=i[l].replace(/[^\*\^!]*[\*\^!]/,"").replace(/[\*!].*/,"")))),l++}}pref.catalog.board.all_boards&&(t[t.length]=[{key:"ALL"},{key:site.nickname}]);for(var s=0;s<t.length;s++)for(var l=1;l<t[s].length;l++){var p=t[s][l].key.replace(/\/.*/,"");""==p&&(p=site.nickname);var _="/"+t[s][l].key.replace(/[^\/]*\//,"").replace(/\/.*/,"")+"/"
;1==l?(t[s][0].domain=p,t[s][0].board=_):(t[s][0].domain!=p&&(t[s][0].domain=null),t[s][0].board!=_&&(t[s][0].board=null))}for(var s=0;s<t.length;s++)for(var l=1;l<t[s].length;l++){var d=common_func.name2domainboardthread(t[s][l].key,!1);t[s][l].key=common_func.name2domainboardthread(t[s][l].key,!0).join(""),""===d[1]&&""===d[2]&&(t[s][0].domains_for_all_boards||(t[s][0].domains_for_all_boards=[]),t[s][0].domains_for_all_boards[t[s][0].domains_for_all_boards.length]=d[0],t[s].splice(l--,1))}},get_tgt:function(e,t,n){t||(t="#"===e[0]?liveTag.tags:pref);for(var a=e.split("."),r=0;r<a.length;r++){if(n&&void 0===t[a[r]])return null;if(r==a.length-1)return[t,a[r]];t=t[a[r]]}},str2obj2:function(){function e(e,t,n,a){if(n){e[t]||(e[t]={});for(var r=n[0].substr(1).split(";"),o=0;o<r.length;o++){var s=r[o].split(":");a&&(1===s.length||"true"===s[1]?s[1]=!0:"false"===s[1]&&(s[1]=!1)),e[t][s[0]]=s[1]}}}function t(t,n){var a=t.replace(/[@\^!].*/,"")||"DEFAULT";void 0===n[a]&&(n[a]={});var r=t.match(/@([^\^!]*)/);r&&(n[a].time=0==r[1]?0:brwsr.Date_parse(r[1])),e(n[a],"style",t.match(/\^[^@!]*/)),e(n[a],"cmd",t.match(/![^@\^]*/),!0)}return function(e,n,a,r,o,s){r||(e[n]={});var i=e[n],l=a.replace(/\s*\/\/.*/gm,"").replace(/\n/g,",").split(/\s*,\s*/);s||(s=t);for(var c=0;c<l.length;c++)l[c]&&s(l[c],i);if(o)return i;var p=n.replace(/_obj2/,"_obj3");e[p]={};var _=e[p];for(var c in i)_[c.replace(/\/[0-9]+$/,"/")]=!0}}(),str2obj2_func_for_val:function(e,t){e=e.replace(/\s*/g,"");var n=e.indexOf(":");t[n>=1?e.substr(0,n):"DEFAULT"]=e.substr(n+1)},str2obj5:function(e,t,n,a){e[t]={},tgt=e[t];for(var r=n.replace(/\s*\/\/.*/gm,"").replace(/\n/g,",").split(","),o=0;o<r.length;o++){var s=r[o].replace(/\s*:\s*/,":").replace(/\s+$/,"");if(""!=s){var i,l=s.indexOf(":"),c=l!=-1?s.substr(0,l):"DEFAULT",p="/"===s[l+1]&&(i=s.lastIndexOf("/"))>l+2,_=p?s.slice(l+2,i):s.slice(l+1),d=(a?"g":"")+(p?s.slice(i+1).replace(/g/,""):"");void 0===tgt[c]&&(tgt[c]=[]);try{tgt[c][tgt[c].length]=new RegExp(p?_:this.str2rstr(_,a),d)}catch(e){console.log("ERROR at str2obj5 in string of: "+r[o])}}}},str2rstr:function(e,t){return e.replace(/[\.\(\)\[\]\+\^\$\{\}]/g,"\\$&").replace(/\*/g,t?"\\S*(\\s|\\n|$)":".*").replace(/\?/g,".")},str2obj7:function(){var e={use:!0,str:"",re:!1,ci:!0,match:0,sentence:!1,op:!0,post:!1,sub:!0,name:!0,trip:!1,com:!0,file:!1,meta:!1,flag:!1,id:!1,cmds:""};return{s2o:function(t,n,a){t[n]={},tgt=t[n];for(var r=a.replace(/\s*\/\/.*/gm,"").split(/\s*\n\s*/),o=0;o<r.length;o++){var s=r[o].trim().replace(/\s*:\s*/,":");if(""!=s){var i=s.indexOf(":"),l=s.indexOf("{");l<i&&(i=l-1);var c=i!=-1?s.substr(0,i):"DEFAULT";void 0===tgt[c]&&(tgt[c]=[]);try{var p=JSON.parse(s.slice(l));p.__proto__=e,p.rexps=common_func.kwd_prep_regexp(p),tgt[c][tgt[c].length]=p}catch(e){console.log("ERROR at str2obj7 in string of: "+r[o])}}}},o2s:function(t){var n={};for(var a in e)e[a]!=t[a]&&(n[a]=t[a]);return delete n.use,t.sentence&&t.str.indexOf(" ")===-1&&delete n.sentence,JSON.stringify(n)}}}(),merge_obj5:function(e,t,n){return this.merge_obj5_all(e,t,n,this.merge_obj5_1)},merge_obj5a:function(e,t,n){return this.merge_obj5_all(e.key,t,n,this.merge_obj5_1a)},merge_obj5a_sc:function(e,t,n){if(!t)return n;var a=common_func.fullname2dbt(e);return t[e]||t[a[1]+a[2]]||t[a[0]+a[2]]||t[a[2]]||t[a[0]+a[1]]||t[a[1]]||t[a[0]]||t.DEFAULT||n},merge_obj5_all:function(e,t,n,a){var r=common_func.fullname2dbt(e);return n=a(n,t,"DEFAULT"),n=a(n,t,r[0]),n=a(n,t,r[1]),n=a(n,t,r[0]+r[1]),n=a(n,t,r[2]),n=a(n,t,r[0]+r[2]),n=a(n,t,r[1]+r[2]),n=a(n,t,e)},merge_obj5_1:function(e,t,n){if(t[n]){var a=t[n];e||(e={}),void 0!==e.hit&&(e.hit=!0);for(var r in a)if("object"!=typeof a[r])e[r]=a[r];else{void 0===e[r]&&(e[r]={});for(var o in a[r])e[r][o]=a[r][o]}}return e},merge_obj5_1a:function(e,t,n){var a=t[n];return a?e?a.concat(e):a:e},str2obj6:function(e,t,n,a){var r=pref_func.get_tgt(a,pref3);r[0][r[1]](r[0],t,n)},obj_init_hier:function(e,t){for(var n in e)"object"==typeof e[n]&&t[n]?this.obj_init_hier(e[n],t[n]):"function"==typeof e[n]&&e[n](e,n,t[n])},obj_init:function(){pref_func.str2obj("catalog_board_list_str"),pref_func.str2obj2(pref.catalog,"style_general_list_obj2",pref.catalog.style_general_list_str),pref_func.str2obj2(pref.catalog.board,"ex_list_obj2",pref.catalog.board.ex_list_str),pref_func.str2obj5(pref.liveTag,"ex_list_obj5",pref.liveTag.ex_list_str),pref_func.str2obj5(pref.liveTag,"rm_list_obj5",pref.liveTag.rm_list_str),pref_func.settings.onchange_funcs.archive["kwd.*"](),this.obj_init_hier(pref3,pref)},obj_elim_the_same:function(e,t,n,a){return this.obj_elim_the_same_1(new Set,e,t,n,a)},obj_elim_the_same_1:function(e,t,n,a,r){var o=!1;for(var s in t)if("object"==typeof t[s]&&n[s]&&"object"==typeof n[s]){if(!t.hasOwnProperty(s))continue;if(e.has(t[s]))continue;e.add(t[s]),pref_func.obj_elim_the_same_1(e,t[s],n[s],!0,r)?(o=!0,r||(Array.isArray(t[s])||Array.isArray(n[s]))&&(t[s]=n[s])):(delete t[s],e.add(n[s]))}else t[s]===n[s]?delete t[s]:(o=!0,r||(t[s]=n[s]));return(Array.isArray(t)||Array.isArray(n))&&t.length!==n.length&&(o=!1),a?o:t},site2_json_ex_remove:function(){var e=pref_default(!0);delete e.catalog_board_list_obj,delete e.catalog.style_general_list_obj2,delete e.catalog.board.ex_list_obj2,pref_func.obj_elim_the_same(e,pref);var t=pref_default().proto;return["catalog","page","thread","float"].forEach(function(n){pref_func.obj_elim_the_same(e[n],t,!0,!0)||delete e[n]}),delete e.page.footer,delete e.thread.footer,e},site2_json_ex:function(e,t){var n=this.site2_json_ex_remove();t||n.catalog.filter&&delete n.catalog.filter,e||n.catalog_board_list_str&&delete n.catalog_board_list_str,n.overwrite_site2_json_str&&delete n.overwrite_site2_json_str,pref.overwrite_site2_json_str=t?'{"pref":{"catalog":{"filter":'+JSON.stringify(n.catalog.filter)+"}}}":'{"pref":'+JSON.stringify(n)+"}"},pref_query:function(e,t){var n="";for(var a in t)void 0!==e[a]&&(n+='"'+a+'":'+("object"!=typeof t[a]||Array.isArray(t[a])?JSON.stringify(e[a]):pref_func.pref_query(e[a],t[a]))+",");return"{"+n.substr(0,n.length-1)+"}"},site2_eval:function(){},tooltips:site0.isStep?null:function(){function e(e){var t=e&&(e.target.name||e.target.getAttribute("name"))||this.name;if(t&&e&&"radio"===e.target.type&&(t+=", "+e.target.value),t||"LABEL"!==e.target.tagName||(t=e.target.childNodes[0].name+("radio"===e.target.childNodes[0].type?", "+e.target.childNodes[0].value:"")),"SHOW2_I"===t&&(t=e.target.previousSibling.childNodes[1].getAttribute("name")),"SHOW2"===t&&(t=e.target.childNodes[1].getAttribute("name")),t){var n="function"==typeof h[t]?h[t]():h[t];return n||(n=h[t.substr(0,t.lastIndexOf(".")+1)+"*"]),n||(n=l(h,t,"")||""),pref.test_mode.tips&&(n="Name: "+t+"\n"+n),n=n.replace(/\n/gm,"<br>").replace(/  /g,"&emsp;"),"#"===t[0]?h["#*"](e,n):n}}function t(t){var a=t.target.getAttribute("name"),r=a&&"#"===a[0]?"info":"help";pref.tooltips[r].show&&n(r,t,e)}function n(e,t,n){_=e;var o={target:t.target,currentTarget:t.currentTarget,clientX:t.clientX,clientY:t.clientY};p?r(t,n(t))&&(f=o):(null!==d&&clearTimeout(d),d=setTimeout(a,pref.tooltips[e].popup_delay),f=o,m=n)}function a(){d=null,r(f,m(f))?site.script_body.appendChild(c):f=null,m=null}function r(e,t){return t?("string"==typeof t?c.innerHTML=t:(c.innerHTML=t.html,t.callback&&t.callback(c)),null!==u&&(clearTimeout(u),u=null),e&&p!==e.target&&(c.style.left=e.clientX+20+"px",c.style.top=e.clientY+20+"px",p=e.target),!0):(s(),!1)}function o(e){f&&f.currentTarget===e&&s()}function s(){f&&null===u&&(null!==d&&(clearTimeout(d),d=null),u=setTimeout(i,pref.tooltips[_].popdown_delay))}function i(){u=null,p&&(c.parentNode.removeChild(c),p=null,f=null)}function l(e,t){if(!e)return null;var n=t.indexOf(".");return n==-1?e[t]||e["*"]||null:l(e[t.substr(0,n)],t.substr(n+1))}var c=document.createElement("div");c.style.position="fixed",c.setAttribute("class",pref.script_prefix+"_popUp"),c.style.zIndex=pref.tooltips.zIndex;var p=null,_="help",d=null,u=null,f=null,m=null,h={catalog_refresh_clear:"Clear all threads at update.",catalog_promiscuous:"Gather information whatever.",catalog:{filter:{kwd:{re:"Regular Expression.",ci:"Case insensitive. Don't distinguish upper and lower case.",sentence:'"XXXX YYYY" matches itself as a whole instead of matching "XXXX" and/or "YYYY"'},time:"Time : Hide threads which have no posts after the time.",time_creation:"Time(Creation Time) : Hide threads which were created before the time.",time_watch:"Watch: watch threads which have posts after the time.",time_watch_creation:"Watch(Creation Time): watch threads which were created after the time."}},"catalog.filter.tag_search.str":"String for searching tags.\n[CAUTION] this function is very heavy, keep blank here when you don't use.","catalog.filter.tag_list":!1,"network.cross_domain":"Use 'direct' if you could, because it's quite light, but it doesn't work in almost of all environments.\n'indirect' usually works well and gives full functionality.\nOr you can use 'GreaseMonkeyM's extension if your browser tend to close steps for cross domain when you connect over X-Frame-Options, but this doesn't provide localStorage/IDB features in remote domains.",debug_mode:"Debug mode.",show_tooltip:"Show this tooltip.","liveTag.rm_list_str":function(){return this.TagExLists()},"liveTag.ex_list_str":function(){return this.TagExLists()},TagExLists:function(){return"String, ...  or\n/RegularExpression/, ... or \nIdentifier:String, ... or \nIdentifier:/RegularExpression/, ...\n\nRegularExpression must be embraced by shashes, and accepts i flag(case insensitive).\nIdentifier must be followed by :(colon). First colon is interpreted as a delimiter always. Put a colon at the head of line when you want to use colons in search strings for global search(without any identifiers)\n"+this.GeneralRules},catalog_board_list_str:function(){return"How to write 'Board groups'.\n\nNameOfBoardGroup,Identifier, ..., Commands, ...\n\nEach line becomes each board group. One line per one board group.\nFirst column is a name of board group. The name is shown in board selector and become a key for localStorage or statistics.\nSecond or later columns are members. Each member is expressed by 'Identifier'.\nYou can add tags for filtering or picking up threads. Single # means filter, double #(##) means pick up and filter. For example,\n\nCC, lain/λ/, #CatChan // load lain/λ/ and filter by #CatChan, then shows a thread for CatChan in lain/λ/.\nlain#lainchan, lain, #lainchan // load all boards of lain and filter by #lainchan, then show all threads which have the tag(#lainchan).\n#tech, ##tech // load all boards which have #tech from sites which are set in VirtualBoard, and filter by #tech, then show all threads which have the tag(#tech) from sites.\nAnd you can add commands to the last of each line. '!stats' takes statistics if the function is enabled.\n"+this.GeneralRules},GeneralRules:"Double slash(//) is a beginning of comment.\n\nIdentifier:\nIdentifier is a string which contains domain, board and/or thread. You can omit some of them. When some identifiers are dropped, it'll be interpreted as follows. Upper case has the priority.\n\ndomain/board/thread\n/board/thread\ndomain/thread\nthread\ndomain/board/\n/board/\ndomain\n\n'Board identifier' must be expressed in a couple of slashes, like /int/. 'Thread identifier' must be numeric. When the identifier is a word, it'll be 'Thread identifier' if it is numeric, otherwise it'll be a 'Domain identifier'. Domain identifiers must be one of meguca, lain, 4chan, 8chan or KC.","catalog.style_general_list_str":function(){return"Identifier^Style_string\nStyle_string is a string and set to its object.style.XXXX. Therefore you can use all of styles in CSS, which ranges from 'background' or 'border' to 'fontSize', 'width' or 'height'\n"+this.GeneralRules},"catalog.board.recommendation":"Scans 'board announcement' and gets owner's recommendation. This recommendation must be start 'Recommendation: ', and the following part of the line is treated as a line of board groups. The recommendation can be seen in a last line of board groups.",catalog_triage_str:"// 1st column :\n//   KILL : delete forever, and set its style.\n//   TIME : delete until the thread gets new replies, and set its style.\n//   NONE : Don't hide the thread and set its style.\n//   KILL_N : delete forever.\n//   TIME_N : delete until the thread gets new replies.\n//   ATTR : Set its style additionally.\n//   UNDO : undo the last modification.\n//   WATCH : watch this thread, or I've read all replies in this thread.\n//   UNWATCH : unwatch this thread.\n//   STICKY : sticky this thread.\n//   UNSTICKY : unsticky this thread.\n//   SHOW : show this thread always without regard to filter setteings.\n//   UNSHOW : remove 'show' mark.\n// 2nd column : strings in the button.\n// 3rd column : style in HTML.\n// Repeat these as you wish.",overwrite_site2_eval_str:"For developers. This function is killed by security reason. If you want to use, you must uncomment the function 'pref_func.site2_eval' by yourself.","thread_reader.buttons.B":"Bookmark this thread to current catalog.","thread_reader.buttons.UB":"Unbookmark this thread from current catalog.","thread_reader.buttons.X":function(){return"Kill this thread from parent catalog"+(pref.thread_reader.triage_close?", and close.":".")},"thread_reader.buttons.v":function(){return"Hide this thread from parent catalog untill it gets new posts"+(pref.thread_reader.triage_close?", and close.":".")},catalog_open_where:"this tab: open the thread in this tab, and catalog will be closed.\nnew tab always: this enables you to open a thread in multiple tabs.\nnamed tab: this prevents you from opening a thread in multiple tabs.\na fixed tab: this enables you to use a catalog window as a dashboard.","virtualBoard.scan_domains.*":"None: Don't scan.\nBoard: Read boards.json and set them to boardlist, not scan threads at startup. Threads are scanned when you read them.\nThread: Scan all threads at startup.",scanBoard:"Scan selected virtual boards.\nScan this physical board if no virtual board is selected.",scanSite:"Scan all virtual boards.\nScan all boards in this site if no virtual board is selected.","style.fix.*":"Write style strings.","style.copy.*":"Write exact selectorText in CSS, then its styles are copied.",debug_mode:["pipe","","removed threads from catalog"],dummy:"",archive:{kwd:null},"#*":function(e,t){return liveTag.tooltip(e,t)}};return h.archive.kwd=h.catalog.filter.kwd,h["catalog.filter.tag_search.re"]=h.catalog.filter.kwd.re,Object.defineProperty(h,"catalog_triage_str",{value:h.catalog_triage_str,enumerable:!0,configurable:!0,writable:!1}),{add_root:function(e){e.addEventListener("mouseover",t,!1),e.addEventListener("mouseleave",s,!1)},remove_root:function(e){e.removeEventListener("mouseover",t,!1),e.removeEventListener("mouseleave",s,!1)},show:e,str:h,req_show:n,hide2:s,show_2:r,hide:s,hide_if:o}}(),pref_samples:site0.isStep?null:{simple:{catalog_triage_str:"KILL,X,",catalog:{style_general_list_str:"%border:4px solid #d6daf0\n%margin:4px",format:{show:{posts:!0}}}},backwash:{catalog_triage_str:"NONE,O,width:;height:,NONE,O,border:4px solid #ff0000;width:100px;height:100px,NONE,O,border:4px solid #00ff00;width:100px;height:100px,NONE,O,border:4px solid #0000ff;width:100px;height:100px,NONE,O,border:4px solid #ffff00;width:100px;height:100px,NONE,O,border:4px solid #ff00ff;width:100px;height:100px,NONE,O,border:4px solid #00ffff;width:100px;height:100px",page:{click:"expand"},catalog:{format:{show:{style:!0,contents:!0,layout:!0,posts:!0,fileinfo:!0,images_2nd:!0}}}},recommend:{max_threads_at_refresh:500,catalog:{auto_load_filter:!0,auto_save_filter:!0,auto_save_filter_at_refresh:!0,order:{sticky:"first"},board:{board_tags_same:!0},auto_update:!0,auto_update_period:1},page:{auto_update:!0,auto_update_period:1},float:{auto_update:!0,auto_update_period:1}},get easy2(){return pref.easy2},"easy2.presets":function(){var e=[{liveTag:{use:!1},virtualBoard:{scan:!1},LTfrom:0,VB:{local:0,global:0},network:{fetch_actively:!1}},{liveTag:{use:!1},virtualBoard:{scan:!0},LTfrom:0,VB:{local:1,global:0},network:{fetch_actively:!1}},{liveTag:{use:!1},virtualBoard:{scan:!0},LTfrom:0,VB:{local:1,global:1},network:{fetch_actively:!1}},{liveTag:{use:!0},virtualBoard:{scan:!0},LTfrom:0,VB:{local:2,global:0},network:{fetch_actively:!0}},{liveTag:{use:!0},virtualBoard:{scan:!0},LTfrom:0,VB:{local:2,global:1},network:{fetch_actively:!0}},{liveTag:{use:!0},virtualBoard:{scan:!0},LTfrom:0,VB:{local:2,global:2},network:{fetch_actively:!0}},{liveTag:{use:!0},virtualBoard:{scan:!0},LTfrom:1,VB:{local:2,global:0},network:{fetch_actively:!0}},{liveTag:{use:!0},virtualBoard:{scan:!0},LTfrom:1,VB:{local:2,global:1},network:{fetch_actively:!0}},{liveTag:{use:!0},virtualBoard:{scan:!0},LTfrom:1,VB:{local:2,global:2},network:{fetch_actively:!0}}],t=["none","board","thread"],n={catalog:{auto_load_filter:!0,auto_save_filter:!0,auto_save_filter_at_refresh:!0},page:{load_on_demand:!0}};return function(a){var r=pref.easy2;void 0!==a&&pref_func.pref_overwrite(r,e[a]),r.virtualBoard.scan_domains={};for(var o in pref.virtualBoard.scan_domains)r.virtualBoard.scan_domains[o]=t[o===site.nickname?r.VB.local:r.VB.global];r.liveTag.from=0===r.LTfrom?"op":"post";var s={auto_update:pref.easy2.auto_update,auto_update_period:pref.easy2.auto_update_period};return r.catalog.embed&&pref_func.pref_overwrite(r,{catalog:s}),r.catalog.embed_page&&pref_func.pref_overwrite(r,{page:s}),r.thread.embed&&pref_func.pref_overwrite(r,{thread:s}),(r.catalog.filter.time_watch||r.catalog.filter.time_watch_creation)&&(r.catalog.filter.time_str=new Date(Date.now()-36e5*(r.catalog.filter.time_watch?r.time_post:r.time_op)).toLocaleString()),pref.easy2.basics&&pref_func.pref_overwrite(r,n),r}}(),"easy2.limits":function(){var e=[{virtualBoard:{max:100},scan:{max:100,max_threads:1e3},catalog:{max_threads_at_refresh:500}},{virtualBoard:{max:50},scan:{max:100,max_threads:1500},catalog:{max_threads_at_refresh:1500}},{virtualBoard:{max:150},scan:{max:100,max_threads:15e3},catalog:{max_threads_at_refresh:15e3}},{virtualBoard:{max:100},scan:{max:50,max_threads:15e3},catalog:{max_threads_at_refresh:15e3}},{virtualBoard:{max:150},scan:{max:100,max_threads:3e4},catalog:{max_threads_at_refresh:15e3}},{virtualBoard:{max:200},scan:{max:500,max_threads:1e5},catalog:{max_threads_at_refresh:15e3}},{virtualBoard:{max:200},scan:{max:1e4,max_threads:1e5},catalog:{max_threads_at_refresh:15e3}},{virtualBoard:{max:150},scan:{max:100,max_threads:15e3},catalog:{max_threads_at_refresh:15e3}}];return function(){pref_func.pref_overwrite(pref.easy2,e[pref.easy2.limits])}}(),"easy.virtualBoard_10_passive":{virtualBoard:{show:!0,scan:!0,max:20},catalog:{auto_load_filter:!0,auto_save_filter:!0,auto_save_filter_at_refresh:!0,auto_update:!0,auto_update_period:10},page:{auto_update:!0,auto_update_period:10},float:{auto_update:!0,auto_update_period:10},func:function(){for(var e in pref.virtualBoard.scan_domains)pref.virtualBoard.scan_domains[e]=e===site.nickname?"board":"none"}},"easy.virtualBoard_10":{virtualBoard:{show:!0,scan:!0,max:20},catalog:{auto_load_filter:!0,auto_save_filter:!0,auto_save_filter_at_refresh:!0,auto_update:!0,auto_update_period:10},page:{auto_update:!0,auto_update_period:10},float:{auto_update:!0,auto_update_period:10},func:function(){for(var e in pref.virtualBoard.scan_domains)pref.virtualBoard.scan_domains[e]=e===site.nickname?"thread":"none"}},"easy.virtualBoard_1":{virtualBoard:{show:!0,scan:!0,max:100,scanDelay:20},catalog:{auto_load_filter:!0,auto_save_filter:!0,auto_save_filter_at_refresh:!0,auto_update:!0,auto_update_period:1},page:{auto_update:!0,auto_update_period:1},float:{auto_update:!0,auto_update_period:1},func:function(){for(var e in pref.virtualBoard.scan_domains)pref.virtualBoard.scan_domains[e]=e===site.nickname?"thread":"none"}},"easy.virtualBoard_8_50":{virtualBoard:{show:!0,scan:!0,max:100,scanDelay:20},catalog:{auto_load_filter:!0,auto_save_filter:!0,auto_save_filter_at_refresh:!0,auto_update:!0,auto_update_period:5},page:{auto_update:!0,auto_update_period:5},float:{auto_update:!0,auto_update_period:5},func:function(){pref.scan.max=pref.easy.max_boards;for(var e in pref.virtualBoard.scan_domains)pref.virtualBoard.scan_domains[e]=e===site.nickname?"thread":"none"}},"easy.virtualBoard_8_all":{virtualBoard:{show:!0,scan:!0,max:100,scanDelay:20},scan:{max:1e4},catalog:{auto_load_filter:!0,auto_save_filter:!0,auto_save_filter_at_refresh:!0,auto_update:!0,auto_update_period:5},page:{auto_update:!0,auto_update_period:5},float:{auto_update:!0,auto_update_period:5},func:function(){for(var e in pref.virtualBoard.scan_domains)pref.virtualBoard.scan_domains[e]=e===site.nickname?"thread":"none"}},"easy.virtualBoard_interSite":{virtualBoard:{show:!0,scan:!0,max:100,scanDelay:20},catalog:{auto_load_filter:!0,auto_save_filter:!0,auto_save_filter_at_refresh:!0,auto_update:!0,auto_update_period:10},page:{auto_update:!0,auto_update_period:10},float:{auto_update:!0,auto_update_period:10},func:function(){for(var e in pref.virtualBoard.scan_domains)pref.virtualBoard.scan_domains[e]=e===site.nickname?"thread":"board"}},"easy.posts_0h":{catalog:{filter:{time_str:null,time_watch:!0}},func:function(){pref_func.pref_samples["easy.posts_0h"].catalog.filter.time_str=(new Date).toLocaleString()}},"easy.posts_24h":{catalog:{filter:{time_str:null,time_watch:!0}},func:function(){pref_func.pref_samples["easy.posts_24h"].catalog.filter.time_str=new Date(Date.now()-36e5*pref.easy.posts_ago).toLocaleString()}},"easy.threads_24h":{catalog:{filter:{time_str:null,time_watch_creation:!0}},func:function(){pref_func.pref_samples["easy.threads_24h"].catalog.filter.time_str=new Date(Date.now()-36e5*pref.easy.threads_ago).toLocaleString()}},"easy.embed_index":{catalog:{embed_page:!0,auto_load_filter:!0,auto_save_filter:!0,auto_save_filter_at_refresh:!0}},"easy.embed_index_lazy":{catalog:{embed_page:!0,auto_load_filter:!0,auto_save_filter:!0,auto_save_filter_at_refresh:!0,auto_watch:!1},liveTag:{use:!1},notify:{desktop:{notify:!1}},network:{fetch_actively:!1}},"easy.light":{catalog:{embed_page:!0,auto_load_filter:!0,auto_save_filter:!0,auto_save_filter_at_refresh:!0,filter:{time_watch:!1,time_watch_creation:!1}},liveTag:{use:!1},stats:{use:!1},network:{fetch_actively:!1}},"easy.embed_index_infinite":{catalog_max_page_auto:!0,catalog:{embed_page:!0,auto_load_filter:!0,auto_save_filter:!0,auto_save_filter_at_refresh:!0}},"easy.embed_index_backwash":{catalog_max_page_auto:!0,catalog:{embed_page:!0,auto_load_filter:!0,auto_save_filter:!0,auto_save_filter_at_refresh:!0,auto_update:!0,auto_update_period:0},page:{auto_update:!0,auto_update_period:0},float:{auto_update:!0,auto_update_period:0}},"easy.stat_activate":{stats:{use:!0},virtualBoard:{scan:!0,scan_domains:{}},liveTag:{use:!0,from:"post"},func:function(){this.virtualBoard.scan_domains[site.nickname]="board"}},triage_simple_kill:{catalog_triage_str:"KILL,X,"},triage_simple:{catalog_triage_str:"KILL,X,,TIME,v,,WATCH,W,,UNWATCH,UW,,UNDO,U,"},triage_basic:{catalog_triage_str:"KILL,X,,TIME,v,,WATCH,W,,UNWATCH,UW,,SHOW,★,,UNSHOW,☆,,STICKY,S,,UNSTICKY,US,,UNDO,U,"},triage_basic_color:{catalog_triage_str:"KILL_N,X,,TIME_N,v,,WATCH,W,,UNWATCH,UW,,SHOW,★,,UNSHOW,☆,,STICKY,S,,UNSTICKY,US,,UNDO,U,\nNONE,O,,ATTR,O,background:#c3dcf9,ATTR,O,background:#b8efc2,ATTR,O,background:#efedbe,ATTR,O,background:#fbd5fb,ATTR,O,background:#fac2c5\nATTR,O,border:3px solid blue,ATTR,O,border:3px solid lime,ATTR,O,border:3px solid yellow,ATTR,O,border:3px solid orange,ATTR,O,border:3px solid red\n"},triage_colorful:{catalog_triage_str:"KILL,X,,KILL,X,background:#c3dcf9,KILL,X,background:#b8efc2,KILL,X,background:#efedbe,KILL,X,background:#fbd5fb,KILL,X,background:#fac2c5\nTIME,v,,TIME,v,background:#c3dcf9,TIME,v,background:#b8efc2,TIME,v,background:#efedbe,TIME,v,background:#fbd5fb,TIME,v,background:#fac2c5\nNONE,O,,NONE,O,background:#c3dcf9,NONE,O,background:#b8efc2,NONE,O,background:#efedbe,NONE,O,background:#fbd5fb,NONE,O,background:#fac2c5\nUNDO,U,,WATCH,W,,UNWATCH,UW,,GO,G,\n"},triage_borders:{catalog_triage_str:"KILL,X,,KILL,X,border:3px solid blue,KILL,X,border:3px solid lime,KILL,X,border:3px solid yellow,KILL,X,border:3px solid orange,KILL,X,border:3px solid red\nTIME,v,,TIME,v,border:3px solid blue,TIME,v,border:3px solid lime,TIME,v,border:3px solid yellow,TIME,v,border:3px solid orange,TIME,v,border:3px solid red\nNONE,O,,NONE,O,border:3px solid blue,NONE,O,border:3px solid lime,NONE,O,border:3px solid yellow,NONE,O,border:3px solid orange,NONE,O,border:3px solid red\nUNDO,U,,WATCH,W,,UNWATCH,UW,,GO,G,\n"},triage_samples:{catalog_triage_str:"KILL,delete forever,\nTIME,hide until new replies,\nNONE,back to default design,background:;border:;\nNONE,border and background,background:#c3dcf9;border:3px solid blue\nNONE,border 3px,border:3px solid blue\nNONE,background,background:#c3dcf9\nNONE,border 5px,border:5px solid blue\nNONE,border 1px,border:1px solid blue\nNONE,transparent,background:\nNONE,shrink,width:100px;height:100px\nGO,open this thread,\n"},triage_test:{catalog_triage_str:"KILL,X,,TIME,v,,WATCH,W,,UNWATCH,UW,,SHOW,★,,UNSHOW,☆,,STICKY,S,,UNSTICKY,US,,UNDO,U,,ARC,A+,,ARC1,A1,,UARC,A-,"},pn_samples:null,init:function(){if(!pref_func.pref_samples.pn_samples){cnst.make_popup(pref_func.pref_samples,"pn_samples",'General samples:<br><button name="simple">simple</button><br><button name="backwash">backwash</button><br><button name="recommend">recommend for desktop/note</button><br>Triages:<br><button name="triage_simple_kill">simple_kill</button><br><button name="triage_simple">simple</button><br><button name="triage_basic">basic</button><br><button name="triage_basic_color">basic_color</button><br><button name="triage_colorful">colorful</button><br><button name="triage_borders">borders</button><br><button name="triage_samples">samples</button><br><button name="triage_test">test</button><br>',pref_func.pref_samples.onclick_event)}},get_name:function(e,t,n){for(var a in e)"object"!=typeof e[a]?t.push(n+a):pref_func.pref_samples.get_name(e[a],t,n+a+".");return t},onclick_event:function(e,t){t||(t=pref_func.pref_samples[this.name]),t.func&&"function"==typeof t.func&&t.func(),pref_func.pref_overwrite(pref,t),pref_func.pref_overwrite(pref_func.tooltips.str,t);for(var n=pref_func.pref_samples.get_name(t,[],""),a=Array.prototype.slice.call(document.querySelectorAll("*[name]")),r=a.length-1;r>=0;r--)n.indexOf(a[r].name)==-1&&a.splice(r,1);a.length>0&&pref_func.apply_prep(a,!1,!0,null,!0)}},settings:{pn13:null,show_hide:function(e){if(null===pref_func.settings.pn13){var t=(2*e.clientX>window.innerWidth?"right":"left")+":0px:"+(2*e.clientY>window.innerHeight?"bottom:0":"top:"+site.header_height())+"px",n=cnst.init(t+":Show:tb",cnst.void_func,cnst.void_func,pref_func.settings.show_hide,cnst.void_func),a=cnst.add_to_tb(n,'<select name="settings.indexing"><option>'+pref_func.settings.options.join("</option><option>")+"</option></select>");a.getElementsByTagName("select")["settings.indexing"].selectedIndex=pref.settings.indexing<pref_func.settings.options.length?pref.settings.indexing:0,pref_func.settings.pn13=n,pref_func.mirror_targets.pn13_1=n.childNodes[1],pref_func.settings.onchange_funcs["settings.indexing"](),pref_func.add_onchange(a,pref_func.settings.onchange_funcs_formatted),pref_func.tooltips.add_root(pref_func.mirror_targets.pn13_1),cnst.bottom_top(n)}else pref_func.tooltips.remove_root(pref_func.mirror_targets.pn13_1),pref_func.settings.files_store(),pref_func.mirror_targets.pn13_1=null,pref_func.settings.pn13=cnst.div_destroy(pref_func.settings.pn13,!0)},apply_pn13_1:function(e,t){pref_func.apply_prep(pref_func.settings.pn13.childNodes[1],e,t),pref_func.settings.onchange_funcs.pn13_1_warning()},files_store:function(){var e=pref_func.settings.pn13.querySelectorAll("input[type=file]");e.length>0&&pref_func.apply_prep_2(e,!0)},insert_menu:function(e,t){var n=pref_func.settings.options.length-1;pref_func.settings.options.splice(n,0,e),pref_func.settings.htmls.splice(n,0,t)},html_funcs:{show_hide_all_to_header:function(e){return"<span>"+e+'<a name="SHOWALL" style="float:right;cursor:pointer" data-str="[all▲]">[all▼]</a></span>'},show_hide_all:function(e,t){return'<a name="SHOWALL" style="cursor:pointer">['+e+']</a><a name="HIDEALL" style="cursor:pointer">['+t+"]</a>"},show_hide:function(e,t,n,a){return'<a name="SHOW" style="cursor:pointer" data-str="'+t+'">'+e+'</a><span style="display:none" name="SUB">'+(a||"")+"<br>"+n+"</span>"},popup:function(e){return'2,<ICBX"'+e+'.popup"> Pop up reply'+this.rollup(this.popup_delay("proto.")+'<br>3,<IC"proto.popup_hlt">Highlight the post if it is visible')+"<br>"},popup_delay:function(e,t){return'4,<IR"'+e+'popdown,imm">immediately<br>4,<IR"'+e+'popdown,delay">delayed: <ITB4"'+e+'popup_delay">'+(t?"":'<ITB4"'+e+'popdown_delay">')+' ms<br>5,<IC"'+e+'popup_mMove">Don\'t popup while mouse is moving<br>4,zIndex: <ITB3"'+e+'popup_zIndex">'},expand_thumbnail_inline:function(e){var t=e+".thumbnail.inline.";return'2,<IC"'+e+'.expand_thumbnail_inline">Image expansion at click'+this.rollup(this.limit_webm(t)+'3,<IC"'+e+'.expand_thumbnail_initial">Expand all images at initial<br>3,<IC"'+e+'.expand_thumbnail_inline_all_after">Expand all images after clicked one<br>4,<IC"'+t+'ondemand">On demand loading: <ITB3"'+t+'ref_height"> % of browser')+"<br>"},expand_thumbnail_hover:function(e){var t=e+".thumbnail.hover.";return'2,<IC"'+e+'.image_hover">Image hover'+this.rollup(this.popup_delay(t,!0)+"<br>"+this.limit_webm(t)+'3,<IC"'+e+'.image_prefetch">Prefetch next image<br>3,<IC"'+t+'dragfloat">Drag thumbnail to make it window<br>4,<IC"'+t+'df_dblC">Double click to close<br>4,<IC"'+t+'df_mW">Wheel to scroll<br>4,<IC"'+t+'df_cV">Continue playing video<br>3,<IC"'+t+'zoom">Click to zoom mode if limited')+"<br>"},limit_webm:function(e){return'4,<IC"'+e+'limit_width">Limit to browser\'s width - <ITB3"'+e+'margin_width"> px<br>4,<IC"'+e+'limit_height">Limit to browser\'s height - <ITB3"'+e+'margin_height"> px<br>4,<IC"'+e+'webm">Play webm<br>5,<IC"'+e+'webm_loop">Loop<br>5,<IC"'+e+'webm_mute">Mute<br>'},env:function(e,t){return"1,Environment values:(advanced option)"+this.rollup('2,You are using native function of:<br>3,<IC"'+e+'.popup_native">Pop up reply<br>3,<IC"'+e+'.expand_thumbnail_inline_native">Image expansion<br>3,<IC"'+e+'.image_hover_native">Image hover<br>3,<IC"'+e+'.colorID_native">Color ID<br>3,<IC"'+e+'.backlink_native">Backlink<br>3,<IC"'+e+'.localtime_native">Local time'+t+'<br>2,<IC"'+e+'.popup_native_kill">Suppress native static popup<br>2,<IC"'+e+'.refresh_initial">Refresh at initial<br>')+"<br>"},posts_for_search:function(e){
return"2,"+this.rollup_radio(e+".storePosts"," :Num of posts to store for search",3,"",["no:No additional posts are stored for search.<br>5,Search will be done only from posts for preview.","ALL:All posts are stored always.<br>5,Search will be done from all posts without preparation scan.","auto:All posts in all scanned threads are stored after the first activation of search.<br>5,Need (automatic) scans prior to search. (usual usage)",'ALL_agg:All posts in all scanned threads are stored.<br>5,Search will be done from all scanned threads.<br>5,This is an option for search from entire domains.<br>3,<IC"proto.searchAc.loosen">Auto loosen limits at the first activation'+this.rollup('6,Max boards of a scan: <ITB6"proto.searchAc.max"><br>6,Max threads of a scan: <ITB6"proto.searchAc.max_threads"><br>6,Max threads at refresh (auto deletion): <ITB6"proto.searchAc.max_threads_at_refresh"><br>5,<BTN"tighten_loosed_limits,Tighten loosed limits">')+'<br>3,<IC"proto.searchAs">Auto scan from this (virtual) board if needed <BTN"scanBoardIf,Scan"><BTN"scanBoard,Rescan"><br>3,<IC"proto.searchAsA">Auto scan from all (virtual) boards if needed <BTN"scanSiteIf,Scan"><BTN"scanSite,Rescan">'])+"<br>2,"+this.rollup_radio(e+".sourceOfSP"," :Posts to be used for search",3,"3,Posts may be stored also by function of deleted posts detection.<br>3,Number of stored posts can be shown in footer.<br>",["auto:All stored posts.(usual usage)","pv:Posts for preview only.<br>5,Search will be done only from recent or newer posts,<br>5,which depends on preview settings."])+"<br>"},op_in_search_result:function(e){return"2,"+this.rollup_radio(e+".posts_search_op"," :Unmatched OP in search result",3,"",["show:Show",'opaque:Opaque: <ITB3"'+e+'.posts_search_op_opacity"> %',"hide:Hide"])+"<br>"},deleted_posts_detection:function(e){return"2,"+this.rollup_radio(e+".deleted_posts.detect"," :Detect deleted posts",4,"3,Detection:<br>",["no:No","passive:Passive detection. Don't make any request","acc:Best effort without any additional requests","full:Full detection, read all posts at first","full_IDB:Full detection with IndexedDB"],'<br>3,<ICBX"'+e+'.deleted_posts.merge"> Merge deleted posts with live posts')},popup_others:function(e){return pref.test_mode[121]?'2,<IC"'+e+'.popupX.use">Pop up others'+this.rollup(this.popup_delay("proto.popupX.")+'<br>3,<IC"'+e+'.popupX.ID">Pop up ID<br>3,<IC"'+e+'.popupX.flag">Pop up flag<br>3,<IC"'+e+'.popupX.name">Pop up name<br>3,<IC"'+e+'.popupX.trip">Pop up trip')+"<br>":""},radios:function(e,t,n,a){var r=t+',<IR"'+e+',$1">'+(a?a.map(function(e){return'<IR"'+e+',$1">'}).join(""):"");return n.map(function(e){return e.replace(/([^:]*):/,r)}).join("<br>")},rollup_radio:function(e,t,n,a,r,o,s){return'<a name="SHOW2" style="cursor:pointer" data-str="▲]">[<SSV"'+e+'"></span>▼]</a><span name="SHOW2_I">'+t+'</span><span style="display:none" name="SUB"><br>'+a+this.radios(e,n,r,s)+(o||"")+"</span>"},rollup:function(e,t){return"&emsp;"+this.show_hide("[▼]","[▲]",e,t)},format_posts:function(e,t){return'2,<IC"'+e+'.open_spoiler_text">Open text spoiler<br>2,<IC"'+e+'.colorID">Color ID<br>'+this.backlink(e)+'2,<IC"'+e+'.localtime">Local time<br>'+t.deleted_posts_detection(e)+'<br>2,<IC"'+e+'.mark_new_posts">Mark new posts<br>'},backlink:function(e){return'2,<IC"'+e+'.backlink">Backlink'+this.rollup('3,<IC"proto.bl_ec">Explicit cross backlink<br>3,<IC"proto.bl_rm">Don\'t retain backlinks to OP<br>3,<IC"'+e+'.backlink_all">Track all backlinks<br>4,<IC"'+e+'.backlink_all_cross">Track all cross-board links')+"<br>"},updates:function(e){return'2,<IC"'+e+'.auto_update">Auto update, every <ITB2"'+e+'.auto_update_period">min.<br>2,<IC"'+e+'.hide_posts_without_images">Hide posts without images<br>2,<IC"'+e+'.merge">Merge all threads'+this.rollup('2,<IC"'+e+'.merge_list">Merge listed threads<br>3,<TA"proto.merge_list_str,40,1" placeholder="4chan/c/2887897 + 4chan/c/2880944 + 4chan/c/2888255,"><br>2,<IC"'+e+'.merge_lv">Merge with level (use user CSS to style)<br>3,<TA"proto.merge_lv_str,40,1">'+this.rollup(this.userCSS(2)))+"<br>"},userCSS:function(e){return e+',<IC"style.userCSS.use">User CSS<br>'+(e+1)+',<TA"style.userCSS.str,50,1"><br>'+(e+1)+",Sample user CSS:<br>"+(e+1)+',<TA"style.userCSS.sample,50,1" disabled>'},vb_domains:function(){for(var e="2,Scan targets:<br>3,None/Board/Thread(No/Passive/Active)<br>",t=site0.domains,n=0;n<t.length;n++)e+='3,<input type="radio" name="virtualBoard.scan_domains.'+t[n]+'" value="none"><input type="radio" name="virtualBoard.scan_domains.'+t[n]+'" value="board"><input type="radio" name="virtualBoard.scan_domains.'+t[n]+'" value="thread"> '+t[n]+"<br>";return e},make_sel:function(e,t){for(var n='<select name="'+e+'" style="float:none">',a=0;a<t.length;a++)n+="<option>"+t[a]+"</option>";return n+"</select>"},features_domains:function(){for(var e="",t=0;t<site0.domains.length;t++)e+='1,<ICBX"features.domains.'+site0.domains[t]+'"> '+site0.domains[t]+"<br>";return e},cb_block:function(e,t){for(var n="",a=t-1;void 0!==pref[e][++a];)n+='<ICBX"'+e+"."+a+'">'+(a%10==4?"&emsp;":a%50==49?"<br><br>":a%10==9?"<br>":"");return n},footer:function(e){var t=e+".footer.";return'1,<IC"'+t+'use">Show information footer'+this.rollup('3,<IC"'+e+'.footer_br">Always over/under the image<br>3,<IC"'+t+'rOP">Num of replies counts OP<br>3,<IC"'+t+'iOP">Num of images counts images in OP')+'<br>2,<IC"'+t+'nr">Show num of new replies (nr)<br>3,<IC"'+t+'nrtm">Show num of new replies to me (nm)<br>2,<IC"'+t+'rp">Show num of replies (rp)<br>2,<IC"'+t+'im">Show num of images (im)<br>2,<IC"'+t+'nl">Show num of stored live posts (lp)<br>2,<IC"'+t+'nd">Show num of deleted posts (dp)<br>2,<IC"'+t+'ns">Show num of saged posts (sp)<br>2,<IC"'+t+'page">Show page No. (pg)<br>2,<IC"threadStats.use">Take statistics of each thread'+this.rollup('4,<IC"threadStats.full">Issue additional fetchs if required<br>5,<IC"threadStats.retry">Retry if obsolete data(may cause infinite loop)')+'<br>3,<IC"'+t+'nid">Show num of IDs (ni)<br>3,<IC"'+t+'nf">Show num of flags (nf)<br>2,<ICBX"'+t+'ctime"> <IC"'+t+'rctime">Show created time (ct), relative (cT)<br>2,<ICBX"'+t+'btime"> <IC"'+t+'rbtime">Show bumped time (bt), relative (bT)<br>2,<ICBX"'+t+'ptime"> <IC"'+t+'rptime">Show last posted time (pt), relative (pT)<br>2,<IC"'+t+'prate">Show post rate (pr)<br>2,<IC"'+t+'domain">Show domain\'s name (dn)<br>2,<IC"'+t+'board">Show board\'s name (bd)<br>2,<IC"'+t+'no">Show thread\'s no (no)<br>2,<IC"'+t+'archived">Show archived (ar)<br>2,<IC"'+t+'tag">Show tags (tg)<br>2,<IC"'+t+'flag">Show recent flags (rf)<br>2,Design:<br>3,<IR"'+t+'design,native"> U: */* / R: * / I: * / P: *<br>3,<IR"'+t+'design,condensed"> */*/*/*/*<br>3,<IR"'+t+'design,meguca"> /bd/ */*/*/*/*<br>3,<IR"'+t+'design,custom"> <ITBL40"'+t+'custom"><br>3,<IR"'+t+'design,custom2"> <ITBL40"'+t+'custom2"><br>'}},options:["Easy Setting2:","Easy Setting:","Virtual Board:","Catalog:","Index Page:","Thread:","Floating Catalog:","Gerenal 0","General 1","Board Group","Live Tag","Statistics","Design of FC","Footer","Footer for watcher","Watcher","Notifiers","JSON Archiver: Store","JSON Archiver: Restore","UIP tracker for 4chan","Command Line Interface","Networking","General 2","Styles","Features","About"],htmls:[function(e){return'Easy Setting2: --- Welcome to CatChan! ---<br><br>1,0. <button name="easy2.beginner">I\'m a beginner and I just want to try</button>, click this.<br>2,Then a reload will be occur after loading settings for beginner.<br>2,(This will be default after a certain period of test.)<br>2,Or follow next steps to choose your favorite settings.<br><br>1,1. <input type="checkbox" name="easy2.reset"> Reset all settings before loading new one if you prefer.<br>1,2. Select a preset: <select name="easy2.presets" style="float:none"><option>Safe default</option><option>Silent inter-board operability (for beginner)</option><option>Silent inter-site operability</option><option>Active inter-board operability</option><option>Active inter-site ondemand operability</option><option>Active inter-site operability</option><option>Active in-board operability with LiveTag</option><option>Active inter-board operability with LiveTag</option><option>Active inter-site operability with LiveTag</option></select><br>1,3. Select limits for safe: <select name="easy2.limits" style="float:none"><option>General</option><option>/all/ for lain, meguca</option><option>/all/ for 4chan</option><option>8chan with top 50 boards</option><option>8chan with top 100 boards</option><option>8chan with top 500 boards</option><option>8chan with all boards</option><option>/all/ for KC</option></select><br>1,4. Modify details if you want.<br>2,<input type="checkbox" name="easy2.virtualBoard.show"> VirtualBoards, shows <input type="text" name="easy2.virtualBoard.max" size="3" style="text-align: right;"> virtual boards<br>4,Local: <select name="easy2.VB.local" style="float:none"><option>No</option><option>Passive</option><option>Active</option></select>&emsp;Global: <select name="easy2.VB.global" style="float:none"><option>No</option><option>Passive</option><option>Active</option></select><br>2,<input type="checkbox" name="easy2.liveTag.use"> LiveTag, from: <select name="easy2.LTfrom" style="float:none"><option>OP</option><option>Posts</option></select><br>2,<IC"easy2.catalog.embed">Use CatChan in catalog<br>2,<IC"easy2.catalog.embed_page">Use CatChan in index page<br>2,<IC"easy2.thread.embed">Use CatChan in thread<br>2,<IC"easy2.auto_update">Auto update, every <ITB2"easy2.auto_update_period"> min.<br>2,<IC"easy2.notify.desktop.notify">Desktop notification<br>2,Misc.'+e.rollup('3,<IC"easy2.catalog.filter.time_watch">Hide all threads which have no posts in recent <ITB3"easy2.time_post"> hours<br>3,<IC"easy2.catalog.filter.time_watch_creation">Hide all threads which are created before <ITB3"easy2.time_op"> hours ago<br>3,<IC"easy2.stats.use">Statistics<br>3,<IC"easy2.healthIndicator.expand_running">Show details of running indicators<br>3,<IC"easy2.network.fetch_actively">Fetch missing info actively<br>3,<IC"easy2.basics">Other basic settings<br>3,Limits for safe: <br>4,At scan: <ITB6"easy2.scan.max"> boards, <ITB6"easy2.scan.max_threads"> threads.<br>4,In a catalog: <ITB6"easy2.catalog.max_threads_at_refresh"> threads.')+'<br>1,5. Click <button name="easy2.apply">Apply</button><br>1,6. Click <button name="save">Save</button> if you want to save your settings to localStorage<br>1,7. Click <button name="reload">Reload</button>, because some setting may need<br>'},'Easy Setting:<br>&emsp;VBs: virtual boards<br>&emsp;AU: auto update every X min<br>&emsp;<button name="easy.virtualBoard_10_passive">Click</button> 20 VBs / AU 10 min. / passive scan. (for all)<br>&emsp;<button name="easy.virtualBoard_10">Click</button> 20 VBs / AU 10 min. (for lainchan and meguca)<br>&emsp;<button name="easy.virtualBoard_1">Click</button> 100 VBs / AU 1 min. (for 4chan)<br>&emsp;<button name="easy.virtualBoard_8_50">Click</button> 100 VBs / AU 5 min from top <input type="text" name="easy.max_boards" size="3" style="text-align: right;"> boards. (for 8chan)<br>&emsp;<button name="easy.virtualBoard_8_all">Click</button> 100 VBs / AU 5 min from all boards. (for 8chan)<br>&emsp;<button name="easy.virtualBoard_interSite">Click</button> 100 VBs / AU 10 min from all sites. / passive scan. (for all)<br><br>&emsp;<button name="easy.posts_0h">Click</button> I want to check all new posts from now.<br>&emsp;<button name="easy.posts_24h">Click</button> I want to check all posts from <input type="text" name="easy.posts_ago" size="3" style="text-align: right;"> hours ago.<br>&emsp;<button name="easy.threads_24h">Click</button> I want to check all new threads from <input type="text" name="easy.threads_ago" size="3" style="text-align: right;"> hours ago.<br><br>&emsp;<button name="easy.embed_index_lazy">Click</button> Setup for narrow band.<br>&emsp;<button name="easy.embed_index_infinite">Click</button> Setup for infinite scroll.<br>&emsp;<button name="easy.embed_index_backwash">Click</button> Backwash style. (infinite scroll/quick auto update)<br><br>&emsp;<button name="easy.light">Click</button> Setup for light start up.<br>',function(e){return'Virtual Board:<br>&emsp;<input type="checkbox" name="virtualBoard.show"> Show virtual boards, up to: <input type="text" name="virtualBoard.max" size="3" style="text-align: right;"><br>2,<ICBX"virtualBoard.search.show"> Show search bar in boardlist<br>&emsp;<input type="checkbox" name="virtualBoard.scan"> Scan at start up, delay: <input type="text" name="virtualBoard.scanDelay" size="2" style="text-align: right;">s<br>&emsp;&emsp;&emsp;Scan: <button name="virtualBoard.scanStart">Start</button>&emsp;<button name="virtualBoard.scanStop">Stop</button><br>'+e.vb_domains()+'&emsp;&emsp;<input type="checkbox" name="virtualBoard.instant_scan"> Instant scan<br>&emsp;Physical boards in boardlist:<br>&emsp;&emsp;<input type="radio" name="virtualBoard.p_board" value="both"> Show as they are<br>&emsp;&emsp;&emsp;<input type="checkbox" name="virtualBoard.p_remove"> Remove virtual boards of the same name<br>&emsp;&emsp;<input type="radio" name="virtualBoard.p_board" value="replace"> Replace with virtual boards<br>1,<IC"liveTag.info">Show infomation on hover<br>1,Styles:'+e.rollup('2,Selected:<ITBL30"liveTag.style.in"><br>2,Excluded:<ITBL30"liveTag.style.ex"><br>2,<IC"liveTag.style.use">Add style for unread posts:<br>3,Unread replies to me:<ITBL30"liveTag.style.urtm"><br>3,Unread replies:<ITBL30"liveTag.style.ur"><br>3,Unread replies to me + selected:<ITBL30"liveTag.style.inurtm"><br>3,Unread replies + selected:<ITBL30"liveTag.style.inur"><br>3,Unread replies to me + excluded:<ITBL30"liveTag.style.exurtm"><br>3,Unread replies + excluded:<ITBL30"liveTag.style.exur">')+"<br>"},function(e){return e.show_hide_all_to_header("Catalog:")+'<br>&emsp;<input type="checkbox" name="catalog.embed"> Use CatChan in catalog<br>'+e.expand_thumbnail_hover("catalog")+e.popup_others("catalog")+'&emsp;&emsp;<input type="checkbox" name="catalog.open_spoiler_text"> Open text spoiler<br>&emsp;&emsp;<input type="checkbox" name="catalog.auto_update"> Auto update, every <input type="text" name="catalog.auto_update_period" size="2" style="text-align: right;"> min.<br>&emsp;&emsp;<input type="checkbox" name="page.mark_new_posts"> Mark new posts when you open a thread<br>2,'+e.rollup_radio("catalog.click_area"," :Click to open the thread",3,"",["thumbnail:Thumbnail","entire:Entire thread card"])+"<br>2,"+e.rollup_radio(pref.test_mode[110]?"catalog.popup2":"catalog.popup3.ww"," :Pop up",3,"3,WW/WN/NW/NN (Wider/Narrower) side:"+e.rollup(e.popup_delay("proto.popup3."))+"<br>",["no:No","sr:Search result","srpv:Search result or preview","pv:Preview","chart:Post rate chart (statistics must be activated)","dp:Deleted posts"],"",["catalog.popup3.wn","catalog.popup3.nw","catalog.popup3.nn"])+"<br>2,"+e.rollup_radio("catalog.t2h_sel"," :Num of posts for preview or footer",3,"",["no:No",'N:Last <ITB3"catalog.t2h_num_of_posts"> posts (N posts)',"N_unread:N + all unread posts","unread:All unread posts","ALL:All posts"])+"<br>"+e.posts_for_search("catalog")+e.op_in_search_result("catalog")+e.deleted_posts_detection("catalog")+'<br>2,<IC"catalog.detect_sage">Detect saged posts in 4chan<br>3,<IC"catalog.page_his">Store page history in 4chan<br>'+e.backlink("catalog")+'2,<IC"catalog.save_board_list_sel">Save board group index<br>2,<IC"catalog.promiscuous">Show all fetched threads<br>1,<IC"catalog.embed_archive">Generate catalog in archive'+e.rollup('5,from top <ITB5"scan.max_archive"> threads')+"<br><br>1,Environment values:(advanced option)"+e.rollup('2,You are using native function of:<br>3,<IC"catalog.env.image_hover_native">Image hover<br>2,<IC"catalog.env.refresh_initial">Refresh at initial')+"<br>"},function(e){return e.show_hide_all_to_header("Index Page:")+'<br>&emsp;<input type="checkbox" name="catalog.embed_page"> Use CatChan in index page'+e.rollup('3,Refresh up to:<br>4,<IR"catalog_max_page_select,manual"> <ITB2"catalog_max_page"> pages<br>4,<IR"catalog_max_page_select,auto"> Max pages<br>5,<ICBX"catalog_max_page_auto"> Update automatically')+"<br>"+e.popup("page")+e.expand_thumbnail_inline("page")+e.expand_thumbnail_hover("page")+e.popup_others("page")+e.format_posts("page",e)+'2,<ICBX"page.use_expander_always"> Use CatChan\'s expander always<br>2,'+e.rollup_radio("page.t2h_sel"," :Num of posts to show",3,"",["page:Inherit from index page",'L: <ITB3"page.t2h_L"> posts(L posts)','M: <ITB3"page.t2h_M"> posts(M posts)','N: <ITB3"page.t2h_num_of_posts"> posts(N posts)',"N_unread:N + all unread posts","unread:All unread posts","ALL:All posts"])+"<br>"+e.posts_for_search("page")+e.op_in_search_result("page")+e.updates("page")+'&emsp;&emsp;<input type="checkbox" name="page.scroll_lock"> Don\'t scroll at update<br>2,<IC"page.save_board_list_sel"> Save board group index<br>2,<IC"page.promiscuous">Show all fetched threads<br><br>'+e.env("page.env","")},function(e){return e.show_hide_all_to_header("Thread:")+'<br>&emsp;<input type="checkbox" name="thread.embed"> Use CatChan in thread<br>'+e.popup("thread")+e.expand_thumbnail_inline("thread")+e.expand_thumbnail_hover("thread")+e.popup_others("thread")+e.format_posts("thread",e)+e.updates("thread")+'2,<IC"archive.IDB.redirect_404">Open archive from IDB if 404'+e.rollup('3,<IC"archive.IDB.redirect_404_CSP">Open blob to bypass Content Security Policy')+"<br><br>"+e.env("thread.env",'<br>3,<input type="checkbox" name="thread.env.auto_update_native"> Auto update')},'Floating Catalog:<br>&emsp;&emsp;<input type="checkbox" name="float.auto_update"> Auto update, every <input type="text" name="float.auto_update_period" size="2" style="text-align: right;"> min.<br>&emsp;Click to:<br>&emsp;&emsp;<input type="radio" name="float.click" value="open">Go to/open the thread<br>&emsp;&emsp;<input type="radio" name="float.click" value="expand">Expand/shrink the OP in catalog<br>&emsp;&emsp;&emsp;&emsp;<input type="checkbox" name="catalog_expand_with_hr"> Insert horizontal splitter when it is expanded<br>&emsp;&emsp;&emsp;<input type="checkbox" name="catalog_no_popup_at_expanded"> Don\'t popup when the catalog is expanded<br>&emsp;&emsp;<input type="radio" name="float.click" value="none">None<br>&emsp;Click area:<br>&emsp;&emsp;<input type="radio" name="float.click_area" value="thumbnail">Thumbnail<br>&emsp;&emsp;<input type="radio" name="float.click_area" value="entire">Entire thread card<br>&emsp;<input type="checkbox" name="float.popup2"> Use pop-up window<br>2,appear/disappear:<br>3,<IR"catalog_popdown,imm">immediately<br>3,<IR"catalog_popdown,delay">delayed: <ITB4"catalog_popup_delay"><ITB4"catalog_popdown_delay"> ms<br>2,grab to move / select text:<br>3,<IR"proto.popup2_sel,move">Move always<br>3,<IR"proto.popup2_sel,auto">Auto, padding-x:<ITB4"proto.popup2_sel_tolerance"> px<br>3,<IR"proto.popup2_sel,sel">Select always<br>3,<ICBX"catalog_popup_size_fix"> Fix size when you move it<br>2,<IC"proto.popup2_resize">Resize on borders of <ITB4"proto.popup2_resize_bw"> px<br>3,Size of corner angle: <ITB4"proto.popup2_resize_cw"> px<br>1,At initial:<br>2,<IR"catalog.appearance.initial.state,max">Maximized<br>2,<IR"catalog.appearance.initial.state,float">Floating <ITB4"catalog.appearance.initial.width"> x <ITB4"catalog.appearance.initial.height"><br>4,left:<ITB4"catalog.appearance.initial.left">px, top:<ITB4"catalog.appearance.initial.top">px<br>2,<IR"catalog.appearance.initial.state,top">Embed to top<br>2,<IR"catalog.appearance.initial.state,bottom">Embed to bottom<br>1,<IC"float.save_board_list_sel">Save board group index<br>','General 0:<br>&emsp; Open short link<br>&emsp;&emsp;<input type="radio" name="catalog_open_last50" value="no">No. Open entire thread<br>&emsp;&emsp;<input type="radio" name="catalog_open_last50" value="exist">If it exists<br>&emsp;&emsp;<input type="radio" name="catalog_open_last50" value="exist_watch">If it exists and all unread posts are in it<br>&emsp; Open the thread in<br>&emsp;&emsp;<input type="radio" name="catalog_open_where" value="_self">this tab<br>&emsp;&emsp;<input type="radio" name="catalog_open_where" value="_blank">new tab always<br>&emsp;&emsp;<input type="radio" name="catalog_open_where" value="named">named tab<br>&emsp;&emsp;<input type="radio" name="catalog_open_where" value="CatChan_tgt">a fixed tab<br>2,<ICBX"pref2.meguca.historyAPI"> Use historyAPI in meguca<br>&emsp;<input type="checkbox" name="catalog_triage"> Enable triage pop-up<br>2,Where to show:<br>3,<span style="display:inline-block"><IR"catalog_triage_place,topLeft">Top left<br><IR"catalog_triage_place,bottomLeft">Bottom left</span><span style="display:inline-block"><IR"catalog_triage_place,topRight">Top right<br><IR"catalog_triage_place,bottomRight">Bottom right</span><br>&emsp;&emsp;pop down delay: <input type="text" name="triage.popdown_delay" size="4" style="text-align: right;">ms<br>&emsp;&emsp;&emsp;<input type="checkbox" name="triage.show_always"> Don\'t pop down while the mouse is on the thread<br>&emsp;&emsp;<input type="checkbox" name="triage.hide_toggle"> Hide useless toggle buttons<br>&emsp;&emsp;Style:<br>&emsp;&emsp;&emsp;<textarea style="height:1em" cols="40" name="catalog_triage_str"></textarea><br><!-- &emsp;<input type="checkbox" name="catalog_enable_cross_board"> Enable cross-board catalog<br> --><!-- &emsp;<input type="checkbox" name="catalog_enable_cross_domain"> Enable cross-domain catalog<br> --><!-- &emsp;&emsp; Cache working in <textarea style="height:1em" cols="20" name="catalog_sw_domain"></textarea><br> -->&emsp;&emsp;Sample triage:<br>&emsp;&emsp;&emsp;<button name="triage_simple_kill">simple_kill</button>&emsp;<button name="triage_simple">simple</button>&emsp;<button name="triage_basic">basic</button>&emsp;<button name="triage_basic_color">basic_color</button><br>&emsp;&emsp;&emsp;<button name="triage_colorful">colorful</button>&emsp;<button name="triage_borders">borders</button>&emsp;<button name="triage_samples">samples</button>&emsp;<button name="triage_test">test</button><br>',function(e){return'General 1:<br>&emsp;Shows in title bar:<br>&emsp;&emsp;<input type="checkbox" name="catalog.appearance.titleBar.filter">Checkbox to show filter<br>&emsp;&emsp;<input type="checkbox" name="catalog.appearance.titleBar.settings">Checkbox to show settings<br>&emsp;&emsp;<input type="checkbox" name="catalog.appearance.titleBar.refresh">Refresh button<br>&emsp;&emsp;<input type="checkbox" name="catalog.appearance.titleBar.num_of_pages">Num of pages to refresh<br>&emsp;&emsp;<input type="checkbox" name="catalog.appearance.titleBar.boards_selector">Boards selector<br><br>&emsp;<input type="checkbox" name="catalog.embed_frame"> Embed to frame<br>&emsp;&emsp;Frame size : &emsp;&emsp;<input type="text" name="catalog_size_frame0_width" size="4" style="text-align: right;">%, &emsp;&emsp;<input type="text" name="catalog_size_frame1_width" size="4" style="text-align: right;">%<br>&emsp;&emsp;<input type="checkbox" name="catalog.refresh.except_bt"> Except the page of selecting boards\' tag.<br>&emsp;<input type="checkbox" name="catalog.refresh.at_switch"> Clear and refresh when boards are switched<br>&emsp;<input type="checkbox" name="common.clear_at_manual_scan"> Clear all threads at manual scan<br>1,'+e.rollup_radio("liveTag.rm_404"," :Remove 404 threads",2,"",["imm:Immediately","watched:Keep watched threads","unread:Keep watched threads if they have unread posts","no:No, keep all threads remain"])+'<br>&emsp;<input type="checkbox" name="catalog.bookmark_list_rm404"> Remove 404 threads from bookmark<br>&emsp;<input type="checkbox" name="pref2.8chan.utilize_boards_json"> Utilize boards.json in 8chan<br>1,<ICBX"pref2.meguca.utilize_boards_json"> Utilize boardTimestamps in meguca<br>2,<ICBX"pref2.meguca.utilize_boards_json_domain"> Utilize boardTimestamps at refresh in meguca<br>'},'Board Group:<br>&emsp;configuration:<br>&emsp;&emsp;<textarea rows="1" cols="60" name="catalog_board_list_str"></textarea><br>&emsp;&emsp;<input type="checkbox" name="catalog.board.recommendation"> Read owner\'s recommendation &emsp;&emsp;<button name="tag.recommendation_add">Add to list</button><br>2,<IC"catalog.board.all_boards">Add all boards group to the last<br>&emsp;&emsp;<input type="checkbox" name="catalog.board.board_tags"> Generate board groups from tags &emsp;&emsp;<button name="tag.scan">Scan</button><br>&emsp;&emsp;<input type="checkbox" name="catalog.board.board_tags_same"> Pick up boards which have the same tag&emsp;&emsp;<button name="tag.same_tag_refresh">Refresh</button><br>&emsp;<input type="checkbox" name="catalog.board.ex_list"> Use exclusive list<br>&emsp;&emsp;<textarea rows="1" cols="40" name="catalog.board.ex_list_str"></textarea><br>&emsp;<input type="checkbox" name="catalog.style_general_list"> Use general style<br>&emsp;&emsp;<textarea rows="1" cols="40" name="catalog.style_general_list_str"></textarea><br>&emsp;<input type="checkbox" name="catalog.mimic_base_site"> Mimic base site<br>&emsp;Scan:<br>&emsp;&emsp;Max scan boards <input type="text" name="scan.max" size="6" style="text-align: right;"><br>&emsp;&emsp;Max found threads <input type="text" name="scan.max_threads" size="6" style="text-align: right;"><br>&emsp;&emsp;Num of crawler: <input type="text" name="scan.crawler" size="2" style="text-align: right;"><br>&emsp;&emsp;&emsp;<input type="checkbox" name="scan.crawler_adaptive"> Spawn adaptively at idle<input type="text" name="scan.crawler_idle_time_to_spawn" size="2" style="text-align: right;">ms<br>','Live Tag:<br>1,From:<br>2,<IR"liveTag.from,op">OP<br>2,<IR"liveTag.from,post">All posts<br>1,<ICBX"liveTag.use"> Live<br>1,max: <ITB2"liveTag.max">, max string length: <ITB2"liveTag.maxstr"><br>1,<ICBX"liveTag.ci"> Case insensitive<br>1,<ICBX"liveTag.inherit_board_name"> Inherits board\'s name as a tag<br>2,<ICBX"liveTag.lock_board_name"> Lock & sticky<br>1,<ICBX"liveTag.inherit_board_tags"> Inherits board\'s tags<br>2,<ICBX"liveTag.lock_board_tags"> Lock & sticky<br>1,<ICBX"liveTag.lock_tags_in_op"> Lock & sticky tags in OP<br>1,<ICBX"liveTag.ex_list"> Use exclusive list<br>2,String list to remove before extraction (costs much)<br>3,<textarea rows="1" cols="40" name="liveTag.rm_list_str"></textarea><br>2,Tag list to remove after extraction (costs less)<br>3,<textarea rows="1" cols="40" name="liveTag.ex_list_str"></textarea><br>1,Click function: tags in <br>2,boardlist / threads<br>2,<IR"liveTag.click_func_bl,pkin"><IR"liveTag.click_func,pkin">None -> Fetch/In -> None<br>2,<IR"liveTag.click_func_bl,in"><IR"liveTag.click_func,in">None -> In -> None<br>2,<IR"liveTag.click_func_bl,inex"><IR"liveTag.click_func,inex">None <-> In <-> Out <-> None (ctrl for backward)<br>2,<IR"liveTag.click_func_bl,ex"><IR"liveTag.click_func,ex">None -> Out -> None<br>1,Update intervals:<br>2,Foreground: <ITB4"liveTag.disp_delay.fg">ms<br>2,Background: <ITB4"liveTag.disp_delay.bg">ms<br>2,Lazy draw of incremental search:<br>3,every <ITB4"liveTag.lazy_each"> tags with <ITB4"liveTag.lazy_delay"> ms delay<br>',function(e){return'Statistics:<br>1,<ICBX"stats.use"> Take statistics<br>3,<ICBX"stats.estimate_posts"> Estimate num of posts from posts\' No.<br>4,<ICBX"stats.patch_tm"> Patch for thread move<br>2,Default settings:<br>3,Time unit: '+chart_obj.time_unit_sel_html+"<br>3,"+chart_obj.chart_options_str.join("&emsp;&emsp;&emsp;")+'3,Size of window: <ITB4"chart.window_width"> x <ITB4"chart.window_height"><br><br>2,Accumulation:<br>3,<ICBX"stats.load"> Load data<br>4,<ICBX"stats.save"> Save data: <ITB4"stats.len_capture"> points<br>4,Auto acquisition of data:<br>5,<ICBX"stats.auto_acquisition_all"> All board groups which you saw once<br>5,<ICBX"stats.auto_acquisition"> Board groups with \'!stats\'<br>6,<ICBX"stats.auto_acquisition_scan"> Scan all targets at startup with <ITB2"stats.auto_acquisition_scan_delay"> secs delay<br>5,(Targets are colored <span style="background:#b5fbda">green</span> in board selector)<br><br>2,<ICBX"chart.instant_scan"> Instant scan at switching board group<br>2,Delay to draw: <ITB2"stats.draw_delay"> sec.<br>2,<ICBX"chart.off_anime_blur"> Off animation in background<br>2,<ICBX"stats.tolerant"> Tolerant of inaccuracy of server and local clocks<br>5,up to <input type="text" name="stats.tolerance" size="2" style="text-align: right;"> min<br>'},'Design of Floating Catalog:<br><input type="radio" name="catalog.text_mode.mode" value="graphic"> Graphical mode: <input type="text" name="catalog_size_width" size="4" style="text-align: right;"> x <input type="text" name="catalog_size_height" size="4" style="text-align: right;"><br>&emsp;&emsp;<input type="checkbox" name="catalog.format.thumb.resize">Resize thumbnails in embed catalog<br>&emsp;&emsp;<input type="checkbox" name="page.format.thumb.resize">Resize thumbnails in embed page<br>&emsp;&emsp;<input type="checkbox" name="float.format.thumb.resize">Resize thumbnails in float catalog<br>&emsp;&emsp;&emsp;1st thumbnail: <input type="text" name="catalog_size_tn1_width" size="4" style="text-align: right;"> x <input type="text" name="catalog_size_tn1_height" size="4" style="text-align: right;"><br>&emsp;&emsp;&emsp;2nd and later: <input type="text" name="catalog_size_tn2_width" size="4" style="text-align: right;"> x <input type="text" name="catalog_size_tn2_height" size="4" style="text-align: right;"><br>&emsp;Catalog/Pop-up/Search<br><!-- &emsp;&emsp;<input type="checkbox" name="float.format.show.images_2nd"><input type="checkbox" name="float.format.hover.images_2nd"><input type="checkbox" name="float.format.search.images_2nd"> 2nd or more images in OP<br> -->&emsp;&emsp;<input type="checkbox" name="float.format.show.posts"><input type="checkbox" name="float.format.hover.posts"><input type="checkbox" name="float.format.search.posts"> Posts<br>&emsp;&emsp;<input type="checkbox" name="float.format.show.fileinfo"><input type="checkbox" name="float.format.hover.fileinfo"><input type="checkbox" name="float.format.search.fileinfo"> File information<br><!--&emsp;&emsp;<input type="checkbox" name="catalog_checkbox_deletion_show"><input type="checkbox" name="catalog_checkbox_deletion_hover"><input type="checkbox" name="catalog_checkbox_deletion_search"> Checkbox for deletion<br> -->&emsp;&emsp;<input type="checkbox" name="float.format.show.contents"><input type="checkbox" name="float.format.hover.contents"><input type="checkbox" name="float.format.search.contents"> Format contents<br>&emsp;&emsp;<input type="checkbox" name="float.format.show.layout"><input type="checkbox" name="float.format.hover.layout"><input type="checkbox" name="float.format.search.layout"> Format layout<br>&emsp;&emsp;<input type="checkbox" name="float.format.show.style"><input type="checkbox" name="float.format.hover.style"><input type="checkbox" name="float.format.search.style"> Format style<br><!-- &emsp;&emsp;<input type="checkbox" name="catalog_border_show">&emsp;&emsp;&emsp; Show border<br> --><!-- &emsp;&emsp;<input type="checkbox" name="catalog_enable_background">&emsp;&emsp;&emsp; Use backgfound color<br> -->&emsp;Num of posts in thread headline: <input type="text" name="float.t2h_num_of_posts" size="3" style="text-align: right;"><br><input type="radio" name="catalog.text_mode.mode" value="text"> Text mode: <input type="text" name="catalog_size_text_width" size="4" style="text-align: right;"> x <input type="text" name="catalog_size_text_height" size="4" style="text-align: right;"><br>&emsp;<input type="checkbox" name="catalog.text_mode.sub"> Show title<br>&emsp;<input type="checkbox" name="catalog.text_mode.name"> Show op\'s name<br>&emsp;<input type="checkbox" name="catalog.text_mode.com"> Show op\'s comment<br>',function(e){return"Footer:<br>"+e.footer("catalog")},function(e){return"Footer for watcher:(under construction)<br>"+e.footer("float")
},'Watcher:<br>&emsp;<input type="checkbox" name="liveTag.watch_all"> Watch all boards<br>&emsp;<input type="checkbox" name="catalog.auto_watch"> Auto add to watch list<br>&emsp;<input type="checkbox" name="catalog.unmark_on_hover"> Unmark post on hover<br>&emsp;<input type="checkbox" name="thread_reader.use"> Thread reader<br>&emsp;&emsp;<input type="checkbox" name="thread_reader.own_posts_tracker"> Own posts tracker<br>&emsp;&emsp;&emsp;&emsp;>> (You)<br>&emsp;&emsp;&emsp;&emsp;<input type="radio" name="thread_reader.show_reply_to_me_by" value="anchor"> anchor text<br>&emsp;&emsp;&emsp;&emsp;<input type="radio" name="thread_reader.show_reply_to_me_by" value="plain"> plain text (for dollchan)<br>&emsp;&emsp;&emsp;&emsp;(You) in name field<br>&emsp;&emsp;&emsp;&emsp;<input type="radio" name="thread_reader.show_own_post_by" value="anchor"> name string<br>&emsp;&emsp;&emsp;&emsp;<input type="radio" name="thread_reader.show_own_post_by" value="plain"> plain text<br>&emsp;&emsp;&emsp;<input type="checkbox" name="thread_reader.clean_up_own_posts"> Clean up localStorage at loading embed native catalog<br>&emsp;&emsp;<input type="checkbox" name="thread_reader.sync"> Sync with parent catalog<br>&emsp;&emsp;&emsp;<input type="checkbox" name="thread_reader.triage"> Show triage to parent catalog<br>&emsp;&emsp;&emsp;<input type="checkbox" name="thread_reader.triage_close"> Close window when triage is clicked<br>2,ID enhancer:<br>4,<IC"IDinfo.auto">Auto off when OP doesn\'t have ID or flag<br>3,<IC"IDinfo.ID">Show count of posts by each ID<br>4,<IC"IDinfo.nofIDs">Show count of IDs at the time of post<br>4,<IC"IDinfo.IDop">Show \'OP\' for ID of OP<br>3,<IC"IDinfo.flag">Show count of posts by each flag<br>4,<IC"IDinfo.nofFlags">Show count of flags at the time of post<br>4,<IC"IDinfo.IDFlag">Show count of IDs by each Flag<br>3,<IC"IDinfo.name">Show count of posts by each name<br>4,<IC"IDinfo.nofNames">Show count of names at the time of post<br>4,<IC"IDinfo.nameTrip">Show count of trips by each name<br>3,<IC"IDinfo.trip">Show count of posts by each trip<br>4,<IC"IDinfo.nofTrips">Show count of trips at the time of post<br>',function(e){function t(e,t,n){return t.rollup('4,<IC"notify.'+e+'.supp_init">Suppressed at initial')+"<br>"+n+'2,<IC"notify.'+e+'.reply_to_me">New replies to me<br>2,<IC"notify.'+e+'.reply">New replies<br>2,<IC"notify.'+e+'.new_thread">New threads<br>2,<IC"notify.'+e+'.appear">Appear threads<br>'}return'Notifiers:<br>1,<ICBX"notify.desktop.notify"> Desktop Notification'+t("desktop",e,'3,<ITB3"notify.desktop.lifetime"> secs (0 means permanent)<br>3,max: <ITB3"notify.desktop.limit">, delay: <ITB3"notify.desktop.delay">ms<br>3,<ICBX"notify.desktop.show_last"> Show the last post only<br>')+'1,<ICBX"notify.favicon"> Favicon<br>1,<ICBX"notify.title.notify"> Show number of unread replies in title<br>2,<ICBX"notify.title.hide_zero"> Hide unread count in title bar when it is zero<br>1,<IC"notify.sound.notify">Sound&emsp;&emsp;<BTN"notify.sound.pause,Pause">'+t("sound",e,'3,<IR"notify.sound.src,beep">Beep &emsp;freq:<ITB4"notify.sound.beep_freq"> length:<ITB4"notify.sound.beep_length_f"> volume:<ITB4"notify.sound.beep_volume_f"><br>3,<IR"notify.sound.src,file">File &emsp;<input type="file" accept="audio/*" name="notify.sound.file"><br>')},function(e){return archiver.event_funcs.queryQuota(),"JSON Archiver: Store<br><br>1,1. Make sure DOWNLOAD DIRECTORY to be set correctly."+e.rollup('3,All files will be into the directory.<br>3,And also, make sure each download doesn\'t ask you anything.<br>3,So many files will be downloaded.<br>2,<ICBX"archive.editing_timeout"> Timeout for editing posts (patch for meguca)')+'<br>1,2. Select sources for each target:<br>2,File: Manual/Auto<br>3,<ICBX"archive.oneshot.post"><ICBX"archive.live.post"> Posts<br>3,<ICBX"archive.oneshot.tn"><ICBX"archive.live.tn"> Thumbnails<br>3,<ICBX"archive.oneshot.img"><ICBX"archive.live.img"> Images (original size)<br>3,<ICBX"archive.oneshot.webm"><ICBX"archive.live.webm"> Webms<br>2,IndexedDB: Manual/Auto'+e.rollup('4,<ICBX"archive.IDB.auto_clean"> Automatic clean up<br>4,<ICBX"archive.IDB.auto_clean_init"> Automatic clean up at start up<br>4,Delayed pruning: <ITB3"archive.IDB.prune"> hours<br>5,<ICBX"archive.IDB.prune_flush"> Archive to file at pruning<br>4,num of transactions: <ITB3"archive.IDB.nof_tr"><br>4,num of requests in a cluster: <ITB3"archive.IDB.nof_cl"> - <ITB3"archive.IDB.nof_cl_max"><br>4,watchdog timer: <ITB3"archive.IDB.watchdog">s')+'<br>4,used / limit: <span name="SHOW_QUOTA"></span><button name="archive.queryQuota"><img src="'+cnst.icons.refresh+'" style="width:1em;height:1em"></button><br>3,<ICBX"archive.oneshot.post_idb"><ICBX"archive.live.post_idb"> Posts<br>3,<ICBX"archive.oneshot.tn_idb"><ICBX"archive.live.tn_idb"> Thumbnails<br>3,<ICBX"archive.oneshot.img_idb"><ICBX"archive.live.img_idb"> Images (original size)<br>3,<ICBX"archive.oneshot.webm_idb"><ICBX"archive.live.webm_idb"> Webms<br>1,3. <ICBX"archive.list_inherit"> Inherit previous archiving list<br>1,4a. <IC"archive.store_watched">Auto archiving for watched threads<br>1,4b. <IC"archive.store_auto">Auto archiving if OP matches:<br>2,Keyword: <input type="text" name="archive.kwd.str" size="25">'+pref_func.settings.html_funcs.make_sel("archive.kwd.match",["match all","match any","unmatch all","unmatch any"])+'<br>3,<ICBX"archive.kwd.sub">Subject <ICBX"archive.kwd.name">Name <ICBX"archive.kwd.com">Comment <br>3,<ICBX"archive.kwd.ci">CI <ICBX"archive.kwd.sentence">Sentence <ICBX"archive.kwd.re">RE<br>1,4c. <ICBX"archive.list"> List picker<br>2,<textarea rows="1" cols="40" name="archive.list_str" placeholder="lain  // whole lainchan\n/tech/  // whole /tech/\n/q/1234  // thread /q/1234"></textarea><br>1,4d. <BTN"archive.oneshot,OneShotArchive"> or <BTN"archive.start,StartArchiving"><br>3,<IR"archive.src,shown"> All shown threads<br>3,<IR"archive.src,watched"> All watched threads<br>3,<IR"archive.src,stored"> All stored threads<br>1,4e. You can select target threads individually using triage<br>'},function(e){return 2===pref.archive.files_sel&&archiver.event_funcs.queryList(),'JSON Archiver: Restore<br><br>1,1. Open a live catalog, index page or thread to be overriden.<br>2,CatChan must be working in it.<br>1,2. Select where to extract<br>2,<IR"archive.format,auto">Select from filename: Domain-Board-No_Sub.json<br>2,<IR"archive.format,manual">Set manually: '+e.make_sel("archive.domain",site0.domains)+'/<ITB5"archive.board">/No.<br>1,3a. <ICBX"archive.IDB.auto_restore"> Automatic restore from IndexedDB<br>3,<ICBX"archive.IDB.auto_restore_remove"> Remove deleted thread from display<br>1,3b. Select source from: '+e.make_sel("archive.files_sel",["Dir","Files","IndexedDB"])+'<br><span name="FILES_ARCHIVE0"'+(0===pref.archive.files_sel?"":' style="display:none"')+'>&emsp;&emsp;<span><IF"archive.dir" multiple webkitdirectory directory><BTN"archive.files_clear,X"></span><br></span><span name="FILES_ARCHIVE1"'+(1===pref.archive.files_sel?"":' style="display:none"')+'>&emsp;&emsp;JSONs/HTMLs: <IF"archive.jsons" multiple accept=".html,.json,text/*"><br>2,<ICBX"archive.load_img"> Images: <IF"archive.imgs" multiple webkitdirectory directory><br></span><span name="FILES_ARCHIVE2"'+(2===pref.archive.files_sel?"":' style="display:none"')+'>&emsp;&emsp;<span><select name="archive.IDB_board_sel"'+(pref.archive.IDB_select_multiple?" multiple":"")+' style="float:none"></select><select name="archive.IDB_thread_sel" style="float:none'+(pref4.archive.IDB_thread_sel_options?'"':';display:none"')+(pref.archive.IDB_select_multiple?" multiple":"")+"></select></span>"+e.rollup('&emsp;&emsp;<ICBX"archive.IDB_select_multiple"> Multiple select<br>&emsp;&emsp;Export selected &emsp;&emsp;&emsp;&emsp;<BTN"archive.IDB.export_thread,Threads"><br>&emsp;&emsp;Reset archived time of selected <BTN"archive.IDB.reset_time,Threads">')+e.rollup('&emsp;&emsp;Delete selected <BTN"archive.IDB.delete_board,Boards"><BTN"archive.IDB.delete_thread,Threads"><BTN"archive.IDB.delete_imgs,Images">')+'<br></span>&emsp;&emsp;<BTN"archive.restore_button,Restore"> <ICBX"archive.restore_auto"> Auto restore after selection<br>3,<ICBX"archive.clear_threads"> Clear all threads at opening an archive<br>3,<ICBX"archive.fix_inconsistency"> Fix inconsistencies at open<br>'},'UIP tracker for 4chan:<br>1,<ICBX"uip_tracker.on"> Show num of unique IPs after post No.<br>3, Check interval: <ITB3"uip_tracker.interval">sec, <ICBX"uip_tracker.adaptive"> Adaptive<br>3, Style of changes: <ITBL30"uip_tracker.highlight_str"><br>2,<ICBX"uip_tracker.posts"> Show num of posts<br>2,<ICBX"uip_tracker.deletion.show"> Show deleted posts\' No.<br>3,<ICBX"uip_tracker.deletion.link"> as links<br>2, Apply style to deleted post:<br>3,<ICBX"uip_tracker.deletion.name"> Add style to name: <ITBL30"uip_tracker.deletion.name_str"><br>3,<ICBX"uip_tracker.deletion.addName"> Add <ITBL30"uip_tracker.deletion.addName_str"> to name<br>3,<ICBX"uip_tracker.deletion.post"> Add style to post: <ITBL30"uip_tracker.deletion.post_str"><br>2,<ICBX"uip_tracker.annotate"> Annotate history of UIP from catalog<br>2,<ICBX"uip_tracker.auto_open"> Open next thread automatically<br>3,Conditions:<br>4,After <input type="text" name="uip_tracker.auto_open_th" size="3" style="text-align: right;">th post<br>4,OP contains <textarea style="height:1em" cols="20" name="uip_tracker.auto_open_kwd"></textarea><br>2,<ICBX"uip_tracker.sage.detect"> Sage detection, tolerance: <ITB2"uip_tracker.sage.tolerance"> sec<br>3,<ICBX"uip_tracker.sage.name"> Add style to name: <ITBL30"uip_tracker.sage.name_str"><br>3,<ICBX"uip_tracker.sage.addName"> Add <ITBL30"uip_tracker.sage.addName_str"> to name<br>3,<ICBX"uip_tracker.sage.post"> Add style to post: <ITBL30"uip_tracker.sage.post_str"><br>3,Bug patch for corrupted data<br>4,<ICBX"uip_tracker.sage.patch_bug3"> Ignore corrupted data at head by history<br>4,<IC"uip_tracker.sage.patch_bug4">Recover by page history<br>4,<IC"uip_tracker.sage.patch_bug5">Cease detection at encountering obsolete data<br>4,<ICBX"uip_tracker.sage.patch_bug2"> Loose detection, to <ITB2"uip_tracker.sage.patch_bug2nth">th thread<br>4,<ICBX"uip_tracker.sage.patch_bug"> Re-evaluate and recover<br>3,<IC"uip_tracker.sage.page">Annotate page history<br>3,<IC"uip_tracker.sage.annotate">Annotate sage from catalog<br>4,<IC"uip_tracker.sage.annotate_page">Annotate page history from catalog<br>','Command interface for overwriting preference<br>&emsp;<textarea style="height:1em" cols="40" name="overwrite_site2_json_str"></textarea><br>&emsp;<button name="JSON_ex">extract</button><button name="JSON_ex_full">extract_full</button><button name="JSON_ex_filter">extract_current_filter</button>&emsp;<button name="JSON_query">query</button>&emsp;<button name="JSON_query_boards">query_boards</button>&emsp;&emsp;<button name="JSON">JSON</button><span name="JSON_result"></span><br>&emsp;<textarea style="height:1em" cols="40" name="overwrite_site2_eval_str"></textarea><br>&emsp;<button name="EVAL">EVAL</button><br>',function(e){return'Networking:<br>1,Timeout: <ITB3"network.timeout"> sec.<br>&emsp;Cross domain connection:<br>'+e.radios("network.cross_domain",2,["direct: Direct connection",'indirect: Indirect connection<br>3,<ICBX"network.overXFO"> Over X-Frame-Options<br>3,<ICBX"network.overCSPF"> Over Content Security Policy frame',"GM: GreaseMonkey's extension"])+'<br>&emsp;Data source:<br>&emsp;&emsp;<input type="radio" name="catalog.design" value="page">Page<br>&emsp;&emsp;<input type="radio" name="catalog.design" value="auto">Auto<br>&emsp;&emsp;<input type="radio" name="catalog.design" value="catalog">Catalog<br>&emsp;&emsp;&emsp;<input type="checkbox" name="catalog.catalog_json"> From json file<br>1,Lazy load/draw<br>2,Catalog/IndexPage/Float <br>3,<IC"catalog.lazyDraw.merge" style="visibility:hidden"><IC"page.lazyDraw.merge"><IC"float.lazyDraw.merge" style="visibility:hidden">Lazy draw posts, step:<ITB3"proto.lazyDraw.merge_step">(at merge)<br>3,<IC"catalog.draw_on_demand"><IC"page.draw_on_demand"><IC"float.draw_on_demand">Lazy draw threads, step:<ITB3"proto.lazyDraw.step"><br>3,<IC"catalog.load_on_demand"><IC"page.load_on_demand"><IC"float.load_on_demand">Lazy load HTMLs/JSONs<br>2,<input type="checkbox" name="network.adaptive"> Adaptive<br>3,100%: new <input type="text" name="network.th100" size="3" style="text-align: right;"> threads, <input type="text" name="network.th100_delay" size="4" style="text-align: right;"> ms delay<br>3,20%: new <input type="text" name="network.th20" size="3" style="text-align: right;"> threads, <input type="text" name="network.th20_delay" size="4" style="text-align: right;"> ms delay<br>1,<ICBX"catalog_auto_update_countdown"> Show countdown to auto update<br>1,<ICBX"healthIndicator.show"> Health indicator, history: <ITB3"healthIndicator.max"><br>2,<ICBX"healthIndicator.expand_running"> Show details of running indicators<br>2,<ICBX"healthIndicator.dont_retire_running"> Don\'t retire running indicators<br>2,<ICBX"healthIndicator.cancel"> Cancel scan when it is clicked<br>1,<ICBX"network.fetch_actively"> Fetch missing info actively<br>'},'General 2:<br>&emsp;Localtime offset<input type="text" name="localtime_offset" size="2" style="text-align: right;"><br>Share loaded html with other tabs to update<br>&emsp;<input type="checkbox" name="info_server"> Broadcast loaded html to other tabs (server)<br>&emsp;<input type="checkbox" name="info_client"> Listen other tab\'s broadcasting (client)<br>Cloudflare<br>&emsp;<input type="checkbox" name="cloudflare.auto_reload"> Auto reload at server error<br>&emsp;&emsp;<input type="text" name="cloudflare.auto_reload_time" size="2" style="text-align: right;"> minutes after<br><br><input type="checkbox" name="tooltips.info.show"> Show infotips<br>&emsp;pop up delay: <input type="text" name="tooltips.info.popup_delay" size="4" style="text-align: right;"> ms<br>&emsp;pop down delay: <input type="text" name="tooltips.info.popdown_delay" size="4" style="text-align: right;"> ms<br><input type="checkbox" name="tooltips.help.show"> Show tooltips<br>&emsp;pop up delay: <input type="text" name="tooltips.help.popup_delay" size="4" style="text-align: right;"> ms<br>&emsp;pop down delay: <input type="text" name="tooltips.help.popdown_delay" size="4" style="text-align: right;"> ms<br>Z-Index of tooptips: <ITB4"tooltips.zIndex"><br>Misc.<br><input type="checkbox" name="recovery.comment"> Recover comment when browser was crashed<br><input type="checkbox" name="catalog_footer_ignore_my_own_posts"> Ignore my own posts at counting unread posts<br><input type="checkbox" name="pref2.KC.summer_time"> Summer time in KC<br><br>Patches<br><input type="checkbox" name="patch.delayed_invoke.use"> Delayed invoke for 4chan, <input type="text" name="patch.delayed_invoke.sec" size="2" style="text-align: right;">sec.<br>',function(e){return'Styles:<br>1,Windows and popups:<br>2,Z-Index: <ITB4"style.zIndex"><br>2,<IR"style.sel,fix"> Fixed <BTN"style.reset.fix,reset"><br>3,Title bar:<ITBL30"style.fix.titleBar_str"><br>3,Window:<ITBL30"style.fix.window_str"><br>3,Pop up:<ITBL30"style.fix.popUp_str"><br>2,<IR"style.sel,copy"> Copy from CSS <BTN"style.reset.copy,reset"><br>3,Title bar:<ITBL30"style.copy.titleBar_str"><br>3,Window:<ITBL30"style.copy.window_str"><br>3,Pop up:<ITBL30"style.copy.popUp_str"><br>1,Others:<br>2,New post:<ITBL30"style.post_new"><br>2,Editing post:<ITBL30"style.post_editing"><br>'+e.userCSS(1)},function(e){return'Features:<br>1,<ICBX"features.page"> Page<br>1,<ICBX"features.graph"> Graph<br>1,<ICBX"features.setting2"> Setting2<br>1,<ICBX"features.postform"> Postform<br>1,<ICBX"features.catalog"> Catalog<br>1,<ICBX"features.listener"> Listener<br>1,<ICBX"features.uip_tracker"> UIP_tracker<br>1,<ICBX"features.thread_reader"> Thread Reader<br>1,<ICBX"features.recovery"> Recovery comment<br>Notifications:<br>1,<ICBX"features.notify.desktop"> DesktopNotification<br>1,<ICBX"features.notify.sound"> Sound<br>1,<ICBX"features.notify.favicon"> Favicon<br>Sites:<br>'+e.features_domains()},function(e){return'CatChan<br>Version 2019.06.30.0<br><a href="https://github.com/DogMan8/CatChan">GitHub</a><br><a href="https://github.com/DogMan8/CatChan/raw/master/CatChan.user.js">Get stable release</a><br><a href="https://github.com/DogMan8/CatChan/raw/develop/CatChan.user.js">Get BETA release</a><br><br><br>Debug mode<br><input type="checkbox" name="debug_mode.0"><input type="text" name="debug_mode.unread_count" size="30" style="text-align: right;"><input type="checkbox" name="debug_mode.2"><input type="checkbox" name="debug_mode.3"><input type="checkbox" name="debug_mode.4">&emsp;<input type="checkbox" name="debug_mode.5"><input type="checkbox" name="debug_mode.parse_error"><input type="checkbox" name="debug_mode.7"><br><input type="text" name="debug_mode.site2func" size="15" style="text-align: right;" placeholder="catalog_json2html3"><button name="debug_site2">dump_site2</button><input type="checkbox" name="debug_mode.site2func_expand">func<br><input type="text" name="debug_mode.pfunc" size="15" style="text-align: right;" placeholder="4chan:catalog_json"><button name="debug_pfunc">dump_parse_funcs</button><input type="checkbox" name="debug_mode.pfunc_expand">func<br><input type="text" name="debug_mode.pfunc_comp" size="15" style="text-align: right;" placeholder="4chan:catalog_json"><button name="debug_pfunc_comp">compare_parse_funcs</button><input type="checkbox" name="debug_mode.pfunc_comp_expand_same"><input type="checkbox" name="debug_mode.pfunc_comp_expand_diff">func <br>1,<input type="text" name="debug_mode.pfunc_comp_proto" size="40" style="text-align: right;" placeholder="temporal prototype, DEFAULT:catalog_json"><br><input type="text" name="debug_mode.pfunc_all" size="15" style="text-align: right;"  placeholder="op_img_url"><button name="debug_pfunc_all">find_parse_funcs</button><input type="checkbox" name="debug_mode.pfunc_all_expand">func<br><input type="checkbox" name="debug_mode.9"><br>'+e.cb_block("debug_mode",10)+"Test mode"+e.rollup(e.cb_block("test_mode",0)+'<br><IC"test_mode.tips"><ITB6"test_mode.num"><ITBL30"test_mode.test_str"><ITB6"test_mode.num_f">&emsp;<button name="button_test">test</button><br>&emsp;<button name="load_samples">setting_samples</button><br><IF"test_mode.js_file" accept=".js,text/*"><BTN"test_mode.js_load,JS_load">')+"<br>"}],html_common:'<span name="reload_recommended" style="display:none;background:yellow">&emsp;&emsp;RELOAD IS REQUIRED TO GET LIGHT FEELING&emsp;&emsp;<br></span><span name="reload_required" style="display:none;background:red;color:white">&emsp;&emsp;RELOAD IS REQUIRED&emsp;&emsp;</span><br><button name="close">close</button>&emsp;<button name="save">save</button><button name="load_default">load_default</button><button name="load_default_of_this_page">load_default_of_this_page</button>',tag_gen:null,get onchange_funcs_formatted(){return Object.defineProperty(this,"onchange_funcs_formatted",{value:pref_func.add_onchange_format(this.onchange_funcs),writable:!0,enumerable:!0,configurable:!0}),pref_func.add_onchange_format(this.onchange_funcs.archive),this.onchange_funcs_formatted},oninput_funcs:null,onchange_funcs:{__proto__:{__proto__:{SHOWALL:function(e){this.TOGGLE(e.target,"HIDEALL","",null,"no"),Array.prototype.slice.call(e.target.parentNode.parentNode.querySelectorAll("[name=SHOW],[name=SHOW2],[name=SHOW3]")).forEach(function(e){e.onclick({target:e,currentTarget:e})})},HIDEALL:function(e){this.TOGGLE(e.target,"SHOWALL","",null,"no"),Array.prototype.slice.call(e.target.parentNode.parentNode.querySelectorAll("[name=HIDE],[name=HIDE2],[name=HIDE3]")).forEach(function(e){e.onclick({target:e,currentTarget:e})})},SHOW:function(e){this.TOGGLE(e.target,"HIDE","")},HIDE:function(e){this.TOGGLE(e.target,"SHOW","none")},TOGGLE:function(e,t,n,a,r){a||(a=e);var o=e.getAttribute("data-str");e.setAttribute("data-str",a.textContent),a.textContent=o,e.setAttribute("name",t),"no"!==r&&(r||(r=e.nextSibling),r.style.display=n)},SHOW2:function(e){this.TOGGLE2(e.target,"HIDE2","")},HIDE2:function(e){this.TOGGLE2(e.target,"SHOW2","none")},TOGGLE2:function(e,t,n){"A"!==e.tagName&&(e=e.parentNode),this.TOGGLE(e,t,n,e.childNodes[2],e.nextSibling.nextSibling)},SHOW3:function(e){for(var t=e.target.getAttribute("data-show3"),n=e.target.previousSibling;n.getAttribute("data-show3")!==t;)n=n.previousSibling;n.style.display="",e.target.style.display="none"},HIDE3:function(e){for(var t=e.target.parentNode.getAttribute("data-show3"),n=e.target.parentNode.nextSibling;n.getAttribute("data-show3")!==t;)n=n.nextSibling;n.style.display="",e.target.parentNode.style.display="none"},SHOW2_I:function(e){var t=e.target.previousSibling;t.onclick({target:t,currentTarget:t})},SHOW4:function(e){e.target.style.display="none",e.target.previousSibling.style.display=null},HIDE4:function(e){e.target.parentNode.style.display="none",e.target.parentNode.nextSibling.style.display=null},SUB:function(e){var t=e.currentTarget.previousSibling.previousSibling;if(t&&t.querySelectorAll){var n=t.querySelectorAll("span[data-class=show_value]");n.length>0&&pref_func.apply_prep_2(n,!1)}},"virtualBoard.search.str":function(){liveTag.filter_onchange(pref.virtualBoard.search)}}},"uip_tracker.on":uip_tracker_init,"healthIndicator.show":function(){cataLog.healthIndicator.show()},"healthIndicator.expand_running":function(){cataLog.healthIndicator.shrink_running()},"settings.indexing":function(e){var t=pref_func.settings,n=pref_func.settings.pn13.childNodes[1];pref_func.settings.files_store();var a=t.htmls[pref.settings.indexing],r=("function"==typeof a?a(t.html_funcs):a)+t.html_common;n.innerHTML=pref_func.format_html_str(r),pref_func.add_onchange(n,pref_func.settings.onchange_funcs_formatted),pref_func.settings.apply_pn13_1()},pn13_1_warning_reload:function(){pref3.reload_required=!0,pref_func.settings.onchange_funcs.pn13_1_warning()},pn13_1_warning:function(){var e=pref_func.settings.pn13.childNodes[1],t=e.getElementsByTagName("span").reload_required;t.style.display=pref3.reload_required||pref3.stats.use!==pref.stats.use||pref.stats.estimate_posts&&!pref3.stats.estimate_posts?"":"none";var t=e.getElementsByTagName("span").reload_recommended;t.style.display=!pref.stats.estimate_posts&&pref3.stats.estimate_posts?"":"none"},"tag.scan":function(){pref.catalog.board.board_tags=!0,pref_func.settings.onchange_funcs["tag.generate_caller"]("tag.scan"),liveTag.popup_filter.popup()},"tag.same_tag_refresh":function(){pref.catalog.board.board_tags_same=!0,pref_func.settings.onchange_funcs["tag.generate_caller"]("tag.same_tag_refresh")},"tag.generate_caller":function(e){site2[site.nickname].get_boards_json("manual_refresh_boards_json",null,null,!0),pref.test_mode[112]&&(http_req.get("tag","8chan","https://"+site2["8chan"].domain_url+"/boards.json",pref_func.settings.onchange_funcs["tag.generate_callback"],!1,!1,e),pref_func.settings.pn13&&pref_func.settings.apply_pn13_1())},"tag.generate_callback":function(e,t,n){site3["8chan"].boards="response"in t?t.response:JSON.parse(t.responseText),pref_func.settings.onchange_funcs["tag.re_generate"](n)},"tag.re_generate":function(e){var t=catalog_obj.scan_tags_common(site3["8chan"].boards,'name="tag.gen"');if(pref_func.settings.tag_gen)pref_func.settings.tag_gen.childNodes[1].childNodes[1].innerHTML=t;else if("tag.same_tag_refresh"!==e){var n='<div><button name="tag.scan">Refresh</button><br><textarea style="height:1em" cols="20" name="tag.gen_str"></textarea><button name="tag.gen_add">Add to list</button></div><div>'+t+"</div>";cnst.make_popup(pref_func.settings,"tag_gen",n,pref_func.settings.onchange_funcs);var a=pref_func.settings.tag_gen.childNodes[1];a.style.height="200px",a.style.width="200px",a.style.overflow="auto",a.style.resize="both",cnst.bottom_top(a)}pref_func.settings.tag_gen&&pref_func.add_onchange(pref_func.settings.tag_gen.childNodes[1].childNodes[1],pref_func.settings.onchange_funcs_formatted);for(var t="",r=site3["8chan"].boards,o=0;o<r.length-1&&site.board!=="/"+r[o].uri+"/";)o++;for(var s=0;s<r[o].tags.length;s++){var i=r[o].tags[s];t=t+"#"+i;for(var l=0;l<r.length;l++)for(var c=0;c<r[l].tags.length;c++)r[l].tags[c]===i&&(t=t+",8chan/"+r[l].uri+"/");t+="\n"}pref_func.catalog_board_list_str_bt_same=t,pref_func.catalog_board_list_str_bt="",pref_func.settings.onchange_funcs.board_sel_refresh()},"tag.gen":function(){for(var e=pref_func.settings.tag_gen.childNodes[1].getElementsByTagName("input"),t="",n=pref_func.settings.tag_gen.childNodes[1].getElementsByTagName("textarea")[0].value,a=site3["8chan"].boards,r=0;r<e.length;r++)if(e[r].checked){var o=e[r].nextSibling.textContent.replace(/ [0-9]*: /,"");""===n&&(n="#"+o);for(var s=0;s<a.length;s++)for(var i=0;i<a[s].tags.length;i++)a[s].tags[i]==o&&(t=t+"8chan/"+a[s].uri+"/,")}pref_func.catalog_board_list_str_bt=n+","+t,pref_func.settings.onchange_funcs.board_sel_refresh()},"tag.gen_add":function(){pref_func.settings.onchange_funcs["tag.gen"](),pref_func.settings.onchange_funcs["tag.add_to_list"](pref_func.catalog_board_list_str_bt)},"tag.recommendation_add":function(){pref_func.settings.onchange_funcs["tag.add_to_list"](pref_func.catalog_board_list_str_or)},"tag.add_to_list":function(e){""!==e&&(pref.catalog_board_list_str.search(/\n$/)==-1&&(pref.catalog_board_list_str=pref.catalog_board_list_str+"\n"),pref.catalog_board_list_str=pref.catalog_board_list_str+e+"\n",pref_func.settings.pn13&&pref_func.settings.apply_pn13_1(),pref_func.settings.onchange_funcs.board_sel_refresh())},board_sel_refresh:function(){pref_func.str2obj("catalog_board_list_str"),cnst.auto_shrink_board_selector.str_changed()},"stats.use":"pn13_1_warning","stats.estimate_posts":"pn13_1_warning","stats.auto_acquisition":function(){cnst.auto_shrink_board_selector.color()},"stats.auto_acquisition_all":"stats.auto_acquisition","catalog.board.recommendation":"board_sel_refresh","catalog.board.board_tags":"board_sel_refresh",catalog_board_list_str:"board_sel_refresh","catalog.board.all_boards":"board_sel_refresh",JSON:function(){pref_func.site2_json()},JSON_query_boards:function(){pref.overwrite_site2_json_str='{"site2":{"'+site.nickname+'":{"boards_json":""}}}',pref_func.site2_json(!0)},JSON_query:function(){pref_func.site2_json(!0)},JSON_ex:function(){pref_func.site2_json_ex(!1),pref_func.settings.apply_pn13_1()},JSON_ex_full:function(){pref_func.site2_json_ex(!0),pref_func.settings.apply_pn13_1()},JSON_ex_filter:function(){pref_func.site2_json_ex(!1,!0),pref_func.settings.apply_pn13_1()},EVAL:function(){pref_func.site2_eval()},close:function(){pref_func.settings.show_hide()},save:function(){localStorage&&(localStorage[pref.script_prefix+".pref"]=JSON.stringify(pref_func.site2_json_ex_remove()))},load_default:function(e){var t=pref_default();if(delete t.settings.indexing,delete t.catalog_board_list_sel,delete t.catalog.filter,"load_default_of_this_page"===e.target.name){for(var n=e.target.parentNode.getElementsByTagName("*"),a=0;a<n.length;a++)if(n[a].name){var r=pref_func.get_tgt(n[a].name,t,!0);if(r){var o=pref_func.get_tgt(n[a].name);o[0][o[1]]=r[0][r[1]]}}}else 0===e.target.name.indexOf("easy2")&&delete t.easy2,pref_func.pref_overwrite(pref,t),pref3.reload_required=!0;pref_func.obj_init(),pref_func.settings.apply_pn13_1(),pref_func.settings.apply_pn13_1(!0,"load_default_of_this_page"===e.target.name&&cataLog.threads)},load_default_of_this_page:"load_default",load_samples:function(){pref_func.pref_samples.init()},catalog_triage_str:function(){catalog_obj&&null!==catalog_obj.catalog_func()&&catalog_obj.catalog_func().remake_triage()},"triage.hide_toggle":"catalog_triage_str","catalog.footer.*w/":function(e,t){cataLog.Footer&&cataLog.Footer.update_all_force(e,t)},"float.footer.*w/":"catalog.footer.*w/","thread_reader.use":thread_reader_init,"catalog.appearance.titleBar.settings":"catalog.appearance.titleBar.filter","catalog.appearance.titleBar.refresh":"catalog.appearance.titleBar.filter","catalog.appearance.titleBar.num_of_pages":"catalog.appearance.titleBar.filter","catalog.appearance.titleBar.boards_selector":"catalog.appearance.titleBar.filter","catalog.appearance.titleBar.filter":function(){catalog_obj&&null!==catalog_obj.catalog_func()&&(catalog_obj.catalog_func().pn12_0_2.getElementsByTagName("*")[this.name.substr(this.name.lastIndexOf(".")+1)].style.display=this.checked?"":"none")},catalog_size_text_height:"catalog_size_width",catalog_size_text_width:"catalog_size_width",catalog_size_height:"catalog_size_width",catalog_size_width:function(){catalog_obj&&null!==catalog_obj.catalog_func()&&catalog_obj.catalog_func().catalog_resized(this)},"catalog.click_area":styleSheet.make_rule_click_area,"style.sel":styleSheet.styles_changed,"style.fix.*":"style.sel","style.copy.*":"style.sel","style.reset.*":function(){var e=pref_default(),t=this.name.split(".")[2];pref_func.pref_overwrite(pref.style[t],e.style[t]),pref_func.settings.apply_pn13_1(),pref_func.settings.onchange_funcs["style.sel"]()},"style.userCSS.*":styleSheet.userCSS_changed,"virtualBoard.p_board":function(){liveTag.update_boardlist(!0)},"virtualBoard.p_remove":"virtualBoard.p_board","virtualBoard.max":"virtualBoard.p_board","virtualBoard.show":"virtualBoard.p_board","easy.virtualBoard_10_passive":"easy.virtualBoard_10","easy.virtualBoard_10":function(){pref_func.settings.onchange_funcs.pn13_1_warning_reload(),pref_func.pref_samples.onclick_event.call(this)},"easy.virtualBoard_1":"easy.virtualBoard_10","easy.virtualBoard_8_50":"easy.virtualBoard_10","easy.virtualBoard_8_100":"easy.virtualBoard_10","easy.virtualBoard_8_500":"easy.virtualBoard_10","easy.virtualBoard_8_all":"easy.virtualBoard_10","easy.virtualBoard_interSite":"easy.virtualBoard_10","easy.posts_0h":"easy.virtualBoard_10","easy.posts_24h":"easy.virtualBoard_10","easy.threads_24h":"easy.virtualBoard_10","easy.embed_index":"easy.virtualBoard_10","easy.embed_index_lazy":"easy.virtualBoard_10","easy.embed_index_infinite":"easy.virtualBoard_10","easy.embed_index_backwash":"easy.virtualBoard_10","easy.light":"easy.virtualBoard_10","easy.stat_activate":"easy.virtualBoard_10","easy2.beginner":function(e){pref.easy2.presets=1,pref_func.settings.onchange_funcs["easy2.presets"](e,pref.easy2.presets),pref_func.settings.onchange_funcs["easy2.apply"](e,!0),pref_func.settings.onchange_funcs.reload(e)},"easy2.presets":function(e,t){pref_func.pref_samples["easy2.presets"](void 0!==t?t:pref.easy2.presets),pref_func.settings.apply_pn13_1()},"easy2.limits":function(e,t){pref_func.pref_samples["easy2.limits"](),pref_func.settings.apply_pn13_1()},"easy2.apply":function(e,t){(pref.easy2.reset||t)&&pref_func.settings.onchange_funcs.load_default(e),pref_func.pref_samples["easy2.presets"](),pref_func.settings.onchange_funcs.pn13_1_warning_reload(),pref_func.pref_samples.onclick_event(null,pref.easy2)},reload:function(){location.reload()},triage_simple_kill:"triage_simple",triage_simple:function(){pref_func.pref_samples.onclick_event.call(this)},triage_basic:"triage_simple",triage_basic_color:"triage_simple",triage_colorful:"triage_simple",triage_borders:"triage_simple",triage_samples:"triage_simple",triage_test:"triage_simple","virtualBoard.scanStart":function(){catalog_obj&&null!==catalog_obj.catalog_func()&&catalog_obj.catalog_func().catalog_liveTag_scan_site()},"virtualBoard.scanStop":function(){scan.abort()},"virtualBoard.scan_domains.*":function(){if(pref.virtualBoard.instant_scan){var e=this.name.replace("virtualBoard.scan_domains.","");scan.keyword_load_1(e)}},"virtualBoard.search.show":function(e,t){if(site.components.boardlist){var n="virtualBoard.search",a=site.components.boardlist.getElementsByTagName("input")[n+".str"];a&&(a=a.parentNode),pref.virtualBoard.search.show?a||(a=document.createElement("span"),a.innerHTML=pref_func.format_html_str('<ITBL10"'+n+'.str"><span style="display:none"><ICBX"'+n+'.re">RE, &lt;<ITB2"virtualBoard.max"><span name="HIDE4">◀</span></span><span name="SHOW4">▶</span>'),a.style="float:right",pref_func.apply_prep(a,!1),
pref_func.add_onchange(a,pref_func.settings.onchange_funcs_formatted,pref_func.settings.oninput_funcs),site.settings.parentNode.insertBefore(a,site.settings),pref_func.mirror_targets.boardlist=a,t||liveTag.update_pn()):a&&(site.settings.parentNode.removeChild(a),pref_func.mirror_targets.boardlist=null,liveTag.update_pn())}},"virtualBoard.search.*":"virtualBoard.search.str",debug_site2:function(){pref.debug_mode.site2func&&common_func.debug_site2func(pref.debug_mode.site2func)},debug_pfunc:function(){pref.debug_mode.pfunc&&common_func.debug_parse_funcs_entry(pref.debug_mode.pfunc)},debug_pfunc_comp:function(){pref.debug_mode.pfunc_comp&&common_func.debug_parse_funcs_entry(pref.debug_mode.pfunc,pref.debug_mode.pfunc_comp)},debug_pfunc_all:function(){pref.debug_mode.pfunc_all&&common_func.debug_parse_funcs_all(pref.debug_mode.pfunc_all)},"liveTag.ex_list_str":function(){liveTag.ex_list_changed()},"liveTag.inherit_board_name":function(){liveTag.inherit_board_name_changed()},"liveTag.inherit_board_tags":function(){liveTag.inherit_board_tags_changed()},"page.mark_new_posts":function(){cataLog.format_html&&cataLog.format_html.time_filter_changed()},"recovery.comment":function(){recovery.setup()},"*.open_spoiler_text":styleSheet.open_spoiler_text,"*.scroll_lock":function(){cataLog.general_event_handler.setup()},button_test:function(){function e(e,t,n,a){console.log(a)}IDB.req_raw("meguca","meguca","mine",null,e,"get_all",!0)},"*.posts_search_op":function(e,t){t||(t=cataLog.embed_mode),styleSheet.register(".CatChan_search_miss","opaque"===pref[t].posts_search_op?"opacity:"+pref[t].posts_search_op_opacity/100+" !important":"hide"===pref[t].posts_search_op?"display:none !important":null)},"*.posts_search_op_opacity":"*.posts_search_op","style.post_editing":function(){styleSheet.register("."+pref.script_prefix+"_post_editing",pref.style.post_editing)},archive:{restore2:function(e,t,n){if(cataLog.threads&&(!e||pref.archive.restore_auto||"archive.restore_button"===e.target.name)){n||(t=Array.prototype.slice.call(pref3.archive.dir.files),n=t.filter(function(e,t,n){return e.name.search(/\.(json|html*)$/)!=-1}),n=n.filter(function(e,t,n){return e.name.indexOf("_deleted.json")==-1}));var a=t.filter(function(e,t,n){return e.name.search(/\.(json|html*)$/)==-1});0!==n.length&&archiver.restore_entry(n,a,this.clear_files_button,t.filter(function(e,t,n){return e.name.indexOf("_deleted.json")!=-1}))}},dir:"restore2",files_sel:function(e){e.target.parentNode.querySelectorAll('span[name="FILES_ARCHIVE0"]')[0].style.display=0===pref.archive.files_sel?"":"none",e.target.parentNode.querySelectorAll('span[name="FILES_ARCHIVE1"]')[0].style.display=1===pref.archive.files_sel?"":"none",e.target.parentNode.querySelectorAll('span[name="FILES_ARCHIVE2"]')[0].style.display=2===pref.archive.files_sel?"":"none",2===pref.archive.files_sel&&this.queryList()},restore_button:function(e){0===pref.archive.files_sel&&this.restore2(e),2===pref.archive.files_sel?this.IDB_thread_sel(e):this.restore(e)},restore:function(e){var t=pref3.archive.jsons.files,n=pref3.archive.imgs.files;0===t.length||pref.archive.load_img&&0===n.length||this.restore2(null,Array.prototype.slice.call(n),t)},jsons:"restore",imgs:"restore",clear_files_button:function(){for(var e=[pref3.archive.jsons,pref3.archive.imgs],t=0;t<e.length;t++)if(e[t]&&e[t].parentNode){var n=e[t].parentNode.insertBefore(e[t].cloneNode(e[t]),e[t]);n.onchange=e[t].onchange,e[t].parentNode.removeChild(e[t]),n.onchange({target:e[t],currentTarget:e[t]})}},get pn_IDB_board_sel(){return pref_func.settings.pn13&&pref_func.settings.pn13.querySelector('select[name="archive.IDB_board_sel"]')},get pn_IDB_thread_sel(){return pref_func.settings.pn13&&pref_func.settings.pn13.querySelector('select[name="archive.IDB_thread_sel"]')},IDB_select_multiple:function(){this.pn_IDB_board_sel.multiple=pref.archive.IDB_select_multiple,this.pn_IDB_thread_sel.multiple=pref.archive.IDB_select_multiple},queryQuota:function(){navigator.webkitTemporaryStorage&&navigator.webkitTemporaryStorage.queryUsageAndQuota(this.showQuota.bind(this))},showQuota:function(e,t){var n=pref_func.settings.pn13.querySelector('span[name="SHOW_QUOTA"]');n&&(n.textContent=e.toLocaleString()+" / "+t.toLocaleString()+" ("+(100*e/t).toString().slice(0,5)+"%)")},queryList:function(){pref.test_mode[65]||pref4.archive.IDB_board_sel_options||(brwsr.ff?setTimeout(function(){this.showList({target:{result:Object.keys(liveTag.mems[site.nickname])}})}.bind(this),0):window.indexedDB.webkitGetDatabaseNames().onsuccess=this.showList.bind(this))},showList:function(e){if(e){for(var t=e.target.result,n=["Select board"],a=0;a<t.length;a++)n[n.length]=t[a].replace(/^[^\/]*/,"");n[n.length]="ALL ("+t.length+")"}else n=null;pref4.archive.IDB_board_sel_options=n,pref_func.apply_prep(this.pn_IDB_board_sel,!1)},IDB_board_sel:function(){pref4.archive.IDB_thread_sel_options=null;var e=this.pn_IDB_thread_sel;pref_func.apply_prep(e,!1),e.style.display="";for(var t=this.IDB_selected_boards(),n=0;n<t.length;n++)IDB.req(site.nickname,t[n],null,null,this.showThreadList_fromIDB.bind(this),"list_os")},IDB_selected_boards:function(){return 0===pref.archive.IDB_board_sel?[]:pref4.archive.IDB_board_sel_options&&pref.archive.IDB_board_sel===pref4.archive.IDB_board_sel_options.length-1?pref4.archive.IDB_board_sel_options.slice(1,-1):Array.prototype.slice.call(this.pn_IDB_board_sel.options).filter(function(e){return e.selected}).map(function(e){return e.textContent})},showThreadList_fromIDB:function(e,t,n){1==this.IDB_selected_boards().length&&(t="");for(var a=pref4.archive.IDB_thread_sel_options||["ALL"],r=0;r<n.length;r++)a[a.length]=t+n[r];a[0]=" ",a.sort(),a[0]="ALL ("+(a.length-1)+")",pref4.archive.IDB_thread_sel_options=a,pref_func.apply_prep(this.pn_IDB_thread_sel,!1)},IDB_thread_sel:function(e){cataLog.threads&&(pref.archive.restore_auto||"archive.restore_button"===e.target.name)&&(pref.archive.clear_threads&&cataLog.threads&&cataLog.catalog_clear_threads(0),this["IDB.selected_threads"](IDB.req,null,this.restore3.bind(this),"get_all"))},"IDB.selected_threads":function(e,t,n,a){var r=0===pref.archive.IDB_thread_sel?pref4.archive.IDB_thread_sel_options.slice(1):Array.prototype.slice.call(this.pn_IDB_thread_sel.options).filter(function(e){return e.selected}).map(function(e){return e.textContent}),o=this.IDB_selected_boards(),s=1===o.length?o[0]:"";if(!e){for(var i={domain:site.nickname,boards:o},l=0;l<r.length;l++)r[l]={board:s||r[l].replace(/[^\/]*$/,""),no:r[l].replace(/\/[^\/]*\//,""),__proto__:i};return r}for(var l=0;l<r.length;l++)e(site.nickname,s||r[l].replace(/[^\/]*$/,""),r[l].replace(/\/[^\/]*\//,""),t,n,a)},restore3:function(e,t,n,a){var r=this.consolidate_IDB_result(a,e);if(r.posts.length>0){var o=archiver.restore({name:(site.nickname+t+n).replace(/\//,"-")},site2[e].parse_funcs.thread_json.prep_to_archive(r.posts),r.tn,!0);if(r.posts_deleted.length>0){pref.test_mode[80]&&(t=t.slice(0,-1)+"_IDB/");var s=liveTag.mems.init({domain:e,board:t,no:n});archiver.prep_deleted_posts(o,s,!0,r.posts_deleted)}}},consolidate_IDB_result:function(e,t){for(var n=[],a=[],r={},o=Object.create(r),s=Object.keys(e),i=0;i<s.length;i++)if(0===s[i].indexOf("posts_deleted"))a=a.concat(e[s[i]]);else if(0===s[i].indexOf("posts"))n=n.concat(e[s[i]]);else{if("pruned_time"===s[i])continue;var l=s[i].replace(/[^\.]*./,""),c="webm"===l?"video/webm":"image",p={type:c,file:e[s[i]]};0===s[i].indexOf("tn_")?o[s[i].substr(3)]=p:r[s[i].substr(4)]=p}for(var i=0;i<n.length-1&&n[i].no<n[i+1].no;)i++;if(i!==n.length-1)for(n.sort(this.consolidate_IDB_sort_func),i=0;i<n.length-1;){if(n[i].no===n[i+1].no){for(var _=i+2;_<n.length&&n[i].no===n[_].no;)_++;if("meguca"===t){for(var d=n[i].editing,u=i+1;u<_&&n[u].editing==d;)u++;if(u<_)for(u=_;--u>i;)n[u].editing&&(n.splice(u,1),_--)}for(;--_>i;)n.splice(_,1)}i++}_=0;for(var i=0;i<a.length;i++){for(;_<n.length&&n[_].no<a[i].no;)_++;_<n.length&&n[_].no===a[i].no&&n.splice(_,1)}var f=t&&site2[t].parse_funcs.thread_json.consolidate_IDB_result_sub;return f&&0!==n.length&&f(n),{posts:n,posts_deleted:a,img:r,tn:o}},consolidate_IDB_sort_func:function(e,t){return e.no!==t.no?e.no-t.no:e.com<t.com?-1:1},"IDB.delete_board":function(){for(var e=this.IDB_selected_boards(),t=0;t<e.length;t++)window.indexedDB.deleteDatabase(pref.script_prefix+"."+e[t]);var n=this.pn_IDB_thread_sel;n&&(n.style.display="none"),this.showList(null),this.queryList()},"IDB.delete_thread":function(){this["IDB.selected_threads"](IDB.req,null,null,"delete_th"),this.IDB_board_sel(null)},"IDB.delete_imgs":function(){this["IDB.selected_threads"](IDB.req,IDBKeyRange.bound("img_","img`",!1,!0),null,"delete")},"IDB.export_thread":function(){for(var e=this["IDB.selected_threads"](),t="CatChan_IDB_"+e[0].domain+"-"+(1==e[0].boards.length?e[0].board.slice(1,-1):e[0].boards.length)+"-"+(1===e.length?e[0].no:e.length)+".tar",n="IDB_extract_"+Date.now(),a=function(a){var r=e.length;return function(e,o,s,i){a.export_thread(e,o,s,i,n),0==--r&&archiver.tar.flush(n,t)}}(this),r=0;r<e.length;r++)IDB.req(e[r].domain,e[r].board,e[r].no,null,a,"get_all")},export_thread:function(e,t,n,a,r,o){for(var s=this.consolidate_IDB_result(a,e),i=Object.keys(s),l=0;l<i.length;l++)for(var c=Array.isArray(s[i[l]])?["dummy"]:Object.keys(s[i[l]]),p=0;p<c.length;p++){var _=0===i[l].indexOf("posts");if(!_||0!==s[i[l]].length){var d=_?new Blob([JSON.stringify(site2[e].parse_funcs.thread_json.prep_to_archive(s[i[l]]))],{type:"text/plain"}):s[i[l]][c[p]].file,u=_?e+"-"+t.slice(1,-1)+"-"+n+i[l].substr(5)+".json":i[l]+"_"+c[p];archiver.tar.add_blob(d,{domain:e,board:t,no:n},u,r,!0)}}o&&archiver.tar.flush(r,o)},"IDB.reset_time":function(){this["IDB.selected_threads"](archiver.clean_list)},start:function(e){archiver.store_entry("archive.start"===e.target.name?"ARC":"ARC1")},oneshot:"start","kwd.*":function(){pref.archive.kwd.rexps=common_func.kwd_prep_regexp(pref.archive.kwd)}},"test_mode.js_load":function(){var e=pref_func.settings.pn13.getElementsByTagName("input")["test_mode.js_file"].files[0],t=window.URL.createObjectURL(e),n=document.createElement("script");n.src=t,site.script_body.appendChild(n)},"*.merge":function(e){site2.DEFAULT.update_posts_merge_bases.onchange_merge(e)},"*.merge_list":"*.merge","*.merge_list_str":"*.merge","*.merge_lv":function(e){site2.DEFAULT.update_posts_merge_bases.onchange_lv(e)},"*.merge_lv_str":"*.merge_lv",scanBoard:function(e){cataLog.event_func&&cataLog.event_func(e)},scanBoardIf:"scanBoard",scanSite:"scanBoard",scanSiteIf:"scanBoard",tighten_loosed_limits:function(e){pref4.search_posts_active_once=!1},"*w/.t2h_sel":function(e,t){cataLog.Footer&&pref.catalog.footer.use&&pref.catalog.footer.flag&&cataLog.Footer.update_all_force(e,t,!0)},"*w/.t2h_num_of_posts":"catalog.t2h_sel"}},bind_myself:function(e,t){for(var n of t)e[n]=e[n].bind(e)},format_html_str:function(e){return e=e.replace(/<br>([1-9]),/g,function(e,t){for(var n="<br>",a=0;a<t;a++)n+="&emsp;";return n}),e=e.replace(/<TA"([\w.]+),(\d+),(\d+)"([^>]*)>/g,'<textarea style="height:1em" rows="$3" cols="$2" name="$1"$4></textarea>'),e=e.replace(/<IC"([\w.]+)"([^>]*)>(\w)?/g,function(e,t,n,a){return'<input type="checkbox" name="'+t+'"'+n+">"+(a?" "+a:"")}),e=e.replace(/<ITB(L)?(\d+)"([\w.]+)"([^>]*)>(\w)?/g,function(e,t,n,a,r,o){return'<input type="text"'+(t?"":' style="text-align: right;"')+' size="'+n+'" name="'+a+'"'+r+">"+(o?" "+o:"")}),e=e.replace(/<ICBX"/g,'<input type="checkbox" name="'),e=e.replace(/<IR"([\w\.]+),([^"]+)">/g,'<input type="radio" name="$1" value="$2">'),e=e.replace(/<SSV("[\w\.]+")>/g,'<span data-class="show_value" style="font-weight:bold" name=$1></span>'),e=e.replace(/<BTN"([\w.]+),([^"]+)"([^>]*)>/g,'<button type="button" name="$1"$3>$2</button>'),e=e.replace(/<IF"/g,'<input type="file" name="'),e.replace(/<input type="(checkbox|radio)[^>]+>[^<]+/g,"<label>$&</label>")}}}(),pref_func.settings.oninput_funcs=pref_func.add_onchange_format(pref_func.settings.onchange_funcs.__proto__),pref_func.settings.onchange_funcs["catalog.tag.ignore"]=pref_func.settings.onchange_funcs["tag.re_generate"],pref_func.settings.onchange_funcs["catalog.tag.max"]=pref_func.settings.onchange_funcs["tag.re_generate"],pref_func.settings.onchange_funcs["tag.gen_str"]=pref_func.settings.onchange_funcs["tag.gen"],pref_func.bind_myself(pref_func.settings.oninput_funcs.__proto__,["SHOW","HIDE","SHOW2","HIDE2","SHOW3","HIDE3","TOGGLE2","SHOWALL","HIDEALL"]);var options={func0_prep:function(){},func0_exe:function(){}};common_func={__proto__:common_func,overwrite_prop:function(e,t){for(var n in t)void 0===t[n]&&e[n]?delete e[n]:"object"==typeof e[n]&&"object"==typeof t[n]?common_func.overwrite_prop(e[n],t[n]):e[n]=t[n]},name2domainboardthread:function(e,t){var n=e.substr(e.lastIndexOf("/")+1),a=e.substr(0,e.indexOf("/")),r=e.substr(a.length,e.length-n.length-a.length);return e===n&&n.search(/[^0-9]/)!=-1&&(a=n,n=""),t&&(""===a&&(a=site.nickname),""===r&&(r=site.board)),[a,r,n]},name2dbt:function(){var e={c:"catalog_html",j:"catalog_json",p:"page_html",q:"page_json",t:"thread_json"};return function(t){var n=this.name2domainboardthread(t,!0);return n[3]=e[n[2][0]],n[3]?n[2]=n[2].substr(1):n[3]="thread_html",n}}(),fullname2dbt:function(e){var t=e.substr(e.lastIndexOf("/")+1),n=e.substr(0,e.indexOf("/"));return[n,e.substr(n.length,e.length-t.length-n.length),t]},dom_addEventListener:function(e,t,n,a){t.addEventListener(n,a,!1),e[e.length]=[t,n,a]},dom_removeEventListener:function(e,t,n,a){for(var r=e.length-1;r>=0;r--)t&&t!==e[r][0]||n&&n!==e[r][1]||a&&a!==e[r][2]||(e[r][0].removeEventListener(e[r][1],e[r][2],!1),e.splice(r,1))},dom_addAttribute:function(e,t,n){var a=e.getAttribute(t);a&&(n=a+" "+n),e.setAttribute(t,n)},Triage:function(e,t){var n={NONE:["Don't hide this thread and set its style.",!0],ATTR:["Set style additionally.",!0],KILL:["Hide this thread permanently.",!0],TIME:["Hide this thread until it gets new replies.",!0],WATCH:["Watch this thread and mark as I've read all posts so far.",!1],UNWATCH:["Unwatch this thread.",!1],SHOW:["Show this thread always without regard to filter setting.",!1],UNSHOW:["Remove 'show' marks.",!1],STICKY:["Sticky this thread.",!1],UNSTICKY:["Unsticky this thread.",!1],UNDO:["Undo last modification.",!1],GO:["Open this thread.",!1],ARC:["Start archiving this thread.",!1],ARC1:["Archive this thread one time.",!1],UARC:["Unarchive this thread.",!1]};n.KILL_N=[n.KILL[0],!1],n.TIME_N=[n.TIME[0],!1];var a=[],r=["WATCH","UNWATCH","SHOW","UNSHOW","STICKY","UNSTICKY","ARC","ARC1","UARC"],o=document.createElement("div");o.name=t.name?t.name:"",o.className="catalog_triage_parent";var s=e.replace(/\s*\/\/.*/gm,"").split("\n");e=[];for(var i=s.length-1;i>=0;i--)""===s[i]&&s.splice(i,1);for(var l=brwsr.ff?[]:["background","background-color"],i=0;i<s.length;i++)e[i]=s[i].split(",");for(var i=0;i<e.length;i++){for(var c=0;c<e[i].length;c+=3){var p=document.createElement("button");p.innerHTML=e[i][c+1],p.name=o.name+"("+i+","+c+")",p.className="catalog_triage_button",p.type="button";for(var _=e[i][c+2]?e[i][c+2].split(";"):[],d=0;d<_.length;d++){for(var u=_[d].replace(/:.*/,""),f=0;f<l.length;f+=2)u=u.replace(l[f],l[f+1]);p.style[u]=_[d].replace(/[^:]*:/,"")}p.onclick=t.onclick,o.appendChild(p),t.wheelpatch&&(p.onmousewheel=t.wheelpatch),o.name&&(pref_func.tooltips.str[p.name]=n[e[i][c]]?n[e[i][c]][0]+(n[e[i][c]][1]?"\nSet style "+(e[i][c+2]?e[i][c+2]:"default")+".":""):""),r.indexOf(e[i][c])!=-1&&(a[a.length]=[p,e[i][c]])}o.appendChild(document.createElement("br"))}this.str=e,this.pn=o,this.format_tgt=0!==a.length?a:null},modify_bookmark:function(e,t){var n=new RegExp("(^|,)"+e.replace(/\+/,"\\+")+"([^@*!][^,\n]*)*(,|\n|$)","mg"),a=pref.catalog.filter.bookmark_list_str;if(a=a.replace(n,",")+(t?","+e+"\n":""),pref.catalog.filter.bookmark_list_str=a.replace(/,,+/g,",").replace(/^,/g,"").replace(/\n,/g,"\n").replace(/\n\n+/g,"\n").replace(/^\n/,""),catalog_obj.catalog_func()){var r=catalog_obj.catalog_func().pn12_0_4.getElementsByTagName("textarea")["catalog.filter.bookmark_list_str"];pref_func.apply_prep(r,!1)}else if(pref.catalog.auto_save_filter&&localStorage){n=pref.script_prefix+".catalog.filter."+pref.catalog_board_list_obj[pref.catalog_board_list_sel][0].key;var o=JSON.parse(localStorage.getItem(n));o.bookmark_list_str=pref.catalog.filter.bookmark_list_str,localStorage.setItem(n,JSON.stringify(o))}},perf_out:function(e){e.push(performance.now());for(var t="",n=null,a=0;a<e.length;a++)"number"==typeof e[a]?(n&&(t+=e[a]-n+", "),n=e[a]):t+=e[a]+", ";console.log(t)},debug_show_proto_func_pool:null,debug_show_proto:function(e,t,n,a){a||(a="proto"),n||(n=["proto"]);for(var r=e+":",o=Object.keys(t),s=0;s<o.length;s++)n.indexOf(o[s])==-1&&(r+=o[s]+",",n.push(o[s]),this.debug_show_proto_func_pool&&(this.debug_show_proto_func_pool[o[s]]=t[o[s]]));return t.hasOwnProperty(a)&&(r+="/"+this.debug_show_proto(t.__proto__[a],t.__proto__,n,a)),r},debug_parse_funcs_entry:function(e,t){if((t?pref.debug_mode.pfunc_comp_expand_same||pref.debug_mode.pfunc_comp_expand_diff:pref.debug_mode.pfunc_expand)&&(this.debug_show_proto_func_pool={}),console.log(this.debug_parse_funcs(e)),t){var n=this.debug_show_proto_func_pool;if(this.debug_show_proto_func_pool={},pref.debug_mode.pfunc_comp_proto){var a=t.split(":"),r=site2[a[0]].parse_funcs[a[1]],o=r.__proto__;a=pref.debug_mode.pfunc_comp_proto.split(":"),(a=site2[a[0]].parse_funcs[a[1]])&&(r.__proto__=a)}console.log(this.debug_parse_funcs(t));var s=this.debug_show_proto_func_pool}if(this.debug_show_proto_func_pool)if(t){for(var i in s){var l=n[i]===s[i];(pref.debug_mode.pfunc_comp_expand_same&&l||pref.debug_mode.pfunc_comp_expand_diff&&!l)&&(console.log(i+": "+(l?"same":"differ")+": "+n[i]),l||console.log(i+": "+(l?"same":"differ")+": "+s[i])),delete n[i]}for(var i in n)console.log(i+": only_in_original: "+n[i])}else for(var i in this.debug_show_proto_func_pool)console.log(i+": "+this.debug_show_proto_func_pool[i]);this.debug_show_proto_func_pool=null,o&&(r.__proto__=o)},debug_parse_funcs:function(e){for(var t in site2)for(var n in site2[t].parse_funcs)site2[t].hasOwnProperty("parse_funcs")&&site2[t].parse_funcs.hasOwnProperty(n)&&(site2[t].parse_funcs[n].debug____proto=t+"."+n);var a=e.split(":"),r=site2[a[0]].parse_funcs[a[1]];return e+"::"+(r?this.debug_show_proto("/"+r.debug____proto,r,["debug____proto","proto"],"debug____proto"):"NONE")},debug_parse_funcs_parse:function(e,t,n,a){for(var r=[t+"_template",t],o=0;o<2;o++)for(var s=this.debug_parse_funcs(e+":"+r[o]).split(","),i=0;i<s.length;i++){var l=s[i].lastIndexOf(":");if(s[i].substr(l+1)===n){s.splice(i+1,s.length-i-1);var c=s[i>0?i-1:i].replace(/[^\/]*\//g,"").replace(/:[^:]*$/,"").replace(/\./,":"),p=s[0].replace(/::.*/,"");return c!==p&&(s[s.length]=" (==="+c+")"),[s,c,r[o]]}l===-1?s.splice(i--,1):s[i]=s[i].substr(0,l+1)}return[s,c,r[o]]},debug_parse_funcs_all:function(e){for(var t=["DEFAULT","4chan","vichan","lain","8chan","KC","meguca","meguca1","meguca2","dist"],n=["","_json","_html"],a=["common","post","thread","page","catalog"],r={},o=0;o<t.length;o++)for(var s=0;s<n.length;s++)if("KC"!==t[o]||"_json"!==n[s])for(var i=0;i<a.length;i++)if(("DEFAULT"===t[o]||"common"!==a[i])&&site2[t[o]]){var l=a[i]+n[s];if(site2[t[o]].parse_funcs[l]){var c=this.debug_parse_funcs_parse(t[o],l,e),p=c[0],_=c[1];l=c[2];var d=site2[t[o]].parse_funcs[l];if(d){var u=d[e],f=!0;for(var m in r)if(r[m][0]===u){p[p.length]=" (==="+m+")",f=!1,r[m][1]++;break}f&&(r[_]=[u,1]),"string"!=typeof u&&"number"!=typeof u||(p[e.length]=", "+u)}console.log(p.join(""))}}var h=0;if(pref.debug_mode.pfunc_all_expand)for(var m in r)console.log(h+++"("+r[m][1]+"): "+m+": "+r[m][0])},debug_site2func:function(e){for(var t in site2)site2[t].hasOwnProperty(e)&&(site2[t]["debug____"+e]=t);var n="",a={};for(var t in site2)n+=t+": "+site2[t]["debug____"+e]+", ",a[site2[t]["debug____"+e]]=site2[t][e];if(console.log(n),pref.debug_mode.site2func_expand)for(var t in a)console.log(t+": "+a[t])},shallow_copy_1:function(e){var t=Object.create(null);for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t},deep_copy:function(e,t){for(var n in t)t.hasOwnProperty(n)&&(Array.isArray(t[n])?e[n]=t[n].slice():"object"==typeof t[n]?e[n]=this.deep_copy({},t[n]):e[n]=t[n]);return e},image_resize:function(e,t,n){var a=e.naturalWidth,r=e.naturalHeight,o=a>t?a/t:1,s=r>n?r/n:1;e.setAttribute("width",o>=s?t:a/s),e.setAttribute("height",s>=o?n:r/o)},kwd_prep_regexp:function(e,t){if(!e.str)return null;for(var n=e.sentence?[e.str]:e.str.split(" "),a=n.length-1;a>=0;a--)if(""===n[a])n.splice(a,1);else{e.re||(n[a]=n[a].replace(/[\.\(\)\[\]\+\^\$\{\}]/g,"\\$&").replace(/\*/g,".*").replace(/\?/g,"."),t&&(n[a]="^"+n[a]+"$"));try{n[a]=new RegExp(n[a],e.ci?"i":"")}catch(e){n.splice(a,1)}}return 0===n.length?null:n},escape:function(){function e(e){return t[e]}var t={"<":"&lt;",">":"&gt;","&":"&amp;",'"':"&quot;","'":"&#039;"};return function(t){return t.replace(/[<>"'&]/g,e)}}(),escape_text:function(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;")},arraybuffer2blob:function(){var e={jpg:"image/jpeg",jpeg:"image/jpeg",gif:"image/gif",png:"image/png",pdf:"application/pdf",svg:"image/svg+xml",svgz:"image/svg+xml",htm:"text/html",html:"text/html",txt:"text/plain",webm:"video/webm",mpg:"video/mpeg",mpeg:"video/mpeg",mp4:"video/mp4",ogv:"video/ogg",mp3:"audio/mp3",gz:"application/x-gzip",tar:"application/x-tar",tgz:"application/x-tar",zip:"application/x-compress","7z":"application/x-7z-compressed",xz:"application/x-xz"};return function(t,n){var a=t.substr(t.lastIndexOf(".")+1),r=e[a]||"text/plain";return new Blob([n],{type:r})}}()};var common_obj={thread_reader:null,events_beforeunload:[]};common_func.dom_addEventListener(common_obj.events_beforeunload,window,"beforeunload",function(){common_func.dom_removeEventListener(common_obj.events_beforeunload)}),common_func.dom_addEventListener(common_obj.events_beforeunload,window,"focus",function(){DelayBuffer.prototype.hasFocus=!0}),common_func.dom_addEventListener(common_obj.events_beforeunload,window,"blur",function(){DelayBuffer.prototype.hasFocus=!1});var site={max_page:20,autosage:300,board_name:"/int/",url_prefix:"https://krautchan.net/int/",url_prefix2:{},nickname:"KC",nicknames:["CatChan_tgt"],thread_keyword:"thread",postform:null,postform_rules:null,get_ops:null,get_posts:null,server_name:null,protocol:document.location.href.search(/https/)!=-1?"https:":"http:",catalog_threads_in_page:null,remove_posts:function(e){return e},remove_files_info:function(e){return e},remove_checkboxes:function(e){return e},get_time_of_last_post:function(e){return null},header_height:function(){return 0},patch:null,components:{},get key(){return site.nickname+site.board+("thread"===site.whereami?site.no:"")},query_set_component:function(e){var t=site2[site.nickname].components[e],n="string"==typeof t?document.querySelector(t):document.querySelectorAll(t[0])[t[1]];n?site.components[e]=n:delete site.components[e]},config:function(e,t,n){var a=window.location.href,r=a.substr(0,a.indexOf(e)+e.length),o=decodeURI(a.substr(r.length+1))+"/";if(site.board="/"+o.substr(0,o.indexOf("/")+1),site.url_prefix=r+site.board,site.server_name=a.substr(0,a.indexOf(e)-1).replace(/https*:\/\/*/,""),site.nickname=t,site.isthread=window.location.href.search(site2[t].thread_keyword)!=-1,void 0===site.no&&(site.no="thread"===site.whereami?site2[site.nickname].get_ops(document)[0]:""),!n){!site0.isStep&&site2[t].features&&pref_func.pref_overwrite(site.features,site2[t].features);for(var s in site2[site.nickname].components)site.query_set_component(s);!site.settings&&site.components.boardlist&&(site.settings=site.components.boardlist.appendChild(document.createElement("span"))),site.patch=site2[site.nickname].patch}},features:{page:!1,graph:!0,setting:!0,setting2:!0,postform:!0,catalog:!0,listener:!1,uip_tracker:!1,thread_reader:!0,debug:!1},owners_recommendation:"",catalog:!1,whereami:null,embed_to:{},root_body:document.getElementsByTagName("body")[0],embed_frame:"CatChan_embed_frame",embed_frame_win:null,boardlist:null,settings:null,__proto__:{get myself(){return Object.defineProperty(this,"myself",{value:site2[site.nickname].wrap_to_parse.get(document,site.nickname,site.board,"thread_html",{thread:site.no})[0],writable:!0,enumerable:!0,configurable:!0}),this.myself}}};site.protocol=document.location.href.search(/https/)!=-1?"https:":"http:",site.root_body2=site.root_body;var site2={};site2.DEFAULT={nickname:"DEFAULT",home:"",check_func:function(){return window.location.href.indexOf(this.domain_url)!=-1&&(site.whereami="other",site.config(this.domain_url,this.nickname),!0)},boards_sel_from_tags:function(){return""},protocol:site.protocol,components:{},spoiler_text:{spoiler:/span.spoiler$/,open:/span.spoiler:hover/},make_tack:function(){var e=document.createElement("i");return e.setAttribute("class","fa fa-thumb-tack"),e},make_showAlways:function(){var e=document.createElement("i");return e.setAttribute("class","fa"),e.textContent="★",e},set_icon:function(e,t,n,a,r){if(e){var o=a["icon_"+n]||"sticky"==n&&this.get_icon(e,t,n,a);if(r&&o)return a.systemSticky&&(o.style.opacity=null),o;if(!o)return this.add_icon(e,t,n,a);"sticky"==n&&a.systemSticky?o.style.opacity="0.4":o.parentNode.removeChild(o)}return null},postform:function(){function e(e){this.tack&&(this.tack.style.display="none"===this.tack.style.display?"":"none")}return{tack:null,init:function(){return site.postform&&(this.tack=site2[site.nickname].make_tack(),this.tack.setAttribute("style","float:right;font-size:2em"),site.postform.parentNode.insertBefore(this.tack,site.postform)),this.tack},on:e,off:e}}(),postform_prep:function(){site.components.postform_submit2=null,site.components.postform_submit2_observer=new MutationObserver(this.postform_submit2_find),site.components.postform_submit2_observer.observe(document.getElementsByTagName("body")[0],{childList:!0})},postform_submit2_find:function(){site.components.postform_submit2;site.query_set_component("postform_submit2"),site.query_set_component("postform_comment2"),common_obj.thread_reader&&common_obj.thread_reader.setup_submit2(),pref.features.recovery&&recovery.setup2()},general_event_handler:function(){var e={common:{subscribe:function(e){this.mouseover&&e.addEventListener("mouseover",this.mouseover,!1)},unsubscribe:function(e){this.mouseover&&e.removeEventListener("mouseover",this.mouseover,!1)},get_mark:function(e,t){return this.get_mark_from_height(t,document.getElementByTagName("div"))},get_mark_from_height:function(e,t){for(var n=t.length,a=n>>1,r=0;a>0;)t[r+a].offsetTop<e&&(r+=a),a>>=1;for(;r+1<n&&t[r+1].offsetTop<e;)r++;return t[r]},isThumbnail:function(e){var t=e.target;return"IMG"===t.tagName&&t.parentNode&&"A"===t.parentNode.tagName},recSearch_thread:function(e,t){for(;e&&e!=t;){if(e.classList&&e.classList.contains("thread"))return e;e=e.parentNode}return null},getID:function(e){},getCountry:function(e){},getTrip:function(e){},getName:function(e){return e.classList.contains("name")&&e.textContent||void 0},an2srcNo:function(e,t){for(;e;){if(e.classList&&e.classList.contains("post"))return site2[t.domain_html].parse_funcs.post_html.no({pn:e});if(gGEH.pns_all_keys.get(e))return site2[t.domain_html].parse_funcs.catalog_html.no({pn:e});e=e.parentNode}}}};return e.thread=Object.create(e.common),e.page=Object.create(e.common),e.catalog=Object.create(e.common),e}(),horizontal_separator_in_index:function(){var e=document.createElement("hr");return e.setAttribute("class",pref.script_prefix+"_hs"),e},get_next_image:function(e,t,n){n||(n=cataLog.parent.getElementsByTagName("img"));var a=Array.prototype.indexOf.call(n,e);if(t)for(;n[a+1]&&n[a+1].offsetTop<t;)a++;return a>=0?n[a+1]:null},catalog_threads_in_page:function(e){return[]},remove_posts:function(e,t){},remove_files_info:function(e){return e},postform_rules:null,thread_keyword:"thread",max_page:function(e){return 10},generate_boards_json:function(e,t){for(var n={pages:t},a=[],r=0;r<e.length;r++)a[a.length]=Array.isArray(e[r])?{board:e[r][0],pages:e[r][1],__proto__:n}:{board:e[r],__proto__:n};return{boards:a}},url_boards_json:function(){return""},get_boards_json:function(e,t,n,a){var e="boards_json_"+this.nickname;this.boards_json?this.get_boards_json_callback(this.nickname,{status:200,response:this.boards_json},[t,n]):httpd.req({initiator:e,INDICATOR:a?{shift:function(){},report:function(){}}:null,IDX:0,FINISHED:0,SUC:0,max:1,tgts:[{domain:this.nickname,url:this.url_boards_json()[0],responseType:"json",data_type:"json"}],callback_1:function(a,r){this.get_boards_json_callback(e,r,[t,n,!0])}.bind(this)},6)},get_boards_json_callback:function(e,t,n){200==t.status&&(this.postprocess_board(t.response),site3[this.nickname].boards||(liveTag.update_pn_buf.cancel(),liveTag.update_pn_buf.do_tgt()),site3[this.nickname].boards=!0),n[0]&&(n[1]||200===t.status)&&(n[2]?n[0]():setTimeout(n[0],0))},postprocess_board:function(e){for(var t=0;t<e.boards.length;t++){var n=liveTag.mems.init({domain:this.nickname,board:"/"+e.boards[t].board+"/"});n.o=t,e.boards[t].pages&&!n.pgs&&(n.pgs=e.boards[t].pages),e.boards[t].tags&&0!=e.boards[t].tags.length&&liveTag.postprocess_board_add_btag(e.boards[t].tags,n)}},boardlist_boards:Object.create(null,{sel:{value:null,writable:!0}}),show_boardlist_physical_board:function(e,t){var n=this.boardlist_boards;if(n.sel===!0&&"replace"===pref.virtualBoard.p_board||n.sel===!1&&"both"===pref.virtualBoard.p_board){var a=n.sel?"v":"p",r=n.sel?"p":"v";for(var o in n){var s=n[o];s[a]&&s[r]&&(s[r].parentNode.insertBefore(s[a],s[r]),s[r].parentNode.removeChild(s[r]))}n.sel=!n.sel}if(null===this.boardlist_boards.sel&&"replace"===pref.virtualBoard.p_board){for(var i=site.components.boardlist.getElementsByTagName("a"),o=0;o<i.length;o++){var l=i[o].textContent;this.show_boardlist_physical_extract_func&&(l=this.show_boardlist_physical_extract_func(l)),"#"!==l[0]&&(this.boardlist_boards["#"+(pref.liveTag.ci?l.toLowerCase():l)]={p:i[o]})}this.boardlist_boards.sel=!1}if("replace"===pref.virtualBoard.p_board){for(var c={},o=e.length-1;o>=0;o--){var l=pref.liveTag.ci?e[o].toLowerCase():e[o],s=this.boardlist_boards[l];if(s){if(!s.v){var p=s.p,_=liveTag.create_tag_node_1(l,t,"a");_.setAttribute("href",p.getAttribute("href")),p.parentNode.insertBefore(_,p),p.parentNode.removeChild(p),s.v=_}e.splice(o,1),c[l]=null}}if(pref.virtualBoard.v_remove)for(var o in this.boardlist_boards)if(this.boardlist_boards[o].v&&void 0===c[o]){var p=this.boardlist_boards[o].p,_=this.boardlist_boards[o].v;_.parentNode.insertBefore(p,_),_.parentNode.removeChild(_),delete this.boardlist_boards[o].v}}return e},boardlist_tags:null,boardlist_tags_pn:null,show_boardlist:function(e,t){var n=site.components.boardlist,a=this.show_boardlist_physical_board(e.slice(),t);if(pref.virtualBoard.show&&0!==a.length){var r=pref.test_mode[118]?liveTag.create_tag_nodes(a," / ",t):liveTag.update_tag_nodes(a," / ",t,this.boardlist_tags_pn,this.boardlist_tags);if(this.boardlist_tags_pn)pref.test_mode[118]&&this.boardlist_tags_pn.parentNode.replaceChild(r,this.boardlist_tags_pn);else{var o=document.createElement("span");o.appendChild(document.createTextNode("[ ")),o.appendChild(r),o.appendChild(document.createTextNode(" ]")),n.appendChild(o)}this.boardlist_tags_pn=r,this.boardlist_tags=a}else this.boardlist_tags_pn&&(n.removeChild(this.boardlist_tags_pn.parentNode),this.boardlist_tags_pn=null,this.boardlist_tags=null)},query_tag_node:function(e){var t=this.boardlist_boards[e];if(t)return t.v;if(this.boardlist_tags_pn){var n=this.boardlist_tags.indexOf(e);if(n>=0)return this.boardlist_tags_pn.childNodes[2*n]}},get_ops:function(e){return[]},get_posts:function(e){return[]},absolute_link:function(e){for(var t=this.protocol+"//"+this.domain_url,n=["src","href"],a=e.getElementsByTagName("*"),r=0;r<a.length;r++)for(var o=0;o<n.length;o++){var s=a[r].getAttribute(n[o]);s&&0!=s.indexOf("http")&&0!=s.indexOf("mailto:")&&0!=s.indexOf("blob")&&"//"!=s.substr(0,2)&&a[r].setAttribute(n[o],t+s)}},absolute_link_1:function(e){
return site2[this.nickname].protocol+"//"+site2[this.nickname].domain_url+e},link_dbtp2href_abs:function(e,t){var n=e[0];return(n!=site.nickname?site2[n].protocol+"//"+site2[n].domain_url:"")+site2[n].link_dbtp2href(e,t)},ls_key_own_posts:pref.script_prefix+".own_posts.",prep_own_posts_event:function(e){e&&site2[site.nickname].prep_own_posts_1(e.key),window.name===site.nickname&&send_message("parent",["OWN_POSTS",window.name,site3[window.name].own_posts])},prep_own_posts:function(e){if(site3[this.nickname].own_posts={},localStorage)for(var t=e?[this.ls_key_own_posts+e]:Object.keys(localStorage),n=0;n<t.length;n++)this.prep_own_posts_1(t[n])},prep_own_posts_1:function(e){if(0==e.indexOf(this.ls_key_own_posts)){var t=e.substr(this.ls_key_own_posts.length),n=t.substr(0,t.lastIndexOf("/")+1);site3[this.nickname].own_posts[n]||(site3[this.nickname].own_posts[n]={});for(var a=JSON.parse(localStorage[e]||"[]"),r=0;r<a.length;r++)site3[this.nickname].own_posts[n][a[r]]=null}},clean_up_LS:function(e,t,n){e===site.nickname&&localStorage&&(pref.thread_reader.own_posts_tracker&&pref.thread_reader.clean_up_own_posts&&this.clean_up_LS_th(this.ls_key_own_posts,t,n),pref[cataLog.embed_mode].deleted_posts.auto_clean&&this.clean_up_LS_th(this.ls_key_deletedPosts,t,n),pref.recovery.auto_clean&&(this.clean_up_LS_th(this.ls_key_comment,t,n),this.clean_up_LS_th(pref.script_prefix+".comment."+site.nickname,t,n)))},ls_key_deletedPosts:pref.script_prefix+".deletedPosts.",clean_up_deleted_posts_1:function(e){localStorage&&delete localStorage[this.ls_key_deletedPosts+e]},ls_key_comment:pref.script_prefix+".draft.",clean_up_LS_th:function(e,t,n){for(var a=e+t,r=Object.keys(localStorage),o=0;o<r.length;o++)0==r[o].indexOf(a)&&void 0===n[r[o].substr(a.length)]&&delete localStorage[r[o]]},check_reply:function(){function e(e,t){for(var n=e.pn.getElementsByTagName("a"),a=0;a<n.length;a++){var r=!1,i=n[a].textContent;if(o&&null===o[i.substr(2)]&&f.test(i)&&(r=!0),!r&&s&&h.test(i)){var l=i.split("/"),c="/"+l[1]+"/";s[c]&&null===s[c][l[2]]&&(r=!0)}r&&("plain"===pref.thread_reader.show_reply_to_me_by?n[a].parentNode.insertBefore(document.createTextNode(" (You)"),n[a].nextSibling):n[a].textContent=n[a].textContent+" (You)")}if(t&&o&&null===o[e.no]){var p=e.parse_funcs_html.pn_name(e);"plain"===pref.thread_reader.show_own_post_by?p.parentNode.insertBefore(document.createTextNode(" (You)"),p.nextSibling):p.innerHTML=p.innerHTML+" (You)"}}function t(e,t,a,r){var i=o&&e.no in o;if(i&&(e.reply_of_mine=!0),!i||!pref.catalog_footer_ignore_my_own_posts){var l=c?e.com:e.body;if(l){var p=!1;if(o){var f=l.match(_);if(null!==f)for(var m=0;m<f.length;m++){var h=f[m].substr(d);if(null===o[h]){p=!0;break}}}if(!p&&s&&null!==(f=l.match(u)))for(var m=0;m<f.length;m++){var h=f[m].split("/"),g="/"+h[1]+"/";if(s[g]&&null===s[g][h[2]]){p=!0;break}}p&&(e.reply_to_me=!0,t[1]+=65536)}t[1]++}r[r.length]=e,a&&n(e,a)}function n(e,t){if(c){var n=e.com;if(!n)return;n=n.replace(/<[^>]*>|&[^;]*;/g," "),pref.test_mode[47]&&(p.innerHTML=n,n=p[brwsr.innerText])}else{if(e.editing)return void(t[t.length]=e);if(!(n=e.body||e.com))return}if(n.indexOf("#")!==-1){if(l)for(var a=0;a<l.length;a++)n=n.replace(l[a],"\n");var r=n.match(liveTag.scan_regex);if(null!==r)for(var a=0;a<r.length;a++)if(r[a].length<=pref.liveTag.maxstr){if(i){for(var o=i.length-1;o>=0&&!i[o].test(r[a]);o--);if(o>=0)continue}t[t.length]=r[a]}}}function a(e){"txt"===e.parse_funcs.type_com?(_=m,d=2,u=g,c=!1):(_=b,d=8,u=v,c=!0)}function r(e){pref.liveTag.ex_list?(i=pref_func.merge_obj5a(e,pref.liveTag.ex_list_obj5,null),l=pref_func.merge_obj5a(e,pref.liveTag.rm_list_obj5,null)):(i=null,l=null)}var o,s,i,l,c=!1,p=document.createElement("div"),_="",d=0,u="",f=/^>>[0-9]+/,m=/>>[0-9]+/g,h=/^>>>\/[0-9A-z_\+]+\/[0-9]+/,g=/>>>\/[0-9A-z_\+]+\/[0-9]+/g,b=/&gt;&gt;[0-9]+/g,v=/&gt;&gt;&gt;\/[0-9A-z_\+]+\/[0-9]+/g,y=!0;return{remake_own_posts:function(){y=!0},make_own_posts:function(){site2[site.nickname].prep_own_posts(),y=!1},add_you:e,set_own_posts:function(e){s=site3[e.domain].own_posts,o=s[e.board]||s.ALL,0==Object.keys(s).length&&(s=void 0)},check_t1_op:function(e){a(e),r(e);var t=[];return n(e,t),t},get_checked_time:function(e){return e[2]},set_watch_time:function(e,t,n,a){t>0&&(e[0]|=262144,8388608&e[0]?e[2]=t:(a?this.time_track[n]=t:this.time_watch[n]=t,e[0]&=4286578687))},set_watched_to_last:function(e,t,n,a){this.set_watch_time(e,t,n,a),e[1]=a||0},set_unwatch:function(e){e[0]&=4285792255,e[1]=0},time_watch:{},time_track:{},check:function(e,o,s,i){var l=131072&o[0],c=o[2],p=!1,_=o[2];if(262144&o[0]){if(8388608&o[0])c=0,o[2]=0;else{var d=!this.time_watch[e.key]&&this.time_track[e.key];_=this.time_watch[e.key]||d,delete this.time_watch[e.key],delete this.time_track[e.key]}o[1]=0,o[0]=(4286251008&o[0]|524288)+(e.omitted_posts?e.omitted_posts+1:0),p=!0}var u=c,f=e.posts.length-1;if(f>=0){o[2]=e.posts[f].time*e.parse_funcs.time_unit||o[2],1!=e.parse_funcs.time_unit&&(c=Math.floor(c/e.parse_funcs.time_unit),_=p?Math.floor(_/e.parse_funcs.time_unit):c);var m="post"===pref.liveTag.from?[]:null;m&&r(e);var h=liveTag.generate_ur(o[1]),g=786432&o[0];if((g||m)&&a(e),g)for(y&&this.make_own_posts(),liveTag.mems[e.domain][e.board].nr=-1,a(e),this.set_own_posts(e);f>=0&&e.posts[f].time>_;)t(e.posts[f--],o,m,i);if(m)for(;f>0&&(l||e.posts[f].time>c);)n(e.posts[f--],m);if(!common_obj.thread_reader)if(m&&0!=m.length)var b=liveTag.extract_tags(e,m,null,!l);else if(pref.liveTag.style.use&&g){var v=liveTag.generate_ur(o[1]);h!=v&&liveTag.update_ur(e.key,v,0!=h&&p)}if(pref3.stats.use&&stats&&stats.aggregate(e),_!==c||!g){for(f=e.posts.length;f>0&&e.posts[f-1].time>c;)f--;var w=e.posts.slice(f)}}return o[0]=(4294508544&o[0])+e.nof_posts,s&&786432&o[0]&&(0!=i.length&&pref.notify.desktop.notify&&site2[e.domain].wrap_to_parse.posts({posts:i,__proto__:e}),notifier.changed(e,d?[]:i)),{tags:b,posts:w||i,time_check_old:u}}}}(),get_post_offsetTop:function(e,t){},favicon:{get_favicon:function(){for(var e=document.getElementsByTagName("head")[0].getElementsByTagName("link"),t=0;t<e.length;t++)if("shortcut icon"==e[t].getAttribute("rel"))return e[t];var n=document.createElement("link");return n.setAttribute("rel","shortcut icon"),n.setAttribute("href",this.none),n.setAttribute("type","image/x-icon"),document.getElementsByTagName("head")[0].appendChild(n)},get_title:function(){var e=document.getElementsByTagName("head")[0].getElementsByTagName("title")[0];return e||(e=document.createElement("title"),e=document.getElementsByTagName("head")[0].appendChild(e)),e}},get_icon:function(){},add_icon:function(){},time_revised_check:function(e){return!1},format_thread_layout:function(e){},format_thread_style:function(e){},format_thread_contents:function(e){},format_thread_always:function(e){},format_remove_tn_area_size:function(e){},mark_newer_posts2:function(e,t,n,a){t/=this.parse_funcs.post_json.time_unit;for(var r=null,o=e.length-1;o>=0;o--){var s=e[o].pn;if(t<e[o].time)s.setAttribute("style",pref.style.post_new),n&&s.addEventListener("mouseover",this.unmark_post_from_event,!1),r=s;else{if(a)break;null!=s.getAttribute("style")&&s.removeAttribute("style")}}return r},mark_newer_posts:function(e,t,n,a,r,o){for(var s=null,i=t.length-1;i>=0;i--){var l=a?a(t[i]):t[i];if(l)if(n<site2[e].parse_funcs.post_html.time_pn(t[i]))l.setAttribute("style",pref.style.post_new),r&&l.addEventListener("mouseover",site2[e].unmark_post_from_event,!1),s=l;else if(null!=l.getAttribute("style")&&l.removeAttribute("style"),o)break}return s},format_pn:function(e,t,n,a,r){n||(n=pref[cataLog.embed_mode]),n.colorID&&this.colorID(e),n.backlink&&this.backlink(e,t,r),n.localtime&&this.localtime(e),a&&(site2.DEFAULT.check_reply.add_you(a,!0),a.deleted_after&&e.classList.add("CatChan_deleted"),void 0!==a.search_result&&site2[a.domain_html].update_posts0_class(e,a.search_result))},colorID:function(){},localtime:function(){},unmark_post_from_event:function(e){e.target.removeEventListener("mouseover",site2.common.unmark_post_from_event,!1),site2.DEFAULT.unmark_post(e.target)},unmark_post:function(e){e.removeAttribute("style")},modify_thread_link:function(e){return[]},preprocess_html:function(e){return e},preprocess_doc:null,check_thread_archived:function(e){return!1},get_owners_recommendation:function(){return""},get_board_tags:function(){return{}},get_json_url_catalog:function(e){return""},parse_json_thread:function(e,t){},uip_tgt_post:function(e){return null},uip_post_num:function(e){return null},uip_check:function(e){},catalog_native_prep:function(e){return[]},catalog_native_prep_sel:function(e,t,n){if(n){if(0!=n.selectedIndex){n.selectedIndex=0;var a=document.createEvent("UIEvents");a.initUIEvent("change",!1,!0,window,1),n.dispatchEvent(a)}n.style.display="none"}var r=e.getElementsByTagName("select")["catalog.indexing"];"catalog"===site.whereami?n.parentNode.insertBefore(r,n):t.childNodes[3].insertBefore(r,t.childNodes[3].firstChild)},catalog_native_prep_swap_sortSel:function(e){e.parentNode.insertBefore(cataLog.components.catalog.indexing,e.nextSibling),e.setAttribute("style","display:none")},catalog_frame_prep:function(e){},catalog_native_frame_prep:function(e){function t(){r?(site.root_body.removeChild(n),n=null,site.embed_frame_win=null,site2.common.disgorge_children(a)):(a=site2.common.absorb_children(site.root_body),a.style.width=pref.catalog_size_frame0_width+"%",a.style.float="left",a.style.height=window.innerHeight+"px",a.style.overflow="scroll",n=site2[site.nickname].catalog_native_frame_prep_frame(site.root_body,null)),r=!r}var n,a,r=!1;e.addEventListener("click",t,!1)},catalog_native_frame_prep_frame:function(e,t){return ifrm=document.createElement("iframe"),ifrm.setAttribute("name",site.embed_frame),ifrm.style.height=window.innerHeight+"px",ifrm.style.margin="0px",ifrm.style.width=pref.catalog_size_frame1_width+"%",e.insertBefore(ifrm,t),site.embed_frame_win=ifrm.contentWindow,ifrm},catalog_embed_prep:function(e){e.style.position=null,e.childNodes[1].style.width=null,e.childNodes[1].style.height=window.innerHeight+"px",e.childNodes[0].childNodes[0].style.display="none",e.childNodes[0].childNodes[1].style.display="none",e.style.border=null,e.style.left=null,e.style.resize=null,e.style.top=null},thread2search_obj:function(e){return[e[brwsr.innerText],"","","","","","",""]},popups_posts:function(){function e(){function e(e,n,a,r){"imm"===e.popdown?a(n):(r||(r=n.target),e.popup_mMove&&r.addEventListener("mousemove",t,!1),o=a,s=e,i=r,t(n))}function t(e){a&&clearTimeout(a),a=setTimeout(n,s.popup_delay),r=e}function n(e){e&&clearTimeout(a),a=null,s.popup_mMove&&i.removeEventListener("mousemove",t,!1),e||o(r)}var a=null,r=null,o=null,s=null,i=null;return{over:e,stop:function(){return!!a&&(n(!0),!0)},get up_timer(){return a},out:function(e){return e.relatedTarget===m?(m=null,e.relatedTarget):this.stop()}}}function t(e,t){var a=f.get(e);if(a)if(Array.isArray(a))for(var r=0;r<a.length;r++)a[r]&&a[r]!==t&&n(a[r]);else a!==t&&n(a)}function n(e){var t=f.get(e),n=t.pf&&t.pf()||pref.proto;"imm"===n.popdown?r(e):t.timer=setTimeout(r.bind(null,e),n.popdown_delay)}function a(e,t,n,a){f.set(e,a||t),f.set(t,n||{src:e}),t.addEventListener("mouseenter",o,!1),t.addEventListener("mousedown",cnst.div_mousedown,!1)}function r(e,t){if(e&&e.parentNode){t||e.parentNode.removeChild(e);var n=f.get(e);n.key&&k.pop_load_req_delete(n.key,e),n.chart&&!t&&n.chart.destroy(),n.scroll&&e.removeEventListener(brwsr.mousewheel,cnst.div_scroll,!1);var a=n.src,r=f.get(a);if(Array.isArray(r)){r[r.indexOf(e)]=null;for(var i=0;i<r.length&&!r[i];i++);i==r.length&&f.delete(a)}else f.delete(a);if(f.delete(e),e.removeEventListener("mouseenter",o,!1),e.removeEventListener("mousedown",cnst.div_mousedown,!1),t)return e.removeEventListener("mouseleave",s,!1),n}}function o(e){var t=e.currentTarget,n=f.get(t);"imm"===(n.pf&&n.pf()||pref.proto).popdown?r(t):(n.timer&&i(n),m=e.relatedTarget,t.addEventListener("mouseleave",s,!1))}function s(e){var t=e.currentTarget;t.removeEventListener("mouseleave",s,!1),n(t)}function i(e){clearTimeout(e.timer),e.timer=null}function l(e,t,n,a,r){var o=n?"left"===h?.75:.25:.5,s=n?"top"===g?.8:.2:.5;b=document.documentElement.clientWidth,v=document.documentElement.clientHeight,b*o-t.clientX>0^a?(e.style.left=t.clientX+10+"px",h="left"):(e.style.right=b-t.clientX+10+"px",h="right"),v*s-t.clientY>0^r?(e.style.top=t.clientY+10+"px",g="top"):(e.style.bottom=v-t.clientY+10+"px",g="bottom")}function c(e,t){var n=e.style,a=parseInt(n.top?n.top:n.bottom,10);if(!(e.offsetHeight+a<v)&&a>.5*v){var r=v-e.offsetHeight,o=(r<0?0:r)+"px";n.top?(n.top=o,g="bottom"):(n.bottom=o,g="top")}var s=parseInt(n.left?n.left:n.right,10);if(!(e.offsetWidth+s<b)&&s>.5*b){var o=b-parseInt(n.left?n.left:n.right,10)+20+"px";n.left?(n.right=o,n.left=null):(n.left=o,n.right=null)}}function p(e){if("/"===e[0]||"#"===e[0])return site.nickname;for(var t in liveTag.mems)if(e.indexOf(site2[t].domain_url)!=-1)return site2[t].nickname;for(var t in site2)if(e.indexOf(site2[t].domain_url)!=-1)return site2[t].nickname_href2domain||site2[t].nickname}function _(e,t){d(e);var n=e.target,a=pref[cataLog.embed_mode];a.popup&&"A"===n.tagName&&site2.DEFAULT.popups_link_regex.test(n.textContent)?k.over(e,t):a.image_hover&&u.isThumbnail(e)?w.over(a.thumbnail.hover,e,cataLog.DIH.image_hover_add):pref.test_mode[121]&&a.popupX.use&&w.over(a.popupX,e,T.X)}function d(e){if(cataLog.DIH.image_hover_remove(),!w.out(e)){var n=e.relatedTarget;n&&("A"===n.tagName||pref.test_mode[121]&&T.et)&&t(n),T.et=null}}var u,f=new Map,m=null,h="left",g="top",b=0,v=0,y=new WeakSet,w=e(),k=function(){function e(e,n){if(!pref.proto.popup_hlt||!m(e)){w.force=n,w.over(pref.proto,e,t);p(e.target.getAttribute("href"))!==site.nickname&&e.stopPropagation()}}function t(e){var t=w.force,a=e.target;if(f.has(a))return void i(f.get(f.get(a)));var r=p(a.getAttribute("href"));if(!t&&pref[cataLog.embed_mode].env.popup_native)if(pref[cataLog.embed_mode].env.event_dynamic&&!pref.test_mode[100]){if(site.nickname===r)return}else if(y.has(a))return;n(e,r)}function n(e,t){var n=b(e,t);return n&&a(e.target,n.pn,n.key?{src:e.target,key:n.key}:null),n.pn}function o(e,t){var a=v.get(e);if(a){for(var o=a.length-1;o>=0;o--){var s=a[o],i=f.get(s.target);if(i){r(i);var l=n(s,t);i.style.left?l.style.left=i.style.left:l.style.right=i.style.right,i.style.top?l.style.top=i.style.top:l.style.bottom=i.style.bottom}}v.delete(e)}}function s(e,t,n){var a={target:e.target,clientX:e.clientX,clientY:e.clientY,pn:n},r=v.get(t);r?r.unshift(a):v.set(t,[a])}function _(e,t){var n=v.get(e);if(n){for(var a=n.length-1;a>=0;a--)n[a].pn===t&&n.splice(a,1);0===n.length&&v.delete(e)}}function m(e){var t=e.target.getAttribute("href"),n=p(t),a=site2[n].popups_href2th_q(t),r=a[1],o=cataLog.threads[a[0].key],s=o&&o[16]&&o[16].posts;if(s){for(var i=s.length-1;i>=0&&s[i].no!==r;i--);var l=i>=0?s[i].pn:void 0;if(l&&"none"!==window.getComputedStyle(l).display){var c=l.offsetTop,_=brwsr.document_body.scrollTop;if(c>_&&c+l.offsetHeight<_+document.documentElement.clientHeight)return l.classList.add(site2[site.nickname].popups_posts_class_hlt),e.target.addEventListener("mouseout",h,!1),f.set(e.target,l),g(l,e,{domain_html:pref.catalog.mimic_base_site?site.nickname:n}),!0}}return!1}function h(e){var t=e.target;t.removeEventListener("mouseout",h,!1),f.get(t).classList.remove(site2[site.nickname].popups_posts_class_hlt),f.delete(t),k&&(k.classList.remove("dotted"),k=null)}function g(e,t,n){if(!pref.test_mode[108]){var a=site2[n.domain_html].post_pn2ce(e),r=a?a.getElementsByTagName("a"):void 0;if(r&&r.length>1){var o=u.an2srcNo(t.target,n);if(o){for(var s=0;s<r.length&&site2[n.domain_html].popups_href2dbtp(r[s].getAttribute("href"))[3]!=o;s++);s!=r.length&&(r[s].classList.add("dotted"),k=r[s])}}}}function b(e,t){var n=e.target,a={domain:t,domain_html:pref.catalog.mimic_base_site?site.nickname:t},r=site2[a.domain].popups_href2th_q(n.getAttribute("href"));if(r){var o,i=r[2],p=r[0][r[1]],_=i[3]==i[2];if(void 0===p&&pref.test_mode[80]){a.no=r[2][2];for(var d=["_IDB/","_File/"],u=0;u<2;u++){a.board=r[2][1].slice(0,-1)+d[u];var f=liveTag.mems[a.domain][a.board]&&liveTag.mems[a.domain][a.board][a.no]&&liveTag.mems[a.domain][a.board][a.no].q;if(f){r[0]=f;break}}}if((void 0===p||Array.isArray(p))&&(site2.DEFAULT.popups_try_fetch_from_lth_ta(liveTag.mems[a.domain][i[1]][i[2]],parseInt(i[3],10),a),p=r[0][r[1]]),void 0===p||Array.isArray(p)){site2[a.domain].popups_post_fetch(a,i),o=site2[a.domain_html].post_json2html({time:0,com:"Loading...",domain:t,board:i[1],no:i[2]},i[1]);var m=i[0]+i[1]+i[2]+"#"+i[3];s(e,m,o),site2.DEFAULT.popups_set_waiting(r[0],r[1])}else{if(!p.pn||_&&("4chan"!==site.nickname||"thread"!==site.whereami)){if(!p.domain){var h=p;if(h.domain=a.domain,h.extra_files)for(var u=0;u<h.extra_files.length;u++)h.extra_files[u].domain=a.domain}o=site2[a.domain_html].post_json2html(p,i[1])}else o=p.pn.cloneNode(!0);cataLog.format_html.prep_anchor_links(o,r[0]),site2[a.domain_html].format_pn(o,p,null,null,r[0]),g(o,e,a)}return o.style={},o.style.position="fixed",l(o,e,!0),o.style.zIndex=pref[cataLog.embed_mode].popup_zIndex,"KC"!==site.nickname&&(o.style.borderStyle="solid"),o.style.boxShadow="rgb(153, 153, 153) 1px 1px 1px","4chan"===site.nickname&&(o.classList.add("preview"),o.style.display="block"),site2[site.nickname].popups_post_pnode(n).appendChild(o),pref.debug_mode[10]&&console.log("popup: "+r[1]+": "+site2[a.domain].popups_debug(r[0])),c(o,e),gGEH.pns_all_keys.set(o,i[0]+i[1]+i[2]),m?{pn:o,key:m}:{pn:o}}}var v=new Map,k=null;return gGEH.triage_in2=d,{over:e,pop_load:o,pop_load_req_delete:_,pop_load_req_delete:_}}(),x=function(){function n(e){var t=pref[cataLog.embed_mode].popup3;if("no"!==t.ww||"no"!==t.wn||"no"!==t.nw||"no"!==t.nn){var n=u.recSearch_thread(e.target,e.currentTarget);if(n){if(d.up_timer&&d.src===n)return;o(e),d.src=n,d.over(t,e,s,n)}else o(e)}}function o(e){var n=d.out(e);if(n!==!0){var a=u.recSearch_thread(e.relatedTarget,e.currentTarget);a?t(a,n):m&&t(m,n),m=null}}function s(e){var t=gGEH.get_key_recursive(d.src,document),n=pref[cataLog.embed_mode].popup3,a=f.get(d.src)||[];pref.test_mode[110]||c(n.ww,e,t,a,0,!1,!1),c(n.wn,e,t,a,1,!1,!0),c(n.nw,e,t,a,2,!0,!1),c(n.nn,e,t,a,3,!0,!0),m=d.src,d.src=null}function c(e,t,n,o,s,c,u,m,h){if("no"!==e){if(o[s])return void i(f.get(o[s]));var g=document.createElement("div");if(g.setAttribute("class",pref.script_prefix+"_window"),g.style.position="fixed",g.style.border="1px solid blue","chart"===e||cataLog.pop_up_set_contents(g,e,n,m)){if(g.addEventListener(brwsr.mousewheel,cnst.div_scroll,!1),l(g,t,!1,c,u),o[s]=site.popup_body.appendChild(g),pref.catalog_popup_size_fix&&(g.style.width=g.offsetWidth+"px",g.style.height=g.offsetHeight+"px"),"chart"===e)if(chart_obj&&pref3.stats.use)var b=new chart_obj.PostChart(g,[n]);else g.innerHTML="Statistics needs to be activated.";var v=document.createElement("button");common_func.overwrite_prop(v.style,{position:"absolute",top:"0px",left:"0px"}),v.classList.add(pref.script_prefix+"_autoTp"),v.appendChild(site2[site.nickname].make_tack()),g.appendChild(v),v.onclick=function(e){var t=e.currentTarget,a=t.parentNode;cnst.bottom_top(a);var o,s=r(a,!0).chart;if(s){var i=document.createElement("div"),l=site2[common_func.name2dbt(n)[0]].parse_funcs.catalog_html.tn_imgs({pn:cataLog.threads[n][0]});l[0]?i.appendChild(l[0].cloneNode()):i.innerHTML=n,common_func.overwrite_prop(i.style,{position:"absolute",bottom:"0px",left:"0px",opacity:.4}),a.replaceChild(i,t),o=chart_obj.PostChart.call(s,null,null,s),o.childNodes[1].replaceChild(a,o.childNodes[1].childNodes[1])}else a.removeChild(t),o=cnst.init3({func_str:"Show:tb"}).pn,o.appendChild(a);o.style.top=parseInt(a.style.top,10)-o.offsetHeight+"px",o.style.left=a.style.left,common_func.overwrite_prop(a.style,{position:"relative",border:null,top:null,left:null})},m?a(h,g,{src:h,scroll:!0,pf:p}):a(d.src,g,b?{src:d.src,chart:b,scroll:!0,pf:_}:{src:d.src,scroll:!0,pf:_},o)}}}function p(){return pref.proto.popupX}function _(){return pref.proto.popup3}var d=e(),m=null;return{init:function(e){site.root_body.addEventListener("mouseover",n,!1),e.addEventListener("mouseleave",o,!1),gGEH.triage_in=o},destroy:function(e){site.root_body.removeEventListener("mouseover",n,!1),e.removeEventListener("mouseleave",o,!1)},pop_up_th_1:c}}(),T=function(){function e(e,n,a){var r=gGEH.get_key_recursive(e.target,e.currentTarget);r&&(n.rexps=common_func.kwd_prep_regexp(n,a),x.pop_up_th_1("sr",e,r,[],4,!1,!1,n,e.target),t=e.target)}var t=null;return{X:function(t){var n=pref[cataLog.embed_mode].popupX;if(n.ID){var a=u.getID(t.target);if(a)return e(t,{str:a,id:!0})}if(n.flag){var r=u.getCountry(t.target);if(r)return e(t,{str:r,flag:!0})}if(n.name){var o=u.getName(t.target);if(!pref.anon&&"Anonymous"===o)return;if(o)return e(t,{str:o,name:!0,sentence:!0},!0)}if(n.trip){var s=u.getTrip(t.target);if(s)return e(t,{str:s,trip:!0},!0)}},get et(){return t},set et(e){t=e}}}(),N=function(){function e(e){var t=u.recSearch_thread(e.target,e.currentTarget);if(t){var n=gGEH.pns_all_keys.get(t)||gGEH.pns_all_keys.get(t.parentNode);if(n)return cataLog.triage.thread_in(t,n)}cataLog.triage.thread_out2(e)}return{init:function(t){site.root_body.addEventListener("mouseover",e,!1)},destroy:function(t){site.root_body.removeEventListener("mouseover",e,!1)}}}();return{over:_,leave:w.stop,pop_load:k.pop_load,blacklist:y,set_pos:l,href2domain:p,init:function(e){u=site2[site.nickname].general_event_handler[site.whereami],pref.test_mode[110]||"catalog"!==cataLog.embed_mode||x.init(e),pref.test_mode[127]||N.init()}}}(),popups_posts_class_hlt:"highlighted",popups_post_fetch:function(e,t){cataLog.scan_init("popup",[e.domain+t[1]+(pref.catalog.catalog_json?"t":"")+t[2]],{priority:8})},popups_post_pnode:function(e){if(pref.test_mode[107])return site.popup_body;if(!pref.test_mode[106])for(var t=e.parentNode;t;){if(t===cataLog.parent)return site.popup_body;t=t.parentNode}for(var n;(!(n=e.getAttribute("class"))||n.indexOf("post")==-1&&n.indexOf("thread")==-1)&&e.parentNode;)e=e.parentNode;return e},popups_href2th_q:function(e){var t=this.popups_href2dbtp(e);if(!t[0]||!t[1]||!t[2])return null;var n=liveTag.mems.init({domain:t[0],board:t[1],no:parseInt(t[2],10)});return void 0===n.q&&(n.q=n.no>1e6?Object.create(n):Object.create({0:void 0,1:void 0,2:void 0,__proto__:n})),[liveTag.mems[t[0]][t[1]][t[2]].q,parseInt(t[3],10),t]},popups_add:function(e,t,n,a,r){var o=liveTag.mems[t.domain][t.board][t.no];if(void 0===o.q&&(o.q=t.no>1e6?Object.create(o):Object.create({0:void 0,1:void 0,2:void 0,__proto__:o})),e&&"html"===t.type_data)for(var s=0;s<e.length;s++)e[s].no||Object.defineProperty(e[s],"no",{value:t.parse_funcs.no(e[s])});var i={};if(e)for(var s=0;s<e.length;s++){var l=e[s].no;i[l]=null,(void 0===o.q[l]||Array.isArray(o.q[l]))&&this.popups_add_1(t,e[s],n,o.q,!0,a)}pref[cataLog.embed_mode].backlink_all||!r&&!pref.test_mode[125]||this.popups_release_all(o,i)},popups_release_all:function(e,t){for(var n=Object.keys(e.q),a=0;a<n.length;a++)void 0===t[n[a]]&&"waiting"!==n[a]&&this.popups_release(e,n[a])},popups_add_1_cross:function(e,t,n){for(var a=0;a<t.length;a++){var r=e.parse_funcs.hrefs(t[a]);if(r)for(var o=0;o<r.length;o++)if("#"!==r[o][0]&&(n||0===r[o].indexOf(e.board))){var s=site2[e.domain].popups_href2th_q(r[o]);if(s){var i=s[2][0]!==e.domain?e.key:s[2][1]!==e.board?e.board+e.no:s[2][2]!=e.no?e.no:null;null!==i&&site2[e.domain_html].popups_add_backlink(s[0],s[1],i+"#"+t[a].no,e,!1,!1)}}}},popups_link_regex:/^>>(>\/[^\/]+\/)*[0-9]+/,popups_add_1:function(e,t,n,a,r,o){t.pn||(t.pn=site2[e.domain_html].post_json2html(t,e.board));var s=site2[e.domain_html].post_pn2ce(t.pn).getElementsByTagName("a"),i=s.length;if(n&&pref[cataLog.embed_mode].env.backlink_native){var l=site2[e.domain_html].add_backlinks_bks_query(t.pn);l&&(s=Array.prototype.slice.call(s).concat(Array.prototype.slice.call(l.getElementsByTagName("a"))))}if(s.length>0)for(var c=new RegExp("^>>"+e.no+"(\\s|\\(|$)"),p=[],_=0;_<s.length;_++){var d=s[_].textContent;if(d.search(this.popups_link_regex)!=-1){if(n&&(pref[cataLog.embed_mode].env.popup_native_kill?s[_].parentNode.replaceChild(s[_].cloneNode(!0),s[_]):this.popups_posts.blacklist.add(s[_])),_>=i)continue;var u=site2[e.domain].popups_href2th_q(s[_].getAttribute("href"));if(pref[cataLog.embed_mode].link_show_op&&0===d.search(c)&&d.indexOf("(OP)")==-1&&(s[_].textContent+=" (OP)"),pref[cataLog.embed_mode].link_show_cross&&u&&u[0]!=a&&(s[_].textContent+=" →"),u){p[p.length]=[u[0],u[1]];var f=u[2][0]!==e.domain?e.key:u[2][1]!==e.board?e.board+e.no:u[2][2]!=e.no?e.no:null;site2[e.domain_html].popups_add_backlink(u[0],u[1],null!==f?f+"#"+t.no:t.no,e,r,o)}}}this.popups_set(a,t.no,t,p&&0!=p.length&&p)},popups_add_backlink:function(e,t,n,a,r,o){if(void 0===e[t])e[t]=[n],r&&this.popups_set_waiting(e,t);else if(Array.isArray(e[t]))e[t].indexOf(n)==-1&&(e[t][e[t].length]=n,r&&this.popups_set_waiting(e,t));else{e[t].backlinks||(e[t].backlinks=[]);var s=e[t].backlinks;s.indexOf(n)==-1&&(s[s.length]=n,e[t].pn&&(!pref[cataLog.embed_mode].backlink||pref[cataLog.embed_mode].env.backlink_native&&o||site2[a.domain_html].add_backlinks(e[t].pn,s,s.length-1,a)))}},add_backlinks:function(e,t,n,a){var r=this.add_backlinks_bks_query(e),o=r||this.add_backlinks_bks();n||(o.innerHTML="");for(var s=n||0;s<t.length&&(this.add_backlinks_add_1(o,this.popups_backlink2dbtpth(t[s],a)),!n);s++);r||this.add_backlinks_bks_append(e,o)},popups_backlink2dbtpth:function(e,t){var n,a="number"==typeof e?[t.domain,t.board,t.no,e,">>"+e]:(n=e.split(/[\/#]/),2==n.length?[t.domain,t.board,n[0],n[1],">>"+(pref.proto.bl_ec?n[0]+"#":"")+n[1]]:[n[0]||t.domain,"/"+n[1]+"/",n[2],n[3],(n[0]?">>>>"+n[0]:">>>")+"/"+n[1]+"/"+(pref.proto.bl_ec?n[2]+"#":"")+n[3]]);return a[5]=site2[a[0]].link_dbtp2href_abs(a),a},remove_backlink:function(e,t){},popups_remove_backlink:function(e,t,n){if(e[t]){var a=Array.isArray(e[t])?e[t]:e[t].backlinks,r=a.indexOf(n);r>=0&&(a.splice(r,1),e.no===t&&pref.proto.bl_rm&&e[t]&&this.remove_backlink(e[t].pn,r))}},popups_set:function(e,t,n,a){t<=2&&(Object.hasOwnProperty.call(e,t)||(e[t]=void 0)),void 0===e[t]?n.backlinks&&(n.backlinks=void 0):Array.isArray(e[t])?n.backlinks=e[t]:e[t].backlinks&&(n.backlinks=e[t].backlinks),e[t]=n,a&&(e[t].quotes=a),n.editing&&this.popups_set_waiting(e,t),this.popups_remove_waiting(e,t)},popups_release:function(e,t){function n(e,t){if(e.no!=t&&e.q&&e.q[t]){var n=Array.isArray(e.q[t])?e.q[t]:e.q[t].backlinks;if(!n||0===n.length){this.popups_remove_waiting(e.q,t),r[o++]=[e,t];var a=e.q&&e.q[t]&&e.q[t].quotes;if(a)for(var s=a.length-1;s>=0;s--)r[o++]=[e,t,a[s]]}}}function a(e){var t=Object.keys(e.q);return t.length-(t.indexOf("waiting")==-1?0:1)}var r=[],o=0;if(pref.debug_mode[12])var s={no:t,lth:e,len:a(e)};for(n.call(this,e,t);--o>=0;){var i=r[o];if(e=i[0],t=i[1],3==i.length){var l=i[2][0],c=i[2][1],p=l.domain!==e.domain?e.key:l.board!==e.board?e.board+e.no:l.no!=e.no?e.no:null;this.popups_remove_backlink(l,c,null!==p?p+"#"+t:parseInt(t,10)),n.call(this,Object.getPrototypeOf(l),c)}else delete e.q[t]}if(pref.debug_mode[12]){var _=a(s.lth);_!==s.len&&console.log("popups_release: "+s.lth.key+": "+_+" <- "+s.len+", "+s.no+(pref.debug_mode[10]?"    "+this.popups_debug(e.q):""))}},popups_set_waiting:function(e,t){if(e.waiting){for(var n=0;n<e.waiting.length&&e.waiting[n]<t;)n++;e.waiting[n]!=t&&e.waiting.splice(n,0,t)}else e.waiting=[t]},popups_remove_waiting:function(e,t){if(e.waiting){var n=e.waiting.indexOf(t);n!=-1&&(e.waiting.splice(n,1),0===e.waiting.length&&delete e.waiting)}},popups_fetched:function(e,t,n){n||(n=0);for(var a=e.posts.length-1,r=t.q.waiting.length-1;r>=0;r--){for(var o=t.q.waiting[r];a>n&&o<e.posts[a].no;)a--;o===e.posts[a].no?this.popups_fetched_1(e,t,o,e.posts[a]):"thread"===e.type_source&&(pref.test_mode[64],this.popups_set(t.q,o,{time:0,com:"DELETED"})),this.popups_posts.pop_load(e.key+"#"+e.posts[a].no,e.domain)}},popups_fetched_1:function(e,t,n,a){site2[e.domain].wrap_to_parse.posts({posts:[a],__proto__:e}),cataLog.format_html.prepare_html_post(e,a),this.popups_add_1(e,a,!1,t.q,!1)},popups_try_fetch_from_lth_ta:function(e,t,n){if(e.ta)for(var a=e.ta.posts.length-1;a>=0;a--)if(e.ta.posts[a].no==t){var r=e.ta.posts[a],n={domain_html:n.domain_html,lth:e,type_data:r.type_data||(r.pn?"html":"json"),posts:[r],__proto__:e};return void this.popups_fetched_1(n,e,t,r)}},popups_fetched_html:function(e,t){var n={domain:t.domain,board:t.board,domain_html:t.domain_html,parse_funcs:t.parse_funcs};if(e.extra_files)for(var a=0;a<e.extra_files.length;a++)for(var r in n)e.extra_files[a][r]=n[r];for(var r in n)e[r]=n[r];e.parse_funcs.filename&&(e.filename=e.parse_funcs.filename(e));e.time;return e.sub,e.com,e.name,e.no,e.op_img_url,e.type_data=t.type_data,e},backlink:function(e,t,n){var a=t?Array.isArray(t)?t:t.backlinks:null;a&&this.add_backlinks(e,a,void 0,n)},popups_debug:function(e){if(!e)return"";for(var t=Object.keys(e),n=t.length+", "+e.key+": ",a=0;a<t.length;a++){var r=t[a];n+=r+":"+(Array.isArray(e[r])?e[r]:e[r].backlinks||e[r].remove_if_no_backlinks||"P")+", "}return n},toplevel_anchor_pos:1,toplevel_anchor:function(e,t){for(var n=e.getElementsByTagName("a"),a=this.toplevel_anchor_pos,r=[t.domain,t.board,t.no,null],o=0;o<n.length;o++){var s=n[o].getAttribute("href");s&&"#"===s[0]&&(r[3]=s.substr(a),n[o].setAttribute("href",this.link_dbtp2href(r)))}},wrap_to_parse:function(){function e(){return pref.debug_mode.parse_error?site4.parse_funcs_on_demand_debug:site4.parse_funcs_on_demand}function t(t,n,r){var o=r.substr(0,r.indexOf("_")),s=r.substr(r.indexOf("_")+1),i=a[o]+a[s]+(pref.debug_mode.parse_error?"_debug":""),l=liveTag.mems.init({domain:t,board:n}).p[i];if(!l){var c=liveTag.mems[t].p,l=c[i];if(!l){var p=site2[t].parse_funcs[r+"_template"]||site2[t].parse_funcs[s+"_template"]||e(),_=pref.catalog.mimic_base_site||site2[t].mimic_always?site.nickname:t;c[i]={domain:t,parse_funcs:site2[t].parse_funcs[r],parse_funcs_html:site2[_].parse_funcs[o+"_html"],type_parse:r,type_source:o,type_data:s,type_html:o,domain_html:_,__proto__:p},l=c[i]}liveTag.mems[t][n].p[i]={board:n,__proto__:l},l=liveTag.mems[t][n].p[i]}return l}var n=/[A-z]/,a={catalog:"c",page:"i",thread:"t",post:"p",shortCatalog:"b",shortThread:"s",html:"h",json:"j"};return{get_getters:e,prep_pfunc:t,get:function(e,a,r,o,s){var i=t(a,r,o);return s&&(void 0!==s.thread&&n.test(s.thread)&&(s.thread=s.thread.substr(1)),s.__proto__=i,i=s),o.indexOf("_json")==-1?site2[a].parse_funcs[o].ths({pn:e,__proto__:i}):site2[a].parse_funcs[o].ths(e,i)},posts:function(e,n,a){if(void 0===e.type_data){var r=[];if(e.posts)for(var o=0;o<e.posts.length;o++)!e.posts[o].domain&&e.posts.pn&&(r[r.length]=e.posts[o]);0!=r.length&&this.posts({type_data:"html",posts:r,__proto__:e},0,common_func.shallow_copy_1(a)),e={type_data:"json",__proto__:e}}var s=t(e.domain,e.board,"post_"+e.type_data);a&&(a.__proto__=s,s=a);var i=e.localArchive;if(i&&(s={localArchive:i,__proto__:s}),e.posts)for(var o=n||0;o<e.posts.length;o++)if(!e.posts[o].domain||i){if(e.posts[o].extra_files)for(var l=0;l<e.posts[o].extra_files.length;l++)e.posts[o].extra_files.domain||(e.posts[o].extra_files[l].__proto__=s);e.posts[o].__proto__=s}if(e.extra_files&&(!e.extra_files[0].domain||i))for(var l=0;l<e.extra_files.length;l++)e.extra_files[l].__proto__=s}}}(),parse_pn_dummy:document.createElement("div"),parse_funcs:{common:{finisher:function(){},posts:function(){},com:function(){},flags:function(){},flag:function(){},id:function(){},country:function(){},hrefs:function(){},trip:function(){},th_init:null,tn_as:function(e){return e.pn.getElementsByTagName("a")},tn_imgs:function(e){for(var t=[],n=e.pn.getElementsByTagName("a"),a=0;a<n.length;a++){var r=n[a].getElementsByTagName("img")[0];r&&(t[t.length]=r)}return t},key:function(e){return e.domain+e.board+e.no},pn:function(e){return site2[e.domain_html].catalog_json2html3(e,e.board,this.op_img_url(e))},op_img_url:function(e){return site2[e.domain].catalog_json2html3_thumbnail(e,e.board)},
get_op_src:function(e){return e.op_img_url},ths_array:function(e,t){var n=[];if(t)for(var a=t.length-1;a>=0;a--){var r="catalog"===e.type_html?Math.floor(a/15)+"."+a%15:"page"===e.type_html?e.page+"."+a:void 0;n[a]={pn:t[a],page:r,__proto__:e.__proto__}}return n},time:function(e){},time_posted:function(e){},time_unit:1,has_posts:!0,txt:function(e){return site2.DEFAULT.parse_pn_dummy.innerHTML=e.com,site2.DEFAULT.parse_pn_dummy[brwsr.innerText]},type_com:"html",footer_prep:function(e,t){var n=t.innerHTML.replace(/ *R:[0-9 \/]*I:[0-9 \/]*/,"");n=n.replace(/P:[0-9 \/]*/,""),""!==(n=n.replace(/ *\(sticky\) */,""))&&(t.innerHTML="<span></span>"+n,t=t.childNodes[0])},get_lth_from_node:function(e){for(;e&&!e.name;)e=e.parentNode;return e&&liveTag.mems.getFromName(e.name)||null},nativeUpdate2pn:function(e){return e.lastChild}},catalog_html:{posts:function(e){return[{pn:e.pn,__proto__:e.__proto__}]},time:function(e){return e.time_created},posts_full:function(){var e={posts:null,pn:null,flag:null,flags:null,footer:null,pn_name:null,ths:null,page:null,tn_as:null,tn_imgs:null,txt:null,pn_id:null,pn_trip:null,parse_funcs:null,parse_funcs_html:null,type_parse:null,type_source:null,type_data:null,type_html:null,domain:null,board:null,domain_html:null,exe_sub:null,exe_sub2:null};return function(t){for(var n in t)void 0===e[n]&&t.parse_funcs[n]&&Object.defineProperty(t.posts[0],n,{value:t[n],enumerable:!0,configurable:!0,writable:!0})}}(),has_posts:!1,type_com:"txt",filename:function(e){var t=e.op_img_url.replace(/.*\//,""),n=t.indexOf(".");return e.tim=t.substr(0,n),e.tim}},catalog_json:{ths:function(e,t){for(var n=[],a=0;a<e.length;a++)if(e[a].threads)for(var r=0;r<e[a].threads.length;r++)e[a].threads[r].page=a+"."+r,e[a].threads[r].sticky=1===e[a].threads[r].sticky,e[a].threads[r].type_html="catalog",e[a].threads[r].__proto__=t,n[n.length]=e[a].threads[r];return n},posts:function(e){return[{time:e.time,DUMMY:!0}]},posts_full:function(e){delete e.posts[0].DUMMY;for(var t=Object.keys(e),n=0;n<t.length;n++)"posts"!==t[n]&&"pn"!==t[n]&&(e.posts[0][t[n]]=e[t[n]])},has_posts:!1},page_html:{posts_array:function(e,t){var n=[],a=site2[e.domain].wrap_to_parse.prep_pfunc(e.domain,e.board,"post_html");if(pref.test_mode[5])n.pns=t,n.idx0=0,n.idx1=t.length-1,n.get0=this.posts_get0,n.get1=this.posts_get1,n.proto=a,Object.defineProperty(n,n.idx0,{get:n.get0,enumerable:!0,configurable:!0}),Object.defineProperty(n,n.idx1,{get:n.get1,enumerable:!0,configurable:!0});else for(var r=0;r<t.length;r++)n[n.length]={pn:t[r],__proto__:a};return n},posts_get0:function(){var e={pn:this.pns[this.idx0],__proto__:this.proto};return Object.defineProperty(this,this.idx0,{value:e,enumerable:!0,configurable:!0,writable:!0}),++this.idx0<this.idx1&&Object.defineProperty(this,this.idx0,{get:this.get0,enumerable:!0,configurable:!0}),e},posts_get1:function(){var e={pn:this.pns[this.idx1],__proto__:this.proto};return Object.defineProperty(this,this.idx1,{value:e,enumerable:!0,configurable:!0,writable:!0}),--this.idx1>this.idx0&&Object.defineProperty(this,this.idx1,{get:this.get1,enumerable:!0,configurable:!0}),e},posts:function(e){return this.posts_array(e,e.pn.getElementsByClassName("post"))},time_posted:"thread_html",time_bumped:function(e){return e.posts[e.posts.length-1].time},time_created:function(e){return e.posts[0].time},key:function(e){return e.domain+e.board+e.no},insert_footer4:function(e){var t=document.createElement("div");return e.parentNode.insertBefore(t,e)},flags:function(e){var t=[],n=e.posts.length-1,a=pref[cataLog.embed_mode].t2h_num_of_posts-1;if(n<a)for(a=0;a<=n;)e.posts[a]&&(t[a]=e.posts[a].flag),a++;else for(;a>=0;)e.posts[n]&&(t[a--]=e.posts[n--].flag),0==a&&(n=0);return t},html_org:function(e){return e.pn.innerHTML},sticky:function(){return!1},type_com:"txt",replace_omitted_info:function(e,t){e.textContent=t.textContent},replace_omitted_info2:"replace_omitted_info",posts_full:"catalog_html",get_max_page:function(e){var t=e.getElementsByClassName("pages")[0];if(t){t=t.childNodes;for(var n=0,a=0;a<t.length;a++)n+1==t[a].textContent&&n++;return n}}},page_json:{ths:function(e,t){var n=[];if(e&&e.threads)for(var a=0;a<e.threads.length;a++){var r=e.threads[a];r&&(r.page=t.page?t.page+"."+a:void 0,r.key=t.domain+t.board+r.posts[0].no,r.posts[0].__proto__=t,r.__proto__=r.posts[0],n[a]=r)}return n},flags:function(e){if(e.country){var t=e.posts.length-pref[cataLog.embed_mode].t2h_num_of_posts;return[e].concat(e.posts.slice(t<=1?1:t))}}},thread_html:{ths_array:function(e,t){return[{pn:t,__proto__:e.__proto__}]},time_posted:function(e){return e.posts[e.posts.length-1].time},posts_full:"catalog_html",id:function(e){return e.posts[0].id},country:function(e){return e.posts[0].country},trip:function(e){return e.posts[0].trip},flag:function(e){return e.posts[0].flag},name:function(e){return e.posts[0].name},type_com:"txt"},thread_json:{ths:function(e,t){return e.key=t.domain+t.board+e.posts[0].no,e.posts[0].__proto__=t,e.__proto__=e.posts[0],[e]},time_created:function(e){return 1e3*e.posts[0].time},time_bumped:function(e){if(!e.posts[0].bumplimit){for(var t=e.posts.length-1;t>0&&e.posts[t].email&&"sage"===e.posts[t].email;)t--;return 1e3*e.posts[t].time}},time_posted:function(e){return 1e3*e.posts[e.posts.length-1].time},nof_posts:function(e){return e.posts[0].replies+1},nof_files:function(e){return e.posts[0].images+1},has_nof_files:!0,sub:function(e){return e.posts[0].sub||""},name:function(e){return e.posts[0].name||""},com:function(e){return e.posts[0].com||""},sticky:function(e){return 1===e.posts[0].sticky},time_unit:1e3,prep_to_archive:function(e){return{posts:e}},rip_from_archive:function(e){return e.posts||e}},post_html:{sub:function(e){var t=e.pn.getElementsByClassName("subject")[0];return t?t.textContent:""},img2src:function(e){return e.parentNode.href},img2ext:function(e){return e.parentNode.getAttribute("data-ext")}},post_json:{time_unit:1e3,pn:function(e){return site2[e.domain_html].post_json2html(e,e.board)},anchor:function(){},hrefs:function(e){if(e.com){var t=e.com.match(/href="([^"]*)"/g);if(t)for(var n=0;n<t.length;n++){var a=t[n].indexOf("://");t[n]=t[n].slice(a===-1?6:a+1,-1)}return t}}},catalog_json_template:"post_json_template",page_json_template:"post_json_template",thread_json_template:"post_json_template",post_json_template:{sub:"",name:"Anonymous",com:"",sticky:void 0,pn:void 0,no:void 0,time:void 0},html_template:{get id(){return this.exe_sub("id")},get pn_id(){return this.exe_sub("pn_id")},get pn_name(){return this.exe_sub("pn_name")}}},parse_parts:{add_op_img_url:function(e,t,n){for(var a=0;a<e.length;a++)e[a].op_img_url=site2[n].catalog_json2html3_thumbnail(e[a],t)}},update_posts_merge_prep:function(e,t,n,a){if(e){n=n>=0?n+1:(t&&t.length?t.length:0)+e.length,n<e.length&&(e=e.slice(0,1).concat(e.slice(e.length-n+1)));var r=1,o=0,s=[e[0]];if(a)for(;r<e.length&&o<t.length;)e[r].no!==t[o].no?s[s.length]=e[r].no<t[o].no?e[r++]:t[o++]:(s[s.length]=e[r++],o++);else for(;r<e.length&&o<t.length;)s[s.length]=e[r].time*e[r].parse_funcs.time_unit<t[o].time*t[o].parse_funcs.time_unit?e[r++]:t[o++];return s=s.concat(r<e.length?e.slice(r):t.slice(o)),s.length<=n?s:s.slice(0,1).concat(s.slice(s.length-n+1,s.length))}},update_posts_merge_bases:{bases:{},initialized:!1,query:function(e,t,n){var a=e.key;if(this.bases[a])return this.bases[a];var r=t?this.bases[t]:null;return r?(this.bases[a]=r,this.merge_th(e,r),n&&cataLog.catalog_obj2.func_hide_org(a),cataLog.threads[a][0]=r.pn,r):(this.bases[a]=this.base_factory(e,n),this.initialized||this.setup_hook(),this.bases[a])},base_factory:function(){var e={lazy_draw:function(e){e>=this.lazy.length?this.lazy[e]=!0:this.lazy.splice(e,0,!0),this.lazy_idx>e&&(this.lazy_idx=e)},remove:function(e){return this.posts.splice(e,1),e<this.lazy_idx&&this.lazy_idx--,!this.lazy||!this.lazy.splice(e,1)[0]},draw_1_pos:function(e){for(var t=e+1;t<this.lazy.length&&this.lazy[t];)t++;return this.lazy[e]=!1,t},get_class:function(e,t,n){if(!t&&!pref.proto.merge_lv)return null;var a=pref_func.merge_obj5a_sc(e,n?pref3.proto.merge_lv_obj2_old:pref3.proto.merge_lv_obj2,null);return null===a?null:pref.script_prefix+"_merge"+a}};return function(t,n){return site2.DEFAULT.update_posts_merge_bases.class_add_all(t.posts,e.get_class(t.key)),{pn:t.pn,posts:t.posts.slice(),isShown:1,lazy:pref[cataLog.embed_mode].lazyDraw.merge?t.posts.map(function(){return!1}):null,lazy_idx:pref[cataLog.embed_mode].lazyDraw.merge?t.posts.length:null,__proto__:e}}}(),class_add_all:function(e,t){if(t)for(var n=0;n<e.length;n++)e[n].pn&&e[n].pn.parentNode&&e[n].pn.parentNode.classList.add(t)},class_remove_all:function(e,t){if(t)for(var n=0;n<e.length;n++)e[n].pn&&e[n].pn.parentNode&&e[n].pn.parentNode.classList.remove(t)},lazy_draw:null,remove_th:function(e,t){var n=this.bases[e.key];if(n){var a=t?null:site2[e.domain_html].page_json2html3_skelton(e);site2[e.domain_html].update_posts_separate(e,n,a),0==--this.bases[e.key].isShown&&(cataLog.catalog_obj2.func_hide_org(e.key),this.shown.delete(n),cataLog.catalog_obj2.lazy_tgts.delete(n)),delete this.bases[e.key],t||(cataLog.threads[e.key][0]=a,gGEH.pns_all_keys.set(a,e.key))}},merge_th:function(e,t){for(var n=0,a=0;a<e.posts.length;a++)n=site2[e.domain_html].update_posts_merge_1(e,t,a,n);this.bases[e.key].isShown++,t.lazy&&t.lazy_idx<t.posts.length&&this.lazy_tgts.set(t,e.key)},base_arr:function(e,t){return pref_func.merge_obj5a_sc(e,t?pref3.proto.merge_list_obj2_old:pref3.proto.merge_list_obj2,null)},base_tgts:function(e){if(pref[cataLog.embed_mode].merge)return Object.keys(this.bases)[0]||e;if(pref[cataLog.embed_mode].merge_list){var t=this.base_arr(e);if(!t)return null;for(var n in this.bases)if(this.base_arr(n)===t)return n;return e}return null},func_show:function(e,t,n){var a=site2.DEFAULT.update_posts_merge_bases,r=a.bases[e];if(!r){var o=a.base_tgts(e);if(o){var s=cataLog.threads[e];r=a.query({pn:s[0],__proto__:s[16]},o,!1)}}return r?(a.shown.has(r)||cataLog.catalog_obj2.func_show_org(e,t,n),!0):this.func_show_org(e,t,n)},func_hide:function(e){var t=site2.DEFAULT.update_posts_merge_bases;return t.bases[e]?(t.remove_th(cataLog.threads[e][16]),!0):this.func_hide_org(e)},func_search_ref:function(e){var t=site2.DEFAULT.update_posts_merge_bases;return t.bases[e]&&t.shown.get(t.bases[e])!==e},func_track_shown:function(e,t){var n=site2.DEFAULT.update_posts_merge_bases,a=n.bases[e];if(a){if(n.shown.has(a)||(this.func_track_shown_org(e,!pref[cataLog.embed_mode].merge&&t),n.shown.set(a,e)),a.lazy&&a.lazy_idx<a.posts.length&&this.lazy_tgts.set(a,e),pref[cataLog.embed_mode].merge&&t)var r=pref.test_mode[88]?1:pref[cataLog.embed_mode].lazyDraw.merge_step;++this.post_count%r==0&&(this.drawn_y=cataLog.threads[e][16].posts[0].pn.offsetTop)}else this.func_track_shown_org(e,t)},shown:new Map,shownSet:null,isShownForTails:function(e){if(!this.shownSet){this.shownSet=new Set;for(var e of this.shown.values())this.shownSet.add(this.base_arr(e))}return this.shownSet.has(this.base_arr(e))},func_track_reset:function(){var e=site2.DEFAULT.update_posts_merge_bases;e.shown.clear(),e.shownSet=null,this.post_count=0,this.lazy_tgts.clear(),this.func_track_reset_org()},setup_hook:function(){cataLog.catalog_obj2.func_show_org=cataLog.catalog_obj2.func_show,cataLog.catalog_obj2.func_show=this.func_show,cataLog.catalog_obj2.func_hide_org=cataLog.catalog_obj2.func_hide,cataLog.catalog_obj2.func_hide=this.func_hide,cataLog.catalog_obj2.func_track_shown_org=cataLog.catalog_obj2.func_track_shown,cataLog.catalog_obj2.func_track_shown=this.func_track_shown,cataLog.catalog_obj2.func_track_reset_org=cataLog.catalog_obj2.func_track_reset,cataLog.catalog_obj2.func_track_reset=this.func_track_reset,cataLog.catalog_obj2.func_search_ref=cataLog.catalog_obj2.func_search_ref,cataLog.catalog_obj2.post_count=0;var e=new Map;cataLog.catalog_obj2.lazy_tgts=e,this.lazy_tgts=e,this.initialized=!0,cataLog.catalog_obj2.lazy_draw=function(){var t=cataLog.get_ref_height(4);for(var n of e.keys()){var a=n.lazy_idx;if(a>=1&&n.posts[a-1].pn.offsetTop>t)break;for(var r=0,o=pref.test_mode[88]?1:pref[cataLog.embed_mode].lazyDraw.merge_step,s=pref.catalog.mimic_base_site?site.nickname:cataLog.threads[e.get(n)][16].domain_html;a<n.posts.length;){if(n.lazy[a]){for(r<a&&(r=a+1);r<n.lazy.length&&n.lazy[r];)r++;site2[s].update_posts_insert(n.posts,n.posts,a,r,n.pn),n.lazy[a]=!1;var i=n.get_class(n.posts[a].key_op);i&&n.posts[a].pn.parentNode.classList.add(i)}if(!pref.test_mode[111]&&++cataLog.catalog_obj2.post_count%o==0&&n.posts[a].pn.offsetTop>t)break;a++}n.lazy_idx=a,a>=n.posts.length&&e.delete(n)}}},release_hook:function(){},onchange_merge:function(e){var t=site2.DEFAULT.update_posts_merge_bases,n=(e.target.name||e.target.getAttribute("name")).split(".")[1];if("merge_list_str"!==n||pref[cataLog.embed_mode].merge_list){var a="merge"===n?function(){return!0}:"merge_list"===n?function(e){return t.base_arr(e)||t.base_arr(e,!0)}:function(e){var n=t.base_arr(e),a=t.base_arr(e,!0);return n?!a||n.join()!==a.join():a};for(var r in cataLog.threads){var o=cataLog.threads[r];o[1]&&a(r)&&cataLog.catalog_obj2.func_hide(r)&&(o[1]=!1)}pref3.proto.merge_list_obj2_old=null,cataLog.catalog_obj2.func_track_reset(),t.initialized||t.setup_hook(),"merge"===n?(pref[cataLog.embed_mode].merge&&(pref3.catalog.indexing_old=pref.catalog.indexing),cataLog.components.catalog.indexing.onfocus(),pref.catalog.indexing=pref[cataLog.embed_mode].merge?7:pref3.catalog.indexing_old,pref_func.apply_prep(cataLog.components.catalog.indexing,!1,!0),cataLog.components.catalog.indexing.onblur(),cataLog.components.catalog.indexing.disabled=pref[cataLog.embed_mode].merge):cataLog.show_catalog()}},onchange_lv:function(e){if(pref[cataLog.embed_mode].merge||pref[cataLog.embed_mode].merge_list){var t=(e.target.name||e.target.getAttribute("name")).split(".")[1];if("merge_lv_str"!==t||pref[cataLog.embed_mode].merge_lv){var n=site2.DEFAULT.update_posts_merge_bases;for(var a in cataLog.threads)if(cataLog.threads[a][1]){var r=n.bases[a];if(r){var o=r.get_class(a),s=r.get_class(a,!0,!0);if("merge_lv"===t||o!=s){var i=cataLog.threads[a][16].posts;"merge_lv"===t&&pref[cataLog.embed_mode].merge_lv||n.class_remove_all(i,s),("merge_lv"!==t||pref[cataLog.embed_mode].merge_lv)&&n.class_add_all(i,o)}}}pref3.proto.merge_lv_obj2_old=null}}}},update_posts_replace_prep:function(e,t,n){if(!e||e.length<=1)return n<0||t.length<=n+1?t:0==n?t.slice(0,1):t.slice(0,1).concat(t.slice(-n));if((n=n>=0?n+1:t.length+e.length-1)==e.length)return e;if(n<e.length)return e.slice(0,1).concat(e.slice(e.length-n+1));for(var a=e[1].no,r=1;r<t.length&&t[r].no<a;)r++;if(1===r)return e;var o=r>n-e.length?r-(n-e.length):1;return e.slice(0,1).concat(t.slice(o,r),e.slice(1))},update_posts0_class:function(e,t){t?e.classList.remove("CatChan_search_miss"):e.classList.add("CatChan_search_miss")},update_posts_replace:function(e,t,n,a,r,o){if(a&&(n=a.pn,r=a.isShown),t.posts){var s=t.parse_funcs_html.get_omitted_info(t.posts[0]),i=e.posts[0].pn?e.parse_funcs_html.get_omitted_info(e.posts[0]):site2[e.domain_html].page_json2html3_add_omitted_info(e,null,e.posts);s?t.parse_funcs_html.replace_omitted_info2(s,i,e):i&&t.parse_funcs_html.set_omitted_info(t.posts[0],i);for(var l=-1,c=e.posts.length-1,p=null,_=t.posts.length-1;_>=1;_--){for(;c>1&&e.posts[c].no>t.posts[_].no;)c--;var d=t.posts[_].editing&&t.posts[_].pn&&t.posts[_]!==e.posts[c];(e.posts[c].no!=t.posts[_].no||d)&&(l=this.update_posts_remove_1(t,_,n,r,a,l)),d&&(p?p[p.length]=e.posts[c]:p=[e.posts[c]])}}this.update_posts_add(e,t,n,a,r,o,p)},update_posts_add:function(e,t,n,a,r,o,s){if(t.posts&&e.posts)for(var i=liveTag.mems[e.domain][e.board][e.no].q,l=(a&&e.parse_funcs.time_unit,-1),c=a?0:1,p=a?0:1;p<e.posts.length;p++){for(;c<t.posts.length&&e.posts[p].no>t.posts[c].no;)c++;if(c>=t.posts.length||e.posts[p].no!=t.posts[c].no){var _=s&&s.indexOf(e.posts[p])!=-1,i=_?liveTag.mems[e.domain][e.board][e.no].q:null;cataLog.format_html.prepare_html_post(e,e.posts[p]),_&&(this.popups_add_1(e,e.posts[p],!1,i,!0),pref[cataLog.embed_mode].backlink&&i[e.posts[p].no].backlinks&&site2[e.domain_html].add_backlinks(e.posts[p].pn,i[e.posts[p].no].backlinks,void 0,e)),a?l=this.update_posts_merge_1(e,a,p,l):this.update_posts_insert(e.posts,t.posts,p,c,n),c<t.posts.length?t.posts.splice(c,0,e.posts[p]):t.posts[t.posts.length]=e.posts[p],o[o.length]=e.posts[p]}c<t.posts.length&&c++}},update_posts_remove_1:function(e,t,n,a,r,o){var s=e.posts[t];return a&&pref[cataLog.embed_mode].scroll_lock&&cataLog.show_catalog_scroll_lock.modified(s),r?(o=o==-1?r.posts.indexOf(s):r.posts.lastIndexOf(s,o),o==-1&&(o=r.posts.lastIndexOf(s)),o>=0&&r.remove(o)&&this.update_posts_remove(e,t,n)):s.pn&&this.update_posts_remove(e,t,n),e.posts.splice(t,1),o},update_posts_merge_1:function(e,t,n,a){var r=e.posts[n].time_tu;for(a==-1&&(a=t.posts.length-1);a>0&&t.posts[a].time_tu>=r;)a--;for(;a<t.posts.length&&(t.posts[a].time_tu<r||t.posts[a].time_tu==r&&t.posts[a].no<=e.posts[n].no);)a++;if(t.lazy&&t.lazy_draw(a),!t.lazy||!pref.test_mode[89]&&0==n){this.update_posts_insert(e.posts,t.posts,n,t.lazy?t.draw_1_pos(a)-1:a,t.pn);var o=t.get_class(e.key);o&&e.posts[n].pn.parentNode.classList.add(o)}return a<t.posts.length?t.posts.splice(a,0,e.posts[n]):t.posts[t.posts.length]=e.posts[n],a},update_posts_separate:function(e,t,n){for(var a=t.get_class(e.key,!0),r=0,o=0;o<e.posts.length;o++){var s=e.posts[o];r=t.posts.indexOf(s,r),r==-1&&(r=t.posts.indexOf(s));var i=r!=-1&&t.remove(r);t.isShown&&pref[cataLog.embed_mode].scroll_lock&&cataLog.show_catalog_scroll_lock.modified(s),a&&s.pn.parentNode&&s.pn.parentNode.classList.remove(a),n?this.update_posts_insert(e.posts,[],o,o,n):i&&this.update_posts_remove(e,o,t.pn)}},short_link:function(){return""},page_json2html3_replace_expander:function(){},page_json2html3_add_omitted_info:function(){},post_json2html_fname_server:function(e){return e.tim+e.ext},post_json2html_fname:function(e){return e.filename+e.ext},post_com2txt_finisher:function(){var e=document.createElement("div");return function(t,n){return t.search(/&[#\w\d]+;/)==-1?t:(pref.debug_mode[17]&&console.log("not interpreted html: "+t),e.innerHTML=n&&n.com,e.textContent)}}(),post_com2txt:function(e){return e.com?this.post_com2txt_finisher(e.com.replace(/<[^>]*>/g," ").replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&amp;/g,"&"),e):""},patch:{},post_pn2ce:function(e){return"BLOCKQUOTE"===e.lastChild.tagName?e.lastChild:e.getElementsByTagName("blockquote")[0]}},site2.common={absorb_children:function(e){for(var t=document.createElement("div");0!=e.childNodes.length;)t.appendChild(e.childNodes[0]);return e.appendChild(t),t},disgorge_children:function(e){for(;0!=e.childNodes.length;)e.parentNode.appendChild(e.childNodes[0]);e.parentNode.removeChild(e)},remove_by_classname:function(e,t,n,a){void 0===n&&(n=0);for(var r=e.getElementsByClassName(t),o=r.length-1-n;o>=0;o--)a&&r[o].nextSibling&&"BR"===r[o].nextSibling.tagName&&r[o].parentNode.removeChild(r[o].nextSibling),r[o].parentNode.removeChild(r[o])},remove_by_tagname:function(e,t,n){void 0===n&&(n=0);for(var a=e.getElementsByTagName(t),r=a.length-1-n;r>=0;r--)a[r].parentNode.removeChild(a[r])},remove_by_attribute:function(e,t,n){for(var a=e.length-1;a>=0;a--)for(var r=e[a].childNodes.length-1;r>=0;r--)e[a].childNodes[r].getAttribute&&e[a].childNodes[r].getAttribute(t)&&e[a].childNodes[r].getAttribute(t).search(n)!=-1&&e[a].removeChild(e[a].childNodes[r])},remove_attribute:function(e,t){for(var n=e.getElementsByTagName("*"),a=n.length-1;a>=0;a--)n[a].getAttribute&&n[a].getAttribute(t)&&n[a].removeAttribute(t)},add_attribute_by_classname:function(e,t,n,a){for(var r=e.getElementsByClassName(t),o=r.length-1;o>=0;o--)r[o].setAttribute(n,a)},add_attribute_by_tagname:function(e,t,n,a){for(var r=e.getElementsByTagName(t),o=r.length-1;o>=0;o--)r[o].setAttribute(n,a)},add_attribute_by_attribute:function(e,t,n,a,r){for(var o=e.length-1;o>=0;o--)for(var s=e[o].childNodes.length-1;s>=0;s--)e[o].childNodes[s].getAttribute&&e[o].childNodes[s].getAttribute(t)&&e[o].childNodes[s].getAttribute(t).search(n)!=-1&&e[o].setAttribute(a,r)},move_up_and_delete_parent:function(e){for(var t=0;t<e.length;t++){var n=e[t].parentNode,a=n.parentNode;a.insertBefore(e[t],n),a.removeChild(n)}},remove_last_hrs_and_brs:function(e){for(;;){var t=e.childNodes[e.childNodes.length-1];if("HR"!==t.tagName&&"BR"!==t.tagName)break;e.removeChild(t)}},remove_brs:function(e){for(var t=e.getElementsByTagName("br"),n=t.length-1;n>=0;n--)t[n].parentNode.removeChild(t[n])},remove_double_br:function(e){for(var t=e.getElementsByTagName("*"),n=t.length-2;n>=0;n--)"<br>"===t[n].outerHTML&&t[n].nextSibling&&"BR"===t[n].nextSibling.tagName&&t[n].parentNode.removeChild(t[n].nextSibling)},remove_double_tags:function(e,t){for(var n=e.getElementsByTagName("*"),a=n.length-2;a>=0;a--)n[a].tagName===t&&n[a+1].tagName===t&&n[a+1].parentNode.removeChild(n[a+1])},change_utc_to_local:function(e){var t=new Date(e);return t.toLocaleString().replace(/\ /," ("+t.toString().replace(/\ .*/,"")+") ")}};var site4={parse_funcs_getters:{get no(){return this.exe_sub("no")},get key(){return this.exe_sub("key")},get time_bumped(){return this.exe_sub("time_bumped")},get nof_posts(){return this.exe_sub("nof_posts")},get nof_files(){return this.exe_sub("nof_files")},get time_created(){return this.exe_sub("time_created")},get posts(){return this.exe_sub("posts")},get sub(){return this.exe_sub("sub")},get name(){return this.exe_sub("name")},get com(){return this.exe_sub("com")},get flag(){return this.exe_sub("flag")},get flags(){return this.exe_sub("flags")},get footer(){return this.exe_sub("footer")},get sticky(){return this.exe_sub("sticky")},get pn(){return this.exe_sub("pn")},get time(){return this.exe_sub("time")},get time_posted(){return this.exe_sub("time_posted")},get tn_as(){return this.exe_sub2("tn_as")},get tn_imgs(){return this.exe_sub2("tn_imgs")},get op_img_url(){return this.exe_sub("op_img_url")},get txt(){return this.exe_sub("txt")},get time_tu(){return this.time*this.parse_funcs.time_unit},get lth(){return liveTag.mems[this.domain][this.board][this.no]},get type_mimic(){return this.type_parse},get key_op(){return this.domain+this.board+(this.resto||this.op||this.no)}},parse_funcs_on_demand:{},parse_funcs_on_demand_debug:{},parse_funcs_no_cache:{},parse_funcs_one_time:{}};site4.parse_funcs_on_demand={exe_sub:function(e){return Object.defineProperty(this,e,{value:this.parse_funcs[e](this),enumerable:!0,configurable:!0,writable:!0})[e]},exe_sub2:function(e){return this.parse_funcs_html[e](this)},__proto__:site4.parse_funcs_getters},site4.parse_funcs_on_demand_debug={exe_sub:function(e){try{return Object.defineProperty(this,e,{value:this.parse_funcs[e](this),enumerable:!0,configurable:!0,writable:!0})[e]}catch(t){console.log("parse_error: "+this.key+", "+this.type_parse+", "+e),console.trace(),console.log(this)}},exe_sub2:function(e){try{return this.parse_funcs_html[e](this)}catch(t){console.log("parse_error: "+this.key+", "+this.type_parse+", "+e),console.trace(),console.log(this)}},__proto__:site4.parse_funcs_getters},site4.parse_funcs_no_cache={exe_sub:function(e){return this.parse_funcs[e](this)},exe_sub2:function(e){return this.parse_funcs_html[e](this)},__proto__:site4.parse_funcs_getters},site4.parse_funcs_one_time={get posts(){return Object.defineProperty(this,"posts",{value:this.parse_funcs.posts(this),enumerable:!0,configurable:!0,writable:!0}).posts},exe_sub:function(e){return this.parse_funcs[e](this)},exe_sub2:function(e){return this.parse_funcs_html[e](this)},__proto__:site4.parse_funcs_getters},pref.features.domains["8chan"]&&(site2["8chan"]={nickname:"8chan",domain_url:"8ch.net",domain_url_image:"media.8ch.net",home:site.protocol+"//8ch.net"+(brwsr.ff?"/faq.html":"/favicon.ico"),protocol:site.protocol,features:{uip_tracker:!0},utilize_boards_json:!0,check_func:function(){var e=window.location.href;if(e.search(/8chan.co|8ch.net/)!=-1){if(site2["8chan"].domain_url=e.search(/8ch.net/)!=-1?"8ch.net":"8chan.co",this.home=site.protocol+"//"+this.domain_url+this.home.substr(this.home.lastIndexOf("/")),site.whereami=document.title.indexOf("404 - Page Not Found")!=-1?"404":e.search(/8ch\.net\/?$/)!=-1?"frame":e.search(/catalog\.html/)!=-1?"catalog":e.search(/res\/[0-9\+]*\.html/)!=-1?"thread":e.search(/8ch\.net\/index/)!=-1?"boards":e.search(/\/$|(index|[0-9]+)\.html|\/#all$/)!=-1?"page":e.search(/boards.html/)!=-1?"boards":"other",site.config(site2["8chan"].domain_url,"8chan"),site.header_height=function(){var e=document.getElementsByClassName("boardlist")[0];return e?e.offsetHeight:0},site.postform=document.getElementsByTagName("form")[0],site.postform&&this.postform_prep(),site.max_page=site2["8chan"].max_page(site.board),site.catalog=e.search(/catalog\.html/)!=-1,site.embed_to="thread"===site.whereami||"page"===site.whereami?{top:function(){return document.getElementsByName("postcontrols")[0]},bottom:function(){return document.getElementsByClassName("boardlist bottom")[0]}}:"catalog"===site.whereami?{top:function(){return document.getElementsByClassName("thumbnail")[0].nextSibling},bottom:function(){return document.getElementsByTagName("footer")[0]}}:{},site.components.boardlist&&(site.components.boardlist.style.zIndex=0),"boards"===site.whereami){var t=document.getElementById("search-form"),n=t.parentNode.insertBefore(document.createElement("button"),t);n.textContent="TagSearch",n.onclick=pref_func.settings.onchange_funcs["tag.scan"]}return!0}return brwsr.ff||(this.protocol="https:",this.home=this.protocol+"//"+this.domain_url+this.home.substr(this.home.lastIndexOf("/"))),!1},postprocess_board:function(e){for(var t=0;t<e.length;t++)if(e[t].max>0){var n=liveTag.mems.init({domain:this.nickname,board:"/"+e[t].uri+"/"});n.o=t,e[t].pages&&!n.pgs&&(n.pgs=e[t].pages),Object.defineProperty(n,"max",{value:parseInt(e[t].max,10),writable:!0}),void 0===n.read_max&&Object.defineProperty(n,"read_max",{value:0,writable:!0}),e[t].tags&&0!=e[t].tags.length&&liveTag.postprocess_board_add_btag(e[t].tags,n)}},catalog_frame_prep:function(e){document.getElementsByTagName("header")[0].style.display="none",document.getElementsByClassName("footer")[0].style.display="none";var t=document.getElementsByClassName("menuCol")[0];t.firstChild.style.display="none";var n=document.getElementsByClassName("bodyCol")[0];n.firstChild.style.display="none",t.insertBefore(e,t.firstChild);this.catalog_native_frame_prep_frame(n,n.firstChild);this.catalog_embed_prep(e)},prep_own_posts_event:function(e){e&&"own_posts"===e.key&&site2["8chan"].prep_own_posts(),"8chan"===window.name&&send_message("parent",["OWN_POSTS",window.name,site3[window.name].own_posts])},prep_own_posts:function(){var e={},t=JSON.parse(localStorage.getItem("own_posts"));for(var n in t){var a="/"+n+"/";e[a]={};for(var r=0;r<t[n].length;r++)e[a][t[n][r]]=null}site3["8chan"].own_posts=e},preprocess_doc2:{thread_html:function(e){for(var t=e.getElementsByTagName("head")[0];t.firstChild;)t.removeChild(t.firstChild);for(var n=e.getElementsByTagName("body")[0],a=n.childNodes.length-1;a>=0;a--)"postcontrols"!==n.childNodes[a].name&&n.removeChild(n.childNodes[a])}},parse_funcs:{catalog_html:{before_test:["ths",":ITER",":ALL","ths",["key","time_bumped","nof_posts","nof_files"]],after_test:["time_created","sub","name","com","footer","sticky","format"],full_hier:["ths",":ITER",":ALL","ths",["key","time_bumped","nof_posts","nof_files","time_created","sub","name","com","footer","sticky","format"]],ths:function(e){var t=e.pn.getElementsByClassName("mix"),n=[];if(pref.test_mode[0])for(var a=0;a<t.length;a++)"DIV"===t[a].tagName&&(n[n.length]={pn:t[a],page:Math.floor(a/15)+"."+a%15});else{for(var a=0;a<t.length;a++)"DIV"===t[a].tagName&&(n[n.length]=t[a]);n=this.ths_array(e,n)}return n},th_init:function(e){var t=e.pn.getElementsByTagName("div")[0];t.className=t.className.replace(/grid\-size\-[a-z]*/,"grid-size-"+site2["8chan"].catalog_native_size)},no:function(e){return parseInt(e.pn.getAttribute("data-id"),10)},sticky:function(e){return"true"===e.pn.getAttribute("data-sticky")},posts:"DEFAULT.catalog_html",proto:"vichan.catalog_html"},catalog_json:{get_op_src:"thread_json",proto:"vichan.catalog_json"},page_html:{ths:function(e){var t=this.ths_array(e,e.pn.getElementsByClassName("thread"));if("page"!==site.whereami||!pref.catalog.embed_page)for(var n=0;n<t.length;n++)t[n].pn.removeAttribute("class");return t},pn:"page_json",filename:"thread_html",proto:"vichan.page_html"},page_json:{has_posts:!0,proto:"vichan.page_json"},thread_html:{filename:function(e){var t=[],n=(e.pn.classList.contains("op")?e.pn.parentNode:e.pn).getElementsByClassName("files")[0];if(n)for(var a=n.getElementsByClassName("postfilename"),r=0;r<a.length;r++)t[r]=a[r].textContent;if(t.length>1){e.extra_files=[];for(var r=1;r<t.length;r++)e.extra_files[r-1]={filename:t[r],__proto__:e.__proto__}}return t[0]},get_op_src:"thread_json",proto:"vichan.thread_html"},thread_json:{get_op_src:function(e){return e.op_img_url.replace("thumb","src").replace(".jpg",e.ext)},proto:"vichan.thread_json"}},update_posts_remove:function(e,t,n){n.removeChild(e.posts[t].pn.nextSibling),n.removeChild(e.posts[t].pn)},update_posts_insert:function(e,t,n,a,r){var o=1==a?t[0].pn.nextSibling||null:a<t.length?t[a].pn.nextSibling&&t[a].pn.nextSibling.nextSibling||null:null;e[n].pn||(e[n].pn=this.post_json2html(e[n],e[n].board)),r.insertBefore(e[n].pn,o),r.insertBefore(document.createElement("br"),o)},catalog_json2html3_thumbnail:function(e,t){return".jpg"===e.ext||".png"===e.ext||".jpeg"===e.ext||".gif"===e.ext||".webm"===e.ext||".mp4"===e.ext?this.protocol+"//"+(64!=e.tim.length?this.domain_url+t+"thumb/"+e.tim+(".gif"===e.ext?".gif":".jpg"):this.domain_url_image+"/file_store/thumb/"+e.tim+(".gif"===e.ext?".gif":".png"===e.ext?".png":".jpeg"===e.ext?".jpeg":".jpg")):e.embed?("//"==e.embed.slice(0,2)?"https:":"")+e.embed.replace(/.*src="/,"").replace(/".*/,""):".swf"===e.ext?"/static/file.png":""},short_link:function(){return""},favicon:{__proto__:site2.DEFAULT.favicon,none:"/favicon.ico",reply:"png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAQElEQVR42mNgGEbg/5n/GJgYORQFDQ0IjK4BmxxWzehsQnJYBdFtxCWH1QBcrkKWw2sAWS6gKAwojgWqpIORDQBVkjfW5KYpFQAAAABJRU5ErkJggg==",reply_to_me:"png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAWUlEQVR42mNgAIH/Z/4zNDRgYpA4UQBqADIYZAaAaHRMtAEwjB42cEPQFaCzCclhFcQWK9jk0A1A8QJW2xgYiDeAJBdQFAbYAhLdRryxgByVuOKaYDoY2QAAcHCIXLRHYMUAAAAASUVORK5CYII="},proto:"vichan"},site2["8chan_live"]={parse_funcs:{thread_html:{posts:function(e){return this.posts_array(e,e.pn.querySelectorAll(":scope>.post.reply"))},proto:"8chan.thread_html"}},proto:"8chan"}),(pref.features.domains["8chan"]||pref.features.domains.lain||pref.features.domains.lainjp)&&(site2.vichan={components:{boardlist:".boardlist",postform_comment:['textarea[name="body"]',0],postform_comment2:['textarea[name="body"]',1],postform_submit:['input[name="post"]',0],postform_submit2:['input[name="post"]',1]},general_event_handler:function(){var e={thread:{get_mark:function(e,t){for(;e&&e!==cataLog.parent;)if("BR"!==e.tagName&&e.classList){if(e.classList.contains("post"))return e;if(e.classList.contains("postcontainer"))return e.getElementsByClassName("post")[0];if(e.parentNode&&e.parentNode.id&&e.parentNode.id.search(/^thread/)!=-1){if(e=e.previousSibling)continue;break}if(e.id&&e.id.search(/^thread/)!=-1)break;e=e.parentNode}else e=e.previousSibling||e.parentNode;return this.get_mark_from_height(t)},get_mark_from_height:function(e){return this.__proto__.get_mark_from_height(e,document.getElementsByClassName("post"))},image_hover_check_mode:function(e){return e.parentNode.parentNode.classList.contains("file")?"page":"catalog"},getID:function(e){return e.classList.contains("poster_id")&&e.textContent},__proto__:site2.DEFAULT.general_event_handler.common}};return e.page={add_mouseover:pref.test_mode[68],mouseover:function(e){var t=e.target
;"A"===t.tagName&&pref[cataLog.embed_mode].popup_truncated&&"toolong"===t.parentNode.className&&site2.DEFAULT.popups_posts.over(e)},__proto__:e.thread},e.catalog=Object.create(e.thread),e}(),boards_sel_from_tags:function(){for(var e=document.getElementsByClassName("board-list-tbody")[0],t="SELECTED_BOARDS,",n=0;n<e.childNodes.length;n++)"none"!==e.childNodes[n].style.display&&(t=t+"8chan"+e.childNodes[n].getElementsByClassName("board-uri")[0].getElementsByTagName("a")[0].getAttribute("href")+",");return t+"\n"},get_next_image:function(e,t){var n=Array.prototype.slice.call(cataLog.parent.getElementsByClassName("post-image")).filter(function(e){return".webm"!==e.src.substr(-5,5)});return site2.DEFAULT.get_next_image(e,t,n)},modify_thread_link:function(e){var t=e.getElementsByClassName("post op");if(0==t.length)return[];var n=[];t=t[0].getElementsByTagName("a");for(var a=t.length-1;a>=0;a--)if("[Reply]"==t[a].innerHTML||"[Last 50 Posts]"==t[a].innerHTML){var r=t[a].getAttribute("href");r&&(n.push([t[a],r]),t[a].removeAttribute("href"))}return n},catalog_threads_in_page:function(e){for(var t={domain:site.nickname,pn:e},n=this.parse_funcs.page_html.ths(t),a=0;a<n.length;a++)n[a]=n[a].pn;return n},remove_posts:function(e,t){site2.common.remove_by_classname(e,"post reply",t,!0)},remove_files_info:function(e){site2.common.remove_by_classname(e,"fileinfo"),site2.common.move_up_and_delete_parent(e.getElementsByClassName("post-image"))},postform_rules:null,thread_keyword:"res",max_page:function(){return 15},make_url4:function(e){var t=this.protocol+"//"+this.domain_url+e[1];return"page_html"===e[3]?[t+(0!=e[2]?parseInt(e[2],10)+1:"index")+".html","html"]:"page_json"===e[3]?[t+parseInt(e[2],10)+".json","json"]:"catalog_json"===e[3]?[t+"catalog.json","json"]:"catalog_html"===e[3]?[t+"catalog.html","html"]:"thread_html"===e[3]?[t+"res/"+e[2]+".html","html"]:"thread_json"===e[3]?[t+"res/"+e[2]+".json","json"]:void 0},url_boards_json:function(){return[site2["8chan"].protocol+"//"+site2["8chan"].domain_url+"/boards.json","json"]},get_ops:function(e){for(var t=e.getElementsByClassName("post op"),n=[],a=0;a<t.length;a++)n.push(parseInt(t[a].id.substring(3),10));return n},get_posts:function(e){for(var t=[],n=e.getElementsByClassName("post_no"),a=0;a<n.length;a++)n[a].id&&t.push(parseInt(n[a].id.substr(8),10));return t},get_post_offsetTop:function(e,t){return e.getElementsByClassName("post")[t].offsetTop},get_icon:function(e,t,n,a){return"sticky"===n?e.getElementsByClassName("fa-thumb-tack")[0]:null},add_icon:function(e,t,n,a){var r,o="sticky"===n?this.make_tack():this.make_showAlways();if("catalog"===t)r=e.getElementsByClassName("threadIcons")[0],r||(r=document.createElement("div"),r.setAttribute("class","threadIcons"),r.setAttribute("style","position:absolute"),e.firstElementChild.insertBefore(r,e.firstElementChild.firstChild)),r.appendChild(o);else{var s=e.getElementsByClassName("op")[0];r=s.getElementsByClassName("mentioned")[0]||s.getElementsByClassName("post_no")[1].nextSibling,r.parentNode.insertBefore(o,r)}return o},favicon:{__proto__:site2.DEFAULT.favicon,none:"/favicon.ico",reply:"png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAQElEQVR42mNgGEbg/5n/GJgYORQFDQ0IjK4BmxxWzehsQnJYBdFtxCWH1QBcrkKWw2sAWS6gKAwojgWqpIORDQBVkjfW5KYpFQAAAABJRU5ErkJggg==",reply_to_me:"png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAWUlEQVR42mNgAIH/Z/4zNDRgYpA4UQBqADIYZAaAaHRMtAEwjB42cEPQFaCzCclhFcQWK9jk0A1A8QJW2xgYiDeAJBdQFAbYAhLdRryxgByVuOKaYDoY2QAAcHCIXLRHYMUAAAAASUVORK5CYII="},time_revised_check:function(e){return e>300},format_thread_layout:function(e){site2.common.add_attribute_by_tagname(e,"img","style","margin:0px"),site2.common.add_attribute_by_tagname(e,"iframe","style","margin:0px"),site2.common.add_attribute_by_classname(e,"post","style","padding:0px"),site2.common.add_attribute_by_classname(e,"intro","style","margin:0px"),site2.common.add_attribute_by_classname(e,"body","style","margin:12px 5px")},format_thread_contents:function(e){site2.common.remove_by_classname(e,"delete"),site2.common.remove_by_classname(e,"omitted")},localtime:function(e){for(var t=e.getElementsByTagName("time"),n=0;n<t.length;n++)t[n].textContent=site2.common.change_utc_to_local(t[n].getAttribute("datetime"))},format_remove_tn_area_size:function(e){for(var t=e.getElementsByClassName("file"),n=0;n<t.length;n++){var a=t[n].getAttribute("style");a&&(a=(a?a+";":"")+"float:left;",a.indexOf("width")!=-1&&(a=a.replace(/width:[^;]*(;|$)/,"")),a.indexOf("height")!=-1&&(a=a.replace(/height:[^;]*(;|$)/,"")),t[n].setAttribute("style",a))}},mark_newer_posts:function(e,t,n,a){return site2.DEFAULT.mark_newer_posts("8chan",e.getElementsByClassName("post"),t,null,n,a)},get_owners_recommendation:function(){if(document.getElementsByClassName("blotter")[0]){or_str=document.getElementsByClassName("blotter")[0][brwsr.innerText];var e="Recommendation: ",t=or_str.indexOf(e);if(t!=-1)return or_str.substr(t+e.length)}return""},get_json_url_catalog:function(e){return site2["8chan"].protocol+"//"+site2["8chan"].domain_url+e+"catalog.json"},thread2search_obj:function(e){function t(e){if(0!=e.length){for(var t=e[0].parentNode;t.classList.contains("post");)t=t.parentNode;for(var n=t.classList.contains("op")?-1:0,a=n>=0?e[0][brwsr.innerText]:"",r="",o=n+1;o<e.length;o++)r=r+e[o][brwsr.innerText]+"\n";return[a,r]}return["",""]}var n=t(e.getElementsByClassName("body")),a=t(e.getElementsByClassName("subject")),r=t(e.getElementsByClassName("name")),o=e.getElementsByClassName("files"),s=["",""];if(0!=o.length){for(var i=0;i<o.length;i++){var l=o[i].getElementsByClassName("unimportant");s[i]="";for(var c=0;c<l.length;c++)0!=l[c].getElementsByTagName("a").length&&(s[i]=s[i]+l[c].getElementsByTagName("a")[0][brwsr.innerText]+"\n"),0!=l[c].getElementsByTagName("span").length&&(s[i]=s[i]+l[c].getElementsByTagName("span")[0][brwsr.innerText]+"\n")}for(var i=2;i<s.length;i++)s[1]=s[1]+s[i]+"\n";o[0].parentNode!=e&&(s[1]=s[0]+"\n"+s[1],s[0]="")}return[n[0],a[0],r[0],s[0],n[1],a[1],r[1],s[1]]},parse_json_thread:function(e,t){for(var n={posts:[]},a={},r=0,o=document.getElementsByClassName("post"),s=0;s<o.length;s++){n.posts[s]={},n.posts[s].no=o[s].id.replace(/op_/,"").replace(/reply_/,"");var i=o[s].getElementsByClassName("poster_id")[0].textContent;n.posts[s].id=i,void 0===a[i]&&(r++,a[i]=1),n.posts[s].unique_ips=r}return n},uip_check:function(e){e(0,200,"")},uip_tgt_post:function(e){var t=document.getElementById("reply_"+e);return t?t:document.getElementById("op_"+e)},uip_post_num:function(e){return e.getElementsByClassName("intro")},catalog_native_prep:function(e,t,n,a,r){var o="catalog"===site.whereami?document.getElementsByClassName("threads")[0]:document.getElementsByName("postcontrols")[0];if(site2.DEFAULT.catalog_native_prep_sel(t,n,"catalog"===site.whereami?document.getElementById("sort_by"):null),"catalog"===site.whereami)n.style.display="inline",n.childNodes[3].style.display="inline";else if("page"===site.whereami){var s=document.getElementsByName("postcontrols")[0];if(!pref.catalog_expand_with_hr||r)for(var i=s.childNodes.length-1;i>=0;i--)"HR"===s.childNodes[i].tagName&&s.removeChild(s.childNodes[i]);else for(var i=s.childNodes.length-1;i>=0;i--)"HR"===s.childNodes[i].tagName&&s.childNodes[i].setAttribute("class",pref.script_prefix+"_hs");s.parentNode.insertBefore(document.createElement("hr"),s.nextSibling)}o.parentNode.insertBefore(n,o)},catalog_native_size:document.getElementById("image_size")?document.getElementById("image_size").value:"small",catalog_native_size_changed:function(){site2["8chan"].catalog_native_size=this.value},catalog_get_native_area:function(){return"catalog"===site.whereami?document.getElementById("Grid"):document.getElementsByName("postcontrols")[0]},parse_funcs:{catalog_html:{ths:function(e){return this.ths_array(e,e.pn.getElementsByClassName("mix"))},no:function(e){return parseInt(e.pn.getElementsByTagName("img")[0].id.substr(4),10)},time_bumped:function(e){return 1e3*parseInt(e.pn.getAttribute("data-bump"),10)},time_created:function(e){return 1e3*parseInt(e.pn.getAttribute("data-time"),10)},nof_posts:function(e){return parseInt(e.pn.getAttribute("data-reply"),10)+1},nof_files:function(e){return parseInt(e.pn.getElementsByTagName("strong")[0].textContent.replace(/.*I: */,""),10)+1},key:function(e){return pref.test_mode[0]&&(e.hasOwnProperty("no")||Object.defineProperty(e,"no",{value:this.no(e),enumerable:!0,configurable:!0,writable:!0})),e.domain+e.board+e.no},sub:"DEFAULT.post_html",name:function(e){return e.pn.getElementsByTagName("img")[0].getAttribute("data-name")},com:function(e){return e.pn.getElementsByClassName("replies")[0].innerHTML.replace(/\s*<strong>[^<]*<\/strong>\s*(<br>)*/,"").replace(/\s*$/,"")},type_com:"html",footer:function(e){return e.pn.getElementsByTagName("strong")[0]},sticky:function(e){return null},op_img_url:function(e){var t=e.pn.getElementsByTagName("img")[0];return t?t.getAttribute("src"):void 0},dynamic_image_hover:!0,missing_info:2,img2src:function(e){var t=this.get_lth_from_node(e);if(!t)return null;var n=e.src;return t.th&&t.th.ext?n=n.replace(/thumb/,"src").replace(/.[^\.]*$/,t.th.ext):t.th.parse_funcs.missing_info&&scan.scan_ui("image_hover",{tgts:[t.domain+t.board+"j0"],options:{callback:function(){cataLog.image_hover_reentry(e)},priority:6}}),n},get_op_src:"thread_json"},catalog_json:{before_test:["ths",":ITER",":ALL","ths",["key","time_bumped","nof_posts","nof_files"]],after_test:["time_created","pn","footer"],full_hier:["ths",":ITER",":ALL","ths",["key","time_bumped","nof_posts","nof_files","pn","footer"]],ths:"DEFAULT.catalog_json",time_bumped:function(e){return 1e3*e.last_modified},time_created:function(e){return 1e3*e.time},nof_posts:function(e){return e.replies+1},nof_files:function(e){return e.images+e.omitted_images},key:function(e){return e.domain+e.board+e.no},sub:function(e){return e.hasOwnProperty("sub")?e.sub:""},name:function(e){return e.hasOwnProperty("name")?e.name:""},com:function(e){return e.hasOwnProperty("com")?e.com:""},op_img_url:"DEFAULT.common",missing_info:1,get_op_src:"thread_json",time_unit:1e3,type_com:"html",posts:"DEFAULT.catalog_json",posts_full:"DEFAULT.catalog_json",get_max_page:function(e){return e.length},proto:"catalog_html"},page_json:{has_posts:!0,nof_posts:"DEFAULT.thread_json",nof_files:function(e){return e.posts[0].images+e.posts[0].omitted_images},ths:"DEFAULT.page_json",proto:"thread_json"},page_html:{before_test:["ths",":ITER",":ALL","ths",["key","time_bumped","nof_posts","nof_files"]],after_test:["time_created",":ITER",":ALL","posts",["sub","name","com","flag"],":ITER",":GALL","posts",["flags","flag"]],before_test_post:["posts",":ITER",":FL","posts",["time"],"html_org","footer"],ths:function(e){return this.ths_array(e,e.pn.querySelectorAll("div[id^=thread_]"))},th_init:function(e){"page"===site.whereami&&pref.catalog.embed_page||e.pn.removeAttribute("class")},no:"post_html",time:function(e){var t=e.pn.getElementsByTagName("time")[0];return t?Date.parse(t.getAttribute("datetime"))/1e3:void 0},time_unit:1e3,time_bumped:function(e){for(var t=e.posts.length;--t>=0;){var n=e.posts[t].pn.getElementsByClassName("email")[0];if(!n||"mailto:sage"!==n.href)return e.posts[t].time}},time_created:function(e){return pref.test_mode[0]&&(e.hasOwnProperty("posts")||this.entry(e,this.before_test_post)),e.posts[0].time},nof_posts:function(e){var t=e.pn.getElementsByClassName("post").length,n=e.pn.getElementsByClassName("fileinfo").length,a=e.pn.getElementsByClassName("omitted")[0];if(a){var r=a.childNodes[0].textContent.replace(/\n/g,"");t+=parseInt(r.replace(/\ post.*/,""),10)||0,n+=parseInt("0"+r.replace(/\ image.*/,"").replace(/[^\ ]*\ /g,""),10)||0}return Object.defineProperty(e,"nof_files",{value:n,enumerable:!0,configurable:!0,writable:!0}),t},nof_files:function(e){return e.hasOwnProperty("nof_posts")||this.nof_posts(e),e.nof_files},key:function(e){return pref.test_mode[0]&&(e.hasOwnProperty("no")||Object.defineProperty(e,"no",{value:this.no(e),enumerable:!0,configurable:!0,writable:!0})),e.domain+e.board+e.no},sub:"DEFAULT.post_html",com:function(e){var t=e.pn.getElementsByClassName("body")[0];return t?t.innerHTML:""},type_com:"html",footer:function(e){return this.insert_footer4(e.pn.getElementsByClassName("post op")[0])},sticky:function(e){return 0!=e.pn.getElementsByClassName("fa-thumb-tack").length},flag:"post_html",op_img_url:function(e){var t=e.pn.getElementsByTagName("img");if(t.length>=2){e.op_img_url2=[];for(var n=1;n<t.length;n++){var a=t[n].getAttribute("src");a&&(e.op_img_url2[e.op_img_url2.length]=a)}}return t&&t[0]?t[0].getAttribute("src"):void 0},tn_as:function(e){return e.tn_imgs},tn_imgs:function(e){var t=[],n=(e.pn.classList.contains("op")?e.pn.parentNode:e.pn).getElementsByClassName("files")[0];if(n){n=n.getElementsByClassName("file");for(var a=0;a<n.length;a++){var r=n[a].getElementsByTagName("img")[0]||n[a].getElementsByTagName("video")[0];r&&(t[t.length]=r)}}return t},get_thread_links:function(e){for(var t=[],n=e.pn.getElementsByClassName("post op")[0].getElementsByTagName("a"),a=0;a<n.length;a++)"[Reply]"===n[a].textContent&&t.unshift(n[a]),"[Last 50 Posts]"===n[a].textContent&&t.push(n[a]),n[a].classList.contains(pref.script_prefix+"_link")&&t.push(n[a]);return t},get_omitted_info:function(e){return e.pn.getElementsByClassName("omitted")[0]},set_omitted_info:function(e,t){e.pn.lastChild.appendChild(t)},replace_omitted_info2:function(e,t){e.childNodes[0].textContent=t?t.childNodes[0].textContent:""},filename:"thread_html",get_op_src:"thread_json",id:"DEFAULT.thread_html",country:"DEFAULT.thread_html",trip:"DEFAULT.thread_html",flag:"DEFAULT.thread_html",name:"DEFAULT.thread_html",pn_name:"post_html"},thread_html:{after_test:["time_created",":ITER",":FLx","posts",["sub","name","com","flag"],":ITER",":GFLx","posts",["flags","flag"]],get_op_src:"thread_json",filename:function(e){var t=(e.pn.classList.contains("op")?e.pn.parentNode:e.pn).getElementsByClassName("files")[0];if(t){t=t.querySelectorAll(":scope>.file");for(var n=0;n<t.length;n++){var a=t[n].getElementsByTagName("a")[0];if(a){a=a.textContent,1===n&&(e.extra_files=[]),n>=1&&(e.extra_files[n-1]={domain:e.domain,board:e.board});var r=0===n?e:e.extra_files[n-1];r.filename="lain"===e.domain?t[n].getElementsByTagName("a")[1].getAttribute("download"):t[n].getElementsByClassName("postfilename")[0].textContent.replace(/\..*/,""),r.ext=a.substr(a.indexOf(".")),r.tim=a.substr(0,a.indexOf("."));var o="lainjp"!==e.domain?t[n].getElementsByClassName("details")[0].textContent.split(","):t[n].getElementsByClassName("unimportant")[0].textContent.split(",");r.w=parseInt(o[1].substr(0,o[1].indexOf("x")),10),r.h=parseInt(o[1].substr(o[1].indexOf("x")+1),10);var s=o[0].split(/\s/);s[1]="KB"===s[1]?1024:"MB"===s[1]?1048576:1,r.fsize=parseFloat(s[0].replace(/\(/,""))*s[1];var i=t[n].querySelector("img.post-image");i&&(r.tn_w=parseInt(i.style.width,10),r.tn_h=parseInt(i.style.height,10))}}}return t?e.filename:void 0},proto:"page_html"},thread_json:{nof_posts:function(e){return e.posts.length},nof_files:function(e){for(var t=0,n=1;n<e.posts.length;n++)e.posts[n].filename&&t++,e.posts[n].extra_files&&(t+=e.posts[n].extra_files.length);return t},add_op_img_url:site2.DEFAULT.parse_parts.add_op_img_url,get_op_src:function(e,t){return!e.ext&&e.parse_funcs.missing_info&&scan.scan_ui("image_hover",{tgts:[e.domain+e.board+"j0"],options:{callback:function(){cataLog.image_hover_reentry(t)},priority:6}}),e.ext?e.op_img_url.replace("thumb","src").replace(".png",e.ext):t.src},pn_name:"post_html",proto:"DEFAULT.thread_json"},post_html:{no:function(e){var t=e.pn.getAttribute("id");return parseInt(t.substring(t.indexOf("_")+1),10)},name:function(e){return e.pn_name?e.pn_name.textContent:""},pn_name:function(e){return e.pn.getElementsByClassName("name")[0]},time_pn:function(e){return Date.parse(e.getElementsByTagName("time")[0].getAttribute("datetime"))},txt2com_spoiler_replace_txt:'<span class="spoiler">$1</span>',flag:function(e){return e.pn.getElementsByClassName("flag")[0]},pn_id:function(e){return e.pn.getElementsByClassName("poster_id")[0]},id:function(e){return e.pn_id?e.pn_id.textContent:void 0},time:"page_html",proto:"DEFAULT.post_html"},post_json:{proto:"DEFAULT.post_json"}},update_posts_remove:function(e,t,n,a){var r=e.posts[t].pn;a&&r.parentNode===n?this.update_posts_insert_pack(r):r=r.parentNode,n.removeChild(r.nextSibling),n.removeChild(r)},update_posts_insert:function(e,t,n,a,r){var o=a<t.length?t[a].pn:null,s=o&&o.parentNode;s&&s!==r&&(o=s),a>=t.length&&(o=r.getElementsByClassName("clear")[0]),e[n].pn||(e[n].pn=this.post_json2html(e[n],e[n].board)),0===n&&this.update_posts_insert_pack(e[n].pn),0===a&&t[0]&&this.update_posts_insert_pack(t[0].pn);var i=0===a&&0===n?e[n].pn:this.post_container(e[n].pn,e[n].no);r.insertBefore(i,o),r.insertBefore(document.createElement("br"),o),0===n&&0===a&&this.update_posts_insert_unpack(e[n].pn)},update_posts0_class:function(e,t){site2.DEFAULT.update_posts0_class(e,t),this.update_posts_insert_pack_iter(e,t?function(e){e.classList.remove("CatChan_search_miss")}:function(e){e.classList.add("CatChan_search_miss")})},update_posts_insert_pack:function(e){this.update_posts_insert_pack_iter(e,function(t){e.insertBefore(t,e.firstChild)})},update_posts_insert_pack_iter:function(e,t){for(var n=e.previousSibling;n;){var a=n.previousSibling;if(n.classList&&(n.classList.contains(pref.script_prefix+"_footer")||n.classList.contains("files"))&&t(n),n.classList&&n.classList.contains("op"))break;n=a}},update_posts_insert_unpack:function(e){for(;;){var t=e.firstChild;if(!t||!t.classList||!t.classList.contains(pref.script_prefix+"_footer")&&!t.classList.contains("files"))break;e.parentNode.insertBefore(t,e)}},add_backlinks_bks:function(){var e=document.createElement("span");return e.setAttribute("class","mentioned unimportant"),function(){return e.cloneNode(!1)}}(),add_backlinks_add_1:function(){var e=document.createElement("a");return e.setAttribute("class","mentioned"),function(t,n){var a=e.cloneNode(!0);a.setAttribute("href",n[5]),a.textContent=n[4],a.onclick=this.backlink_onclick,t.appendChild(a)}}(),add_backlinks_bks_query:function(e){return e.getElementsByClassName("mentioned")[0]},add_backlinks_bks_append:function(e,t){var n=e.getElementsByClassName("post_no")[1],a=n.parentNode;do{n=n.nextSibling}while(n&&"I"===n.tagName);a.insertBefore(t,n)},popups_href2dbtp:function(e){var t=e.split("/"),n=t[t.length-1].substr(t[t.length-1].indexOf("#")+1),a=t[t.length-1].substr(0,t[t.length-1].indexOf("."))||"#"===e[0]&&site.no,r=t.length>=3?"/"+t[t.length-3]+"/":site.board;return[this.nickname,r,a,n]},link_dbtp2href:function(e){return e[1]+"res/"+e[2]+".html#"+e[3]},backlink_onclick:function(){highlightReply.call(this,parseInt(this.textContent.substr(2),10))},colorID:function(e){var t=e.getElementsByClassName("poster_id")[0];if(t){var n=t.textContent,a=parseInt(n.substr(0,2),16),r=parseInt(n.substr(2,2),16),o=parseInt(n.substr(4,2),16),s=a+r+o>384?0:255;t.setAttribute("style","padding: 0px 5px; border-radius: 8px; color: rgb("+s+","+s+","+s+"); background-color: rgb("+a+","+r+","+o+");")}},post_container:function(e,t){var n=document.createElement("div");return n.setAttribute("id","pc"+t),n.setAttribute("class","postcontainer"),n.innerHTML='<div class="sidearrows">&gt;&gt;</div>',n.appendChild(e),n},short_link:function(e,t,n,a,r){var o=common_func.fullname2dbt(e);return t>100?'<a href="'+o[1]+"res/"+o[2]+'+50.html" class="'+pref.script_prefix+'_link">'+a+"50"+r+"</a>":""},post_json2html:function(e,t,n,a){var r=document.createElement("div"),o=e.parse_funcs&&e.parse_funcs.time_unit||1,s=new Date((e.time||0)*o),i='<div class="post '+(n?"op":"reply")+'" id="reply_'+e.no+'" style="border: none"><p class="intro"><input type="checkbox" class="delete" name="delete_'+e.no+'" id="delete_'+e.no+'"><label for="delete_'+e.no+'">'+(e.sub?'<span class="subject">'+e.sub+" </span>":"")+(e.email?'<a class="email" href="mailto:'+e.email+'">':"")+'<span class="name">'+(e.name||"")+"</span>"+(e.trip?'<span class="trip">'+e.trip+"</span>":"")+(e.capcode?'<span class="capcode" style="color:orange;font-weight:bold">## '+e.capcode+"</span>":"")+(e.email?"</a> ":" ")+(e.country?'<img class="flag flag-'+e.country.toLowerCase()+'" src="/static/blank.gif" style="width:16px;height:11px;" alt="'+e.country_name+'" title="'+e.country_name+'"> ':" ")+'<time datetime="'+s.toISOString()+'">'+s.toLocaleString()+"</time></label>"+(e.id?'<span class="poster_id">'+e.id+"</span>":"")+'&nbsp;<a class="post_no" id="post_no_'+e.no+'">No.</a><a class="post_no">'+e.no+"</a>"+(n?'<a href="'+site2[e.domain].make_url4([e.domain,t,e.no,"thread_html"])[0]+'">[Reply]</a>'+(a?a:""):"")+"</p>";if(e.filename){if(i+='<div class="files">'+this.post_json2html_file(e,t,e.extra_files),e.extra_files)for(var l=0;l<e.extra_files.length;l++)i+=this.post_json2html_file(e.extra_files[l],t,!0);i+="</div>"}return i+='<div class="body">'+(e.com?e.com:"")+"</div></div>",r.innerHTML=i,r.childNodes[0]},post_pn2ce:function(e){return"body"===e.lastChild.className?e.lastChild:e.getElementsByClassName("body")[0]},post_json2html_file:function(e,t,n){var a=(.005+(e.fsize>1048576?e.fsize/1048576:e.fsize/1024)).toString();a=a.substr(0,a.indexOf(".")+3)+(e.fsize>1048576?" MB":" KB");var r=site2[e.domain].post_json2html_fname_server(e),o=site2[e.domain].post_json2html_fname(e),s=site2[e.domain].catalog_json2html3_src(e,t),i=site2[e.domain].catalog_json2html3_thumbnail(e,t);return'<div class="file'+(n?" multifile":"")+'"'+(n?' style="width:'+(e.tn_w+40)+'px"':"")+'><p class="fileinfo">File: <a href="'+s+'">'+r+'</a> <span class="details">('+a+", "+e.w+"x"+e.h+', <span class="postfilename">'+o+'</span>) </span></p><a href="'+s+'" target="_blank">'+(".webm"!==e.ext?'<img class="post-image" src="'+i+'" style="width: '+e.tn_w+"px; height: "+e.tn_h+'px; max-width: 98%;" alt=""'+(128===e.tn_w&&128===e.tn_h?"onerror=\"this.onerror=null;this.src='/static/spoiler.png';\"":"")+">":'<video class="post-image" src="'+s+'" style="width: '+e.tn_w+"px; height: "+e.tn_h+'px; max-width: 98%;">')+"</a></div>"},page_json2html3_skelton:function(e,t){var n=document.createElement("div");n.setAttribute("class","thread"),n.setAttribute("id","thread_"+e.no),n.setAttribute("data-board",e.board.slice(1,-1));var a=document.createElement("br");return a.setAttribute("class","clear"),n.appendChild(a),n.appendChild(document.createElement("hr")),t?[n,a]:n},page_json2html3:function(e,t,n,a,r){var o=this.page_json2html3_skelton(e,!0),s=o[0],i=o[1],l=this.post_json2html(e.posts&&e.posts[0]?e.posts[0]:e,e.board,!0,site2[e.domain].short_link(e.key,e.nof_posts,2,"[Last "," Posts]")),c=l.getElementsByClassName("files")[0];if(c&&s.insertBefore(c,i),r&&e.posts[0].pn&&(l=e.posts[0].pn.cloneNode(!0)),l.setAttribute("class","post op"),e.posts&&e.posts[0]&&e.posts[0].extra_files&&l.setAttribute("style","clear:both;"),s.insertBefore(l,i),e.posts[0].pn=l,e.posts){for(var p=1;p<e.posts.length;p++){var _=r&&e.posts[p].pn&&e.posts[p].pn.cloneNode(!0)||this.post_json2html(e.posts[p],e.board);s.insertBefore(this.post_container(_,e.posts[p].no),i),s.insertBefore(document.createElement("br"),i),e.posts[p].pn=_}this.page_json2html3_add_omitted_info(e,e.posts,e.posts)}return s},page_json2html3_replace_expander:function(e,t,n){var a=e[0].pn.getElementsByClassName("omitted")[0];a&&(a.childNodes.length>=3&&a.removeChild(a.childNodes[2]),a.childNodes.length>=2&&a.removeChild(a.childNodes[1]),a.appendChild(cnst.config_expander(n,t)))},page_json2html3_add_omitted_info:function(e,t,n){for(var a=0,r=1;r<n.length;r++)a+="html"===n[r].type_data?n[r].pn.getElementsByClassName("file").length:n[r].filename?n[r].extra_files?n[r].extra_files.length+1:1:0;var o=e.nof_files-a,s=e.nof_posts-n.length,i=t?t[0].pn.getElementsByClassName("omitted")[0]:null;return 0!=s?(i||(i=document.createElement("span"),i.setAttribute("class","omitted"),i.innerHTML="dummy",i.appendChild(cnst.config_expander(e.key)),t&&t[0].pn.appendChild(i)),i.childNodes[0].textContent=s+" post"+(1!==s?"s":"")+(o?" and "+o+" image repl"+(1===o?"y":"ies"):"")+" omitted. "):i&&(i.childNodes[0].textContent="Showing all posts."),i},catalog_json2html3_thumbnail:function(e,t){return".jpg"===e.ext||".jpeg"===e.ext||".gif"===e.ext||".png"===e.ext?"https://"+this.domain_url+t+"thumb/"+e.tim+e.ext:""},catalog_json2html3_src:function(e,t){return".jpg"===e.ext||".jpeg"===e.ext||".gif"===e.ext||".png"===e.ext||".webm"===e.ext?"https://"+this.domain_url+t+"src/"+e.tim+e.ext:""},catalog_json2html3:function(e,t,n,a){var r=document.createElement("div");return r.setAttribute("class","mix"),r.setAttribute("style","display: inline-block;"),r.innerHTML='<div class="thread grid-li grid-size-'+site2[site.nickname].catalog_native_size+'"><a href="'+site2[e.domain].make_url4([e.domain,e.board,e.no,"thread_html"])[0]+'"><img src="'+n+'" id="img-'+e.no+'" data-subject="'+e.sub+'" data-name="'+e.name+'" data-muhdifference="" data-last-reply="" data-last-subject="" data-last-name="" data-last-difference=""class="'+t+' thread-image" title="'+new Date(1e3*e.last_modified).toLocaleString()+" "+e.ext+'"></a><div class="replies"><strong>'+(a?" R: "+(e.nof_posts-1)+" / I: "+e.nof_files:"")+"</strong>"+(e.sub?'<p class="intro"><span class="subject">'+e.sub+"</span></p>":"<br>")+e.com+"</div></div>",r},catalog_from_json3:function(e,t){var n;return pref.test_mode[0]?(n={domain:"8chan",board:site.board,obj:e},this.parse_funcs.catalog_json.entry(n,this.parse_funcs.catalog_json.full_hier),n.ths):site2[this.nickname].wrap_to_parse.get(e,this.nickname,t,"catalog_json")},patch:{expand_thumbnail_inline_load:function(){var e=this.parentNode&&this.parentNode.parentNode;e&&e.classList&&e.classList.contains("multifile")&&e.style.width&&(this.setAttribute("data-originalWidth",e.style.width),e.style="")}},proto:"DEFAULT"}),pref.features.domains.KC&&(site2.KC={nickname:"KC",domain_url:"krautchan.net",components:{boardlist:".menu",postform_comment:"#postform_comment",postform_submit:"#postform_submit"},make_tack:function(){var e=document.createElement("img");return e.setAttribute("src","/images/sticky.gif"),e},boards_json:site2.DEFAULT.generate_boards_json([["b",15],["int",20],"vip","a","c","co","d","e","f","fb","fe","fit","jp","k","l","li",["m",5],"n","ng","p","ph","prog","sp","t",["trv",18],"tu","tv","v","w","we","wk","wp","z","zp","ft","r",["h",8],"s","bans","kc","rfk",["rvss",15]],10),check_func:function(){site2.KC.force_https||(site2.KC.protocol=site.protocol);var e=window.location.href;return e.search(/krautchan.net/)!=-1&&(site.whereami=document.head.innerHTML.indexOf("404 Not Found")!=-1?"404":e.search(/krautchan\.net\/?$/)!=-1?"frame":e.search(/catalog/)!=-1?"catalog":e.search(/thread/)!=-1?"thread":e.search(/\/$|(index|[0-9]+)\.html|\/#all$/)!=-1?"page":"other","page"!==site.whereami&&"thread"!==site.whereami||(this.components.boardlist="body > div:nth-child(3)",delete this.show_boardlist_physical_extract_func),site.config("krautchan.net","KC"),site.max_page=void 0==site2.KC.max_page_kc[site.board]?10:site2.KC.max_page_kc[site.board],"catalog"===site.whereami&&("/"===e[e.length-1]&&(e=e.substr(0,e.length-1)),site.board=e.substr(e.lastIndexOf("/"))+"/"),"frame"===site.whereami&&(site.root_body2=document.createElement("div"),site.embed_frame="main",site.embed_frame_win=main,navigation.onload=function(){site.root_body=navigation.document.body,site.root_body.appendChild(site.root_body2)}),site.embed_to="thread"===site.whereami||"page"===site.whereami?{top:function(){return document.querySelector('form[action="/delete"]')},bottom:function(){return document.querySelector('form[action="/delete"]').nextSibling}}:{},site.postform=document.getElementById("postform"),site.postform_rules=document.getElementById("rules_row"),!0)},force_https:!1,protocol:"https:",home:site.protocol+"//krautchan.net/regeln.html",show_boardlist_physical_extract_func:function(e){return e.substr(1,e.length-2)},catalog_frame_prep:function(e){var t=[navigation.document.body,main.document.body];site2.common.absorb_children(t[0]).style.display="none",site2.common.absorb_children(t[1]).style.display="none",t[0].insertBefore(e,t[0].firstChild),t[0].insertBefore(e,t[0].firstChild),site.root_body.appendChild(site.root_body2),this.catalog_embed_prep(e)},catalog_threads_in_page:function(e){return e.getElementsByClassName("thread_body")},max_page_kc:{"/int/":20,"/b/":15,"/trv/":13,"/m/":5},max_page:function(e){return site2.KC.max_page_kc[e]},make_url4:function(e){var t=this.protocol+"//"+this.domain_url;return e[3]=e[3].replace(/_json/,"_html"),"page_html"===e[3]?[t+e[1]+(0==e[2]?"":e[2]+".html"),"html"]:"catalog_html"===e[3]?[t+"/catalog"+e[1].substr(0,e[1].length-1),"html"]:"thread_html"===e[3]?[t+e[1]+"thread-"+e[2]+".html","html"]:void 0},trim_list:"no",get_next_image:function(e,t){var n=Array.prototype.slice.call(document.querySelectorAll("img[id^=thumbnail]")).filter(function(e){return".webm"!==e.src.substr(-5,5)});return site2.DEFAULT.get_next_image(e,t,n)},get_ops:function(e){for(var t=[],n=e.getElementsByTagName("div"),a=0;a<n.length;a++)"thread"!=n[a].className&&"thread kc_showReplies"!=n[a].className||t.push(n[a].id.substring(7));return t},get_posts:function(e){for(var t=[],n=e.getElementsByTagName("a"),a=0;a<n.length;a++)""!=n[a].name&&t.push(n[a].name);return t},modify_thread_link:function(e){for(var t=[],n=e.getElementsByClassName("postheader")[0].getElementsByTagName("a"),a=0;a<n.length;a++)if("Reply"==n[a][brwsr.innerText]||"Antworten"==n[a][brwsr.innerText]){var r=n[a].getAttribute("href");t.push([n[a],r]),n[a].removeAttribute("href")}return t},time_offset:1,mark_newer_posts:function(e,t,n,a){var r=site2.DEFAULT.mark_newer_posts("KC",e.getElementsByTagName("table"),t,function(e){return e.getElementsByClassName("postreply")[0]},n,a);return null!=r?r.offsetParent:null},localtime:function(e){var t=e.getElementsByClassName("postdate")[0];if(t){var n=t.cloneNode(!1);n.setAttribute("class","CatChan_localtime"),n.textContent=site2.common.change_utc_to_local(site2.KC.parse_funcs.post_html.time_pn_1(t)),t.parentNode.insertBefore(n,t.nextSibling),t.setAttribute("style","display:none")}},remove_files_info:function(e){site2.common.remove_by_classname(e,"filename"),site2.common.remove_by_classname(e,"fileinfo");for(var t=e.getElementsByTagName("img"),n=0;n<t.length;n++)t[n].id&&t[n].id.search("thumbnail")!=-1&&(t[n].removeAttribute("onmouseover"),t[n].removeAttribute("onmouseout"),t[n].removeAttribute("onload"),site2.common.move_up_and_delete_parent([t[n]]));for(var a=e.getElementsByClassName("file_thread"),n=0;n<a.length;n++)site2.common.remove_brs(a[n]);for(var n=0;n<a.length;n++)site2.common.remove_by_attribute([a[n]],"id","filename")},remove_posts:function(e,t){for(var n=e.getElementsByTagName("table"),a=n.length-1-t;a>=0;a--)n[a].previousSibling.previousSibling&&n[a].parentNode.removeChild(n[a].previousSibling.previousSibling),n[a].parentNode.removeChild(n[a].previousSibling),n[a].parentNode.removeChild(n[a])},format_thread_layout:function(e){site2.common.add_attribute_by_classname(e,"file_thread","style","float:left;margin:5px"),site2.common.add_attribute_by_classname(e,"file_reply","style","float:left;margin:5px"),e.getElementsByTagName("blockquote")[0].setAttribute("style","margin:5px;clear:both")},format_thread_style:function(e){site2.common.add_attribute_by_classname(e,"postreply","style","background:#cacaec")},format_thread_contents:function(e){site2.common.remove_by_tagname(e,"input"),site2.common.remove_by_classname(e,"report_parent"),site2.common.remove_by_attribute(e.getElementsByClassName("postheader"),"onclick","hideThread"),site2.common.remove_by_attribute(e.getElementsByClassName("file_thread"),"onclick","toggleThumbnail"),site2.common.remove_by_attribute(e.getElementsByClassName("file_thread"),"href","shipainter"),site2.common.remove_by_tagname(e,"hr"),site2.common.remove_by_classname(e,"omittedinfo")},preprocess_html:function(e,t){
return e&&(t&&(e=e.replace(/<script[> ].*<\/script>/gm,"")),e=e.replace(/onload="imageFinishedLoading\([0-9]*\)"/gm,""),e=e.replace(/onmouseover="[^"]*"/gm,""),e=e.replace(/onmouseout="[^"]*"/gm,""),e=e.replace(/onclick="[^"]*"/gm,"")),e},preprocess_doc:function(e){site2.common.remove_attribute(e,"onload"),site2.common.remove_attribute(e,"onmouseover"),site2.common.remove_attribute(e,"onmouseout"),site2.common.remove_attribute(e,"onclick"),site2.common.remove_attribute(e,"onchange"),site2.common.remove_attribute(e,"onfocus"),site2.common.remove_attribute(e,"onsubmit");for(var t=e.getElementsByTagName("*"),n=t.length-1;n>=0;n--)t[n].getAttribute&&t[n].getAttribute("href")&&0==t[n].getAttribute("href").indexOf("javascript:")&&t[n].removeAttribute("href");pref.test_mode[28]&&(e.getElementsByTagName("html")[0].innerHTML=e.getElementsByTagName("html")[0].innerHTML)},catalog_native_prep:function(e,t,n,a){var r="catalog"===site.whereami?document.getElementsByClassName("catalog")[0]:document.querySelector('form[action="/delete"]'),o=t.getElementsByTagName("select")["catalog.indexing"];o.setAttribute("style","float:left"),r.parentNode.insertBefore(o,r),n.childNodes[3].setAttribute("style","float:left"),r.parentNode.insertBefore(n,r)},catalog_get_native_area:function(){return"page"===site.whereami?document.querySelector('form[action="/delete"]'):document.getElementsByClassName("catalog")[0]},parse_funcs:{catalog_html:{ths:function(e){for(var t=this.ths_array(e,e.pn.getElementsByClassName("thread")),n=Date.now()-36e5*pref.localtime_offset,a=0;a<t.length;a++)t[a].time_bumped<0&&(t[a].time_bumped+=n);return t},no:function(e){return parseInt(e.pn.getAttribute("id").substr(7),10)},time_bumped:function(e){return-1-16*parseInt(e.page.substr(0,e.page.indexOf(".")),10)-parseInt(e.page.substr(e.page.indexOf(".")+1))},time_created:function(e){return 0},nof_posts:function(e){var t=e.pn.getElementsByClassName("omitted_text")[0],n=t?parseInt(t.textContent.match(/[0-9]+/),10):0;return isNaN(n)?1:n+1},nof_files:function(e){return 0},key:function(e){return e.domain+e.board+e.no},sub:function(e){var t=e.pn.getElementsByTagName("header")[0].textContent.trim();return 0==t.search(/^#[0-9]+$/)?"":t},name:function(e){return""},com:function(e){return e.pn.getElementsByTagName("section")[0].innerHTML},type_com:"html",footer:function(e){var t=e.pn.getElementsByClassName("omitted_text")[0];return t.innerHTML="",t},sticky:function(e){return!1},op_img_url:function(e){var t=e.pn.getElementsByClassName("thumbnail"),n=t[0]?t[0].getElementsByTagName("img"):null;return n&&n[n.length-1]?n[n.length-1].getAttribute("src"):void 0},get_op_src:"thread_html",filename:function(e){var t=(e.pn.classList.contains("thread")||e.pn.classList.contains("thread_body"),e.pn.getElementsByClassName("post_files")[0].getElementsByTagName("figure"));if(t)for(var n=0;n<t.length;n++){var a=t[n].getElementsByTagName("img")[0].getAttribute("src");1===n&&(e.extra_files=[]),n>=1&&(e.extra_files[n-1]={domain:e.domain,board:e.board});var r=a.lastIndexOf("/"),o=0===n?e:e.extra_files[n-1];o.filename=t[n].getElementsByTagName("img")[0].getAttribute("alt"),o.filename_server=a.substr(r+1)}return e.filename},prep_mimic:"page_html",tn_imgs:function(){return[]},img2src:function(e){return th.op_img_url.replace("thumbnails","files")},dynamic_image_hover:!0},catalog_json:{proto:"catalog_html"},page_html:{ths:function(e){return this.ths_array(e,e.pn.getElementsByClassName("thread"))},th_init:function(e){e.pn.removeAttribute("class"),e.pn.style.clear="none"},no:function(e){return parseInt(e.pn.id?e.pn.id.replace(/[^_\-]*./,""):e.pn.getElementsByClassName("postnumber")[0].getElementsByTagName("a")[1].textContent,10)},posts:function(e){return this.posts_array(e,e.pn.querySelectorAll(".thread_body, td.postreply"))},time:"post_html.time",nof_posts:function(e){var t=e.pn.getElementsByTagName("table").length+1,n=e.pn.getElementsByClassName("filename").length,a=e.pn.getElementsByClassName("omittedinfo");if(a[0]){var r=a[0][brwsr.innerText].replace(/\n/g,"");t+=parseInt(r.replace(/\ post.*/,""),10),n+=parseInt("0"+r.replace(/\ file.*/,"").replace(/[^\ ]*\ /g,""),10)}return Object.defineProperty(e,"nof_files",{value:n,enumerable:!0,configurable:!0,writable:!0}),t},nof_files:function(e){return e.hasOwnProperty("nof_posts")||this.nof_posts(e),e.nof_files},sub:function(e){var t=e.pn.getElementsByClassName("postsubject")[0];return t?t.textContent:""},name:function(e){return e.pn.getElementsByClassName("postername")[0][brwsr.innerText]},pn_name:function(e){return e.pn.getElementsByClassName("postername")[0]},com:function(e){return(e.pn.getElementsByClassName("postbody")[0]||e.pn).getElementsByTagName("p")[0].innerHTML.replace(/^\s*/,"").replace(/\s*$/,"")},type_com:"html",footer:function(e){return this.insert_footer4(e.pn.getElementsByClassName("file_thread")[0])},flag:function(e){for(var t=e.pn.getElementsByTagName("img"),n=0;n<t.length&&t[n].getAttribute("src").search(/images\/balls/)==-1;n++);if(n<t.length){var a=document.importNode(t[n],!1);return a.setAttribute("src",site2.KC.absolute_link_1(a.getAttribute("src"))),a}return null},op_img_url:function(e){var t=e.pn.getElementsByClassName("file_thread"),n=t[0]?t[0].getElementsByTagName("img"):null,a=n&&n[n.length-1]?n[n.length-1].getAttribute("src"):void 0;if(t.length>=2){e.op_img_url2=[];for(var r=1;r<t.length;r++){n=t[r].getElementsByTagName("img");var o=n&&n[n.length-1]?n[n.length-1].getAttribute("src"):void 0;o&&(e.op_img_url2[e.op_img_url2.length]=o)}}return site2[e.domain].protocol+"//"+site2[e.domain].domain_url+a},get_op_src:"thread_html",get_thread_links:function(e){for(var t=e.pn.getElementsByClassName("postheader")[0].getElementsByTagName("a"),n=0;n<t.length;n++)if("Reply"===t[n].textContent||"Antworten"===t[n].textContent)return[t[n]]},get_omitted_info:function(e){return e.pn.getElementsByClassName("omittedinfo")[0]},set_omitted_info:function(e,t){e.pn.insertBefore(t,e.pn.getElementsByClassName("postbody")[0].nextSibling)},replace_omitted_info2:function(e,t){e.childNodes[0].textContent=t?t.childNodes[0].textContent:""},filename:function(e){var t=e.pn.classList.contains("thread")||e.pn.classList.contains("thread_body"),n=e.pn.getElementsByClassName(t?"file_thread":"file_reply");if(n)for(var a=0;a<n.length;a++){var r=n[a].getElementsByClassName("filename")[0].getElementsByTagName("a")[0].getAttribute("href");1===a&&(e.extra_files=[]),a>=1&&(e.extra_files[a-1]={domain:e.domain,board:e.board});var o=r.lastIndexOf("/"),s=0===a?e:e.extra_files[a-1];s.filename=r.substr(o+1),s.filename_server=r.substr(0,o).replace(/[^\/]*\//g,"").replace(/jpeg$/,"jpg");var i=n[a].getElementsByClassName("fileinfo")[0].textContent.replace(/\s/g,"").split(",");s.w=parseInt(i[1].substr(0,i[1].indexOf("x")),10),s.h=parseInt(i[1].substr(i[1].indexOf("x")+1),10);var l=i[1].split(/\s/);l[1]="kB"===l[1]?1e3:"MB"===l[1]?1e6:1,s.fsize=parseInt(l[0],10)*l[1];var c=n[a].querySelector("img[id^=thumbnail]");c&&(s.tn_w=parseInt(c.getAttribute("width"),10),s.tn_h=parseInt(c.getAttribute("height"),10))}return e.filename},tn_imgs:function(e){return e.pn.querySelectorAll("img[id^=thumbnail]")},prep_mimic:function(e){e.op_img_url=e.parse_funcs.op_img_url(e)},get_op_src:function(e){return site2.KC.catalog_json2html3_src(e)},get_max_page:function(e){for(var t=e.querySelectorAll("form[action*=delete]")[0].lastChild.previousSibling.previousSibling.previousSibling.childNodes[1].childNodes[1].childNodes[0].childNodes[3].childNodes,n=0,a=0;a<t.length;a++){var r=t[a].textContent.replace(/\s+/g,"");n+1!=r&&"["+(n+1)+"]"!==r||n++}return n}},thread_html:{com:function(e){return e.pn.getElementsByTagName("blockquote")[0].innerHTML.replace(/^\s*/,"").replace(/\s*$/,"")},type_com:"html",time_created:function(e){return e.parse_funcs.time(e.posts[0])},time_bumped:function(e){return e.parse_funcs.time(e.posts[e.posts.length-1])},get_op_src:function(e){return e.op_img_url.replace("thumbnails","files")},proto:"page_html"},post_html:{flag:"page_html",time:function(e){return site2.KC.parse_funcs.post_html.time_pn(e.pn)},time_pn:function(e){var t=e.getElementsByClassName("postdate")[0];return t?site2.KC.parse_funcs.post_html.time_pn_1(t):void 0},time_pn_1:function(e){return Date.parse(e.textContent)+36e5*(pref.localtime_offset-site2.KC.time_offset)}},post_json:{time_unit:1}},general_event_handler:{},popups_href2dbtp:function(e){var t=e.split(/[\/#]/),n=t[t.length-1],a=t[t.length-2].replace("thread-","").replace(".html","");return["KC",t.length>=3?"/"+t[t.length-3]+"/":site.board,a,n]},link_dbtp2href:function(e){return e[1]+"thread-"+e[2]+".html#"+e[3]},post_json2html_fname_server:function(e){return e.filename_server},post_json2html_fname:function(e){return e.filename},catalog_json2html3_src:function(e){return site.protocol+"//"+site2[e.domain].domain_url+"/files/"+e.filename_server},catalog_json2html3_thumbnail:function(e){return site.protocol+"//"+site2[e.domain].domain_url+"/thumbnails/"+e.filename_server},post_json2html:function(e,t,n,a,r){var o=document.createElement("div"),s=e.parse_funcs&&e.parse_funcs.time_unit||1,i=new Date((e.time||0)*s-36e5*(pref.localtime_offset-site2.KC.time_offset)),l="";if(e.filename&&(l+=this.post_json2html_file(e,t,e.extra_files),e.extra_files))for(var c=0;c<e.extra_files.length;c++)l+=this.post_json2html_file(e.extra_files[c],t,!0);return o.innerHTML='<div class="'+(n?"thread_body":'postreply" id="post-'+e.no)+'"><div class="postheader"><input name="post_'+e.no+'" value="delete" type="checkbox">'+(e.flag?e.flag.outerHTML:"")+'<span class="postsubject">'+e.sub+'</span> <span class="postername">'+e.name+'</span> <span class="postdate">'+i.toLocaleString()+'</span> <span class="postnumber"><a href="/int/thread-'+r+".html#"+e.no+'" class="quotelink">No.</a><a href="/int/thread-'+r+".html#q"+e.no+'" class="quotelink">'+e.no+'</a></span> <div class="report_parent"><a href="/report/int/'+r+'" class="report_link"><img src="/images/icon-report.png"></a></div>'+(n?' [<a href="'+t+"thread-"+e.no+'.html">Reply</a>] ':"")+"</div>"+l+"<div"+(n?' class="postbody"':"")+'><blockquote><p id="post_text_'+e.no+'">'+e.com+"</p></blockquote></div></div>",o.childNodes[0]},post_pn2ce:function(e){return"BLOCKQUOTE"===e.lastChild.firstChild.tagName?e.lastChild.firstChild:e.getElementsByTagName("blockquote")[0]},post_json2html_file:function(e,t,n){var a=(.005+(e.fsize>1048576?e.fsize/1048576:e.fsize/1024)).toString();a=a.substr(0,a.indexOf(".")+3)+(e.fsize>1048576?" MB":" KB");var r=site2[e.domain].post_json2html_fname_server(e),o=site2[e.domain].post_json2html_fname(e),s=site2[e.domain].catalog_json2html3_src(e,t),i=site2[e.domain].catalog_json2html3_thumbnail(e,t);return'<div class="file_thread"><span class="filename"><a href="/download/'+r+"/"+o+'">'+o+'</a></span><br><span class="fileinfo"> '+o.substr(o.lastIndexOf(".")+1).toUpperCase()+", "+e.w+"x"+e.h+", "+a+'</span><br><a href="'+s+'" target="_blank"><img style="display: block" id="thumbnail_'+r+'" src="'+i+'" width="'+e.tn_w+'" height="'+e.tn_h+'"></a></div>'},page_json2html3:function(e,t,n,a){a=!0;var r=document.createElement("div");r.setAttribute("id","thread_"+e.no),r.setAttribute("style","clear:both"),r.innerHTML="<hr><a name="+e.no+"></a>";var o=this.post_json2html(e.posts&&e.posts[0]?e.posts[0]:e,t,!0,site2[e.domain].short_link(e.key,e.nof_posts,2,"[Last "," Posts]"),e.no);if(r.appendChild(o),!a&&e.posts[0].pn||(e.posts[0].pn=o),e.posts){for(var s=1;s<e.posts.length;s++){var i=this.post_json2html(e.posts[s],t);this.update_posts_insert_1(this.post_container(i,e.posts[s].no),e.posts[s].no,null,r),!a&&e.posts[s].pn||(e.posts[s].pn=i)}this.page_json2html3_add_omitted_info(e,e.posts,e.posts)}return r},page_json2html3_replace_expander:function(e,t,n){var a=e[0].pn.getElementsByClassName("omittedinfo")[0];a&&a.appendChild(cnst.config_expander(n,t))},page_json2html3_add_omitted_info:function(e,t,n){for(var a=0,r=1;r<n.length;r++)a+="html"===n[r].type_data?n[r].pn.getElementsByClassName("file_thread").length:n[r].filename?n[r].extra_files?n[r].extra_files.length+1:1:0;var o=e.nof_files-a,s=e.nof_posts-n.length,i=t?t[0].pn.getElementsByClassName("omittedinfo")[0]:null;return e.nof_posts>1?(i||(i=document.createElement("span"),i.setAttribute("class","omittedinfo"),i.innerHTML="dummy",i.appendChild(cnst.config_expander(e.key)),t&&t[0].pn.insertBefore(i,t[0].pn.getElementsByClassName("postbody")[0].nextSibling)),i.childNodes[0].textContent=0!==s?s+" post"+(1!==s?"s":"")+(o?" and "+o+" file"+(1===o?"":"s"):"")+" are not shown. ":""):i&&(i.childNodes[0].textContent="Showing all posts."),i},update_posts_remove:function(e,t,n,a){n=n.getElementsByClassName("thread_body")[0];var r=e.posts[t].pn;a&&r.parentNode===n?this.update_posts_insert_pack(r):r=r.parentNode.parentNode.parentNode,r.previousSibling&&"A"===r.previousSibling.tagName&&n.removeChild(r.previousSibling),n.removeChild(r)},update_posts_insert:function(e,t,n,a,r){var o=t[a];o=o?o.pn:null;var s=o&&o.parentNode&&o.parentNode.parentNode&&o.parentNode.parentNode.parentNode;s&&s.parentNode&&s.parentNode.parentNode===r&&(o=s),e[n].pn||(e[n].pn=this.post_json2html(e[n],e[n].board)),0===n&&this.update_posts_insert_pack(e[0].pn),0===a&&o&&this.update_posts_insert_pack(t[0].pn);var i=0===a&&0===n?e[n].pn:this.post_container(e[n].pn,e[n].no);this.update_posts_insert_1(i,e[n].no,o,r),0===n&&0===a&&this.update_posts_insert_unpack(e[0].pn)},update_posts_insert_1:function(e,t,n,a){a=a.getElementsByClassName("thread_body")[0];var r=document.createElement("a");r.setAttribute("name",t),a.insertBefore(r,n),a.insertBefore(e,n)},update_posts0_class:site2.vichan.update_posts0_class,update_posts_insert_pack:site2.vichan.update_posts_insert_pack,update_posts_insert_pack_iter:function(e,t){for(var n=e.previousSibling;n;){var a=n.previousSibling;if(n.classList&&(n.classList.contains(pref.script_prefix+"_footer")||n.classList.contains("file_thread")||n.classList.contains("post_header"))&&t(n),n.classList&&n.classList.contains("postbody"))break;n=a}},update_posts_insert_unpack:function(e){for(;;){var t=e.firstChild;if(!(t&&t.classList&&(t.classList.contains(pref.script_prefix+"_footer")||t.classList.contains("file_thread")||t.classList.contains("post_header"))))break;e.parentNode.insertBefore(t,e)}},post_container:function(e,t){var n=document.createElement("table");return n.innerHTML='<tbody><tr><td valign="top">&gt;&gt;</td></tr></tbody>',n.childNodes[0].childNodes[0].appendChild(e),n},catalog_json2html3:function(e,t,n,a){var r=document.createElement("article");r.setAttribute("class","thread teaser"),r.setAttribute("id","thread-"+e.no);var o=null;return e.flags&&e.flags[0]&&(o=document.importNode(e.flags[0],!1),o.setAttribute("class","post_country")),r.innerHTML='<article class="thread_OP" id="'+e.no+'"><div class="post"><header><a><h1>'+(o?o.outerHTML:"")+(e.sub?e.sub:"#"+e.no)+'</h1></a></header><div class="post_body"><a><div class="post_files multiple"><figure><div class="thumbnail"><img src="'+e.op_img_url+'"></div></figure>'+(e.op_img_url2&&e.op_img_url2[0]?'<figure><div class="thumbnail"><img src="'+e.op_img_url2[0]+'"></div></figure>'+(e.op_img_url2&&e.op_img_url2[1]?'<figure><div class="thumbnail"><img src="'+e.op_img_url2[1]+'"></div></figure>'+(e.op_img_url2&&e.op_img_url2[2]?'<figure><div class="thumbnail"><img src="'+e.op_img_url2[2]+'"></div></figure>':""):""):"")+'</div></a><div class="omittedposts"><span class="omitted_text">'+(a?"R: 0 / I: 0 / P: 0.0&emsp;/catalog/":"")+'</span></div><div class="post_text"><section>'+e.com+"</section></div></div></div></article>",r.getElementsByClassName("thumbnail")[0].childNodes[0].addEventListener("load",site2.KC.catalog_json2html3_onload,!1),r},catalog_json2html3_onload:function(){this.removeEventListener("load",site2.KC.catalog_json2html3_onload,!1);var e=this.naturalWidth,t=this.naturalHeight,n=(e>t?e:t)/200;this.setAttribute("width",e/n),this.setAttribute("height",t/n)},favicon:{__proto__:site2.DEFAULT.favicon,none:"/favicon.ico",reply:"png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAIAAACQkWg2AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAKJJREFUOE9jZPh/hgECfv4yts59/PgxlAujZGVlzx6dzMDOBhMAaoCjtEA01SAuUBBZDQrnwEwsGoCCKBp+HEPwPx6QkZFB1gPifjyAUABUbGxsDLIUaAxEItQFxRIgFygIlAIqSAsEKYYDkGGhLpaWlsgaQNxQFxRrxcTEsLgbhxBI8SDUQLKnSQ9WUiOO9KRBfuL7cQzoH2C0oAGQJ5GcDQBwM6RhinByrgAAAABJRU5ErkJggg==",reply_to_me:"png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAIAAACQkWg2AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAMxJREFUOE9jZPh/hgECfv4yts59/PgxlAujZGVlzx6dzMDOBhMAavh/5j8MoKkGcdMCQYbCEYSFT8OBmagafhxD1iAjI4NsCYj78QBCA1CxsbEx0FKEDaEuKK4CcoFOAOoB2pMWCFIMAXANlpaWyBpA3FAXFGvFxMSQNWDxNJIQSDFEA5EAoQFfKGG1gQQNcP0gn4W6EPY0JFhBoQYJb8LBCo44KPp4gHDEoUQ70B5MgJ40kBMW0G2YAGviA9nz4xjQP8CQRgMgTyI5GwD2xdfU779fsgAAAABJRU5ErkJggg=="},add_backlinks:function(e,t,n,a){}}),(pref.features.domains["4chan"]||pref.features.domains.meguca)&&(site2["4chan_i"]={home:void 0,nickname:"4chan_i",nickname_href2domain:"4chan",domain_url:"i.4cdn.org",check_func:site2.DEFAULT.check_func,proto:"4chan"},site2["4chan"]={nickname:"4chan",home:site.protocol+"//boards.4chan.org/favicon.ico",protocol:"http:",make_tack:function(){var e=document.createElement("img");return e.setAttribute("src","//s.4cdn.org/image/sticky.gif"),e.setAttribute("class","stickyIcon retina"),e},postform_rules:null,postform:{activation:function(){document.getElementById("togglePostFormLink").getElementsByTagName("a")[0].click(),this.activation=null},__proto__:site2.DEFAULT.postform},features:{uip_tracker:!0},components:{boardlist:".boardList",postform_comment:'textarea[name="com"]',postform_submit:'input[type="submit"]',postform_comment2:['textarea[name="com"]',1],postform_submit2:['input[type="submit"]',2]},spoiler_text:{open_rule:"s,s a:not(:hover) {color: #fff!important;}"},general_event_handler:function(){var e={thread:{get_mark:function(e,t){for(;e&&e!==cataLog.parent;){if(e.classList.contains("post"))return e;if(e.classList.contains("postContainer"))return e.getElementsByClassName("post")[0];if(e.parentNode&&e.parentNode.classList.contains("thread")){if(e=e.previousSibling)continue;break}if(e.classList.contains("thread"))break;e=e.parentNode}return this.get_mark_from_height(t)},get_mark_from_height:function(e){return this.__proto__.get_mark_from_height(e,document.getElementsByClassName("post"))},image_hover_check_mode:function(e){return e.parentNode.classList.contains("fileThumb")?"page":"catalog"},getID:function(e){return e.classList.contains("hand")&&e.textContent},getCountry:function(e){return e.classList.contains("flag")&&e.getAttribute("class").replace(/\s*flag\-*/g,"").toUpperCase()||"countryFlag"===e.className&&e.getAttribute("alt").toLowerCase()},getTrip:function(e){return e.classList.contains("postertrip")&&e.textContent},__proto__:site2.DEFAULT.general_event_handler.common}};return e.catalog=Object.create(e.thread),e.page=Object.create(e.thread),e.archive=Object.create(e.thread),e}(),domain_url:"boards.4chan.org",check_func:function(){var e=window.location.href;return e.search(this.domain_url)!==-1&&(site.whereami=document.title.indexOf("404 Not Found")!=-1?"404":e.search(/catalog/)!=-1?"catalog":e.search(/thread\/[0-9]+/)!=-1?"thread":e.search(/archive/)!=-1?"archive":e.search(/\/$|(index|[0-9]+)(\.html)*|\/#all$/)!=-1?"page":"other","thread"===site.whereami&&(site.no=parseInt(e.replace(/.*thread\/([0-9]+)/,"$1"),10)),site.config(this.domain_url,"4chan"),this.postform_prep(),site.max_page=site2["4chan"].max_page(site.board),site.header_height=function(){var e=document.getElementById("header");return e?e.offsetHeight:0},site.embed_to="thread"===site.whereami?{top:function(){return document.getElementsByClassName("navLinks")[0]},bottom:function(){return document.getElementsByClassName("bottomad")[0]||document.getElementById("boardNavDesktopFoot")}}:"page"===site.whereami?{top:function(){return document.getElementById("ctrl-top")},bottom:function(){return document.getElementsByClassName("pagelist")[0]}}:"catalog"===site.whereami?{top:function(){return document.getElementById("content").previousSibling},bottom:function(){return document.getElementsByClassName("navLinksBottom")[0].nextSibling}}:{},site.postform=document.getElementsByClassName("postForm")[0],!0)},get_next_image:function(e,t){var n=cataLog.parent.querySelectorAll("img[data-md5]"),a=Array.prototype.indexOf.call(n,e);if(a==-1&&(a=Array.prototype.indexOf.call(n,e.previousSibling)),t)for(;n[a+1]&&n[a+1].offsetTop<t;)a++;if(a>=0){for(;n[a+1]&&n[a+1].parentNode.getAttribute("href").search(/\.webm$/)!=-1;)a++;return n[a+1]}return null},format_expanded_thumbnail:function(e){e.removeAttribute("data-md5"),e.className="expanded-thumb"},catalog_threads_in_page:function(e){return e.getElementsByClassName("thread")},catalog_posts_in_thread:function(e){return e.getElementsByClassName("replyContainer")},max_page:function(){return 10},make_url4:function(e,t){var n=site.protocol+"//"+this.domain_url+e[1],a=site.protocol+"//a.4cdn.org"+e[1];return("catalog_html"===e[3]||t&&0==e[2]&&"page_json"===e[3])&&(e[3]="catalog_json"),"page_json"===e[3]?[a+(parseInt(e[2],10)+1)+".json","json",t?"4chan"+e[1]+"j0":void 0]:"catalog_json"===e[3]?[a+"catalog.json","json","4chan"+e[1]+"j0"]:"thread_json"===e[3]?[a+"thread/"+e[2]+".json","json"]:"page_html"===e[3]?[n+(0!=e[2]?parseInt(e[2],10)+1:""),"html"]:"thread_html"===e[3]?[n+"thread/"+e[2],"html"]:null},trim_list:"force_init",url_boards_json:function(){return[site.protocol+"//a.4cdn.org/boards.json","json"]},archive_patch_domain:function(e){Object.defineProperty(e,"domain_xhr",{get:function(){return this.url.indexOf("i.4cdn.org/")===-1?null:"4chan_i"},configurable:!0,enumerable:!0})},get_ops:function(e){for(var t=[],n=e.getElementsByClassName("thread"),a=0;a<n.length;a++)t.push(n[a].id.substring(1));return t},get_posts:function(e){for(var t=[],n=e.getElementsByClassName("postContainer"),a=0;a<n.length;a++)t.push(parseInt(n[a].id.substring(2),10));return t},modify_thread_link:function(e){var t=e.getElementsByClassName("replylink")[0];if(t){var n=t.getAttribute("href");return t.removeAttribute("href"),[[t,n]]}return[]},check_thread_archived:function(e){return 0!=e.getElementsByClassName("archivedIcon").length},mark_newer_posts:function(e,t,n,a){return site2.DEFAULT.mark_newer_posts("4chan",e.getElementsByClassName("postContainer"),t,function(e){return e.getElementsByClassName("post")[0]},n,a)},localtime:function(e){for(var t=e.getElementsByClassName("dateTime"),n=0;n<t.length;n++)t[n].textContent=site2.common.change_utc_to_local(1e3*parseInt(t[n].getAttribute("data-utc"),10))},remove_files_info:function(e){site2.common.remove_by_classname(e,"fileText"),site2.common.remove_by_classname(e,"mFileInfo");for(var t=e.getElementsByClassName("fileThumb"),n=0;n<t.length;n++)site2.common.move_up_and_delete_parent([t[n].childNodes[0]])},remove_posts:function(e,t){site2.common.remove_by_classname(e,"postContainer replyContainer",t,!0)},format_thread_layout:function(e){site2.common.add_attribute_by_classname(e,"post op","style","padding:0px"),site2.common.add_attribute_by_tagname(e,"blockquote","style","margin:12px 5px")},format_thread_contents:function(e){site2.common.remove_by_tagname(e,"input"),site2.common.remove_by_classname(e,"mobile"),site2.common.remove_by_classname(e,"sideArrows"),site2.common.remove_by_classname(e,"summary")},get_json_url_catalog:function(e){return site.protocol+"//a.4cdn.org"+e+"catalog.json"},uip_check:function(e,t){var n=[site.nickname,site.board,site.no,"thread_json"];http_req.get("uip",n.join(),"",e,!1,!1),pref.uip_tracker.sage.detect&&(n[3]="catalog_json",http_req.get("sage_detection",n.join(),"",this.sage_detect,!1,!1,t))},sage_detect:function(e,t,n){var a=e.split(","),r=site2["4chan"].wrap_to_parse.get(t.response,a[0],a[1],a[3],{page:0});n(site2["4chan"].parse_funcs.catalog_json.add_sage(r,site.no))},sage_detect_all:function(e){this.parse_funcs.catalog_json.add_sage(e,null);for(var t=0;t<e.length;t++){for(var n=e[t].posts,a=liveTag.mems.init(e[t]),r=0;r<n.length;r++)"sage"===n[r].email&&(a.sg||(a.sg=new Set),a.sg.add(n[r].no));if(pref.catalog.page_his){a.pgh||(a.pgh={});var o=a.pgh,s=e[t].posts[e[t].posts.length-1].no;o[s]?this.page_his_update(o[s],t):o[s]=[t]}}},page_his_update:function(e,t){var n=e[e.length-1];return n!=t&&(e[e.length-(e.length>=3&&e.length%2==1?0:e.length>1&&n<t?1:0)]=t),n!=t},parse_json_thread:function(e,t){if(t)return e.posts[e.posts.length-1].unique_ips=e.posts[0].unique_ips,e;for(var e={posts:[]},n={},a=0,r=document.getElementsByClassName("postContainer"),o=0;o<r.length;o++){e.posts[o]={},e.posts[o].no=r[o].id.replace(/pc/,"");var s=r[o].getElementsByClassName("posteruid")[0];s&&(s=s.textContent,e.posts[o].id=s,void 0===n[s]&&(a++,n[s]=1)),e.posts[o].unique_ips=a}return e.posts[r.length-1].unique_ips=0,e},uip_tgt_post:function(e){return document.getElementById("p"+e)},uip_post_num:function(e){return e.getElementsByClassName("postNum")},prep_own_posts_reg:/^4chan\-track\-[0-9A-z]+\-[0-9]+$/,prep_own_posts_event:function(e){e&&site2["4chan"].prep_own_posts_1(e.key)&&(e=null),"4chan"!==window.name||e||send_message("parent",["OWN_POSTS",window.name,site3[window.name].own_posts])},prep_own_posts:function(e){if(site3[this.nickname].own_posts={},localStorage)for(var t=e?[("4chan-track"+e).replace(/\//g,"-")]:Object.keys(localStorage||"{}"),n=0;n<t.length;n++)this.prep_own_posts_1(t[n])},prep_own_posts_1:function(e){if(this.prep_own_posts_reg.test(e)){var t="/"+e.replace(/^4chan\-track\-/,"").replace(/\-[0-9]+$/,"")+"/";site3[this.nickname].own_posts[t]||(site3[this.nickname].own_posts[t]={});var n=JSON.parse(localStorage[e]||"{}");for(var a in n)site3[this.nickname].own_posts[t][a.substr(2)]=null;return!0}return!1},catalog_native_prep:function(e,t,n,a){var r="catalog"===site.whereami?document.getElementById("ctrl"):document.getElementById("ctrl-top");if("thread"===site.whereami||!r)for(var r=document.getElementsByClassName("navLinks"),o=0;o<r.length;o++)if("none"!==window.getComputedStyle(r[o]).display){r=r[o];break}if(site2.DEFAULT.catalog_native_prep_sel(t,n,"catalog"===site.whereami?document.getElementById("order-ctrl"):null),"catalog"===site.whereami){document.getElementById("size-ctrl").addEventListener("change",site2["4chan"].catalog_native_size_changed,!1),pref3.catalog.filter.kwd.init(document.getElementById("qf-box"),t).id=null;var s=pref3.catalog.filter.kwd.clear.bind(pref3.catalog.filter.kwd);document.getElementById("qf-ctrl").addEventListener("click",s,!1),document.getElementById("qf-clear").addEventListener("click",s,!1)}else site.whereami;r.appendChild(n),"archive"===site.whereami&&(styleSheet.register("."+pref.script_prefix+"_threads","padding:20px 0;text-align:center;"),styleSheet.register("."+pref.script_prefix+"_threads>.thread","width:180px;max-height:320px;vertical-align:top;display:inline-block;word-wrap:break-word;overflow:hidden;margin-top:5px;margin-bottom:20px;padding:5px 0 3px;position:relative;"))},catalog_native_prep_clonenode:function(e,t){var n=e.cloneNode(t);return n.setAttribute("name",(n.name?n.name:"clone_node")+"_CatChan"),e.parentNode.insertBefore(n,e.nextSibling),e.setAttribute("style","display:none"),n},catalog_get_native_area:function(){if("archive"===site.whereami){var e=document.getElementById("arc-list"),t=document.createElement("div");t.setAttribute("class",pref.script_prefix+"_threads"),e.parentNode.insertBefore(t,e);var n=document.createElement("button");return n.textContent="More threads",e.parentNode.insertBefore(n,e),n.onclick=function(){cataLog.insert_myself(null,null,!0)},t}return"catalog"===site.whereami?document.getElementById("threads"):document.getElementsByClassName("board")[0]},catalog_native_size:document.getElementById("size-ctrl")?document.getElementById("size-ctrl").value:"small",catalog_native_size_changed:function(){site2["4chan"].catalog_native_size=this.value;var e=catalog_obj.catalog_func().get_threads();for(var t in e)e[t][0]&&site2["4chan"].catalog_json2html3_size_changed(e[t][0].getElementsByTagName("img")[0]);catalog_obj.catalog_func().show_catalog()},parse_funcs:{catalog_html:{ths:"thread_html",no:function(e){return parseInt(e.pn.getAttribute("id").substr(7),10)},time_bumped:function(e){return 0},time_created:function(e){return 0},nof_posts:function(e){var t=e.footer.textContent.match(/[0-9]+/g),n=t&&t[1]&&parseInt(t[1],10)+1||1;return Object.defineProperty(e,"nof_files",{value:n,enumerable:!0,writable:!0,configurable:!0}),t&&parseInt(t[0],10)+1||1},nof_files:function(e){var t=e.footer.textContent.match(/[0-9]+/g),n=t&&parseInt(t[0],10)+1||1;return Object.defineProperty(e,"nof_posts",{value:n,enumerable:!0,writable:!0,configurable:!0}),t&&t[1]&&parseInt(t[1],10)+1||1},sub:function(e){var t=e.pn.getElementsByClassName("teaser")[0],n=t?t.getElementsByTagName("b"):null,a=t?n&&n[0]?t.childNodes[1]?t.childNodes[1].textContent:"":t.childNodes[0].textContent:"";return Object.defineProperty(e,"com",{value:a,enumerable:!0,writable:!0,configurable:!0}),n&&n[0]?n[0].textContent:""},name:function(e){return""},com:function(e){return e.hasOwnProperty("sub")||Object.defineProperty(e,"sub",{value:this.sub(e),enumerable:!0,writable:!0,configurable:!0}),e.com},footer:function(e){return e.pn.getElementsByClassName("meta")[0]},sticky:function(e){return void 0!==e.pn.getElementsByClassName("stickyIcon")[0]},tn_as:function(e){return e.pn.getElementsByTagName("a")},tn_imgs:function(e){var t=e.pn.getElementsByTagName("a")[0];return t?[t.getElementsByTagName("img")[0]]:[]},class_thread:"thread",class_thumbnail:"thumb",op_img_url:function(e){return e.tn_imgs[0]?e.tn_imgs[0].getAttribute("src"):void 0},get_op_src:"thread_json",dynamic_image_hover:!0,missing_info:1,img2src:function(e){var t=this.get_lth_from_node(e);if(!t)return null;var n=e.src;return t.th&&t.th.ext?n=n.replace(/thumb/,"src").replace(/s\.[^\.]*$/,t.th.ext):t.th.parse_funcs.missing_info&&scan.scan_ui("image_hover",{tgts:[t.domain+t.board],options:{callback:function(){cataLog.image_hover_reentry(e)},priority:6}}),n},time_unit:1e3,footer_prep:function(e,t){var n=document.createElement("span");t.insertBefore(n,t.firstChild),t.removeChild(t.lastChild);for(var a;a=n.nextSibling;)n.appendChild(a);return n}},catalog_json:{ths:function(e,t){for(var n=[],a=0;a<e.length;a++)if(e[a].threads)for(var r=0;r<e[a].threads.length;r++){var o=e[a].threads[r];o.__proto__=t,n[n.length]={page:a+"."+r,key:t.domain+t.board+o.no,__proto__:o}}return n},time_posted:function(e){return e.last_replies?1e3*e.last_replies[e.last_replies.length-1].time:e.time_created},time_bumped:function(e){return e.bumplimit?void 0:e.time_posted},time_created:function(e){return 1e3*e.time},nof_posts:function(e){return e.replies+1},nof_files:function(e){return e.images+1},op_img_url:"DEFAULT.common",posts:function(e){return e.last_replies?[e.__proto__].concat(e.last_replies):[e.__proto__]},has_posts:!0,add_op_img_url:site2.DEFAULT.parse_parts.add_op_img_url,time_unit:1e3,get_op_src:"thread_json",type_com:"html",posts_full:null,missing_info:void 0,tn_as:"catalog_html",tn_imgs:"catalog_html",footer:"catalog_html",class_thread:"catalog_html",class_thumbnail:"catalog_html",add_sage:function(){function e(e,t,n){return"p"+Math.floor(e/15)+"."+e%15+", "+t+"#"+n.no}var t={},n={};return function(a,r){for(var o=pref.uip_tracker.sage,s=0;s<a.length&&a[s].sticky;){if(a[s].no===r)return a[s];s++}if(o.patch_bug3){for(var i=(a[0].domain!==site.nickname?a[0].domain:"")+a[0].board,l=t[i]||0;s<a.length&&a[s].last_modified<l;){if(a[s].no===r)return a[s];s++}s<a.length&&(t[i]=a[s].last_modified)}if(s!=a.length){if(a[s].no==r)return a[s];l=a[s].last_modified;for(var c=(a[0].domain!==site.nickname?a[0].domain:"")+(a[0].board!==site.board?a[0].board:""),p=!1,_=this.time_unit;++s<a.length;){var d=a[s],u=c?c+d.no:d.no;if(!d.bumplimit){for(var f=d.posts.length-1;f>=1;f--){var m=d.posts[f].time;if(t[u]>=m)break;if(l+o.tolerance>=m)break
;if(o.patch_bug4&&f==d.posts.length-1&&s<n[u]){pref.debug_mode[30]&&console.log("RECOVERED by page history: "+e(s,u,d.posts[f])),p=!0;break}d.posts[f].email="sage",pref.debug_mode[30]&&console.log("detect: sage: "+e(s,u,d.posts[f])+", "+m+", "+l)}0===f&&(m=d.posts[0].time),1!==d.posts.length&&d.posts[d.posts.length-1].time==d.last_modified||(m=d.last_modified);var h=t[u]!=m;(!t[u]||t[u]<m)&&(t[u]=m),l=o.patch_bug2&&s<o.patch_bug2nth?d.last_modified:t[u],Object.defineProperty(d,"time_bumped",{value:l*_,enumerable:!0,configurable:!0,writable:!0})}var g=!h&&s<n[u];if(n[u]=g?n[u]:s,d.no==r)return d;if(o.patch_bug5&&(p||g)){pref.debug_mode[30]&&console.log("EXIT by obsolete data: "+e(s,u,d.posts[f])+", "+n[u]);break}}}}}(),flags:"DEFAULT.page_json",hrefs:"DEFAULT.post_json",proto:"DEFAULT.common"},page_html:{proto:"thread_html"},thread_html:{time_created:"DEFAULT.thread_json",time_bumped:"DEFAULT.thread_json",time_posted:"DEFAULT.thread_json",ths:function(e){return this.ths_array(e,e.pn.getElementsByClassName("thread"))},id:"DEFAULT.thread_html",country:"DEFAULT.thread_html",trip:"DEFAULT.thread_html",flag:"DEFAULT.thread_html",name:"DEFAULT.thread_html",th_init:function(e){e.pn.removeAttribute("class")},nof_posts:function(e){var t=e.pn.getElementsByClassName("postContainer").length,n=e.pn.getElementsByClassName("fileText").length,a=e.pn.getElementsByClassName("summary desktop")[0];if(a){var r=a[brwsr.innerText].replace(/\n/g,"");t+=parseInt(r.replace(/\ post.*/,""),10),n+=parseInt("0"+r.replace(/\ image.*/,"").replace(/[^\ ]*\ /g,""),10)}return Object.defineProperty(e,"nof_files",{value:n,enumerable:!0,configurable:!0,writable:!0}),t},nof_files:function(e){return e.hasOwnProperty("nof_posts")||this.nof_posts(e),e.nof_files},footer:function(e){return this.insert_footer4(e.pn.getElementsByClassName("postInfo desktop")[0])},sticky:function(e){return 0!=e.pn.getElementsByClassName("stickyIcon").length},op_img_url:function(e){var t=e.pn.getElementsByTagName("img")[0];return t?t.getAttribute("src"):void 0},get_thread_links:function(e){return e.pn.querySelectorAll(".replylink,."+pref.script_prefix+"_link")},get_omitted_info:function(e){var t=e.pn.parentNode.nextSibling;return t&&t.classList.contains("summary")?t:void 0},set_omitted_info:function(e,t){e.pn.parentNode.parentNode.insertBefore(t,e.pn.parentNode.nextSibling)},replace_omitted_info:function(e,t){e.childNodes[1].textContent=t.childNodes[1].textContent},replace_omitted_info2:function(e,t,n){if("A"===e.tagName){var a=document.createElement("span");a.setAttribute("class","summary"),a.appendChild(document.createElement("span")),a.appendChild(e),e=a}t?("none"===e.childNodes[1].style.display&&(n.domain===site.nickname&&e.childNodes[0].removeAttribute("style"),e.childNodes[1].removeAttribute("style")),this.replace_omitted_info(e,t)):(e.childNodes[0].setAttribute("style","display:none"),e.childNodes[1].setAttribute("style","display:none"))},get_op_src:"thread_json",proto:"post_html"},page_json:{ths:"DEFAULT.page_json",get_op_src:"thread_json",proto:"thread_json"},thread_json:{tn_as:"catalog_html.tn_as",sticky:function(e){return e.posts[0].sticky},get_op_src:function(e,t){return e.op_img_url.indexOf("s.4cdn.org")!=-1?e.op_img_url:(!e.ext&&e.parse_funcs.missing_info&&scan.scan_ui("image_hover",{tgts:[e.domain+e.board+"j0"],options:{callback:function(){cataLog.image_hover_reentry(t)},priority:6}}),e.localArchive?site2[e.domain].catalog_json2html3_src(e,e.board):e.ext?e.op_img_url.replace(/s(\.\w+)$/,e.ext):t.src)},consolidate_IDB_result_sub:function(e){e[0].nof_posts=e.length;for(var t=0,n=0;n<e.length;n++)e[n].filename&&t++;e[0].nof_files=t},flags:"DEFAULT.page_json",hrefs:"DEFAULT.post_json",proto:"DEFAULT.thread_json"},post_html:{no:function(e){var t=e.pn.getAttribute("id");return parseInt(t.substr(1),10)||parseInt(t.substr(2),10)},time:function(e){return parseInt(e.pn.getElementsByClassName("dateTime")[0].getAttribute("data-utc"),10)},time_pn:function(e){return 1e3*parseInt(e.getElementsByClassName("dateTime")[0].getAttribute("data-utc"),10)},flag:function(e){return e.pn.getElementsByClassName("flag")[1]||e.tFlag},tFlag:function(e){return e.pn.getElementsByClassName("countryFlag")[1]},country:function(e){return e.tFlag?e.tFlag.getAttribute("alt").toLowerCase():e.flag?e.flag.getAttribute("class").replace(/\s*flag\-*/g,"").toUpperCase():void 0},txt2com_anchor_class:"quotelink",txt2com_spoiler_replace_txt:"<s>$1</s>",time_unit:1e3,pn_name:function(e){return e.pn.getElementsByClassName("desktop")[0].getElementsByClassName("name")[0]},name:function(e){return this.pn_name(e).textContent},pn_id:function(e){var t=e.pn.getElementsByClassName("posteruid")[1];return t?t.childNodes[1]:void 0},id:function(e){return e.pn_id?e.pn_id.textContent:void 0},pn_trip:function(e){return e.pn.getElementsByClassName("postertrip")[1]},trip:function(e){return e.pn_trip?e.pn_trip.textContent:void 0},time_unit:1e3,com:function(e){return e.pn.getElementsByClassName("postMessage")[0].innerHTML},sub:"DEFAULT.post_html",img2src:"DEFAULT.post_html",img2ext:"DEFAULT.post_html",proto:"DEFAULT.page_html"},post_json:{proto:"DEFAULT.post_json"},archive_html:{ths:function(e){for(var t=Array.prototype.slice.call(e.pn.getElementById("arc-list").getElementsByTagName("tr")).slice(1,pref.scan.max_archive+1),n=0;n<t.length;n++)t[n].parentNode.removeChild(t[n]);return this.ths_array(e,t)},no:function(e){return parseInt(e.pn.getElementsByTagName("td")[0].textContent,10)},sub:function(e){var t=e.pn.getElementsByTagName("td")[1].firstChild;return"B"===t.tagName?t.textContent:""},com:function(e){return e.pn.getElementsByTagName("td")[1].lastChild.textContent},nof_posts:function(){},nof_files:function(){},filename:function(){return""},footer:function(){return document.createElement("div")},proto:"catalog_html"},html_template:{get id(){return this.exe_sub("id")},get pn_id(){return this.exe_sub("pn_id")},get country(){return this.exe_sub("country")},get trip(){return this.exe_sub("trip")},get pn_trip(){return this.exe_sub("pn_trip")},get pn_name(){return this.exe_sub("pn_name")},get tFlag(){return this.exe_sub("tFlag")}}},popups_posts_class_hlt:"highlight",popups_href2dbtp:function(e){var t=e.split(/[\/#]/),n=t.length,a=t[n-1].substr(1),r=n>=2&&t[n-2]||site.no,o=n>=4&&t[n-4]?"/"+t[n-4]+"/":site.board;if("catalog"===t[n-2])a="",r="",o=n>=3&&t[n-3]?"/"+t[n-3]+"/":site.board;else if("/"===e[0])if("/"===e[1]){if(0!==e.indexOf("//boards.4chan"))return[];a=n>=7?t[6].slice(1):"",r=n>=6?t[5]:"",o=n>=4?"/"+t[3]+"/":site.board}else 5!=n&&(a=n>=5?t[4].slice(1):"",r=n>=4?t[3]:"",o="/"+t[1]+"/");return["4chan",o,r,a]},update_posts_remove:function(e,t,n){pref.debug_mode[13]&&e.posts[t].pn.parentNode.parentNode!==n&&console.log(e.posts[t].pn);var a=e.posts[t].pn.parentNode,r=0==t?a.nextSibling:null;n.removeChild(a),r&&"SPAN"===r.tagName&&n.removeChild(r)},update_posts_insert:function(e,t,n,a,r){var o=a<t.length?t[a].pn.parentNode:null;e[n].pn||(e[n].pn=this.post_json2html(e[n],e[n].board));var s=e[n].pn.parentNode||this.post_container(e[n].pn,e[n].no),i=0==n?s.nextSibling:null;r.insertBefore(s,o),i&&"SPAN"===i.tagName&&r.insertBefore(i,o)},update_posts0_class:function(e,t){site2.DEFAULT.update_posts0_class(e,t);var n=e.parentNode&&e.parentNode.nextSibling;n&&n.classList.contains("summary")&&site2.DEFAULT.update_posts0_class(n,t)},post_container:function(e,t,n){var a=document.createElement("div");return a.setAttribute("id","pc"+t),a.setAttribute("class","postContainer "+(n?"op":"reply")+"Container"),n||(a.innerHTML='<div class="sideArrows" id="sa'+t+'">&gt;&gt;</div>'),a.appendChild(e),a},remove_backlink:function(e,t){var n=e&&e.getElementsByClassName("backlink")[0],a=n&&n.childNodes[t];a&&n.removeChild(a)},add_backlinks_bks:function(){var e=document.createElement("div");return e.setAttribute("class","backlink"),function(){return e.cloneNode(!1)}}(),add_backlinks_add_1:function(){var e=document.createElement("a");e.setAttribute("class","quotelink");var t=document.createElement("span");return t.appendChild(e),t.appendChild(document.createTextNode(" ")),function(n,a){e.setAttribute("href",a[5]),e.textContent=a[4];var r=t.cloneNode(!0);if("4chan"!==a[0]||pref.test_mode[91]){r.firstChild.onclick=this.backlink_onclick}n.appendChild(r)}}(),add_backlinks_bks_query:function(e){return e.getElementsByClassName("backlink")[0]},add_backlinks_bks_append:function(e,t){e.getElementsByClassName("desktop")[0].appendChild(t)},toplevel_anchor_pos:2,link_dbtp2href:function(e,t){return(e[1]!=site.board||e[2]!=site.no?e[1]+"thread/"+e[2]:"")+"#"+(t?"q":"p")+e[3]},backlink_onclick:function(){highlightReply.call(this,parseInt(this.textContent.substr(2),10))},backlink_parent_prevSib:function(e){return e.getElementsByClassName("postNum")[1]},post_com2txt:function(e){return e.com?this.post_com2txt_finisher(e.com.replace(/<[^>]*>/g," ").replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&quot;/g,'"').replace(/&#039;/g,"'").replace(/&#0*44;/g,",").replace(/&amp;/g,"&"),e):""},post_json2html:function(e,t,n,a,r){void 0===r&&(r=e.op||e.resto||e.no),void 0===n&&(n=0===e.resto||e.no==e.op);var o=document.createElement("div"),s=e.parse_funcs&&e.parse_funcs.time_unit||1,i=new Date((e.time||0)*s),l=e.name||"Anonymous";if(e.ext){var c=(.005+(e.fsize>1048576?e.fsize/1048576:e.fsize/1024)).toString();c=c.substr(0,c.indexOf(".")+3)+(e.fsize>1048576?" MB":" KB");var p=site2[e.domain].catalog_json2html3_src(e,t),_=site2[e.domain].catalog_json2html3_thumbnail(e,t),d=n?1:(e.tn_w>e.tn_h?e.tn_w:e.tn_h)/125,u='<div class="file" id="f'+e.no+'"><div class="fileText" id="fT'+e.no+'">File: <a '+(e.filename.length>30?'title="'+e.filename+e.ext+'" ':"")+'href="'+p+'" target="_blank">'+(e.spoiler?"Spoiler Image":e.filename.length>30?e.filename.slice(0,25)+"(...)":e.filename)+e.ext+"</a> ("+c+", "+e.w+"x"+e.h+')</div><a class="fileThumb" href="'+p+'" target="_blank"><img src="'+_+'" alt="'+c+'" data-md5="'+e.md5+'" style="height: '+(e.spoiler?100:n?e.tn_h:e.tn_h/d)+"px; width:"+(e.spoiler?100:n?e.th_w:e.tn_w/d)+'px;"><div data-tip="" data-tip-cb="mShowFull" class="mFileInfo mobile">'+c+" "+e.ext.substr(1).toUpperCase()+"</div></a></div>"}var f=[e.domain,t,r,e.no];return o.innerHTML='<div id="p'+e.no+'" class="post reply"><div class="postInfoM mobile" id="pim'+e.no+'">'+this.post_json2html_nameblock(e,l,!1)+'<span class="dateTime postNum" data-utc="'+e.time+'">'+site2.common.change_utc_to_local(i)+"</span></div>"+(e.ext&&n?u:"")+'<div class="postInfo desktop" id="pi'+e.no+'"><input type="checkbox" name="'+e.no+'" value="delete"> '+(e.sub?'<span class="subject">'+e.sub+"</span> ":"")+this.post_json2html_nameblock(e,l,!0)+'<span class="dateTime" data-utc="'+e.time+'">'+site2.common.change_utc_to_local(i)+'</span> <span class="postNum desktop"><a href="'+this.link_dbtp2href_abs(f)+'" title="Link to this post">No.</a><a href="'+this.link_dbtp2href_abs(f,!0)+'" title="Reply to this post">'+e.no+"</a></span> &nbsp; "+(n?'<span>[<a href="'+site2[e.domain].make_url4([e.domain,t,e.no,"thread_html"])[0]+'" class="replylink">Reply</a>]</span>'+(a?a.replace(/>\[/g,">").replace(/<a/g,"<span>[<a").replace(/\]<\/a/g,"</a>]</span"):""):"")+"</div>"+(e.ext&&!n?u:"")+'<blockquote class="postMessage" id="m'+e.no+'">'+(e.com||"")+"</blockquote></div>",o.removeChild(o.childNodes[0])},post_json2html_nameblock:function(e,t,n){var a;return'<span class="nameBlock"><span class="name">'+t+"</span> "+(e.trip?'<span class="postertrip">'+e.trip+"</span> ":"")+(e.capcode?'<strong class="capcode hand id_mod" title="Highlight posts by Moderators">##'+e.capcode+"</strong>":"")+(e.since4pass?'<span title="Pass user since '+e.since4pass+'" class="n-pu"></span>':"")+(e.id?'<span class="posteruid id_'+e.id+'">(ID: <span class="hand" title="Highlight posts by this ID"'+(n?(a=this.post_json2html_colorID(e),' style="color: '+a[1]+"; background-color: rgb("+a[0]+');"'):"")+">"+e.id+"</span>)</span> ":"")+site2["4chan"].post_flag2html(e)+(n?"</span> ":"<br></span>")},post_flag2html:function(e){return e.troll_country?'<img src="//s.4cdn.org/image/country/troll/'+e.troll_country.toLowerCase()+'.gif" alt="'+e.troll_country+'" title="'+e.country_name+'" class="countryFlag">':e.country?"<span "+(e.country_name?'title="'+e.country_name+'" ':"")+'class="flag flag-'+e.country.toLowerCase()+'"></span>':""},post_json2html_colorID:function(e){for(var t=0,n=0;n<e.id.length;n++)t=(t<<5)-t+e.id.charCodeAt(n);var a=t>>24&255,r=t>>16&255,o=t>>8&255;return[a+","+r+","+o,.299*a+.587*r+.114*o>125?"black":"white"]},page_json2html3_skelton:function(e){var t=document.createElement("div");return t.setAttribute("class","thread"),t.setAttribute("id","t"+e.no),t},page_json2html3:function(e,t,n,a,r){var o=this.page_json2html3_skelton(e),s=r&&e.posts[0].pn&&e.posts[0].pn.cloneNode(!0)||this.post_json2html(e.posts&&e.posts[0]?e.posts[0]:e,e.board,!0,site2[e.domain].short_link(e.key,e.nof_posts,2,"[Last "," Posts]"),e.posts[0].no);if(s.setAttribute("class","post op"),o.appendChild(this.post_container(s,e.posts[0].no,!0)),e.posts[0].pn=s,e.posts){for(var i=1;i<e.posts.length;i++){var l=r&&e.posts[i].pn&&e.posts[i].pn.cloneNode(!0)||this.post_json2html(e.posts[i],e.board);o.appendChild(this.post_container(l,e.posts[i].no)),e.posts[i].pn=l}this.page_json2html3_add_omitted_info(e,e.posts,e.posts)}return o},page_json2html3_replace_expander:function(e,t,n){var a=e[0].pn.parentNode.parentNode.getElementsByClassName("summary")[0];a&&a.appendChild(cnst.config_expander(n,t))},page_json2html3_add_omitted_info:function(e,t,n){for(var a=0,r=1;r<n.length;r++)a+="html"===n[r].type_data?n[r].pn.getElementsByClassName("file").length:n[r].filename?1:0;var o=e.nof_files-a,s=e.nof_posts-n.length,i=t?this.parse_funcs.page_html.get_omitted_info(t[0]):null;return 0!=s?(i||(i=document.createElement("span"),i.setAttribute("class","summary"),i.innerHTML='<img class="extButton expbtn" title="Expand thread" alt="+" data-cmd="expand" data-id="'+n[0].no+'" src="//s.4cdn.org/image/buttons/burichan/post_expand_plus.png"><span class="summary"></span><span style="display: none;">Showing all replies.</span>',("4chan"!==e.domain||pref[cataLog.embed_mode].use_expander_always)&&i.appendChild(cnst.config_expander(e.key)),t&&this.parse_funcs.page_html.set_omitted_info(t[0],i)),i.childNodes[1].textContent=s+(1==s?" reply":" replies")+(o?" and "+o+" image"+(1!==s?"s":""):"")+" omitted.",e.domain!==site.nickname&&(i.childNodes[0].style.display="none")):i&&(i.childNodes[1].textContent="Showing all replies."),i},catalog_json2html3_thumbnail:function(e,t){return e.ext?e.spoiler?"//s.4cdn.org/image/spoiler-a1.png":this.protocol+"//i.4cdn.org"+t+e.tim+"s"+(".jpg"===e.ext||".png"===e.ext||".gif"===e.ext||".webm"===e.ext?".jpg":e.ext):""},catalog_json2html3_src:function(e,t){return e.ext?this.protocol+"//i.4cdn.org"+t+e.tim+e.ext:""},catalog_json2html3:function(e,t,n,a){var r=document.createElement("div");return r.setAttribute("class","thread"),r.setAttribute("id","thread-"+e.no),r.innerHTML='<a href="'+this.protocol+"//boards.4chan.org"+e.board+"thread/"+e.no+(e.sub?"/"+e.sub.replace(/ /,"-"):"")+'"><img alt="" id="thumb-'+e.no+'" class="thumb"'+(e.tn_w?'width="'+("small"===this.catalog_native_size?3*e.tn_w/5:e.tn_w)+'"':"")+(e.tn_h?'height="'+("small"===this.catalog_native_size?3*e.tn_h/5:e.tn_h)+'"':"")+"src="+n+' data-id="'+e.no+'"></a><div title="(R)eplies / (I)mages" id="meta-'+e.no+'" class="meta">'+(a?"R: <b>"+e.nof_posts+"</b> / I: <b>"+e.nof_files+"</b>":"")+'</div><div class="teaser">'+(e.sub?"<b>"+e.sub+"</b>":"")+(e.com?(e.sub?": ":"")+e.com:"")+"</div>",r.childNodes[0].childNodes[0].addEventListener("load",site2["4chan"].catalog_json2html3_onload,!1),r},catalog_json2html3_onload:function(){this.removeEventListener("load",site2["4chan"].catalog_json2html3_onload,!1),this.tn_w&&this.tn_h||site2["4chan"].catalog_json2html3_size_changed(this),this.removeAttribute("class")},catalog_json2html3_size_changed:function(e){var t=e.naturalWidth,n=e.naturalHeight,a=(t>n?t:n)/("small"===site2["4chan"].catalog_native_size?150:250);e.setAttribute("width",t/a),e.setAttribute("height",n/a)},favicon:{__proto__:site2.DEFAULT.favicon,none:"/favicon.ico",reply:"png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAoUlEQVQ4T61TwRGAMAiTmexMDuVMOlM1XOEoAj60L20gDUlLy8dF6Kd+dM/TqTEmK6shAe4GW8zfQlLVMAGat2NVgr2dUDWJymomBRlJdUCoAEdbFZ7A4qEHw9jHCM5U/k1TiEyMkiqj8ikIgY1YCXxUUQp2NCW3F8malZno9kk9qKLKMKj4nwAScaGiETw2KRix8RWG5MhEjynB24usXusFrlPCCCmAi/UAAAAASUVORK5CYII=",reply_to_me:"png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAvUlEQVQ4T61TXRrDIAiDXWmeabvTzlSvVGb8hFIK3ct8aeUnJkSZxmLZBF+/hBvHWLafRQDY6Wn5B3WKANUhrIkIADQF0Zqxt0NGbP5PACREDhXMDFZREr22g+Wn9VmTMnj3RlqwmKTNJYNfAGi8MPD61mAvEnzAZlDZmA0xs7q08Q7AW5wCVC54aWaxl4A5qFWVCyE+DF830Tf7Kd/ZCBb/BwBFyMgkxNyJgVKFv5CTXeWYM4DqLsTHlD33Lx2GzAg15eTiAAAAAElFTkSuQmCC"},stats_ID:function(e,t,n){n.sID||(n.sID={ids:{},cs:{},nid:0,nc:0,np:0,h:null});var a=n.sID;if(e.unique_ips&&(a.np=e.unique_ips,!e.id&&e.posts)){a.h||(a.h=[]);var r=a.h.length;a.h[r-3]!=e.posts[e.posts.length-1].no||a.h[r-2]!=e.nof_posts||a.h[r-1]!=e.unique_ips?a.h.push(e.posts[e.posts.length-1].no,e.nof_posts,e.unique_ips):e.nof_posts<n.nof_posts&&scan.list_nup.add(n,0,!0)}if(t&&t.length>0&&(e.id||e.country))for(var o=0;o<t.length;o++){var s=t[o].country;if(s&&(a.cs[s]?a.cs[s]++:(a.cs[s]=1,a.nc++)),t[o].id){var i=(s||"")+t[o].id;a.ids[i]?a.ids[i]++:(a.ids[i]=1,a.nid++)}}return 1==e.nof_posts?(a.np=1,!1):t&&t.length>0&&pref.threadStats.full&&!e.id&&!e.unique_ips},get_icon:function(e,t,n,a){return"sticky"==n?e.getElementsByClassName("stickyIcon")[0]:null},add_icon:function(e,t,n,a){var r,o="sticky"===n?this.make_tack():this.make_showAlways();return r=e.getElementsByClassName("threadIcons")[0],r||(r=document.createElement("div"),r.setAttribute("class","threadIcons"),e.insertBefore(r,e.getElementsByClassName("meta")[0])),r.appendChild(o),o}},site2["4channel"]={domain_url:"boards.4channel.org",check_func:site2["4chan"].check_func,proto:"4chan"}),pref.features.domains.meguca&&(site2.meguca1={nickname:"meguca",protocol:"https:",home:"https://meguca.org/favicon.ico",domain_url:"meguca.org",domain_url_image:"meguca.org",features:{page:!1,graph:!1,setting2:!1,thread_reader:!1},components:{boardlist:"#navTop"},pref_default:{catalog:{image_hover:!0}},boards_json:{boards:[{board:"a"},{board:"an"},{board:"cr"},{board:"g"},{board:"v"}]},check_func:function(){var e=window.location.href;return e.indexOf("/meguca.org/")!=-1?(site.whereami=e.indexOf("/catalog")!=-1?"catalog":e.search(/page[0-9]/)!=-1?"page":e.search(/[0-9]+$/)!=-1?"thread":"other",site.config("meguca.org",this.nickname),site.max_page=3,site.header_height=function(){var e=document.getElementById("banner");return e?e.offsetHeight:0},!0):(this.prep_own_posts(),!1)},make_url4:function(e){var t=this.protocol+"//"+this.domain_url;return"page_json"===e[3]&&0==e[2]&&(e[3]="catalog_json"),"page_html"===e[3]?[t+(0!=e[2]?parseInt(e[2],10)+1:""),"html"]:"catalog_json"===e[3]?[t+"/api/board"+e[1].substr(0,e[1].length-1),"json"]:"thread_html"===e[3]?[t+e[1]+e[2],"html"]:"thread_json"===e[3]?[t+"/api/thread/"+e[2],"json"]:void 0},catalog_get_native_area:function(){return"catalog"===site.whereami?document.getElementById("catalog"):document.getElementsByName("postcontrols")[0]},catalog_native_prep:function(e,t,n,a){var r="catalog"===site.whereami?document.getElementsByTagName("threads")[0].getElementsByTagName("aside")[0]:document.getElementsByName("postcontrols")[0];if("catalog"===site.whereami){for(var o=document.createElement("span");n.firstChild;)o.appendChild(n.firstChild);n=o,n.appendChild(n.removeChild(n.childNodes[3]).firstChild),n.setAttribute("style","float:right")}else if("page"===site.whereami){var s=document.getElementsByName("postcontrols")[0];s.parentNode.insertBefore(document.createElement("hr"),s.nextSibling)}site.whereami,r.parentNode.insertBefore(n,r),r.parentNode.insertBefore(t,document.getElementById("catalog"));var i=t.getElementsByTagName("select")["catalog.indexing"];i.setAttribute("style","float:left"),"catalog"===site.whereami?r.parentNode.insertBefore(i,r):n.childNodes[3].insertBefore(i,n.childNodes[3].firstChild),r.setAttribute("style","float:left"),r.parentNode.insertBefore(n.childNodes[3],r.nextSibling)},catalog_json2html3:function(e,t,n,a){var r=document.createElement("article"),o=site2[e.domain].make_url4([e.domain,e.board,e.no,"thread_html"])[0],s=e.tn_w||e.posts[0].tn_w,i=e.tn_h||e.posts[0].tn_h,l=150/(s>i?s:i),c=site2[e.domain].historyAPI&&pref.pref2.meguca.historyAPI?"history":"",p=c+" "+pref.script_prefix+"_link",_=site2[e.domain].short_link(e.key,e.nof_posts,1,"Last ","");return r.innerHTML='<a target="_blank" rel="nofollow" href="'+o+'"'+(c?' class="'+c+'"':"")+'><img src="'+n+'" width="'+s*l+'" height="'+i*l+'" class="expanded"></a><br><small><span title="Replies/Images">'+(a?e.nof_posts-1+"/"+(e.nof_files-1):"")+'</span><span class="act expansionLinks"><a href="'+o+'" class="'+p+'">Expand</a>'+(_?"] ["+_:"")+"</span></small><br>"+(e.sub?"<h3>"+e.sub+" </h3>":"")+(e.com?e.com:""),r},mark_newer_posts:function(e,t,n,a){return site2.DEFAULT.mark_newer_posts("meguca",e.getElementsByTagName("article"),t,null,n,a)},prep_own_posts_event:function(e){e&&"mine"===e.key&&site2.meguca.prep_own_posts(),"meguca"===window.name&&send_message("parent",["OWN_POSTS",window.name,site3[window.name].own_posts.ALL])},prep_own_posts_event_received:function(e){site3[this.nickname].own_posts.ALL=e},prep_own_posts:function(e){if(!site3[this.nickname].own_posts.ALL){site3[this.nickname].own_posts.ALL={};for(var t=["/a/","/an/","/cr/","/g/"],n=0;n<t.length;n++)site3[this.nickname].own_posts[t[n]]=Object.create(site3[this.nickname].own_posts.ALL)}if(localStorage){var a=JSON.parse(localStorage.mine||"{}");for(var r in a)site3[this.nickname].own_posts.ALL[r]=null}},wrap_to_parse:{get:site2.DEFAULT.wrap_to_parse.get,posts:function(e){delete Object.getPrototypeOf(e.posts[0]).com}},short_link:function(e,t,n,a,r){var o=this.make_url4(common_func.name2dbt(e))[0],s=pref.script_prefix+"_link";return(!n||n>1?'<a href="'+o+'?last=50" class="'+s+'">'+a+"50"+r+"</a>":"")+'<a href="'+o+'?last=100" class="'+s+'">'+a+"100"+r+"</a>"},catalog_json2html3_src:function(e){return e.image?"/static/src/"+e.image.src:void 0},catalog_json2html3_thumbnail:function(e){return e.image?"/static/"+(void 0===e.image.spoiler||pref[cataLog.embed_mode].open_spoiler_image?void 0!==e.image.thumb?"thumb/"+e.image.thumb:"src/"+e.image.src:"spoil/spoilers"+e.image.spoiler+".png"):void 0},post_json2html_fname_server:function(e){return e.image?e.image.src:void 0},post_json2html_fname:function(e){return e.image?e.image.imgnm:void 0},popups_href2dbtp:function(e){var t=e.split(/[\/#]/),n=t[t.length-1],a=t[t.length-2];return["meguca","/"+t[t.length-3]+"/",a,n]},link_dbtp2href:function(e){return e[1]+e[2]+"#"+e[3]},time_offset:-5,parse_funcs:{post_json:{get no(){return this.num},get sub(){return this.subject},name:"Anonymous",get txt(){return this.body},get com(){return this.body?this.body.replace(this.anchor_regex,this.anchor_func):""},get filename(){return this.image?this.image.imgnm:void 0},get w(){return this.image?this.image.dims[0]:void 0},get h(){return this.image?this.image.dims[1]:void 0},get tn_w(){return this.image?void 0===this.image.spoiler||pref[cataLog.embed_mode].open_spoiler_image?this.image.dims[2]:250:void 0},get tn_h(){return this.image?void 0===this.image.spoiler||pref[cataLog.embed_mode].open_spoiler_image?this.image.dims[3]:250:void 0},get fsize(){return this.image?this.image.size:void 0},get ext(){return this.image?this.image.ext:void 0},domain:"meguca",get domain_html(){return site.nickname},get parse_funcs_html(){return site2[site.nickname].parse_funcs[site.whereami+"_html"]},anchor_regex:/(>>)([0-9]+)/g,pn:void 0},thread_json:{ths:function(e,t){for(var n={board:t.board,anchor_func:function(){var e=['<a href="'+t.board+t.thread+"#",'">&gt;&gt;',"</a>"];return function(t,n,a){return e[0]+a+e[1]+a+e[2]}}(),get com(){return this.body},__proto__:site2[t.domain].parse_funcs.post_json},a=0;a<e.length&&void 0===e[a].state;)e[a++].__proto__=n;return a!==e.length&&e.splice(a,e.length-a),[{posts:e,nof_posts:e.length,key:t.domain+t.board+t.thread,no:t.thread,__proto__:t}]},get_op_src:function(e){return site2[e.domain].protocol+"//"+site2[e.domain].domain_url+"/static/src/"+e.posts[0].image.src},op_img_url:function(e){return site2[e.domain].protocol+"//"+site2[e.domain].domain_url+"/static/"+site2.meguca.catalog_json2html3_thumbnail(e.posts[0])},nof_files:function(e){return e.posts[0].imgctr-1},time:function(e){return e.posts[0].time},time_posted:function(e){return e.posts[e.posts.length-1].time},time_created:function(e){return e.posts[0].time},time_bumped:function(e){for(var t=e.posts.length-1;t>0;){if(!e.posts[t].email||"sage"!==e.posts[t].email)return e.posts[t].time;t++}return e.posts[0].time},sticky:function(e){return!1},com:function(e){return e.posts[0].body},sub:function(e){return e.posts[0].sub},name:function(e){return e.posts[0].name},filename:function(e){return e.posts[0].image.imgnm},type_com:"txt",time_unit:1,add_op_img_url:function(e,t,n){for(var a=0;a<e.length;a++)e[a].image&&(e[a].op_img_url=site2[n].protocol+"//"+site2[n].domain_url+"/static/thumb/"+e[a].image.thumb)},footer:"catalog_html",footer_prep:"catalog_html",proto:"DEFAULT.thread_json"},catalog_html:{footer:function(e){return e.pn.getElementsByClassName("counters")[0]},footer_prep:function(e){e.footer.textContent=""},ths:function(e){if(!pref.pref2.meguca.historyAPI)for(var t=e.pn.getElementsByClassName("history"),n=t.length-1;n>=0;n--)"Expand"===t[n].textContent||"Last 100"===t[n].textContent?t[n].setAttribute("class",pref.script_prefix+"_link"):t[n].removeAttribute("class");var a=this.ths_array(e,e.pn.getElementsByTagName("article"));if("/all/"===site.board)for(var n=a.length-1;n>=0;n--)a[n].board=a[n].pn.getElementsByTagName("a")[0].getAttribute("href").replace(/\d+$/,"");return a},no:function(e){return e.pn.getElementsByTagName("a")[0].getAttribute("href").replace(/.*\//g,"")},time_bumped:function(e){},time_created:function(e){},nof_posts:function(e){return parseInt(e.footer.textContent.split("/")[0],10)},nof_files:function(e){return parseInt(e.footer.textContent.split("/")[1],10)},sub:function(e){var t=e.pn.getElementsByTagName("h3")[0];return t?common_func.escape(t.textContent):void 0},name:function(e){},com:function(e){return e.pn.childNodes[e.pn.childNodes.length-1].textContent},sticky:function(e){return!1},op_img_url:function(e){var t=e.pn.getElementsByTagName("img")[0];return t&&t.getAttribute("src")||""},get_op_src:function(e){return e.op_img_url.replace(/thumb/,"src")},dynamic_image_hover:!0,missing_info:1,img2src:function(e,t){if(t||(t=this.get_lth_from_node(e)),!t)return null;var n=e.src;return t.th&&t.th.posts[0].ext?n=n.replace(/thumb/,"src").replace(/\.\w+$/,t.th.posts[0].ext):t.th.parse_funcs.missing_info&&scan.scan_ui("image_hover",{tgts:[t.key],options:{callback:function(){cataLog.image_hover_reentry(e)},priority:6}}),n}},post_html:{time_pn:function(e){var t=e.getElementsByTagName("time")[0];return Date.parse(t.title||t.textContent)+36e5*(pref.localtime_offset-site2.meguca.time_offset)},pn_name:function(e){return e.pn.getElementsByClassName("name")[0]}}},general_event_handler:{page:{mouseover:function(e){}},catalog:{image_hover_check_mode:function(e){return"catalog"===e.parentNode.parentNode.parentNode.parentNode.id?"catalog":"page"},recSearch_thread:function(e,t){for(;e&&e!=t;){if(e.classList&&e.classList.contains("op"))return e;e=e.parentNode}return null},__proto__:site2.DEFAULT.general_event_handler.catalog}},favicon:{__proto__:site2.DEFAULT.favicon,none:"/static/favicon.ico",reply:"/static/css/ui/unreadFavicon.ico",reply_to_me:"/static/css/ui/replyFavicon.ico"},make_tack:function(){var e=document.createElement("div");return e.innerHTML='<svg class="sticky" xmlns="http://www.w3.org/2000/svg" width="8" height="8" viewBox="0 0 8 8"><path d="M1.34 0a.5.5 0 0 0 .16 1h.5v2h-1c-.55 0-1 .45-1 1h3v3l.44 1 .56-1v-3h3c0-.55-.45-1-1-1h-1v-2h.5a.5.5 0 1 0 0-1h-4a.5.5 0 0 0-.09 0 .5.5 0 0 0-.06 0z"></path></svg>',e.childNodes[0]}},site2.meguca2={home:"https://meguca.org/assets/favicons/default.ico",components:{boardlist:"#banner"},boards_json:void 0,check_func:function(e){var t=window.location.href;if(t.indexOf("/meguca.org/")!=-1){if(site.whereami=t.search(/[A-z]+\/(\?page=\d+)*$/)!=-1?"page":t.search(/[0-9]+(\?last=\d+)*$/)!=-1?"thread":t.search(/catalog\/*$/)!=-1?"catalog":"other",site.config("meguca.org",this.nickname,e),site.no="thread"===site.whereami?parseInt(t.replace(/.*meguca\.org\/\w*\/([0-9]+)/,"$1"),10):"","page"===site.whereami){var n=t.indexOf("?page=");site.page=n!=-1&&parseInt(t.substr(n+6),10)||0}else site.page=null;if(e)return;return site.max_page=3,site.header_height=function(){var e=document.getElementById("banner");return e?e.offsetHeight:0},!0}return!1},check_func_whereami:function(){},utilize_boards_json:!0,url_boards_json:function(){return["https://meguca.org/json/boardTimestamps","json"]},postprocess_board:function(e){var t=0;for(var n in e){var a=liveTag.mems.init({domain:this.nickname,board:"/"+n+"/"});a.o=t++,Object.defineProperty(a,"max",{value:e[n],writable:!0}),void 0===a.read_max&&Object.defineProperty(a,"read_max",{value:0,writable:!0})}},make_url4:function(e){var t=this.protocol+"//"+this.domain_url;return"page"===e[3].substr(0,4)&&0==e[2]&&(e[3]="catalog_json"),"catalog_json"===e[3]?[t+"/json"+e[1],"json","meguca"+e[1]+"j0"]:"thread_html"===e[3]?[t+e[1]+e[2],"html"]:"thread_json"===e[3]?[t+"/json"+e[1]+e[2],"json"]:void 0},catalog_get_native_area:function(){return document.getElementById("catalog"===site.whereami?"catalog":"page"===site.whereami?"index-thread-container":"threads")},catalog_get_native_scroll_area:function(){return"catalog"===site.whereami?document.getElementsByTagName("section")[1]:window},catalog_native_prep_wait_loop_timeout:100,catalog_native_prep_wait_loop:function(e,t){--this.catalog_native_prep_wait_loop_timeout<0||(("catalog"!==e||document.getElementsByName("sortMode")[0])&&("page"!==e||document.getElementById("catalog-controls")&&document.getElementById("index-thread-container"))&&("thread"!==e||document.getElementById("expand-images")&&document.getElementById("threads"))?t():setTimeout(function(){this.catalog_native_prep_wait_loop(e,t)}.bind(this),1e3))},catalog_native_prep:function(e,t,n,a){var r="catalog"===site.whereami?document.getElementsByName("sortMode")[0]:"page"===site.whereami?document.getElementById("catalog-controls").getElementsByTagName("input").search:document.getElementById("expand-images");if("catalog"!==site.whereami||r.nextSibling!==cataLog.components.catalog.indexing){if(!cataLog.components.initialized){n.setAttribute("style","float:right"),cataLog.components.pn12_0=n,cataLog.components.pn_hi=n.removeChild(n.childNodes[3]);var o=function(){cataLog.catalog_obj2.func_track_reset(),cataLog.insert_myself(null,null,null,!0),cataLog.show_catalog()},s=function(e){pref[site.whereami].embed&&(cataLog.general_event_handler.destroy(),cataLog.triage_parent_set(),cataLog.general_event_handler=new cataLog.GEH(cataLog.parent),cataLog.general_event_handler.init(),o(),site2.meguca.catalog_native_prep(null,t,n))};new MutationObserver(s).observe(document.getElementById("threads"),{childList:!0}),pref_func.settings.onchange_funcs.button_test=s;var i=document.getElementById("loading-image"),l="none"!==i.style.display,c=function(e){if("none"!==e[0].target.style.display)site2.meguca.historyAPI_blocking=!0,"thread"===site.whereami&&site2.meguca.prep_own_posts();else{if(site2.meguca.historyAPI_blocking=!1,!l){cataLog.DIH.image_hover_remove(),cataLog.general_event_handler.destroy();for(var a in cataLog.threads)cataLog.gClg.remove_thread(a,!0);site2.meguca.check_func(!0),pref[site.whereami].embed&&(cataLog.set_embed_xxxx(),cataLog.triage_parent_set(),cataLog.general_event_handler=new cataLog.GEH(cataLog.parent),
cataLog.general_event_handler.init(),"catalog"!==site.whereami&&"page"!==site.whereami||pref.test_mode[90]||o(),site2.meguca.catalog_native_prep(null,t,n)),recovery.reentry(),receive_message_emu()}l=!1}};new MutationObserver(c).observe(i,{attributes:!0})}if("catalog"===site.whereami?(r.parentNode.appendChild(n),r.parentNode.parentNode.insertBefore(cataLog.components.pn_hi,r.parentNode)):(r.parentNode.insertBefore(n,r),r.parentNode.insertBefore(cataLog.components.pn_hi,r)),"catalog"===site.whereami){var p=document.getElementById("catalog");p.parentNode.insertBefore(t,p)}else r.parentNode.insertBefore(t,document.getElementById("catalog"));"catalog"===site.whereami?site2.DEFAULT.catalog_native_prep_swap_sortSel(r):r.parentNode.insertBefore(cataLog.components.catalog.indexing,r.nextSibling),"catalog"!=site.whereami&&"page"!=site.whereami||(document.getElementById("banner").style="height:auto",pref3.catalog.filter.kwd.init(document.getElementById("catalog-controls").getElementsByTagName("input").search,t)),cataLog.components.initialized=!0}},post_json2html:site2["4chan"].post_json2html,page_json2html3_skelton:site2["4chan"].page_json2html3_skelton,page_json2html3:site2["4chan"].page_json2html3,page_json2html3_replace_expander:site2["4chan"].page_json2html3_replace_expander,page_json2html3_add_omitted_info:site2["4chan"].page_json2html3_add_omitted_info,post_container:site2["4chan"].post_container,wrap_to_parse:site2.DEFAULT.wrap_to_parse,catalog_json2html3_thumbnail:function(e){return e.image?this.protocol+"//"+this.domain_url_image+(void 0===e.image.spoiler||pref[cataLog.embed_mode].open_spoiler_image?14===e.image.thumbType?"/audio.png":"/images/thumb/"+e.image.SHA1+(0===e.image.thumbType||void 0===e.image.thumbType&&0===e.image.fileType?".jpg":".png"):"/spoil/default.jpg"):void 0},catalog_json2html3_src:function(e){return e.image?this.protocol+"//"+this.domain_url_image+"/images/src/"+e.image.SHA1+(e.ext||Object.getOwnPropertyDescriptor(this.parse_funcs.post_json_template,"ext").get.call(e)):void 0},post_json2html_fname_server:function(e){return e.image?e.image.SHA1+(0===e.image.fileType?".jpg":".png"):void 0},post_json2html_fname:function(e){return e.image?e.filename+e.ext:void 0},parse_funcs:{page_html:{get_omitted_info:site2["4chan"].parse_funcs.page_html.get_omitted_info,set_omitted_info:site2["4chan"].parse_funcs.page_html.set_omitted_info,replace_omitted_info:site2["4chan"].parse_funcs.page_html.replace_omitted_info,replace_omitted_info2:site2["4chan"].parse_funcs.page_html.replace_omitted_info2},thread_json:{ths:function(e,t){var n=this.prep_th_posts(e);return n.nof_posts=n.posts.length,e.__proto__=t,[n]},prep_th_posts:function(e){var t=Object.create(e);t.sticky&&(t.sticky=!0),t.board="/"+e.board+"/",e.no=e.id||e.no,delete e.id;var n=[e];if(e.posts)for(var a=0;a<e.posts.length;a++){var r=e.posts[a];r.id&&(r.no=r.id,delete r.id),n[n.length]=r}return t.posts=n,t},get_op_src:function(e){return site2[e.domain].catalog_json2html3_src(e.posts[0])},op_img_url:"DEFAULT.common",time_unit:1e3,type_com:"txt",posts_full:null,has_editing:!0,posts_obj:function(e,t){for(var n={},a=e.posts.length;--a>=0;){var r=e.posts[a].no;if(n[r]=e.posts[a],r===t)break}return n},key:"DEFAULT.common"},catalog_json:{ths:function(e,t){var n=[],a=parseInt(t.page||0,10);e.threads&&(e=e.threads);for(var r=0;r<e.length;r++){var o=this.prep_th_posts(e[r]);o.page=a+Math.floor(r/15)+"."+r%15,e[r].__proto__=t,n[n.length]=o}return n},has_posts:!0,proto:"thread_json"},shortCatalog_json_template:{proto:"catalog_json_template"},page_json_template:{proto:"catalog_json_template"},catalog_json_template:{dont_have_com:!0,get nof_posts(){return this.postCtr},proto:"thread_json_template"},thread_json_template:{get time_posted(){return 1e3*this.replyTime},get time_bumped(){return 1e3*this.bumpTime},get time_created(){return 1e3*this.time},get nof_files(){return this.imageCtr},get com(){return this.body},proto:"post_json_template"},post_json:{anchor:function(e,t,n,a,r){return r||(r=(a?"/all/":e)+"#p"+n),'<em><a class="history post-link" data-id="'+n+'" href="'+r+'">&gt;&gt;'+n+'</a><a class="hash-link history" href="'+r+'"> #</a> </em>'}},post_json_template:function(){var e=["jpg","png","gif","webm","pdf","svg","mp4","mp3","ogg","zip","7z","tar.gz","tar.xz","flac","noFile","txt"];return{get filename(){return this.image?this.image.name:void 0},get w(){return this.image?this.image.dims[0]:void 0},get h(){return this.image?this.image.dims[1]:void 0},get tn_w(){return this.image?void 0===this.image.spoiler||pref[cataLog.embed_mode].open_spoiler_image?this.image.dims[2]||125:150:void 0},get tn_h(){return this.image?void 0===this.image.spoiler||pref[cataLog.embed_mode].open_spoiler_image?this.image.dims[3]||125:150:void 0},get fsize(){return this.image?this.image.size:void 0},get ext(){return this.image?"."+e[this.image.fileType]:void 0},get sub(){return this.subject?common_func.escape(this.subject):""},get capcode(){return this.auth},get md5(){return this.image?this.image.MD5:void 0},get sha1(){return this.image?this.image.SHA1:void 0},get country(){return this.flag?this.flag.toUpperCase():void 0},name:"Anonymous",get txt(){return this.body},get com(){function e(e,t,n){for(var a=r.links,s=0;s<a.length&&a[s].id!=n;)s++;return s<a.length?o(r.board,a[s].op,n,r.op!=a[s].op,null):e}function t(e){return"<strong>"+e+" ("+(this[n]?this[n++].val:"")+")</strong>"}var n,a=site2[site.nickname].parse_funcs.post_html.txt2com_anchor_class?'" class="'+site2[site.nickname].parse_funcs.post_html.txt2com_anchor_class:"",r=null,o="meguca"===site.nickname?site2.meguca.parse_funcs.post_json.anchor:function(e,t,n,r){return'<a href="'+(r?"/cross/":e)+t+"#p"+n+a+'">&gt;&gt;'+n+"</a>"},s=site2[site.nickname].parse_funcs.post_html.txt2com_spoiler_replace_txt||"<spoiler>$1</spoiler>",i="meguca"===site.nickname?"<em>$1</em>":'<span class="quote">$1</span>';return Object.defineProperty(site2.meguca.parse_funcs.post_json_template,"com",{get:function(){if(!this.body)return"";var a=common_func.escape_text(this.body);return this.links&&(r=this,a=a.replace(/(>>)([0-9]+)/g,e)),a=a.replace(/(^>[^>].*$)/gm,i),a=a.replace(/\*\*(.*?)((\*\*)|$)/gm,s),this.commands&&(n=0,a=a.replace(/^#(pyu|flip|\d*d\d+|8ball)$/gm,t.bind(this.commands))),a=a.replace(/(https*:\/\/[^\s]*)(\s|$)/gm,'<a href="$1" target="_blank">$1</a>$2'),a.replace(/\n/g,"<br>")},enumerable:!0,configurable:!0}),this.com},sticky:!1,pn:void 0,get no(){return this.id},time:void 0,flag:void 0,flags:void 0,get parse_funcs_html(){return Object.defineProperty(site2.meguca.parse_funcs.post_json_template,"parse_funcs_html",{value:site2[site.nickname].parse_funcs[site.whereami+"_html"],writable:!0,enumerable:!0,configurable:!0}),this.parse_funcs_html},proto:"DEFAULT.common"}}()},mimic_always:!0,post_com2txt:function(e){return e.body?e.body.replace(/\*\*([^(\*\*)\n]*)((\*\*)|$)/gm," $1 "):""},proto:"meguca1"},common_func.Object_modifyDescriptor(site2.meguca2,"check_func",{writable:!1}),site2.meguca={domain_url_image:"meguca.org/assets",check_func:site2.meguca2.check_func,url_boards_json:function(){return["https://meguca.org/json/board-list","json"]},postprocess_board:function(e){for(var t=0;t<e.length;t++){var n=liveTag.mems.init({domain:this.nickname,board:"/"+e[t].id+"/"});n.o=t,e[t].tags&&0!=e[t].tags.length&&liveTag.postprocess_board_add_btag(e[t].tags,n)}},utilize_boards_json:!1,catalog_get_native_scroll_area:void 0,make_url4:function(e){var t=this.protocol+"//"+this.domain_url;return"catalog_json"===e[3]?[t+"/json/boards"+e[1]+"catalog","json"]:"page_json"===e[3]?[t+"/json/boards"+e[1]+"?page="+e[2],"json"]:"thread_html"===e[3]?[t+e[1]+e[2],"html"]:"thread_json"===e[3]?[t+"/json/boards"+e[1]+e[2],"json"]:"page_html"===e[3]?[t+e[1],"html"]:void 0},historyAPI:!1,historyAPI_blocking:!1,short_link:function(e,t,n,a,r){return'<a href="'+this.make_url4(common_func.name2dbt(e))[0]+'?last=100" class="history lastN-link '+pref.script_prefix+'_link">'+a+"100"+r+"</a>"},wrap_to_parse:{get:site2.DEFAULT.wrap_to_parse.get,posts:function(e,t){site2.DEFAULT.wrap_to_parse.posts(e,t||e.localArchive&&1||void 0,{op:e.no||e.id})}},lth_init:function(e){liveTag.mems.init({board:"/cross/",domain:e.domain}),Object.defineProperty(liveTag.mems.meguca,"/cross/",{value:liveTag.mems.meguca["/cross/"],configurable:!0,enumerable:!1,writable:!0})},prep_own_posts:function(e){window.opener&&"meguca"===window.name?setTimeout(this.prep_own_posts_IDB.bind(this),0):this.prep_own_posts_IDB()},prep_own_posts_IDB:function(e){IDB.req_raw("meguca","meguca","mine",null,this.prep_own_posts_IDB_callback.bind(this),"get_all")},prep_own_posts_IDB_callback:function(e,t,n,a){var r={};for(var o in a)r[a[o].id]=null;site3[this.nickname].own_posts={ALL:r},window.opener&&"meguca"===window.name&&this.prep_own_posts_event()},popups_post_pnode:function(e){for(;"ARTICLE"!==e.tagName&&e.parentNode;)e=e.parentNode;return e},add_backlinks_pn:function(e,t){var n=e.getElementsByClassName("backlinks")[0];return n?{pn:n,hrefs:this.add_backlinks_hrefs(n,t)}:(n=document.createElement("span"),n.setAttribute("class","spaced backlinks"),e.appendChild(n),{pn:n,hrefs:{}})},add_backlinks_hrefs:function(e,t){var n={};if(t)for(var a=e.getElementsByTagName("a"),r=0;r<a.length;r++)n[a[r].getAttribute("href")]=null;else e.innerHTML="";return n},add_backlinks_add_1:function(e,t,n){var a=document.createElement("span");a.innerHTML=site2.meguca.parse_funcs.post_json.anchor(t[1],t[2],t[3],null,n),a=a.childNodes[0],("meguca"!==t[0]||pref.test_mode[91])&&(a.childNodes[0].onclick=this.backlink_onclick,a.childNodes[1].onclick=this.backlink_onclick),e.pn.appendChild(a)},add_backlinks:function(e,t,n,a){for(var r=this.add_backlinks_pn(e,n),o=n||0;o<t.length;o++){var s=this.popups_backlink2dbtpth(t[o],a),i=s[0],l=site2[i].link_dbtp2href_abs(s);if(null!==r.hrefs[l]&&this.add_backlinks_add_1(r,s,l),n)break}},popups_href2dbtp:function(e){var t=e.split(/[\/#]/),n=t[t.length-1].substr(1),a="/"+t[t.length-3]+"/",r=t[t.length-2];return r||(r=-1),["meguca",a,r,n]},toplevel_anchor_pos:2,link_dbtp2href:function(e){return e[1]+e[2]+"#p"+e[3]},popups_post_fetch:function(e,t){httpd.req({initiator:"popup",tgts:[{url:"https://meguca.org/json/post/"+t[3],responseType:"json",tgt:t[0]+"/*/"+t[2]+"#"+t[3],data_type:"json",domain:e.domain}],callback_1:site2[e.domain].popups_post_fetch_callback.bind(site2[e.domain]),IDX:0,FINISHED:0,SUC:0,max:1,dbt:t},8)},popups_post_fetch_callback:function(e,t,n){var a={domain:n.dbt[0],board:n.dbt[1],no:n.dbt[2],type_data:"json",domain_html:site.nickname,key:n.dbt[0]+n.dbt[1]+n.dbt[2]};delete t.response.board;var r={posts:[a,t.response],__proto__:a};site2[r.domain].wrap_to_parse.posts(r);var o=liveTag.mems.init(r);this.popups_fetched(r,o,1)},post_json2html_imagesearch_href:{google:function(e){return"https://www.google.com/searchbyimage?image_url="+e},iqdb:function(e){return"http://iqdb.org/?url="+e},saucenao:function(e){return"http://saucenao.com/search.php?db=999&amp;url="+e},whatAnime:function(e){return"https://whatanime.ga/?url="+e},desustorage:function(e){return"https://desuarchive.org/_/search/image/"+e},exhentai:function(e){return"http://exhentai.org/?fs_similar=1&amp;fs_exp=1&amp;f_shash="+e}},post_json2html_imagesearch_1:function(e,t,n){return'<a class="image-search '+e+'" target="_blank" rel="nofollow" href="'+this.post_json2html_imagesearch_href[e](t)+'">'+n+"</a>"},post_json2html_imagesearch:function(e,t,n,a){return(e.google?this.post_json2html_imagesearch_1("google",t,"G"):"")+(e.iqdb?this.post_json2html_imagesearch_1("iqdb",t,"Iq"):"")+(e.saucenao?this.post_json2html_imagesearch_1("saucenao",t,"Sn"):"")+(e.whatAnime?this.post_json2html_imagesearch_1("whatAnime",t,"Wa"):"")+(e.desustorage&&n?this.post_json2html_imagesearch_1("desustorage",n,"Ds"):"")+(e.exhentai&&a?this.post_json2html_imagesearch_1("exhentai",a,"Ex"):"")},post_json2html:function(e,t,n,a,r){var o=document.createElement("div"),s=e.parse_funcs&&e.parse_funcs.time_unit||1,i=new Date((e.time||0)*s),l=(e.name,""),c="";if(e.ext){var p=(.005+(e.fsize>1048576?e.fsize/1048576:e.fsize/1024)).toString();p=p.substr(0,p.indexOf(".")+3)+(e.fsize>1048576?" MB":" KB");var _=site2[e.domain].catalog_json2html3_src(e,t),d=site2[e.domain].catalog_json2html3_thumbnail(e,t);n||(e.tn_w>e.tn_h?e.tn_w:e.tn_h);l='<figcaption class="spaced"><a class="image-toggle act" hidden=""></a>'+(pref[cataLog.embed_mode].imagesearch.use?'<span class="spaced image-search-container">'+this.post_json2html_imagesearch(pref[cataLog.embed_mode].imagesearch,_,e.md,e.sha1)+"</span>":"")+'<span class="fileinfo"><span class="filesize">'+p+'</span><span class="dims">'+e.w+"x"+e.h+'</span></span><a href="'+("meguca"===e.domain?_.replace(/images\.meguca\.org/,"meguca.org"):_)+'" download="'+e.filename+e.ext+'">'+e.filename+e.ext+"</a></figcaption>",c='<figure><a target="_blank" href="'+_+'"><img src="'+d+'" width="'+e.tn_w+'" height="'+e.tn_h+'"></a></figure>'}return o.innerHTML='<article id="p'+e.no+'" class="glass'+(e.ext?" media":"")+'"><input type="checkbox" class="deleted-toggle"><header class="spaced"><input type="checkbox" class="mod-checkbox hidden"><b class="name">'+e.name+"</b>"+(e.country?'<img class="flag" src="/assets/flags/'+e.country.toLowerCase()+'.svg" title="'+e.country+'">':"")+"<time>"+site2.common.change_utc_to_local(i)+'</time><nav><a class="history" href="#p'+e.no+'">No.</a><a class="history quote" href="#p'+e.no+'">'+e.no+"</a></nav>"+(n?'<span><span class="act"><a class="history expand-link" href="'+t+e.no+'">Expand</a></span>'+(a?'<span class="act">'+a+"</span>":"")+"</span>":"")+'<a class="control"><svg xmlns="http://www.w3.org/2000/svg" width="8" height="8" viewBox="0 0 8 8"><path d="M1.5 0l-1.5 1.5 4 4 4-4-1.5-1.5-2.5 2.5-2.5-2.5z" transform="translate(0 1)"></path></svg></a></header>'+l+'<div class="post-container">'+c+"<blockquote>"+e.com+"</blockquote></div></article>",o.removeChild(o.childNodes[0])},post_container:function(e){return e},update_posts_remove:function(e,t,n){n.removeChild(e.posts[t].pn)},update_posts_insert:function(e,t,n,a,r){var o=a<t.length?t[a].pn:r.getElementsByTagName("aside")[0];e[n].pn||(e[n].pn=this.post_json2html(e[n],e[n].board));var s=e[n].pn;r.insertBefore(s,o)},page_json2html3_skelton:function(e,t){var n=document.createElement("section");return n.setAttribute("class","index-thread"),n.setAttribute("data-id",e.no),n.innerHTML='<input type="checkbox" class="deleted-toggle"><aside class="act posting glass"><a href="'+e.board+e.no+'?last=100#bottom">Reply</a></aside>',t?[n,n.childNodes[1]]:n},page_json2html3:function(e,t,n,a){var r=this.page_json2html3_skelton(e,!0),o=r[0],s=r[1],i=this.post_json2html(e.posts&&e.posts[0]?e.posts[0]:e,t,!0,site2[e.domain].short_link(e.key,e.nof_posts,2,"Last ",""),e.no);if(o.insertBefore(i,s),!a&&e.posts[0].pn||(e.posts[0].pn=i),e.posts){for(var l=1;l<e.posts.length;l++){var c=this.post_json2html(e.posts[l],t);o.insertBefore(c,s),!a&&e.posts[l].pn||(e.posts[l].pn=c)}this.page_json2html3_add_omitted_info(e,e.posts,e.posts)}return o},page_json2html3_replace_expander:function(e,t,n){var a=this.parse_funcs.page_html.get_omitted_info(e[0]);a&&a.appendChild(cnst.config_expander(n,t))},page_json2html3_add_omitted_info:function(e,t,n){for(var a=0,r=0;r<n.length;r++)a+="html"===n[r].type_data?n[r].pn.getElementsByClassName("figure").length:n[r].filename?1:0;var o=e.nof_files-a,s=e.nof_posts-n.length,i=t?this.parse_funcs.page_html.get_omitted_info(t[0]):null;return 0!=s?(i||(i=document.createElement("span"),i.setAttribute("class","omit"),i.setAttribute("data-omit",s),i.setAttribute("data-image-omit",o),i.innerHTML=' <span class="act"><a href="'+n[0].no+'" class="history">See All</a></span>',("meguca"!==e.domain||pref[cataLog.embed_mode].use_expander_always)&&i.appendChild(cnst.config_expander(e.key)),t&&this.parse_funcs.page_html.set_omitted_info(t[0],i)),i.childNodes[0].textContent=s+(1==s?" post":" posts")+(o?" and "+o+" image"+(1!==s?"s":""):"")+" omitted "):i&&(i.childNodes[0].textContent="Showing all posts."),i},catalog_json2html3:function(e,t,n,a){var r=document.createElement("article");r.id="p"+e.no,r.setAttribute("class","glass media op"+(e.deleted?" deleted":"")),r.setAttribute("data-id",e.no);var o=site2[e.domain].make_url4([e.domain,e.board,e.no,"thread_html"])[0];if(n)var s=e.tn_w||e.posts[0].tn_w,i=e.tn_h||e.posts[0].tn_h,l=150/(s>i?s:i);var c=site2[e.domain].historyAPI&&pref.pref2.meguca.historyAPI?"history":"",p=c+(c?" ":"")+pref.script_prefix+"_link",_=site2[e.domain].short_link(e.key,e.nof_posts,1,"Last ","");return r.innerHTML='<input type="checkbox" class="deleted-toggle">'+(n?'<figure><a class="'+c+'" href="'+t+e.no+'"><img width="'+s*l+'" height="'+i*l+'" class="catalog" src="'+n+'"></a></figure>':"")+'<span class="spaced thread-links hide-empty"><b class="board">'+t+'</b><span class="counters" title="Posts/Images">'+(a?e.nof_posts-1+"/"+(e.nof_files-1):"")+'</span><span class="act">'+("meguca"===e.domain?'<a class="'+c+' lastN-link" href="'+t+e.no+'?last=100">Last 100</a></span>':'<a href="'+o+'" class="'+p+' lastN-link">Expand</a>'+(_?"] ["+_:""))+"</span></span><br>"+(e.sub?"<h3>"+e.sub+" </h3>":"")+"<blockquote>"+(e.com?e.com:"")+"</blockquote>",r},mark_newer_posts:function(e,t,n,a,r){for(var o=r?[r]:site2.meguca.wrap_to_parse.get(document,"meguca",site.board,site.whereami+"_html","thread"===site.whereami?{thread:site.no}:null),s=null,i=o.length-1;i>=0;i--)s=o[i].posts[0].pn&&this.mark_newer_posts2(o[i].posts,t,n,a)||s;return s},parse_funcs:{shortCatalog_json:{has_posts:!1,proto:"meguca2.catalog_json"},catalog_json:{has_posts:!1},catalog_html:{ths_json:"thread_html",ths:function(e){for(var t=site2.meguca2.parse_funcs.catalog_html.ths(e),n=this.ths_json(e,t.map(function(e){return e.pn}),"shortCatalog_json","catalog_html"),a=0;a<n.length;a++)n[a].page=Math.floor(a/15)+"."+a%15;return n},get_omitted_info:function(){},set_omitted_info:function(){},pn_name:"thread_html"},page_json:{proto:"meguca2.catalog_json"},post_json:{pn:"DEFAULT.post_json"},page_html:{ths:function(e){for(var t=this.ths_json(e,document.getElementsByClassName("index-thread"),"page_json","page_html"),n=0;n<t.length;n++)t[n].page=site.page+"."+n;return t},get_max_page:function(e){var t,n=e.getElementsByClassName("pagination")[0];return n?(t=n.childNodes.length,t<=1?t:t-1):1},proto:"thread_html"},thread_html:{ths_json:function(e,t,n,a){var r=JSON.parse(e.pn.getElementById("post-data").innerHTML);r=site2.meguca.wrap_to_parse.get(r,"meguca",e.board,n);for(var o={},s=0;s<t.length;s++)o[t[s].dataset.id]=t[s];for(var s=0;s<r.length;s++){r[s].pn=o[r[s].no];var i=r[s].pn&&r[s].pn.getElementsByTagName("article");if(i){for(var l=0;l<r[s].posts.length;l++)r[s].posts[l].pn=i[l];Object.defineProperty(r[s],"footer",{value:this.footer(r[s]),configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(r[s],"type_mimic",{value:a,configurable:!0,enumerable:!0,writable:!0})}}return r[0].__proto__.__proto__.__proto__.parse_funcs_html=site2.meguca.parse_funcs[a],r},ths:function(e){return this.ths_json(e,[document.getElementById("thread-container")],"thread_json","thread_html")},footer:function(e){return site2.DEFAULT.parse_funcs.page_html.insert_footer4(e.pn.getElementsByClassName("deleted-toggle")[0])},get_thread_links:function(e){return e.pn.querySelectorAll(".expand-link,.lastN-link,."+pref.script_prefix+"_link")},get_omitted_info:function(e){return e.pn&&e.pn.getElementsByClassName("omit")[0]||void 0},set_omitted_info:function(e,t){t&&e.pn.appendChild(t)},replace_omitted_info:function(e,t){e.childNodes[0].textContent=t.childNodes[0].textContent},replace_omitted_info2:function(e,t,n){if(t)"none"===e.childNodes[1].style.display&&(e.insertBefore(e.childNodes[0].childNodes[0],e.firstChild),e.removeChild(e.childNodes[1]),e.childNodes[1].removeAttribute("style")),this.replace_omitted_info(e,t);else{var a=document.createElement("span");a.setAttribute("style","display:none"),e.insertBefore(a,e.childNodes[1]),a.appendChild(e.childNodes[0]),e.childNodes[1].setAttribute("style","display:none")}},pn_name:function(e){return e.pn.getElementsByClassName("name")[0].childNodes[0]}},thread_json:{prep_to_archive:function(e){return e[0].posts=e.slice(1),e[0]},proto:"meguca2.thread_json"}},favicon:{__proto__:site2.DEFAULT.favicon,none:"/assets/favicons/default.ico",reply:"/assets/favicons/unread.ico",reply_to_me:"/assets/favicons/reply.ico"},proto:"meguca2"},common_func.Object_modifyDescriptor(site2.meguca,"check_func",{writable:!1}),site2.imeguca={nickname:"imeguca",domain_url:"images.meguca.org",home:"https://images.meguca.org/assets/favicons/default.ico",check_func:site2.DEFAULT.check_func}),(pref.features.domains.lain||pref.features.domains.lainjp)&&(site2.lain={nickname:"lain",home:site.protocol+"//lainchan.org/q/index.html",X_FRAME_OPTIONS:!0,CONTENT_SECURITY_POLICY_FRAME:!0,protocol:"https:",domain_url:"lainchan.org",postform_rules:null,features:{page:!1,graph:!0,setting2:!1},boards_json:site2.DEFAULT.generate_boards_json([["λ",5],["diy",2],["sec",6],["tech",6],["inter",2],["lit",3],["music",3],["vis",3],["hum",3],["drg",3],["zzz",2],["layer",1],["q",7],["r",7]],3),check_func:function(){var e=window.location.href;return e.indexOf(this.domain_url)!==-1&&e.search(new RegExp(this.domain_url+"/*$"))==-1&&(site.whereami=e.indexOf("/catalog")!=-1?"catalog":e.indexOf("/res/")!=-1?"thread":"404"===document.title?"404":"page","thread"===site.whereami&&(site.no=parseInt(e.replace(/.*res\//,"").replace(/\.html/,""),10)),site.config(this.domain_url,this.nickname),site.max_page=7,site.header_height=function(){var e=document.getElementsByClassName("boardlist")[0];return e?e.offsetHeight:0},site.embed_to="thread"===site.whereami||"page"===site.whereami?{top:function(){return document.getElementsByName("postcontrols")[0]},bottom:function(){return document.getElementsByTagName("footer")[0]}}:"catalog"===site.whereami?{top:function(){return document.getElementsByTagName("header")[0].nextSibling},bottom:function(){return document.getElementsByTagName("footer")[0]}}:{},"thread"!==site.whereami&&"page"!==site.whereami||(site.postform=document.getElementsByTagName("form").post,site.postform&&this.postform_prep()),"lain"===this.nickname&&(styleSheet.add_to_watch(document.getElementById("stylesheet")),styleSheet.add_to_watch(document.getElementById("code_stylesheet"))),!0)},styles:[["a.dotted","border-bottom:1px dashed;"]],catalog_posts_in_thread:function(e){return e.getElementsByClassName("replyContainer")},max_page:function(){return 10},all_boards:["/popular/","/all/","/mega/","/random/","/culture/","/psy/"],make_url4:function(e){return site2.lain.all_boards.indexOf(e[1])!=-1&&"catalog_html"!==e[3]?void 0:site2.vichan.make_url4.call(this,e)},catalog_native_prep:function(e,t,n,a){var r="catalog"===site.whereami?document.getElementsByClassName("threads")[0]:document.getElementsByName("postcontrols")[0];if(site2.DEFAULT.catalog_native_prep_sel(t,n,"catalog"===site.whereami?document.getElementById("sort_by"):null),"catalog"===site.whereami){if(document.getElementById("image_size").addEventListener("change",site2.lain.catalog_native_size_changed,!1),n.style.display="inline",n.childNodes[3].style.display="inline","lain"===this.nickname)document.getElementsByClassName("controls")[0].appendChild(n);else{var o=document.getElementsByClassName("threads")[0];o.parentNode.insertBefore(n,o)}r.parentNode.insertBefore(t,r)}else{var s=document.getElementsByName("postcontrols")[0];if("lain"===this.nickname){var i=document.getElementsByClassName("blotter")[0],l=document.createElement("div");l.setAttribute("style","float:left"),l.appendChild(i.nextSibling.nextSibling),l.appendChild(i.nextSibling.nextSibling),"page"===site.whereami&&l.appendChild(document.createTextNode(" | ")),i.parentNode.insertBefore(l,i.nextSibling.nextSibling),l.parentNode.insertBefore(t,l.nextSibling),l.parentNode.insertBefore(n,l.nextSibling)}else s.parentNode.insertBefore(t,s),s.parentNode.insertBefore(n,s)}},catalog_native_size:document.getElementById("image_size")?document.getElementById("image_size").value:"small",catalog_native_size_changed:function(){site2[site.nickname].catalog_native_size=this.value},parse_funcs:{catalog_html:{sticky:function(e){return e.footer.textContent.indexOf("(sticky)")!=-1},ths:function(e){var t=this.__proto__.ths(e);if(site2.lain.all_boards.indexOf(site.board)!=-1)for(var n=t.length-1;n>=0;n--)t[n].board="/"+t[n].pn.getAttribute("data-board")+"/";for(var n=0;n<t.length;n++)t[n].page=Math.floor(n/10)+"."+n%10;return t}},page_html:{ths:function(e){var t=this.__proto__.ths(e);if(site2.lain.all_boards.indexOf(site.board)!=-1){for(var n=t.length-1;n>=0;n--){var a=site.nickname+"/"+t[n].pn.getAttribute("data-board")+"/"+t[n].no;cataLog.threads[a]?t.splice(n,1):t[n].board="/"+t[n].pn.getAttribute("data-board")+"/"}0===t.length&&cataLog.show_catalog()}return t}},catalog_json:{time_unit:1e3},post_html:{img2src:function(e){var t=e.parentNode.href;return t.search(/.webm/)!=-1&&(t=t.replace(/.*player.php\?v=/,"").replace(/&t=.*/,"")),t}}},colorID:function(e){var t=e.getElementsByClassName("poster_id")[0];if(t&&t.style&&!t.style.backgroundColor){site2.vichan.colorID(e);var n=t.previousSibling;t.textContent="ID: "+t.textContent," ID: "===n.textContent&&(n.textContent="")}},catalog_json2html3_thumbnail:function(e,t){return".jpg"===e.ext||".jpeg"===e.ext||".gif"===e.ext||".png"===e.ext||".pdf"===e.ext?"https://"+this.domain_url+t+"thumb/"+e.tim+".png":".epub"===e.ext?"https://"+this.domain_url+"/static/lain_epub.jpg":""},catalog_from_json3:function(e,t){return site2[this.nickname].wrap_to_parse.get(e,this.nickname,t,"catalog_json")},favicon:{__proto__:site2.DEFAULT.favicon,none:"/favicon.png",
reply:"png;base64,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",
reply_to_me:"png;base64,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"},proto:"vichan"}),pref.features.domains.lainjp&&(site2.lainjp={nickname:"lainjp",home:site.protocol+"//lainchan.jp/lainicon.ico",X_FRAME_OPTIONS:!0,CONTENT_SECURITY_POLICY_DATAURI:!0,CONTENT_SECURITY_POLICY_FRAME:!0,protocol:"https:",domain_url:"lainchan.jp",postform_rules:null,features:{page:!1,graph:!0,setting2:!1,postform:!0},boards_json:site2.DEFAULT.generate_boards_json([["cyb",2],["tech",2],["cult",2],["λ",1],["μ",1],["psy",1],["feels",1],["q",2],["r",1]],2),check_func:site2.lain.check_func,components:{boardlist:"#overheader",__proto__:site2.vichan.components},parse_funcs:{catalog_html:{sticky:function(e){return e.pn.getElementsByTagName("strong")[0].textContent.search(/\(sticky\)/)!=-1},proto:"lain.catalog_html"}},post_container:function(e,t){return e},update_posts_remove:function(e,t,n,a){var r=e.posts[t].pn;0==t&&r.classList.contains("op")?this.update_posts_insert_pack(r):n.removeChild(r.nextSibling),n.removeChild(r)},catalog_json2html3_thumbnail:function(e,t){return".jpg"===e.ext||".jpeg"===e.ext||".gif"===e.ext||".png"===e.ext?"https://"+this.domain_url+t+"thumb/"+e.tim+".png":".pdf"===e.ext?"https://"+this.domain_url+"/static/pdf.png":""},favicon:{__proto__:site2.lain.favicon,none:"/lainicon.ico"},proto:"lain"}),window.location.href.search(/localhost/)!=-1&&(pref.test_mode[94]=!0,pref.catalog.embed_page=!1,pref.virtualBoard.scan_domains.dist="none"),pref.test_mode[94]&&(site2.dist={nickname:"dist",domain_url:"localhost",boards_json:site2.DEFAULT.generate_boards_json([["a",1],["undefined",1]],3),check_func:function(){site2.DEFAULT.check_func.call(this),site.postform=document.getElementsByClassName("postForm")[0]},make_url4:function(e,t){var n=site.protocol+"//"+this.domain_url+e[1];return("catalog_html"===e[3]||t&&0==e[2]&&"page_json"===e[3])&&(e[3]="catalog_json"),"page_json"===e[3]?[n+(parseInt(e[2],10)+1)+".json","json",t?this.nickname+e[1]+"j0":void 0]:"catalog_json"===e[3]?[n+"catalog.json","json",this.nickname+e[1]+"j0"]:"thread_json"===e[3]?[n+e[2]+".json","json"]:"page_html"===e[3]?[n+(0!=e[2]?parseInt(e[2],10)+1:""),"html"]:"thread_html"===e[3]?[n+e[2],"html"]:null},parse_funcs:{other_html:{}},testPoster:function(){function e(){var e=new Date;return e.toLocaleTimeString()+"."+("00"+e.getMilliseconds()).slice(-3)}function t(e){var t=!1;return function(n){return e.insertBefore(n,e.firstChild),t?e.removeChild(e.lastChild):(t=e.childNodes.length>=10,null)}}var n=[],a=document.getElementsByClassName("message")[1];if(a){a.innerHTML="<div></div><div></div><div></div><div></div>";var r=t(a.childNodes[0]),o=t(a.childNodes[1]),s=t(a.childNodes[2]),i=t(a.childNodes[3])}var l=new Map,c=[],p=document.getElementsByClassName("a_update")[0],_=DelayBuffer.prototype.delayed_do.bind(new DelayBuffer(function(){function t(t){var a=t.target,r=l.get(a),o=r.pn,s=r.data,i=200==a.status?a.response&&a.response.message:a.status,d=o.textContent,u=d.indexOf(": ")+2;if(d=[d.slice(0,u),d.slice(u)],i&&i.indexOf("OK.")!=-1){d[1]=d[1].replace(/(makeThread|post|prune)/,"");var i=i.split(" ");i[1]=i[1].slice(0,8),i[4]=i[4].slice(0,8),i[5]="op/sec,",i=i.join(" ")}o.textContent=d[0]+e()+": "+i+d[1],p.textContent=s.thread,s.board===site.board.slice(1,-1)&&"prune"!==s.action&&p.click(),n.length>0&&_(pref.test_mode.num||500),l.delete(a),c.push(a)}var a=n.shift(),d=a.op,u=a.post;if(u){u.no===d&&(u.new_thread=!0);var f={type:"json",action:u.new_thread?"makeThread":u.pruned?"prune":"post",board:u.board.slice(1,-1),thread:d,body:n.length+": "+u.com,subject:u.sub,debug:d};u.com&&u.com.indexOf(" is ")!=-1&&(f.tag=u.com.substr(u.com.indexOf(" is ")+4).split(/[\W]/)[0]);var m=document.createElement("div"),h=f.action+"/"+f.board+"/"+f.thread,g=c.shift()||function(){var e=new XMLHttpRequest;return e.addEventListener("load",t,!1),e.addEventListener("error",t,!1),e.addEventListener("abort",t,!1),e.responseType="json",e}();l.set(g,{pn:m,data:f}),g.open("POST","//localhost/post.php",!0),g.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),g.send(function(e){var t=[],n=0;for(var a in e)t[n++]=encodeURIComponent(a)+"="+encodeURIComponent(e[a]);return t.join("&").replace(/%20/g,"+")}(f)),m.textContent=e()+": "+h+(f.tag?" "+f.tag:"");var b=r(m);b&&(b.textContent.indexOf("OK.")===-1?i(b):b.textContent.indexOf("prune")!==-1?s(b):b.textContent.indexOf("makeThread")!==-1&&o(b))}},500));return function(e,t){"string"==typeof e?n=n.concat({post:{board:"/"+e.split("/")[1]+"/",pruned:!0},op:e.split("/")[2]}):e&&(n=n.concat({post:e,op:t})),_(pref.test_mode.num||500)}}(),features:{catalog:!0},parse_funcs:{catalog_json:{ths:function(e,t){for(var n=[],a=parseInt(t.page||0,10),r=0;r<e.length;r++){var o=Object.create(e[r]);o.sub=e[r].subject,o.board="/"+e[r].board+"/",o.page=a+Math.floor(r/15)+"."+r%15,o.posts=[e[r]],e[r].__proto__=t,n[n.length]=o}return n},op_img_url:function(){return"/distchan.png"},key:function(e){return e.domain+e.board+e.no},has_posts:!1,__proto__:site2.meguca.parse_funcs.catalog_json},thread_json:{ths:function(e,t){return site2.DEFAULT.parse_funcs.thread_json.ths({posts:e,nof_posts:e.length,board:"/"+e[0].board+"/"},t)},__proto__:site2.meguca.parse_funcs.thread_json},__proto__:site2.meguca.parse_funcs},catalog_json2html3:site2.meguca.catalog_json2html3,__proto__:site2["4chan"]});for(var i in site2)if(!pref.test_mode[94]||"dist"!==i){for(var j in site2[i].parse_funcs)if("string"!=typeof site2[i].parse_funcs[j]){for(var k in site2[i].parse_funcs[j])if("proto"!==k&&"string"==typeof Object.getOwnPropertyDescriptor(site2[i].parse_funcs[j],k).value){tgt=site2[i].parse_funcs[j][k].split(".");var tgt_obj=3===tgt.length?site2[tgt[0]].parse_funcs[tgt[1]][tgt[2]]:2===tgt.length&&site2[i].parse_funcs[tgt[0]]&&site2[i].parse_funcs[tgt[0]][tgt[1]]?site2[i].parse_funcs[tgt[0]][tgt[1]]:2===tgt.length&&site2[tgt[0]]&&site2[tgt[0]].parse_funcs[tgt[1]]&&site2[tgt[0]].parse_funcs[tgt[1]][k]?site2[tgt[0]].parse_funcs[tgt[1]][k]:1===tgt.length?site2[i].parse_funcs[tgt[0]]&&site2[i].parse_funcs[tgt[0]][k]:null;tgt_obj&&(site2[i].parse_funcs[j][k]=tgt_obj)}if("DEFAULT"!==i||"common"!==j){var proto=site2[i].parse_funcs[j].hasOwnProperty("proto")?site2[i].parse_funcs[j].proto:site2[i].hasOwnProperty("proto")&&"DEFAULT"!==i?site2[i].proto+"."+j:site2.DEFAULT.parse_funcs[j]&&"DEFAULT"!==i?"DEFAULT."+j:"DEFAULT.common";proto="_template"===j.slice(-9)&&"DEFAULT.common"===proto?site2.DEFAULT.wrap_to_parse.get_getters():proto.indexOf(".")==-1?site2[i].parse_funcs[proto]:site2[proto.substr(0,proto.indexOf("."))].parse_funcs[proto.substr(proto.indexOf(".")+1)],site2[i].parse_funcs[j].__proto__=proto,delete site2[i].parse_funcs[j].proto}}else{var tgt=site2[i].parse_funcs[j];site2[i].parse_funcs[j]=site2[i].parse_funcs[tgt]}"DEFAULT"!==i&&(proto=site2[i].hasOwnProperty("proto")?site2[i].proto:"DEFAULT",site2[i].parse_funcs&&(site2[i].parse_funcs.__proto__=site2[proto].parse_funcs),site2[i].patch&&(site2[i].patch.__proto__=site2[proto].patch),site2[i].__proto__=site2[proto],delete site2[i].proto)}site2.ALL={};var site3={};for(var i in site2)"DEFAULT"!==i&&"common"!==i&&"meguca1"!==i&&"meguca2"!==i&&(site3[i]={boards:null,tags:{cs:[],ci:[]},own_posts:{}},site2[i].hasOwnProperty("check_func")&&(site2[i].check_func(),delete site2[i].check_func),site.nicknames.push(i),site2.ALL[site2[i].domain_url]=i);if(site.embed_to.top||(site.embed_to.top=site.root_body&&site.root_body.firstChild),site.embed_to.bottom||(site.embed_to.bottom=site.root_body&&site.root_body.lastChild),pref.pref2.KC.summer_time&&(site2.KC.time_offset=2),pref_func.site2_json(!1,!0,["site2","pref_func","site3"]),window.top!=window.self){if(site.nicknames.indexOf(window.name)==-1&&window.name!==site.embed_frame)return;for(var i in site2)site.nicknames.indexOf(i)!=-1&&i!=site.nickname&&delete site2[i]}var pipe_name=pref.script_prefix+".graph."+site.board+"__pipe__",info_raw=site.nickname+site.board;window.SharedWorker||(pref.info_server=!1,pref.info_client=!1),site0.isStep||pref_func.obj_init(),pref3.stats.use=pref.stats.use,pref3.stats.estimate_posts=pref.stats.estimate_posts;var notifier=function(){var e=pref.features.notify.sound?function(){function e(){var e=[],t=function(t){function n(t,n,a){if(1==a)for(var r=0;r<n;r++)e.push("");for(var r=0;r<n;r++)1==a?e[e.length-1-r]=(t%256).toString(16):e.push((t%256).toString(16)),t=Math.floor(t/256)}var a=Math.floor(44100*t);return n(1380533830,4,1),n(a+46,4,0),n(1463899717,4,1),n(1718449184,4,1),n(18,4,0),n(1,2,0),n(1,2,0),n(44100,4,0),n(44100,4,0),n(1,2,0),n(8,2,0),n(0,2,0),n(1684108385,4,1),n(a,4,0),a}(pref.notify.sound.beep_length_f);!function(t,n,a){a*=127;for(var r=0;r<n;r++){var o=Math.floor(Math.sin(6.283185308*t*r/44100)*a+128)%256;e.push(o.toString(16))}}(pref.notify.sound.beep_freq,t,pref.notify.sound.beep_volume_f);for(var n=0;n<e.length;n++)1==e[n].length&&(e[n]="0"+e[n]);return new Audio("data:audio/wav,%"+e.join("%"))}function t(){if("file"===pref.notify.sound.src){var t=pref3.notify.sound.file&&pref3.notify.sound.file.files[0];if(t)return new Audio(URL.createObjectURL(t))}return e()}function n(e,t){r&&r.pause(),"pause"!==(t=t.slice(13))&&(r=null,!pref.notify.sound.notify||"notify"!==t&&"src"!==t&&0!==t.indexOf(pref.notify.sound.src)||a())}function a(){r||(r=t()),r.play()}var r=null;return pref_func.settings.onchange_funcs["notify.sound.*w/"]=n,{play:a}}():{play:function(){}},t=pref.features.notify.favicon?function(){function e(e){if(s!==e){var t=site2[site.nickname].favicon[e];"/"!==t[0]&&(t="data:image/"+t),a.setAttribute("href",t),s=e}}function t(){var t=new liveTag.CountNR;if(pref.liveTag.watch_all)t.count_all();else{var a=cataLog.threads;if(a)for(var r in a)t.count(a[r][19])}pref.notify.favicon&&e(0!=t.nrtm?"reply_to_me":0!=t.nr?"reply":"none"),pref.notify.title.notify&&n(0==t.nr&&pref.notify.title.hide_zero?"":(pref.catalog.footer.nrtm&&t.nrtm?t.nrtm+"/":"")+t.nr+" - ")}function n(e){i!==e&&(r.innerHTML=e+o,i=e)}var a=site2[site.nickname].favicon.get_favicon(),r=site2[site.nickname].favicon.get_title(),o=r.innerHTML,s="none",i="";return{set:new DelayBuffer(t,200).get_binded_delayed_do()}}():{set:function(){}},n=Notification&&pref.features.notify.desktop?function(){function e(){
return"granted"!==Notification.permission&&Notification.requestPermission(function(e){Notification.permission!==e&&(Notification.permission=e)}),"granted"===Notification.permission}function t(t,a,r){if(pref.test_mode[94]&&"dist"===site.nickname)return site2[site.nickname].testPoster(r>=0?a[r]:a,t.no);i.length+l.length<pref.notify.desktop.limit&&("granted"===Notification.permission||e())&&n(t,a,r)}function n(e,t,n){var r=n>=0?t[n]:t;r={icon:r.op_img_url,body:r.com||"",__proto__:r},r.reply_of_mine&&pref.catalog_footer_ignore_my_own_posts||(r.title=(r.new_thread?"New Thread ":r.reply_to_me&&pref.notify.desktop.reply_to_me?"(You) in ":"")+(e.sub||e.key),r.tag=pref.script_prefix+"/"+e.key+", "+(t.length-n-1),c.innerHTML=r.body,r.body=c[brwsr.innerText].trim(),0===pref.notify.desktop.delay?a(r):(l[l.length]=r,p()))}function a(e){e||(e=l.shift());var t=new Notification(e.title,e);t.onclick=o;var n=0!=pref.notify.desktop.lifetime?setTimeout(r,1e3*pref.notify.desktop.lifetime):null;i[i.length]=[t,n],l.length>0&&p()}function r(){i.shift()[0].close()}function o(){window.focus();for(var e=i.length-1;e>=0;e--)if(i[e][0]===this||0==e){i[e][1]&&clearTimeout(i[e][1]),i.splice(e,1);break}}function s(){for(;i.length>0;)i[0][1]&&clearTimeout(i[0][1]),r()}e();var i=[],l=[],c=document.createElement("div"),p=new DelayBuffer(a,200).get_binded_delayed_do();return window.addEventListener("beforeunload",s,!1),{show:t}}():{show:function(){}};return{sound:e,favicon:t,desktop:n,changed:function(e,a){(pref.notify.favicon||pref.notify.title.notify)&&t.set();for(var r=!1,o=pref4.refresh.count<=1,s=pref.notify.desktop.show_last?0:a.length-1,i=a.length-1;i>=0;i--)(pref.notify.sound.reply||pref.notify.sound.reply_to_me&&a[i].reply_to_me)&&(r=!0),i<=s&&pref.notify.desktop.notify&&(pref.notify.desktop.reply||pref.notify.desktop.reply_to_me&&a[i].reply_to_me)&&(o&&pref.notify.desktop.supp_init||n.show(e,a,i,!0));pref.notify.sound.notify&&r&&(o&&pref.notify.sound.supp_init||notifier.sound.play())},appeared:function(e,a){var r=cataLog.threads;(pref.notify.favicon||pref.notify.title.notify)&&t.set(r);var o=liveTag.mems[e.domain][e.board][e.no].wt;pref.notify.desktop.notify&&(pref.notify.desktop.appear&&(0===o[0]||!pref.notify.desktop.reply&&!pref.notify.desktop.reply_to_me)||pref.notify.desktop.new_thread&&a)&&n.show(e,{new_thread:a,__proto__:e},-1),pref.notify.sound.notify&&(pref.notify.sound.appear||pref.notify.sound.new_thread&&a)&&notifier.sound.play()}}}(),ports={},messages_to_send={},init_func={},receive_func={},received_messages_404=null,send_message_emu=[];if(window.addEventListener("beforeunload",close_all,!1),window.opener&&(make_port_child(window.opener),site2[window.name]&&site2[window.name].prep_own_posts_event&&(window.addEventListener("storage",site2[window.name].prep_own_posts_event,!1),site2[window.name].prep_own_posts(),site2[window.name].prep_own_posts_event())),pref.cloudflare.auto_reload){var cf_error=document.getElementsByClassName("cf-error-code");cf_error.length>0&&parseInt(cf_error[0].textContent,10)>=500&&setTimeout(function(){location.reload()},6e4*pref.cloudflare.auto_reload_time)}var httpd=function(){function e(){z.id||t()}function t(e,o){if(!U)for(var i=8;i>=0;i--)if(O[i]&&(E<pref.scan.crawler||8==i)){for(;O[i][0]&&0===O[i][0].tgts.length;)O[i].shift();for(var l=O[i][0],c=0;l&&l.ERR_5xx&&o!==l;)l=O[i][++c];if(!l)continue;var p;l.INDICATOR||(l.INDICATOR=T.shift("limegreen",l.initiator[0],l.initiator,i),l.INDICATOR.report({start:Date.now(),prog:l}),l.IDX=0,l.FINISHED=0,l.SUC=0,l.max||(l.max=l.tgts.length));var p=l.get_tgt_func?l.get_tgt_func(l):{REQ:l,__proto__:l.tgts[l.IDX++]};return l.IDX>=l.max&&a(l,i),E++,void(p?(l.INDICATOR.report({tgt:p.tgt||n(p.url)}),p.domain===site.nickname&&!p.domain_xhr||"indirect"!==pref.network.cross_domain?s(e,p):(e&&(L[L.length]=e),r(p)),pref.scan.crawler_adaptive?z.restart(pref.scan.crawler_idle_time_to_spawn):E<pref.scan.crawler&&t()):(l.IDX<l.max&&(l.refresh||l.found_threads<l.max_threads)||(a(l,i),l.FINISHED+=l.max-l.IDX,l.IDX=l.max),setTimeout(function(){d({type:"SKIPPED_TO_END"},e,{REQ:l},!0,{date:Date.now(),status:200})},0)))}z.id&&z.stop(),e&&(L[L.length]=e)}function n(e){return e.substr(e.lastIndexOf("/")+1)}function a(e,t){O[t]&&O[t].length>1?O[t].shift():O[t]=null,D[D.length]=e}function r(e){var t=e.domain_xhr||e.domain;N[t]||(cnst.make_iframe(t),N[t]=window.open(site2[t]&&site2[t].home||e.url,t),send_message(t,["HTTPD",["SUB_FRAME_INIT"]],N[t])),j[t]=null,S[B]=e,e.archive||(e.responseType="text"),send_message(t,["HTTPD",["SUB_GET",[{ID:B++,url:e.url,responseType:e.responseType,domain:e.domain,board:e.board,no:e.no,key:e.key,archive:e.archive,to_file:e.to_file,to_idb:e.to_idb,kind:e.kind,timestamp:e.timestamp,domain_xhr:e.domain_xhr}]]])}function o(e){s(void 0,e[0])}function s(e,t){e||(L.length>0?e=L.pop():"GM"===pref.network.cross_domain?e=new H:(e=new XMLHttpRequest,e.onload=_,e.onerror=_,e.onabort=_)),A.set(e,t),e.open("GET",t.url),e.responseType=t.responseType,e.send(),i(e,Date.now(),t)}function i(e,t,n){n.TIMEOUT=(n.TIMEOUT?n.TIMEOUT:t)+1e3*pref.network.timeout,R[R.length]=e,1===R.length&&M.restart(1e3*pref.network.timeout)}function l(e,t){var n=R.indexOf(e);if(n<0)return!0;if(R.splice(n,1),0===n)if(R.length>0){var a=A.get(R[0]).TIMEOUT-t;a>0?M.restart(a):c()}else M.stop()}function c(){var e=R[0];pref.debug_mode[25]&&console.log("xhr_timeout: "+e.readyState+", "+e.responseURL),e.onreadystatechange?_({target:e,type:"TIMEOUT"}):(e.onreadystatechange=p,e.onprogress=p,p({target:e}))}function p(e){var t=e.target,n=A.get(t);pref.debug_mode[25]&&console.log("xhr_onreadystatechange: "+n.url+("progress"===e.type?": "+e.loaded+"/"+e.total:"")),"progress"===e.type&&(e.target.onreadystatechange=null);var a=Date.now();l(t,a),i(t,a,n)}function _(e){var t=e.target,n=Date.now();if(!l(t,n)){t.onreadystatechange=null,t.onprogress=null;var a=A.get(t),r=200===t.status||304===t.status;d(e,t,a,r,"text"===t.responseType?{date:n,status:t.status,responseText:r?t.responseText:null}:{date:n,status:t.status,response:r?t.response:null})}}function d(a,r,o,s,i){if(C){E--;var l=++o.REQ.FINISHED===o.REQ.IDX&&o.REQ.IDX>=o.REQ.max;t(r,i.status<500?o:null),l&&f(o.REQ),s?(o.REQ.SUC++,h(o,i)):(i.status>=500&&!o.REQ.ERR_5xx&&(o.REQ.ERR_5xx=setTimeout(function(t){return function(){delete t.ERR_5xx,e()}}(o.REQ),3e4)),o.REQ.INDICATOR.report({err_str:(o.tgt||n(o.url))+"("+i.status+("load"!==a.type?":"+a.type:"")+")"}),o.REQ.callback_1_fail&&o.REQ.callback_1_fail(o,i,o.REQ)),l&&y(o.REQ,i.date),o.REQ=null}else send_message("parent",["HTTPD",["SUB_ACK",[o.ID,{type:o.archive?"ARCHIVE":a.type},s,o.archive?{date:i.date,status:i.status,responseText:"",response:{}}:i]]]),L[L.length]=r,s&&o.archive&&g(o,i)}function u(e){var t=S[e[0]];delete S[e[0]],d(e[1],void 0,t,e[2],e[3])}function f(e){D.splice(D.indexOf(e),1),e.archive&&(e.TAR_FLUSH=j),m()}function m(){if(0===E){if(A.clear(),C)for(var e in j)send_message(e,["HTTPD",["SUB_FREE"]]);B=0,j={}}else for(var t=0;t<L.length;t++)A.delete(L[t]);L=[]}function h(e,t){"text"===e.responseType&&("html"===e.data_type?t.response=I.parseFromString(t.responseText,"text/html"):"json"===e.data_type&&(t.response=JSON.parse(t.responseText))),e.REQ.callback_1(e,t,e.REQ)}function g(e,t){if("string"==typeof e.archive)return void archiver.download_url4(t.response,e.archive);e.from&&C&&delete archiver.list_all_obj_downloading[e.from];var n="indirect"!==pref.network.cross_domain;if((e.domain_xhr||e.domain)===site.nickname||n){var a=e.kind+"_"+e.url.replace(/.*\//g,"");e.to_file&&archiver.download_url3(t.response,e,a,e.timestamp),e.to_idb&&(pref.test_mode[65]&&C||IDB.req(e.domain,e.board,e.no,a,t.response,"put"))}if(C&&e.REQ.TAR_FLUSH){archiver.tar.flush(0===E?void 0:e.timestamp);for(var r in e.REQ.TAR_FLUSH)send_message(r,["HTTPD",["SUB_TAR_FLUSH",[0===E?void 0:e.timestamp]]])}}function b(e,t){e.from&&delete archiver.list_all_obj_downloading[e.from]}function v(e){if(O[0]&&O[0][0]&&O[0][0].timestamp===e&&O[0][0].tgts.length>0)return!1;for(var t=0;t<D.length;t++)if(D[t].timestamp===e)return!1;return archiver.tar.flush(0===E?void 0:e),!0}function y(e,t){e.callback&&e.callback(e),e.INDICATOR.report({end:t})}function w(e){archiver.tar.flush(e[0])}function k(){C=!1}function x(){U>0?--U>0&&F.delayed_do():(F.cancel(),e())}var T,N={},C=!0,I=new DOMParser,A=new Map,L=[],E=0,j={},B=0,S={},O=[],D=[],U=0,z=new Watchdog(t,pref.scan.crawler_idle_time_to_spawn),R=[],M=new Watchdog(c,3e4),H=function(){this.onload=this.onload.bind(this),this.onerror=this.onerror.bind(this),this.onabort=this.onabort.bind(this)};H.prototype={open:function(e,t){this.method=e,this.url=t},send:function(){this.response=null,GM_xmlhttpRequest(this)},onload:function(e){this.response=e.response,this.response||(this.response="document"===this.responseType?(new DOMParser).parseFromString(e.responseText,"text/xml"):"json"===this.responseType?JSON.parse(e.responseText):e.responseText),this.onXXX("load",e,_)},onerror:function(e){this.onXXX("error",e,_)},onabort:function(e){this.onXXX("abort",e,_)},onXXX:function(e,t,n){this.type=e,this.result=t,n(this)},onXXX_factory:function(e,t){return function(n){this.onXXX(e,n,t)}.bind(this)},set onreadystatechange(e){this._onreadystatechange=e?this.onXXX_factory("readystatechange",e):e},get onreadystatechange(){return this._onreadystatechange||this.dummy_func},set onprogress(e){this._onprogress=e?this.onXXX_factory("progress",e):e},get onprogress(){return this._onprogress||this.dummy_func},dummy_func:function(){},get status(){return this.result&&this.result.status||1404},get responseText(){return this.result.responseText},get target(){return this},result:null};var F=new DelayBuffer(x,1e4),q={SUB_GET:o,SUB_ACK:u,SUB_FREE:m,SUB_TAR_FLUSH:w,SUB_FRAME_INIT:k};return{req:function(e,n){O[n]?O[n].push(e):O[n]=[e],0!==e.tgts.length&&t()},req_add:function(t,n){O[n]&&0!==O[n].length?O[n][O[n].length-1].tgts=O[n][O[n].length-1].tgts.concat(t.tgts):O[n]=[t],e()},check_timestamp_and_flush:v,onload_archive:g,onload_archive_fail:b,sub_funcs:function(e){q[e[0]](e[1])},pause_req:function(){U++,F.delayed_do()},pause_cancel:x,set_health_indicator:function(e){T=e},get isLocal(){return C}}}(),http_req={get:function(e,t,n,a,r,o,s,i){var l=t.indexOf(",")==-1?common_func.name2dbt(t):t.split(",");""===n?n=site2[l[0]].make_url4(l):"string"==typeof n&&(n=[n,"raw"]),t=l.join(","),httpd.req({initiator:t,tgts:[{url:n[0],responseType:"html"===n[1]?"document":"raw"===n[1]?"text":n[1],tgt:t,data_type:n[1],domain:l[0]}],callback_1:function(e,n){a(t,n,s)},INDICATOR:{shift:function(){},report:function(){}},IDX:0,FINISHED:0,SUC:0,max:1},6)}},cnst=function(){function e(e){var t=e.target,n="click"===e.type?"BUTTON"===t.tagName&&k[t.name]||"BUTTON"===t.parentNode.tagName&&k[t.parentNode.name]:("DIV"===t.tagName||"SPAN"===t.tagName)&&k.roll_toggle;n&&(e.stopPropagation(),n.call(k,e,w.get(e.currentTarget.parentNode)))}function t(e){e.stopPropagation(),k.exit.call(k,e,w.get(e.currentTarget.parentNode))}function n(e){var t=w.get(e.currentTarget);(t&&t.float||cnst.tack_float_nSblgs)(e)}function a(e){var t=w.get(w.get(e.currentTarget.parentNode).tack);(t&&t.embed||cnst.tack_dock_nSblgs)(e)}function r(e){d(e,e.currentTarget.parentNode.parentNode)}function o(e){d(e,e.currentTarget.parentNode)}function s(e,t){return document.documentElement.clientHeight-parseInt(e,10)-t.offsetHeight}function i(e,t){return document.documentElement.clientWidth-parseInt(e,10)-t.offsetWidth}function l(e){pref.proto.popup2_resize&&c(e)||"sel"===pref.proto.popup2_sel||f(e)||pref[cataLog.embed_mode].thumbnail.hover.dragfloat&&cataLog.DIH&&cataLog.DIH.hover_ex||d(e,e.currentTarget)}function c(e){for(var t=e.currentTarget,n=t.style,a=e.clientY-(n.top?parseInt(n.top,10):s(n.bottom,t)),r=e.clientX-(n.left?parseInt(n.left,10):i(n.right,t)),o=t.offsetHeight-a,l=t.offsetWidth-r,c=[a,r,o,l],d=0;d<4;d++)if(c[d]<=pref.proto.popup2_resize_bw){for(var u=0;u<4;u++)c[u]=c[u]<=pref.proto.popup2_resize_cw?parseInt(window.getComputedStyle(t)[u%2?"width":"height"],10):null;return document.body.addEventListener("mouseup",_,!1),document.body.addEventListener("dragend",_,!1),document.body.addEventListener("drag",p,!1),x=e.screenX,T=e.screenY,c.push(parseInt(n.top,10),parseInt(n.left,10),parseInt(n.bottom,10),parseInt(n.right,10),t),N=c,e.stopPropagation(),t.draggable=!0,!0}return!1}function p(e){if(0!==e.screenX){var t=N,n=t[8],a=n.style,r=e.screenX-x,o=e.screenY-T;t[0]&&(a.height=t[0]-o+"px",a.top&&(a.top=t[4]+o+"px")),t[1]&&(a.width=t[1]-r+"px",a.left&&(a.left=t[5]+r+"px")),t[2]&&(a.height=t[2]+o+"px",a.bottom&&(a.bottom=t[6]-o+"px")),t[3]&&(a.width=t[3]+r+"px",a.right&&(a.right=t[7]-r+"px")),e.stopPropagation()}}function _(e){var t=e.currentTarget;t.removeEventListener("drag",p,!1),t.removeEventListener("dragend",_,!1),t.removeEventListener("mouseup",_,!1),e.stopPropagation(),t.draggable=!1,N=null}function d(e,t){t.draggable=!0,t.addEventListener("dragstart",m,!1),t.addEventListener("mouseup",u,!1),e.stopPropagation()}function u(e){e.currentTarget.removeEventListener("mouseup",u,!1),e.currentTarget.draggable=!1}function f(e){if("INPUT"===e.target.tagName||"TEXTAREA"===e.target.tagName||"SELECT"===e.target.tagName)return!0;if("move"===pref.proto.popup2_sel)return!1;for(var t=e.target.childNodes,n=new Range,a=0;a<t.length;a++){var r="BUTTON"===t[a].tagName||"SELECT"===t[a].tagName?0:pref.proto.popup2_sel_tolerance;n.selectNode(t[a]);for(var o=n.getClientRects(),s=0;s<o.length;s++){var i=o[s];if(i.bottom>e.clientY&&e.clientY>=i.top&&i.left-r<e.clientX&&e.clientX<i.right+r)return!0}}return!1}function m(e){e.currentTarget.removeEventListener("dragstart",m,!1),e.currentTarget.removeEventListener("mouseup",u,!1),k.roll_if_auto(e,!0),h(e,!0)}function h(e,t){var n=e.currentTarget;x=e.screenX,T=e.screenY,e.dataTransfer.setData("text/plain",""),e.dataTransfer.effectAllowed="move",e.dataTransfer.dropEffect="move",e.stopPropagation(),n.style.opacity=.4,n.addEventListener("dragend",t?b:v,!1),C.addEventListener("dragover",g,!1)}function g(e){e.preventDefault(),e.dataTransfer.dropEffect="move"}function b(e){v(e,!0),k.roll_if_auto(e,!1),e.currentTarget.draggable=!1}function v(e,t){C.removeEventListener("dragover",g,!1);var n=e.currentTarget,a=n.style;n.removeEventListener("dragend",t?b:v,!1),a.left?a.left=parseInt(a.left,10)+e.screenX-x+"px":a.right=parseInt(a.right,10)-e.screenX+x+"px",a.bottom?a.bottom=parseInt(a.bottom,10)-e.screenY+T+"px":a.top=parseInt(a.top,10)+e.screenY-T+"px",a.opacity=1,e.stopPropagation()}function y(e){var t=brwsr.ff?40*-e.detail:e.wheelDelta,n=e.currentTarget.style;n.bottom?n.bottom=parseInt(n.bottom,10)-t+"px":n.top=parseInt(n.top,10)+t+"px",e.preventDefault()}var w=new WeakMap,k={op_p:function(e){var t=e.currentTarget.parentNode.style,n=parseFloat(t.opacity)||1;t.opacity="op_p"===e.target.name?n+.1>=1?1:n+.1:n-.1<=.1?.1:n-.1},roll_toggle:function(e,t){"none"==t.cn.style.display?this.rolldown(t):this.rollup(t)},roll_if_auto:function(e,t){var n=w.get(e.currentTarget);n&&(t?n.auto_roll&&"none"!==n.cn.style.display&&(this.rollup(n),n.auto_unroll=!0):n.auto_unroll&&"none"===n.cn.style.display&&(this.rolldown(n),n.auto_unroll=!1))},rolldown:function(e){e.tb.style.width="",e.cn.style.display="",e.rolldown&&e.rolldown.call(e.this_obj)},rollup:function(e){e.tb.style.width=e.tb.offsetWidth+"px",e.cn.style.display="none",e.rollup&&e.rollup.call(e.this_obj)},top:function(e,t){this.maximize(t.pn,t.tb,t.cn,e.target.name,t,e.target)},maximize:function(e,t,n,a,r,o){var s=r.maximize_state,i=s[0];s[5].style.display=null;var l=(r.maximize_tgt||n).style;if("float"===i?s=[a,e.style.left,e.style.top,l.width,l.height,o,e.style.right,e.style.bottom]:(s[0]=a,s[5]=o),"max"===a){var c=site.header_height();common_func.overwrite_prop(e.style,{left:"0px",top:c+"px",position:"fixed",resize:"none",zIndex:pref.style.zIndex}),common_func.overwrite_prop(l,{width:document.documentElement.clientWidth+"px",height:document.documentElement.clientHeight-t.offsetHeight-c+"px",resize:"none"})}else if("float"===a)common_func.overwrite_prop(e.style,{left:s[1],top:s[2],position:"fixed",resize:"both",right:s[6],bottom:s[7],zIndex:pref.style.zIndex}),common_func.overwrite_prop(l,r.maximize_float_style_pnch1||{width:s[3],height:s[4],resize:"both"});else{var p=site.embed_to[a];p&&("function"==typeof site.embed_to[a]&&(p=site.embed_to[a]=site.embed_to[a]()),common_func.overwrite_prop(e.style,{left:"auto",top:"auto",position:"relative",resize:"none",right:"auto",bottom:"auto",zIndex:null}),common_func.overwrite_prop(l,r.maximize_embed_style_pnch1||{width:"auto",height:"auto",resize:"none"}),p.parentNode.insertBefore(e,p))}o.style.display="none",r.maximize_state=s,r.maximize&&r.maximize.call(r.this_obj,a,i)},exit:function(e,t){t.exit?t.exit.call(t.this_obj,e):cnst.div_destroy(t.pn,!0)},settings:function(e,t){var n="BUTTON"===e.target.tagName?e.target:e.target.parentNode,a=w.get(n)||t.cn.childNodes[0];a.style.display="none"===a.style.display?null:"none",cnst.toggleButton(n)}};k.op_m=k.op_p,k.bottom=k.top,k.float=k.top,k.max=k.top,k.filter=k.settings;var x,T,N=null,C=document.body,I={left:0,bottom:0,last_pn:null};return{init3:function(e){return this.init(e.func_str,null,null,null,null,e.pn_st,e)},init2:function(e){return this.init(e.func_str,e.rolldown_func,e.rollup_func,e.exit_func,e.maximize_func,e.pn_st)},init:function(n,a,s,i,c,p,_){var d=void 0!==_;void 0===_&&(_={rolldown:a,rollup:s,exit:i,maximize:c});var u=document.createElement("span");if(_.pn=u,p)return u.textContent=" "+n.replace(/.*:button:/,"").replace(/:.*/,""),u.setAttribute("style","cursor:pointer"),p.appendChild(document.createTextNode(" ")),p.appendChild(u),u;u.style||(u.style={}),u.style.position="fixed",u.draggable=!0,u.style.padding="0px",u.style.zIndex=pref.style.zIndex,u.style.float="left",u.style.display="inline-block";var f=n.split(":"),m=0;if("pop"!=f[0]);else{var g=!0;u.addEventListener(brwsr.mousewheel,y,!1),u.name="catalog_pop",m=1,u.draggable=!1}u.setAttribute("class",pref.script_prefix+"_window");for(var b=u;m<f.length;){var v=f[m++];if("tb"==v){u.setAttribute("class",pref.script_prefix+"_titleBar"),u.innerHTML=pref_func.format_html_str('<div style="height:auto;overflow:hidden"><div style="float: left"><BTN"roll_toggle,-"><BTN"op_m,&lt;"><BTN"op_p,&gt;"><span style="width:16px;display:inline-block"></span></div><div style="float: right"><BTN"top,^"><BTN"bottom,v"><BTN"float,o" style="display:none"><BTN"max,[]"><BTN"exit,X"></div><div></div></div><div class="'+pref.script_prefix+'_window" style="margin: 0px 3px 3px 3px;clear:both"></div>');var k=u.childNodes[0],x=u.childNodes[1];_.maximize_state=["float",null,null,null,null,k.childNodes[1].childNodes[2]],u.draggable=!1,b=u.childNodes[1],k.onclick=e,k.ondblclick=e,k.childNodes[0].onmousedown=r,k.childNodes[1].onmousedown=r,k.childNodes[2].onmousedown=r,k.onmousedown=o,_.tb=k,_.cn=x,w.set(u,_)}else if("ftb"==v){k.childNodes[0].removeChild(k.childNodes[0].childNodes[0]),u.insertBefore(x,k);var T=k.style;T.position="absolute",T.top="0px",T.width="100%",x.style.margin="3px",k.classList.add(pref.script_prefix+"_autoTp");var N=pref[cataLog.embed_mode].thumbnail.hover;N.df_dblC&&(x.ondblclick=t),k.ondblclick=t,N.df_mW&&(u["on"+brwsr.mousewheel]=y)}else if("tb_press"==v){var C=f[m++];"float"!==C&&e({target:k.getElementsByTagName("button")[C],currentTarget:k,type:"click",stopPropagation:function(){}})}else"embed"==v?(k.childNodes[0].onmousedown=null,k.childNodes[1].onmousedown=null,k.childNodes[2].onmousedown=null,k.onmousedown=null):"bottom_top"==v?this.bottom_top(u):"txt"==v||brwsr.ff&&"button"==v?(b.appendChild(document.createTextNode(f[m++])),b.style.cursor="pointer",b.style.padding="2px 5px 2px 5px"):"button"==v?(b.innerHTML='<input type="button" value="'+f[m++]+'">',b.style.padding="0",b.style.border="0",b.style.background="none"):"Show2"==v?site.root_body!==site.root_body2&&site.root_body2?(u.style.position="static",site.root_body2.appendChild(u)):site.root_body.appendChild(u):"Show"==v?site.script_body.appendChild(u):"tile"==v||"tile2"==v?"set"==f[m++]?"left"==f[m]?(I[f[m]]=parseInt(u.style[f[m]].replace(/px/,""),10)+u.offsetWidth,m++):(I[f[m]]=parseInt(u.style[f[m]].replace(/px/,""),10)+u.offsetHeight,m++):"tile"===v?(u.style[f[m]]=I[f[m]]+"px",m++):(u.style[f[m]]=I[f[m]]+parseInt(f[m+1],10)+"px",m+=2):b.style[v]=f[m++]}return k||g?u.addEventListener("mousedown",l,!1):u.addEventListener("dragstart",h,!1),I.last_pn=u,d?_:u},tile_set_bottom:function(){I.last_pn&&(I.bottom=I.last_pn.offsetHeight)},tile_set_left:function(){I.last_pn&&(I.left=I.last_pn.offsetWidth)},left2right:i,bottom_top:function(e){var t=e.style;t.bottom&&(t.top=s(t.bottom,e)+"px",t.bottom=null),t.right&&(t.left=i(t.right,e)+"px",t.right=null)},void_func:function(){},div_mousedown:l,div_dragstart:h,div_scroll:y,div_destroy:function(e,t,n){return t&&e.parentNode.removeChild(e),e.name||w.has(e)?e.removeEventListener("mousedown",l,!1):e.removeEventListener("dragstart",h,!1),e.name&&e.removeEventListener(brwsr.mousewheel,y,!1),null},tb_prep_for_embed:function(e){e.childNodes[0].innerHTML="",e.childNodes[1].innerHTML="",e.childNodes[3].removeAttribute("style"),e.ondblclick=null},add_to_tb:function(e,t){var n=document.createElement("div");return n.style.float="right",n.style.resize="none",n.style.overflow="visible",n.innerHTML=t,e.childNodes[0].insertBefore(n,e.childNodes[0].childNodes[e.childNodes[0].childNodes.length-1]),brwsr.ff&&n.setAttribute("style","float: right"),n},show_hide:function(e,t,n){"none"==e.style.display?(e.style.display="",t&&(t.style.height=parseInt(t.style.height.replace(/px/,""),10)-e.offsetHeight+"px"),n&&(n.style.top=parseInt(n.style.top.replace(/px/,""),10)+e.offsetHeight+"px")):(t&&(t.style.height=parseInt(t.style.height.replace(/px/,""),10)+e.offsetHeight+"px"),n&&(n.style.top=parseInt(n.style.top.replace(/px/,""),10)-e.offsetHeight+"px"),e.style.display="none")},name2domainboardthread:common_func.name2domainboardthread,get_time:function(){var e=new Date,t=e.getHours(),n=e.getMinutes(),a=e.getSeconds();return t<10&&(t="0"+t),n<10&&(n="0"+n),a<10&&(a="0"+a),t+":"+n+":"+a},make_destroy:function(e,t,n,a){e[t]?e[t]=a():e[t]=n()},make_popup:function(e,t,n,a){e[t]=cnst.init("left:0px:tile:get:bottom:Show:tb",cnst.void_func,cnst.void_func,function(){e[t]=cnst.div_destroy(e[t],!0)},cnst.void_func),e[t].childNodes[1].innerHTML=n,pref_func.add_onchange(e[t].childNodes[1],a)},make_iframe:function(e){if(!(site2[e]&&site2[e].X_FRAME_OPTIONS&&pref.network.overXFO||site2[site.nickname].CONTENT_SECURITY_POLICY_FRAME&&pref.network.overCSPF)){var t=document.createElement("iframe");return t.name=e,t.setAttribute("style","display:none"),site.script_body.appendChild(t),t}},subscribe:function(e,t){e.push(t)},unsubscribe:function(e,t){var n=e.indexOf(t);n!=-1&&e.splice(n,1)},foreach:function(e,t){for(var n=0;n<e.length;n++)t(e[n])},auto_shrink_board_selector:function(){function e(){this.removeAttribute("style");for(var e=0;e<this.length;e++)this.options[e].text=pref.catalog_board_list_obj[e][0].key,a(this.options[e],e)}function t(){for(var e=0;e<this.length;e++)e!=this.selectedIndex&&(this.options[e].text="");a(this,this.selectedIndex)}function n(e,t){void 0===t&&(t=e.selectedIndex),e.length=0;for(var n=0;n<pref.catalog_board_list_obj.length;n++)e.length++,e.options[e.length-1].text=pref.catalog_board_list_obj[n][0].key;e.selectedIndex=t>=e.length?0:t,e.onblur()}function a(e,t){pref3.stats.use&&(pref.stats.auto_acquisition||pref.stats.auto_acquisition_all)&&stats.query_auto_acquisition(t)?e.setAttribute("style","background:#b5fbda"):e.removeAttribute("style")}var r=[];return{setup:function(a,o){a.onfocus=e,a.onblur=t,n(a,o),cnst.subscribe(r,a)},str_changed:function(){cnst.foreach(r,n)},destroy:function(e){cnst.unsubscribe(r,e)},color:function(){cnst.foreach(r,function(e){a(e,e.selectedIndex)})}}}(),auto_shrink_selector:function(){function e(){for(var e=n[this.getAttribute("name")],t=0;t<this.length;t++)""===this.options[t].text&&(this.options[t].text=e[t])}function t(){for(var e=[],t=0;t<this.length;t++)e[t]=this.options[t].text,t!=this.selectedIndex&&(this.options[t].text="");n[this.getAttribute("name")]=e}var n=Object.create(null);return function(n){n.onfocus=e,n.onblur=t,n.onblur()}}(),config_expander:function(){function e(){var e=pref[cataLog.embed_mode].t2h_num_of_posts;return["Same as the page",pref[cataLog.embed_mode].t2h_L+" posts",pref[cataLog.embed_mode].t2h_M+" posts",e+" posts",e+" + all unread posts","All unread posts","All"]}function t(){for(var t=e(),n=0;n<this.length;n++)""===this.options[n].text&&(this.options[n].text=t[n])}function n(){for(var e=0;e<this.length;e++)e!=this.selectedIndex&&(this.options[e].text="")}return function(a,r){var o=document.createElement("select");return o.className=pref.script_prefix+"_expander",o.setAttribute("data-key",a),o.length=7,void 0===r&&(r=0),o.selectedIndex=r,o.options[r].text=0===r?"Expand...":e()[r],o.onfocus=t,o.onblur=n,o}}(),icons:{filter:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcAQAAAABaduI5AAAAAnRSTlMAAQGU/a4AAABUSURBVAjXY/j///8HBjAx////CQz8//8zMLD//8fAwPz/DwND4/8fAgwH/n8wYHhQ/6CA4YP9gQ8MP+QbPzD84Wf+wPCPnx2ol5+fLKJfHmovnAAAn79HiYOE2q8AAAAldEVYdGRhdGU6Y3JlYXRlADIwMTUtMTAtMjlUMDI6MTM6MzkrMDk6MDBxKtFiAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE1LTEwLTI5VDAyOjEzOjM5KzA5OjAwAHdp3gAAAABJRU5ErkJggg==",settings:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcAQAAAABaduI5AAAAAnRSTlMAAQGU/a4AAABWSURBVAjXdY6xDcAgDAQvGzAKG2QllykiwWgexWxgKQ2dI4yULs1X9/dPWHMyHrudYZegvVQ6FBQqdqrgzRwLF0ZM4YjJfySS8K4tQaq2dOlzKCe/By9fz0MDWLKIZgAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAxNS0xMC0yOVQwMjowMzowNiswOTowMMhjeagAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMTUtMTAtMjlUMDI6MDM6MDYrMDk6MDC5PsEUAAAAAElFTkSuQmCC",refresh:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcAQAAAABaduI5AAAAAnRSTlMAAQGU/a4AAABmSURBVAjXbY6xDYAwDASfijLegBUYLRuAlCIljITEAowQNnCZIspjQ0tzkvX6e4NKBREudIw7KgaBTqugLEVwUwWnI9HOzMNh6UarhR+8QWaXD4nNBW02VY0ujdAA9SH1yXfcYG88J0BH+yT9vZAAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTUtMTAtMjhUMjM6NDg6MDYrMDk6MDASyn1kAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE1LTEwLTI4VDIzOjQ4OjA2KzA5OjAwY5fF2AAAAABJRU5ErkJggg==",img:function(e){return'<img src="'+e+'" style="width:14px;height:14px">'},button_settings:function(){return'<button type="button" name="settings">'+this.img(this.settings)+"</button>"}},toggleButton:function(e){e.style&&e.style.border?e.style.border="":e.style.border="inset 2px"},createElement:function(e){var t=document.createElement("div");return t.innerHTML=e,1===t.childNodes.length?t.childNodes[0]:t.querySelectorAll("*")},set_tack_float:function(e,t,a){return(t||a)&&w.set(e,{float:t,embed:a}),e.onclick=n,e},tack_float_nSblgs:function(e,t){for(var n,r=e.currentTarget,o=r.nextSibling,s=o.offsetLeft-o.scrollLeft,i=o.parentNode;i&&!n;)n=i.scrollTop,i=i.parentNode;var l=o.offsetTop-(n||0),c=cnst.init3({func_str:"left:"+s+"px:top:"+l+"px:overflow:hidden:Show:tb",exit:a,tack:r});c.cn.innerHTML='<div style="display: none"></div><div></div>';var p=c.cn.childNodes[1];if(o.parentNode.insertBefore(c.pn,o),p.appendChild(o),t)for(;c.pn.nextSibling;)p.appendChild(c.pn.nextSibling);return r.style.display="none",c},tack_dock_nSblgs:function(e){for(var t=e.currentTarget.parentNode,n=w.get(t),a=n.tack.parentNode,r=n.tack.nextSibling,o=n.cn.childNodes[1];o.firstChild;)a.insertBefore(o.firstChild,r);return n.tack.style.display=null,cnst.div_destroy(t,!0),n.tack},tack_dock_e2tack:function(e){var t=e.currentTarget.parentNode;return w.get(t).tack},set_target_of_button:function(e,t){w.set(e,t)}}}(),timer_obj,chart_obj,setting_obj,post_form_obj,catalog_obj,cnst_obj=function(){function e(e){return cnst.init2({func_str:"tile:get:left:tile:get:bottom:button:"+e+":Show2:tile:set:left",pn_st:r})}site.script_body=document.createElement("div"),site.script_body.className=pref.script_prefix,site.script_body.innerHTML='<div style="display:none"></div><div></div>',site.popup_body=site.script_body.childNodes[1],site.root_body.appendChild(site.script_body);var t=site.features,n=pref.features;if(t.postform&&n.postform&&null==site.postform&&!site2[site.nickname].postform.activation){var a=document.createElement("div");a.innerHTML='<div><textarea style="height:5em;display:none" cols="20" name="'+pref.script_prefix+'_draft"></textarea><button name="'+pref.script_prefix+'_send" style="display:none">send</button></div>',site.script_body.appendChild(a),a=a.childNodes[0],site.components.postform_comment=a.childNodes[0],site.postform=site.components.postform_comment,site.components.postform_submit=a.childNodes[1]}if(site.settings){site.settings.innerHTML="<span>[CC</span><span></span>]",site.settings.setAttribute("style","float:right;");var r=site.settings.childNodes[1];site.settings.childNodes[0].setAttribute("style","cursor:pointer"),site.settings.childNodes[0].onclick=function(){cnst.show_hide(r)},site.settings.childNodes[1].setAttribute("style","display:none")}if(t.setting&&n.setting&&e("settings").addEventListener("click",pref_func.settings.show_hide,!1),t.catalog&&n.catalog&&(catalog_obj=make_catalog_obj(pref[site.whereami]&&pref[site.whereami].embed?pref.test_mode[114]?e("Watcher"):null:e("Catalog")),pref.catalog.embed&&"catalog"===site.whereami&&site2[site.nickname].catalog_native_frame_prep(e("Frame"))),pref.test_mode[94]||cnst.tile_set_left(),chart_obj=make_chart_obj(t.graph&&n.graph&&pref3.stats.use?e("Graph"):null),t.setting2&&n.setting2&&(setting_obj=make_setting_obj(e("settings2"))),t.postform&&n.postform&&(null!=site.postform||site2[site.nickname].postform.activation)&&(post_form_obj=make_post_form_obj(e(a?"Draft":"PostForm"))),t.debug&&n.debug&&make_debug_obj(e("debug")),t.page&&n.page){var o=cnst.init2({func_str:"tile:get:left:tile:get:bottom:txt:init:Show2",pn_st:r});timer_obj=make_timer_obj(o)}cnst.tile_set_bottom(),t.catalog&&n.catalog&&pref.catalog.board.board_tags_same&&pref_func.settings.onchange_funcs["tag.same_tag_refresh"]()}(),uip_tracker=null,liveTag={pn:null,pn_summary:null,active:{pk:0,in:0,ex:0},tags_ci:null,tags:Object.create(Object.create(null)),mems:Object.create(null,{getFromName:{value:function(e){var t=common_func.fullname2dbt(e);return t[2]?this[t[0]][t[1]][t[2]]:this[t[0]][t[1]]}},init:{value:function(){function e(e){this[e.domain]=Object.create(Object.create(this.acc,{domain:{value:e.domain}}),{p:{value:Object.create(null)}}),site2[e.domain].lth_init&&site2[e.domain].lth_init(e)}function t(e){var t="#"+e.board.substr(1,e.board.length-2);liveTag.tags[t]&&liveTag.tags[t].ref_tag===t&&(t=liveTag.tags[t].ref_tag),this[e.domain][e.board]=Object.create(Object.create(Object.getPrototypeOf(this[e.domain]),{board:{value:e.board},btag:{value:t,writable:!0}}),{nr:{value:0,writable:!0},nrtm:{value:0,writable:!0},u:{value:0,writable:!0},o:{value:null,writable:!0},p:{value:{},configurable:!0,writable:!0},pgs:{value:null,writable:!0},d:{value:0,writable:!0}}),pref.liveTag.inherit_board_name&&(liveTag.update_tags_in_th_sub([],{},[t],{},1,null,0,this[e.domain][e.board]),liveTag.update_pn_buf.delayed_do())}function n(e){var t=this[e.domain][e.board];t[e.no]=Object.create(Object.getPrototypeOf(t),{1:{value:void 0,writable:!0},2:{value:[8585216,0,0]},u:{value:0,writable:!0},no:{value:e.no,writable:!0}})}return function(a){return void 0===this[a.domain]&&e.call(this,a),a.board?(void 0===this[a.domain][a.board]&&t.call(this,a),a.no?(void 0===this[a.domain][a.board][a.no]&&n.call(this,a),this[a.domain][a.board][a.no]):this[a.domain][a.board]):this[a.domain]}}()},acc:{value:Object.create(null,{0:{get:function(){var e=this.btags;return this.tl&&(e=e?e.concat(this.tl):this.tl),e||[]},set:function(e){var t=this.btags;if(t){pref.liveTag.ci&&(t=t.map(function(e){return e.toLowerCase()}));for(var n=0;n<e.length;n++)t.indexOf(pref.liveTag.ci?e[n].toLowerCase():e[n])!=-1&&e.splice(n--,1)}e.length>0?this.tl=e:void 0!==this.tl&&delete this.tl}},t:{get:function(){return this[1]}},t0:{get:function(){return this[0]},set:function(e){this[0]=e}},t1:{get:function(){return this[1]},set:function(e){this[1]=e}},wt:{get:function(){return this[2]},
set:function(e){this[2]=e}},key:{get:function(){return this.domain+this.board+(this.no?this.no:"")}},tags:{get:function(){return(this[0]||[]).concat(this[1]||[])}},btags:{get:function(){var e=pref.liveTag.inherit_board_name&&pref.liveTag.lock_board_name?[this.btag]:null;return this.btag2&&pref.liveTag.inherit_board_tags&&pref.liveTag.lock_board_tags?e?e.concat(this.btag2):this.btag2:e}},watched:{get:function(){return 786432&this[2][0]}},time_checked:{get:function(){return this[2][2]}},archived:{get:function(){return(7340032&this[2][0])>>20},set:function(e){this[2][0]=4287627263&this[2][0]|(7&e)<<20}},posts_saved:{get:function(){return(33554432&this[2][0])>>25},set:function(e){this[2][0]=4261412863&this[2][0]|(1&e)<<25}},force_ar:{get:function(){return(5242880&this[2][0])>>20}},rescan_dp:{get:function(){return(16777216&this[2][0])>>24},set:function(e){this[2][0]=4278190079&this[2][0]|(1&e)<<24}},nrtm:{get:function(){return this[2][1]>>16}},nr:{get:function(){return 65535&this[2][1]}},nof_posts:{get:function(){return 65535&this[2][0]},set:function(e){this[2][0]=(4294901760&this[2][0])+e}},LS_synced:{get:function(){return 1&this.d},set:function(e){this.d=4294967294&this.d|1&e}},IDB_synced:{get:function(){return(2&this.d)>>1},set:function(e){this.d=4294967293&this.d|(1&e)<<1}}})}}),postprocess_board_add_btag:function(e,t){for(var n=0;n<e.length;n++)e[n]="#"+e[n].replace(/[&<>'"#]/g,""),e[n].length>pref.liveTag.maxstr&&e.splice(n--,1);var a=t.btag2&&t.btag2.length===e.length;if(a)for(var n=0;n<e.length;n++)if(e[n]!==t.btag2[n]){a=!1;break}if(!a){for(var n=0;n<e.length;n++)liveTag.tags[e[n]]&&liveTag.tags[e[n]].ref_tag===e[n]&&(e[n]=liveTag.tags[e[n]].ref_tag);Object.defineProperty(Object.getPrototypeOf(t),"btag2",{value:e,writable:!0}),pref.liveTag.inherit_board_tags&&liveTag.inherit_board_tags_changed_1(e,t)}},retag:function(e,t){t&&(t.list_nup.add_scan(e),e.wt[0]|=131072);var n={com:e.tags.join(" "),parse_funcs:{type_com:"txt"},__proto__:e};liveTag.prep_tags(n,!0),cataLog.threads[e.key]&&cataLog.Footer.update_force(e.key,null,e)},retag_db:DelayBuffer.prototype.delayed_do.bind(new DelayBuffer(function(){cataLog.catalog_filter_changed&&cataLog.catalog_filter_changed()},10)),inherit_board_name_changed:function(){for(var e in this.mems)for(var t in this.mems[e])this.inherit_board_tags_changed_1([this.mems[e][t].btag],this.mems[e][t],!pref.liveTag.inherit_board_name)},inherit_board_tags_changed:function(){for(var e in this.mems)for(var t in this.mems[e])this.mems[e][t].btag2&&this.inherit_board_tags_changed_1(this.mems[e][t].btag2,this.mems[e][t],!pref.liveTag.inherit_board_tags)},inherit_board_tags_changed_1:function(e,t,n){for(var a=0;a<e.length;a++)this.retag_in_th_sub(e[a],t,n);for(var r in t){t.domain,t.board,t[r].no;this.retag(t[r],n&&t[r].tags.length>=pref.liveTag.max)}this.retag_db(),this.update_pn_buf.delayed_do()},ex_list_changed:function(){if(pref.liveTag.ex_list)for(var e in this.mems)for(var t in this.mems[e])for(var n in this.mems[e][t]){var a=this.mems[e][t][n],r=a.tags.length;this.exclude_tags(a,a.t0,a.t1,!0)&&this.retag(a,r>=pref.liveTag.max)}},exclude_tags:function(e,t,n,a){var r=pref_func.merge_obj5a(e,pref.liveTag.ex_list_obj5,null);if(r){var o=this.exclude_tags_1(t,r,a?e:null),s=this.exclude_tags_1(n,r,a?e:null);return a&&(o&&(e.t0=o),s&&(e.t1=s)),o||s}},exclude_tags_1:function(e,t,n){var a=!1;if(e)for(var r=e.length-1;r>=0;r--)e:for(var o=0;o<t.length;o++)if(t[o].test(e[r])){n&&this.delete_tags(e[r],n.key),e.splice(r,1),a=!0;break e}return a?e:null},key_dirty:Object.create(null),tags_array_old:[],tags_proto:{pk:!1,in:!1,ex:!1,pn:null,mems_keys_obj:function(){var e={};for(var t of this.mems.keys())if(void 0===t.no)for(var n in t)e[t[n].key]=this.mems.get(t);else e[t.key]=this.mems.get(t);return e},mems_keys:function*(){for(var e of this.mems.keys())if(void 0===e.no)for(var t in e)yield e[t];else yield e},mems_keys_length:function(){var e=0;for(var t of this.mems.keys())if(void 0===t.no)for(var n in t)++e;else++e;return e},mems_keys_length_and_set_top:function(){var e=0,t={};for(var n of this.mems.keys()){var a=this.mems.get(n);if(void 0===t[a]&&(t[a]=0),void 0===n.no)for(var r in n)++t[a],++e;else++t[a],++e}for(var r in t)(t[r]>t[this.key]||t[r]==t[this.key]&&r<this.key)&&(this.key=r);return this.key===this.ref_tag&&(this.key=this.ref_tag),e},mems_boards:function(){var e={};for(var t of this.mems.keys())e[t.key.substr(0,t.key.lastIndexOf("/")+1)]=null;return e}},scan_regex:/#[^#, \.:;\n\|"<>&]+(?=[#, \.:;\n\|"<>&]|$)/g,update_tags_in_th_sub:function(e,t,n,a,r,o,s,i,l){for(var c=e.length,p=0;c<r&&p<n.length;){var _=n[p++],d=pref.liveTag.ci?_.toLowerCase():_;if(d===_&&(d=_),void 0===a[d]&&void 0===t[d]){if(t[d]=_,void 0===this.tags[_]){if(void 0===this.tags_ci[d]){null===this.key_dirty[d]&&this.update_pn();var u=new Map;this.tags_ci[d]={key:_,mems:u,ref_tag:_,num:0,ur:s,__proto__:this.tags_proto},this.tags_array_old[this.tags_array_old.length]=this.tags_ci[d]}_!==d&&(this.tags[_]=this.tags_ci[d],void 0===this.tags_ci[d].sb?this.tags_ci[d].sb=[_]:this.tags_ci[d].sb[this.tags_ci[d].sb.length]=_)}var f=this.tags[_].mems;if(_===this.tags[_].ref_tag)_=this.tags[_].ref_tag;else for(var m in f)if(_===f.get(m)){_=f.get(m);break}if(f.has(i))l||(this.key_dirty[d]=null);else{var h=null===o?i:i[o.no],g=f.get(h);void 0!==g&&g===_||(this.key_dirty[d]=null),f.set(h,_)}e[c++]=_}var b=this.tags_reserved[d];if(null===o){var v=this.tags_ci[d].pk;(void 0!==b||v)&&this.tags_reserved_found_scan(d,!0,b,v,i)}else void 0!==b&&this.tags_reserved_found(d,!0,b)}return p},retag_in_th_sub:function(e,t,n){if(n)this.tags[e]&&this.delete_tags(e,t.key);else{this.update_tags_in_th_sub([],{},[e],{},1,null,0,t);var a=this.tags[e].mems;for(var r in t)a.has(r)&&a.delete(r)}},update_tags_in_th:function(e,t,n,a,r,o,s){var i=this.generate_ur(o[1]),l=[],c={};if(this.update_tags_in_th_sub(l,c,e,n,a,r,i,s),t)for(var p=this.update_tags_in_th_sub(l,c,t,n,a,r,i,s);p<t.length;){var _=t[p++],d=pref.liveTag.ci?_.toLowerCase():_;void 0===n[d]&&(c[d]!==_&&(this.key_dirty[d]=null),void 0===c[d]&&this.delete_tags(_,r.key))}for(var p in n)this.check_update_tags_color(n[p],i);for(var p=0;p<l.length;p++)this.check_update_tags_color(l[p],i);return e=null,this.keys_fix=c,l},remove_tags_in_th:function(e){var t=this.mems[e[0]][e[1]][e[2]];if(t){for(var n=t.tags,a=0;a<n.length;a++)this.delete_tags(n[a],t.key);var r=t.btags;if(pref3.stats.use&&stats.thread_removed(e),t.q&&(t.q=null),t.nr&&(pref.notify.favicon||pref.notify.title.notify)&&notifier.favicon.set(),delete this.mems[e[0]][e[1]][e[2]],r)for(var a=0;a<r.length;a++)this.key_dirty[pref.liveTag.ci?r[a].toLowerCase():r[a]]=null,pref.liveTag.style.use&&this.update_ur_1(r[a]);this.update_pn_buf.delayed_do()}},delete_tags:function(e,t){var n=pref.liveTag.ci?e.toLowerCase():e;if(this.key_dirty[n]=null,this.tags[e]&&(this.tags[e].mems.delete(this.mems.getFromName(t))&&pref.liveTag.style.use&&this.update_ur_1(e),0==this.tags[e].mems.size)){this.tags[e].pn;null!==this.tags[e].pn&&this.pn.removeChild(this.tags[e].pn);for(var a in this.active)this.tags[e][a]&&this.active[a]--;var r=this.tags_ci[n].sb;if(r)for(var a=0;a<r.length;a++)delete this.tags[r[a]];delete this.tags_ci[n],pref.debug_mode[3]&&console.log("Remove: "+e)}},check_update_tags_color:function(e,t){var n=this.tags[e].ur;this.tags[e].ur|=t,~n&t&&this.update_tag_node(e)},rm_404:function(e,t,n){if(this.mems[e]&&this.mems[e][t]){var a=this.mems[e][t];for(var r in a)void 0===n[r]&&this.rm_404_1(e,t,r)&&(n[r]=null)}},rm_404_1:function(e,t,n,a){var r,o=e+t+n,s="no"===pref.liveTag.rm_404||(r=liveTag.mems.getFromName(o))&&r.watched&&("watched"===pref.liveTag.rm_404||r.nr);if(a||(pref.test_mode[65]||pref.archive.IDB.auto_clean&&IDB.req(e,t,n,"pruned_time",Date.now(),"check_clean"),pref.test_mode[67]||archiver.clean_list(e,t,n),!s&&!pref.test_mode[65]&&pref.archive.IDB.auto_restore&&cataLog.threads[o]&&cataLog.restore_th_from_IDB(e,t,n)),s){var i=cataLog.threads[o];return i&&"IDB"!==i[14]&&"FILE"!==i[14]&&"x"!==i[14]&&(i[14]="x",cataLog.Footer.update_force(o)),!0}cataLog.gClg.remove_thread(o),this.remove_tags_in_th([e,t,n]),pref[cataLog.embed_mode].deleted_posts.auto_clean&&site2[e].clean_up_deleted_posts_1(t+n)},tooltip:function(e,t){var n,a=e.target;if("checkbox"===a.type){var r=a.name.substr(-2,2);n=a.getAttribute("name").slice(0,-3),t+=("pk"===r?"Fetch":"in"===r?"Show":"Hide")+" threads which have "+n+"."}else{n=a.getAttribute("name"),t+=n+": "+liveTag.make_info(n)+"<br>";var o=new RegExp("^"+site.nickname);for(var s of liveTag.tags[n].mems.keys())t+=s.key.replace(o,"")+", "}return t},boardlist_click_entry:function(e){if(!e.ctrlKey){e.preventDefault();var t=this.textContent;liveTag.cbx_changed(t,pref.liveTag.click_func_bl,null,this)}},generate_ur:function(e){return e>>16!=0?3:0!=(65535&e)?1:0},CountNR:function(){var e=function(){this.nrtm=0,this.nr=0,this.nth=0};return e.prototype={count:function(e){if(786432&e[0]){var t=65535&e[1];t&&(this.nrtm+=e[1]>>16,this.nr+=t,this.nth++)}},count_all:function(){for(var e in liveTag.mems)for(var t in liveTag.mems[e]){var n=liveTag.mems[e][t];if(n.nr<0){var a=new liveTag.CountNR;for(var r in n)a.count(n[r].wt);n.nrtm=a.nrtm,n.nr=a.nr}this.nrtm+=n.nrtm,this.nr+=n.nr}}},e}(),update_ur:function(e,t,n){var a=common_func.fullname2dbt(e);this.mems[a[0]][a[1]].nr=-1;for(var r=this.mems[a[0]][a[1]][a[2]].tags,o=0;o<r.length;o++)n?this.update_ur_1(r[o]):this.tags[r[o]]&&this.check_update_tags_color(r[o],t)},update_ur_1:function(e){var t=this.tags[e].ur,n=0;if(pref.test_mode[24])for(var a of this.tags[e].mems_keys())n|=liveTag.generate_ur(a.wt[1]);else{var r=this.tags[e].mems_keys_obj();for(var a in r){var o=this.mems.getFromName(a);o&&(n|=liveTag.generate_ur(o.wt[1]))}}t!=n&&(this.tags[e].ur=n,this.update_tag_node(e))},count_ur:function(e){var t=0,n={},a=new this.CountNR;if(pref.test_mode[24])for(var r of this.tags[e].mems_keys())a.count(r.wt),n[r.domain+r.board]=null,t++;else{var o=this.tags[e].mems_keys_obj();for(var r in o){var s=common_func.fullname2dbt(r),i=this.mems[s[0]][s[1]][s[2]].wt;i&&a.count(i),n[s[0]+s[1]]=null}t=this.tags[e].mems_keys_length()}var l=Object.keys(this.tags[e].mems_boards()).length;return[a.nrtm,a.nr,a.nth,t,Object.keys(n).length,l]},make_info:function(e){var t=liveTag.count_ur(e);return"U: "+t[0]+"/"+t[1]+"/"+t[2]+" / T: "+t[3]+" / B: "+t[4]+"/"+t[5]},tag_onmouseover:function(e){return liveTag.make_info(e.target.textContent)},cbx_changed:function(e,t,n,a,r){var o=this.tags[e],s=o.in===!1&&o.ex===!0,i=o.in===!1&&o.ex===!1,l=o.in===!0&&o.ex===!1,c="pkin"===t||"in"===t||"inex"===t&&(r?!i:!s),p="pkin"===t&&o.pk===o.in,_="ex"===t||"inex"===t&&(r?!l:!i);c&&this.cbx_emulate_inv(e,"in",n),p&&this.cbx_emulate_inv(e,"pk",n),_&&this.cbx_emulate_inv(e,"ex",n),cataLog.catalog_filter_changed&&cataLog.catalog_filter_changed(),this.update_tag_node(e,a)},filter_onchange:function(e,t){e.rexps=common_func.kwd_prep_regexp(e),t||this.update_pn(e===pref.catalog.filter.tag_search)},tags_reserved:Object.create(null),tags_reserved_found_scan:function(e,t,n,a,r){("pk"===n||a)&&(scan.list_nup.add_board(r,0),scan.scan("b",r.domain)),void 0!==n&&this.tags_reserved_found(e,t,n)},tags_reserved_found:function(e,t,n){this.tags_ci[e][n]!=t&&this.cbx_changed(e,"pk"===n?"pkin":n,!0),delete this.tags_reserved[e]},tags_reserved_init:function(e,t){this.tags_reserved=Object.create(null);for(var n={},a=0;a<e.length;a++){var r="!"===e[a][0]?"ex":"#"===e[a][1]?"pk":"in",o="in"===r?e[a]:e[a].slice(1),s=pref.liveTag.ci?o.toLowerCase():o;if(this.tags_ci[s]){if(this.tags_reserved_found(s,t,r),t&&"pk"===r){var i=liveTag.tags_ci[s].mems_boards();for(var l in i)n[l]=null}}else t&&(this.tags_reserved[s]=r)}return n},update_pn_last_filter_active:!1,sort_func:function(e,t){return t.num-e.num||t.mems.size-e.mems.size||(t.key>e.key?-1:1)},update_pn_disp_func:function(e,t){if(null===e)return 0;for(var n=0;n<e.length;n++)if(e[n].test(t))return 1;return 0},update_pn_buf:null,update_pn:function(e){if(0!==this.pn){if(null===this.pn){if(this.pn=document.getElementsByName("catalog.filter.tag_list")[0],!this.pn)return void(this.pn=0);this.pn.style.height="16px",this.pn.style.width="250px",this.pn_summary=this.pn.previousSibling.childNodes[0],this.pn.onchange=this.cbx_onchange_entry,this.filter_onchange(pref.catalog.filter.tag_search,!0)}this.update_pn_1_lazy.cancel(),this.update_pn_1(e,!0)}},update_pn_pos:null,update_pn_1_lazy:null,update_pn_1:function(e,t){var n=this.tags_array_old,a=0,r=0;for(var o in this.key_dirty)this.tags_ci[o]?this.tags_ci[o].num=pref.liveTag.ci?this.tags_ci[o].mems_keys_length_and_set_top():this.tags_ci[o].mems_keys_length():r++,a++;(a||pref.test_mode[73])&&n.sort(this.sort_func),a&&(t=!0);var s=e||this.update_pn_pos,i=pref.liveTag.lazy_each,l=pref.catalog.filter.tag_search.rexps,c=l||this.update_pn_last_filter_active;if(c||r){for(var p=l&&this.pn.firstChild?null:document.createDocumentFragment(),_=t?0:this.update_pn_pos[0],d=pref.catalog.filter.tag_search.show_nof_boards,u=t?0:this.update_pn_pos[1];u<n.length;u++){var f=n[u].key,m=pref.liveTag.ci?f.toLowerCase():f,h=m in this.key_dirty,g=this.tags_ci[m];if(g){if(c){var b=g.pn;if(s||h){var v=this.update_pn_disp_func(l,m);0===v?null!==b&&(this.pn.removeChild(b),g.pn=null):(null!==b?(h&&(g.pn.childNodes[3].textContent=g.num+": "+f),i>0&&this.pn.childNodes[_]!==b&&(this.pn.insertBefore(b,this.pn.childNodes[_]||null),0==--i&&(this.update_pn_pos=[_+1,u+1]))):i>0&&(b=document.createElement("div"),b.setAttribute("name",f),b.innerHTML='<input type="checkbox" name="'+m+'.pk" '+(g.pk?"checked":"")+'><input type="checkbox" name="'+m+'.in" '+(g.in?"checked":"")+'><input type="checkbox" name="'+m+'.ex" '+(g.ex?"checked":"")+">"+g.num+(d?"/"+Object.keys(this.tags[f].mems_boards()).length:"")+": "+f,g.pn=b,p?p.appendChild(b):this.pn.insertBefore(b,this.pn.childNodes[_]||null),0==--i&&(this.update_pn_pos=[_+1,u+1])),_++)}else b&&_++}}else n.splice(u--,1);if((a<=0||h&&--a<=0)&&(!c||i<=0))break}i<=0&&this.update_pn_pos[1]<n.length?this.update_pn_1_lazy.delayed_do(pref.liveTag.lazy_delay):this.update_pn_pos=null,p&&this.pn.appendChild(p),this.pn_summary.textContent=l?_+"/"+n.length:""}this.tags_array_old=n,this.key_dirty=Object.create(null),pref.virtualBoard.show&&!e&&this.update_boardlist(),this.update_pn_last_filter_active=l},popup_filter:function(){var e={"catalog.filter.tag_search.str":function(){liveTag.filter_onchange(pref.catalog.filter.tag_search)},__proto__:pref_func.settings.oninput_funcs.__proto__},t={"catalog.filter.tag_search.re":e["catalog.filter.tag_search.str"],"catalog.filter.tag_search.show_nof_boards":function(){for(var e=pref.catalog.filter.tag_search.show_nof_boards,t=0;t<liveTag.tags_array_old.length;t++){var n=liveTag.tags_array_old[t].key,a=liveTag.tags[n];a&&a.pn&&(a.pn.childNodes[3].textContent=a.num+(e?"/"+Object.keys(liveTag.tags[n].mems_boards()).length:"")+": "+n)}},__proto__:e};return{html:'<div style="float:left"><input type="checkbox" name="catalog.filter.tag"> Tag :</div><div style="float:left"><div> Fetcn / In / Out / Threads / Tag <ITBL25"catalog.filter.tag_search.str" placeholder="Search tags..."> <ICBX"catalog.filter.tag_search.re">RE</div><div><span></span>'+pref_func.settings.html_funcs.rollup('<IC"catalog.filter.tag_search.show_nof_boards">Show number of boards<br><BTN"tagB.shown_t_pk,T"><BTN"tagB.shown_t_in,T"><BTN"tagB.shown_t_ex,T"> Toggle checkboxes of shown tags<br><BTN"tagB.shown_c_pk,C"><BTN"tagB.shown_c_in,C"><BTN"tagB.shown_c_ex,C"> Clear checkboxes of shown tags<br><BTN"tagB.all_c_pk,C"><BTN"tagB.all_c_in,C"><BTN"tagB.all_c_ex,C"> Clear checkboxes of all tags')+'<br></div><div style="overflow:auto;resize:both;float:left" name="catalog.filter.tag_list"></div>'+pref_func.settings.html_funcs.rollup('<div style="clear:both"><BTN"tag2bList,Add"> selected tags to the last of board group<br>1,Label: <ITBL20"catalog.filter.tag2bList.label" placeholder="default: topmost tag"><br>1,<IR"catalog.filter.tag2bList.by,tag">By tag<br>1,<IR"catalog.filter.tag2bList.by,board">By board<br></div>')+'</div><div style="clear:both"></div>',oninput_funcs:e,onchange_funcs:t,popup:function(){if(!liveTag.pn){var n=function(){pref_func.tooltips.remove_root(a.pn),liveTag.pn=null,cnst.div_destroy(a.pn,!0)},a=cnst.init3({func_str:"top:0px:left:0px:Show:tb",exit:n});a.cn.innerHTML=pref_func.format_html_str(liveTag.popup_filter.html),pref_func.add_onchange(a.cn,t,e),pref_func.apply_prep(a.pn,!1),pref_func.tooltips.add_root(a.pn),liveTag.update_pn(!0)}}}}(),cbx_all_onchange:function(e){var t=e.target,n="c"===t.name.substr(-4,1),a=t.name.substr(-2,2),r="all"===t.name.substr(-8,3),o=null;for(var s in liveTag.tags_ci){var i=liveTag.tags_ci[s];if((r||i.pn)&&(!n||i[a])&&(liveTag.cbx_emulate_inv(s,a,!0),liveTag.update_tag_node(s),"pk"===a&&i[a])){var l=liveTag.tags_ci[s].mems_boards();if(o)for(var c in l)o[c]=l[c];else o=l}}o&&0!=Object.keys(o).length&&scan.scan_ui("refresh_tag",{tgts:o,options:{callback:function(){scan.scan("t")},priority:6}}),cataLog.catalog_filter_changed&&cataLog.catalog_filter_changed()},cbx_emulate_inv:function(e,t,n){var a=this.tags[e],r=!a[t];a[t]=r,null!==a.pn&&(a.pn.childNodes["pk"===t?0:"in"===t?1:2].checked=r),this.cbx_onchange(e,t,r,n)},cbx_onchange_entry:function(e){var t=e.target,n=t.name.slice(0,-3),a=t.name.substr(-2,2);liveTag.tags[n][a]=t.checked,liveTag.cbx_onchange(n,a,liveTag.tags[n][a]),cataLog.catalog_filter_changed&&cataLog.catalog_filter_changed(),liveTag.update_tag_node(n)},cbx_onchange:function(e,t,n,a){if(this.active[t]+=n?1:-1,"pk"===t&&(n&&!this.tags[e].in&&this.cbx_emulate_inv(e,"in"),n&&!a&&catalog_obj&&null!=catalog_obj.catalog_func())){var r=this.tags[e].mems_boards();0!=Object.keys(r).length&&scan.scan_ui("refresh_tag",{tgts:r,options:{callback:function(){scan.scan("t")},priority:6}})}"in"!==t&&"ex"!==t||this.active.in+this.active.ex===(n?1:0)&&(pref.catalog.filter.tag=n,pref_func.mirror_targets.pn12_0_4&&pref_func.apply_prep(pref_func.mirror_targets.pn12_0_4.getElementsByTagName("input")["catalog.filter.tag"],!1))},add_tags_to_boardlist:function(){var e,t=liveTag.tags_array_old,n=pref.catalog.filter.tag2bList.label||(t.filter(function(e){return e.in})[0]||t.filter(function(e){return e.pk})[0]||t.filter(function(e){return e.ex})[0]).key;if("tag"===pref.catalog.filter.tag2bList.by)e=[t.filter(function(e){return e.in}).map(function(e){return e.key}).join(","),t.filter(function(e){return e.pk}).map(function(e){return"#"+e.key}).join(","),t.filter(function(e){return e.ex}).map(function(e){return"!"+e.key}).join(",")];else{for(var a=t.filter(function(e){return e.in}).map(function(e){return e.mems_boards()}),r=t.filter(function(e){return e.pk}).map(function(e){return e.mems_boards()}),o=t.filter(function(e){return e.ex}).map(function(e){return e.mems_boards()}),s={},i=0;i<a.length;i++)for(var l in a[i])s[l]=null;for(var i=0;i<r.length;i++)for(var l in r[i])s[l]=null;for(var i=0;i<o.length;i++)for(var l in o[i])delete s[l];e=Object.keys(s)}pref_func.settings.onchange_funcs["tag.add_to_list"](n+" ,"+e.filter(function(e){return e}).join(","))},search_by_tags:function(e){var t=!this.active.in,n=e.tags;if(this.active.in)for(var a=0;a<n.length;a++)if(n[a]in this.tags&&this.tags[n[a]].in){t=!0;break}if(t&&this.active.ex)for(var a=0;a<n.length;a++)if(n[a]in this.tags&&this.tags[n[a]].ex){t=!1;break}return t},keys_fix:null,prep_tags:function(e,t){var n=this.mems.init(e),a=n.wt;if((65536&a[0]&&pref.liveTag.watch_all&&e.time_created||8388608==(8650752&a[0])&&(e.time_created>0||e.time_posted>0))&&cataLog.set_watch_time_thread(e.key,cataLog.embed_mode,e.time_created,e.time_posted,e,a),65536&a[0]||t){65536&a[0]&&(!pref.test_mode[64]&&pref[cataLog.embed_mode].deleted_posts.merge&&archiver.prep_deleted_posts(e,n),pref.test_mode[67]||archiver.check_op(e,n),a[0]=4294836224&a[0]);var r=(pref.liveTag,[[],[]]);if(pref.liveTag.inherit_board_name){r[pref.liveTag.lock_board_name?0:1][0]=n.btag}if(pref.liveTag.inherit_board_tags&&n.btag2){var o=pref.liveTag.lock_board_tags?0:1;r[o]=r[o].concat(n.btag2)}var s=site2[e.domain].check_reply.check_t1_op(e);if(0!=s.length){var i=pref.liveTag.lock_tags_in_op?0:1;r[i]=r[i].concat(s)}this.exclude_tags(e,r[0],r[1]),e.parse_funcs.has_editing&&e.posts[0].editing&&0!=r[0].length&&(r[0]=this.extract_tags_trim_editing(e,n,r[0])),0!=r[0].length&&(n.t0=this.update_tags_in_th(r[0],null,{},r[0].length<pref.liveTag.max?r[0].length:pref.liveTag.max,e,a,this.mems[e.domain][e.board])),0!=r[1].length?this.extract_tags(e,r[1],this.keys_fix):(null!==n.t1&&(n.t1=null),this.update_pn_buf.delayed_do())}return n},update_tags_in_editing_posts:function(e,t,n){for(var a=e.parse_funcs.posts_obj(e,t.ed_t[t.ed_t.length-1].no),r=!1,o=t.ed_t.length-1;o>=0;o--)if("string"!=typeof t.ed_t[o]){var s=a[t.ed_t[o].no];if(s&&!s.editing){if("post"===pref.liveTag.from||s.no==e.no){site2[e.domain].wrap_to_parse.posts({posts:[s],__proto__:e});var i=site2[e.domain].check_reply.check_t1_op(s);0!=i.length&&(r=!0),t.ed_t=t.ed_t.slice(0,o).concat(i).concat(t.ed_t.slice(o+1))}else t.ed_t.splice(o,1);n[n.length]=s}}if(0!=n.length)return pref.debug_mode[24]&&console.log(e.key+": retag_req: "+i+", "+r+", "+(t.ed_t&&t.ed_t.map(function(e){return"string"==typeof e?e:e.no+"("+e.time+")"}))),0==t.ed_t.length?void(t.ed_t=null):r?this.extract_tags(e,t.ed_t,null,null,!0):i?this.extract_tags_trim_editing(e,t,t.ed_t,!0)&&void 0:void 0},extract_tags_trim_editing:function(e,t,n,a){for(var r=null,o=n.length-1;o>=0;o--)"string"!=typeof n[o]&&(r||(r=n.slice(0,o+1)),n.splice(o,1));return(r||a)&&(t.ed_t=a||!t.ed_t?r:r.concat(t.ed_t),pref.debug_mode[24]&&console.log(e.key+": lth.ed_t: "+(t.ed_t&&t.ed_t.map(function(e){return"string"==typeof e?e:e.no+"("+e.time+")"})))),n},extract_tags:function(e,t,n,a,r){var o=this.mems[e.domain][e.board][e.no];if(e.parse_funcs.has_editing&&(t=this.extract_tags_trim_editing(e,o,t,r)),!n){this.keys_fix={};var s=o.t0;if(null!==s&&0!=s.length)if(pref.liveTag.ci)for(var i=0;i<s.length;i++)this.keys_fix[s[i].toLowerCase()]=s[i];else for(var i=0;i<s.length;i++)this.keys_fix[s[i]]=s[i]}var l=void 0!==s?s.length:o.t0.length,c=this.update_tags_in_th(t,o.t1,this.keys_fix,pref.liveTag.max-l,e,o.wt,this.mems[e.domain][e.board],a);return(0!=c.length||o.t1&&0!==o.t1.length)&&(o.t1=c),this.update_pn_buf.delayed_do(),this.keys_fix=null,o},tags_boardlist:null,update_boardlist:function(e){if(site.components.boardlist){null===this.tags_boardlist&&(this.tags_boardlist=[],pref_func.settings.onchange_funcs["virtualBoard.search.show"](null,!0),this.filter_onchange(pref.virtualBoard.search,!0));for(var t=0,n=e,a=0,r=0,o="both"===pref.virtualBoard.p_board&&pref.virtualBoard.p_remove,s=pref.virtualBoard.search.show&&pref.virtualBoard.search.rexps;r<pref.virtualBoard.max&&t<this.tags_array_old.length;){var i=this.tags_array_old[t].key;o&&"/"+i.substr(1)+"/"in this.mems[site.nickname]?a++:s&&!this.update_pn_disp_func(s,pref.liveTag.ci?i.toLowerCase():i)||(this.tags_boardlist[r]!==i&&(this.tags_boardlist[r]=i,n=!0),r++),t++}r!=this.tags_boardlist.length&&(this.tags_boardlist.splice(r,this.tags_boardlist.length-r),n=!0),n&&site2[site.nickname].show_boardlist(this.tags_boardlist,this.boardlist_click_entry)}},update_tag_node:function(e,t){if(null!==cataLog.threads){var n=liveTag.tags[e].mems_keys_obj();for(var a in n)cataLog.Footer.color_tag_node(a,e)}var r=this.tags_ci[pref.liveTag.ci?e.toLowerCase():e].key,o=t||site2[site.nickname].query_tag_node(r);o&&this.color_tag_node(o,r)},color_tag_node:function(e,t){var n=pref.liveTag.style,a=this.tags[t],r=n.use?a.ur:0,o=a.ex?r>=2?n.exurtm:r>=1?n.exur:n.ex:a.in?r>=2?n.inurtm:r>=1?n.inur:n.in:r>=2?n.urtm:r>=1?n.ur:null;o?e.setAttribute("style",o):e.removeAttribute("style")},update_tag_nodes:function(e,t,n,a,r){for(var o=pref.debug_mode[35]?r&&r.slice():null,s=o?[]:null,i=a||document.createElement("span"),l=i.firstChild,c=0;c<e.length;c++){var p=r&&r.slice();o&&s.push(l&&l.textContent||null);var _=null,d=e[c];if(r&&d==r[c])l&&(l=l.nextSibling),l&&c!=e.length-1&&(l=l.nextSibling),o&&s.push("same");else{var u=r?r.indexOf(d,c):-1;if(u==-1)i.insertBefore(this.create_tag_node_1(d,n,"span"),l),_=!0,r&&r.splice(c,0,d),o&&s.push("new");else if(u==c+1){var f=l,m=l.nextSibling;l=m.nextSibling;var h=e.indexOf(r[c],c+1),g=r.splice(c,1)[0];if(h==-1)i.removeChild(m),i.removeChild(f),o&&s.push("remove");else{var b=i.childNodes[2*(h+1)-1]||null;i.insertBefore(m,b),i.insertBefore(f,b),r.splice(h,0,g),o&&s.push("down")}l=l.nextSibling,l&&c!=e.length-1&&(l=l.nextSibling)}else{var f=i.childNodes[2*u];_=f.previousSibling,i.insertBefore(f,l),r.splice(c,0,r.splice(u,1)[0]),o&&s.push("up")}}c==e.length-1||l&&!_||i.insertBefore(_!==!0&&_||document.createTextNode(t),l),o&&(r&&e.slice(0,c+1).toString()!==r.slice(0,c+1).toString()&&console.log("ERROR: update_tag_nodes: arr: ",c,r,e,p,o,s),r&&0!=i.textContent.indexOf(r.slice(0,c+1).join(t))&&console.log("ERROR: update_tag_nodes_1: ",c,i.textContent,r,p,o,s))}if(l){for(;l.nextSibling;)i.removeChild(l.nextSibling);i.removeChild(l)}return o&&i.textContent!==this.create_tag_nodes(e,t,n).textContent&&console.log("ERROR: update_tag_nodes: ",i.textContent,e,o),i},create_tag_nodes:function(e,t,n){for(var a=document.createElement("span"),r=0;r<e.length;r++)0!=r&&t&&a.appendChild(document.createTextNode(t)),a.appendChild(this.create_tag_node_1(e[r],n,"span"));return a},create_tag_node_1:function(e,t,n){var a=document.createElement(n);return a.setAttribute("class",pref.script_prefix+"_tag"),a.textContent=e,this.color_tag_node(a,e),a.onclick=t,a},tag_node_onclick:function(e){var t=this.textContent;liveTag.cbx_changed(t,pref.liveTag.click_func,null,null,e.ctrlKey)}};liveTag.update_pn_buf=new DelayBuffer(liveTag.update_pn.bind(liveTag),pref.liveTag.disp_delay),liveTag.update_pn_1_lazy=new DelayBuffer(liveTag.update_pn_1.bind(liveTag,!0),pref.liveTag.lazy_delay),liveTag.tags_ci=Object.getPrototypeOf(liveTag.tags),pref_func.site2_json(!1,!0,["liveTag"]);var IDB=function(){function e(e){console.log("IDB: ERROR: ",e),X.report({err_str:"IDB_ERROR:"+e.target.error.name});for(var t of S.keys())console.log(S.get(t));console.log("last_closed: ",B)}function t(e){pref.debug_mode[21]&&console.log("IDB: BLOCKED: "+e.oldVersion+" -> "+e.newVersion)}function n(e){console.log("IDBT: ABORT: "+e.target.error.name,e),X.report({err_str:"IDBT_ABORT:"+e.target.error.name});var t=e.target,n=t.db;navigator.webkitTemporaryStorage&&navigator.webkitTemporaryStorage.queryUsageAndQuota(console.log.bind(console)),x(n,t,"IDBT_abort:"+t.error.name)}function a(e){console.log("IDBT: ERROR: "+e.target.error.name,e),X.report({err_str:"IDBT_ERROR:"+e.target.error.name});var t=e.target.transaction;x(e.target.db||e.target.transaction&&e.target.transaction.db,t,"IDBT_onerror:"+t.error.name)}function r(e){e.target.onsuccess=null,o(e,!0)}function o(e,t){var n=e.target.result;D[n.name]=n.version,delete U[n.name+(t?"vc":"rw")];var a=t&&z[n.name]||R[n.name];if(pref.debug_mode[20]){var r=a&&a.debug_query()||null;console.log("IDB: opened: "+(S.size+1)+" "+n.name.replace(/^[^\/]*/,"")+" v"+n.version+", "+(r&&r.length)+" req(s), "+e.type+", "+(r&&r.coms))}var o={type:e.type,tr_count:1,reqs:a,pass:0,wdg:null,crawler:1,oss:{},tr_info:new Map,req_kinds:{},coms:r&&r.coms,done:0,done_put:0};if(S.set(n,o),a){for(var l=0;l<n.objectStoreNames.length;l++)o.oss[n.objectStoreNames[l]]=null;if(t){var _=e.target.transaction;if(N(n),u(_,function(){k({target:{db:n}})}),1==n.version)return delete U[n.name+"rw"],pref4.archive.IDB_board_sel_options=null,n.createObjectStore("Meta"),i(n,t);for(var d=0;;){P();var f=a.shift();if(o.pass++,!f)break;pref.debug_mode[20]&&o.done++,pref.debug_mode[22]&&"put"!==f.kind&&console.log("req_upgrade: "+f.no+", "+f.kind+", "+f.key+", "+a.debug_query().length),o.req_kinds[f.kind]=null;var m=null===o.oss[f.no];"put"===f.kind?m?(L(R,n.name,f),pref.debug_mode[22]&&d++):(p(n,f,k),o.oss[f.no]=null,pref.debug_mode[22]&&console.log("req_upgrade: "+f.no+", "+f.kind+", "+f.key+", "+a.debug_query().length)):"delete_th"===f.kind&&m&&c(n,f,_)}pref.debug_mode[22]&&d&&console.log("req_upgrade: downgraded: "+d),i(n,t)}else{var h=function e(){s(n,a,t,e)};o.complete_func=h,s(n,a,t,h)}}else i(n,t)}function s(e,t,n,a){var r=S.get(e);if(r){P();var o=void 0!==U[e.name+"vc"]?null:t.shift();if(r.pass++,o){pref.debug_mode[20]&&r.done++,pref.debug_mode[22]&&"put_m"!==o.kind&&console.log(e.name.replace(/^[^\/]*/,"")+o.no+", "+o.kind+", "+o.key+", "+t.debug_query().length);var l=null===r.oss[o.no];if("get_all_m"===o.kind){for(var c=[],p={},u=0;u<o.reqs.length;u++)null===r.oss[o.reqs[u].no]&&(c[c.length]=o.reqs[u],p[o.reqs[u].no]=null);0!==c.length?v(e,{nos:Object.keys(p),reqs:c},a):a()}else if("list_os"===o.kind)o.obj(site.nickname,e.name.substr(pref.script_prefix.length+1),Array.prototype.slice.call(e.objectStoreNames).filter(function(e){return"Meta"!==e})),a();else if("put_m"===o.kind){for(var c=[],p={},u=0;u<o.reqs.length;u++)null!==r.oss[o.reqs[u].no]?L(z,e.name,o.reqs[u]):(c[c.length]=o.reqs[u],p[o.reqs[u].no]=null);pref.debug_mode[22]&&console.log(e.name.replace(/^[^\/]*/,"")+(c[0]&&c[0].no||"skipped")+"("+Object.keys(p).length+"), "+o.kind+"("+c.length+"), "+o.key+", "+t.debug_query().length),c.length>1?(o.reqs=c,o.nos=Object.keys(p),_(e,o,a)):1==c.length?_(e,c[0],a):a()}else if("put"===o.kind)l?_(e,o,a):(L(z,e.name,o),a());else if("delete"===o.kind)l?d(e,o,a):a();else if("clean_up"===o.kind||"clean_m"===o.kind){O[e.name]||(O[e.name]={list:[],write:null});for(var f=O[e.name].list,h=f.length,p={Meta:null,__proto__:o.obj},u=0;u<f.length;u++)p[f[u].no]=null;if("clean_up"===o.kind)for(var b=Date.now(),y=e.objectStoreNames,u=0;u<y.length;u++)null!==p[y[u]]&&(f[f.length]={no:y[u],pruned_time:b});else for(var u=0;u<o.reqs.length;u++)null===r.oss[o.reqs[u].no]&&null!==p[o.reqs[u].no]&&(f[f.length]={no:o.reqs[u].no,pruned_time:o.reqs[u].obj});null===O[e.name].write?(O[e.name].write=!1,m(e,o,a)):g(e,null,a,f.length!==h)}else a();r.crawler<pref.archive.IDB.nof_tr&&!t.isEmpty&&(r.crawler++,s(e,t,n,a))}else 0==--r.crawler&&i(e,n)}}function i(e,t){k({target:{db:e}});var n=t&&z[e.name]&&z||R;n[e.name]&&n[e.name].isEmpty&&delete n[e.name],M[e.name]&&l(e.name),t?R[e.name]&&!R[e.name].isEmpty&&I(e.name):z[e.name]&&!z[e.name].isEmpty&&I(e.name,!0),0===Object.keys(R).length&&0===Object.keys(z).length&&0===Object.keys(M).length&&K.stop()}function l(e){R[e]?R[e].push_all(M[e]):R[e]=M[e],delete M[e]}function c(e,t,n){e.deleteObjectStore(t.no),pref.debug_mode[23]&&console.log("IDB: delete_th: "+e.name+t.no+", "+e.objectStoreNames.length)}function p(e,t,n){N(e);var a=e.createObjectStore(t.no).transaction;u(a,function(a){return function(r){pref.test_mode[66]?(L(R,e.name,t),n({target:{db:e}})):_(e,t,n),a&&a(r)}}(a.oncomplete))}function _(t,n,a){var r=n.reqs||[n];try{for(var o=u(t.transaction(n.nos||n.no,"readwrite",n),a,n,t),s=0;s<r.length;s++){var i=r[s];if(pref.test_mode[82]&&i.obj instanceof Blob)if(pref.test_mode[83])i.obj=null;else if(pref.test_mode[84]){for(var l="";2*l.length<i.obj.size;)l+=Math.random();i.obj=l}else{for(var c=[],p=0;2*p<i.obj.size;p++)c[p]=Math.floor(65536*Math.random());i.obj=String.fromCharCode.apply(null,c)}pref.debug_mode[23]&&console.log("put_"+(n.nos?"m: ":"1: ")+t.name.replace(/^[^\/]*/,"")+i.no+", "+i.key+("posts"===i.key?":"+i.obj.length:"")+(n.nos?" "+(s+1)+"/"+n.nos.length+"/"+n.reqs.length:""));o.objectStore(i.no).put("posts"!==i.key?i.obj:JSON.stringify(i.obj,archiver.store_json_func),"posts"!==i.key?i.key:i.key+"_"+i.obj[0].no).onerror=e}pref.debug_mode[20]&&(S.get(t).done_put+=r.length)}catch(e){console.log("IDB: fail to put: "+e.name+": "+JSON.stringify(i,["no","key","kind"]),e,S.get(t)),"InvalidStateError"===e.name&&(L(M,t.name,i),pref.debug_mode[20]&&console.log("IDB: re-scheduled:")),a({target:{db:t}})}}function d(e,t,n){u(e.transaction(t.no,"readwrite"),n).objectStore(t.no).delete(t.key)}function u(e,t,r,o){return e.oncomplete=r?f:t,e.onabort=n,e.onerror=a,r&&S.get(o).tr_info.set(e,{req:r,func:t}),e}function f(e){var t=S.get(e.target.db);if(t){
var n=t.tr_info.get(e.target).func;t.tr_info.delete(e.target),n&&n(e)}}function m(e,t,n){e.objectStoreNames.contains("Meta")?u(e.transaction("Meta","readwrite"),n).objectStore("Meta").get("pruned_time").onsuccess=h:(O[e.name].write=!0,g(e,t,n,!0))}function h(e,t){var n=e.target.transaction.db,a=e.target.result;if(a){var r=S.get(n),o=r&&r.oss||{};a=a.filter(function(e){return null===o[e.no]});for(var s={},i=0;i<a.length;i++)void 0!==s[a[i].no]&&a.splice(s[a[i--].no],1),s[a[i].no]=i;O[n.name].list=a.concat(O[n.name].list.filter(function(e){return void 0===s[e.no]}))}O[n.name].write=!0,g(n,null,null,!0)}function g(e,t,n,a){for(var r=O[e.name].list,o=Date.now()-36e5*pref.archive.IDB.prune,s=0;s<r.length&&r[s].pruned_time<o;)pref.archive.IDB.auto_restore_remove&&liveTag.rm_404_1(site.nickname,e.name.replace(/^[^\/]*/,""),r[s].no,!0),pref.archive.IDB.prune_flush?L(R,e.name,{no:r[s++].no,key:null,obj:b,kind:"get_all"},!0):L(z,e.name,{no:r[s++].no,key:null,obj:null,kind:"delete_th"},!0);s>0&&r.splice(0,s),O[e.name].write&&(a||0!==s)&&L(R,e.name,{no:"Meta",key:"pruned_time",obj:r,kind:"put"}),n&&n()}function b(e,t,n,a){var r="CatChan_archive_pruned_"+e+"-"+t.slice(1,-1)+"-"+n+".tar",o="pruned_"+e+t+n+Date.now();archiver.event_funcs.export_thread(e,t,n,a,o,r),C(e,t,n,null,null,"delete_th")}function v(e,t,n){for(var a=u(e.transaction(t.nos,"readonly"),n),r=0;r<t.reqs.length;r++){var o=t.reqs[r];pref.debug_mode[23]&&console.log("get_all: "+e.name.replace(/^[^\/]*/,"")+o.no+", "+o.key);var s=a.objectStore(o.no).openCursor("posts"===o.key?IDBKeyRange.bound("posts","postt",!1,!0):void 0);s.onsuccess=w,o.result={},j.set(s,o)}}function y(e){var t=e.target.transaction.db,n=S.get(t);return n&&n.pass++,t}function w(e){var t=(y(e),e.target),n=j.get(t),a=e.target.result;if(a)n.result[a.key]=a.key.indexOf&&0===a.key.indexOf("posts")?JSON.parse(a.value):a.value instanceof ArrayBuffer?common_func.arraybuffer2blob(a.key,a.value):a.value,a.continue();else{j.delete(t);var r=e.target.transaction.db.name.replace(pref.script_prefix+".",""),o=e.target.source.name;if(setTimeout(function(e,t,n){return function(){e.obj(site.nickname,t,n,e.result)}}(n,r,o),0),pref.debug_mode[29]){var s=0;for(var i in n.result)s+=0===i.indexOf("posts")?2*JSON.stringify(n.result[i]).length:n.result[i]&&n.result[i].size;console.log("IDB: "+r+o+": "+Object.keys(n.result).length+" files, "+s.toLocaleString()+" bytes.")}}}function k(e){var t=e.target.source&&e.target.source.transaction.db||e.target.db||e.target.result,n=S.get(t);n&&(1!==n.tr_count?n.tr_count-=1:T(t,n))}function x(e,t,n){var a=S.get(e);if(a&&"readonly"!==t.mode){var r=a.tr_info.get(t).req;L("delete_th"===r.kind?z:M,e.name,r),console.log(n+": close and re-req, "+r.kind)}}function T(e,t,n){if(t||(t=S.get(e)),n&&t)for(var a of t.tr_info.keys())x(e,a,n);S.delete(e);var r=!n&&void 0!==t.req_kinds.delete_th&&1===Object.keys(t.req_kinds).length||1==e.version;pref.debug_mode[26]&&r&&console.log("Hit the case of test_mode[78]"),!r||pref.test_mode[78]?e.close():setTimeout(function(){e.close()},0),pref.debug_mode[20]&&console.log("IDB: closed: "+S.size+" "+e.name.replace(/^[^\/]*/,"")+" v"+e.version+", "+(t?t.type+", done:"+t.done+", done_put:"+t.done_put+", "+t.coms:"")),t&&(t.db=e),B=t,P()}function N(e){S.get(e).tr_count+=1}function C(e,t,n,a,r,o){if(e===site.nickname){var s=pref.script_prefix+"."+t,i={no:n,key:a,obj:r,kind:o};L("delete_th"===o?z:R,s,i,!0)}else"function"==typeof r&&(H[e+t+n]=r,r="sub_callback"),pref.test_mode[86]&&r instanceof ArrayBuffer?send_message(e,["IDB",["ACC",[e,t,n,a,null,o]]],null,[r]):send_message(e,["IDB",["ACC",[e,t,n,a,r,o]]])}function I(n,a,s){var i=n+(a?"vc":"rw");if(void 0!==U[i]&&(!s||++U[i]<S.size))return void(pref.debug_mode[27]&&s&&console.log("IDB: WATCHDOG: "+i+", "+U[i]));U[i]=0;var l=window.indexedDB.open(n,a&&D[n]+1||void 0);l.onerror=e,l.onsuccess=o,l.onupgradeneeded=r,l.onblocked=t}function A(e,t,n,a,r,o){if(e===site.nickname){var s={no:n,key:a,obj:r,kind:o};L("delete_th"===o?z:R,t,s,!0)}}function L(e,t,n,a){if(W++,!X&&q?(X=q.shift("limegreen","w","IDB",0),X.report({start:Date.now(),prog_str:"Opening"})):P(),e[t]){var r=e===R&&e[t].isEmpty;if(e[t].push(n),r)for(var o of S.keys()){var s=S.get(o);if(s.crawler<pref.archive.IDB.nof_tr&&o.name===t&&"success"===s.type){s.crawler++,setTimeout(s.complete_func,100);break}}}else e[t]=new F(t,e!==z,n),a&&I(t,e===z);K.start(1e3*pref.archive.IDB.watchdog)}function E(){var e=0;for(var t of S.keys())e+=S.get(t).crawler;for(var n=[0,0,0,0,0,0,Object.keys(z).length,Object.keys(R).length,Object.keys(M).length,e,S.size,Object.keys(U).length],a=[z,R,M],r=0;r<3;r++)if(n[r+6])for(var o in a[r])n[r+3]+=a[r][o].length,n[r]+=a[r][o].length_whole;return{sums:n,total:n.reduce(function(e,t){return e+t}),str:n.join("/")+"/"+W}}var j=new Map,B=null,S=new Map,O={},D={},U={},z={},R={},M={},H={},F=function(e,t,n){this.ary=[],this.ary_ro=[],this.allow_multi=t,this.reqs[e]||(this.reqs[e]={}),this.reqs=this.reqs[e],this.cls={},n&&this.push(n),this.cl=null,this.cl_idx=0};F.prototype={shift:function(){for(var e=this.allow_multi?pref.archive.IDB.nof_cl_max:1,t=0;t<this.ary_ro.length&&t<e&&"get_all"===this.ary_ro[t].kind;)t++;if(0!=t)return{kind:"get_all_m",reqs:this.ary_ro.splice(0,t)};if(0!==this.ary_ro.length)return this.ary_ro.shift();if(0===this.ary.length&&!this.cl)return null;if(pref.test_mode[79]){for(;t<e;){var n=this.ary[t];if(!n)break;if(n.cl&&(this.ary=this.ary.slice(0,t+1).concat(n.cl,this.ary.slice(t+1)),n.cl=null),"put"!==n.kind)break;this.cls[n.no]=null,delete this.cls[n.no+n.key],t++}return t>1?{kind:"put_m",reqs:this.ary.splice(0,t)}:this.ary.shift()}var a=[];if(pref.test_mode[81])for(;a.length<e;){var n;if(null===this.cl){if(!(n=this.ary[t])||"put"!==n.kind)break;t++,n.cl&&(this.cls[n.no]=null,this.cl=n.cl,this.cl_idx=0,n.cl=null)}else n=this.cl[this.cl_idx++],this.cl_idx>=this.cl.length&&(this.cl=null);a[a.length]=n,delete this.reqs[n.no+n.key]}else{for(var r;a.length<e;){var n=this.ary[t];if(!n||"put"!==n.kind)break;if(void 0!==r&&(!n.no||r!==n.no))break;n.cl?(void 0===n.idx&&(this.ary[t]={kind:"put",cl:[n].concat(n.cl),idx:0,no:n.no},n.cl=null,n=this.ary[t],this.cls[n.no]=n),n.idx>=n.cl.length-1&&(this.cls[n.no]=null,t++),n=n.cl[n.idx++]):(this.cls[n.no]=null,t++),a[a.length]=n,delete this.reqs[n.no+n.key],a.length===pref.archive.IDB.nof_cl-1&&(r=n.no)}if(this.ary[t]&&this.ary[t].cl&&this.ary[t].idx<this.ary[t].cl.length){var o=this.ary.splice(t,1)[0];this.ary[this.ary.length]=o}}return t>0&&this.ary.splice(0,t),0===t&&this.ary[0]&&"check_clean"===this.ary[0].kind&&(this.cls.check_clean=null),a.length>1?{kind:"put_m",reqs:a}:a.length>0?a[0]:this.ary.shift()},push:function(e){if("get_all"===e.kind||"list_os"===e.kind)return void(this.ary_ro[this.ary_ro.length]=e);if("put"===e.kind)var t=e.no+e.key,n=this.reqs[t];if(n)n.obj="posts"===e.key?n.obj.concat(e.obj):e.obj;else if(t){"posts"!==e.key&&"pruned_time"!==e.key&&"posts_deleted"!==e.key||(this.reqs[t]=e);var a=this.cls[e.no];a?a.cl?a.cl[a.cl.length]=e:a.cl=[e]:(this.ary[this.ary.length]=e,this.cls[e.no]=e)}else if("check_clean"===e.kind){var t=null+e.key,n=this.cls[t];n?n.reqs[n.reqs.length]=e:(e={kind:"clean_m",reqs:[e],no:null},this.cls[t]=e,this.ary[this.ary.length]=e)}else this.ary[this.ary.length]=e},push_all:function(e){for(;!e.isEmpty;)this.push(e.shift())},get length(){return this.ary.length+this.ary_ro.length},get length_whole(){for(var e=0,t=0;t<this.ary.length;t++)e+=this.ary[t].cl?this.ary[t].cl.length-(this.ary[t].idx||0):1;return e+this.ary_ro.length},get isEmpty(){return 0===this.ary.length&&!this.cl&&0===this.ary_ro.length},reqs:{},debug_query:function(){for(var e=Array.prototype.concat.apply(this.ary_ro,this.ary.map(function(e){return e.cl?pref.test_mode[81]?[e].concat(e.cl):e.cl.slice(e.idx||0):e})),t=[],n=1,a=0;t.length<20&&a++<e.length;)e[a]&&e[a-1].kind===e[a].kind?n++:(t[t.length]=e[a-1].kind+(1!=n?"*"+n:""),n=1);return a<e.length&&(t[t.length-1]+="..."),{coms:t,length:this.ary_ro.length+"/"+this.ary.length+"/"+e.length}}};var q=null,X=null,W=0,P=function(){},P=DelayBuffer.prototype.delayed_do.bind(new DelayBuffer(function(){if(X){var e=E();X.report({prog_str:e.str}),0===e.total&&(X.report({end:Date.now()}),X=null,W=0)}},100)),K=new Watchdog(function(){function e(){t.str&&(X.report({err_str:"WDG: "+t.str}),t.str="")}var t=E();pref.debug_mode[27]&&console.log("IDB: "+t.str);var n={};for(var a of S.keys()){var r=S.get(a);pref.debug_mode[27]&&console.log(r),r.wdg!==r.pass?(r.wdg=r.pass,n[a.name]=null):(e(),T(a,r,"IDB: WDG"))}for(var o in z)null===n[o]||z[o].isEmpty||I(o,!0,!0);for(var o in R)null===n[o]||z[o]&&!z[o].isEmpty||R[o].isEmpty||I(o,void 0,!0);for(var o in M)null===n[o]||z[o]&&!z[o].isEmpty||R[o]&&!R[o].isEmpty||M[o].isEmpty||(l(o),I(o,void 0,!0));for(var s in U){var i=s.replace(/(rw|vc)$/,"");null===n[i]||z[i]||R[i]||(e(),I(i,s.search(/vc$/)!=-1,!0))}0!==t.total&&K.start(1e3*pref.archive.IDB.watchdog)},6e4);return{req:C,req_raw:A,clean_up:function(e,t,n){D[pref.script_prefix+"."+t]&&(C(e,t,null,null,n,"clean_up"),liveTag.mems[e][t].IDB_synced=1)},set_indicator:function(e){q||(q=e)},sub_funcs:function(e,t){if("ACC"===e[0])"sub_callback"===e[1][4]?e[1][4]=IDB.sub_ack:t.length>0&&(e[1][4]=t[0]),C.apply(this,e[1]);else if("ACK"===e[0]){var n=e[1].slice(0,3).join("");H[n]&&H[n].apply(this,e[1]),delete H[n]}},sub_ack:function(e,t,n,a){send_message("parent",["IDB",["ACK",[e,t,n,a]]])}}}(),archiver=function(){function e(e,n,a,o){window.URL&&(b||r(),t(new Blob([e],{type:n}),a,o,b))}function t(e,t,a,r){pref.archive.tar?h.add_blob(e,t,a,r):n(e,"CatChan_"+t.key.replace(/\//g,"_")+"_"+a)}function n(e,t){if(e instanceof ArrayBuffer&&(e=common_func.arraybuffer2blob(t,e)),brwsr.ff&&!httpd.isLocal)return void send_message("parent",["ARCHIVER",["DOWNLOAD",[e,t]]]);var n=window.URL.createObjectURL(e);a(n,t),window.URL.revokeObjectURL(n)}function a(e,t){if(!pref.test_mode[70]){var n=document.createElement("div");n.innerHTML="<a href="+e+' download="'+t+'">',brwsr.ff&&site.script_body.appendChild(n),n.childNodes[0].click(),brwsr.ff&&site.script_body.removeChild(n)}}function r(){var e=(new Date).toString().split(" ").slice(1,5);b=[e[2],v[e[0]],e[1],e[3].replace(/:/g,"")].join(""),httpd.req({tgts:[],timestamp:b,__proto__:g},0)}function o(e){httpd.req_add({tgts:e,timestamp:b,__proto__:g},0)}function s(e,t,n,a,o,s,i,l,c){for(var p=0;p<a.length;p++){var _="tn"===e?site2[t.domain].catalog_json2html3_thumbnail(a[p],t.board):site2[t.domain].catalog_json2html3_src(a[p],t.board);if(_){b||r();var d={domain:t.domain,board:t.board,no:t.no,key:t.key,kind:e,to_file:o||i,to_idb:s||l,timestamp:b,__proto__:g};if(site2[t.domain].archive_patch_domain&&site2[t.domain].archive_patch_domain(d),(".webm"===_.substr(-5,5)?i||l:o||s)&&(c[c.length]={url:_,__proto__:d}),a[p].extra_files)for(var u=0;u<a[p].extra_files.length;u++)_="tn"===e?site2[t.domain].catalog_json2html3_thumbnail(a[p].extra_files[u],t.board):site2[t.domain].catalog_json2html3_src(a[p].extra_files[u],t.board),(".webm"===_.substr(-5,5)?i||l:o||s)&&(c[c.length]={url:_,__proto__:d})}}}function l(){function e(e){return function(t,n){var a=e.call(this,t,n);return a&&t.localArchive?archiver.url2file(t.localArchive,a):a}}for(var t in site2)if(site2[t].hasOwnProperty("catalog_json2html3_thumbnail")&&(site2[t].catalog_json2html3_thumbnail=e(site2[t].catalog_json2html3_thumbnail)),site2[t].hasOwnProperty("catalog_json2html3_src")&&(site2[t].catalog_json2html3_src=e(site2[t].catalog_json2html3_src)),site2[t].hasOwnProperty("parse_funcs"))for(var n=["catalog_html","page_html","thread_html","post_html"],a=0;a<n.length;a++)site2[t].parse_funcs.hasOwnProperty(n[a])&&site2[t].parse_funcs[n[a]].hasOwnProperty("op_img_url")&&(site2[t].parse_funcs[n[a]].op_img_url=e(site2[t].parse_funcs[n[a]].op_img_url))}function c(e,t,n,a){if(window.URL){var r=a?t:"text/html"===e.type?(new DOMParser).parseFromString(t,"text/html"):JSON.parse(t),o="auto"===pref.archive.format?common_func.name2domainboardthread(e.name.replace(/\.[^\.]*$/,"").split("_")[0].split("-").slice(0,3).join("/"),!0):[site0.domains[pref.archive.domain],"/"+pref.archive.board.replace(/\//g,"")+"/"];if(pref.test_mode[80]&&(o[1]=o[1].slice(0,-1)+(a?"_IDB/":"_File/")),pref.archive.fix_inconsistency&&"meguca"!==o[0]){r.posts[0].no!=o[2]&&(r.posts=[common_func.deep_copy(r.posts[0])].concat(r.posts),r.posts[0].no=o[2],console.log("Archiver: Fixed: added dummy OP: "+o.join("")));for(var s=0;s<r.posts.length;s++)r.posts[s].filename===!1&&(r.posts[s].filename="LOST_AT_ARCHIVE",console.log("Archiver: Fixed: filename was lost: "+o.join("")+"#"+r.posts[s].no))}w||(l(),w=!0);var i=cataLog.scan_boards_keyword_callback2(o[0]+","+o[1]+","+k+++",thread_"+("text/html"===e.type?"html":"json"),{date:Date.now(),status:200,response:r},["archive_restore",{localArchive:n,page:a?"IDB":"File",__proto__:cataLog.scan_boards_keyword_callback2_default_args}]);return cataLog.threads[i[0].key][16].archiveFile=a?"IDB":e,i[0]}}function p(e,t,n,a){"ARC"===e||"ARC1"===e?(t.archived|="ARC"===e?6:1,a||scan.list_nup.add_scan(t)):"UARC"===e&&(t.archived=0,archiver.clean_list(t.domain,t.board,t.no)),n&&pref.catalog.footer.archived&&cataLog.Footer.update_force(t.key)}function _(e,t){return null===x[e]?void 0:t}function d(){pref.debug_mode[28]&&console.log("list_all_obj_downloading: ",I);for(var e in liveTag.mems){var t=site2[e].parse_funcs.post_json.time_unit;for(var n in liveTag.mems[e]){var a=C[e]&&C[e][n],r=a||{};for(var o in liveTag.mems[e][n]){var s=liveTag.mems[e][n][o],i=I[s.key]||s.time_checked/t;s.ed_t&&(i=pref.archive.editing_timeout?u(s)||i:s.ed_t[s.ed_t.length-1].time-1),s.archived?I[s.key]?r[o]=I[s.key]:(!r[o]||r[o]<i)&&(r[o]=i):s.posts_saved&&(r[o]=-i)}a||0===Object.keys(r).length?a&&0===Object.keys(a).length&&delete C[e][n]:(C[e]||(C[e]={}),C[e][n]=r)}C[e]&&0===Object.keys(C[e])&&delete C[e]}}function u(e){for(var t=Date.now()/1e3,n=e.ed_t.length-1;n>=0;n--)if("string"!=typeof e.ed_t[n]){var a=e.ed_t[n].time;if(t-a<3600)return a}return null}function f(e){e&&e.key!==N||(C=JSON.parse(e&&e.newValue||localStorage[N]||"{}"))}function m(){pref3.archive.working&&localStorage&&(d(),0===Object.keys(C).length?delete localStorage[N]:localStorage[N]=JSON.stringify(C),pref.debug_mode[28]&&console.log("list_all_obj: ",C))}var h=function(){function e(e,n,r){var o=new Uint8Array(512);r="tn_"===r.substr(0,3)?"thumbs/"+a(r.substr(3)):"img_"===r.substr(0,4)?"images/"+a(r.substr(4)):a(r),t(o,0,n.domain+"/"+a(n.board.slice(1,-1))+"/"+n.no+"/"+r,100),t(o,100,"100777",8),t(o,108,"0",8),t(o,116,"0",8),t(o,124,(e.byteLength||e.size||0).toString(8),12),t(o,136,Math.floor(Date.now()/1e3).toString(8),12),t(o,148,"        ",8),o[156]=48;var s=0;for(i=0;i<157;i++)s+=o[i];return t(o,148,s.toString(8),8),o}function t(e,t,n,a){for(var r=0;r<n.length&&r<a;)e[t++]=255&n.charCodeAt(r++);r<a&&(e[t++]=0)}function a(e){return encodeURIComponent(e).replace(/[!'()*]/g,function(e){return"%"+e.charCodeAt(0).toString(16)})}var r={},o=0;return{add_blob:function(t,n,a,o,s){r[o]||(r[o]={files:[],size:0});var i=r[o],l=t.byteLength||t.size;i.files[i.files.length]=e(t,n,a),i.size+=1,i.files[i.files.length]=t,l%512!=0&&(i.files[i.files.length]=new Uint8Array(512-l%512)),i.size+=Math.floor((l+511)/512),!s&&(i.size>2*pref.archive.tarsize*1024||pref.test_mode[71])&&this.flush(o)},flush:function(e,t){if(e)r[e]&&(r[e].files[r[e].files.length]=new Uint8Array(1024),n(new Blob(r[e].files,{type:"application/x-tar"}),t||"CatChan_archive_updates_"+site.nickname+"_"+e+"_"+o+++".tar"),delete r[e]);else for(var a in r)this.flush(a)}}}(),g={initiator:"archive",get responseType(){return pref.test_mode[85]?"blob":"arraybuffer"},archive:!0,callback_1:httpd.onload_archive,callback_1_fail:httpd.onload_archive_fail,get max(){return this.tgts.length},get tgt(){return this.key+this.url.substr(this.url.lastIndexOf("/"))}},b=null,v={Jan:"01",Feb:"02",Mar:"03",Apr:"04",May:"05",Jun:"06",Jul:"07",Aug:"08",Sep:"09",Oct:"10",Nov:"11",Dec:"12"},y=DelayBuffer.prototype.delayed_do.bind(new DelayBuffer(function(){httpd.check_timestamp_and_flush(b)},5e3)),w=(new Map,!1),k=0,x={pn:null,time_bumped:null,time_created:null,time_posted:null,flag:null,footer:null,time_tu:null,nof_posts:null,nof_files:null,tags:null,page:null,parse_funcs:null,quotes:null,backlinks:null,reply_to_me:null,reply_of_mine:null,op_img_url:null},T=function(){var e={html:function(){var e=document.createElement("div"),t={A:null,SPAN:null,DIV:null,BLOCKQUOTE:null,BR:null,WBR:null,U:null,S:null,STRIKE:null,B:null,I:null,BIG:null,SMALL:null,TT:null,SUB:null,SUP:null,EM:null,STRONG:null};return function(n,a,r){e.innerHTML=a;for(var o=e.getElementsByTagName("*"),s=0;s<o.length;s++)if(null!==t[o[s].tagName])return void(r[n]="")}}(),string:function(e,t,n){t.search(/[<>"'&]/)!=-1&&(n[e]="")}};return function(t){if(t)for(var n=0;n<t.length;n++){var a=t[n];for(var r in a)"string"==typeof a[r]&&("com"===r?e.html(r,a[r],a):e.string(r,a[r],a))}return t}}(),N=pref.script_prefix+".archived",C={};localStorage&&f(),pref.debug_mode[28]&&console.log("list_all_obj: ",C);var I={};return window.addEventListener("storage",f,!1),window.addEventListener("beforeunload",m,!1),{clean_list_all:function(e,t,n){if(C[e]&&C[e][t]){var a=C[e][t];for(var r in a)void 0===n[r]&&this.clean_list(e,t,r)}},clean_list:function(e,t,n){C[e]&&C[e][t]&&delete C[e][t][n]},check_op:function(e,t){var n=pref.archive.kwd;(pref.archive.store_auto&&n.str&&(n.sub||n.name||n.com)&&cataLog.threads&&cataLog.catalog_filter_query_keyword.kwd(pref.archive.kwd,e.posts,e.domain,e)||this.check_archived_time(e.key,e.domain,e.board,e.no,e.parse_funcs.time_unit)!==!1)&&p("ARC",t,!1,!0)},check_archived_time:function(e,t,n,a,r){if(pref.archive.list){var o=pref3.archive.list_obj2[e];if(o&&o.time)return o.time}var s=C[t]&&C[t][n]&&C[t][n][a];return pref.archive.list_inherit&&s?s:(pref.archive.list&&(o=pref_func.merge_obj5(e,pref3.archive.list_obj2,null)),!!o&&(o.time/r||s||0))},update_archived_time:function(e){if(pref3.archive.working=!0,pref3.archive.list_obj2[e]&&pref3.archive.list_obj2[e].time){var t=new RegExp("(^|,)"+e.replace(/\+/,"\\+")+"([\\^@!][^,\n]*)*(,|\n|$)","mg");pref.archive.list_str=pref.archive.list_str.value.replace(t,",")+","+e+"\n",pref.archive.list_str=str.replace(/,,+/g,",").replace(/^,/g,"").replace(/\n,/g,"\n").replace(/\n\n+/g,"\n").replace(/^\n/,""),pref3.archive.list_obj2[e].time=null}},store_entry:function(e,t){if(cataLog.threads){if("shown"===pref.archive.src)for(var n in cataLog.threads)null===cataLog.threads[n][9][0]&&(cataLog.threads[n][9]=cataLog.catalog_filter_query(n,!0));for(var n in cataLog.threads){var a=liveTag.mems.getFromName(n);("stored"===pref.archive.src||"watched"===pref.archive.src&&a.watched||"shown"===pref.archive.src&&cataLog.threads[n][9][0])&&p(e,a,!0)}}},start_1:p,restore_posts_from_IDB:function(t,n,a,r,o,s){var i=this.event_funcs.consolidate_IDB_result(s);if(i.posts.length>1){var l=n.lth;i.time_loaded=i.posts[i.posts.length-1].time;var c=this.check_deleted_posts(t,n,l,i,!0);if(l.archived&&c&&2&l.archived&&pref.archive.live.post){var p=n.key.replace(/\//g,"-");e(JSON.stringify(site2[n.domain].parse_funcs.thread_json.prep_to_archive(c)),"text/plain",l,p+"_deleted.json")}}},store_th_to_mem:function(e,t,n,a,r){if("no"!==a){if(r&&n.ta.posts)for(var o=n.ta.posts,s=o.length-1,i=r.length-1;i>=0;i--){for(;s>=0&&o[s].no!=r[i].no;)s--;s>=0?o[s]=r[i]:s=o.length-1}var l=pref[cataLog.embed_mode].deleted_posts.detect,c=t.posts&&t.posts.length>1&&t.nof_posts>t.posts.length&&n.ta&&"passive"!==l?site2[t.domain].update_posts_replace_prep(t.posts,n.ta.posts,"number"==typeof a?a:-1):t.parse_funcs.has_posts?t.posts:n.ta&&n.ta.posts||t.posts;if(!pref.test_mode[65]&&(n.archived&&pref.archive.live.post_idb||"full_IDB"===l)){n.ta||"full_IDB"!==l||IDB.req(t.domain,t.board,t.no,"posts",this.restore_posts_from_IDB.bind(this,e,{posts:t.posts,__proto__:t}),"get_all");var p;n.ta?p=n.ta.posts[n.ta.posts.length-1].time:(p=C[t.domain]&&C[t.domain][t.board]&&C[t.domain][t.board][t.no])<0&&(p=-p);var _;if(p&&(!n.ta||n.ta.posts.length===n.ta.nof_posts||t.posts.length<t.nof_posts)){for(var i=t.posts.length;i>0&&t.posts[i-1].time>p;)i--;_=t.posts.slice(i)}else _=t.posts;r&&(_=r.concat(_)),_.length>0&&("html"===t.type_data&&cataLog.format_html.prepare_html_extract_params(t),IDB.req(t.domain,t.board,t.no,"posts",_,"put"),n.posts_saved=1),pref.debug_mode[28]&&_.length>0&&console.log("posts_saved: "+t.key+", "+p+", "+_[_.length-1].time+" "+new Date(_[_.length-1].time*t.parse_funcs.time_unit).toLocaleString()+", LS:"+(C[t.domain]&&C[t.domain][t.board]&&C[t.domain][t.board][t.no]))}n.ta={posts:c,nof_posts:t.nof_posts,time_loaded:t.time_loaded}}else n.ta&&delete n.ta},check_deleted_posts:function(e,t,n,a,r){if("no"!==pref[cataLog.embed_mode].deleted_posts.detect&&a&&a.posts.length>1){var o=t.posts,s=a.posts,i=t.nof_posts===t.posts.length||"thread"===t.type_source,l=1,c=1;i?n.rescan_dp=0:(l=a.nof_posts-s.length+1-(t.nof_posts-o.length),c=1,l<1&&(c+=1-l,l=1));for(var p,d=0,u=0,f=n.pd||[],m=r?[]:null;c<s.length;){if(l<o.length){for(;d<f.length&&o[l].no>f[d].no;)d++;if(d<f.length&&o[l].no==f[d].no){t.native_prep?d++:p=f.splice(d,1);continue}if(o[l].no===s[c].no){l++,c++,i=!0;continue}if(o[l].no<s[c].no){i&&r&&(m[m.length]=o[l]),l++;continue}}for(;u<f.length&&s[c].no>f[u].no;)u++;if(u<f.length&&s[c].no===f[u].no)c++;else if(i){if(p=s[c++],!p.deleted_after){!pref.debug_mode[33]||void 0!==p.no&&null!==p.no||alert("Stopped by illegal deleted posts,(BUG)"),p.deleted_after=a.time_loaded,p.deleted_before=e&&e.date||null;var h={posts:[a.posts[0]].concat(p),__proto__:t};site2[t.domain].wrap_to_parse.posts(h)}f.splice(u++,0,p)}else 0===pref[cataLog.embed_mode].deleted_posts.detect.indexOf("full")&&(n.rescan_dp=1,scan.list_nup.add_scan(n)),c++}if(n.pd=f.length>0?f:null,p){if("no"!==pref[cataLog.embed_mode].deleted_posts.store&&t.domain===site.nickname){var g="LS"===pref[cataLog.embed_mode].deleted_posts.store?localStorage:sessionStorage;if(g){var b=site2[t.domain].ls_key_deletedPosts+t.board+t.no;f.length>0?g[b]=JSON.stringify(f,_):delete g[b]}}pref.test_mode[65]||"full_IDB"!==pref[cataLog.embed_mode].deleted_posts.detect||this.store_deleted_posts_to_IDB(t,f)}if(m&&m.length>0&&(t.domain!==site.nickname&&(m=JSON.parse(JSON.stringify(m,_))),IDB.req(t.domain,t.board,t.no,"posts",m,"put")),pref.debug_mode[19]&&p&&n.pd)for(var l=0;l<n.pd.length-1;l++)n.pd[l].no>=n.pd[l+1].no&&console.log("BUG: inorder of posts_deleted: "+t.key+", "+l+", "+n.pd[l].no+", "+n.pd[l+1].no)}return p?f:null},store_deleted_posts_to_IDB:function(e,t){IDB.req(e.domain,e.board,e.no,"posts_deleted",JSON.stringify(t,_),t.length>0?"put":"delete")},store_json_func:_,store:function(t,n,a,r,i,l,c){var p=this.check_deleted_posts(t,n,a,a.ta);if(this.store_th_to_mem(t,n,a,l,c),a.archived){var d=n.parse_funcs.time_unit,u=this.check_archived_time(n.key,n.domain,n.board,n.no,d)||0;if(i/=d,u<i&&(u=i),!(1&a.archived)&&4&a.archived&&(n.posts[n.posts.length-1].time<=u||n.time_posted<=u*d)&&!c)return void(a.archived&=2);n.parse_funcs.posts_full&&n.parse_funcs.posts_full(n);var f=2&a.archived,m=1&a.archived,h=f&&pref.archive.live.post||m&&pref.archive.oneshot.post,g=f&&pref.archive.live.post_idb||m&&pref.archive.oneshot.post_idb,b=n.key.replace(/\//g,"-");p&&(h&&e(JSON.stringify(site2[n.domain].parse_funcs.thread_json.prep_to_archive(p)),"text/plain",a,b+"_deleted.json"),g&&"full_IDB"!==pref[cataLog.embed_mode].deleted_posts.detect&&this.store_deleted_posts_to_IDB(n,p));var v="html"===n.type_data?"text/html":"text/plain",w="thread"===n.type_source||n.posts.length===n.nof_posts?n.posts:a.ta&&a.ta.posts.length===n.nof_posts?a.ta.posts:null;if(h){var k=(n.posts[0].sub||"").replace(/\..*/,""),x=b+(pref.archive.sub_in_filename&&k?"_"+k:"")+("html"===n.type_data?".html":".json");if(!w)return void this.store_rescan(a);e("thread"===n.type_source?t.responseText:JSON.stringify(site2[n.domain].parse_funcs.thread_json.prep_to_archive(w),_),v,a,x)}if(r||5&a.archived||c){var T=f&&pref.archive.live.tn||m&&pref.archive.oneshot.tn,N=f&&pref.archive.live.tn_idb||m&&pref.archive.oneshot.tn_idb,C=f&&pref.archive.live.img||m&&pref.archive.oneshot.img,A=f&&pref.archive.live.img_idb||m&&pref.archive.oneshot.img_idb,L=f&&pref.archive.live.webm||m&&pref.archive.oneshot.webm,E=f&&pref.archive.live.webm_idb||m&&pref.archive.oneshot.webm_idb;if(T||N||C||A||L||E||g){if(5&a.archived){if(!w&&(m||(!n.posts[1]||n.posts[1].time>u)&&(!a.ta.posts[1]||a.ta.posts[1].time>u)))return void this.store_rescan(a);if(m)r=w;else{for(var j=n.posts[1]&&n.posts[1].time<=u?n.posts:a.ta.posts,B=j.length;B>0&&j[B-1].time>u;)B--;r=j.slice(B)}}if(c&&(r=c.concat(r||[])),0!=r.length){pref.debug_mode[28]&&console.log("archive: "+n.key+", "+r.length+"/"+n.nof_posts);var S=[];(T||N)&&s("tn",n,a,r,T,N,L,E,S),(C||A||L||E)&&s("img",n,a,r,C,A,L,E,S),0!=S.length&&(S[S.length-1].from=n.key,I[n.key]=u,o(S)),!pref.test_mode[65]&&g&&5&a.archived&&IDB.req(n.domain,n.board,n.no,"posts",r,"put")}}}!h||!p&&!w||S&&0!==S.length&&n.domain===site.nickname||!pref.archive.tar||y(),a.archived&=2,this.update_archived_time(n.key)}},store_rescan:function(e){scan.list_nup.add_scan(e),e.archived|=4},restore_entry:function(e,t,n,a){for(var r={},o=0;o<t.length;o++)void 0===r[t[o].name]?r[t[o].name]={file:t[o]}:Array.isArray(r[t[o].name])?r[t[o].name].push({file:t[o]}):r[t[o].name]=[r[t[o].name],{file:t[o]}];var s={};if(!pref.test_mode[64]&&pref[cataLog.embed_mode].deleted_posts.merge)for(var o=0;o<a.length;o++)s[a[o].name]=a[o];var i=0;pref.archive.clear_threads&&cataLog.threads&&cataLog.catalog_clear_threads(0);var l,p=new FileReader;p.onerror=function(e){console.log("ERROR at loading json file, "+e)},p.onload=function(t){if(l){var a=l.slice(0,-13).replace(/\-/g,"/");pref.test_mode[80]&&(a=a.replace(/\/\d+$/,"_File$&"));var o=liveTag.mems.getFromName(a);archiver.prep_deleted_posts(o.th,o,p.result)}else if(c(e[i-1],p.result,r),!pref.test_mode[64]&&pref[cataLog.embed_mode].deleted_posts.merge&&(l=e[i-1].name.replace(/(_|\.).*/,"")+"_deleted.json",s[l]))return void p.readAsText(s[l]);l=null,e.length>i?p.readAsText(e[i++]):pref.archive.clear_files&&n()},p.readAsText(e[i++])},url2file:function(e,t){var n=e[t.replace(/[^\/]*\//g,"")];return n?(Array.isArray(n)&&(n=t.search(/thumb/)!=-1?n[0]:n[n.length-1]),n.url||(n.url=window.URL.createObjectURL(n.file)),n.url+("video/webm"===n.file.type?'" data-ext=".webm':"")):t},prep_deleted_posts:function(e,t,n,a){var r=n?a||JSON.parse(n):"LS"===pref[cataLog.embed_mode].deleted_posts.store&&localStorage?T(JSON.parse(localStorage[site2[e.domain].ls_key_deletedPosts+e.board+e.no]||null)):"SS"===pref[cataLog.embed_mode].deleted_posts.store&&sessionStorage?JSON.parse(sessionStorage[site2[e.domain].ls_key_deletedPosts+e.board+e.no]||null):null;if(!pref.test_mode[123]&&r){for(var o={},s=0;s<e.posts.length;s++)o[e.posts[s].no]=null;for(var s=r.length-1;s>=0;s--)r[s].no&&null!==o[r[s].no]||r.splice(s,1);0===r.length&&(r=null)}if(r){r=site2[e.domain].parse_funcs.thread_json.rip_from_archive(r);var i={posts:[e.posts[0]].concat(r),parse_funcs:site2[e.domain].parse_funcs.thread_json,type_parse:"thread_json",type_source:"thread",type_data:"json",__proto__:e};site2[e.domain].wrap_to_parse.posts(i,1),n&&t.th?(t.pd=t.pd?site2[e.domain].update_posts_merge_prep(i.posts,t.pd,-1,!0).slice(1):r,"page"!==cataLog.embed_mode&&"thread"!==cataLog.embed_mode||pref.test_mode[64]||!pref[cataLog.embed_mode].deleted_posts.merge||(e.posts=site2[e.domain].update_posts_merge_prep(e.posts,t.pd,-1,!0),cataLog.threads[e.key][16].th=e,cataLog.show_catalog(e.key)),cataLog.Footer.update_force(e.key)):t.pd=r}},refresh_start:function(){m(),b=null},list_all_obj_downloading:I,download_url3:t,download_url4:n,tar:h,sub_funcs:function(e,t){if("SUB_INIT"===e[0])if(cataLog.catalog_clear_threads(0),cataLog.auto_update.stop_if_running(),pref.stats.auto_acquisition=!1,pref[cataLog.embed_mode].t2h_sel="All",e[1].IDB)IDB.req(e[1].domain,e[1].board,e[1].no,null,t?function(e,n,a,r){archiver.event_funcs.restore3(e,n,a,r),t()}:archiver.event_funcs.restore3.bind(archiver.event_funcs),"get_all");else for(var a=e[1],r=parseInt(a.files_sel,10),o=window.opener.document.getElementsByClassName(pref.script_prefix)[0].querySelectorAll('span[name="FILES_ARCHIVE'+r+'"]')[0].querySelectorAll('input[type="file"]'),s=0;s<o.length;s++)for(var i=0;i<o[s].files.length;i++){var l=o[s].files[i];if(l.name===a.name&&l.size===a.size&&l.lastModified===a.lastModified)return void archiver.event_funcs.restore2(null,Array.prototype.slice.call(o[s+r].files),[l])}else"DOWNLOAD"===e[0]&&n(e[1][0],e[1][1])},restore:c,event_funcs:pref_func.settings.onchange_funcs.archive}}(),recovery=pref.features.recovery&&localStorage?function(){function e(){s=site2[site.nickname].ls_key_comment+site.board+site.no;var e=pref.script_prefix+".comment."+site.nickname+site.board+site.no;if(pref.recovery.comment){var t=localStorage[s]||localStorage[e]||"";t&&(site.components.postform_comment&&(site.components.postform_comment.value=t),site.components.postform_comment2&&(site.components.postform_comment2.value=t))}}function t(){i=this,c()}function n(){var e=i.value;(!l||l.length<=e.length)&&(l=e),i=null,p()}function a(){l?localStorage[s]=l:delete localStorage[s],l=null}function r(){i&&(l=i.value),null!==l&&a()}function o(e,n,a){if(!e&&pref.recovery.comment&&n){var r=t.bind(n);n.addEventListener("change",r,!1),n.addEventListener("keyup",r,!1),a.addEventListener("click",r,!1),e=[n,a,r]}else!e||pref.recovery.comment&&n||(e[0].removeEventListener("change",e[2],!1),e[0].removeEventListener("keyup",e[2],!1),e[1].removeEventListener("click",e[2],!1),e=null);return e}var s;e();var i=null,l=null,c=new DelayBuffer(n,1e3).get_binded_delayed_do(),p=new DelayBuffer(a,1e3*pref.recovery.interval).get_binded_delayed_do(),_=o(null,site.components.postform_comment,site.components.postform_submit),d=null;return window.addEventListener("beforeunload",r,!1),{setup:function(){_=o(_,site.components.postform_comment,site.components.postform_submit),d=o(d,site.components.postform_comment2,site.components.postform_submit2)},setup2:function(){d=o(d,site.components.postform_comment2,site.components.postform_submit2)},reentry:function(){r(),e()}}}():null,scan=function(){function e(e,t,n){return("b"===e?"scan":"scan_threads")+"_"+t+":"+(n||0)}function t(t,n){for(var r=e(t,n,0).replace(/0$/,""),o=8;o>=0;o--){var s=a.prototype.scanners[r+o];if(s||s===!1)return o}return-1}var n={add:function(e,t,n){"string"==typeof e&&(e=this.get_th(e)),t=(t||0)<<4,0===e.u?e.u=t|(n?7:3):e.u>0&&e.u<t&&(e.u=t|15&e.u)},add_scan:function(e){this.add(e),scan.scan_threads_delayed_do()},issued:function(e){return"string"==typeof e&&(e=this.get_th(e)),e&&(e.u=(1==(3&e.u)?4294967040:0)|(0===e.u?2:e.u-1)),e&&e.no&&e.archived},got_200:function(e){var t=this.get_th(e.key);0===t.u||4&t.u&&"thread"!==e.type_source||(t.u=0)},got_404:function(e){"string"==typeof e&&(e=this.get_th(e)),e&&(e.u=-1)},get_th:function(e){var t=common_func.fullname2dbt(e);return t[2].search(/(p|q)[0-9]+$/)!=-1?null:("t"===t[2][0]?t[2]=t[2].substr(1):t[2].search(/^[0-9]/)==-1&&(t[2]=""),liveTag.mems.init({domain:t[0],board:t[1],no:t[2]}))},priority_th:[0,16,32,48,64,80,96,112,128,144,160,176,192,208,224,240,256],get_list_thread:function(e,t){var n=this.priority_th[t||0],a=0;for(var r in liveTag.mems[e])for(var o in liveTag.mems[e][r])liveTag.mems[e][r][o].u>n&&a++;return 0===a?null:[a,function*(t){for(var n in liveTag.mems[e])for(var a in liveTag.mems[e][n])liveTag.mems[e][n][a].u>t&&(yield liveTag.mems[e][n][a])}(n)]},get_list_thread2:function(e,t){var n=this.priority_th[t||0],a=[];for(var r in liveTag.mems[e])for(var o in liveTag.mems[e][r])liveTag.mems[e][r][o].u>n&&(a[a.length]=liveTag.mems[e][r][o]);return a},get_list_board:function(e,t){var n=this.priority_th[t||0],a=0;for(var r in liveTag.mems[e])liveTag.mems[e][r].u>n&&a++;return 0===a?null:[a,function*(t){for(var n in liveTag.mems[e])liveTag.mems[e][n].u>t&&(yield liveTag.mems[e][n])}(n)]},get_list_board2:function(e,t){
var n=this.priority_th[t||0],a=[];for(var r in liveTag.mems[e])liveTag.mems[e][r].u>n&&(a[a.length]=liveTag.mems[e][r]);return a},add_domain:function(e,t,n){var a=pref4.scan.max;if(liveTag.active.pk){if(n)for(var r in liveTag.mems[e]){liveTag.tags[liveTag.mems[e][r].btag].pk&&this.add_board(e+r,null,t);var o=liveTag.mems[e][r].btag2;if(o)for(var s=0;s<o.length;s++)liveTag.tags[o[s]].pk&&this.add_board(e+r,null,t)}else for(var s=0;s<a;s++)if(liveTag.tags_array_old[s])for(var i of liveTag.tags[liveTag.tags_array_old[s].key].mems.keys())i.no?this.add(i,null,t):this.add_board(i,null,t)}else if(n)for(var s=0;s<n.length;s++)this.add_board(e+n[s],null,t);else for(var r in liveTag.mems[e])null!==liveTag.mems[e][r].o&&liveTag.mems[e][r].o<a&&this.add_board(e+r,null,t)},add_board:function(e,t,n,a,r){if("string"==typeof e&&(e=this.get_th(e)),2!==n){if(!a||e.read_max<e.max){var o=(t||0)<<4|(r?8:0)|(n?4:0);0===e.u?e.u=3|o:e.u>0&&e.u<t&&(e.u=o|15&e.u)}}else for(var s in e)e[s].ta&&e[s].nof_posts===e[s].ta.posts.length||this.add(e[s],t,!0)},got_200_board:function(e){if("string"==typeof e&&(e=this.get_th(e)),4&e.u)for(var t in e)this.add(e[t],240&e.u,!0);e.max&&(e.read_max=e.max),e.u=0},scan_boards_enumerate:function(e,t,n){var a="thread"===pref.virtualBoard.scan_domains[e]||n.has(liveTag.mems[e]),r=pref4.scan.max;for(var o in liveTag.mems[e])if((a||0!=Object.keys(liveTag.mems[e][o]).length)&&!n.has(liveTag.mems[e][o])&&null!==liveTag.mems[e][o].o&&liveTag.mems[e][o].o<r&&(!t||t(liveTag.mems[e][o])))return!0}},a=function(e,t,n,a){this.type=e,this.domain=t,this.key=a,this.priority=n||0,this.scanners[a]=this};a.prototype={scanners:Object.create(null),func_entry:function(){var e;pref.test_mode[51]?(e="b"===this.type?scan.list_nup.get_list_board(this.domain,this.priority):scan.list_nup.get_list_thread(this.domain,this.priority),e?this.func_scan(e,{tgts_iterator:e[1],max:e[0]}):this.exit()):(e="b"===this.type?scan.list_nup.get_list_board2(this.domain,this.priority):scan.list_nup.get_list_thread2(this.domain,this.priority),0!=e.length?this.func_scan(e,null):this.exit())},func_scan:function(e,t,n){this.wdg||(this.wdg=new Watchdog(this.abort.bind(this),3e4)),cataLog.scan_init(this.key,e,{callback:this.func_cont.bind(this),watchdog:this.wdg.restart.bind(this.wdg),priority:this.priority,__proto__:t},n)},func_cont:function(){this.req?(this.req=!1,this.func_entry()):this.exit()},exit:function(){this.wdg&&this.wdg.stop(),this.scanners[this.key]=null,"b"===this.type?this.aborted||scan.scan("t",this.domain,this.priority):"t"===this.type&&cataLog.catalog_refresh_end&&cataLog.catalog_refresh_end(),this.callback&&this.callback();var n=t(this.type,this.domain),r=e(this.type,this.domain,n);this.scanners[r]===!1&&new a(this.type,this.domain,n,r).func_entry()},abort:function(){pref.debug_mode[7]&&console.log("Scanner_abort: "+this.key),cataLog.scan_boards.scan_abort(this.key),void 0===this.aborted?(this.aborted=!0,this.wdg.restart()):this.exit()}};var r=function(e,t){this.key=e,this.arg=t,this.scanners[e]=this,this.callback=this.arg.options&&this.arg.options.callback};r.prototype={scanners:Object.create(null),priority:8,func_entry:function(){this.func_scan(this.arg.tgts,this.arg.options,!0)},func_cont:function(){this.queue&&this.queue.length>0?(this.arg=this.queue.shift(),this.func_entry()):this.exit()},__proto__:a.prototype};var o=new Set;return{scan_refresh:function(e,t,a,r){o.clear();for(var s=0;s<t.length;s++){var i=common_func.name2domainboardthread(t[s],!0);0===i[2].search(/^[cj]/)?o.add(liveTag.mems[i[0]][i[1]]):0===i[2].search(/^t*[0-9]+/)&&o.add(liveTag.mems[i[0]][i[1]]["t"===i[2][0]?i[2].substr(1):i[2]])}for(var s in r)o.add(liveTag.mems[s]);if(scan.scan("t",null,a),!pref.liveTag.use)for(var l in liveTag.tags)if(liveTag.tags[l].pk)for(var c of liveTag.tags[l].mems.keys())o.has(c)||(c.no?scan.list_nup.add(c,2):scan.list_nup.add_board(c,2));for(var p in liveTag.mems)pref.liveTag.use?site2[p].utilize_boards_json&&pref.pref2[p].utilize_boards_json?n.scan_boards_enumerate(p,null,o)?site2[p].get_boards_json("boards_"+p,function(e){return function(){scan.scan_refresh_1(e,!0)}}(p),!0,e):scan.scan("t",p):scan.scan_refresh_1(p,!1):scan.scan("b",p)},scan_refresh_1:function(e,t){n.scan_boards_enumerate(e,function(e){scan.list_nup.add_board(e,null,null,t)},o),scan.scan("b",e)},scan:function(n,r,o){if(r){var s=e(n,r,o),i=a.prototype.scanners[s];i?i.req=!0:t(n,r)>=o?a.prototype.scanners[s]=!1:"b"===n&&(i=a.prototype.scanners[e("t",r,o)])?i.callback=function(){scan.scan(n,r,o)}:new a(n,r,o,s).func_entry()}else for(var l in liveTag.mems)this.scan(n,l,o)},abort:function(){for(var e in a.prototype.scanners){var t=a.prototype.scanners[e];t&&(t.wdg&&t.wdg.stop(),t.abort())}},scan_ui:function(e,t){new r(e,t).func_entry()},scan_threads_delayed_do:DelayBuffer.prototype.delayed_do.bind(new DelayBuffer(function(){scan.scan("t")},200)),keyword_load:function(e,t){var n=!0;for(var a in pref.virtualBoard.scan_domains)"none"!==pref.virtualBoard.scan_domains[a]&&(this.keyword_load_1(a,e,null,t),n=!1);n&&this.keyword_load_1(site.nickname,e,null,t)},keyword_load_1:function(e,t,n,a){if(!site3[e].boards&&(!t&&"none"!==pref.virtualBoard.scan_domains[e]||t&&liveTag.active.pk||!n))return void site2[e].get_boards_json("kwd_load",function(){scan.keyword_load_1(e,t,n,a)},!1,a);("thread"===pref.virtualBoard.scan_domains[e]||t)&&(scan.list_nup.add_domain(e,pref.catalog.filter.kwd.post&&t,n),scan.scan("b",e))},list_nup:n}}(),stats=pref3.stats.use?function(){function e(e){var t=liveTag.mems[e[0]][e[1]][e[2]];if(t.ss)if(Array.isArray(t.ss))for(var a=0;a<t.ss.length;a++)t.ss[a].rm&&t.ss[a].rm.update_thread(t.s,0,!0);else t.ss.rm&&t.ss.rm.update_thread(t.s,0,!0);pref.stats.retain_404&&t.s&&(u[e[0]]||(u[e[0]]={}),u[e[0]][e[1]]||(u[e[0]][e[1]]={}),u[e[0]][e[1]][e[2]]=liveTag.mems[e[0]][e[1]][e[2]],(pref.test_mode[44]||u[e[0]][e[1]].sr||Object.keys(u[e[0]][e[1]]).length>64)&&n(u[e[0]][e[1]]))}function t(e){for(var t=0;t<g.length;t++){pref_func.merge_obj5(e.key,g[t].tgts_obj2,{hit:!1}).hit&&g[t].check_and_add_thread(e)}}function n(e){e.sr||(a(e,"sr"),a(e,"srt"));for(var t in e){if(e[t].s)for(var n=0;n<m.length;n++)c(e.sr[n],null,0,e[t].s.length,e[t].s,m[n],o,0),c(e.srt[n],null,0,1,e[t].s,m[n],o,0);delete e[t]}}function a(e,t){Object.defineProperty(e,t,{value:[],configurable:!0,writable:!1});for(var n=0;n<m.length;n++)e[t][n]=[null,n<3?[]:{length:pref.stats.len_capture+2,__proto__:Array.prototype},[],0],r(e[t][n],m[n]);"s"===t&&(e[t][m.length]=-Object.keys(e).length)}function r(e,t,n){var a=Math.floor((Date.now()/6e4+e[3])/t)*t,r=a-t*pref.stats.len_capture;if(!e[0])return void(e[0]=r);if(r!==e[0]||n){var o=(r-e[0])/t,s=0;return n>o&&pref.stats.tolerant&&(e[3]+(n-o)*t<pref.stats.tolerance?(e[3]=n*t,s=n-o):(e[3]=pref.stats.tolerance,s=Math.floor((pref.stats.tolerance-e[3])/t))),e[1].splice(0,o+s),Array.isArray(e[1])||(e[1].length=pref.stats.len_capture+2),e[0]=r+s*t,o+s}}function o(e,t){e[t]=(e[t]||0)+1}function s(e,t,n,a){var r=n.posts[a].no||n.no;(void 0===e[t]||e[t]<r)&&(e[t]=r)}function i(e,t,n,a){var r=n.posts[a].no||n.no;(void 0===e[t]||e[t]>r)&&(e[t]=r)}function l(e,t,n,r){e.s||a(e,"s");for(var o=0;o<m.length;o++)c(e.s[o],t,n,r.length,r,m[o],pref.stats.patch_tm?i:s,t.posts.length);e.s[m.length]++}function c(e,t,n,a,o,s,i,l){for(var c,p=e[0],_=e[1],d=a-1;d>=n;d--){var u=Math.floor((o[d]-p)/s);if(!(--l>=0&&u===c)||pref.stats.patch_tm){var f=u-pref.stats.len_capture-1;if(f>0?(u-=r(e,s,f),u>pref.stats.len_capture+1&&(u=pref.stats.len_capture+1),p=e[0]):u<0&&(u=0),i(_,u,t,l),0===u&&!pref.stats.patch_tm)break;c=u}}for(var m=0;m<e[2].length;m++)e[2][m].update_posts_no(p,u)}function p(e){return pref.catalog_board_list_obj[e][0].key}function _(){if(pref.stats.auto_acquisition&&"thread"!==cataLog.embed_mode)for(var e=pref.catalog_board_list_obj.length-1;e>=0;e--)if(void 0!==x["@"+p(e)]){var t=cataLog.catalog_refresh_1("chart",!1,!1,!1,!1,e,!1,!0);"function"!=typeof t&&new b(null,t,p(e),!1).destroy()}}function d(e){if(pref.stats.auto_acquisition&&cataLog.catalog_refresh_1&&"thread"!==cataLog.embed_mode){for(void 0===e&&(e=pref.catalog_board_list_obj.length-1);e>=0&&(!pref.catalog_board_list_obj[e][0].cmds||pref.catalog_board_list_obj[e][0].cmds.indexOf("stats")===-1);)e--;if(e>=0){pref.stats.auto_acquisition&&stats.register_auto_acquisition(e);var t=cataLog.catalog_refresh_1("chart",!1,!1,!1,"stats_ac",e,!1,!0,function(){d(e-1)});"function"==typeof t&&t(function(){d(e)})}}}var u={},f={hour:function(e){return new Date(6e4*e).toString().split(" ")[4].replace(/:\d*$/,"")},day:function(e){return new Date(6e4*e).toString().replace(/\s\d{4}.*/,"")},sunday:function(e){var t=new Date(6e4*e).toString();return"Sun"==t.split(" ")[0]?t.replace(/\s\d{4}.*/,""):""},month:function(e){var t=new Date(6e4*e).toString();return"01"==t.split(" ")[2]?t.replace(/\s\d{4}.*/,""):""},quarter_year:function(e){var t=new Date(6e4*e).toString().split(" ");return t[2]<=7&&["Jan","Apr","Jul","Oct"].indexOf(t[1])!=-1?t.slice(1,4).join(" "):""}};f[1]=[60,f.hour,1],f[10]=[60,f.hour,1],f[60]=[1440,f.day,1],f[1440]=[1440,f.sunday,0],f[10080]=[1440,f.quarter_year,0];var m=[1,10,60,1440,10080],h=Math.floor(Date.now()/6e4),g=[],b=function(e,t,n){g.push(this),this.chart=e,this.tolerance=0,this.draw=DelayBuffer.prototype.delayed_do.bind(new DelayBuffer(this.refresh.bind(this),1e3*pref.stats.draw_delay)),this.wdg_tick=new Watchdog(this.prep_time.bind(this),6e4),this.fromNo=pref3.stats.estimate_posts?new w(this):null,this.tgts_changed(t,n,!0),this.time_unit_changed(pref.chart.inst.time_sel,!0),this.len_changed(this.chart&&this.chart.len>pref.stats.len_capture?this.chart.len:pref.stats.len_capture)};b.prototype={destroy:function(){this.chart=null,this.save_all_unsubscribe(!0),this.wdg_tick.stop(),g.splice(g.indexOf(this),1)},merge_1:function(e,t){if(t)for(var n=0;n<t.length;n++)e[n]<t[n]&&(e[n]=t[n]);return e},merge_1_hier:function(e,t,n){for(var a=this.time_unit/n.time_unit,r=Math.ceil((n.time_base-this.time_base)/this.time_unit),o=(a-n.time_base%this.time_unit/n.time_unit)%a;o<t.length;)this.merge_1_hier_1(e,t,r,o,a,n),o+=a,r++},merge_1_hier_1:function(e,t,n,a,r,o){for(var s=0,i=t.length>=a+r?r:t.length-a,l=0;l<i;l++)s+=t[a+l];pref.debug_mode[15]&&s>e[n]&&console.log("merge_1_hier_1: "+this.time_unit+": "+n+", "+e[n]+"->"+s+", "+new Date(6e4*(this.time_base+n*this.time_unit)).toLocaleString()+", "+new Date(6e4*(o.time_base+a*o.time_unit)).toLocaleString()+", "+r),s>e[n]&&(e[n]=s)},save_all_unsubscribe:function(e){if(this.tgts&&pref.stats.save&&void 0!==x["@"+this.key]){var t=Math.floor(Date.now()/6e4);if(x["@"+this.key]!==t){var n=this.chart;this.chart=null;for(var a=m.indexOf(this.time_unit),r=null,o=0;o<m.length;o++)this.time_unit_changed(o),this.save(r),r={data_p:this.data_p,data_t:this.data_t,time_unit:this.time_unit,time_base:this.time_base};e||this.time_unit_changed(a),this.chart=n,x["@"+this.key]=t}}this.tgts&&(this.prep("both",this.prep_thread_unsubscribe),this.fromNo&&this.fromNo.prep("live",this.fromNo.prep_board_unsubscribe))},Zcompress:function(e){return e.replace(/0,(0,)+/g,function(e){return"z"+e.length/2+","})},Zdecompress:function(e){return e.replace(/z(\d+),/g,function(e,t){for(var n="",a=parseInt(t,10),r=0;r<a;r++)n+="0,";return n})},get_ls_key:function(){return pref.test_mode[38]?pref.script_prefix+".graph."+this.time_unit+"."+this.key+"_test38":pref.script_prefix+".graph."+this.time_unit+"."+this.key},save:function(e){if(this.data_p&&pref.stats.load&&pref.stats.save&&localStorage){this.merge_1(this.data_p,this.data_p_old),this.merge_1(this.data_t,this.data_t_old),e&&(this.merge_1_hier(this.data_p,e.data_p,e),this.merge_1_hier(this.data_t,e.data_t,e));for(var t=0;t<this.data_p.length&&0===this.data_p[t]&&0===this.data_t[t];)t++;var n=[this.time_base+t*this.time_unit,this.data_p.slice(0,this.len+1).slice(t),this.data_t.slice(0,this.len+1).slice(t)];if(!pref.test_mode[42]&&this.fromNo){var a=this.fromNo;if(a.valid=!0,a.prep("live",a.prep_board_check_valid),a.valid){if(a.data_p_old){var r=a.data_p_old.length-1;a.data_p[r]>a.data_p_old[r]&&(a.data_p_old[r]=a.data_p[r])}}else for(var o=0;o<a.data_p.length;o++)a.data_p[o]=0;a.data_p_old&&(a.data_p=a.data_p_old.concat(a.data_p.slice(a.data_p_old.length)));for(var o=a.data_p.length-2-this.tolerance;o<a.data_p.length;o++)a.data_p[o]=0;n[3]=a.data_p.slice(0,this.len+1).slice(t)}localStorage[this.get_ls_key()]=this.Zcompress(JSON.stringify(n)),pref.debug_mode[15]&&console.log("saved: "+this.get_ls_key())}},load:function(){if(pref.stats.load&&localStorage){var e=localStorage[this.get_ls_key()];if(e){e=JSON.parse(this.Zdecompress(e));var t=(this.time_base-e[0])/this.time_unit,n=Math.floor((h-this.time_last)/this.time_unit);if(0===n&&(n=void 0),t>=0?(this.data_p_old=e[1].slice(t,n),this.data_t_old=e[2].slice(t,n),this.fromNo&&e[3]&&(this.fromNo.data_p_old=e[3].slice(t,n))):(this.data_p_old=this.array_init([],0,0).slice(0,-t).concat(e[1].slice(0,n)),this.data_t_old=this.array_init([],0,0).slice(0,-t).concat(e[2].slice(0,n)),this.fromNo&&e[3]&&(this.fromNo.data_p_old=this.array_init([],0,0).slice(0,-t).concat(e[3].slice(0,n)))),this.fromNo&&this.fromNo.data_p_old)for(;0===this.fromNo.data_p_old[this.fromNo.data_p_old.length-1];)this.fromNo.data_p_old.pop()}else this.data_p_old=null,this.data_t_old=null}},tgts_changed:function(e,t,n){this.save_all_unsubscribe(),this.tgts=e,this.key=t,pref_func.str2obj2(this,"tgts_obj2",e.join(","),null,!0),this.prep("both",this.prep_thread_subscribe),n||this.init()},time_unit_changed:function(e,t){this.fromNo&&this.fromNo.prep("live",this.fromNo.prep_board_unsubscribe),this.time_sel=e,this.time_unit=m[e],t||this.init()},len_changed:function(e){this.len=e,this.init()},init:function(){this.time_last=null,this.data_p=[],this.data_t=[],this.data_l=[],this.rm=this.chart&&(this.chart.show.ep||this.chart.show.et)?new v(this):null,this.fromNo&&(this.fromNo.data_p=[],this.fromNo.data_p_old=[],this.fromNo.min_idx=0),this.refresh(!0)},array_init:function(e,t,n){for(var a=t;a<this.len+2;a++)void 0===e[a]&&(e[a]=n);return e},tz_offset:(new Date).getTimezoneOffset(),label_init:function(e){for(var t=f[this.time_unit],n=t[2]?Math.floor((Math.floor((this.time_base-this.tz_offset+(this.len+2)*this.time_unit)/t[0])*t[0]-(this.time_base-this.tz_offset))/this.time_unit):this.len+2;n>=e;)this.data_l[n]=t[1](this.time_base+n*this.time_unit),n-=t[2]?t[0]/this.time_unit:1},prep_time:function(e){var t=Math.floor((Date.now()/6e4+this.tolerance)/this.time_unit)*this.time_unit;if(this.time_last!==t){var n=(t-this.time_last)/this.time_unit;this.time_last=t,this.time_base=t-this.time_unit*this.len;var a=0;e||0===n||(n>this.len&&(n=this.len),this.data_p.splice(0,n),this.data_t.splice(0,n),this.data_l.splice(0,n),this.rm&&(this.rm.data_p.splice(0,n),this.rm.data_t.splice(0,n)),this.fromNo&&(this.fromNo.data_p.splice(0,n),this.fromNo.data_p_old&&(this.fromNo.data_p_old.splice(0,n),0===this.fromNo.data_p_old.length&&(this.fromNo.data_p_old=null)),this.fromNo.min_idx-=n),this.data_p_old&&(this.data_p_old.splice(0,n),0===this.data_p_old.length&&(this.data_p_old=null)),this.data_t_old&&(this.data_t_old.splice(0,n),0===this.data_t_old.length&&(this.data_t_old=null)),a=this.len-n,this.min_idx-=n,this.min_idx<0&&(this.min_idx=0)),this.array_init(this.data_p,a,0),this.array_init(this.data_t,a,0),this.array_init(this.data_l,a,""),this.rm&&(this.array_init(this.rm.data_p,a,0),this.array_init(this.rm.data_t,a,0)),this.fromNo&&this.array_init(this.fromNo.data_p,a,0),this.label_init(a),this.shift=e?0:this.shift+n}this.wdg_tick.restart(6e4*this.time_unit)},prep:function(e,t,n){for(var a=0;a<this.tgts.length;a++){var r=common_func.name2domainboardthread(this.tgts[a],!0);"live"!==e&&"both"!==e||this.prep_1(liveTag.mems,r,t,n),"dead"!==e&&"both"!==e||this.prep_1(u,r,t,n)}},prep_1:function(e,t,n,a){t[2]?e[t[0]]&&e[t[0]][t[1]]&&e[t[0]][t[1]][t[2]]&&null!==a&&(a?a:n).call(this,e[t[0]][t[1]][t[2]]):t[1]?e[t[0]]&&e[t[0]][t[1]]&&this.prep_board(e[t[0]][t[1]],n,a):e[t[0]]&&this.prep_domain(e[t[0]],n,a)},prep_domain:function(e,t){for(var n in e)this.prep_board(e[n],t,func_t)},prep_board:function(e,t){for(var n in e)t.call(this,e[n])},prep_thread_init:function(e){e.s&&this.update_thread(e.s,0)},check_and_add_thread:function(e){e.s&&!this.prep_thread_unsubscribe(e,!0)&&(this.update_thread(e.s,0,!0),this.prep_thread_subscribe(e))},prep_thread_subscribe:function(e){Array.isArray(e.ss)?e.ss.push(this):e.ss?e.ss=[e.ss,this]:e.ss=this},prep_thread_unsubscribe:function(e,t){if(Array.isArray(e.ss)){var n=e.ss.indexOf(this);if(t)return n!==-1;n!=-1&&(e.ss.splice(n,1),1===e.ss.length&&(e.ss=e.ss[0]))}else{if(e.ss!==this)return!1;if(t)return!0;delete e.ss}},refresh:function(e){pref.debug_mode[15]&&console.log("updated: "+this.data_p.slice(this.len-10).toString()+", "+this.min_idx),this.prep_time(e),e?(this.prep("live",this.prep_thread_init),this.rm_tmp=new v(this,this.data_p,this.data_t),this.rm_tmp.prep("dead",this.rm_tmp.prep_board_init,this.prep_thread_init),this.rm&&this.rm.prep("dead",this.rm.prep_board_init,this.prep_thread_init),this.fromNo&&this.fromNo.prep("live",this.fromNo.prep_board_init,!0),this.load(),this.chart&&this.chart.replace_data(this)):0===this.shift&&this.min_idx===this.data_p.length||(this.fromNo&&this.fromNo.prep("live",this.fromNo.prep_board_init,!1,!0),this.chart&&this.chart.update_data2(this)),this.min_idx=this.data_p.length},update_thread:function(e,t,n){e&&(0===t&&this.update_thread_1(this.data_t,e,0,0),this.update_thread_1(this.data_p,e,t,e.length-1),n&&this.draw())},update_thread_1:function(e,t,n,a){for(var r=a;r>=n;r--){var o=Math.floor((t[r]-this.time_base)/this.time_unit),s=o-this.len-1;if(s>0&&(pref.stats.tolerant&&(this.tolerance=s*this.time_unit+this.tolerance,this.tolerance>pref.stats.tolerance&&(this.tolerance=pref.stats.tolerance),this.prep_time(!1)),o=this.len+1),!(o>=0))break;e[o]++,o<this.min_idx&&(this.min_idx=o)}}};var v=function(e,t,n){this.data_p=t||[],this.data_t=n||[],Object.defineProperty(this,"min_idx",{set:function(e){this.__proto__.min_idx=e},get:function(){return this.__proto__.min_idx},configurable:!0,enumerable:!0});for(var a in y)this[a]=y[a];this.__proto__=e},y={prep_board:function(e,t,n){if(e.sr)t.call(this,e);else for(var a in e)n.call(this,e[a])},prep_board_init:function(e){this.prep_board_init_1(e.sr,this.data_p),this.prep_board_init_1(e.srt,this.data_t)},prep_board_init_1:function(e,t){for(var n=e[this.time_sel][1],a=(this.time_base-e[this.time_sel][0])/this.time_unit,r=a;r<n.length;)n[r]&&(t[r-a]+=n[r]),r++}},w=function(e){this.data_p=[],this.min_idx=0;for(var t in k)this[t]=k[t];this.__proto__=e},k={prep_board_subscribe:function(e){e.s||a(e,"s"),e.s[this.time_sel][2].push(this)},prep_board_unsubscribe:function(e){if(e.s&&this.time_sel){var t=e.s[this.time_sel][2].indexOf(this);t!=-1&&e.s[this.time_sel][2].splice(t,1)}},prep:function(e,t,n,a){if(n&&this.__proto__.prep.call(this.fromNo,"live",this.fromNo.prep_board_subscribe,null),a)for(var r=this.min_idx;r<this.data_p.length;r++)this.data_p[r]=0;this.new_vals={},this.__proto__.prep.call(this,"live",t,null);for(var r in this.new_vals)this[r]=this.new_vals[r];delete this.new_vals},prep_board:function(e,t){t.call(this,e)},prep_board_init:function(e,t){var n=e.s[this.time_sel][1],a=(this.time_base-e.s[this.time_sel][0])/this.time_unit,r=this.min_idx+a;r<2&&(r=2);for(var o,s=r-1;s>0&&!n[s];)s--;if(s>0)o=n[s];else{for(;r<n.length&&!n[r];)r++;o=n[r++]}if(pref.stats.patch_tm){for(var i=(s>0?s:r-1)-a,l=i;r<n.length;)n[r]&&(this.data_p[i]+=n[r]-o,o=n[r],l=i,i=r-a),r++;(void 0===this.new_vals.min_idx||this.new_vals.min_idx>l)&&(this.new_vals.min_idx=l)}else{for(;r<n.length;)n[r]&&(this.data_p[r-a]+=n[r]-o,o=n[r]),r++;(void 0===this.new_vals.min_idx||this.new_vals.min_idx>r-a)&&(this.new_vals.min_idx=r-a)}},update_posts_no:function(e,t){var n=(e-this.time_base)/this.time_unit+t;n>=0&&n<this.min_idx&&(this.min_idx=n)},prep_board_check_valid:function(e,t){this.valid&=e.s[m.length]>=0}},x={};return window.addEventListener("beforeunload",_,!1),pref.stats.auto_acquisition_scan&&"archive"!==site.whereami&&setTimeout(d,1e3*pref.stats.auto_acquisition_scan_delay),{aggregate:function(e){if(e.posts){var n=liveTag.mems[e.domain][e.board],a=n[e.no];a.s||(a.s=[]);var r=e.parse_funcs.time_unit,o=a.s.length,s=o;a.pd&&pref.test_mode[128]&&(e={posts:site2[a.domain].update_posts_merge_prep(e.posts,a.pd,-1,!0),__proto__:e});var i=e.posts.length-(e.nof_posts-a.s.length);if(!(i<0)){for(;i<e.posts.length;)a.s[s++]=Math.floor(e.posts[i++].time*r/6e4);if(a.ss)if(Array.isArray(a.ss))for(var i=0;i<a.ss.length;i++)a.ss[i].update_thread(a.s,o,!0);else a.ss.update_thread(a.s,o,!0);else 0===o&&t(a);pref3.stats.estimate_posts&&l(n,e,o,a.s,e.posts.length)}}},thread_removed:e,Stats:b,register_auto_acquisition:function(e){x["@"+p(e)]=null,cnst.auto_shrink_board_selector.color()},query_auto_acquisition:function(e){return void 0!==x["@"+p(e)]}}}():null,listener=null;site.features.listener&&pref.features.listener&&(listener=make_listener());var pn_debug=0;brwsr.sw_cache=brwsr.sw_cache&&window.SharedWorker&&(pref.info_server||pref.info_client)?function(){function e(e){if(!e){var a=new Blob(['          var ports = [];          var store = {};          var connections = 0;          self.addEventListener("connect", function(e){            var port = e.ports[0];            var no = connections++;            var func = function(e){msg_parser(e,port,no)};            port.addEventListener("message", func, false);            port.start();            port.postMessage(JSON.stringify(["INFO","Connected: #" + no]));            ports.push({port:port, func:func, echo:true, subscribe:false});          }, false);          function msg_parser(e,port,no){            if (ports[no].echo) port.postMessage(e.data);            var fields = JSON.parse(e.data);            if (fields[0]=="ECHO") ports[no].echo = fields[1];            else if (fields[0]=="GET") port.postMessage(JSON.stringify(["ACK",fields[1],store[fields[1]]]));            else if (fields[0]=="CLOSE") {              port.removeEventListener("message", ports[no].func, false);              ports[no] = null;            }/*            else if (fields[0]=="SET") store[fields[1]]=fields[2];*/            else if (fields[0]=="SET") {              var old_val = store[fields[1]];              if (old_val!=fields[2]) {                var msg = JSON.stringify(["EVENT",fields[1]]);                for (var i=0;i<ports.length;i++)                  if (i==no) store[fields[1]]=fields[2];                  else if (ports[i] && ports[i].subscribe) ports[i].port.postMessage(msg);              }            } else if (fields[0]=="STAT") stat_post(port,"STAT_ACK",fields[1]);else if (fields[0]=="SUBSCRIBE") ports[no].subscribe = fields[1];}var gc = setInterval(gc_func, 600000);function gc_func(){var date = Date.now() - 3600000;for (var i in store) if (store[i].date < date) delete store[i];}function stat_post(port,str,dump){var live = 0;for (var i=0;i<ports.length;i++) if (ports[i]) live++;var msg = JSON.stringify([str,"Connected: "+live+"/"+connections+", Stored: "+Object.keys(store).length]);port.postMessage(msg);var count = 0;if (dump) for (var i in store) port.postMessage(JSON.stringify(["DUMP_ACK",(count++)+": "+i+", "+JSON.stringify(store[i])]));}        '],{type:"text/javascript"});e=URL.createObjectURL(a),localStorage[s]=e}try{return r=new unsafeWindow.SharedWorker(e),r.port.addEventListener("message",t,!1),r.port.addEventListener("message",n,!1),r.port.start(),!0}catch(e){return!1}}function t(e){console.log((new Date).toLocaleTimeString()+", Worker said : "+e.data.substr(0,120)),o||(r.port.postMessage(JSON.stringify(["STAT"])),pref.debug_mode[0]||r.port.postMessage(JSON.stringify(["ECHO",!1])),window.addEventListener("beforeunload",function(){r.port.postMessage(JSON.stringify(["CLOSE"])),r.port.close()},!1)),o=!0,pref.debug_mode[0]||r.port.removeEventListener("message",t,!1)}function n(e){if(p=JSON.parse(e.data),"ACK"==p[0]){var t=p[1];clearTimeout(c[t]),l[t]&&(l[t][0](t,p[2],l[t][1]),delete l[t])}else if("EVENT"==p[0]){if(pref.info_client&&p[1].search(info_raw)!=-1&&"p"==p[1].substr(info_raw.length,1)){var n=(p[1].substr(info_raw.length+1),timer_obj?timer_obj.timer():null);null!=n&&brwsr.sw_cache.trygetItem(p[1],n.page_check5)}pref.info_client&&catalog_obj&&null!=catalog_obj.catalog_func()&&pref.catalog_snoop_refresh&&catalog_obj.catalog_func().catalog_insert(p[1])}p=null}function a(e){l[e][0](e,null,l[e][1]),delete l[e]}if(!localStorage)return null;var r=null,o=!1,s=pref.script_prefix+".bs",i=localStorage[s];i?e(i)||e():e(),!brwsr.ff&&r&&setTimeout(function(){null===i||o||(r.port.removeEventListener("message",t,!1),r.port.close(),e()||(brwsr.sw_cache=null))},5e3);var l=[],c=[],p=null;return r?{setItem:function(e,t){r.port.postMessage(JSON.stringify(["SET",e,t]))},trygetItem:function(e,t,n){l[e]=[t,n],c[e]=setTimeout(function(){a(e)},2e3),r.port.postMessage(JSON.stringify(["GET",e]))},subscribe:function(e){r.port.postMessage(JSON.stringify(["SUBSCRIBE",e]))},addEventListener:function(){}}:null}():null,function(){var e="CatChan_archive_"+window.name,t=pref.catalog.embed_page&&"page"===site.whereami&&sessionStorage&&sessionStorage[e]?function(){catalog_obj.show_hide(),setTimeout(function(){var t=JSON.parse(sessionStorage[e]);sessionStorage[e+"M"]&&(t[2]=function(){if(send_message_emu=JSON.parse(sessionStorage[e+"M"]),receive_message_emu(window.name),pref.archive.IDB.redirect_404_CSP){var t=document.head.innerHTML+document.body.innerHTML,n=new Blob([t],{type:"text/html"}),a=URL.createObjectURL(n);window.open(a,window.name+"B")}}),send_message_emu=[t],receive_message_emu(window.name)},100)}:catalog_obj&&catalog_obj.show_hide;"404"===site.whereami&&pref.archive.IDB.redirect_404?sessionStorage&&setTimeout(function(){var t=e+"A";if(sessionStorage[t])delete sessionStorage[t];else{var n=common_func.fullname2dbt(window.name);sessionStorage[t]=JSON.stringify(["ARCHIVER",["SUB_INIT",{IDB:!0,domain:n[0],board:n[1],no:n[2]}]]),received_messages_404&&(sessionStorage[t+"M"]=JSON.stringify(received_messages_404));var a=site2[site.nickname].make_url4([site.nickname,site.board,"0","page_html"])[0];window.name=window.name+"A",window.open(a,"_self")}},5e3):(pref.catalog.embed&&"catalog"===site.whereami||pref.catalog.embed_page&&"page"===site.whereami||pref.thread.embed&&"thread"===site.whereami||pref.catalog.embed_archive&&"archive"===site.whereami)&&catalog_obj&&(site2[site.nickname].catalog_native_prep_wait_loop?site2[site.nickname].catalog_native_prep_wait_loop(site.whereami,t):pref.patch.delayed_invoke.use?setTimeout(t,1e3*pref.patch.delayed_invoke.sec):t()),setTimeout(thread_reader_init,0),setTimeout(uip_tracker_init,0)}(),options.func0_prep=function(e,t,n){function a(){if(null==l&&null==c){var t=e.childNodes[1].childNodes[1].selectedIndex,n=e.childNodes[1].childNodes[2].value,a=parseInt(n.substr(0,n.indexOf(":")),10),o=parseInt(n.substr(n.indexOf(":")+1),10),p=Date.now();0==t?(i=(new Date).setHours(a,o,0))<p&&(i+=864e5):i=p+1e3*(3600*a+60*o),r()}else null!=l&&(clearTimeout(l),l=null),null!=c&&(clearInterval(c),c=null),_.innerHTML="";s(!1)}function r(){var e=Date.now(),t=i-e;l=t%6e4>=1e3&&t>6e4?setTimeout(r,t%6e4):t<9e4?setTimeout(function(){c=o(30),l=null},t-3e4):setTimeout(r,(t+3e4)%6e4+3e4);var n="";t%6e4>=1e3&&t%6e4<=59499&&(n=Math.round(t%6e4/1e3)+"s"),t>=59500&&(n=Math.floor((t+500)%36e5/6e4)+"m"+n),t>=3599500&&(n=Math.floor((t+500)/36e5)+"h"+n),_.innerHTML=n}function o(e){function t(){if(e-=1,_.innerHTML=e+"s",0==e){var t=document.createEvent("MouseEvents");t.initUIEvent("click",!1,!0,window,1),site.components.postform_submit.dispatchEvent(t),a()}}return _.innerHTML=e+"s",s(!0),setInterval(t,1e3)}function s(t){n.style.background=t?"#ffc0cb":null!=l?"#f5ecf9":d.checked?"#e5f4f9":p;var a=t||null!=l?"Cancel":"Schedule";e.childNodes[1].childNodes[0].value=a}cnst.add_to_tb(t,cnst.icons.button_settings());e.innerHTML='<div style="float:left"><input type="checkbox">autobumper</div><div style="float:right"><input type="button" value="Schedule"><select name="time_sel"><option>at</option><option>later</option></select><input type="time" name="time" value="08:41"></div><div style="float:right"></div>',e.childNodes[1].childNodes[0].addEventListener("click",a,!1);var i,l=null,c=null,p=e.parentNode.style.background,_=e.childNodes[2],d=e.childNodes[0].childNodes[0];d.onchange=function(){s(!1)};var u=null;options.func0_exe=function(e){var t=document.getElementsByClassName("postreply").length-document.getElementsByClassName("de-post-deleted").length;parseFloat(e)>=site.max_page-1&&d.checked&&null==u&&t<site.autosage&&(c=o(30),u=setTimeout(function(){u=null},36e5))}}}}();
//# sourceMappingURL=https://raw.github.com/Dogman8/CatChan/master/CatChan.user.js.map
